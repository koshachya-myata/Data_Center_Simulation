{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 5.000000000000001e-09, "entropy_coeff": 0.10000000000000002, "policy_entropy": -362.93078952365454, "policy_loss": -5811637.389322917, "vf_loss": 10204745.125}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 63.5, "diff_num_grad_updates_vs_sampler_policy": 62.5}}, "num_env_steps_sampled": 48413400, "num_env_steps_trained": 48413400, "num_agent_steps_sampled": 48413400, "num_agent_steps_trained": 48413400}, "sampler_results": {"episode_reward_max": -6939.769104344216, "episode_reward_min": -7192.935015412464, "episode_reward_mean": -7049.7923799196515, "episode_len_mean": 1200.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-7192.935015412464, -6939.769104344216, -6964.646815398022, -7101.818584523901], "episode_lengths": [1200, 1200, 1200, 1200]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.3783720974325264, "mean_inference_ms": 0.23108123615616885, "mean_action_processing_ms": 0.05576725280227773, "mean_env_wait_ms": 0.8015810412879885, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00508427619934082, "StateBufferConnector_ms": 0.0018298625946044922, "ViewRequirementAgentConnector_ms": 0.04257559776306152}}, "episode_reward_max": -6939.769104344216, "episode_reward_min": -7192.935015412464, "episode_reward_mean": -7049.7923799196515, "episode_len_mean": 1200.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-7192.935015412464, -6939.769104344216, -6964.646815398022, -7101.818584523901], "episode_lengths": [1200, 1200, 1200, 1200]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.3783720974325264, "mean_inference_ms": 0.23108123615616885, "mean_action_processing_ms": 0.05576725280227773, "mean_env_wait_ms": 0.8015810412879885, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00508427619934082, "StateBufferConnector_ms": 0.0018298625946044922, "ViewRequirementAgentConnector_ms": 0.04257559776306152}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 48413400, "num_agent_steps_trained": 48413400, "num_env_steps_sampled": 48413400, "num_env_steps_trained": 48413400, "num_env_steps_sampled_this_iter": 4800, "num_env_steps_trained_this_iter": 4800, "num_env_steps_sampled_throughput_per_sec": 399.9477772555327, "num_env_steps_trained_throughput_per_sec": 399.9477772555327, "timesteps_total": 48413400, "num_steps_trained_this_iter": 4800, "agent_timesteps_total": 48413400, "timers": {"training_iteration_time_ms": 3000.379, "sample_time_ms": 2977.158, "load_time_ms": 0.405, "load_throughput": 2965045.538, "learn_time_ms": 22.212, "learn_throughput": 54024.782, "synch_weights_time_ms": 0.569}, "counters": {"num_env_steps_sampled": 48413400, "num_env_steps_trained": 48413400, "num_agent_steps_sampled": 48413400, "num_agent_steps_trained": 48413400}, "done": false, "episodes_total": 9921, "training_iteration": 3116, "trial_id": "4bd41_00000", "date": "2023-08-08_07-30-41", "timestamp": 1691469041, "time_this_iter_s": 12.00338888168335, "time_total_s": 83490.2152774334, "pid": 11406, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 10, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[48412200, 5e-09], [48430200, 5e-09], [48448200, 5e-09], [48466200, 2.5e-09], [48484200, 2.5e-09], [48502200, 2.5e-09], [48520200, 2.5e-09], [48538200, 1e-09], [48556200, 1e-09], [48574200, 1e-09], [48592200, 1e-09], [48610200, 1e-09], [48628200, 5e-10], [48646200, 5e-10], [48664200, 5e-10], [48682200, 5e-10], [48700200, 2.5e-10], [48718200, 2.5e-10], [48736200, 2.5e-10], [48754200, 2.5e-10], [48772200, 1e-10], [48790200, 1e-10], [48808200, 1e-10], [48826200, 5e-11], [48844200, 5e-11], [48862200, 5e-11]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.3, "final_epsilon": 0.01, "epsilon_timesteps": 48880200}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 1200, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17eb87820>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 12.00338888168335, "iterations_since_restore": 1, "perf": {"cpu_util_percent": 21.48888888888889, "ram_util_percent": 55.583333333333336}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 5.000000000000001e-09, "entropy_coeff": 0.10000000000000002, "policy_entropy": -363.0893063015408, "policy_loss": -4765880.345920139, "vf_loss": 9945348.236111112}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 135.5, "diff_num_grad_updates_vs_sampler_policy": 134.5}}, "num_env_steps_sampled": 48418200, "num_env_steps_trained": 48418200, "num_agent_steps_sampled": 48418200, "num_agent_steps_trained": 48418200}, "sampler_results": {"episode_reward_max": -6939.769104344216, "episode_reward_min": -7192.935015412464, "episode_reward_mean": -7036.863389920479, "episode_len_mean": 1200.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-7192.935015412464, -6939.769104344216, -6964.646815398022, -7101.818584523901, -7004.560091406043, -7080.420514360684, -7003.95476470443, -7006.802229214072], "episode_lengths": [1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.3795982149712165, "mean_inference_ms": 0.23087381155719666, "mean_action_processing_ms": 0.05574179812141814, "mean_env_wait_ms": 0.7197284624662763, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0044792890548706055, "StateBufferConnector_ms": 0.001856684684753418, "ViewRequirementAgentConnector_ms": 0.042819976806640625}}, "episode_reward_max": -6939.769104344216, "episode_reward_min": -7192.935015412464, "episode_reward_mean": -7036.863389920479, "episode_len_mean": 1200.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-7192.935015412464, -6939.769104344216, -6964.646815398022, -7101.818584523901, -7004.560091406043, -7080.420514360684, -7003.95476470443, -7006.802229214072], "episode_lengths": [1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.3795982149712165, "mean_inference_ms": 0.23087381155719666, "mean_action_processing_ms": 0.05574179812141814, "mean_env_wait_ms": 0.7197284624662763, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0044792890548706055, "StateBufferConnector_ms": 0.001856684684753418, "ViewRequirementAgentConnector_ms": 0.042819976806640625}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 48418200, "num_agent_steps_trained": 48418200, "num_env_steps_sampled": 48418200, "num_env_steps_trained": 48418200, "num_env_steps_sampled_this_iter": 4800, "num_env_steps_trained_this_iter": 4800, "num_env_steps_sampled_throughput_per_sec": 459.9153177694454, "num_env_steps_trained_throughput_per_sec": 459.9153177694454, "timesteps_total": 48418200, "num_steps_trained_this_iter": 4800, "agent_timesteps_total": 48418200, "timers": {"training_iteration_time_ms": 2804.772, "sample_time_ms": 2782.731, "load_time_ms": 0.398, "load_throughput": 3016128.719, "learn_time_ms": 21.044, "learn_throughput": 57024.144, "synch_weights_time_ms": 0.565}, "counters": {"num_env_steps_sampled": 48418200, "num_env_steps_trained": 48418200, "num_agent_steps_sampled": 48418200, "num_agent_steps_trained": 48418200}, "done": false, "episodes_total": 9925, "training_iteration": 3117, "trial_id": "4bd41_00000", "date": "2023-08-08_07-30-52", "timestamp": 1691469052, "time_this_iter_s": 10.438952207565308, "time_total_s": 83500.65422964096, "pid": 11406, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 10, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[48412200, 5e-09], [48430200, 5e-09], [48448200, 5e-09], [48466200, 2.5e-09], [48484200, 2.5e-09], [48502200, 2.5e-09], [48520200, 2.5e-09], [48538200, 1e-09], [48556200, 1e-09], [48574200, 1e-09], [48592200, 1e-09], [48610200, 1e-09], [48628200, 5e-10], [48646200, 5e-10], [48664200, 5e-10], [48682200, 5e-10], [48700200, 2.5e-10], [48718200, 2.5e-10], [48736200, 2.5e-10], [48754200, 2.5e-10], [48772200, 1e-10], [48790200, 1e-10], [48808200, 1e-10], [48826200, 5e-11], [48844200, 5e-11], [48862200, 5e-11]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.3, "final_epsilon": 0.01, "epsilon_timesteps": 48880200}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 1200, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17eb87820>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 22.442341089248657, "iterations_since_restore": 2, "perf": {"cpu_util_percent": 18.607142857142858, "ram_util_percent": 55.62142857142857}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 5.000000000000001e-09, "entropy_coeff": 0.10000000000000002, "policy_entropy": -363.3595614963108, "policy_loss": -2902368.892361111, "vf_loss": 9631648.25}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 207.5, "diff_num_grad_updates_vs_sampler_policy": 206.5}}, "num_env_steps_sampled": 48423000, "num_env_steps_trained": 48423000, "num_agent_steps_sampled": 48423000, "num_agent_steps_trained": 48423000}, "sampler_results": {"episode_reward_max": -6897.9347297838385, "episode_reward_min": -7192.935015412464, "episode_reward_mean": -7028.137063183432, "episode_len_mean": 1200.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-7192.935015412464, -6939.769104344216, -6964.646815398022, -7101.818584523901, -7004.560091406043, -7080.420514360684, -7003.95476470443, -7006.802229214072, -7108.819924944902, -7077.238211770432, -6958.74477233818, -6897.9347297838385], "episode_lengths": [1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.3807982240327152, "mean_inference_ms": 0.23063851839656188, "mean_action_processing_ms": 0.05570755171287384, "mean_env_wait_ms": 0.6743048292059161, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0039895375569661455, "StateBufferConnector_ms": 0.0018318494160970051, "ViewRequirementAgentConnector_ms": 0.043082237243652344}}, "episode_reward_max": -6897.9347297838385, "episode_reward_min": -7192.935015412464, "episode_reward_mean": -7028.137063183432, "episode_len_mean": 1200.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-7192.935015412464, -6939.769104344216, -6964.646815398022, -7101.818584523901, -7004.560091406043, -7080.420514360684, -7003.95476470443, -7006.802229214072, -7108.819924944902, -7077.238211770432, -6958.74477233818, -6897.9347297838385], "episode_lengths": [1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.3807982240327152, "mean_inference_ms": 0.23063851839656188, "mean_action_processing_ms": 0.05570755171287384, "mean_env_wait_ms": 0.6743048292059161, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0039895375569661455, "StateBufferConnector_ms": 0.0018318494160970051, "ViewRequirementAgentConnector_ms": 0.043082237243652344}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 48423000, "num_agent_steps_trained": 48423000, "num_env_steps_sampled": 48423000, "num_env_steps_trained": 48423000, "num_env_steps_sampled_this_iter": 4800, "num_env_steps_trained_this_iter": 4800, "num_env_steps_sampled_throughput_per_sec": 459.1031900287475, "num_env_steps_trained_throughput_per_sec": 459.1031900287475, "timesteps_total": 48423000, "num_steps_trained_this_iter": 4800, "agent_timesteps_total": 48423000, "timers": {"training_iteration_time_ms": 2611.078, "sample_time_ms": 2590.253, "load_time_ms": 0.404, "load_throughput": 2971697.939, "learn_time_ms": 19.831, "learn_throughput": 60512.588, "synch_weights_time_ms": 0.556}, "counters": {"num_env_steps_sampled": 48423000, "num_env_steps_trained": 48423000, "num_agent_steps_sampled": 48423000, "num_agent_steps_trained": 48423000}, "done": false, "episodes_total": 9929, "training_iteration": 3118, "trial_id": "4bd41_00000", "date": "2023-08-08_07-31-02", "timestamp": 1691469062, "time_this_iter_s": 10.456971883773804, "time_total_s": 83511.11120152473, "pid": 11406, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 10, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[48412200, 5e-09], [48430200, 5e-09], [48448200, 5e-09], [48466200, 2.5e-09], [48484200, 2.5e-09], [48502200, 2.5e-09], [48520200, 2.5e-09], [48538200, 1e-09], [48556200, 1e-09], [48574200, 1e-09], [48592200, 1e-09], [48610200, 1e-09], [48628200, 5e-10], [48646200, 5e-10], [48664200, 5e-10], [48682200, 5e-10], [48700200, 2.5e-10], [48718200, 2.5e-10], [48736200, 2.5e-10], [48754200, 2.5e-10], [48772200, 1e-10], [48790200, 1e-10], [48808200, 1e-10], [48826200, 5e-11], [48844200, 5e-11], [48862200, 5e-11]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.3, "final_epsilon": 0.01, "epsilon_timesteps": 48880200}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 1200, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17eb87820>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 32.89931297302246, "iterations_since_restore": 3, "perf": {"cpu_util_percent": 16.19333333333333, "ram_util_percent": 55.63333333333335}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 5.000000000000001e-09, "entropy_coeff": 0.10000000000000002, "policy_entropy": -362.5689629448785, "policy_loss": -10732235.230034722, "vf_loss": 10124909.583333334}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 279.5, "diff_num_grad_updates_vs_sampler_policy": 278.5}}, "num_env_steps_sampled": 48427800, "num_env_steps_trained": 48427800, "num_agent_steps_sampled": 48427800, "num_agent_steps_trained": 48427800}, "sampler_results": {"episode_reward_max": -6897.9347297838385, "episode_reward_min": -7192.935015412464, "episode_reward_mean": -7040.9260792697805, "episode_len_mean": 1200.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-7192.935015412464, -6939.769104344216, -6964.646815398022, -7101.818584523901, -7004.560091406043, -7080.420514360684, -7003.95476470443, -7006.802229214072, -7108.819924944902, -7077.238211770432, -6958.74477233818, -6897.9347297838385, -7133.0413473706885, -7106.175846091458, -7022.508151062388, -7055.4471655907755], "episode_lengths": [1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.3822833585771845, "mean_inference_ms": 0.2305428885780051, "mean_action_processing_ms": 0.05572507435341638, "mean_env_wait_ms": 0.6461014996398011, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0035002827644348145, "StateBufferConnector_ms": 0.0018462538719177246, "ViewRequirementAgentConnector_ms": 0.04324913024902344}}, "episode_reward_max": -6897.9347297838385, "episode_reward_min": -7192.935015412464, "episode_reward_mean": -7040.9260792697805, "episode_len_mean": 1200.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-7192.935015412464, -6939.769104344216, -6964.646815398022, -7101.818584523901, -7004.560091406043, -7080.420514360684, -7003.95476470443, -7006.802229214072, -7108.819924944902, -7077.238211770432, -6958.74477233818, -6897.9347297838385, -7133.0413473706885, -7106.175846091458, -7022.508151062388, -7055.4471655907755], "episode_lengths": [1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.3822833585771845, "mean_inference_ms": 0.2305428885780051, "mean_action_processing_ms": 0.05572507435341638, "mean_env_wait_ms": 0.6461014996398011, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0035002827644348145, "StateBufferConnector_ms": 0.0018462538719177246, "ViewRequirementAgentConnector_ms": 0.04324913024902344}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 48427800, "num_agent_steps_trained": 48427800, "num_env_steps_sampled": 48427800, "num_env_steps_trained": 48427800, "num_env_steps_sampled_this_iter": 4800, "num_env_steps_trained_this_iter": 4800, "num_env_steps_sampled_throughput_per_sec": 452.35913901699234, "num_env_steps_trained_throughput_per_sec": 452.35913901699234, "timesteps_total": 48427800, "num_steps_trained_this_iter": 4800, "agent_timesteps_total": 48427800, "timers": {"training_iteration_time_ms": 2627.904, "sample_time_ms": 2607.139, "load_time_ms": 0.407, "load_throughput": 2949926.621, "learn_time_ms": 19.77, "learn_throughput": 60697.508, "synch_weights_time_ms": 0.552}, "counters": {"num_env_steps_sampled": 48427800, "num_env_steps_trained": 48427800, "num_agent_steps_sampled": 48427800, "num_agent_steps_trained": 48427800}, "done": false, "episodes_total": 9933, "training_iteration": 3119, "trial_id": "4bd41_00000", "date": "2023-08-08_07-31-13", "timestamp": 1691469073, "time_this_iter_s": 10.61302399635315, "time_total_s": 83521.72422552109, "pid": 11406, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 10, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[48412200, 5e-09], [48430200, 5e-09], [48448200, 5e-09], [48466200, 2.5e-09], [48484200, 2.5e-09], [48502200, 2.5e-09], [48520200, 2.5e-09], [48538200, 1e-09], [48556200, 1e-09], [48574200, 1e-09], [48592200, 1e-09], [48610200, 1e-09], [48628200, 5e-10], [48646200, 5e-10], [48664200, 5e-10], [48682200, 5e-10], [48700200, 2.5e-10], [48718200, 2.5e-10], [48736200, 2.5e-10], [48754200, 2.5e-10], [48772200, 1e-10], [48790200, 1e-10], [48808200, 1e-10], [48826200, 5e-11], [48844200, 5e-11], [48862200, 5e-11]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.3, "final_epsilon": 0.01, "epsilon_timesteps": 48880200}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 1200, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17eb87820>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 43.51233696937561, "iterations_since_restore": 4, "perf": {"cpu_util_percent": 17.453333333333333, "ram_util_percent": 55.626666666666665}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 5.000000000000001e-09, "entropy_coeff": 0.10000000000000002, "policy_entropy": -363.94057210286456, "policy_loss": -6164249.967230903, "vf_loss": 10128951.347222222}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 351.5, "diff_num_grad_updates_vs_sampler_policy": 350.5}}, "num_env_steps_sampled": 48432600, "num_env_steps_trained": 48432600, "num_agent_steps_sampled": 48432600, "num_agent_steps_trained": 48432600}, "sampler_results": {"episode_reward_max": -6897.9347297838385, "episode_reward_min": -7192.935015412464, "episode_reward_mean": -7047.457274941453, "episode_len_mean": 1200.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-7192.935015412464, -6939.769104344216, -6964.646815398022, -7101.818584523901, -7004.560091406043, -7080.420514360684, -7003.95476470443, -7006.802229214072, -7108.819924944902, -7077.238211770432, -6958.74477233818, -6897.9347297838385, -7133.0413473706885, -7106.175846091458, -7022.508151062388, -7055.4471655907755, -7156.551730099049, -7118.253979107904, -6960.48613997543, -7059.036381330186], "episode_lengths": [1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.3833327786063432, "mean_inference_ms": 0.23055842090009615, "mean_action_processing_ms": 0.05577169440476942, "mean_env_wait_ms": 0.6264396834556416, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003204345703125, "StateBufferConnector_ms": 0.0018203258514404297, "ViewRequirementAgentConnector_ms": 0.04317760467529297}}, "episode_reward_max": -6897.9347297838385, "episode_reward_min": -7192.935015412464, "episode_reward_mean": -7047.457274941453, "episode_len_mean": 1200.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-7192.935015412464, -6939.769104344216, -6964.646815398022, -7101.818584523901, -7004.560091406043, -7080.420514360684, -7003.95476470443, -7006.802229214072, -7108.819924944902, -7077.238211770432, -6958.74477233818, -6897.9347297838385, -7133.0413473706885, -7106.175846091458, -7022.508151062388, -7055.4471655907755, -7156.551730099049, -7118.253979107904, -6960.48613997543, -7059.036381330186], "episode_lengths": [1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.3833327786063432, "mean_inference_ms": 0.23055842090009615, "mean_action_processing_ms": 0.05577169440476942, "mean_env_wait_ms": 0.6264396834556416, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003204345703125, "StateBufferConnector_ms": 0.0018203258514404297, "ViewRequirementAgentConnector_ms": 0.04317760467529297}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 48432600, "num_agent_steps_trained": 48432600, "num_env_steps_sampled": 48432600, "num_env_steps_trained": 48432600, "num_env_steps_sampled_this_iter": 4800, "num_env_steps_trained_this_iter": 4800, "num_env_steps_sampled_throughput_per_sec": 453.79815060091914, "num_env_steps_trained_throughput_per_sec": 453.79815060091914, "timesteps_total": 48432600, "num_steps_trained_this_iter": 4800, "agent_timesteps_total": 48432600, "timers": {"training_iteration_time_ms": 2637.949, "sample_time_ms": 2617.173, "load_time_ms": 0.407, "load_throughput": 2945610.581, "learn_time_ms": 19.761, "learn_throughput": 60726.728, "synch_weights_time_ms": 0.572}, "counters": {"num_env_steps_sampled": 48432600, "num_env_steps_trained": 48432600, "num_agent_steps_sampled": 48432600, "num_agent_steps_trained": 48432600}, "done": false, "episodes_total": 9937, "training_iteration": 3120, "trial_id": "4bd41_00000", "date": "2023-08-08_07-31-23", "timestamp": 1691469083, "time_this_iter_s": 10.579447984695435, "time_total_s": 83532.30367350578, "pid": 11406, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 10, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[48412200, 5e-09], [48430200, 5e-09], [48448200, 5e-09], [48466200, 2.5e-09], [48484200, 2.5e-09], [48502200, 2.5e-09], [48520200, 2.5e-09], [48538200, 1e-09], [48556200, 1e-09], [48574200, 1e-09], [48592200, 1e-09], [48610200, 1e-09], [48628200, 5e-10], [48646200, 5e-10], [48664200, 5e-10], [48682200, 5e-10], [48700200, 2.5e-10], [48718200, 2.5e-10], [48736200, 2.5e-10], [48754200, 2.5e-10], [48772200, 1e-10], [48790200, 1e-10], [48808200, 1e-10], [48826200, 5e-11], [48844200, 5e-11], [48862200, 5e-11]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.3, "final_epsilon": 0.01, "epsilon_timesteps": 48880200}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 1200, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17eb87820>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 54.091784954071045, "iterations_since_restore": 5, "perf": {"cpu_util_percent": 18.220000000000002, "ram_util_percent": 55.48666666666667}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 5.000000000000001e-09, "entropy_coeff": 0.10000000000000002, "policy_entropy": -364.30835978190106, "policy_loss": -4230405.371527778, "vf_loss": 9933438.305555556}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 423.5, "diff_num_grad_updates_vs_sampler_policy": 422.5}}, "num_env_steps_sampled": 48437400, "num_env_steps_trained": 48437400, "num_agent_steps_sampled": 48437400, "num_agent_steps_trained": 48437400}, "sampler_results": {"episode_reward_max": -6897.9347297838385, "episode_reward_min": -7258.694817064271, "episode_reward_mean": -7052.028927435637, "episode_len_mean": 1200.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-7192.935015412464, -6939.769104344216, -6964.646815398022, -7101.818584523901, -7004.560091406043, -7080.420514360684, -7003.95476470443, -7006.802229214072, -7108.819924944902, -7077.238211770432, -6958.74477233818, -6897.9347297838385, -7133.0413473706885, -7106.175846091458, -7022.508151062388, -7055.4471655907755, -7156.551730099049, -7118.253979107904, -6960.48613997543, -7059.036381330186, -7258.694817064271, -7103.609693153824, -6959.141746836437, -6978.102502571718], "episode_lengths": [1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.3842513529807727, "mean_inference_ms": 0.23057343645251469, "mean_action_processing_ms": 0.05582102654268381, "mean_env_wait_ms": 0.6115276966451147, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0030249357223510742, "StateBufferConnector_ms": 0.001825888951619466, "ViewRequirementAgentConnector_ms": 0.04322131474812826}}, "episode_reward_max": -6897.9347297838385, "episode_reward_min": -7258.694817064271, "episode_reward_mean": -7052.028927435637, "episode_len_mean": 1200.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-7192.935015412464, -6939.769104344216, -6964.646815398022, -7101.818584523901, -7004.560091406043, -7080.420514360684, -7003.95476470443, -7006.802229214072, -7108.819924944902, -7077.238211770432, -6958.74477233818, -6897.9347297838385, -7133.0413473706885, -7106.175846091458, -7022.508151062388, -7055.4471655907755, -7156.551730099049, -7118.253979107904, -6960.48613997543, -7059.036381330186, -7258.694817064271, -7103.609693153824, -6959.141746836437, -6978.102502571718], "episode_lengths": [1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.3842513529807727, "mean_inference_ms": 0.23057343645251469, "mean_action_processing_ms": 0.05582102654268381, "mean_env_wait_ms": 0.6115276966451147, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0030249357223510742, "StateBufferConnector_ms": 0.001825888951619466, "ViewRequirementAgentConnector_ms": 0.04322131474812826}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 48437400, "num_agent_steps_trained": 48437400, "num_env_steps_sampled": 48437400, "num_env_steps_trained": 48437400, "num_env_steps_sampled_this_iter": 4800, "num_env_steps_trained_this_iter": 4800, "num_env_steps_sampled_throughput_per_sec": 455.220911257666, "num_env_steps_trained_throughput_per_sec": 455.220911257666, "timesteps_total": 48437400, "num_steps_trained_this_iter": 4800, "agent_timesteps_total": 48437400, "timers": {"training_iteration_time_ms": 2639.911, "sample_time_ms": 2619.159, "load_time_ms": 0.409, "load_throughput": 2930518.079, "learn_time_ms": 19.728, "learn_throughput": 60826.831, "synch_weights_time_ms": 0.577}, "counters": {"num_env_steps_sampled": 48437400, "num_env_steps_trained": 48437400, "num_agent_steps_sampled": 48437400, "num_agent_steps_trained": 48437400}, "done": false, "episodes_total": 9941, "training_iteration": 3121, "trial_id": "4bd41_00000", "date": "2023-08-08_07-31-34", "timestamp": 1691469094, "time_this_iter_s": 10.54616904258728, "time_total_s": 83542.84984254837, "pid": 11406, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 10, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[48412200, 5e-09], [48430200, 5e-09], [48448200, 5e-09], [48466200, 2.5e-09], [48484200, 2.5e-09], [48502200, 2.5e-09], [48520200, 2.5e-09], [48538200, 1e-09], [48556200, 1e-09], [48574200, 1e-09], [48592200, 1e-09], [48610200, 1e-09], [48628200, 5e-10], [48646200, 5e-10], [48664200, 5e-10], [48682200, 5e-10], [48700200, 2.5e-10], [48718200, 2.5e-10], [48736200, 2.5e-10], [48754200, 2.5e-10], [48772200, 1e-10], [48790200, 1e-10], [48808200, 1e-10], [48826200, 5e-11], [48844200, 5e-11], [48862200, 5e-11]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.3, "final_epsilon": 0.01, "epsilon_timesteps": 48880200}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 1200, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17eb87820>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 64.63795399665833, "iterations_since_restore": 6, "perf": {"cpu_util_percent": 18.65333333333333, "ram_util_percent": 55.35999999999999}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 5.000000000000001e-09, "entropy_coeff": 0.10000000000000002, "policy_entropy": -362.8818003336589, "policy_loss": -7887664.644314236, "vf_loss": 9913180.486111112}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 495.5, "diff_num_grad_updates_vs_sampler_policy": 494.5}}, "num_env_steps_sampled": 48442200, "num_env_steps_trained": 48442200, "num_agent_steps_sampled": 48442200, "num_agent_steps_trained": 48442200}, "sampler_results": {"episode_reward_max": -6897.9347297838385, "episode_reward_min": -7258.694817064271, "episode_reward_mean": -7055.152904978201, "episode_len_mean": 1200.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-7192.935015412464, -6939.769104344216, -6964.646815398022, -7101.818584523901, -7004.560091406043, -7080.420514360684, -7003.95476470443, -7006.802229214072, -7108.819924944902, -7077.238211770432, -6958.74477233818, -6897.9347297838385, -7133.0413473706885, -7106.175846091458, -7022.508151062388, -7055.4471655907755, -7156.551730099049, -7118.253979107904, -6960.48613997543, -7059.036381330186, -7258.694817064271, -7103.609693153824, -6959.141746836437, -6978.102502571718, -7023.055259216437, -7054.420855284454, -7221.500670767508, -6996.610295665902], "episode_lengths": [1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.3850110127272444, "mean_inference_ms": 0.2306006297435797, "mean_action_processing_ms": 0.055867721483975, "mean_env_wait_ms": 0.6000266193457148, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0028848648071289062, "StateBufferConnector_ms": 0.0018307140895298549, "ViewRequirementAgentConnector_ms": 0.04324572426932199}}, "episode_reward_max": -6897.9347297838385, "episode_reward_min": -7258.694817064271, "episode_reward_mean": -7055.152904978201, "episode_len_mean": 1200.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-7192.935015412464, -6939.769104344216, -6964.646815398022, -7101.818584523901, -7004.560091406043, -7080.420514360684, -7003.95476470443, -7006.802229214072, -7108.819924944902, -7077.238211770432, -6958.74477233818, -6897.9347297838385, -7133.0413473706885, -7106.175846091458, -7022.508151062388, -7055.4471655907755, -7156.551730099049, -7118.253979107904, -6960.48613997543, -7059.036381330186, -7258.694817064271, -7103.609693153824, -6959.141746836437, -6978.102502571718, -7023.055259216437, -7054.420855284454, -7221.500670767508, -6996.610295665902], "episode_lengths": [1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.3850110127272444, "mean_inference_ms": 0.2306006297435797, "mean_action_processing_ms": 0.055867721483975, "mean_env_wait_ms": 0.6000266193457148, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0028848648071289062, "StateBufferConnector_ms": 0.0018307140895298549, "ViewRequirementAgentConnector_ms": 0.04324572426932199}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 48442200, "num_agent_steps_trained": 48442200, "num_env_steps_sampled": 48442200, "num_env_steps_trained": 48442200, "num_env_steps_sampled_this_iter": 4800, "num_env_steps_trained_this_iter": 4800, "num_env_steps_sampled_throughput_per_sec": 452.77063753065016, "num_env_steps_trained_throughput_per_sec": 452.77063753065016, "timesteps_total": 48442200, "num_steps_trained_this_iter": 4800, "agent_timesteps_total": 48442200, "timers": {"training_iteration_time_ms": 2642.268, "sample_time_ms": 2621.48, "load_time_ms": 0.409, "load_throughput": 2932737.909, "learn_time_ms": 19.768, "learn_throughput": 60703.071, "synch_weights_time_ms": 0.572}, "counters": {"num_env_steps_sampled": 48442200, "num_env_steps_trained": 48442200, "num_agent_steps_sampled": 48442200, "num_agent_steps_trained": 48442200}, "done": false, "episodes_total": 9945, "training_iteration": 3122, "trial_id": "4bd41_00000", "date": "2023-08-08_07-31-45", "timestamp": 1691469105, "time_this_iter_s": 10.603371143341064, "time_total_s": 83553.45321369171, "pid": 11406, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 10, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[48412200, 5e-09], [48430200, 5e-09], [48448200, 5e-09], [48466200, 2.5e-09], [48484200, 2.5e-09], [48502200, 2.5e-09], [48520200, 2.5e-09], [48538200, 1e-09], [48556200, 1e-09], [48574200, 1e-09], [48592200, 1e-09], [48610200, 1e-09], [48628200, 5e-10], [48646200, 5e-10], [48664200, 5e-10], [48682200, 5e-10], [48700200, 2.5e-10], [48718200, 2.5e-10], [48736200, 2.5e-10], [48754200, 2.5e-10], [48772200, 1e-10], [48790200, 1e-10], [48808200, 1e-10], [48826200, 5e-11], [48844200, 5e-11], [48862200, 5e-11]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.3, "final_epsilon": 0.01, "epsilon_timesteps": 48880200}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 1200, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17eb87820>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 75.24132513999939, "iterations_since_restore": 7, "perf": {"cpu_util_percent": 17.425, "ram_util_percent": 55.65}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 5.000000000000001e-09, "entropy_coeff": 0.10000000000000002, "policy_entropy": -363.6664852566189, "policy_loss": -6148184.741753472, "vf_loss": 9860376.138888888}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 567.5, "diff_num_grad_updates_vs_sampler_policy": 566.5}}, "num_env_steps_sampled": 48447000, "num_env_steps_trained": 48447000, "num_agent_steps_sampled": 48447000, "num_agent_steps_trained": 48447000}, "sampler_results": {"episode_reward_max": -6863.816864875627, "episode_reward_min": -7258.694817064271, "episode_reward_mean": -7049.802926608303, "episode_len_mean": 1200.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-7192.935015412464, -6939.769104344216, -6964.646815398022, -7101.818584523901, -7004.560091406043, -7080.420514360684, -7003.95476470443, -7006.802229214072, -7108.819924944902, -7077.238211770432, -6958.74477233818, -6897.9347297838385, -7133.0413473706885, -7106.175846091458, -7022.508151062388, -7055.4471655907755, -7156.551730099049, -7118.253979107904, -6960.48613997543, -7059.036381330186, -7258.694817064271, -7103.609693153824, -6959.141746836437, -6978.102502571718, -7023.055259216437, -7054.420855284454, -7221.500670767508, -6996.610295665902, -6863.816864875627, -7135.441374732098, -7072.856803490325, -6977.297268978018], "episode_lengths": [1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.3856538322230003, "mean_inference_ms": 0.23061031033461168, "mean_action_processing_ms": 0.055905150595162524, "mean_env_wait_ms": 0.59057609640135, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002781301736831665, "StateBufferConnector_ms": 0.0018224120140075684, "ViewRequirementAgentConnector_ms": 0.043198466300964355}}, "episode_reward_max": -6863.816864875627, "episode_reward_min": -7258.694817064271, "episode_reward_mean": -7049.802926608303, "episode_len_mean": 1200.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-7192.935015412464, -6939.769104344216, -6964.646815398022, -7101.818584523901, -7004.560091406043, -7080.420514360684, -7003.95476470443, -7006.802229214072, -7108.819924944902, -7077.238211770432, -6958.74477233818, -6897.9347297838385, -7133.0413473706885, -7106.175846091458, -7022.508151062388, -7055.4471655907755, -7156.551730099049, -7118.253979107904, -6960.48613997543, -7059.036381330186, -7258.694817064271, -7103.609693153824, -6959.141746836437, -6978.102502571718, -7023.055259216437, -7054.420855284454, -7221.500670767508, -6996.610295665902, -6863.816864875627, -7135.441374732098, -7072.856803490325, -6977.297268978018], "episode_lengths": [1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.3856538322230003, "mean_inference_ms": 0.23061031033461168, "mean_action_processing_ms": 0.055905150595162524, "mean_env_wait_ms": 0.59057609640135, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002781301736831665, "StateBufferConnector_ms": 0.0018224120140075684, "ViewRequirementAgentConnector_ms": 0.043198466300964355}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 48447000, "num_agent_steps_trained": 48447000, "num_env_steps_sampled": 48447000, "num_env_steps_trained": 48447000, "num_env_steps_sampled_this_iter": 4800, "num_env_steps_trained_this_iter": 4800, "num_env_steps_sampled_throughput_per_sec": 456.6606695435135, "num_env_steps_trained_throughput_per_sec": 456.6606695435135, "timesteps_total": 48447000, "num_steps_trained_this_iter": 4800, "agent_timesteps_total": 48447000, "timers": {"training_iteration_time_ms": 2633.182, "sample_time_ms": 2612.433, "load_time_ms": 0.411, "load_throughput": 2922520.497, "learn_time_ms": 19.731, "learn_throughput": 60818.452, "synch_weights_time_ms": 0.571}, "counters": {"num_env_steps_sampled": 48447000, "num_env_steps_trained": 48447000, "num_agent_steps_sampled": 48447000, "num_agent_steps_trained": 48447000}, "done": false, "episodes_total": 9949, "training_iteration": 3123, "trial_id": "4bd41_00000", "date": "2023-08-08_07-31-55", "timestamp": 1691469115, "time_this_iter_s": 10.51297903060913, "time_total_s": 83563.96619272232, "pid": 11406, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 10, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[48412200, 5e-09], [48430200, 5e-09], [48448200, 5e-09], [48466200, 2.5e-09], [48484200, 2.5e-09], [48502200, 2.5e-09], [48520200, 2.5e-09], [48538200, 1e-09], [48556200, 1e-09], [48574200, 1e-09], [48592200, 1e-09], [48610200, 1e-09], [48628200, 5e-10], [48646200, 5e-10], [48664200, 5e-10], [48682200, 5e-10], [48700200, 2.5e-10], [48718200, 2.5e-10], [48736200, 2.5e-10], [48754200, 2.5e-10], [48772200, 1e-10], [48790200, 1e-10], [48808200, 1e-10], [48826200, 5e-11], [48844200, 5e-11], [48862200, 5e-11]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.3, "final_epsilon": 0.01, "epsilon_timesteps": 48880200}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 1200, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17eb87820>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 85.75430417060852, "iterations_since_restore": 8, "perf": {"cpu_util_percent": 17.621428571428574, "ram_util_percent": 55.63571428571429}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 4.666666666666667e-09, "entropy_coeff": 0.10000000000000002, "policy_entropy": -363.82856920030383, "policy_loss": -6563838.278211806, "vf_loss": 10035266.111111112}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 639.5, "diff_num_grad_updates_vs_sampler_policy": 638.5}}, "num_env_steps_sampled": 48451800, "num_env_steps_trained": 48451800, "num_agent_steps_sampled": 48451800, "num_agent_steps_trained": 48451800}, "sampler_results": {"episode_reward_max": -6863.816864875627, "episode_reward_min": -7258.694817064271, "episode_reward_mean": -7051.014974002087, "episode_len_mean": 1200.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-7192.935015412464, -6939.769104344216, -6964.646815398022, -7101.818584523901, -7004.560091406043, -7080.420514360684, -7003.95476470443, -7006.802229214072, -7108.819924944902, -7077.238211770432, -6958.74477233818, -6897.9347297838385, -7133.0413473706885, -7106.175846091458, -7022.508151062388, -7055.4471655907755, -7156.551730099049, -7118.253979107904, -6960.48613997543, -7059.036381330186, -7258.694817064271, -7103.609693153824, -6959.141746836437, -6978.102502571718, -7023.055259216437, -7054.420855284454, -7221.500670767508, -6996.610295665902, -6863.816864875627, -7135.441374732098, -7072.856803490325, -6977.297268978018, -7045.858383823964, -7116.76351670452, -7075.866883064482, -7004.356629016461], "episode_lengths": [1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.3861630402006522, "mean_inference_ms": 0.2306215072105201, "mean_action_processing_ms": 0.05593868872492114, "mean_env_wait_ms": 0.5828105000819335, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0027100245157877603, "StateBufferConnector_ms": 0.0018192662133110894, "ViewRequirementAgentConnector_ms": 0.04318290286593967}}, "episode_reward_max": -6863.816864875627, "episode_reward_min": -7258.694817064271, "episode_reward_mean": -7051.014974002087, "episode_len_mean": 1200.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-7192.935015412464, -6939.769104344216, -6964.646815398022, -7101.818584523901, -7004.560091406043, -7080.420514360684, -7003.95476470443, -7006.802229214072, -7108.819924944902, -7077.238211770432, -6958.74477233818, -6897.9347297838385, -7133.0413473706885, -7106.175846091458, -7022.508151062388, -7055.4471655907755, -7156.551730099049, -7118.253979107904, -6960.48613997543, -7059.036381330186, -7258.694817064271, -7103.609693153824, -6959.141746836437, -6978.102502571718, -7023.055259216437, -7054.420855284454, -7221.500670767508, -6996.610295665902, -6863.816864875627, -7135.441374732098, -7072.856803490325, -6977.297268978018, -7045.858383823964, -7116.76351670452, -7075.866883064482, -7004.356629016461], "episode_lengths": [1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.3861630402006522, "mean_inference_ms": 0.2306215072105201, "mean_action_processing_ms": 0.05593868872492114, "mean_env_wait_ms": 0.5828105000819335, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0027100245157877603, "StateBufferConnector_ms": 0.0018192662133110894, "ViewRequirementAgentConnector_ms": 0.04318290286593967}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 48451800, "num_agent_steps_trained": 48451800, "num_env_steps_sampled": 48451800, "num_env_steps_trained": 48451800, "num_env_steps_sampled_this_iter": 4800, "num_env_steps_trained_this_iter": 4800, "num_env_steps_sampled_throughput_per_sec": 454.41312971693236, "num_env_steps_trained_throughput_per_sec": 454.41312971693236, "timesteps_total": 48451800, "num_steps_trained_this_iter": 4800, "agent_timesteps_total": 48451800, "timers": {"training_iteration_time_ms": 2639.402, "sample_time_ms": 2618.526, "load_time_ms": 0.411, "load_throughput": 2920316.101, "learn_time_ms": 19.853, "learn_throughput": 60443.044, "synch_weights_time_ms": 0.574}, "counters": {"num_env_steps_sampled": 48451800, "num_env_steps_trained": 48451800, "num_agent_steps_sampled": 48451800, "num_agent_steps_trained": 48451800}, "done": false, "episodes_total": 9953, "training_iteration": 3124, "trial_id": "4bd41_00000", "date": "2023-08-08_07-32-06", "timestamp": 1691469126, "time_this_iter_s": 10.56498408317566, "time_total_s": 83574.5311768055, "pid": 11406, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 10, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[48412200, 5e-09], [48430200, 5e-09], [48448200, 5e-09], [48466200, 2.5e-09], [48484200, 2.5e-09], [48502200, 2.5e-09], [48520200, 2.5e-09], [48538200, 1e-09], [48556200, 1e-09], [48574200, 1e-09], [48592200, 1e-09], [48610200, 1e-09], [48628200, 5e-10], [48646200, 5e-10], [48664200, 5e-10], [48682200, 5e-10], [48700200, 2.5e-10], [48718200, 2.5e-10], [48736200, 2.5e-10], [48754200, 2.5e-10], [48772200, 1e-10], [48790200, 1e-10], [48808200, 1e-10], [48826200, 5e-11], [48844200, 5e-11], [48862200, 5e-11]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.3, "final_epsilon": 0.01, "epsilon_timesteps": 48880200}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 1200, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17eb87820>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 96.31928825378418, "iterations_since_restore": 9, "perf": {"cpu_util_percent": 16.10625, "ram_util_percent": 55.599999999999994}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 3.9999999999999994e-09, "entropy_coeff": 0.10000000000000002, "policy_entropy": -364.4393802218967, "policy_loss": -6233799.291232639, "vf_loss": 10155610.305555556}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 711.5, "diff_num_grad_updates_vs_sampler_policy": 710.5}}, "num_env_steps_sampled": 48456600, "num_env_steps_trained": 48456600, "num_agent_steps_sampled": 48456600, "num_agent_steps_trained": 48456600}, "sampler_results": {"episode_reward_max": -6863.816864875627, "episode_reward_min": -7258.694817064271, "episode_reward_mean": -7049.8273963866495, "episode_len_mean": 1200.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-7192.935015412464, -6939.769104344216, -6964.646815398022, -7101.818584523901, -7004.560091406043, -7080.420514360684, -7003.95476470443, -7006.802229214072, -7108.819924944902, -7077.238211770432, -6958.74477233818, -6897.9347297838385, -7133.0413473706885, -7106.175846091458, -7022.508151062388, -7055.4471655907755, -7156.551730099049, -7118.253979107904, -6960.48613997543, -7059.036381330186, -7258.694817064271, -7103.609693153824, -6959.141746836437, -6978.102502571718, -7023.055259216437, -7054.420855284454, -7221.500670767508, -6996.610295665902, -6863.816864875627, -7135.441374732098, -7072.856803490325, -6977.297268978018, -7045.858383823964, -7116.76351670452, -7075.866883064482, -7004.356629016461, -7049.743980503448, -7085.78856131624, -6955.217855184973, -7065.806394386167], "episode_lengths": [1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.3866083313492723, "mean_inference_ms": 0.23062609697786862, "mean_action_processing_ms": 0.055967080713670736, "mean_env_wait_ms": 0.5762177908935427, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002633333206176758, "StateBufferConnector_ms": 0.0018137693405151367, "ViewRequirementAgentConnector_ms": 0.043106675148010254}}, "episode_reward_max": -6863.816864875627, "episode_reward_min": -7258.694817064271, "episode_reward_mean": -7049.8273963866495, "episode_len_mean": 1200.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-7192.935015412464, -6939.769104344216, -6964.646815398022, -7101.818584523901, -7004.560091406043, -7080.420514360684, -7003.95476470443, -7006.802229214072, -7108.819924944902, -7077.238211770432, -6958.74477233818, -6897.9347297838385, -7133.0413473706885, -7106.175846091458, -7022.508151062388, -7055.4471655907755, -7156.551730099049, -7118.253979107904, -6960.48613997543, -7059.036381330186, -7258.694817064271, -7103.609693153824, -6959.141746836437, -6978.102502571718, -7023.055259216437, -7054.420855284454, -7221.500670767508, -6996.610295665902, -6863.816864875627, -7135.441374732098, -7072.856803490325, -6977.297268978018, -7045.858383823964, -7116.76351670452, -7075.866883064482, -7004.356629016461, -7049.743980503448, -7085.78856131624, -6955.217855184973, -7065.806394386167], "episode_lengths": [1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.3866083313492723, "mean_inference_ms": 0.23062609697786862, "mean_action_processing_ms": 0.055967080713670736, "mean_env_wait_ms": 0.5762177908935427, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002633333206176758, "StateBufferConnector_ms": 0.0018137693405151367, "ViewRequirementAgentConnector_ms": 0.043106675148010254}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 48456600, "num_agent_steps_trained": 48456600, "num_env_steps_sampled": 48456600, "num_env_steps_trained": 48456600, "num_env_steps_sampled_this_iter": 4800, "num_env_steps_trained_this_iter": 4800, "num_env_steps_sampled_throughput_per_sec": 455.6734202369365, "num_env_steps_trained_throughput_per_sec": 455.6734202369365, "timesteps_total": 48456600, "num_steps_trained_this_iter": 4800, "agent_timesteps_total": 48456600, "timers": {"training_iteration_time_ms": 2635.335, "sample_time_ms": 2614.516, "load_time_ms": 0.408, "load_throughput": 2939245.971, "learn_time_ms": 19.807, "learn_throughput": 60585.794, "synch_weights_time_ms": 0.568}, "counters": {"num_env_steps_sampled": 48456600, "num_env_steps_trained": 48456600, "num_agent_steps_sampled": 48456600, "num_agent_steps_trained": 48456600}, "done": false, "episodes_total": 9957, "training_iteration": 3125, "trial_id": "4bd41_00000", "date": "2023-08-08_07-32-16", "timestamp": 1691469136, "time_this_iter_s": 10.535804748535156, "time_total_s": 83585.06698155403, "pid": 11406, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 10, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[48412200, 5e-09], [48430200, 5e-09], [48448200, 5e-09], [48466200, 2.5e-09], [48484200, 2.5e-09], [48502200, 2.5e-09], [48520200, 2.5e-09], [48538200, 1e-09], [48556200, 1e-09], [48574200, 1e-09], [48592200, 1e-09], [48610200, 1e-09], [48628200, 5e-10], [48646200, 5e-10], [48664200, 5e-10], [48682200, 5e-10], [48700200, 2.5e-10], [48718200, 2.5e-10], [48736200, 2.5e-10], [48754200, 2.5e-10], [48772200, 1e-10], [48790200, 1e-10], [48808200, 1e-10], [48826200, 5e-11], [48844200, 5e-11], [48862200, 5e-11]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.3, "final_epsilon": 0.01, "epsilon_timesteps": 48880200}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 1200, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17eb87820>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 106.85509300231934, "iterations_since_restore": 10, "perf": {"cpu_util_percent": 17.46666666666666, "ram_util_percent": 55.46000000000001}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 3.333333333333334e-09, "entropy_coeff": 0.10000000000000002, "policy_entropy": -365.3068661159939, "policy_loss": -3348700.5086805555, "vf_loss": 9825463.319444444}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 783.5, "diff_num_grad_updates_vs_sampler_policy": 782.5}}, "num_env_steps_sampled": 48461400, "num_env_steps_trained": 48461400, "num_agent_steps_sampled": 48461400, "num_agent_steps_trained": 48461400}, "sampler_results": {"episode_reward_max": -6863.816864875627, "episode_reward_min": -7258.694817064271, "episode_reward_mean": -7046.439240902045, "episode_len_mean": 1200.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-7192.935015412464, -6939.769104344216, -6964.646815398022, -7101.818584523901, -7004.560091406043, -7080.420514360684, -7003.95476470443, -7006.802229214072, -7108.819924944902, -7077.238211770432, -6958.74477233818, -6897.9347297838385, -7133.0413473706885, -7106.175846091458, -7022.508151062388, -7055.4471655907755, -7156.551730099049, -7118.253979107904, -6960.48613997543, -7059.036381330186, -7258.694817064271, -7103.609693153824, -6959.141746836437, -6978.102502571718, -7023.055259216437, -7054.420855284454, -7221.500670767508, -6996.610295665902, -6863.816864875627, -7135.441374732098, -7072.856803490325, -6977.297268978018, -7045.858383823964, -7116.76351670452, -7075.866883064482, -7004.356629016461, -7049.743980503448, -7085.78856131624, -6955.217855184973, -7065.806394386167, -6956.922071482337, -7088.209427875218, -7064.594289810642, -6940.504955055777], "episode_lengths": [1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.3870353656546697, "mean_inference_ms": 0.2306369368296397, "mean_action_processing_ms": 0.05599355151779386, "mean_env_wait_ms": 0.5705372592002569, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0026226043701171875, "StateBufferConnector_ms": 0.0018282370133833451, "ViewRequirementAgentConnector_ms": 0.04311474886807529}}, "episode_reward_max": -6863.816864875627, "episode_reward_min": -7258.694817064271, "episode_reward_mean": -7046.439240902045, "episode_len_mean": 1200.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-7192.935015412464, -6939.769104344216, -6964.646815398022, -7101.818584523901, -7004.560091406043, -7080.420514360684, -7003.95476470443, -7006.802229214072, -7108.819924944902, -7077.238211770432, -6958.74477233818, -6897.9347297838385, -7133.0413473706885, -7106.175846091458, -7022.508151062388, -7055.4471655907755, -7156.551730099049, -7118.253979107904, -6960.48613997543, -7059.036381330186, -7258.694817064271, -7103.609693153824, -6959.141746836437, -6978.102502571718, -7023.055259216437, -7054.420855284454, -7221.500670767508, -6996.610295665902, -6863.816864875627, -7135.441374732098, -7072.856803490325, -6977.297268978018, -7045.858383823964, -7116.76351670452, -7075.866883064482, -7004.356629016461, -7049.743980503448, -7085.78856131624, -6955.217855184973, -7065.806394386167, -6956.922071482337, -7088.209427875218, -7064.594289810642, -6940.504955055777], "episode_lengths": [1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.3870353656546697, "mean_inference_ms": 0.2306369368296397, "mean_action_processing_ms": 0.05599355151779386, "mean_env_wait_ms": 0.5705372592002569, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0026226043701171875, "StateBufferConnector_ms": 0.0018282370133833451, "ViewRequirementAgentConnector_ms": 0.04311474886807529}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 48461400, "num_agent_steps_trained": 48461400, "num_env_steps_sampled": 48461400, "num_env_steps_trained": 48461400, "num_env_steps_sampled_this_iter": 4800, "num_env_steps_trained_this_iter": 4800, "num_env_steps_sampled_throughput_per_sec": 454.5295712015592, "num_env_steps_trained_throughput_per_sec": 454.5295712015592, "timesteps_total": 48461400, "num_steps_trained_this_iter": 4800, "agent_timesteps_total": 48461400, "timers": {"training_iteration_time_ms": 2637.253, "sample_time_ms": 2616.263, "load_time_ms": 0.409, "load_throughput": 2935132.26, "learn_time_ms": 19.974, "learn_throughput": 60077.118, "synch_weights_time_ms": 0.569}, "counters": {"num_env_steps_sampled": 48461400, "num_env_steps_trained": 48461400, "num_agent_steps_sampled": 48461400, "num_agent_steps_trained": 48461400}, "done": false, "episodes_total": 9961, "training_iteration": 3126, "trial_id": "4bd41_00000", "date": "2023-08-08_07-32-27", "timestamp": 1691469147, "time_this_iter_s": 10.562613010406494, "time_total_s": 83595.62959456444, "pid": 11406, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 10, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[48412200, 5e-09], [48430200, 5e-09], [48448200, 5e-09], [48466200, 2.5e-09], [48484200, 2.5e-09], [48502200, 2.5e-09], [48520200, 2.5e-09], [48538200, 1e-09], [48556200, 1e-09], [48574200, 1e-09], [48592200, 1e-09], [48610200, 1e-09], [48628200, 5e-10], [48646200, 5e-10], [48664200, 5e-10], [48682200, 5e-10], [48700200, 2.5e-10], [48718200, 2.5e-10], [48736200, 2.5e-10], [48754200, 2.5e-10], [48772200, 1e-10], [48790200, 1e-10], [48808200, 1e-10], [48826200, 5e-11], [48844200, 5e-11], [48862200, 5e-11]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.3, "final_epsilon": 0.01, "epsilon_timesteps": 48880200}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 1200, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17eb87820>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 117.41770601272583, "iterations_since_restore": 11, "perf": {"cpu_util_percent": 17.88, "ram_util_percent": 55.27999999999999}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 2.666666666666666e-09, "entropy_coeff": 0.10000000000000002, "policy_entropy": -364.2976430257161, "policy_loss": -7030182.707465278, "vf_loss": 9801424.291666666}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 855.5, "diff_num_grad_updates_vs_sampler_policy": 854.5}}, "num_env_steps_sampled": 48466200, "num_env_steps_trained": 48466200, "num_agent_steps_sampled": 48466200, "num_agent_steps_trained": 48466200}, "sampler_results": {"episode_reward_max": -6863.816864875627, "episode_reward_min": -7258.694817064271, "episode_reward_mean": -7045.728399803658, "episode_len_mean": 1200.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-7192.935015412464, -6939.769104344216, -6964.646815398022, -7101.818584523901, -7004.560091406043, -7080.420514360684, -7003.95476470443, -7006.802229214072, -7108.819924944902, -7077.238211770432, -6958.74477233818, -6897.9347297838385, -7133.0413473706885, -7106.175846091458, -7022.508151062388, -7055.4471655907755, -7156.551730099049, -7118.253979107904, -6960.48613997543, -7059.036381330186, -7258.694817064271, -7103.609693153824, -6959.141746836437, -6978.102502571718, -7023.055259216437, -7054.420855284454, -7221.500670767508, -6996.610295665902, -6863.816864875627, -7135.441374732098, -7072.856803490325, -6977.297268978018, -7045.858383823964, -7116.76351670452, -7075.866883064482, -7004.356629016461, -7049.743980503448, -7085.78856131624, -6955.217855184973, -7065.806394386167, -6956.922071482337, -7088.209427875218, -7064.594289810642, -6940.504955055777, -7130.810313300896, -7082.376107966857, -7002.202110324274, -6936.2480592936245], "episode_lengths": [1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.387418097256966, "mean_inference_ms": 0.2306490829488619, "mean_action_processing_ms": 0.056017529230804934, "mean_env_wait_ms": 0.5656071533565975, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002577404181162516, "StateBufferConnector_ms": 0.0018378098805745442, "ViewRequirementAgentConnector_ms": 0.04310011863708496}}, "episode_reward_max": -6863.816864875627, "episode_reward_min": -7258.694817064271, "episode_reward_mean": -7045.728399803658, "episode_len_mean": 1200.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-7192.935015412464, -6939.769104344216, -6964.646815398022, -7101.818584523901, -7004.560091406043, -7080.420514360684, -7003.95476470443, -7006.802229214072, -7108.819924944902, -7077.238211770432, -6958.74477233818, -6897.9347297838385, -7133.0413473706885, -7106.175846091458, -7022.508151062388, -7055.4471655907755, -7156.551730099049, -7118.253979107904, -6960.48613997543, -7059.036381330186, -7258.694817064271, -7103.609693153824, -6959.141746836437, -6978.102502571718, -7023.055259216437, -7054.420855284454, -7221.500670767508, -6996.610295665902, -6863.816864875627, -7135.441374732098, -7072.856803490325, -6977.297268978018, -7045.858383823964, -7116.76351670452, -7075.866883064482, -7004.356629016461, -7049.743980503448, -7085.78856131624, -6955.217855184973, -7065.806394386167, -6956.922071482337, -7088.209427875218, -7064.594289810642, -6940.504955055777, -7130.810313300896, -7082.376107966857, -7002.202110324274, -6936.2480592936245], "episode_lengths": [1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.387418097256966, "mean_inference_ms": 0.2306490829488619, "mean_action_processing_ms": 0.056017529230804934, "mean_env_wait_ms": 0.5656071533565975, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002577404181162516, "StateBufferConnector_ms": 0.0018378098805745442, "ViewRequirementAgentConnector_ms": 0.04310011863708496}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 48466200, "num_agent_steps_trained": 48466200, "num_env_steps_sampled": 48466200, "num_env_steps_trained": 48466200, "num_env_steps_sampled_this_iter": 4800, "num_env_steps_trained_this_iter": 4800, "num_env_steps_sampled_throughput_per_sec": 454.6528281971275, "num_env_steps_trained_throughput_per_sec": 454.6528281971275, "timesteps_total": 48466200, "num_steps_trained_this_iter": 4800, "agent_timesteps_total": 48466200, "timers": {"training_iteration_time_ms": 2637.511, "sample_time_ms": 2616.642, "load_time_ms": 0.408, "load_throughput": 2942682.881, "learn_time_ms": 19.866, "learn_throughput": 60405.178, "synch_weights_time_ms": 0.559}, "counters": {"num_env_steps_sampled": 48466200, "num_env_steps_trained": 48466200, "num_agent_steps_sampled": 48466200, "num_agent_steps_trained": 48466200}, "done": false, "episodes_total": 9965, "training_iteration": 3127, "trial_id": "4bd41_00000", "date": "2023-08-08_07-32-37", "timestamp": 1691469157, "time_this_iter_s": 10.559514045715332, "time_total_s": 83606.18910861015, "pid": 11406, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 10, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[48412200, 5e-09], [48430200, 5e-09], [48448200, 5e-09], [48466200, 2.5e-09], [48484200, 2.5e-09], [48502200, 2.5e-09], [48520200, 2.5e-09], [48538200, 1e-09], [48556200, 1e-09], [48574200, 1e-09], [48592200, 1e-09], [48610200, 1e-09], [48628200, 5e-10], [48646200, 5e-10], [48664200, 5e-10], [48682200, 5e-10], [48700200, 2.5e-10], [48718200, 2.5e-10], [48736200, 2.5e-10], [48754200, 2.5e-10], [48772200, 1e-10], [48790200, 1e-10], [48808200, 1e-10], [48826200, 5e-11], [48844200, 5e-11], [48862200, 5e-11]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.3, "final_epsilon": 0.01, "epsilon_timesteps": 48880200}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 1200, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17eb87820>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 127.97722005844116, "iterations_since_restore": 12, "perf": {"cpu_util_percent": 19.42, "ram_util_percent": 55.466666666666676}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 2.5000000000000005e-09, "entropy_coeff": 0.10000000000000002, "policy_entropy": -363.4954071044922, "policy_loss": -9440106.667534722, "vf_loss": 10106697.347222222}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 927.5, "diff_num_grad_updates_vs_sampler_policy": 926.5}}, "num_env_steps_sampled": 48471000, "num_env_steps_trained": 48471000, "num_agent_steps_sampled": 48471000, "num_agent_steps_trained": 48471000}, "sampler_results": {"episode_reward_max": -6863.816864875627, "episode_reward_min": -7258.694817064271, "episode_reward_mean": -7047.184180207741, "episode_len_mean": 1200.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-7192.935015412464, -6939.769104344216, -6964.646815398022, -7101.818584523901, -7004.560091406043, -7080.420514360684, -7003.95476470443, -7006.802229214072, -7108.819924944902, -7077.238211770432, -6958.74477233818, -6897.9347297838385, -7133.0413473706885, -7106.175846091458, -7022.508151062388, -7055.4471655907755, -7156.551730099049, -7118.253979107904, -6960.48613997543, -7059.036381330186, -7258.694817064271, -7103.609693153824, -6959.141746836437, -6978.102502571718, -7023.055259216437, -7054.420855284454, -7221.500670767508, -6996.610295665902, -6863.816864875627, -7135.441374732098, -7072.856803490325, -6977.297268978018, -7045.858383823964, -7116.76351670452, -7075.866883064482, -7004.356629016461, -7049.743980503448, -7085.78856131624, -6955.217855184973, -7065.806394386167, -6956.922071482337, -7088.209427875218, -7064.594289810642, -6940.504955055777, -7130.810313300896, -7082.376107966857, -7002.202110324274, -6936.2480592936245, -7100.72250874128, -7021.215123461855, -7078.492281506492, -7058.18426651735], "episode_lengths": [1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.3877466001080214, "mean_inference_ms": 0.2306615978498046, "mean_action_processing_ms": 0.056038927283794324, "mean_env_wait_ms": 0.561318157643394, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0025377823756291317, "StateBufferConnector_ms": 0.0018390325399545522, "ViewRequirementAgentConnector_ms": 0.0430909486917349}}, "episode_reward_max": -6863.816864875627, "episode_reward_min": -7258.694817064271, "episode_reward_mean": -7047.184180207741, "episode_len_mean": 1200.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-7192.935015412464, -6939.769104344216, -6964.646815398022, -7101.818584523901, -7004.560091406043, -7080.420514360684, -7003.95476470443, -7006.802229214072, -7108.819924944902, -7077.238211770432, -6958.74477233818, -6897.9347297838385, -7133.0413473706885, -7106.175846091458, -7022.508151062388, -7055.4471655907755, -7156.551730099049, -7118.253979107904, -6960.48613997543, -7059.036381330186, -7258.694817064271, -7103.609693153824, -6959.141746836437, -6978.102502571718, -7023.055259216437, -7054.420855284454, -7221.500670767508, -6996.610295665902, -6863.816864875627, -7135.441374732098, -7072.856803490325, -6977.297268978018, -7045.858383823964, -7116.76351670452, -7075.866883064482, -7004.356629016461, -7049.743980503448, -7085.78856131624, -6955.217855184973, -7065.806394386167, -6956.922071482337, -7088.209427875218, -7064.594289810642, -6940.504955055777, -7130.810313300896, -7082.376107966857, -7002.202110324274, -6936.2480592936245, -7100.72250874128, -7021.215123461855, -7078.492281506492, -7058.18426651735], "episode_lengths": [1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.3877466001080214, "mean_inference_ms": 0.2306615978498046, "mean_action_processing_ms": 0.056038927283794324, "mean_env_wait_ms": 0.561318157643394, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0025377823756291317, "StateBufferConnector_ms": 0.0018390325399545522, "ViewRequirementAgentConnector_ms": 0.0430909486917349}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 48471000, "num_agent_steps_trained": 48471000, "num_env_steps_sampled": 48471000, "num_env_steps_trained": 48471000, "num_env_steps_sampled_this_iter": 4800, "num_env_steps_trained_this_iter": 4800, "num_env_steps_sampled_throughput_per_sec": 453.9849335695577, "num_env_steps_trained_throughput_per_sec": 453.9849335695577, "timesteps_total": 48471000, "num_steps_trained_this_iter": 4800, "agent_timesteps_total": 48471000, "timers": {"training_iteration_time_ms": 2640.582, "sample_time_ms": 2619.833, "load_time_ms": 0.402, "load_throughput": 2982086.029, "learn_time_ms": 19.756, "learn_throughput": 60741.752, "synch_weights_time_ms": 0.554}, "counters": {"num_env_steps_sampled": 48471000, "num_env_steps_trained": 48471000, "num_agent_steps_sampled": 48471000, "num_agent_steps_trained": 48471000}, "done": false, "episodes_total": 9969, "training_iteration": 3128, "trial_id": "4bd41_00000", "date": "2023-08-08_07-32-48", "timestamp": 1691469168, "time_this_iter_s": 10.574957847595215, "time_total_s": 83616.76406645775, "pid": 11406, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 10, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[48412200, 5e-09], [48430200, 5e-09], [48448200, 5e-09], [48466200, 2.5e-09], [48484200, 2.5e-09], [48502200, 2.5e-09], [48520200, 2.5e-09], [48538200, 1e-09], [48556200, 1e-09], [48574200, 1e-09], [48592200, 1e-09], [48610200, 1e-09], [48628200, 5e-10], [48646200, 5e-10], [48664200, 5e-10], [48682200, 5e-10], [48700200, 2.5e-10], [48718200, 2.5e-10], [48736200, 2.5e-10], [48754200, 2.5e-10], [48772200, 1e-10], [48790200, 1e-10], [48808200, 1e-10], [48826200, 5e-11], [48844200, 5e-11], [48862200, 5e-11]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.3, "final_epsilon": 0.01, "epsilon_timesteps": 48880200}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 1200, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17eb87820>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 138.55217790603638, "iterations_since_restore": 13, "perf": {"cpu_util_percent": 18.013333333333332, "ram_util_percent": 55.586666666666666}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 2.5000000000000005e-09, "entropy_coeff": 0.10000000000000002, "policy_entropy": -363.43928866916235, "policy_loss": -3471231.870659722, "vf_loss": 9900409.208333334}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 999.5, "diff_num_grad_updates_vs_sampler_policy": 998.5}}, "num_env_steps_sampled": 48475800, "num_env_steps_trained": 48475800, "num_agent_steps_sampled": 48475800, "num_agent_steps_trained": 48475800}, "sampler_results": {"episode_reward_max": -6863.816864875627, "episode_reward_min": -7258.694817064271, "episode_reward_mean": -7048.014927235617, "episode_len_mean": 1200.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-7192.935015412464, -6939.769104344216, -6964.646815398022, -7101.818584523901, -7004.560091406043, -7080.420514360684, -7003.95476470443, -7006.802229214072, -7108.819924944902, -7077.238211770432, -6958.74477233818, -6897.9347297838385, -7133.0413473706885, -7106.175846091458, -7022.508151062388, -7055.4471655907755, -7156.551730099049, -7118.253979107904, -6960.48613997543, -7059.036381330186, -7258.694817064271, -7103.609693153824, -6959.141746836437, -6978.102502571718, -7023.055259216437, -7054.420855284454, -7221.500670767508, -6996.610295665902, -6863.816864875627, -7135.441374732098, -7072.856803490325, -6977.297268978018, -7045.858383823964, -7116.76351670452, -7075.866883064482, -7004.356629016461, -7049.743980503448, -7085.78856131624, -6955.217855184973, -7065.806394386167, -6956.922071482337, -7088.209427875218, -7064.594289810642, -6940.504955055777, -7130.810313300896, -7082.376107966857, -7002.202110324274, -6936.2480592936245, -7100.72250874128, -7021.215123461855, -7078.492281506492, -7058.18426651735, -7165.856608548078, -7091.593360217844, -6982.041884454672, -6995.766701171402], "episode_lengths": [1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.3880540894541926, "mean_inference_ms": 0.2306733462204605, "mean_action_processing_ms": 0.05605860569924528, "mean_env_wait_ms": 0.5575054986824762, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0025106327874319895, "StateBufferConnector_ms": 0.0018413577760968889, "ViewRequirementAgentConnector_ms": 0.043082237243652344}}, "episode_reward_max": -6863.816864875627, "episode_reward_min": -7258.694817064271, "episode_reward_mean": -7048.014927235617, "episode_len_mean": 1200.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-7192.935015412464, -6939.769104344216, -6964.646815398022, -7101.818584523901, -7004.560091406043, -7080.420514360684, -7003.95476470443, -7006.802229214072, -7108.819924944902, -7077.238211770432, -6958.74477233818, -6897.9347297838385, -7133.0413473706885, -7106.175846091458, -7022.508151062388, -7055.4471655907755, -7156.551730099049, -7118.253979107904, -6960.48613997543, -7059.036381330186, -7258.694817064271, -7103.609693153824, -6959.141746836437, -6978.102502571718, -7023.055259216437, -7054.420855284454, -7221.500670767508, -6996.610295665902, -6863.816864875627, -7135.441374732098, -7072.856803490325, -6977.297268978018, -7045.858383823964, -7116.76351670452, -7075.866883064482, -7004.356629016461, -7049.743980503448, -7085.78856131624, -6955.217855184973, -7065.806394386167, -6956.922071482337, -7088.209427875218, -7064.594289810642, -6940.504955055777, -7130.810313300896, -7082.376107966857, -7002.202110324274, -6936.2480592936245, -7100.72250874128, -7021.215123461855, -7078.492281506492, -7058.18426651735, -7165.856608548078, -7091.593360217844, -6982.041884454672, -6995.766701171402], "episode_lengths": [1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.3880540894541926, "mean_inference_ms": 0.2306733462204605, "mean_action_processing_ms": 0.05605860569924528, "mean_env_wait_ms": 0.5575054986824762, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0025106327874319895, "StateBufferConnector_ms": 0.0018413577760968889, "ViewRequirementAgentConnector_ms": 0.043082237243652344}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 48475800, "num_agent_steps_trained": 48475800, "num_env_steps_sampled": 48475800, "num_env_steps_trained": 48475800, "num_env_steps_sampled_this_iter": 4800, "num_env_steps_trained_this_iter": 4800, "num_env_steps_sampled_throughput_per_sec": 454.7980858172635, "num_env_steps_trained_throughput_per_sec": 454.7980858172635, "timesteps_total": 48475800, "num_steps_trained_this_iter": 4800, "agent_timesteps_total": 48475800, "timers": {"training_iteration_time_ms": 2638.864, "sample_time_ms": 2618.12, "load_time_ms": 0.403, "load_throughput": 2975562.991, "learn_time_ms": 19.75, "learn_throughput": 60758.176, "synch_weights_time_ms": 0.553}, "counters": {"num_env_steps_sampled": 48475800, "num_env_steps_trained": 48475800, "num_agent_steps_sampled": 48475800, "num_agent_steps_trained": 48475800}, "done": false, "episodes_total": 9973, "training_iteration": 3129, "trial_id": "4bd41_00000", "date": "2023-08-08_07-32-59", "timestamp": 1691469179, "time_this_iter_s": 10.556254863739014, "time_total_s": 83627.32032132149, "pid": 11406, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 10, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[48412200, 5e-09], [48430200, 5e-09], [48448200, 5e-09], [48466200, 2.5e-09], [48484200, 2.5e-09], [48502200, 2.5e-09], [48520200, 2.5e-09], [48538200, 1e-09], [48556200, 1e-09], [48574200, 1e-09], [48592200, 1e-09], [48610200, 1e-09], [48628200, 5e-10], [48646200, 5e-10], [48664200, 5e-10], [48682200, 5e-10], [48700200, 2.5e-10], [48718200, 2.5e-10], [48736200, 2.5e-10], [48754200, 2.5e-10], [48772200, 1e-10], [48790200, 1e-10], [48808200, 1e-10], [48826200, 5e-11], [48844200, 5e-11], [48862200, 5e-11]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.3, "final_epsilon": 0.01, "epsilon_timesteps": 48880200}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 1200, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17eb87820>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 149.1084327697754, "iterations_since_restore": 14, "perf": {"cpu_util_percent": 17.040000000000003, "ram_util_percent": 55.59333333333334}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 2.5000000000000005e-09, "entropy_coeff": 0.10000000000000002, "policy_entropy": -365.9546067979601, "policy_loss": -4623294.287326389, "vf_loss": 9714662.916666666}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 1071.5, "diff_num_grad_updates_vs_sampler_policy": 1070.5}}, "num_env_steps_sampled": 48480600, "num_env_steps_trained": 48480600, "num_agent_steps_sampled": 48480600, "num_agent_steps_trained": 48480600}, "sampler_results": {"episode_reward_max": -6863.816864875627, "episode_reward_min": -7258.694817064271, "episode_reward_mean": -7043.159031274705, "episode_len_mean": 1200.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-7192.935015412464, -6939.769104344216, -6964.646815398022, -7101.818584523901, -7004.560091406043, -7080.420514360684, -7003.95476470443, -7006.802229214072, -7108.819924944902, -7077.238211770432, -6958.74477233818, -6897.9347297838385, -7133.0413473706885, -7106.175846091458, -7022.508151062388, -7055.4471655907755, -7156.551730099049, -7118.253979107904, -6960.48613997543, -7059.036381330186, -7258.694817064271, -7103.609693153824, -6959.141746836437, -6978.102502571718, -7023.055259216437, -7054.420855284454, -7221.500670767508, -6996.610295665902, -6863.816864875627, -7135.441374732098, -7072.856803490325, -6977.297268978018, -7045.858383823964, -7116.76351670452, -7075.866883064482, -7004.356629016461, -7049.743980503448, -7085.78856131624, -6955.217855184973, -7065.806394386167, -6956.922071482337, -7088.209427875218, -7064.594289810642, -6940.504955055777, -7130.810313300896, -7082.376107966857, -7002.202110324274, -6936.2480592936245, -7100.72250874128, -7021.215123461855, -7078.492281506492, -7058.18426651735, -7165.856608548078, -7091.593360217844, -6982.041884454672, -6995.766701171402, -7005.125250829107, -6998.122880892173, -6999.881975986087, -6897.575843580419], "episode_lengths": [1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.3883223039961679, "mean_inference_ms": 0.23068234937616208, "mean_action_processing_ms": 0.0560758995958711, "mean_env_wait_ms": 0.5540559051595767, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0024863084157307944, "StateBufferConnector_ms": 0.001844167709350586, "ViewRequirementAgentConnector_ms": 0.043146610260009766}}, "episode_reward_max": -6863.816864875627, "episode_reward_min": -7258.694817064271, "episode_reward_mean": -7043.159031274705, "episode_len_mean": 1200.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-7192.935015412464, -6939.769104344216, -6964.646815398022, -7101.818584523901, -7004.560091406043, -7080.420514360684, -7003.95476470443, -7006.802229214072, -7108.819924944902, -7077.238211770432, -6958.74477233818, -6897.9347297838385, -7133.0413473706885, -7106.175846091458, -7022.508151062388, -7055.4471655907755, -7156.551730099049, -7118.253979107904, -6960.48613997543, -7059.036381330186, -7258.694817064271, -7103.609693153824, -6959.141746836437, -6978.102502571718, -7023.055259216437, -7054.420855284454, -7221.500670767508, -6996.610295665902, -6863.816864875627, -7135.441374732098, -7072.856803490325, -6977.297268978018, -7045.858383823964, -7116.76351670452, -7075.866883064482, -7004.356629016461, -7049.743980503448, -7085.78856131624, -6955.217855184973, -7065.806394386167, -6956.922071482337, -7088.209427875218, -7064.594289810642, -6940.504955055777, -7130.810313300896, -7082.376107966857, -7002.202110324274, -6936.2480592936245, -7100.72250874128, -7021.215123461855, -7078.492281506492, -7058.18426651735, -7165.856608548078, -7091.593360217844, -6982.041884454672, -6995.766701171402, -7005.125250829107, -6998.122880892173, -6999.881975986087, -6897.575843580419], "episode_lengths": [1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.3883223039961679, "mean_inference_ms": 0.23068234937616208, "mean_action_processing_ms": 0.0560758995958711, "mean_env_wait_ms": 0.5540559051595767, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0024863084157307944, "StateBufferConnector_ms": 0.001844167709350586, "ViewRequirementAgentConnector_ms": 0.043146610260009766}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 48480600, "num_agent_steps_trained": 48480600, "num_env_steps_sampled": 48480600, "num_env_steps_trained": 48480600, "num_env_steps_sampled_this_iter": 4800, "num_env_steps_trained_this_iter": 4800, "num_env_steps_sampled_throughput_per_sec": 457.42860336092684, "num_env_steps_trained_throughput_per_sec": 457.42860336092684, "timesteps_total": 48480600, "num_steps_trained_this_iter": 4800, "agent_timesteps_total": 48480600, "timers": {"training_iteration_time_ms": 2633.43, "sample_time_ms": 2612.564, "load_time_ms": 0.407, "load_throughput": 2949753.736, "learn_time_ms": 19.859, "learn_throughput": 60427.369, "synch_weights_time_ms": 0.564}, "counters": {"num_env_steps_sampled": 48480600, "num_env_steps_trained": 48480600, "num_agent_steps_sampled": 48480600, "num_agent_steps_trained": 48480600}, "done": false, "episodes_total": 9977, "training_iteration": 3130, "trial_id": "4bd41_00000", "date": "2023-08-08_07-33-09", "timestamp": 1691469189, "time_this_iter_s": 10.495402097702026, "time_total_s": 83637.81572341919, "pid": 11406, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 10, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[48412200, 5e-09], [48430200, 5e-09], [48448200, 5e-09], [48466200, 2.5e-09], [48484200, 2.5e-09], [48502200, 2.5e-09], [48520200, 2.5e-09], [48538200, 1e-09], [48556200, 1e-09], [48574200, 1e-09], [48592200, 1e-09], [48610200, 1e-09], [48628200, 5e-10], [48646200, 5e-10], [48664200, 5e-10], [48682200, 5e-10], [48700200, 2.5e-10], [48718200, 2.5e-10], [48736200, 2.5e-10], [48754200, 2.5e-10], [48772200, 1e-10], [48790200, 1e-10], [48808200, 1e-10], [48826200, 5e-11], [48844200, 5e-11], [48862200, 5e-11]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.3, "final_epsilon": 0.01, "epsilon_timesteps": 48880200}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 1200, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17eb87820>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 159.60383486747742, "iterations_since_restore": 15, "perf": {"cpu_util_percent": 17.013333333333332, "ram_util_percent": 55.58666666666667}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 2.5000000000000005e-09, "entropy_coeff": 0.10000000000000002, "policy_entropy": -366.9978332519531, "policy_loss": -547071.5724826389, "vf_loss": 9523617.708333334}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 1143.5, "diff_num_grad_updates_vs_sampler_policy": 1142.5}}, "num_env_steps_sampled": 48485400, "num_env_steps_trained": 48485400, "num_agent_steps_sampled": 48485400, "num_agent_steps_trained": 48485400}, "sampler_results": {"episode_reward_max": -6833.375325217441, "episode_reward_min": -7258.694817064271, "episode_reward_mean": -7037.887531601688, "episode_len_mean": 1200.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-7192.935015412464, -6939.769104344216, -6964.646815398022, -7101.818584523901, -7004.560091406043, -7080.420514360684, -7003.95476470443, -7006.802229214072, -7108.819924944902, -7077.238211770432, -6958.74477233818, -6897.9347297838385, -7133.0413473706885, -7106.175846091458, -7022.508151062388, -7055.4471655907755, -7156.551730099049, -7118.253979107904, -6960.48613997543, -7059.036381330186, -7258.694817064271, -7103.609693153824, -6959.141746836437, -6978.102502571718, -7023.055259216437, -7054.420855284454, -7221.500670767508, -6996.610295665902, -6863.816864875627, -7135.441374732098, -7072.856803490325, -6977.297268978018, -7045.858383823964, -7116.76351670452, -7075.866883064482, -7004.356629016461, -7049.743980503448, -7085.78856131624, -6955.217855184973, -7065.806394386167, -6956.922071482337, -7088.209427875218, -7064.594289810642, -6940.504955055777, -7130.810313300896, -7082.376107966857, -7002.202110324274, -6936.2480592936245, -7100.72250874128, -7021.215123461855, -7078.492281506492, -7058.18426651735, -7165.856608548078, -7091.593360217844, -6982.041884454672, -6995.766701171402, -7005.125250829107, -6998.122880892173, -6999.881975986087, -6897.575843580419, -6999.032029919281, -6927.287035903237, -7075.565754985772, -6833.375325217441], "episode_lengths": [1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.3885636362297522, "mean_inference_ms": 0.2306901334770688, "mean_action_processing_ms": 0.05609136035556784, "mean_env_wait_ms": 0.5508984043137679, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0024825334548950195, "StateBufferConnector_ms": 0.0018328428268432617, "ViewRequirementAgentConnector_ms": 0.04312284290790558}}, "episode_reward_max": -6833.375325217441, "episode_reward_min": -7258.694817064271, "episode_reward_mean": -7037.887531601688, "episode_len_mean": 1200.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-7192.935015412464, -6939.769104344216, -6964.646815398022, -7101.818584523901, -7004.560091406043, -7080.420514360684, -7003.95476470443, -7006.802229214072, -7108.819924944902, -7077.238211770432, -6958.74477233818, -6897.9347297838385, -7133.0413473706885, -7106.175846091458, -7022.508151062388, -7055.4471655907755, -7156.551730099049, -7118.253979107904, -6960.48613997543, -7059.036381330186, -7258.694817064271, -7103.609693153824, -6959.141746836437, -6978.102502571718, -7023.055259216437, -7054.420855284454, -7221.500670767508, -6996.610295665902, -6863.816864875627, -7135.441374732098, -7072.856803490325, -6977.297268978018, -7045.858383823964, -7116.76351670452, -7075.866883064482, -7004.356629016461, -7049.743980503448, -7085.78856131624, -6955.217855184973, -7065.806394386167, -6956.922071482337, -7088.209427875218, -7064.594289810642, -6940.504955055777, -7130.810313300896, -7082.376107966857, -7002.202110324274, -6936.2480592936245, -7100.72250874128, -7021.215123461855, -7078.492281506492, -7058.18426651735, -7165.856608548078, -7091.593360217844, -6982.041884454672, -6995.766701171402, -7005.125250829107, -6998.122880892173, -6999.881975986087, -6897.575843580419, -6999.032029919281, -6927.287035903237, -7075.565754985772, -6833.375325217441], "episode_lengths": [1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.3885636362297522, "mean_inference_ms": 0.2306901334770688, "mean_action_processing_ms": 0.05609136035556784, "mean_env_wait_ms": 0.5508984043137679, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0024825334548950195, "StateBufferConnector_ms": 0.0018328428268432617, "ViewRequirementAgentConnector_ms": 0.04312284290790558}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 48485400, "num_agent_steps_trained": 48485400, "num_env_steps_sampled": 48485400, "num_env_steps_trained": 48485400, "num_env_steps_sampled_this_iter": 4800, "num_env_steps_trained_this_iter": 4800, "num_env_steps_sampled_throughput_per_sec": 458.23633495769894, "num_env_steps_trained_throughput_per_sec": 458.23633495769894, "timesteps_total": 48485400, "num_steps_trained_this_iter": 4800, "agent_timesteps_total": 48485400, "timers": {"training_iteration_time_ms": 2622.711, "sample_time_ms": 2601.952, "load_time_ms": 0.408, "load_throughput": 2942510.845, "learn_time_ms": 19.75, "learn_throughput": 60760.817, "synch_weights_time_ms": 0.564}, "counters": {"num_env_steps_sampled": 48485400, "num_env_steps_trained": 48485400, "num_agent_steps_sampled": 48485400, "num_agent_steps_trained": 48485400}, "done": false, "episodes_total": 9981, "training_iteration": 3131, "trial_id": "4bd41_00000", "date": "2023-08-08_07-33-20", "timestamp": 1691469200, "time_this_iter_s": 10.476936101913452, "time_total_s": 83648.2926595211, "pid": 11406, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 10, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[48412200, 5e-09], [48430200, 5e-09], [48448200, 5e-09], [48466200, 2.5e-09], [48484200, 2.5e-09], [48502200, 2.5e-09], [48520200, 2.5e-09], [48538200, 1e-09], [48556200, 1e-09], [48574200, 1e-09], [48592200, 1e-09], [48610200, 1e-09], [48628200, 5e-10], [48646200, 5e-10], [48664200, 5e-10], [48682200, 5e-10], [48700200, 2.5e-10], [48718200, 2.5e-10], [48736200, 2.5e-10], [48754200, 2.5e-10], [48772200, 1e-10], [48790200, 1e-10], [48808200, 1e-10], [48826200, 5e-11], [48844200, 5e-11], [48862200, 5e-11]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.3, "final_epsilon": 0.01, "epsilon_timesteps": 48880200}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 1200, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17eb87820>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 170.08077096939087, "iterations_since_restore": 16, "perf": {"cpu_util_percent": 18.160000000000004, "ram_util_percent": 55.440000000000005}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 2.5000000000000005e-09, "entropy_coeff": 0.10000000000000002, "policy_entropy": -362.56964280870227, "policy_loss": -5685900.782118056, "vf_loss": 10133073.805555556}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 1215.5, "diff_num_grad_updates_vs_sampler_policy": 1214.5}}, "num_env_steps_sampled": 48490200, "num_env_steps_trained": 48490200, "num_agent_steps_sampled": 48490200, "num_agent_steps_trained": 48490200}, "sampler_results": {"episode_reward_max": -6833.375325217441, "episode_reward_min": -7258.694817064271, "episode_reward_mean": -7042.9780589656375, "episode_len_mean": 1200.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-7192.935015412464, -6939.769104344216, -6964.646815398022, -7101.818584523901, -7004.560091406043, -7080.420514360684, -7003.95476470443, -7006.802229214072, -7108.819924944902, -7077.238211770432, -6958.74477233818, -6897.9347297838385, -7133.0413473706885, -7106.175846091458, -7022.508151062388, -7055.4471655907755, -7156.551730099049, -7118.253979107904, -6960.48613997543, -7059.036381330186, -7258.694817064271, -7103.609693153824, -6959.141746836437, -6978.102502571718, -7023.055259216437, -7054.420855284454, -7221.500670767508, -6996.610295665902, -6863.816864875627, -7135.441374732098, -7072.856803490325, -6977.297268978018, -7045.858383823964, -7116.76351670452, -7075.866883064482, -7004.356629016461, -7049.743980503448, -7085.78856131624, -6955.217855184973, -7065.806394386167, -6956.922071482337, -7088.209427875218, -7064.594289810642, -6940.504955055777, -7130.810313300896, -7082.376107966857, -7002.202110324274, -6936.2480592936245, -7100.72250874128, -7021.215123461855, -7078.492281506492, -7058.18426651735, -7165.856608548078, -7091.593360217844, -6982.041884454672, -6995.766701171402, -7005.125250829107, -6998.122880892173, -6999.881975986087, -6897.575843580419, -6999.032029919281, -6927.287035903237, -7075.565754985772, -6833.375325217441, -7113.299728443704, -7152.451555348877, -7176.19230452039, -7055.762398842322], "episode_lengths": [1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.3887888993286044, "mean_inference_ms": 0.23069994580890127, "mean_action_processing_ms": 0.05610606929199497, "mean_env_wait_ms": 0.5481119810068582, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0024683335248161763, "StateBufferConnector_ms": 0.0018302132101619944, "ViewRequirementAgentConnector_ms": 0.04307206939248478}}, "episode_reward_max": -6833.375325217441, "episode_reward_min": -7258.694817064271, "episode_reward_mean": -7042.9780589656375, "episode_len_mean": 1200.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-7192.935015412464, -6939.769104344216, -6964.646815398022, -7101.818584523901, -7004.560091406043, -7080.420514360684, -7003.95476470443, -7006.802229214072, -7108.819924944902, -7077.238211770432, -6958.74477233818, -6897.9347297838385, -7133.0413473706885, -7106.175846091458, -7022.508151062388, -7055.4471655907755, -7156.551730099049, -7118.253979107904, -6960.48613997543, -7059.036381330186, -7258.694817064271, -7103.609693153824, -6959.141746836437, -6978.102502571718, -7023.055259216437, -7054.420855284454, -7221.500670767508, -6996.610295665902, -6863.816864875627, -7135.441374732098, -7072.856803490325, -6977.297268978018, -7045.858383823964, -7116.76351670452, -7075.866883064482, -7004.356629016461, -7049.743980503448, -7085.78856131624, -6955.217855184973, -7065.806394386167, -6956.922071482337, -7088.209427875218, -7064.594289810642, -6940.504955055777, -7130.810313300896, -7082.376107966857, -7002.202110324274, -6936.2480592936245, -7100.72250874128, -7021.215123461855, -7078.492281506492, -7058.18426651735, -7165.856608548078, -7091.593360217844, -6982.041884454672, -6995.766701171402, -7005.125250829107, -6998.122880892173, -6999.881975986087, -6897.575843580419, -6999.032029919281, -6927.287035903237, -7075.565754985772, -6833.375325217441, -7113.299728443704, -7152.451555348877, -7176.19230452039, -7055.762398842322], "episode_lengths": [1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.3887888993286044, "mean_inference_ms": 0.23069994580890127, "mean_action_processing_ms": 0.05610606929199497, "mean_env_wait_ms": 0.5481119810068582, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0024683335248161763, "StateBufferConnector_ms": 0.0018302132101619944, "ViewRequirementAgentConnector_ms": 0.04307206939248478}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 48490200, "num_agent_steps_trained": 48490200, "num_env_steps_sampled": 48490200, "num_env_steps_trained": 48490200, "num_env_steps_sampled_this_iter": 4800, "num_env_steps_trained_this_iter": 4800, "num_env_steps_sampled_throughput_per_sec": 450.74426115802913, "num_env_steps_trained_throughput_per_sec": 450.74426115802913, "timesteps_total": 48490200, "num_steps_trained_this_iter": 4800, "agent_timesteps_total": 48490200, "timers": {"training_iteration_time_ms": 2636.317, "sample_time_ms": 2615.539, "load_time_ms": 0.409, "load_throughput": 2931200.745, "learn_time_ms": 19.753, "learn_throughput": 60749.01, "synch_weights_time_ms": 0.577}, "counters": {"num_env_steps_sampled": 48490200, "num_env_steps_trained": 48490200, "num_agent_steps_sampled": 48490200, "num_agent_steps_trained": 48490200}, "done": false, "episodes_total": 9985, "training_iteration": 3132, "trial_id": "4bd41_00000", "date": "2023-08-08_07-33-30", "timestamp": 1691469210, "time_this_iter_s": 10.651026248931885, "time_total_s": 83658.94368577003, "pid": 11406, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 10, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[48412200, 5e-09], [48430200, 5e-09], [48448200, 5e-09], [48466200, 2.5e-09], [48484200, 2.5e-09], [48502200, 2.5e-09], [48520200, 2.5e-09], [48538200, 1e-09], [48556200, 1e-09], [48574200, 1e-09], [48592200, 1e-09], [48610200, 1e-09], [48628200, 5e-10], [48646200, 5e-10], [48664200, 5e-10], [48682200, 5e-10], [48700200, 2.5e-10], [48718200, 2.5e-10], [48736200, 2.5e-10], [48754200, 2.5e-10], [48772200, 1e-10], [48790200, 1e-10], [48808200, 1e-10], [48826200, 5e-11], [48844200, 5e-11], [48862200, 5e-11]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.3, "final_epsilon": 0.01, "epsilon_timesteps": 48880200}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 1200, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17eb87820>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 180.73179721832275, "iterations_since_restore": 17, "perf": {"cpu_util_percent": 16.793333333333333, "ram_util_percent": 55.313333333333325}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 2.5000000000000005e-09, "entropy_coeff": 0.10000000000000002, "policy_entropy": -367.57677374945746, "policy_loss": -6740935.184027778, "vf_loss": 10254565.944444444}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 1287.5, "diff_num_grad_updates_vs_sampler_policy": 1286.5}}, "num_env_steps_sampled": 48495000, "num_env_steps_trained": 48495000, "num_agent_steps_sampled": 48495000, "num_agent_steps_trained": 48495000}, "sampler_results": {"episode_reward_max": -6833.375325217441, "episode_reward_min": -7258.694817064271, "episode_reward_mean": -7042.318157215077, "episode_len_mean": 1200.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-7192.935015412464, -6939.769104344216, -6964.646815398022, -7101.818584523901, -7004.560091406043, -7080.420514360684, -7003.95476470443, -7006.802229214072, -7108.819924944902, -7077.238211770432, -6958.74477233818, -6897.9347297838385, -7133.0413473706885, -7106.175846091458, -7022.508151062388, -7055.4471655907755, -7156.551730099049, -7118.253979107904, -6960.48613997543, -7059.036381330186, -7258.694817064271, -7103.609693153824, -6959.141746836437, -6978.102502571718, -7023.055259216437, -7054.420855284454, -7221.500670767508, -6996.610295665902, -6863.816864875627, -7135.441374732098, -7072.856803490325, -6977.297268978018, -7045.858383823964, -7116.76351670452, -7075.866883064482, -7004.356629016461, -7049.743980503448, -7085.78856131624, -6955.217855184973, -7065.806394386167, -6956.922071482337, -7088.209427875218, -7064.594289810642, -6940.504955055777, -7130.810313300896, -7082.376107966857, -7002.202110324274, -6936.2480592936245, -7100.72250874128, -7021.215123461855, -7078.492281506492, -7058.18426651735, -7165.856608548078, -7091.593360217844, -6982.041884454672, -6995.766701171402, -7005.125250829107, -6998.122880892173, -6999.881975986087, -6897.575843580419, -6999.032029919281, -6927.287035903237, -7075.565754985772, -6833.375325217441, -7113.299728443704, -7152.451555348877, -7176.19230452039, -7055.762398842322, -6962.554228305463, -6994.231144372555, -7093.922080242668, -7073.69185690152], "episode_lengths": [1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.3890005943948793, "mean_inference_ms": 0.230709745725996, "mean_action_processing_ms": 0.056119645284830044, "mean_env_wait_ms": 0.5455840561922702, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002447101804945204, "StateBufferConnector_ms": 0.001838472154405382, "ViewRequirementAgentConnector_ms": 0.043081574969821505}}, "episode_reward_max": -6833.375325217441, "episode_reward_min": -7258.694817064271, "episode_reward_mean": -7042.318157215077, "episode_len_mean": 1200.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-7192.935015412464, -6939.769104344216, -6964.646815398022, -7101.818584523901, -7004.560091406043, -7080.420514360684, -7003.95476470443, -7006.802229214072, -7108.819924944902, -7077.238211770432, -6958.74477233818, -6897.9347297838385, -7133.0413473706885, -7106.175846091458, -7022.508151062388, -7055.4471655907755, -7156.551730099049, -7118.253979107904, -6960.48613997543, -7059.036381330186, -7258.694817064271, -7103.609693153824, -6959.141746836437, -6978.102502571718, -7023.055259216437, -7054.420855284454, -7221.500670767508, -6996.610295665902, -6863.816864875627, -7135.441374732098, -7072.856803490325, -6977.297268978018, -7045.858383823964, -7116.76351670452, -7075.866883064482, -7004.356629016461, -7049.743980503448, -7085.78856131624, -6955.217855184973, -7065.806394386167, -6956.922071482337, -7088.209427875218, -7064.594289810642, -6940.504955055777, -7130.810313300896, -7082.376107966857, -7002.202110324274, -6936.2480592936245, -7100.72250874128, -7021.215123461855, -7078.492281506492, -7058.18426651735, -7165.856608548078, -7091.593360217844, -6982.041884454672, -6995.766701171402, -7005.125250829107, -6998.122880892173, -6999.881975986087, -6897.575843580419, -6999.032029919281, -6927.287035903237, -7075.565754985772, -6833.375325217441, -7113.299728443704, -7152.451555348877, -7176.19230452039, -7055.762398842322, -6962.554228305463, -6994.231144372555, -7093.922080242668, -7073.69185690152], "episode_lengths": [1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.3890005943948793, "mean_inference_ms": 0.230709745725996, "mean_action_processing_ms": 0.056119645284830044, "mean_env_wait_ms": 0.5455840561922702, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002447101804945204, "StateBufferConnector_ms": 0.001838472154405382, "ViewRequirementAgentConnector_ms": 0.043081574969821505}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 48495000, "num_agent_steps_trained": 48495000, "num_env_steps_sampled": 48495000, "num_env_steps_trained": 48495000, "num_env_steps_sampled_this_iter": 4800, "num_env_steps_trained_this_iter": 4800, "num_env_steps_sampled_throughput_per_sec": 454.1333807332124, "num_env_steps_trained_throughput_per_sec": 454.1333807332124, "timesteps_total": 48495000, "num_steps_trained_this_iter": 4800, "agent_timesteps_total": 48495000, "timers": {"training_iteration_time_ms": 2646.888, "sample_time_ms": 2626.226, "load_time_ms": 0.405, "load_throughput": 2962602.154, "learn_time_ms": 19.649, "learn_throughput": 61073.203, "synch_weights_time_ms": 0.572}, "counters": {"num_env_steps_sampled": 48495000, "num_env_steps_trained": 48495000, "num_agent_steps_sampled": 48495000, "num_agent_steps_trained": 48495000}, "done": false, "episodes_total": 9989, "training_iteration": 3133, "trial_id": "4bd41_00000", "date": "2023-08-08_07-33-41", "timestamp": 1691469221, "time_this_iter_s": 10.571871995925903, "time_total_s": 83669.51555776596, "pid": 11406, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 10, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[48412200, 5e-09], [48430200, 5e-09], [48448200, 5e-09], [48466200, 2.5e-09], [48484200, 2.5e-09], [48502200, 2.5e-09], [48520200, 2.5e-09], [48538200, 1e-09], [48556200, 1e-09], [48574200, 1e-09], [48592200, 1e-09], [48610200, 1e-09], [48628200, 5e-10], [48646200, 5e-10], [48664200, 5e-10], [48682200, 5e-10], [48700200, 2.5e-10], [48718200, 2.5e-10], [48736200, 2.5e-10], [48754200, 2.5e-10], [48772200, 1e-10], [48790200, 1e-10], [48808200, 1e-10], [48826200, 5e-11], [48844200, 5e-11], [48862200, 5e-11]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.3, "final_epsilon": 0.01, "epsilon_timesteps": 48880200}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 1200, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17eb87820>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 191.30366921424866, "iterations_since_restore": 18, "perf": {"cpu_util_percent": 16.813333333333336, "ram_util_percent": 55.27333333333333}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 2.5000000000000005e-09, "entropy_coeff": 0.10000000000000002, "policy_entropy": -363.7457224527995, "policy_loss": -9972399.129123263, "vf_loss": 10327336.430555556}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 1359.5, "diff_num_grad_updates_vs_sampler_policy": 1358.5}}, "num_env_steps_sampled": 48499800, "num_env_steps_trained": 48499800, "num_agent_steps_sampled": 48499800, "num_agent_steps_trained": 48499800}, "sampler_results": {"episode_reward_max": -6833.375325217441, "episode_reward_min": -7258.694817064271, "episode_reward_mean": -7044.853339799154, "episode_len_mean": 1200.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-7192.935015412464, -6939.769104344216, -6964.646815398022, -7101.818584523901, -7004.560091406043, -7080.420514360684, -7003.95476470443, -7006.802229214072, -7108.819924944902, -7077.238211770432, -6958.74477233818, -6897.9347297838385, -7133.0413473706885, -7106.175846091458, -7022.508151062388, -7055.4471655907755, -7156.551730099049, -7118.253979107904, -6960.48613997543, -7059.036381330186, -7258.694817064271, -7103.609693153824, -6959.141746836437, -6978.102502571718, -7023.055259216437, -7054.420855284454, -7221.500670767508, -6996.610295665902, -6863.816864875627, -7135.441374732098, -7072.856803490325, -6977.297268978018, -7045.858383823964, -7116.76351670452, -7075.866883064482, -7004.356629016461, -7049.743980503448, -7085.78856131624, -6955.217855184973, -7065.806394386167, -6956.922071482337, -7088.209427875218, -7064.594289810642, -6940.504955055777, -7130.810313300896, -7082.376107966857, -7002.202110324274, -6936.2480592936245, -7100.72250874128, -7021.215123461855, -7078.492281506492, -7058.18426651735, -7165.856608548078, -7091.593360217844, -6982.041884454672, -6995.766701171402, -7005.125250829107, -6998.122880892173, -6999.881975986087, -6897.575843580419, -6999.032029919281, -6927.287035903237, -7075.565754985772, -6833.375325217441, -7113.299728443704, -7152.451555348877, -7176.19230452039, -7055.762398842322, -6962.554228305463, -6994.231144372555, -7093.922080242668, -7073.69185690152, -7061.972758395433, -7098.346686411997, -7059.960118478598, -7141.666941964138], "episode_lengths": [1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.389206938926207, "mean_inference_ms": 0.230718068177026, "mean_action_processing_ms": 0.05613227528405414, "mean_env_wait_ms": 0.5432741123398498, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0024265364596718236, "StateBufferConnector_ms": 0.0018395875629625823, "ViewRequirementAgentConnector_ms": 0.04305055266932437}}, "episode_reward_max": -6833.375325217441, "episode_reward_min": -7258.694817064271, "episode_reward_mean": -7044.853339799154, "episode_len_mean": 1200.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-7192.935015412464, -6939.769104344216, -6964.646815398022, -7101.818584523901, -7004.560091406043, -7080.420514360684, -7003.95476470443, -7006.802229214072, -7108.819924944902, -7077.238211770432, -6958.74477233818, -6897.9347297838385, -7133.0413473706885, -7106.175846091458, -7022.508151062388, -7055.4471655907755, -7156.551730099049, -7118.253979107904, -6960.48613997543, -7059.036381330186, -7258.694817064271, -7103.609693153824, -6959.141746836437, -6978.102502571718, -7023.055259216437, -7054.420855284454, -7221.500670767508, -6996.610295665902, -6863.816864875627, -7135.441374732098, -7072.856803490325, -6977.297268978018, -7045.858383823964, -7116.76351670452, -7075.866883064482, -7004.356629016461, -7049.743980503448, -7085.78856131624, -6955.217855184973, -7065.806394386167, -6956.922071482337, -7088.209427875218, -7064.594289810642, -6940.504955055777, -7130.810313300896, -7082.376107966857, -7002.202110324274, -6936.2480592936245, -7100.72250874128, -7021.215123461855, -7078.492281506492, -7058.18426651735, -7165.856608548078, -7091.593360217844, -6982.041884454672, -6995.766701171402, -7005.125250829107, -6998.122880892173, -6999.881975986087, -6897.575843580419, -6999.032029919281, -6927.287035903237, -7075.565754985772, -6833.375325217441, -7113.299728443704, -7152.451555348877, -7176.19230452039, -7055.762398842322, -6962.554228305463, -6994.231144372555, -7093.922080242668, -7073.69185690152, -7061.972758395433, -7098.346686411997, -7059.960118478598, -7141.666941964138], "episode_lengths": [1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.389206938926207, "mean_inference_ms": 0.230718068177026, "mean_action_processing_ms": 0.05613227528405414, "mean_env_wait_ms": 0.5432741123398498, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0024265364596718236, "StateBufferConnector_ms": 0.0018395875629625823, "ViewRequirementAgentConnector_ms": 0.04305055266932437}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 48499800, "num_agent_steps_trained": 48499800, "num_env_steps_sampled": 48499800, "num_env_steps_trained": 48499800, "num_env_steps_sampled_this_iter": 4800, "num_env_steps_trained_this_iter": 4800, "num_env_steps_sampled_throughput_per_sec": 454.0512496837228, "num_env_steps_trained_throughput_per_sec": 454.0512496837228, "timesteps_total": 48499800, "num_steps_trained_this_iter": 4800, "agent_timesteps_total": 48499800, "timers": {"training_iteration_time_ms": 2645.459, "sample_time_ms": 2624.691, "load_time_ms": 0.406, "load_throughput": 2956511.278, "learn_time_ms": 19.741, "learn_throughput": 60786.354, "synch_weights_time_ms": 0.582}, "counters": {"num_env_steps_sampled": 48499800, "num_env_steps_trained": 48499800, "num_agent_steps_sampled": 48499800, "num_agent_steps_trained": 48499800}, "done": false, "episodes_total": 9993, "training_iteration": 3134, "trial_id": "4bd41_00000", "date": "2023-08-08_07-33-51", "timestamp": 1691469231, "time_this_iter_s": 10.573695182800293, "time_total_s": 83680.08925294876, "pid": 11406, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 10, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[48412200, 5e-09], [48430200, 5e-09], [48448200, 5e-09], [48466200, 2.5e-09], [48484200, 2.5e-09], [48502200, 2.5e-09], [48520200, 2.5e-09], [48538200, 1e-09], [48556200, 1e-09], [48574200, 1e-09], [48592200, 1e-09], [48610200, 1e-09], [48628200, 5e-10], [48646200, 5e-10], [48664200, 5e-10], [48682200, 5e-10], [48700200, 2.5e-10], [48718200, 2.5e-10], [48736200, 2.5e-10], [48754200, 2.5e-10], [48772200, 1e-10], [48790200, 1e-10], [48808200, 1e-10], [48826200, 5e-11], [48844200, 5e-11], [48862200, 5e-11]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.3, "final_epsilon": 0.01, "epsilon_timesteps": 48880200}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 1200, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17eb87820>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 201.87736439704895, "iterations_since_restore": 19, "perf": {"cpu_util_percent": 20.15333333333333, "ram_util_percent": 55.29333333333332}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 2.5000000000000005e-09, "entropy_coeff": 0.10000000000000002, "policy_entropy": -365.4234890407986, "policy_loss": -8269084.150824653, "vf_loss": 10418261.833333334}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 1431.5, "diff_num_grad_updates_vs_sampler_policy": 1430.5}}, "num_env_steps_sampled": 48504600, "num_env_steps_trained": 48504600, "num_agent_steps_sampled": 48504600, "num_agent_steps_trained": 48504600}, "sampler_results": {"episode_reward_max": -6833.375325217441, "episode_reward_min": -7258.694817064271, "episode_reward_mean": -7044.11070608806, "episode_len_mean": 1200.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-7192.935015412464, -6939.769104344216, -6964.646815398022, -7101.818584523901, -7004.560091406043, -7080.420514360684, -7003.95476470443, -7006.802229214072, -7108.819924944902, -7077.238211770432, -6958.74477233818, -6897.9347297838385, -7133.0413473706885, -7106.175846091458, -7022.508151062388, -7055.4471655907755, -7156.551730099049, -7118.253979107904, -6960.48613997543, -7059.036381330186, -7258.694817064271, -7103.609693153824, -6959.141746836437, -6978.102502571718, -7023.055259216437, -7054.420855284454, -7221.500670767508, -6996.610295665902, -6863.816864875627, -7135.441374732098, -7072.856803490325, -6977.297268978018, -7045.858383823964, -7116.76351670452, -7075.866883064482, -7004.356629016461, -7049.743980503448, -7085.78856131624, -6955.217855184973, -7065.806394386167, -6956.922071482337, -7088.209427875218, -7064.594289810642, -6940.504955055777, -7130.810313300896, -7082.376107966857, -7002.202110324274, -6936.2480592936245, -7100.72250874128, -7021.215123461855, -7078.492281506492, -7058.18426651735, -7165.856608548078, -7091.593360217844, -6982.041884454672, -6995.766701171402, -7005.125250829107, -6998.122880892173, -6999.881975986087, -6897.575843580419, -6999.032029919281, -6927.287035903237, -7075.565754985772, -6833.375325217441, -7113.299728443704, -7152.451555348877, -7176.19230452039, -7055.762398842322, -6962.554228305463, -6994.231144372555, -7093.922080242668, -7073.69185690152, -7061.972758395433, -7098.346686411997, -7059.960118478598, -7141.666941964138, -6964.956240607673, -7024.262777255779, -6984.5164476153195, -7146.26719683038], "episode_lengths": [1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.3893996737590797, "mean_inference_ms": 0.23072484758098302, "mean_action_processing_ms": 0.05614349502082701, "mean_env_wait_ms": 0.541146578523462, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0024113059043884277, "StateBufferConnector_ms": 0.0018388032913208008, "ViewRequirementAgentConnector_ms": 0.043053627014160156}}, "episode_reward_max": -6833.375325217441, "episode_reward_min": -7258.694817064271, "episode_reward_mean": -7044.11070608806, "episode_len_mean": 1200.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-7192.935015412464, -6939.769104344216, -6964.646815398022, -7101.818584523901, -7004.560091406043, -7080.420514360684, -7003.95476470443, -7006.802229214072, -7108.819924944902, -7077.238211770432, -6958.74477233818, -6897.9347297838385, -7133.0413473706885, -7106.175846091458, -7022.508151062388, -7055.4471655907755, -7156.551730099049, -7118.253979107904, -6960.48613997543, -7059.036381330186, -7258.694817064271, -7103.609693153824, -6959.141746836437, -6978.102502571718, -7023.055259216437, -7054.420855284454, -7221.500670767508, -6996.610295665902, -6863.816864875627, -7135.441374732098, -7072.856803490325, -6977.297268978018, -7045.858383823964, -7116.76351670452, -7075.866883064482, -7004.356629016461, -7049.743980503448, -7085.78856131624, -6955.217855184973, -7065.806394386167, -6956.922071482337, -7088.209427875218, -7064.594289810642, -6940.504955055777, -7130.810313300896, -7082.376107966857, -7002.202110324274, -6936.2480592936245, -7100.72250874128, -7021.215123461855, -7078.492281506492, -7058.18426651735, -7165.856608548078, -7091.593360217844, -6982.041884454672, -6995.766701171402, -7005.125250829107, -6998.122880892173, -6999.881975986087, -6897.575843580419, -6999.032029919281, -6927.287035903237, -7075.565754985772, -6833.375325217441, -7113.299728443704, -7152.451555348877, -7176.19230452039, -7055.762398842322, -6962.554228305463, -6994.231144372555, -7093.922080242668, -7073.69185690152, -7061.972758395433, -7098.346686411997, -7059.960118478598, -7141.666941964138, -6964.956240607673, -7024.262777255779, -6984.5164476153195, -7146.26719683038], "episode_lengths": [1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.3893996737590797, "mean_inference_ms": 0.23072484758098302, "mean_action_processing_ms": 0.05614349502082701, "mean_env_wait_ms": 0.541146578523462, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0024113059043884277, "StateBufferConnector_ms": 0.0018388032913208008, "ViewRequirementAgentConnector_ms": 0.043053627014160156}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 48504600, "num_agent_steps_trained": 48504600, "num_env_steps_sampled": 48504600, "num_env_steps_trained": 48504600, "num_env_steps_sampled_this_iter": 4800, "num_env_steps_trained_this_iter": 4800, "num_env_steps_sampled_throughput_per_sec": 455.3284061682268, "num_env_steps_trained_throughput_per_sec": 455.3284061682268, "timesteps_total": 48504600, "num_steps_trained_this_iter": 4800, "agent_timesteps_total": 48504600, "timers": {"training_iteration_time_ms": 2641.489, "sample_time_ms": 2620.649, "load_time_ms": 0.405, "load_throughput": 2962427.781, "learn_time_ms": 19.84, "learn_throughput": 60485.1, "synch_weights_time_ms": 0.559}, "counters": {"num_env_steps_sampled": 48504600, "num_env_steps_trained": 48504600, "num_agent_steps_sampled": 48504600, "num_agent_steps_trained": 48504600}, "done": false, "episodes_total": 9997, "training_iteration": 3135, "trial_id": "4bd41_00000", "date": "2023-08-08_07-34-02", "timestamp": 1691469242, "time_this_iter_s": 10.543872117996216, "time_total_s": 83690.63312506676, "pid": 11406, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 10, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[48412200, 5e-09], [48430200, 5e-09], [48448200, 5e-09], [48466200, 2.5e-09], [48484200, 2.5e-09], [48502200, 2.5e-09], [48520200, 2.5e-09], [48538200, 1e-09], [48556200, 1e-09], [48574200, 1e-09], [48592200, 1e-09], [48610200, 1e-09], [48628200, 5e-10], [48646200, 5e-10], [48664200, 5e-10], [48682200, 5e-10], [48700200, 2.5e-10], [48718200, 2.5e-10], [48736200, 2.5e-10], [48754200, 2.5e-10], [48772200, 1e-10], [48790200, 1e-10], [48808200, 1e-10], [48826200, 5e-11], [48844200, 5e-11], [48862200, 5e-11]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.3, "final_epsilon": 0.01, "epsilon_timesteps": 48880200}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 1200, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17eb87820>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 212.42123651504517, "iterations_since_restore": 20, "perf": {"cpu_util_percent": 19.3, "ram_util_percent": 55.32}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 2.5000000000000005e-09, "entropy_coeff": 0.10000000000000002, "policy_entropy": -364.85783216688367, "policy_loss": -5666576.999131944, "vf_loss": 10141668.777777778}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 1503.5, "diff_num_grad_updates_vs_sampler_policy": 1502.5}}, "num_env_steps_sampled": 48509400, "num_env_steps_trained": 48509400, "num_agent_steps_sampled": 48509400, "num_agent_steps_trained": 48509400}, "sampler_results": {"episode_reward_max": -6833.375325217441, "episode_reward_min": -7258.694817064271, "episode_reward_mean": -7042.012576625061, "episode_len_mean": 1200.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-7192.935015412464, -6939.769104344216, -6964.646815398022, -7101.818584523901, -7004.560091406043, -7080.420514360684, -7003.95476470443, -7006.802229214072, -7108.819924944902, -7077.238211770432, -6958.74477233818, -6897.9347297838385, -7133.0413473706885, -7106.175846091458, -7022.508151062388, -7055.4471655907755, -7156.551730099049, -7118.253979107904, -6960.48613997543, -7059.036381330186, -7258.694817064271, -7103.609693153824, -6959.141746836437, -6978.102502571718, -7023.055259216437, -7054.420855284454, -7221.500670767508, -6996.610295665902, -6863.816864875627, -7135.441374732098, -7072.856803490325, -6977.297268978018, -7045.858383823964, -7116.76351670452, -7075.866883064482, -7004.356629016461, -7049.743980503448, -7085.78856131624, -6955.217855184973, -7065.806394386167, -6956.922071482337, -7088.209427875218, -7064.594289810642, -6940.504955055777, -7130.810313300896, -7082.376107966857, -7002.202110324274, -6936.2480592936245, -7100.72250874128, -7021.215123461855, -7078.492281506492, -7058.18426651735, -7165.856608548078, -7091.593360217844, -6982.041884454672, -6995.766701171402, -7005.125250829107, -6998.122880892173, -6999.881975986087, -6897.575843580419, -6999.032029919281, -6927.287035903237, -7075.565754985772, -6833.375325217441, -7113.299728443704, -7152.451555348877, -7176.19230452039, -7055.762398842322, -6962.554228305463, -6994.231144372555, -7093.922080242668, -7073.69185690152, -7061.972758395433, -7098.346686411997, -7059.960118478598, -7141.666941964138, -6964.956240607673, -7024.262777255779, -6984.5164476153195, -7146.26719683038, -7052.197402042947, -6926.088343663724, -6930.404533176647, -7091.509670576999], "episode_lengths": [1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.3895691942223336, "mean_inference_ms": 0.2307327501907339, "mean_action_processing_ms": 0.05615356662303035, "mean_env_wait_ms": 0.5391674243255157, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002394687561761765, "StateBufferConnector_ms": 0.0018389452071416947, "ViewRequirementAgentConnector_ms": 0.04311686470395043}}, "episode_reward_max": -6833.375325217441, "episode_reward_min": -7258.694817064271, "episode_reward_mean": -7042.012576625061, "episode_len_mean": 1200.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-7192.935015412464, -6939.769104344216, -6964.646815398022, -7101.818584523901, -7004.560091406043, -7080.420514360684, -7003.95476470443, -7006.802229214072, -7108.819924944902, -7077.238211770432, -6958.74477233818, -6897.9347297838385, -7133.0413473706885, -7106.175846091458, -7022.508151062388, -7055.4471655907755, -7156.551730099049, -7118.253979107904, -6960.48613997543, -7059.036381330186, -7258.694817064271, -7103.609693153824, -6959.141746836437, -6978.102502571718, -7023.055259216437, -7054.420855284454, -7221.500670767508, -6996.610295665902, -6863.816864875627, -7135.441374732098, -7072.856803490325, -6977.297268978018, -7045.858383823964, -7116.76351670452, -7075.866883064482, -7004.356629016461, -7049.743980503448, -7085.78856131624, -6955.217855184973, -7065.806394386167, -6956.922071482337, -7088.209427875218, -7064.594289810642, -6940.504955055777, -7130.810313300896, -7082.376107966857, -7002.202110324274, -6936.2480592936245, -7100.72250874128, -7021.215123461855, -7078.492281506492, -7058.18426651735, -7165.856608548078, -7091.593360217844, -6982.041884454672, -6995.766701171402, -7005.125250829107, -6998.122880892173, -6999.881975986087, -6897.575843580419, -6999.032029919281, -6927.287035903237, -7075.565754985772, -6833.375325217441, -7113.299728443704, -7152.451555348877, -7176.19230452039, -7055.762398842322, -6962.554228305463, -6994.231144372555, -7093.922080242668, -7073.69185690152, -7061.972758395433, -7098.346686411997, -7059.960118478598, -7141.666941964138, -6964.956240607673, -7024.262777255779, -6984.5164476153195, -7146.26719683038, -7052.197402042947, -6926.088343663724, -6930.404533176647, -7091.509670576999], "episode_lengths": [1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.3895691942223336, "mean_inference_ms": 0.2307327501907339, "mean_action_processing_ms": 0.05615356662303035, "mean_env_wait_ms": 0.5391674243255157, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002394687561761765, "StateBufferConnector_ms": 0.0018389452071416947, "ViewRequirementAgentConnector_ms": 0.04311686470395043}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 48509400, "num_agent_steps_trained": 48509400, "num_env_steps_sampled": 48509400, "num_env_steps_trained": 48509400, "num_env_steps_sampled_this_iter": 4800, "num_env_steps_trained_this_iter": 4800, "num_env_steps_sampled_throughput_per_sec": 457.2321229161043, "num_env_steps_trained_throughput_per_sec": 457.2321229161043, "timesteps_total": 48509400, "num_steps_trained_this_iter": 4800, "agent_timesteps_total": 48509400, "timers": {"training_iteration_time_ms": 2636.563, "sample_time_ms": 2615.686, "load_time_ms": 0.414, "load_throughput": 2898620.594, "learn_time_ms": 19.862, "learn_throughput": 60417.65, "synch_weights_time_ms": 0.564}, "counters": {"num_env_steps_sampled": 48509400, "num_env_steps_trained": 48509400, "num_agent_steps_sampled": 48509400, "num_agent_steps_trained": 48509400}, "done": false, "episodes_total": 10001, "training_iteration": 3136, "trial_id": "4bd41_00000", "date": "2023-08-08_07-34-12", "timestamp": 1691469252, "time_this_iter_s": 10.499972820281982, "time_total_s": 83701.13309788704, "pid": 11406, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 10, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[48412200, 5e-09], [48430200, 5e-09], [48448200, 5e-09], [48466200, 2.5e-09], [48484200, 2.5e-09], [48502200, 2.5e-09], [48520200, 2.5e-09], [48538200, 1e-09], [48556200, 1e-09], [48574200, 1e-09], [48592200, 1e-09], [48610200, 1e-09], [48628200, 5e-10], [48646200, 5e-10], [48664200, 5e-10], [48682200, 5e-10], [48700200, 2.5e-10], [48718200, 2.5e-10], [48736200, 2.5e-10], [48754200, 2.5e-10], [48772200, 1e-10], [48790200, 1e-10], [48808200, 1e-10], [48826200, 5e-11], [48844200, 5e-11], [48862200, 5e-11]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.3, "final_epsilon": 0.01, "epsilon_timesteps": 48880200}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 1200, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17eb87820>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 222.92120933532715, "iterations_since_restore": 21, "perf": {"cpu_util_percent": 17.353333333333335, "ram_util_percent": 55.70666666666667}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 2.5000000000000005e-09, "entropy_coeff": 0.10000000000000002, "policy_entropy": -364.19867451985675, "policy_loss": -6960336.848958333, "vf_loss": 10078438.833333334}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 1575.5, "diff_num_grad_updates_vs_sampler_policy": 1574.5}}, "num_env_steps_sampled": 48514200, "num_env_steps_trained": 48514200, "num_agent_steps_sampled": 48514200, "num_agent_steps_trained": 48514200}, "sampler_results": {"episode_reward_max": -6833.375325217441, "episode_reward_min": -7258.694817064271, "episode_reward_mean": -7041.420519841692, "episode_len_mean": 1200.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-7192.935015412464, -6939.769104344216, -6964.646815398022, -7101.818584523901, -7004.560091406043, -7080.420514360684, -7003.95476470443, -7006.802229214072, -7108.819924944902, -7077.238211770432, -6958.74477233818, -6897.9347297838385, -7133.0413473706885, -7106.175846091458, -7022.508151062388, -7055.4471655907755, -7156.551730099049, -7118.253979107904, -6960.48613997543, -7059.036381330186, -7258.694817064271, -7103.609693153824, -6959.141746836437, -6978.102502571718, -7023.055259216437, -7054.420855284454, -7221.500670767508, -6996.610295665902, -6863.816864875627, -7135.441374732098, -7072.856803490325, -6977.297268978018, -7045.858383823964, -7116.76351670452, -7075.866883064482, -7004.356629016461, -7049.743980503448, -7085.78856131624, -6955.217855184973, -7065.806394386167, -6956.922071482337, -7088.209427875218, -7064.594289810642, -6940.504955055777, -7130.810313300896, -7082.376107966857, -7002.202110324274, -6936.2480592936245, -7100.72250874128, -7021.215123461855, -7078.492281506492, -7058.18426651735, -7165.856608548078, -7091.593360217844, -6982.041884454672, -6995.766701171402, -7005.125250829107, -6998.122880892173, -6999.881975986087, -6897.575843580419, -6999.032029919281, -6927.287035903237, -7075.565754985772, -6833.375325217441, -7113.299728443704, -7152.451555348877, -7176.19230452039, -7055.762398842322, -6962.554228305463, -6994.231144372555, -7093.922080242668, -7073.69185690152, -7061.972758395433, -7098.346686411997, -7059.960118478598, -7141.666941964138, -6964.956240607673, -7024.262777255779, -6984.5164476153195, -7146.26719683038, -7052.197402042947, -6926.088343663724, -6930.404533176647, -7091.509670576999, -7000.025414988401, -7155.803125543254, -6930.210957654184, -7029.909811377778], "episode_lengths": [1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.3897249675814256, "mean_inference_ms": 0.23074388645245392, "mean_action_processing_ms": 0.05616327731013054, "mean_env_wait_ms": 0.5373358651792501, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0023806636983698063, "StateBufferConnector_ms": 0.001848556778647683, "ViewRequirementAgentConnector_ms": 0.04318004304712469}}, "episode_reward_max": -6833.375325217441, "episode_reward_min": -7258.694817064271, "episode_reward_mean": -7041.420519841692, "episode_len_mean": 1200.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-7192.935015412464, -6939.769104344216, -6964.646815398022, -7101.818584523901, -7004.560091406043, -7080.420514360684, -7003.95476470443, -7006.802229214072, -7108.819924944902, -7077.238211770432, -6958.74477233818, -6897.9347297838385, -7133.0413473706885, -7106.175846091458, -7022.508151062388, -7055.4471655907755, -7156.551730099049, -7118.253979107904, -6960.48613997543, -7059.036381330186, -7258.694817064271, -7103.609693153824, -6959.141746836437, -6978.102502571718, -7023.055259216437, -7054.420855284454, -7221.500670767508, -6996.610295665902, -6863.816864875627, -7135.441374732098, -7072.856803490325, -6977.297268978018, -7045.858383823964, -7116.76351670452, -7075.866883064482, -7004.356629016461, -7049.743980503448, -7085.78856131624, -6955.217855184973, -7065.806394386167, -6956.922071482337, -7088.209427875218, -7064.594289810642, -6940.504955055777, -7130.810313300896, -7082.376107966857, -7002.202110324274, -6936.2480592936245, -7100.72250874128, -7021.215123461855, -7078.492281506492, -7058.18426651735, -7165.856608548078, -7091.593360217844, -6982.041884454672, -6995.766701171402, -7005.125250829107, -6998.122880892173, -6999.881975986087, -6897.575843580419, -6999.032029919281, -6927.287035903237, -7075.565754985772, -6833.375325217441, -7113.299728443704, -7152.451555348877, -7176.19230452039, -7055.762398842322, -6962.554228305463, -6994.231144372555, -7093.922080242668, -7073.69185690152, -7061.972758395433, -7098.346686411997, -7059.960118478598, -7141.666941964138, -6964.956240607673, -7024.262777255779, -6984.5164476153195, -7146.26719683038, -7052.197402042947, -6926.088343663724, -6930.404533176647, -7091.509670576999, -7000.025414988401, -7155.803125543254, -6930.210957654184, -7029.909811377778], "episode_lengths": [1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.3897249675814256, "mean_inference_ms": 0.23074388645245392, "mean_action_processing_ms": 0.05616327731013054, "mean_env_wait_ms": 0.5373358651792501, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0023806636983698063, "StateBufferConnector_ms": 0.001848556778647683, "ViewRequirementAgentConnector_ms": 0.04318004304712469}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 48514200, "num_agent_steps_trained": 48514200, "num_env_steps_sampled": 48514200, "num_env_steps_trained": 48514200, "num_env_steps_sampled_this_iter": 4800, "num_env_steps_trained_this_iter": 4800, "num_env_steps_sampled_throughput_per_sec": 454.9143340887499, "num_env_steps_trained_throughput_per_sec": 454.9143340887499, "timesteps_total": 48514200, "num_steps_trained_this_iter": 4800, "agent_timesteps_total": 48514200, "timers": {"training_iteration_time_ms": 2634.005, "sample_time_ms": 2613.269, "load_time_ms": 0.415, "load_throughput": 2888141.849, "learn_time_ms": 19.722, "learn_throughput": 60847.053, "synch_weights_time_ms": 0.562}, "counters": {"num_env_steps_sampled": 48514200, "num_env_steps_trained": 48514200, "num_agent_steps_sampled": 48514200, "num_agent_steps_trained": 48514200}, "done": false, "episodes_total": 10005, "training_iteration": 3137, "trial_id": "4bd41_00000", "date": "2023-08-08_07-34-23", "timestamp": 1691469263, "time_this_iter_s": 10.553441047668457, "time_total_s": 83711.68653893471, "pid": 11406, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 10, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[48412200, 5e-09], [48430200, 5e-09], [48448200, 5e-09], [48466200, 2.5e-09], [48484200, 2.5e-09], [48502200, 2.5e-09], [48520200, 2.5e-09], [48538200, 1e-09], [48556200, 1e-09], [48574200, 1e-09], [48592200, 1e-09], [48610200, 1e-09], [48628200, 5e-10], [48646200, 5e-10], [48664200, 5e-10], [48682200, 5e-10], [48700200, 2.5e-10], [48718200, 2.5e-10], [48736200, 2.5e-10], [48754200, 2.5e-10], [48772200, 1e-10], [48790200, 1e-10], [48808200, 1e-10], [48826200, 5e-11], [48844200, 5e-11], [48862200, 5e-11]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.3, "final_epsilon": 0.01, "epsilon_timesteps": 48880200}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 1200, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17eb87820>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 233.4746503829956, "iterations_since_restore": 22, "perf": {"cpu_util_percent": 16.71333333333333, "ram_util_percent": 55.61333333333334}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 2.5000000000000005e-09, "entropy_coeff": 0.10000000000000002, "policy_entropy": -362.87738715277777, "policy_loss": -6865188.443576389, "vf_loss": 9956442.430555556}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 1647.5, "diff_num_grad_updates_vs_sampler_policy": 1646.5}}, "num_env_steps_sampled": 48519000, "num_env_steps_trained": 48519000, "num_agent_steps_sampled": 48519000, "num_agent_steps_trained": 48519000}, "sampler_results": {"episode_reward_max": -6833.375325217441, "episode_reward_min": -7258.694817064271, "episode_reward_mean": -7042.595990742959, "episode_len_mean": 1200.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-7192.935015412464, -6939.769104344216, -6964.646815398022, -7101.818584523901, -7004.560091406043, -7080.420514360684, -7003.95476470443, -7006.802229214072, -7108.819924944902, -7077.238211770432, -6958.74477233818, -6897.9347297838385, -7133.0413473706885, -7106.175846091458, -7022.508151062388, -7055.4471655907755, -7156.551730099049, -7118.253979107904, -6960.48613997543, -7059.036381330186, -7258.694817064271, -7103.609693153824, -6959.141746836437, -6978.102502571718, -7023.055259216437, -7054.420855284454, -7221.500670767508, -6996.610295665902, -6863.816864875627, -7135.441374732098, -7072.856803490325, -6977.297268978018, -7045.858383823964, -7116.76351670452, -7075.866883064482, -7004.356629016461, -7049.743980503448, -7085.78856131624, -6955.217855184973, -7065.806394386167, -6956.922071482337, -7088.209427875218, -7064.594289810642, -6940.504955055777, -7130.810313300896, -7082.376107966857, -7002.202110324274, -6936.2480592936245, -7100.72250874128, -7021.215123461855, -7078.492281506492, -7058.18426651735, -7165.856608548078, -7091.593360217844, -6982.041884454672, -6995.766701171402, -7005.125250829107, -6998.122880892173, -6999.881975986087, -6897.575843580419, -6999.032029919281, -6927.287035903237, -7075.565754985772, -6833.375325217441, -7113.299728443704, -7152.451555348877, -7176.19230452039, -7055.762398842322, -6962.554228305463, -6994.231144372555, -7093.922080242668, -7073.69185690152, -7061.972758395433, -7098.346686411997, -7059.960118478598, -7141.666941964138, -6964.956240607673, -7024.262777255779, -6984.5164476153195, -7146.26719683038, -7052.197402042947, -6926.088343663724, -6930.404533176647, -7091.509670576999, -7000.025414988401, -7155.803125543254, -6930.210957654184, -7029.909811377778, -7072.606524772726, -7193.148038609042, -7006.156456292769, -7001.914382608852], "episode_lengths": [1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.3898706309368012, "mean_inference_ms": 0.23075519663520558, "mean_action_processing_ms": 0.056172173104141625, "mean_env_wait_ms": 0.5356570926277241, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0023626762887705927, "StateBufferConnector_ms": 0.001843856728595236, "ViewRequirementAgentConnector_ms": 0.0431581683780836}}, "episode_reward_max": -6833.375325217441, "episode_reward_min": -7258.694817064271, "episode_reward_mean": -7042.595990742959, "episode_len_mean": 1200.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-7192.935015412464, -6939.769104344216, -6964.646815398022, -7101.818584523901, -7004.560091406043, -7080.420514360684, -7003.95476470443, -7006.802229214072, -7108.819924944902, -7077.238211770432, -6958.74477233818, -6897.9347297838385, -7133.0413473706885, -7106.175846091458, -7022.508151062388, -7055.4471655907755, -7156.551730099049, -7118.253979107904, -6960.48613997543, -7059.036381330186, -7258.694817064271, -7103.609693153824, -6959.141746836437, -6978.102502571718, -7023.055259216437, -7054.420855284454, -7221.500670767508, -6996.610295665902, -6863.816864875627, -7135.441374732098, -7072.856803490325, -6977.297268978018, -7045.858383823964, -7116.76351670452, -7075.866883064482, -7004.356629016461, -7049.743980503448, -7085.78856131624, -6955.217855184973, -7065.806394386167, -6956.922071482337, -7088.209427875218, -7064.594289810642, -6940.504955055777, -7130.810313300896, -7082.376107966857, -7002.202110324274, -6936.2480592936245, -7100.72250874128, -7021.215123461855, -7078.492281506492, -7058.18426651735, -7165.856608548078, -7091.593360217844, -6982.041884454672, -6995.766701171402, -7005.125250829107, -6998.122880892173, -6999.881975986087, -6897.575843580419, -6999.032029919281, -6927.287035903237, -7075.565754985772, -6833.375325217441, -7113.299728443704, -7152.451555348877, -7176.19230452039, -7055.762398842322, -6962.554228305463, -6994.231144372555, -7093.922080242668, -7073.69185690152, -7061.972758395433, -7098.346686411997, -7059.960118478598, -7141.666941964138, -6964.956240607673, -7024.262777255779, -6984.5164476153195, -7146.26719683038, -7052.197402042947, -6926.088343663724, -6930.404533176647, -7091.509670576999, -7000.025414988401, -7155.803125543254, -6930.210957654184, -7029.909811377778, -7072.606524772726, -7193.148038609042, -7006.156456292769, -7001.914382608852], "episode_lengths": [1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.3898706309368012, "mean_inference_ms": 0.23075519663520558, "mean_action_processing_ms": 0.056172173104141625, "mean_env_wait_ms": 0.5356570926277241, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0023626762887705927, "StateBufferConnector_ms": 0.001843856728595236, "ViewRequirementAgentConnector_ms": 0.0431581683780836}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 48519000, "num_agent_steps_trained": 48519000, "num_env_steps_sampled": 48519000, "num_env_steps_trained": 48519000, "num_env_steps_sampled_this_iter": 4800, "num_env_steps_trained_this_iter": 4800, "num_env_steps_sampled_throughput_per_sec": 452.64964041477646, "num_env_steps_trained_throughput_per_sec": 452.64964041477646, "timesteps_total": 48519000, "num_steps_trained_this_iter": 4800, "agent_timesteps_total": 48519000, "timers": {"training_iteration_time_ms": 2641.132, "sample_time_ms": 2620.546, "load_time_ms": 0.412, "load_throughput": 2915241.703, "learn_time_ms": 19.579, "learn_throughput": 61291.41, "synch_weights_time_ms": 0.559}, "counters": {"num_env_steps_sampled": 48519000, "num_env_steps_trained": 48519000, "num_agent_steps_sampled": 48519000, "num_agent_steps_trained": 48519000}, "done": false, "episodes_total": 10009, "training_iteration": 3138, "trial_id": "4bd41_00000", "date": "2023-08-08_07-34-34", "timestamp": 1691469274, "time_this_iter_s": 10.606864929199219, "time_total_s": 83722.2934038639, "pid": 11406, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 10, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[48412200, 5e-09], [48430200, 5e-09], [48448200, 5e-09], [48466200, 2.5e-09], [48484200, 2.5e-09], [48502200, 2.5e-09], [48520200, 2.5e-09], [48538200, 1e-09], [48556200, 1e-09], [48574200, 1e-09], [48592200, 1e-09], [48610200, 1e-09], [48628200, 5e-10], [48646200, 5e-10], [48664200, 5e-10], [48682200, 5e-10], [48700200, 2.5e-10], [48718200, 2.5e-10], [48736200, 2.5e-10], [48754200, 2.5e-10], [48772200, 1e-10], [48790200, 1e-10], [48808200, 1e-10], [48826200, 5e-11], [48844200, 5e-11], [48862200, 5e-11]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.3, "final_epsilon": 0.01, "epsilon_timesteps": 48880200}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 1200, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17eb87820>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 244.08151531219482, "iterations_since_restore": 23, "perf": {"cpu_util_percent": 17.19333333333333, "ram_util_percent": 55.54666666666667}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 2.3e-09, "entropy_coeff": 0.10000000000000002, "policy_entropy": -363.51783074273004, "policy_loss": -4249407.051215278, "vf_loss": 9825664.513888888}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 1719.5, "diff_num_grad_updates_vs_sampler_policy": 1718.5}}, "num_env_steps_sampled": 48523800, "num_env_steps_trained": 48523800, "num_agent_steps_sampled": 48523800, "num_agent_steps_trained": 48523800}, "sampler_results": {"episode_reward_max": -6833.375325217441, "episode_reward_min": -7258.694817064271, "episode_reward_mean": -7041.690716511391, "episode_len_mean": 1200.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-7192.935015412464, -6939.769104344216, -6964.646815398022, -7101.818584523901, -7004.560091406043, -7080.420514360684, -7003.95476470443, -7006.802229214072, -7108.819924944902, -7077.238211770432, -6958.74477233818, -6897.9347297838385, -7133.0413473706885, -7106.175846091458, -7022.508151062388, -7055.4471655907755, -7156.551730099049, -7118.253979107904, -6960.48613997543, -7059.036381330186, -7258.694817064271, -7103.609693153824, -6959.141746836437, -6978.102502571718, -7023.055259216437, -7054.420855284454, -7221.500670767508, -6996.610295665902, -6863.816864875627, -7135.441374732098, -7072.856803490325, -6977.297268978018, -7045.858383823964, -7116.76351670452, -7075.866883064482, -7004.356629016461, -7049.743980503448, -7085.78856131624, -6955.217855184973, -7065.806394386167, -6956.922071482337, -7088.209427875218, -7064.594289810642, -6940.504955055777, -7130.810313300896, -7082.376107966857, -7002.202110324274, -6936.2480592936245, -7100.72250874128, -7021.215123461855, -7078.492281506492, -7058.18426651735, -7165.856608548078, -7091.593360217844, -6982.041884454672, -6995.766701171402, -7005.125250829107, -6998.122880892173, -6999.881975986087, -6897.575843580419, -6999.032029919281, -6927.287035903237, -7075.565754985772, -6833.375325217441, -7113.299728443704, -7152.451555348877, -7176.19230452039, -7055.762398842322, -6962.554228305463, -6994.231144372555, -7093.922080242668, -7073.69185690152, -7061.972758395433, -7098.346686411997, -7059.960118478598, -7141.666941964138, -6964.956240607673, -7024.262777255779, -6984.5164476153195, -7146.26719683038, -7052.197402042947, -6926.088343663724, -6930.404533176647, -7091.509670576999, -7000.025414988401, -7155.803125543254, -6930.210957654184, -7029.909811377778, -7072.606524772726, -7193.148038609042, -7006.156456292769, -7001.914382608852, -7144.865642034664, -6995.5622990461, -6974.745524322425, -6968.304171338026], "episode_lengths": [1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.390007682969052, "mean_inference_ms": 0.23076596285171957, "mean_action_processing_ms": 0.0561804482795333, "mean_env_wait_ms": 0.5340834466216898, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002352644999821981, "StateBufferConnector_ms": 0.0018462538719177246, "ViewRequirementAgentConnector_ms": 0.04319573442141215}}, "episode_reward_max": -6833.375325217441, "episode_reward_min": -7258.694817064271, "episode_reward_mean": -7041.690716511391, "episode_len_mean": 1200.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-7192.935015412464, -6939.769104344216, -6964.646815398022, -7101.818584523901, -7004.560091406043, -7080.420514360684, -7003.95476470443, -7006.802229214072, -7108.819924944902, -7077.238211770432, -6958.74477233818, -6897.9347297838385, -7133.0413473706885, -7106.175846091458, -7022.508151062388, -7055.4471655907755, -7156.551730099049, -7118.253979107904, -6960.48613997543, -7059.036381330186, -7258.694817064271, -7103.609693153824, -6959.141746836437, -6978.102502571718, -7023.055259216437, -7054.420855284454, -7221.500670767508, -6996.610295665902, -6863.816864875627, -7135.441374732098, -7072.856803490325, -6977.297268978018, -7045.858383823964, -7116.76351670452, -7075.866883064482, -7004.356629016461, -7049.743980503448, -7085.78856131624, -6955.217855184973, -7065.806394386167, -6956.922071482337, -7088.209427875218, -7064.594289810642, -6940.504955055777, -7130.810313300896, -7082.376107966857, -7002.202110324274, -6936.2480592936245, -7100.72250874128, -7021.215123461855, -7078.492281506492, -7058.18426651735, -7165.856608548078, -7091.593360217844, -6982.041884454672, -6995.766701171402, -7005.125250829107, -6998.122880892173, -6999.881975986087, -6897.575843580419, -6999.032029919281, -6927.287035903237, -7075.565754985772, -6833.375325217441, -7113.299728443704, -7152.451555348877, -7176.19230452039, -7055.762398842322, -6962.554228305463, -6994.231144372555, -7093.922080242668, -7073.69185690152, -7061.972758395433, -7098.346686411997, -7059.960118478598, -7141.666941964138, -6964.956240607673, -7024.262777255779, -6984.5164476153195, -7146.26719683038, -7052.197402042947, -6926.088343663724, -6930.404533176647, -7091.509670576999, -7000.025414988401, -7155.803125543254, -6930.210957654184, -7029.909811377778, -7072.606524772726, -7193.148038609042, -7006.156456292769, -7001.914382608852, -7144.865642034664, -6995.5622990461, -6974.745524322425, -6968.304171338026], "episode_lengths": [1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.390007682969052, "mean_inference_ms": 0.23076596285171957, "mean_action_processing_ms": 0.0561804482795333, "mean_env_wait_ms": 0.5340834466216898, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002352644999821981, "StateBufferConnector_ms": 0.0018462538719177246, "ViewRequirementAgentConnector_ms": 0.04319573442141215}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 48523800, "num_agent_steps_trained": 48523800, "num_env_steps_sampled": 48523800, "num_env_steps_trained": 48523800, "num_env_steps_sampled_this_iter": 4800, "num_env_steps_trained_this_iter": 4800, "num_env_steps_sampled_throughput_per_sec": 456.0652781747403, "num_env_steps_trained_throughput_per_sec": 456.0652781747403, "timesteps_total": 48523800, "num_steps_trained_this_iter": 4800, "agent_timesteps_total": 48523800, "timers": {"training_iteration_time_ms": 2638.793, "sample_time_ms": 2618.245, "load_time_ms": 0.41, "load_throughput": 2927790.588, "learn_time_ms": 19.546, "learn_throughput": 61393.984, "synch_weights_time_ms": 0.556}, "counters": {"num_env_steps_sampled": 48523800, "num_env_steps_trained": 48523800, "num_agent_steps_sampled": 48523800, "num_agent_steps_trained": 48523800}, "done": false, "episodes_total": 10013, "training_iteration": 3139, "trial_id": "4bd41_00000", "date": "2023-08-08_07-34-44", "timestamp": 1691469284, "time_this_iter_s": 10.526823282241821, "time_total_s": 83732.82022714615, "pid": 11406, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 10, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[48412200, 5e-09], [48430200, 5e-09], [48448200, 5e-09], [48466200, 2.5e-09], [48484200, 2.5e-09], [48502200, 2.5e-09], [48520200, 2.5e-09], [48538200, 1e-09], [48556200, 1e-09], [48574200, 1e-09], [48592200, 1e-09], [48610200, 1e-09], [48628200, 5e-10], [48646200, 5e-10], [48664200, 5e-10], [48682200, 5e-10], [48700200, 2.5e-10], [48718200, 2.5e-10], [48736200, 2.5e-10], [48754200, 2.5e-10], [48772200, 1e-10], [48790200, 1e-10], [48808200, 1e-10], [48826200, 5e-11], [48844200, 5e-11], [48862200, 5e-11]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.3, "final_epsilon": 0.01, "epsilon_timesteps": 48880200}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 1200, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17eb87820>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 254.60833859443665, "iterations_since_restore": 24, "perf": {"cpu_util_percent": 17.57333333333333, "ram_util_percent": 55.46666666666667}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1.8999999999999996e-09, "entropy_coeff": 0.10000000000000002, "policy_entropy": -363.8023630777995, "policy_loss": -5050017.926649306, "vf_loss": 9823821.222222222}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 1791.5, "diff_num_grad_updates_vs_sampler_policy": 1790.5}}, "num_env_steps_sampled": 48528600, "num_env_steps_trained": 48528600, "num_agent_steps_sampled": 48528600, "num_agent_steps_trained": 48528600}, "sampler_results": {"episode_reward_max": -6833.375325217441, "episode_reward_min": -7258.694817064271, "episode_reward_mean": -7040.4681021474025, "episode_len_mean": 1200.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-7192.935015412464, -6939.769104344216, -6964.646815398022, -7101.818584523901, -7004.560091406043, -7080.420514360684, -7003.95476470443, -7006.802229214072, -7108.819924944902, -7077.238211770432, -6958.74477233818, -6897.9347297838385, -7133.0413473706885, -7106.175846091458, -7022.508151062388, -7055.4471655907755, -7156.551730099049, -7118.253979107904, -6960.48613997543, -7059.036381330186, -7258.694817064271, -7103.609693153824, -6959.141746836437, -6978.102502571718, -7023.055259216437, -7054.420855284454, -7221.500670767508, -6996.610295665902, -6863.816864875627, -7135.441374732098, -7072.856803490325, -6977.297268978018, -7045.858383823964, -7116.76351670452, -7075.866883064482, -7004.356629016461, -7049.743980503448, -7085.78856131624, -6955.217855184973, -7065.806394386167, -6956.922071482337, -7088.209427875218, -7064.594289810642, -6940.504955055777, -7130.810313300896, -7082.376107966857, -7002.202110324274, -6936.2480592936245, -7100.72250874128, -7021.215123461855, -7078.492281506492, -7058.18426651735, -7165.856608548078, -7091.593360217844, -6982.041884454672, -6995.766701171402, -7005.125250829107, -6998.122880892173, -6999.881975986087, -6897.575843580419, -6999.032029919281, -6927.287035903237, -7075.565754985772, -6833.375325217441, -7113.299728443704, -7152.451555348877, -7176.19230452039, -7055.762398842322, -6962.554228305463, -6994.231144372555, -7093.922080242668, -7073.69185690152, -7061.972758395433, -7098.346686411997, -7059.960118478598, -7141.666941964138, -6964.956240607673, -7024.262777255779, -6984.5164476153195, -7146.26719683038, -7052.197402042947, -6926.088343663724, -6930.404533176647, -7091.509670576999, -7000.025414988401, -7155.803125543254, -6930.210957654184, -7029.909811377778, -7072.606524772726, -7193.148038609042, -7006.156456292769, -7001.914382608852, -7144.865642034664, -6995.5622990461, -6974.745524322425, -6968.304171338026, -6980.846861410689, -7075.252526474274, -7032.610450405647, -6955.7915913561255], "episode_lengths": [1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.3901321207519783, "mean_inference_ms": 0.2307762671350666, "mean_action_processing_ms": 0.05618801513653762, "mean_env_wait_ms": 0.5326078467160109, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002348184585571289, "StateBufferConnector_ms": 0.0018472671508789062, "ViewRequirementAgentConnector_ms": 0.0432438850402832}}, "episode_reward_max": -6833.375325217441, "episode_reward_min": -7258.694817064271, "episode_reward_mean": -7040.4681021474025, "episode_len_mean": 1200.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-7192.935015412464, -6939.769104344216, -6964.646815398022, -7101.818584523901, -7004.560091406043, -7080.420514360684, -7003.95476470443, -7006.802229214072, -7108.819924944902, -7077.238211770432, -6958.74477233818, -6897.9347297838385, -7133.0413473706885, -7106.175846091458, -7022.508151062388, -7055.4471655907755, -7156.551730099049, -7118.253979107904, -6960.48613997543, -7059.036381330186, -7258.694817064271, -7103.609693153824, -6959.141746836437, -6978.102502571718, -7023.055259216437, -7054.420855284454, -7221.500670767508, -6996.610295665902, -6863.816864875627, -7135.441374732098, -7072.856803490325, -6977.297268978018, -7045.858383823964, -7116.76351670452, -7075.866883064482, -7004.356629016461, -7049.743980503448, -7085.78856131624, -6955.217855184973, -7065.806394386167, -6956.922071482337, -7088.209427875218, -7064.594289810642, -6940.504955055777, -7130.810313300896, -7082.376107966857, -7002.202110324274, -6936.2480592936245, -7100.72250874128, -7021.215123461855, -7078.492281506492, -7058.18426651735, -7165.856608548078, -7091.593360217844, -6982.041884454672, -6995.766701171402, -7005.125250829107, -6998.122880892173, -6999.881975986087, -6897.575843580419, -6999.032029919281, -6927.287035903237, -7075.565754985772, -6833.375325217441, -7113.299728443704, -7152.451555348877, -7176.19230452039, -7055.762398842322, -6962.554228305463, -6994.231144372555, -7093.922080242668, -7073.69185690152, -7061.972758395433, -7098.346686411997, -7059.960118478598, -7141.666941964138, -6964.956240607673, -7024.262777255779, -6984.5164476153195, -7146.26719683038, -7052.197402042947, -6926.088343663724, -6930.404533176647, -7091.509670576999, -7000.025414988401, -7155.803125543254, -6930.210957654184, -7029.909811377778, -7072.606524772726, -7193.148038609042, -7006.156456292769, -7001.914382608852, -7144.865642034664, -6995.5622990461, -6974.745524322425, -6968.304171338026, -6980.846861410689, -7075.252526474274, -7032.610450405647, -6955.7915913561255], "episode_lengths": [1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.3901321207519783, "mean_inference_ms": 0.2307762671350666, "mean_action_processing_ms": 0.05618801513653762, "mean_env_wait_ms": 0.5326078467160109, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002348184585571289, "StateBufferConnector_ms": 0.0018472671508789062, "ViewRequirementAgentConnector_ms": 0.0432438850402832}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 48528600, "num_agent_steps_trained": 48528600, "num_env_steps_sampled": 48528600, "num_env_steps_trained": 48528600, "num_env_steps_sampled_this_iter": 4800, "num_env_steps_trained_this_iter": 4800, "num_env_steps_sampled_throughput_per_sec": 456.287373850259, "num_env_steps_trained_throughput_per_sec": 456.287373850259, "timesteps_total": 48528600, "num_steps_trained_this_iter": 4800, "agent_timesteps_total": 48528600, "timers": {"training_iteration_time_ms": 2633.602, "sample_time_ms": 2612.837, "load_time_ms": 0.41, "load_throughput": 2927960.908, "learn_time_ms": 19.756, "learn_throughput": 60740.872, "synch_weights_time_ms": 0.562}, "counters": {"num_env_steps_sampled": 48528600, "num_env_steps_trained": 48528600, "num_agent_steps_sampled": 48528600, "num_agent_steps_trained": 48528600}, "done": false, "episodes_total": 10017, "training_iteration": 3140, "trial_id": "4bd41_00000", "date": "2023-08-08_07-34-55", "timestamp": 1691469295, "time_this_iter_s": 10.521739959716797, "time_total_s": 83743.34196710587, "pid": 11406, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 10, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[48412200, 5e-09], [48430200, 5e-09], [48448200, 5e-09], [48466200, 2.5e-09], [48484200, 2.5e-09], [48502200, 2.5e-09], [48520200, 2.5e-09], [48538200, 1e-09], [48556200, 1e-09], [48574200, 1e-09], [48592200, 1e-09], [48610200, 1e-09], [48628200, 5e-10], [48646200, 5e-10], [48664200, 5e-10], [48682200, 5e-10], [48700200, 2.5e-10], [48718200, 2.5e-10], [48736200, 2.5e-10], [48754200, 2.5e-10], [48772200, 1e-10], [48790200, 1e-10], [48808200, 1e-10], [48826200, 5e-11], [48844200, 5e-11], [48862200, 5e-11]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.3, "final_epsilon": 0.01, "epsilon_timesteps": 48880200}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 1200, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17eb87820>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 265.13007855415344, "iterations_since_restore": 25, "perf": {"cpu_util_percent": 17.24666666666667, "ram_util_percent": 55.26666666666666}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1.5000000000000002e-09, "entropy_coeff": 0.10000000000000002, "policy_entropy": -367.9941219753689, "policy_loss": -4225115.870442708, "vf_loss": 9987013.430555556}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 1863.5, "diff_num_grad_updates_vs_sampler_policy": 1862.5}}, "num_env_steps_sampled": 48533400, "num_env_steps_trained": 48533400, "num_agent_steps_sampled": 48533400, "num_agent_steps_trained": 48533400}, "sampler_results": {"episode_reward_max": -6833.375325217441, "episode_reward_min": -7258.694817064271, "episode_reward_mean": -7040.481767465958, "episode_len_mean": 1200.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-7004.560091406043, -7080.420514360684, -7003.95476470443, -7006.802229214072, -7108.819924944902, -7077.238211770432, -6958.74477233818, -6897.9347297838385, -7133.0413473706885, -7106.175846091458, -7022.508151062388, -7055.4471655907755, -7156.551730099049, -7118.253979107904, -6960.48613997543, -7059.036381330186, -7258.694817064271, -7103.609693153824, -6959.141746836437, -6978.102502571718, -7023.055259216437, -7054.420855284454, -7221.500670767508, -6996.610295665902, -6863.816864875627, -7135.441374732098, -7072.856803490325, -6977.297268978018, -7045.858383823964, -7116.76351670452, -7075.866883064482, -7004.356629016461, -7049.743980503448, -7085.78856131624, -6955.217855184973, -7065.806394386167, -6956.922071482337, -7088.209427875218, -7064.594289810642, -6940.504955055777, -7130.810313300896, -7082.376107966857, -7002.202110324274, -6936.2480592936245, -7100.72250874128, -7021.215123461855, -7078.492281506492, -7058.18426651735, -7165.856608548078, -7091.593360217844, -6982.041884454672, -6995.766701171402, -7005.125250829107, -6998.122880892173, -6999.881975986087, -6897.575843580419, -6999.032029919281, -6927.287035903237, -7075.565754985772, -6833.375325217441, -7113.299728443704, -7152.451555348877, -7176.19230452039, -7055.762398842322, -6962.554228305463, -6994.231144372555, -7093.922080242668, -7073.69185690152, -7061.972758395433, -7098.346686411997, -7059.960118478598, -7141.666941964138, -6964.956240607673, -7024.262777255779, -6984.5164476153195, -7146.26719683038, -7052.197402042947, -6926.088343663724, -6930.404533176647, -7091.509670576999, -7000.025414988401, -7155.803125543254, -6930.210957654184, -7029.909811377778, -7072.606524772726, -7193.148038609042, -7006.156456292769, -7001.914382608852, -7144.865642034664, -6995.5622990461, -6974.745524322425, -6968.304171338026, -6980.846861410689, -7075.252526474274, -7032.610450405647, -6955.7915913561255, -7060.5960455186205, -7114.440117574603, -7037.721288460172, -6987.778599980701], "episode_lengths": [1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.3907307286727724, "mean_inference_ms": 0.23077547681619684, "mean_action_processing_ms": 0.0562121826869223, "mean_env_wait_ms": 0.5204137979309849, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002348184585571289, "StateBufferConnector_ms": 0.0018448829650878906, "ViewRequirementAgentConnector_ms": 0.04325604438781738}}, "episode_reward_max": -6833.375325217441, "episode_reward_min": -7258.694817064271, "episode_reward_mean": -7040.481767465958, "episode_len_mean": 1200.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-7004.560091406043, -7080.420514360684, -7003.95476470443, -7006.802229214072, -7108.819924944902, -7077.238211770432, -6958.74477233818, -6897.9347297838385, -7133.0413473706885, -7106.175846091458, -7022.508151062388, -7055.4471655907755, -7156.551730099049, -7118.253979107904, -6960.48613997543, -7059.036381330186, -7258.694817064271, -7103.609693153824, -6959.141746836437, -6978.102502571718, -7023.055259216437, -7054.420855284454, -7221.500670767508, -6996.610295665902, -6863.816864875627, -7135.441374732098, -7072.856803490325, -6977.297268978018, -7045.858383823964, -7116.76351670452, -7075.866883064482, -7004.356629016461, -7049.743980503448, -7085.78856131624, -6955.217855184973, -7065.806394386167, -6956.922071482337, -7088.209427875218, -7064.594289810642, -6940.504955055777, -7130.810313300896, -7082.376107966857, -7002.202110324274, -6936.2480592936245, -7100.72250874128, -7021.215123461855, -7078.492281506492, -7058.18426651735, -7165.856608548078, -7091.593360217844, -6982.041884454672, -6995.766701171402, -7005.125250829107, -6998.122880892173, -6999.881975986087, -6897.575843580419, -6999.032029919281, -6927.287035903237, -7075.565754985772, -6833.375325217441, -7113.299728443704, -7152.451555348877, -7176.19230452039, -7055.762398842322, -6962.554228305463, -6994.231144372555, -7093.922080242668, -7073.69185690152, -7061.972758395433, -7098.346686411997, -7059.960118478598, -7141.666941964138, -6964.956240607673, -7024.262777255779, -6984.5164476153195, -7146.26719683038, -7052.197402042947, -6926.088343663724, -6930.404533176647, -7091.509670576999, -7000.025414988401, -7155.803125543254, -6930.210957654184, -7029.909811377778, -7072.606524772726, -7193.148038609042, -7006.156456292769, -7001.914382608852, -7144.865642034664, -6995.5622990461, -6974.745524322425, -6968.304171338026, -6980.846861410689, -7075.252526474274, -7032.610450405647, -6955.7915913561255, -7060.5960455186205, -7114.440117574603, -7037.721288460172, -6987.778599980701], "episode_lengths": [1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.3907307286727724, "mean_inference_ms": 0.23077547681619684, "mean_action_processing_ms": 0.0562121826869223, "mean_env_wait_ms": 0.5204137979309849, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002348184585571289, "StateBufferConnector_ms": 0.0018448829650878906, "ViewRequirementAgentConnector_ms": 0.04325604438781738}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 48533400, "num_agent_steps_trained": 48533400, "num_env_steps_sampled": 48533400, "num_env_steps_trained": 48533400, "num_env_steps_sampled_this_iter": 4800, "num_env_steps_trained_this_iter": 4800, "num_env_steps_sampled_throughput_per_sec": 453.79635034086016, "num_env_steps_trained_throughput_per_sec": 453.79635034086016, "timesteps_total": 48533400, "num_steps_trained_this_iter": 4800, "agent_timesteps_total": 48533400, "timers": {"training_iteration_time_ms": 2634.693, "sample_time_ms": 2613.934, "load_time_ms": 0.408, "load_throughput": 2943887.7, "learn_time_ms": 19.756, "learn_throughput": 60741.092, "synch_weights_time_ms": 0.559}, "counters": {"num_env_steps_sampled": 48533400, "num_env_steps_trained": 48533400, "num_agent_steps_sampled": 48533400, "num_agent_steps_trained": 48533400}, "done": false, "episodes_total": 10021, "training_iteration": 3141, "trial_id": "4bd41_00000", "date": "2023-08-08_07-35-05", "timestamp": 1691469305, "time_this_iter_s": 10.57966685295105, "time_total_s": 83753.92163395882, "pid": 11406, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 10, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[48412200, 5e-09], [48430200, 5e-09], [48448200, 5e-09], [48466200, 2.5e-09], [48484200, 2.5e-09], [48502200, 2.5e-09], [48520200, 2.5e-09], [48538200, 1e-09], [48556200, 1e-09], [48574200, 1e-09], [48592200, 1e-09], [48610200, 1e-09], [48628200, 5e-10], [48646200, 5e-10], [48664200, 5e-10], [48682200, 5e-10], [48700200, 2.5e-10], [48718200, 2.5e-10], [48736200, 2.5e-10], [48754200, 2.5e-10], [48772200, 1e-10], [48790200, 1e-10], [48808200, 1e-10], [48826200, 5e-11], [48844200, 5e-11], [48862200, 5e-11]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.3, "final_epsilon": 0.01, "epsilon_timesteps": 48880200}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 1200, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17eb87820>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 275.7097454071045, "iterations_since_restore": 26, "perf": {"cpu_util_percent": 17.40666666666667, "ram_util_percent": 55.19333333333334}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1.1000000000000001e-09, "entropy_coeff": 0.10000000000000002, "policy_entropy": -366.05170186360675, "policy_loss": -4910877.159505208, "vf_loss": 9932892.791666666}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 1935.5, "diff_num_grad_updates_vs_sampler_policy": 1934.5}}, "num_env_steps_sampled": 48538200, "num_env_steps_trained": 48538200, "num_agent_steps_sampled": 48538200, "num_agent_steps_trained": 48538200}, "sampler_results": {"episode_reward_max": -6833.375325217441, "episode_reward_min": -7258.694817064271, "episode_reward_mean": -7041.208375019378, "episode_len_mean": 1200.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-7108.819924944902, -7077.238211770432, -6958.74477233818, -6897.9347297838385, -7133.0413473706885, -7106.175846091458, -7022.508151062388, -7055.4471655907755, -7156.551730099049, -7118.253979107904, -6960.48613997543, -7059.036381330186, -7258.694817064271, -7103.609693153824, -6959.141746836437, -6978.102502571718, -7023.055259216437, -7054.420855284454, -7221.500670767508, -6996.610295665902, -6863.816864875627, -7135.441374732098, -7072.856803490325, -6977.297268978018, -7045.858383823964, -7116.76351670452, -7075.866883064482, -7004.356629016461, -7049.743980503448, -7085.78856131624, -6955.217855184973, -7065.806394386167, -6956.922071482337, -7088.209427875218, -7064.594289810642, -6940.504955055777, -7130.810313300896, -7082.376107966857, -7002.202110324274, -6936.2480592936245, -7100.72250874128, -7021.215123461855, -7078.492281506492, -7058.18426651735, -7165.856608548078, -7091.593360217844, -6982.041884454672, -6995.766701171402, -7005.125250829107, -6998.122880892173, -6999.881975986087, -6897.575843580419, -6999.032029919281, -6927.287035903237, -7075.565754985772, -6833.375325217441, -7113.299728443704, -7152.451555348877, -7176.19230452039, -7055.762398842322, -6962.554228305463, -6994.231144372555, -7093.922080242668, -7073.69185690152, -7061.972758395433, -7098.346686411997, -7059.960118478598, -7141.666941964138, -6964.956240607673, -7024.262777255779, -6984.5164476153195, -7146.26719683038, -7052.197402042947, -6926.088343663724, -6930.404533176647, -7091.509670576999, -7000.025414988401, -7155.803125543254, -6930.210957654184, -7029.909811377778, -7072.606524772726, -7193.148038609042, -7006.156456292769, -7001.914382608852, -7144.865642034664, -6995.5622990461, -6974.745524322425, -6968.304171338026, -6980.846861410689, -7075.252526474274, -7032.610450405647, -6955.7915913561255, -7060.5960455186205, -7114.440117574603, -7037.721288460172, -6987.778599980701, -6959.082944138272, -7126.327775626586, -7104.231212636027, -6978.756422626538], "episode_lengths": [1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.3912387500386956, "mean_inference_ms": 0.23079306711948483, "mean_action_processing_ms": 0.05623848808447303, "mean_env_wait_ms": 0.5147552462048556, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002354860305786133, "StateBufferConnector_ms": 0.0018374919891357422, "ViewRequirementAgentConnector_ms": 0.04322695732116699}}, "episode_reward_max": -6833.375325217441, "episode_reward_min": -7258.694817064271, "episode_reward_mean": -7041.208375019378, "episode_len_mean": 1200.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-7108.819924944902, -7077.238211770432, -6958.74477233818, -6897.9347297838385, -7133.0413473706885, -7106.175846091458, -7022.508151062388, -7055.4471655907755, -7156.551730099049, -7118.253979107904, -6960.48613997543, -7059.036381330186, -7258.694817064271, -7103.609693153824, -6959.141746836437, -6978.102502571718, -7023.055259216437, -7054.420855284454, -7221.500670767508, -6996.610295665902, -6863.816864875627, -7135.441374732098, -7072.856803490325, -6977.297268978018, -7045.858383823964, -7116.76351670452, -7075.866883064482, -7004.356629016461, -7049.743980503448, -7085.78856131624, -6955.217855184973, -7065.806394386167, -6956.922071482337, -7088.209427875218, -7064.594289810642, -6940.504955055777, -7130.810313300896, -7082.376107966857, -7002.202110324274, -6936.2480592936245, -7100.72250874128, -7021.215123461855, -7078.492281506492, -7058.18426651735, -7165.856608548078, -7091.593360217844, -6982.041884454672, -6995.766701171402, -7005.125250829107, -6998.122880892173, -6999.881975986087, -6897.575843580419, -6999.032029919281, -6927.287035903237, -7075.565754985772, -6833.375325217441, -7113.299728443704, -7152.451555348877, -7176.19230452039, -7055.762398842322, -6962.554228305463, -6994.231144372555, -7093.922080242668, -7073.69185690152, -7061.972758395433, -7098.346686411997, -7059.960118478598, -7141.666941964138, -6964.956240607673, -7024.262777255779, -6984.5164476153195, -7146.26719683038, -7052.197402042947, -6926.088343663724, -6930.404533176647, -7091.509670576999, -7000.025414988401, -7155.803125543254, -6930.210957654184, -7029.909811377778, -7072.606524772726, -7193.148038609042, -7006.156456292769, -7001.914382608852, -7144.865642034664, -6995.5622990461, -6974.745524322425, -6968.304171338026, -6980.846861410689, -7075.252526474274, -7032.610450405647, -6955.7915913561255, -7060.5960455186205, -7114.440117574603, -7037.721288460172, -6987.778599980701, -6959.082944138272, -7126.327775626586, -7104.231212636027, -6978.756422626538], "episode_lengths": [1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.3912387500386956, "mean_inference_ms": 0.23079306711948483, "mean_action_processing_ms": 0.05623848808447303, "mean_env_wait_ms": 0.5147552462048556, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002354860305786133, "StateBufferConnector_ms": 0.0018374919891357422, "ViewRequirementAgentConnector_ms": 0.04322695732116699}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 48538200, "num_agent_steps_trained": 48538200, "num_env_steps_sampled": 48538200, "num_env_steps_trained": 48538200, "num_env_steps_sampled_this_iter": 4800, "num_env_steps_trained_this_iter": 4800, "num_env_steps_sampled_throughput_per_sec": 453.1605767348693, "num_env_steps_trained_throughput_per_sec": 453.1605767348693, "timesteps_total": 48538200, "num_steps_trained_this_iter": 4800, "agent_timesteps_total": 48538200, "timers": {"training_iteration_time_ms": 2642.088, "sample_time_ms": 2621.205, "load_time_ms": 0.409, "load_throughput": 2932737.909, "learn_time_ms": 19.87, "learn_throughput": 60392.639, "synch_weights_time_ms": 0.567}, "counters": {"num_env_steps_sampled": 48538200, "num_env_steps_trained": 48538200, "num_agent_steps_sampled": 48538200, "num_agent_steps_trained": 48538200}, "done": false, "episodes_total": 10025, "training_iteration": 3142, "trial_id": "4bd41_00000", "date": "2023-08-08_07-35-16", "timestamp": 1691469316, "time_this_iter_s": 10.59433126449585, "time_total_s": 83764.51596522331, "pid": 11406, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 10, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[48412200, 5e-09], [48430200, 5e-09], [48448200, 5e-09], [48466200, 2.5e-09], [48484200, 2.5e-09], [48502200, 2.5e-09], [48520200, 2.5e-09], [48538200, 1e-09], [48556200, 1e-09], [48574200, 1e-09], [48592200, 1e-09], [48610200, 1e-09], [48628200, 5e-10], [48646200, 5e-10], [48664200, 5e-10], [48682200, 5e-10], [48700200, 2.5e-10], [48718200, 2.5e-10], [48736200, 2.5e-10], [48754200, 2.5e-10], [48772200, 1e-10], [48790200, 1e-10], [48808200, 1e-10], [48826200, 5e-11], [48844200, 5e-11], [48862200, 5e-11]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.3, "final_epsilon": 0.01, "epsilon_timesteps": 48880200}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 1200, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17eb87820>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 286.30407667160034, "iterations_since_restore": 27, "perf": {"cpu_util_percent": 17.62666666666666, "ram_util_percent": 55.233333333333334}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 9.999999999999999e-10, "entropy_coeff": 0.10000000000000002, "policy_entropy": -363.3721991644965, "policy_loss": -2718429.82421875, "vf_loss": 9820461.958333334}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 2007.5, "diff_num_grad_updates_vs_sampler_policy": 2006.5}}, "num_env_steps_sampled": 48543000, "num_env_steps_trained": 48543000, "num_agent_steps_sampled": 48543000, "num_agent_steps_trained": 48543000}, "sampler_results": {"episode_reward_max": -6833.375325217441, "episode_reward_min": -7258.694817064271, "episode_reward_mean": -7039.89570962793, "episode_len_mean": 1200.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-7133.0413473706885, -7106.175846091458, -7022.508151062388, -7055.4471655907755, -7156.551730099049, -7118.253979107904, -6960.48613997543, -7059.036381330186, -7258.694817064271, -7103.609693153824, -6959.141746836437, -6978.102502571718, -7023.055259216437, -7054.420855284454, -7221.500670767508, -6996.610295665902, -6863.816864875627, -7135.441374732098, -7072.856803490325, -6977.297268978018, -7045.858383823964, -7116.76351670452, -7075.866883064482, -7004.356629016461, -7049.743980503448, -7085.78856131624, -6955.217855184973, -7065.806394386167, -6956.922071482337, -7088.209427875218, -7064.594289810642, -6940.504955055777, -7130.810313300896, -7082.376107966857, -7002.202110324274, -6936.2480592936245, -7100.72250874128, -7021.215123461855, -7078.492281506492, -7058.18426651735, -7165.856608548078, -7091.593360217844, -6982.041884454672, -6995.766701171402, -7005.125250829107, -6998.122880892173, -6999.881975986087, -6897.575843580419, -6999.032029919281, -6927.287035903237, -7075.565754985772, -6833.375325217441, -7113.299728443704, -7152.451555348877, -7176.19230452039, -7055.762398842322, -6962.554228305463, -6994.231144372555, -7093.922080242668, -7073.69185690152, -7061.972758395433, -7098.346686411997, -7059.960118478598, -7141.666941964138, -6964.956240607673, -7024.262777255779, -6984.5164476153195, -7146.26719683038, -7052.197402042947, -6926.088343663724, -6930.404533176647, -7091.509670576999, -7000.025414988401, -7155.803125543254, -6930.210957654184, -7029.909811377778, -7072.606524772726, -7193.148038609042, -7006.156456292769, -7001.914382608852, -7144.865642034664, -6995.5622990461, -6974.745524322425, -6968.304171338026, -6980.846861410689, -7075.252526474274, -7032.610450405647, -6955.7915913561255, -7060.5960455186205, -7114.440117574603, -7037.721288460172, -6987.778599980701, -6959.082944138272, -7126.327775626586, -7104.231212636027, -6978.756422626538, -7040.223373487282, -7008.819672401102, -6900.361053042657, -6962.0670007614835], "episode_lengths": [1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.3916534407782177, "mean_inference_ms": 0.230831359101995, "mean_action_processing_ms": 0.056267909763153344, "mean_env_wait_ms": 0.511242773483728, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0023589134216308594, "StateBufferConnector_ms": 0.0018436908721923828, "ViewRequirementAgentConnector_ms": 0.04320669174194336}}, "episode_reward_max": -6833.375325217441, "episode_reward_min": -7258.694817064271, "episode_reward_mean": -7039.89570962793, "episode_len_mean": 1200.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-7133.0413473706885, -7106.175846091458, -7022.508151062388, -7055.4471655907755, -7156.551730099049, -7118.253979107904, -6960.48613997543, -7059.036381330186, -7258.694817064271, -7103.609693153824, -6959.141746836437, -6978.102502571718, -7023.055259216437, -7054.420855284454, -7221.500670767508, -6996.610295665902, -6863.816864875627, -7135.441374732098, -7072.856803490325, -6977.297268978018, -7045.858383823964, -7116.76351670452, -7075.866883064482, -7004.356629016461, -7049.743980503448, -7085.78856131624, -6955.217855184973, -7065.806394386167, -6956.922071482337, -7088.209427875218, -7064.594289810642, -6940.504955055777, -7130.810313300896, -7082.376107966857, -7002.202110324274, -6936.2480592936245, -7100.72250874128, -7021.215123461855, -7078.492281506492, -7058.18426651735, -7165.856608548078, -7091.593360217844, -6982.041884454672, -6995.766701171402, -7005.125250829107, -6998.122880892173, -6999.881975986087, -6897.575843580419, -6999.032029919281, -6927.287035903237, -7075.565754985772, -6833.375325217441, -7113.299728443704, -7152.451555348877, -7176.19230452039, -7055.762398842322, -6962.554228305463, -6994.231144372555, -7093.922080242668, -7073.69185690152, -7061.972758395433, -7098.346686411997, -7059.960118478598, -7141.666941964138, -6964.956240607673, -7024.262777255779, -6984.5164476153195, -7146.26719683038, -7052.197402042947, -6926.088343663724, -6930.404533176647, -7091.509670576999, -7000.025414988401, -7155.803125543254, -6930.210957654184, -7029.909811377778, -7072.606524772726, -7193.148038609042, -7006.156456292769, -7001.914382608852, -7144.865642034664, -6995.5622990461, -6974.745524322425, -6968.304171338026, -6980.846861410689, -7075.252526474274, -7032.610450405647, -6955.7915913561255, -7060.5960455186205, -7114.440117574603, -7037.721288460172, -6987.778599980701, -6959.082944138272, -7126.327775626586, -7104.231212636027, -6978.756422626538, -7040.223373487282, -7008.819672401102, -6900.361053042657, -6962.0670007614835], "episode_lengths": [1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.3916534407782177, "mean_inference_ms": 0.230831359101995, "mean_action_processing_ms": 0.056267909763153344, "mean_env_wait_ms": 0.511242773483728, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0023589134216308594, "StateBufferConnector_ms": 0.0018436908721923828, "ViewRequirementAgentConnector_ms": 0.04320669174194336}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 48543000, "num_agent_steps_trained": 48543000, "num_env_steps_sampled": 48543000, "num_env_steps_trained": 48543000, "num_env_steps_sampled_this_iter": 4800, "num_env_steps_trained_this_iter": 4800, "num_env_steps_sampled_throughput_per_sec": 456.90200941565865, "num_env_steps_trained_throughput_per_sec": 456.90200941565865, "timesteps_total": 48543000, "num_steps_trained_this_iter": 4800, "agent_timesteps_total": 48543000, "timers": {"training_iteration_time_ms": 2640.421, "sample_time_ms": 2619.684, "load_time_ms": 0.409, "load_throughput": 2932225.342, "learn_time_ms": 19.737, "learn_throughput": 60798.396, "synch_weights_time_ms": 0.552}, "counters": {"num_env_steps_sampled": 48543000, "num_env_steps_trained": 48543000, "num_agent_steps_sampled": 48543000, "num_agent_steps_trained": 48543000}, "done": false, "episodes_total": 10029, "training_iteration": 3143, "trial_id": "4bd41_00000", "date": "2023-08-08_07-35-26", "timestamp": 1691469326, "time_this_iter_s": 10.507542133331299, "time_total_s": 83775.02350735664, "pid": 11406, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 10, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[48412200, 5e-09], [48430200, 5e-09], [48448200, 5e-09], [48466200, 2.5e-09], [48484200, 2.5e-09], [48502200, 2.5e-09], [48520200, 2.5e-09], [48538200, 1e-09], [48556200, 1e-09], [48574200, 1e-09], [48592200, 1e-09], [48610200, 1e-09], [48628200, 5e-10], [48646200, 5e-10], [48664200, 5e-10], [48682200, 5e-10], [48700200, 2.5e-10], [48718200, 2.5e-10], [48736200, 2.5e-10], [48754200, 2.5e-10], [48772200, 1e-10], [48790200, 1e-10], [48808200, 1e-10], [48826200, 5e-11], [48844200, 5e-11], [48862200, 5e-11]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.3, "final_epsilon": 0.01, "epsilon_timesteps": 48880200}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 1200, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17eb87820>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 296.81161880493164, "iterations_since_restore": 28, "perf": {"cpu_util_percent": 17.486666666666668, "ram_util_percent": 55.32}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 9.999999999999999e-10, "entropy_coeff": 0.10000000000000002, "policy_entropy": -364.13040500217016, "policy_loss": -7286917.136284722, "vf_loss": 10184790.583333334}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 2079.5, "diff_num_grad_updates_vs_sampler_policy": 2078.5}}, "num_env_steps_sampled": 48547800, "num_env_steps_trained": 48547800, "num_agent_steps_sampled": 48547800, "num_agent_steps_trained": 48547800}, "sampler_results": {"episode_reward_max": -6833.375325217441, "episode_reward_min": -7258.694817064271, "episode_reward_mean": -7039.233418090327, "episode_len_mean": 1200.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-7156.551730099049, -7118.253979107904, -6960.48613997543, -7059.036381330186, -7258.694817064271, -7103.609693153824, -6959.141746836437, -6978.102502571718, -7023.055259216437, -7054.420855284454, -7221.500670767508, -6996.610295665902, -6863.816864875627, -7135.441374732098, -7072.856803490325, -6977.297268978018, -7045.858383823964, -7116.76351670452, -7075.866883064482, -7004.356629016461, -7049.743980503448, -7085.78856131624, -6955.217855184973, -7065.806394386167, -6956.922071482337, -7088.209427875218, -7064.594289810642, -6940.504955055777, -7130.810313300896, -7082.376107966857, -7002.202110324274, -6936.2480592936245, -7100.72250874128, -7021.215123461855, -7078.492281506492, -7058.18426651735, -7165.856608548078, -7091.593360217844, -6982.041884454672, -6995.766701171402, -7005.125250829107, -6998.122880892173, -6999.881975986087, -6897.575843580419, -6999.032029919281, -6927.287035903237, -7075.565754985772, -6833.375325217441, -7113.299728443704, -7152.451555348877, -7176.19230452039, -7055.762398842322, -6962.554228305463, -6994.231144372555, -7093.922080242668, -7073.69185690152, -7061.972758395433, -7098.346686411997, -7059.960118478598, -7141.666941964138, -6964.956240607673, -7024.262777255779, -6984.5164476153195, -7146.26719683038, -7052.197402042947, -6926.088343663724, -6930.404533176647, -7091.509670576999, -7000.025414988401, -7155.803125543254, -6930.210957654184, -7029.909811377778, -7072.606524772726, -7193.148038609042, -7006.156456292769, -7001.914382608852, -7144.865642034664, -6995.5622990461, -6974.745524322425, -6968.304171338026, -6980.846861410689, -7075.252526474274, -7032.610450405647, -6955.7915913561255, -7060.5960455186205, -7114.440117574603, -7037.721288460172, -6987.778599980701, -6959.082944138272, -7126.327775626586, -7104.231212636027, -6978.756422626538, -7040.223373487282, -7008.819672401102, -6900.361053042657, -6962.0670007614835, -7063.371044769579, -6962.867246659552, -7131.790713000119, -7092.914351925807], "episode_lengths": [1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.3919282112513387, "mean_inference_ms": 0.23086645132586248, "mean_action_processing_ms": 0.05629191405470923, "mean_env_wait_ms": 0.5085983393887563, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0023598670959472656, "StateBufferConnector_ms": 0.0018398761749267578, "ViewRequirementAgentConnector_ms": 0.04316234588623047}}, "episode_reward_max": -6833.375325217441, "episode_reward_min": -7258.694817064271, "episode_reward_mean": -7039.233418090327, "episode_len_mean": 1200.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-7156.551730099049, -7118.253979107904, -6960.48613997543, -7059.036381330186, -7258.694817064271, -7103.609693153824, -6959.141746836437, -6978.102502571718, -7023.055259216437, -7054.420855284454, -7221.500670767508, -6996.610295665902, -6863.816864875627, -7135.441374732098, -7072.856803490325, -6977.297268978018, -7045.858383823964, -7116.76351670452, -7075.866883064482, -7004.356629016461, -7049.743980503448, -7085.78856131624, -6955.217855184973, -7065.806394386167, -6956.922071482337, -7088.209427875218, -7064.594289810642, -6940.504955055777, -7130.810313300896, -7082.376107966857, -7002.202110324274, -6936.2480592936245, -7100.72250874128, -7021.215123461855, -7078.492281506492, -7058.18426651735, -7165.856608548078, -7091.593360217844, -6982.041884454672, -6995.766701171402, -7005.125250829107, -6998.122880892173, -6999.881975986087, -6897.575843580419, -6999.032029919281, -6927.287035903237, -7075.565754985772, -6833.375325217441, -7113.299728443704, -7152.451555348877, -7176.19230452039, -7055.762398842322, -6962.554228305463, -6994.231144372555, -7093.922080242668, -7073.69185690152, -7061.972758395433, -7098.346686411997, -7059.960118478598, -7141.666941964138, -6964.956240607673, -7024.262777255779, -6984.5164476153195, -7146.26719683038, -7052.197402042947, -6926.088343663724, -6930.404533176647, -7091.509670576999, -7000.025414988401, -7155.803125543254, -6930.210957654184, -7029.909811377778, -7072.606524772726, -7193.148038609042, -7006.156456292769, -7001.914382608852, -7144.865642034664, -6995.5622990461, -6974.745524322425, -6968.304171338026, -6980.846861410689, -7075.252526474274, -7032.610450405647, -6955.7915913561255, -7060.5960455186205, -7114.440117574603, -7037.721288460172, -6987.778599980701, -6959.082944138272, -7126.327775626586, -7104.231212636027, -6978.756422626538, -7040.223373487282, -7008.819672401102, -6900.361053042657, -6962.0670007614835, -7063.371044769579, -6962.867246659552, -7131.790713000119, -7092.914351925807], "episode_lengths": [1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.3919282112513387, "mean_inference_ms": 0.23086645132586248, "mean_action_processing_ms": 0.05629191405470923, "mean_env_wait_ms": 0.5085983393887563, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0023598670959472656, "StateBufferConnector_ms": 0.0018398761749267578, "ViewRequirementAgentConnector_ms": 0.04316234588623047}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 48547800, "num_agent_steps_trained": 48547800, "num_env_steps_sampled": 48547800, "num_env_steps_trained": 48547800, "num_env_steps_sampled_this_iter": 4800, "num_env_steps_trained_this_iter": 4800, "num_env_steps_sampled_throughput_per_sec": 454.21240575181207, "num_env_steps_trained_throughput_per_sec": 454.21240575181207, "timesteps_total": 48547800, "num_steps_trained_this_iter": 4800, "agent_timesteps_total": 48547800, "timers": {"training_iteration_time_ms": 2637.258, "sample_time_ms": 2616.679, "load_time_ms": 0.416, "load_throughput": 2886651.067, "learn_time_ms": 19.563, "learn_throughput": 61340.711, "synch_weights_time_ms": 0.563}, "counters": {"num_env_steps_sampled": 48547800, "num_env_steps_trained": 48547800, "num_agent_steps_sampled": 48547800, "num_agent_steps_trained": 48547800}, "done": false, "episodes_total": 10033, "training_iteration": 3144, "trial_id": "4bd41_00000", "date": "2023-08-08_07-35-37", "timestamp": 1691469337, "time_this_iter_s": 10.57011604309082, "time_total_s": 83785.59362339973, "pid": 11406, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 10, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[48412200, 5e-09], [48430200, 5e-09], [48448200, 5e-09], [48466200, 2.5e-09], [48484200, 2.5e-09], [48502200, 2.5e-09], [48520200, 2.5e-09], [48538200, 1e-09], [48556200, 1e-09], [48574200, 1e-09], [48592200, 1e-09], [48610200, 1e-09], [48628200, 5e-10], [48646200, 5e-10], [48664200, 5e-10], [48682200, 5e-10], [48700200, 2.5e-10], [48718200, 2.5e-10], [48736200, 2.5e-10], [48754200, 2.5e-10], [48772200, 1e-10], [48790200, 1e-10], [48808200, 1e-10], [48826200, 5e-11], [48844200, 5e-11], [48862200, 5e-11]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.3, "final_epsilon": 0.01, "epsilon_timesteps": 48880200}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 1200, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17eb87820>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 307.38173484802246, "iterations_since_restore": 29, "perf": {"cpu_util_percent": 17.220000000000002, "ram_util_percent": 55.29333333333334}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 9.999999999999999e-10, "entropy_coeff": 0.10000000000000002, "policy_entropy": -362.91045464409723, "policy_loss": -1757249.6588541667, "vf_loss": 9774453.430555556}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 2151.5, "diff_num_grad_updates_vs_sampler_policy": 2150.5}}, "num_env_steps_sampled": 48552600, "num_env_steps_trained": 48552600, "num_agent_steps_sampled": 48552600, "num_agent_steps_trained": 48552600}, "sampler_results": {"episode_reward_max": -6833.375325217441, "episode_reward_min": -7258.694817064271, "episode_reward_mean": -7037.113449842004, "episode_len_mean": 1200.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-7258.694817064271, -7103.609693153824, -6959.141746836437, -6978.102502571718, -7023.055259216437, -7054.420855284454, -7221.500670767508, -6996.610295665902, -6863.816864875627, -7135.441374732098, -7072.856803490325, -6977.297268978018, -7045.858383823964, -7116.76351670452, -7075.866883064482, -7004.356629016461, -7049.743980503448, -7085.78856131624, -6955.217855184973, -7065.806394386167, -6956.922071482337, -7088.209427875218, -7064.594289810642, -6940.504955055777, -7130.810313300896, -7082.376107966857, -7002.202110324274, -6936.2480592936245, -7100.72250874128, -7021.215123461855, -7078.492281506492, -7058.18426651735, -7165.856608548078, -7091.593360217844, -6982.041884454672, -6995.766701171402, -7005.125250829107, -6998.122880892173, -6999.881975986087, -6897.575843580419, -6999.032029919281, -6927.287035903237, -7075.565754985772, -6833.375325217441, -7113.299728443704, -7152.451555348877, -7176.19230452039, -7055.762398842322, -6962.554228305463, -6994.231144372555, -7093.922080242668, -7073.69185690152, -7061.972758395433, -7098.346686411997, -7059.960118478598, -7141.666941964138, -6964.956240607673, -7024.262777255779, -6984.5164476153195, -7146.26719683038, -7052.197402042947, -6926.088343663724, -6930.404533176647, -7091.509670576999, -7000.025414988401, -7155.803125543254, -6930.210957654184, -7029.909811377778, -7072.606524772726, -7193.148038609042, -7006.156456292769, -7001.914382608852, -7144.865642034664, -6995.5622990461, -6974.745524322425, -6968.304171338026, -6980.846861410689, -7075.252526474274, -7032.610450405647, -6955.7915913561255, -7060.5960455186205, -7114.440117574603, -7037.721288460172, -6987.778599980701, -6959.082944138272, -7126.327775626586, -7104.231212636027, -6978.756422626538, -7040.223373487282, -7008.819672401102, -6900.361053042657, -6962.0670007614835, -7063.371044769579, -6962.867246659552, -7131.790713000119, -7092.914351925807, -7165.682347164258, -6974.732658856332, -6987.338218700964, -6954.578180958785], "episode_lengths": [1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.3921675924800112, "mean_inference_ms": 0.2308867152056027, "mean_action_processing_ms": 0.05630854380253859, "mean_env_wait_ms": 0.5064776910580252, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002366304397583008, "StateBufferConnector_ms": 0.0018477439880371094, "ViewRequirementAgentConnector_ms": 0.04322314262390137}}, "episode_reward_max": -6833.375325217441, "episode_reward_min": -7258.694817064271, "episode_reward_mean": -7037.113449842004, "episode_len_mean": 1200.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-7258.694817064271, -7103.609693153824, -6959.141746836437, -6978.102502571718, -7023.055259216437, -7054.420855284454, -7221.500670767508, -6996.610295665902, -6863.816864875627, -7135.441374732098, -7072.856803490325, -6977.297268978018, -7045.858383823964, -7116.76351670452, -7075.866883064482, -7004.356629016461, -7049.743980503448, -7085.78856131624, -6955.217855184973, -7065.806394386167, -6956.922071482337, -7088.209427875218, -7064.594289810642, -6940.504955055777, -7130.810313300896, -7082.376107966857, -7002.202110324274, -6936.2480592936245, -7100.72250874128, -7021.215123461855, -7078.492281506492, -7058.18426651735, -7165.856608548078, -7091.593360217844, -6982.041884454672, -6995.766701171402, -7005.125250829107, -6998.122880892173, -6999.881975986087, -6897.575843580419, -6999.032029919281, -6927.287035903237, -7075.565754985772, -6833.375325217441, -7113.299728443704, -7152.451555348877, -7176.19230452039, -7055.762398842322, -6962.554228305463, -6994.231144372555, -7093.922080242668, -7073.69185690152, -7061.972758395433, -7098.346686411997, -7059.960118478598, -7141.666941964138, -6964.956240607673, -7024.262777255779, -6984.5164476153195, -7146.26719683038, -7052.197402042947, -6926.088343663724, -6930.404533176647, -7091.509670576999, -7000.025414988401, -7155.803125543254, -6930.210957654184, -7029.909811377778, -7072.606524772726, -7193.148038609042, -7006.156456292769, -7001.914382608852, -7144.865642034664, -6995.5622990461, -6974.745524322425, -6968.304171338026, -6980.846861410689, -7075.252526474274, -7032.610450405647, -6955.7915913561255, -7060.5960455186205, -7114.440117574603, -7037.721288460172, -6987.778599980701, -6959.082944138272, -7126.327775626586, -7104.231212636027, -6978.756422626538, -7040.223373487282, -7008.819672401102, -6900.361053042657, -6962.0670007614835, -7063.371044769579, -6962.867246659552, -7131.790713000119, -7092.914351925807, -7165.682347164258, -6974.732658856332, -6987.338218700964, -6954.578180958785], "episode_lengths": [1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.3921675924800112, "mean_inference_ms": 0.2308867152056027, "mean_action_processing_ms": 0.05630854380253859, "mean_env_wait_ms": 0.5064776910580252, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002366304397583008, "StateBufferConnector_ms": 0.0018477439880371094, "ViewRequirementAgentConnector_ms": 0.04322314262390137}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 48552600, "num_agent_steps_trained": 48552600, "num_env_steps_sampled": 48552600, "num_env_steps_trained": 48552600, "num_env_steps_sampled_this_iter": 4800, "num_env_steps_trained_this_iter": 4800, "num_env_steps_sampled_throughput_per_sec": 457.3744097173568, "num_env_steps_trained_throughput_per_sec": 457.3744097173568, "timesteps_total": 48552600, "num_steps_trained_this_iter": 4800, "agent_timesteps_total": 48552600, "timers": {"training_iteration_time_ms": 2628.765, "sample_time_ms": 2608.198, "load_time_ms": 0.415, "load_throughput": 2890463.906, "learn_time_ms": 19.556, "learn_throughput": 61363.446, "synch_weights_time_ms": 0.559}, "counters": {"num_env_steps_sampled": 48552600, "num_env_steps_trained": 48552600, "num_agent_steps_sampled": 48552600, "num_agent_steps_trained": 48552600}, "done": false, "episodes_total": 10037, "training_iteration": 3145, "trial_id": "4bd41_00000", "date": "2023-08-08_07-35-48", "timestamp": 1691469348, "time_this_iter_s": 10.496745824813843, "time_total_s": 83796.09036922455, "pid": 11406, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 10, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[48412200, 5e-09], [48430200, 5e-09], [48448200, 5e-09], [48466200, 2.5e-09], [48484200, 2.5e-09], [48502200, 2.5e-09], [48520200, 2.5e-09], [48538200, 1e-09], [48556200, 1e-09], [48574200, 1e-09], [48592200, 1e-09], [48610200, 1e-09], [48628200, 5e-10], [48646200, 5e-10], [48664200, 5e-10], [48682200, 5e-10], [48700200, 2.5e-10], [48718200, 2.5e-10], [48736200, 2.5e-10], [48754200, 2.5e-10], [48772200, 1e-10], [48790200, 1e-10], [48808200, 1e-10], [48826200, 5e-11], [48844200, 5e-11], [48862200, 5e-11]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.3, "final_epsilon": 0.01, "epsilon_timesteps": 48880200}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 1200, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17eb87820>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 317.8784806728363, "iterations_since_restore": 30, "perf": {"cpu_util_percent": 17.44, "ram_util_percent": 55.326666666666675}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 9.999999999999999e-10, "entropy_coeff": 0.10000000000000002, "policy_entropy": -363.42168511284723, "policy_loss": -7470456.378472222, "vf_loss": 10135335.083333334}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 2223.5, "diff_num_grad_updates_vs_sampler_policy": 2222.5}}, "num_env_steps_sampled": 48557400, "num_env_steps_trained": 48557400, "num_agent_steps_sampled": 48557400, "num_agent_steps_trained": 48557400}, "sampler_results": {"episode_reward_max": -6833.375325217441, "episode_reward_min": -7221.500670767508, "episode_reward_mean": -7034.586567783122, "episode_len_mean": 1200.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-7023.055259216437, -7054.420855284454, -7221.500670767508, -6996.610295665902, -6863.816864875627, -7135.441374732098, -7072.856803490325, -6977.297268978018, -7045.858383823964, -7116.76351670452, -7075.866883064482, -7004.356629016461, -7049.743980503448, -7085.78856131624, -6955.217855184973, -7065.806394386167, -6956.922071482337, -7088.209427875218, -7064.594289810642, -6940.504955055777, -7130.810313300896, -7082.376107966857, -7002.202110324274, -6936.2480592936245, -7100.72250874128, -7021.215123461855, -7078.492281506492, -7058.18426651735, -7165.856608548078, -7091.593360217844, -6982.041884454672, -6995.766701171402, -7005.125250829107, -6998.122880892173, -6999.881975986087, -6897.575843580419, -6999.032029919281, -6927.287035903237, -7075.565754985772, -6833.375325217441, -7113.299728443704, -7152.451555348877, -7176.19230452039, -7055.762398842322, -6962.554228305463, -6994.231144372555, -7093.922080242668, -7073.69185690152, -7061.972758395433, -7098.346686411997, -7059.960118478598, -7141.666941964138, -6964.956240607673, -7024.262777255779, -6984.5164476153195, -7146.26719683038, -7052.197402042947, -6926.088343663724, -6930.404533176647, -7091.509670576999, -7000.025414988401, -7155.803125543254, -6930.210957654184, -7029.909811377778, -7072.606524772726, -7193.148038609042, -7006.156456292769, -7001.914382608852, -7144.865642034664, -6995.5622990461, -6974.745524322425, -6968.304171338026, -6980.846861410689, -7075.252526474274, -7032.610450405647, -6955.7915913561255, -7060.5960455186205, -7114.440117574603, -7037.721288460172, -6987.778599980701, -6959.082944138272, -7126.327775626586, -7104.231212636027, -6978.756422626538, -7040.223373487282, -7008.819672401102, -6900.361053042657, -6962.0670007614835, -7063.371044769579, -6962.867246659552, -7131.790713000119, -7092.914351925807, -7165.682347164258, -6974.732658856332, -6987.338218700964, -6954.578180958785, -7003.6489920448175, -7026.794257404716, -6956.1188736786835, -7060.298430609567], "episode_lengths": [1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.3923455107951128, "mean_inference_ms": 0.23090634408224503, "mean_action_processing_ms": 0.05632075620076751, "mean_env_wait_ms": 0.5047675802306482, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0023605823516845703, "StateBufferConnector_ms": 0.0018489360809326172, "ViewRequirementAgentConnector_ms": 0.04328322410583496}}, "episode_reward_max": -6833.375325217441, "episode_reward_min": -7221.500670767508, "episode_reward_mean": -7034.586567783122, "episode_len_mean": 1200.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-7023.055259216437, -7054.420855284454, -7221.500670767508, -6996.610295665902, -6863.816864875627, -7135.441374732098, -7072.856803490325, -6977.297268978018, -7045.858383823964, -7116.76351670452, -7075.866883064482, -7004.356629016461, -7049.743980503448, -7085.78856131624, -6955.217855184973, -7065.806394386167, -6956.922071482337, -7088.209427875218, -7064.594289810642, -6940.504955055777, -7130.810313300896, -7082.376107966857, -7002.202110324274, -6936.2480592936245, -7100.72250874128, -7021.215123461855, -7078.492281506492, -7058.18426651735, -7165.856608548078, -7091.593360217844, -6982.041884454672, -6995.766701171402, -7005.125250829107, -6998.122880892173, -6999.881975986087, -6897.575843580419, -6999.032029919281, -6927.287035903237, -7075.565754985772, -6833.375325217441, -7113.299728443704, -7152.451555348877, -7176.19230452039, -7055.762398842322, -6962.554228305463, -6994.231144372555, -7093.922080242668, -7073.69185690152, -7061.972758395433, -7098.346686411997, -7059.960118478598, -7141.666941964138, -6964.956240607673, -7024.262777255779, -6984.5164476153195, -7146.26719683038, -7052.197402042947, -6926.088343663724, -6930.404533176647, -7091.509670576999, -7000.025414988401, -7155.803125543254, -6930.210957654184, -7029.909811377778, -7072.606524772726, -7193.148038609042, -7006.156456292769, -7001.914382608852, -7144.865642034664, -6995.5622990461, -6974.745524322425, -6968.304171338026, -6980.846861410689, -7075.252526474274, -7032.610450405647, -6955.7915913561255, -7060.5960455186205, -7114.440117574603, -7037.721288460172, -6987.778599980701, -6959.082944138272, -7126.327775626586, -7104.231212636027, -6978.756422626538, -7040.223373487282, -7008.819672401102, -6900.361053042657, -6962.0670007614835, -7063.371044769579, -6962.867246659552, -7131.790713000119, -7092.914351925807, -7165.682347164258, -6974.732658856332, -6987.338218700964, -6954.578180958785, -7003.6489920448175, -7026.794257404716, -6956.1188736786835, -7060.298430609567], "episode_lengths": [1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.3923455107951128, "mean_inference_ms": 0.23090634408224503, "mean_action_processing_ms": 0.05632075620076751, "mean_env_wait_ms": 0.5047675802306482, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0023605823516845703, "StateBufferConnector_ms": 0.0018489360809326172, "ViewRequirementAgentConnector_ms": 0.04328322410583496}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 48557400, "num_agent_steps_trained": 48557400, "num_env_steps_sampled": 48557400, "num_env_steps_trained": 48557400, "num_env_steps_sampled_this_iter": 4800, "num_env_steps_trained_this_iter": 4800, "num_env_steps_sampled_throughput_per_sec": 458.0951270782126, "num_env_steps_trained_throughput_per_sec": 458.0951270782126, "timesteps_total": 48557400, "num_steps_trained_this_iter": 4800, "agent_timesteps_total": 48557400, "timers": {"training_iteration_time_ms": 2628.105, "sample_time_ms": 2607.494, "load_time_ms": 0.41, "load_throughput": 2923708.859, "learn_time_ms": 19.57, "learn_throughput": 61319.039, "synch_weights_time_ms": 0.594}, "counters": {"num_env_steps_sampled": 48557400, "num_env_steps_trained": 48557400, "num_agent_steps_sampled": 48557400, "num_agent_steps_trained": 48557400}, "done": false, "episodes_total": 10041, "training_iteration": 3146, "trial_id": "4bd41_00000", "date": "2023-08-08_07-35-58", "timestamp": 1691469358, "time_this_iter_s": 10.480336904525757, "time_total_s": 83806.57070612907, "pid": 11406, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 10, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[48412200, 5e-09], [48430200, 5e-09], [48448200, 5e-09], [48466200, 2.5e-09], [48484200, 2.5e-09], [48502200, 2.5e-09], [48520200, 2.5e-09], [48538200, 1e-09], [48556200, 1e-09], [48574200, 1e-09], [48592200, 1e-09], [48610200, 1e-09], [48628200, 5e-10], [48646200, 5e-10], [48664200, 5e-10], [48682200, 5e-10], [48700200, 2.5e-10], [48718200, 2.5e-10], [48736200, 2.5e-10], [48754200, 2.5e-10], [48772200, 1e-10], [48790200, 1e-10], [48808200, 1e-10], [48826200, 5e-11], [48844200, 5e-11], [48862200, 5e-11]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.3, "final_epsilon": 0.01, "epsilon_timesteps": 48880200}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 1200, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17eb87820>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 328.35881757736206, "iterations_since_restore": 31, "perf": {"cpu_util_percent": 18.066666666666666, "ram_util_percent": 55.373333333333335}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 9.999999999999999e-10, "entropy_coeff": 0.10000000000000002, "policy_entropy": -362.80442301432294, "policy_loss": -5501823.939019097, "vf_loss": 10086841.361111112}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 2295.5, "diff_num_grad_updates_vs_sampler_policy": 2294.5}}, "num_env_steps_sampled": 48562200, "num_env_steps_trained": 48562200, "num_agent_steps_sampled": 48562200, "num_agent_steps_trained": 48562200}, "sampler_results": {"episode_reward_max": -6833.375325217441, "episode_reward_min": -7193.148038609042, "episode_reward_mean": -7033.351291215156, "episode_len_mean": 1200.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-6863.816864875627, -7135.441374732098, -7072.856803490325, -6977.297268978018, -7045.858383823964, -7116.76351670452, -7075.866883064482, -7004.356629016461, -7049.743980503448, -7085.78856131624, -6955.217855184973, -7065.806394386167, -6956.922071482337, -7088.209427875218, -7064.594289810642, -6940.504955055777, -7130.810313300896, -7082.376107966857, -7002.202110324274, -6936.2480592936245, -7100.72250874128, -7021.215123461855, -7078.492281506492, -7058.18426651735, -7165.856608548078, -7091.593360217844, -6982.041884454672, -6995.766701171402, -7005.125250829107, -6998.122880892173, -6999.881975986087, -6897.575843580419, -6999.032029919281, -6927.287035903237, -7075.565754985772, -6833.375325217441, -7113.299728443704, -7152.451555348877, -7176.19230452039, -7055.762398842322, -6962.554228305463, -6994.231144372555, -7093.922080242668, -7073.69185690152, -7061.972758395433, -7098.346686411997, -7059.960118478598, -7141.666941964138, -6964.956240607673, -7024.262777255779, -6984.5164476153195, -7146.26719683038, -7052.197402042947, -6926.088343663724, -6930.404533176647, -7091.509670576999, -7000.025414988401, -7155.803125543254, -6930.210957654184, -7029.909811377778, -7072.606524772726, -7193.148038609042, -7006.156456292769, -7001.914382608852, -7144.865642034664, -6995.5622990461, -6974.745524322425, -6968.304171338026, -6980.846861410689, -7075.252526474274, -7032.610450405647, -6955.7915913561255, -7060.5960455186205, -7114.440117574603, -7037.721288460172, -6987.778599980701, -6959.082944138272, -7126.327775626586, -7104.231212636027, -6978.756422626538, -7040.223373487282, -7008.819672401102, -6900.361053042657, -6962.0670007614835, -7063.371044769579, -6962.867246659552, -7131.790713000119, -7092.914351925807, -7165.682347164258, -6974.732658856332, -6987.338218700964, -6954.578180958785, -7003.6489920448175, -7026.794257404716, -6956.1188736786835, -7060.298430609567, -7016.830733976093, -6952.957068840482, -7135.422376976788, -7066.849244344521], "episode_lengths": [1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.3924965292122369, "mean_inference_ms": 0.23092209368519506, "mean_action_processing_ms": 0.0563298639221872, "mean_env_wait_ms": 0.5032788887616445, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0023593902587890625, "StateBufferConnector_ms": 0.0018463134765625, "ViewRequirementAgentConnector_ms": 0.043256521224975586}}, "episode_reward_max": -6833.375325217441, "episode_reward_min": -7193.148038609042, "episode_reward_mean": -7033.351291215156, "episode_len_mean": 1200.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-6863.816864875627, -7135.441374732098, -7072.856803490325, -6977.297268978018, -7045.858383823964, -7116.76351670452, -7075.866883064482, -7004.356629016461, -7049.743980503448, -7085.78856131624, -6955.217855184973, -7065.806394386167, -6956.922071482337, -7088.209427875218, -7064.594289810642, -6940.504955055777, -7130.810313300896, -7082.376107966857, -7002.202110324274, -6936.2480592936245, -7100.72250874128, -7021.215123461855, -7078.492281506492, -7058.18426651735, -7165.856608548078, -7091.593360217844, -6982.041884454672, -6995.766701171402, -7005.125250829107, -6998.122880892173, -6999.881975986087, -6897.575843580419, -6999.032029919281, -6927.287035903237, -7075.565754985772, -6833.375325217441, -7113.299728443704, -7152.451555348877, -7176.19230452039, -7055.762398842322, -6962.554228305463, -6994.231144372555, -7093.922080242668, -7073.69185690152, -7061.972758395433, -7098.346686411997, -7059.960118478598, -7141.666941964138, -6964.956240607673, -7024.262777255779, -6984.5164476153195, -7146.26719683038, -7052.197402042947, -6926.088343663724, -6930.404533176647, -7091.509670576999, -7000.025414988401, -7155.803125543254, -6930.210957654184, -7029.909811377778, -7072.606524772726, -7193.148038609042, -7006.156456292769, -7001.914382608852, -7144.865642034664, -6995.5622990461, -6974.745524322425, -6968.304171338026, -6980.846861410689, -7075.252526474274, -7032.610450405647, -6955.7915913561255, -7060.5960455186205, -7114.440117574603, -7037.721288460172, -6987.778599980701, -6959.082944138272, -7126.327775626586, -7104.231212636027, -6978.756422626538, -7040.223373487282, -7008.819672401102, -6900.361053042657, -6962.0670007614835, -7063.371044769579, -6962.867246659552, -7131.790713000119, -7092.914351925807, -7165.682347164258, -6974.732658856332, -6987.338218700964, -6954.578180958785, -7003.6489920448175, -7026.794257404716, -6956.1188736786835, -7060.298430609567, -7016.830733976093, -6952.957068840482, -7135.422376976788, -7066.849244344521], "episode_lengths": [1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.3924965292122369, "mean_inference_ms": 0.23092209368519506, "mean_action_processing_ms": 0.0563298639221872, "mean_env_wait_ms": 0.5032788887616445, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0023593902587890625, "StateBufferConnector_ms": 0.0018463134765625, "ViewRequirementAgentConnector_ms": 0.043256521224975586}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 48562200, "num_agent_steps_trained": 48562200, "num_env_steps_sampled": 48562200, "num_env_steps_trained": 48562200, "num_env_steps_sampled_this_iter": 4800, "num_env_steps_trained_this_iter": 4800, "num_env_steps_sampled_throughput_per_sec": 455.4771150944522, "num_env_steps_trained_throughput_per_sec": 455.4771150944522, "timesteps_total": 48562200, "num_steps_trained_this_iter": 4800, "agent_timesteps_total": 48562200, "timers": {"training_iteration_time_ms": 2624.401, "sample_time_ms": 2603.666, "load_time_ms": 0.409, "load_throughput": 2933250.656, "learn_time_ms": 19.701, "learn_throughput": 60911.265, "synch_weights_time_ms": 0.588}, "counters": {"num_env_steps_sampled": 48562200, "num_env_steps_trained": 48562200, "num_agent_steps_sampled": 48562200, "num_agent_steps_trained": 48562200}, "done": false, "episodes_total": 10045, "training_iteration": 3147, "trial_id": "4bd41_00000", "date": "2023-08-08_07-36-09", "timestamp": 1691469369, "time_this_iter_s": 10.540653944015503, "time_total_s": 83817.11136007309, "pid": 11406, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 10, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[48412200, 5e-09], [48430200, 5e-09], [48448200, 5e-09], [48466200, 2.5e-09], [48484200, 2.5e-09], [48502200, 2.5e-09], [48520200, 2.5e-09], [48538200, 1e-09], [48556200, 1e-09], [48574200, 1e-09], [48592200, 1e-09], [48610200, 1e-09], [48628200, 5e-10], [48646200, 5e-10], [48664200, 5e-10], [48682200, 5e-10], [48700200, 2.5e-10], [48718200, 2.5e-10], [48736200, 2.5e-10], [48754200, 2.5e-10], [48772200, 1e-10], [48790200, 1e-10], [48808200, 1e-10], [48826200, 5e-11], [48844200, 5e-11], [48862200, 5e-11]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.3, "final_epsilon": 0.01, "epsilon_timesteps": 48880200}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 1200, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17eb87820>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 338.89947152137756, "iterations_since_restore": 32, "perf": {"cpu_util_percent": 20.06, "ram_util_percent": 55.48}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 9.999999999999999e-10, "entropy_coeff": 0.10000000000000002, "policy_entropy": -364.3907877604167, "policy_loss": -4564811.655598958, "vf_loss": 10161711.611111112}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 2367.5, "diff_num_grad_updates_vs_sampler_policy": 2366.5}}, "num_env_steps_sampled": 48567000, "num_env_steps_trained": 48567000, "num_agent_steps_sampled": 48567000, "num_agent_steps_trained": 48567000}, "sampler_results": {"episode_reward_max": -6833.375325217441, "episode_reward_min": -7193.148038609042, "episode_reward_mean": -7033.732099767641, "episode_len_mean": 1200.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-7045.858383823964, -7116.76351670452, -7075.866883064482, -7004.356629016461, -7049.743980503448, -7085.78856131624, -6955.217855184973, -7065.806394386167, -6956.922071482337, -7088.209427875218, -7064.594289810642, -6940.504955055777, -7130.810313300896, -7082.376107966857, -7002.202110324274, -6936.2480592936245, -7100.72250874128, -7021.215123461855, -7078.492281506492, -7058.18426651735, -7165.856608548078, -7091.593360217844, -6982.041884454672, -6995.766701171402, -7005.125250829107, -6998.122880892173, -6999.881975986087, -6897.575843580419, -6999.032029919281, -6927.287035903237, -7075.565754985772, -6833.375325217441, -7113.299728443704, -7152.451555348877, -7176.19230452039, -7055.762398842322, -6962.554228305463, -6994.231144372555, -7093.922080242668, -7073.69185690152, -7061.972758395433, -7098.346686411997, -7059.960118478598, -7141.666941964138, -6964.956240607673, -7024.262777255779, -6984.5164476153195, -7146.26719683038, -7052.197402042947, -6926.088343663724, -6930.404533176647, -7091.509670576999, -7000.025414988401, -7155.803125543254, -6930.210957654184, -7029.909811377778, -7072.606524772726, -7193.148038609042, -7006.156456292769, -7001.914382608852, -7144.865642034664, -6995.5622990461, -6974.745524322425, -6968.304171338026, -6980.846861410689, -7075.252526474274, -7032.610450405647, -6955.7915913561255, -7060.5960455186205, -7114.440117574603, -7037.721288460172, -6987.778599980701, -6959.082944138272, -7126.327775626586, -7104.231212636027, -6978.756422626538, -7040.223373487282, -7008.819672401102, -6900.361053042657, -6962.0670007614835, -7063.371044769579, -6962.867246659552, -7131.790713000119, -7092.914351925807, -7165.682347164258, -6974.732658856332, -6987.338218700964, -6954.578180958785, -7003.6489920448175, -7026.794257404716, -6956.1188736786835, -7060.298430609567, -7016.830733976093, -6952.957068840482, -7135.422376976788, -7066.849244344521, -7040.896775796961, -6946.577431724025, -7023.730168227358, -7076.288791576191], "episode_lengths": [1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.3926265249264593, "mean_inference_ms": 0.23094287965295016, "mean_action_processing_ms": 0.05633832198276931, "mean_env_wait_ms": 0.5020359966282638, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00237274169921875, "StateBufferConnector_ms": 0.0018551349639892578, "ViewRequirementAgentConnector_ms": 0.04325985908508301}}, "episode_reward_max": -6833.375325217441, "episode_reward_min": -7193.148038609042, "episode_reward_mean": -7033.732099767641, "episode_len_mean": 1200.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-7045.858383823964, -7116.76351670452, -7075.866883064482, -7004.356629016461, -7049.743980503448, -7085.78856131624, -6955.217855184973, -7065.806394386167, -6956.922071482337, -7088.209427875218, -7064.594289810642, -6940.504955055777, -7130.810313300896, -7082.376107966857, -7002.202110324274, -6936.2480592936245, -7100.72250874128, -7021.215123461855, -7078.492281506492, -7058.18426651735, -7165.856608548078, -7091.593360217844, -6982.041884454672, -6995.766701171402, -7005.125250829107, -6998.122880892173, -6999.881975986087, -6897.575843580419, -6999.032029919281, -6927.287035903237, -7075.565754985772, -6833.375325217441, -7113.299728443704, -7152.451555348877, -7176.19230452039, -7055.762398842322, -6962.554228305463, -6994.231144372555, -7093.922080242668, -7073.69185690152, -7061.972758395433, -7098.346686411997, -7059.960118478598, -7141.666941964138, -6964.956240607673, -7024.262777255779, -6984.5164476153195, -7146.26719683038, -7052.197402042947, -6926.088343663724, -6930.404533176647, -7091.509670576999, -7000.025414988401, -7155.803125543254, -6930.210957654184, -7029.909811377778, -7072.606524772726, -7193.148038609042, -7006.156456292769, -7001.914382608852, -7144.865642034664, -6995.5622990461, -6974.745524322425, -6968.304171338026, -6980.846861410689, -7075.252526474274, -7032.610450405647, -6955.7915913561255, -7060.5960455186205, -7114.440117574603, -7037.721288460172, -6987.778599980701, -6959.082944138272, -7126.327775626586, -7104.231212636027, -6978.756422626538, -7040.223373487282, -7008.819672401102, -6900.361053042657, -6962.0670007614835, -7063.371044769579, -6962.867246659552, -7131.790713000119, -7092.914351925807, -7165.682347164258, -6974.732658856332, -6987.338218700964, -6954.578180958785, -7003.6489920448175, -7026.794257404716, -6956.1188736786835, -7060.298430609567, -7016.830733976093, -6952.957068840482, -7135.422376976788, -7066.849244344521, -7040.896775796961, -6946.577431724025, -7023.730168227358, -7076.288791576191], "episode_lengths": [1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.3926265249264593, "mean_inference_ms": 0.23094287965295016, "mean_action_processing_ms": 0.05633832198276931, "mean_env_wait_ms": 0.5020359966282638, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00237274169921875, "StateBufferConnector_ms": 0.0018551349639892578, "ViewRequirementAgentConnector_ms": 0.04325985908508301}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 48567000, "num_agent_steps_trained": 48567000, "num_env_steps_sampled": 48567000, "num_env_steps_trained": 48567000, "num_env_steps_sampled_this_iter": 4800, "num_env_steps_trained_this_iter": 4800, "num_env_steps_sampled_throughput_per_sec": 455.70378521671716, "num_env_steps_trained_throughput_per_sec": 455.70378521671716, "timesteps_total": 48567000, "num_steps_trained_this_iter": 4800, "agent_timesteps_total": 48567000, "timers": {"training_iteration_time_ms": 2631.744, "sample_time_ms": 2611.019, "load_time_ms": 0.408, "load_throughput": 2942682.881, "learn_time_ms": 19.71, "learn_throughput": 60882.529, "synch_weights_time_ms": 0.57}, "counters": {"num_env_steps_sampled": 48567000, "num_env_steps_trained": 48567000, "num_agent_steps_sampled": 48567000, "num_agent_steps_trained": 48567000}, "done": false, "episodes_total": 10049, "training_iteration": 3148, "trial_id": "4bd41_00000", "date": "2023-08-08_07-36-19", "timestamp": 1691469379, "time_this_iter_s": 10.535470962524414, "time_total_s": 83827.64683103561, "pid": 11406, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 10, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[48412200, 5e-09], [48430200, 5e-09], [48448200, 5e-09], [48466200, 2.5e-09], [48484200, 2.5e-09], [48502200, 2.5e-09], [48520200, 2.5e-09], [48538200, 1e-09], [48556200, 1e-09], [48574200, 1e-09], [48592200, 1e-09], [48610200, 1e-09], [48628200, 5e-10], [48646200, 5e-10], [48664200, 5e-10], [48682200, 5e-10], [48700200, 2.5e-10], [48718200, 2.5e-10], [48736200, 2.5e-10], [48754200, 2.5e-10], [48772200, 1e-10], [48790200, 1e-10], [48808200, 1e-10], [48826200, 5e-11], [48844200, 5e-11], [48862200, 5e-11]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.3, "final_epsilon": 0.01, "epsilon_timesteps": 48880200}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 1200, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17eb87820>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 349.434942483902, "iterations_since_restore": 33, "perf": {"cpu_util_percent": 17.193333333333335, "ram_util_percent": 55.46666666666667}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 9.999999999999999e-10, "entropy_coeff": 0.10000000000000002, "policy_entropy": -363.9842478434245, "policy_loss": -5928804.645833333, "vf_loss": 10272750.930555556}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 2439.5, "diff_num_grad_updates_vs_sampler_policy": 2438.5}}, "num_env_steps_sampled": 48571800, "num_env_steps_trained": 48571800, "num_agent_steps_sampled": 48571800, "num_agent_steps_trained": 48571800}, "sampler_results": {"episode_reward_max": -6833.375325217441, "episode_reward_min": -7193.148038609042, "episode_reward_mean": -7031.920868667906, "episode_len_mean": 1200.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-7049.743980503448, -7085.78856131624, -6955.217855184973, -7065.806394386167, -6956.922071482337, -7088.209427875218, -7064.594289810642, -6940.504955055777, -7130.810313300896, -7082.376107966857, -7002.202110324274, -6936.2480592936245, -7100.72250874128, -7021.215123461855, -7078.492281506492, -7058.18426651735, -7165.856608548078, -7091.593360217844, -6982.041884454672, -6995.766701171402, -7005.125250829107, -6998.122880892173, -6999.881975986087, -6897.575843580419, -6999.032029919281, -6927.287035903237, -7075.565754985772, -6833.375325217441, -7113.299728443704, -7152.451555348877, -7176.19230452039, -7055.762398842322, -6962.554228305463, -6994.231144372555, -7093.922080242668, -7073.69185690152, -7061.972758395433, -7098.346686411997, -7059.960118478598, -7141.666941964138, -6964.956240607673, -7024.262777255779, -6984.5164476153195, -7146.26719683038, -7052.197402042947, -6926.088343663724, -6930.404533176647, -7091.509670576999, -7000.025414988401, -7155.803125543254, -6930.210957654184, -7029.909811377778, -7072.606524772726, -7193.148038609042, -7006.156456292769, -7001.914382608852, -7144.865642034664, -6995.5622990461, -6974.745524322425, -6968.304171338026, -6980.846861410689, -7075.252526474274, -7032.610450405647, -6955.7915913561255, -7060.5960455186205, -7114.440117574603, -7037.721288460172, -6987.778599980701, -6959.082944138272, -7126.327775626586, -7104.231212636027, -6978.756422626538, -7040.223373487282, -7008.819672401102, -6900.361053042657, -6962.0670007614835, -7063.371044769579, -6962.867246659552, -7131.790713000119, -7092.914351925807, -7165.682347164258, -6974.732658856332, -6987.338218700964, -6954.578180958785, -7003.6489920448175, -7026.794257404716, -6956.1188736786835, -7060.298430609567, -7016.830733976093, -6952.957068840482, -7135.422376976788, -7066.849244344521, -7040.896775796961, -6946.577431724025, -7023.730168227358, -7076.288791576191, -7018.620189142384, -6959.779870768019, -6975.804982984654, -7107.517259740744], "episode_lengths": [1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.392759763793315, "mean_inference_ms": 0.23096310947405613, "mean_action_processing_ms": 0.05634522227366768, "mean_env_wait_ms": 0.500930288415455, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002370119094848633, "StateBufferConnector_ms": 0.0018565654754638672, "ViewRequirementAgentConnector_ms": 0.04326629638671875}}, "episode_reward_max": -6833.375325217441, "episode_reward_min": -7193.148038609042, "episode_reward_mean": -7031.920868667906, "episode_len_mean": 1200.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-7049.743980503448, -7085.78856131624, -6955.217855184973, -7065.806394386167, -6956.922071482337, -7088.209427875218, -7064.594289810642, -6940.504955055777, -7130.810313300896, -7082.376107966857, -7002.202110324274, -6936.2480592936245, -7100.72250874128, -7021.215123461855, -7078.492281506492, -7058.18426651735, -7165.856608548078, -7091.593360217844, -6982.041884454672, -6995.766701171402, -7005.125250829107, -6998.122880892173, -6999.881975986087, -6897.575843580419, -6999.032029919281, -6927.287035903237, -7075.565754985772, -6833.375325217441, -7113.299728443704, -7152.451555348877, -7176.19230452039, -7055.762398842322, -6962.554228305463, -6994.231144372555, -7093.922080242668, -7073.69185690152, -7061.972758395433, -7098.346686411997, -7059.960118478598, -7141.666941964138, -6964.956240607673, -7024.262777255779, -6984.5164476153195, -7146.26719683038, -7052.197402042947, -6926.088343663724, -6930.404533176647, -7091.509670576999, -7000.025414988401, -7155.803125543254, -6930.210957654184, -7029.909811377778, -7072.606524772726, -7193.148038609042, -7006.156456292769, -7001.914382608852, -7144.865642034664, -6995.5622990461, -6974.745524322425, -6968.304171338026, -6980.846861410689, -7075.252526474274, -7032.610450405647, -6955.7915913561255, -7060.5960455186205, -7114.440117574603, -7037.721288460172, -6987.778599980701, -6959.082944138272, -7126.327775626586, -7104.231212636027, -6978.756422626538, -7040.223373487282, -7008.819672401102, -6900.361053042657, -6962.0670007614835, -7063.371044769579, -6962.867246659552, -7131.790713000119, -7092.914351925807, -7165.682347164258, -6974.732658856332, -6987.338218700964, -6954.578180958785, -7003.6489920448175, -7026.794257404716, -6956.1188736786835, -7060.298430609567, -7016.830733976093, -6952.957068840482, -7135.422376976788, -7066.849244344521, -7040.896775796961, -6946.577431724025, -7023.730168227358, -7076.288791576191, -7018.620189142384, -6959.779870768019, -6975.804982984654, -7107.517259740744], "episode_lengths": [1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.392759763793315, "mean_inference_ms": 0.23096310947405613, "mean_action_processing_ms": 0.05634522227366768, "mean_env_wait_ms": 0.500930288415455, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002370119094848633, "StateBufferConnector_ms": 0.0018565654754638672, "ViewRequirementAgentConnector_ms": 0.04326629638671875}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 48571800, "num_agent_steps_trained": 48571800, "num_env_steps_sampled": 48571800, "num_env_steps_trained": 48571800, "num_env_steps_sampled_this_iter": 4800, "num_env_steps_trained_this_iter": 4800, "num_env_steps_sampled_throughput_per_sec": 454.31859440613835, "num_env_steps_trained_throughput_per_sec": 454.31859440613835, "timesteps_total": 48571800, "num_steps_trained_this_iter": 4800, "agent_timesteps_total": 48571800, "timers": {"training_iteration_time_ms": 2639.109, "sample_time_ms": 2618.493, "load_time_ms": 0.409, "load_throughput": 2934789.971, "learn_time_ms": 19.613, "learn_throughput": 61184.343, "synch_weights_time_ms": 0.558}, "counters": {"num_env_steps_sampled": 48571800, "num_env_steps_trained": 48571800, "num_agent_steps_sampled": 48571800, "num_agent_steps_trained": 48571800}, "done": false, "episodes_total": 10053, "training_iteration": 3149, "trial_id": "4bd41_00000", "date": "2023-08-08_07-36-30", "timestamp": 1691469390, "time_this_iter_s": 10.567480087280273, "time_total_s": 83838.2143111229, "pid": 11406, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 10, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[48412200, 5e-09], [48430200, 5e-09], [48448200, 5e-09], [48466200, 2.5e-09], [48484200, 2.5e-09], [48502200, 2.5e-09], [48520200, 2.5e-09], [48538200, 1e-09], [48556200, 1e-09], [48574200, 1e-09], [48592200, 1e-09], [48610200, 1e-09], [48628200, 5e-10], [48646200, 5e-10], [48664200, 5e-10], [48682200, 5e-10], [48700200, 2.5e-10], [48718200, 2.5e-10], [48736200, 2.5e-10], [48754200, 2.5e-10], [48772200, 1e-10], [48790200, 1e-10], [48808200, 1e-10], [48826200, 5e-11], [48844200, 5e-11], [48862200, 5e-11]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.3, "final_epsilon": 0.01, "epsilon_timesteps": 48880200}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 1200, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17eb87820>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 360.00242257118225, "iterations_since_restore": 34, "perf": {"cpu_util_percent": 17.27857142857143, "ram_util_percent": 55.49285714285715}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 9.999999999999999e-10, "entropy_coeff": 0.10000000000000002, "policy_entropy": -364.0948367648655, "policy_loss": -6459497.518880208, "vf_loss": 9970968.638888888}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 2511.5, "diff_num_grad_updates_vs_sampler_policy": 2510.5}}, "num_env_steps_sampled": 48576600, "num_env_steps_trained": 48576600, "num_agent_steps_sampled": 48576600, "num_agent_steps_trained": 48576600}, "sampler_results": {"episode_reward_max": -6833.375325217441, "episode_reward_min": -7193.148038609042, "episode_reward_mean": -7032.289652945913, "episode_len_mean": 1200.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-6956.922071482337, -7088.209427875218, -7064.594289810642, -6940.504955055777, -7130.810313300896, -7082.376107966857, -7002.202110324274, -6936.2480592936245, -7100.72250874128, -7021.215123461855, -7078.492281506492, -7058.18426651735, -7165.856608548078, -7091.593360217844, -6982.041884454672, -6995.766701171402, -7005.125250829107, -6998.122880892173, -6999.881975986087, -6897.575843580419, -6999.032029919281, -6927.287035903237, -7075.565754985772, -6833.375325217441, -7113.299728443704, -7152.451555348877, -7176.19230452039, -7055.762398842322, -6962.554228305463, -6994.231144372555, -7093.922080242668, -7073.69185690152, -7061.972758395433, -7098.346686411997, -7059.960118478598, -7141.666941964138, -6964.956240607673, -7024.262777255779, -6984.5164476153195, -7146.26719683038, -7052.197402042947, -6926.088343663724, -6930.404533176647, -7091.509670576999, -7000.025414988401, -7155.803125543254, -6930.210957654184, -7029.909811377778, -7072.606524772726, -7193.148038609042, -7006.156456292769, -7001.914382608852, -7144.865642034664, -6995.5622990461, -6974.745524322425, -6968.304171338026, -6980.846861410689, -7075.252526474274, -7032.610450405647, -6955.7915913561255, -7060.5960455186205, -7114.440117574603, -7037.721288460172, -6987.778599980701, -6959.082944138272, -7126.327775626586, -7104.231212636027, -6978.756422626538, -7040.223373487282, -7008.819672401102, -6900.361053042657, -6962.0670007614835, -7063.371044769579, -6962.867246659552, -7131.790713000119, -7092.914351925807, -7165.682347164258, -6974.732658856332, -6987.338218700964, -6954.578180958785, -7003.6489920448175, -7026.794257404716, -6956.1188736786835, -7060.298430609567, -7016.830733976093, -6952.957068840482, -7135.422376976788, -7066.849244344521, -7040.896775796961, -6946.577431724025, -7023.730168227358, -7076.288791576191, -7018.620189142384, -6959.779870768019, -6975.804982984654, -7107.517259740744, -7035.256969146439, -7062.818438576796, -7116.9719381952345, -6978.387873273061], "episode_lengths": [1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.3928877189432416, "mean_inference_ms": 0.2309852184492369, "mean_action_processing_ms": 0.056351508626688605, "mean_env_wait_ms": 0.4999687456183913, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002378702163696289, "StateBufferConnector_ms": 0.0018527507781982422, "ViewRequirementAgentConnector_ms": 0.04330182075500488}}, "episode_reward_max": -6833.375325217441, "episode_reward_min": -7193.148038609042, "episode_reward_mean": -7032.289652945913, "episode_len_mean": 1200.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-6956.922071482337, -7088.209427875218, -7064.594289810642, -6940.504955055777, -7130.810313300896, -7082.376107966857, -7002.202110324274, -6936.2480592936245, -7100.72250874128, -7021.215123461855, -7078.492281506492, -7058.18426651735, -7165.856608548078, -7091.593360217844, -6982.041884454672, -6995.766701171402, -7005.125250829107, -6998.122880892173, -6999.881975986087, -6897.575843580419, -6999.032029919281, -6927.287035903237, -7075.565754985772, -6833.375325217441, -7113.299728443704, -7152.451555348877, -7176.19230452039, -7055.762398842322, -6962.554228305463, -6994.231144372555, -7093.922080242668, -7073.69185690152, -7061.972758395433, -7098.346686411997, -7059.960118478598, -7141.666941964138, -6964.956240607673, -7024.262777255779, -6984.5164476153195, -7146.26719683038, -7052.197402042947, -6926.088343663724, -6930.404533176647, -7091.509670576999, -7000.025414988401, -7155.803125543254, -6930.210957654184, -7029.909811377778, -7072.606524772726, -7193.148038609042, -7006.156456292769, -7001.914382608852, -7144.865642034664, -6995.5622990461, -6974.745524322425, -6968.304171338026, -6980.846861410689, -7075.252526474274, -7032.610450405647, -6955.7915913561255, -7060.5960455186205, -7114.440117574603, -7037.721288460172, -6987.778599980701, -6959.082944138272, -7126.327775626586, -7104.231212636027, -6978.756422626538, -7040.223373487282, -7008.819672401102, -6900.361053042657, -6962.0670007614835, -7063.371044769579, -6962.867246659552, -7131.790713000119, -7092.914351925807, -7165.682347164258, -6974.732658856332, -6987.338218700964, -6954.578180958785, -7003.6489920448175, -7026.794257404716, -6956.1188736786835, -7060.298430609567, -7016.830733976093, -6952.957068840482, -7135.422376976788, -7066.849244344521, -7040.896775796961, -6946.577431724025, -7023.730168227358, -7076.288791576191, -7018.620189142384, -6959.779870768019, -6975.804982984654, -7107.517259740744, -7035.256969146439, -7062.818438576796, -7116.9719381952345, -6978.387873273061], "episode_lengths": [1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.3928877189432416, "mean_inference_ms": 0.2309852184492369, "mean_action_processing_ms": 0.056351508626688605, "mean_env_wait_ms": 0.4999687456183913, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002378702163696289, "StateBufferConnector_ms": 0.0018527507781982422, "ViewRequirementAgentConnector_ms": 0.04330182075500488}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 48576600, "num_agent_steps_trained": 48576600, "num_env_steps_sampled": 48576600, "num_env_steps_trained": 48576600, "num_env_steps_sampled_this_iter": 4800, "num_env_steps_trained_this_iter": 4800, "num_env_steps_sampled_throughput_per_sec": 453.069855089006, "num_env_steps_trained_throughput_per_sec": 453.069855089006, "timesteps_total": 48576600, "num_steps_trained_this_iter": 4800, "agent_timesteps_total": 48576600, "timers": {"training_iteration_time_ms": 2642.078, "sample_time_ms": 2621.574, "load_time_ms": 0.41, "load_throughput": 2926939.288, "learn_time_ms": 19.504, "learn_throughput": 61525.243, "synch_weights_time_ms": 0.552}, "counters": {"num_env_steps_sampled": 48576600, "num_env_steps_trained": 48576600, "num_agent_steps_sampled": 48576600, "num_agent_steps_trained": 48576600}, "done": false, "episodes_total": 10057, "training_iteration": 3150, "trial_id": "4bd41_00000", "date": "2023-08-08_07-36-40", "timestamp": 1691469400, "time_this_iter_s": 10.596550226211548, "time_total_s": 83848.8108613491, "pid": 11406, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 10, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[48412200, 5e-09], [48430200, 5e-09], [48448200, 5e-09], [48466200, 2.5e-09], [48484200, 2.5e-09], [48502200, 2.5e-09], [48520200, 2.5e-09], [48538200, 1e-09], [48556200, 1e-09], [48574200, 1e-09], [48592200, 1e-09], [48610200, 1e-09], [48628200, 5e-10], [48646200, 5e-10], [48664200, 5e-10], [48682200, 5e-10], [48700200, 2.5e-10], [48718200, 2.5e-10], [48736200, 2.5e-10], [48754200, 2.5e-10], [48772200, 1e-10], [48790200, 1e-10], [48808200, 1e-10], [48826200, 5e-11], [48844200, 5e-11], [48862200, 5e-11]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.3, "final_epsilon": 0.01, "epsilon_timesteps": 48880200}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 1200, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17eb87820>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 370.5989727973938, "iterations_since_restore": 35, "perf": {"cpu_util_percent": 17.28125, "ram_util_percent": 55.5375}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 9.999999999999999e-10, "entropy_coeff": 0.10000000000000002, "policy_entropy": -363.4877454969618, "policy_loss": -5524761.5546875, "vf_loss": 9974856.902777778}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 2583.5, "diff_num_grad_updates_vs_sampler_policy": 2582.5}}, "num_env_steps_sampled": 48581400, "num_env_steps_trained": 48581400, "num_agent_steps_sampled": 48581400, "num_agent_steps_trained": 48581400}, "sampler_results": {"episode_reward_max": -6833.375325217441, "episode_reward_min": -7193.148038609042, "episode_reward_mean": -7033.057019126818, "episode_len_mean": 1200.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-7130.810313300896, -7082.376107966857, -7002.202110324274, -6936.2480592936245, -7100.72250874128, -7021.215123461855, -7078.492281506492, -7058.18426651735, -7165.856608548078, -7091.593360217844, -6982.041884454672, -6995.766701171402, -7005.125250829107, -6998.122880892173, -6999.881975986087, -6897.575843580419, -6999.032029919281, -6927.287035903237, -7075.565754985772, -6833.375325217441, -7113.299728443704, -7152.451555348877, -7176.19230452039, -7055.762398842322, -6962.554228305463, -6994.231144372555, -7093.922080242668, -7073.69185690152, -7061.972758395433, -7098.346686411997, -7059.960118478598, -7141.666941964138, -6964.956240607673, -7024.262777255779, -6984.5164476153195, -7146.26719683038, -7052.197402042947, -6926.088343663724, -6930.404533176647, -7091.509670576999, -7000.025414988401, -7155.803125543254, -6930.210957654184, -7029.909811377778, -7072.606524772726, -7193.148038609042, -7006.156456292769, -7001.914382608852, -7144.865642034664, -6995.5622990461, -6974.745524322425, -6968.304171338026, -6980.846861410689, -7075.252526474274, -7032.610450405647, -6955.7915913561255, -7060.5960455186205, -7114.440117574603, -7037.721288460172, -6987.778599980701, -6959.082944138272, -7126.327775626586, -7104.231212636027, -6978.756422626538, -7040.223373487282, -7008.819672401102, -6900.361053042657, -6962.0670007614835, -7063.371044769579, -6962.867246659552, -7131.790713000119, -7092.914351925807, -7165.682347164258, -6974.732658856332, -6987.338218700964, -6954.578180958785, -7003.6489920448175, -7026.794257404716, -6956.1188736786835, -7060.298430609567, -7016.830733976093, -6952.957068840482, -7135.422376976788, -7066.849244344521, -7040.896775796961, -6946.577431724025, -7023.730168227358, -7076.288791576191, -7018.620189142384, -6959.779870768019, -6975.804982984654, -7107.517259740744, -7035.256969146439, -7062.818438576796, -7116.9719381952345, -6978.387873273061, -7076.900494994287, -6992.520744634531, -7057.108872658992, -7000.437250026758], "episode_lengths": [1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.3929923041847565, "mean_inference_ms": 0.23100578601869842, "mean_action_processing_ms": 0.0563566305029746, "mean_env_wait_ms": 0.4991219024702497, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0023665428161621094, "StateBufferConnector_ms": 0.0018486976623535156, "ViewRequirementAgentConnector_ms": 0.04333829879760742}}, "episode_reward_max": -6833.375325217441, "episode_reward_min": -7193.148038609042, "episode_reward_mean": -7033.057019126818, "episode_len_mean": 1200.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-7130.810313300896, -7082.376107966857, -7002.202110324274, -6936.2480592936245, -7100.72250874128, -7021.215123461855, -7078.492281506492, -7058.18426651735, -7165.856608548078, -7091.593360217844, -6982.041884454672, -6995.766701171402, -7005.125250829107, -6998.122880892173, -6999.881975986087, -6897.575843580419, -6999.032029919281, -6927.287035903237, -7075.565754985772, -6833.375325217441, -7113.299728443704, -7152.451555348877, -7176.19230452039, -7055.762398842322, -6962.554228305463, -6994.231144372555, -7093.922080242668, -7073.69185690152, -7061.972758395433, -7098.346686411997, -7059.960118478598, -7141.666941964138, -6964.956240607673, -7024.262777255779, -6984.5164476153195, -7146.26719683038, -7052.197402042947, -6926.088343663724, -6930.404533176647, -7091.509670576999, -7000.025414988401, -7155.803125543254, -6930.210957654184, -7029.909811377778, -7072.606524772726, -7193.148038609042, -7006.156456292769, -7001.914382608852, -7144.865642034664, -6995.5622990461, -6974.745524322425, -6968.304171338026, -6980.846861410689, -7075.252526474274, -7032.610450405647, -6955.7915913561255, -7060.5960455186205, -7114.440117574603, -7037.721288460172, -6987.778599980701, -6959.082944138272, -7126.327775626586, -7104.231212636027, -6978.756422626538, -7040.223373487282, -7008.819672401102, -6900.361053042657, -6962.0670007614835, -7063.371044769579, -6962.867246659552, -7131.790713000119, -7092.914351925807, -7165.682347164258, -6974.732658856332, -6987.338218700964, -6954.578180958785, -7003.6489920448175, -7026.794257404716, -6956.1188736786835, -7060.298430609567, -7016.830733976093, -6952.957068840482, -7135.422376976788, -7066.849244344521, -7040.896775796961, -6946.577431724025, -7023.730168227358, -7076.288791576191, -7018.620189142384, -6959.779870768019, -6975.804982984654, -7107.517259740744, -7035.256969146439, -7062.818438576796, -7116.9719381952345, -6978.387873273061, -7076.900494994287, -6992.520744634531, -7057.108872658992, -7000.437250026758], "episode_lengths": [1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.3929923041847565, "mean_inference_ms": 0.23100578601869842, "mean_action_processing_ms": 0.0563566305029746, "mean_env_wait_ms": 0.4991219024702497, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0023665428161621094, "StateBufferConnector_ms": 0.0018486976623535156, "ViewRequirementAgentConnector_ms": 0.04333829879760742}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 48581400, "num_agent_steps_trained": 48581400, "num_env_steps_sampled": 48581400, "num_env_steps_trained": 48581400, "num_env_steps_sampled_this_iter": 4800, "num_env_steps_trained_this_iter": 4800, "num_env_steps_sampled_throughput_per_sec": 454.37235339929896, "num_env_steps_trained_throughput_per_sec": 454.37235339929896, "timesteps_total": 48581400, "num_steps_trained_this_iter": 4800, "agent_timesteps_total": 48581400, "timers": {"training_iteration_time_ms": 2644.393, "sample_time_ms": 2623.834, "load_time_ms": 0.41, "load_throughput": 2926939.288, "learn_time_ms": 19.54, "learn_throughput": 61411.438, "synch_weights_time_ms": 0.572}, "counters": {"num_env_steps_sampled": 48581400, "num_env_steps_trained": 48581400, "num_agent_steps_sampled": 48581400, "num_agent_steps_trained": 48581400}, "done": false, "episodes_total": 10061, "training_iteration": 3151, "trial_id": "4bd41_00000", "date": "2023-08-08_07-36-51", "timestamp": 1691469411, "time_this_iter_s": 10.56618070602417, "time_total_s": 83859.37704205513, "pid": 11406, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 10, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[48412200, 5e-09], [48430200, 5e-09], [48448200, 5e-09], [48466200, 2.5e-09], [48484200, 2.5e-09], [48502200, 2.5e-09], [48520200, 2.5e-09], [48538200, 1e-09], [48556200, 1e-09], [48574200, 1e-09], [48592200, 1e-09], [48610200, 1e-09], [48628200, 5e-10], [48646200, 5e-10], [48664200, 5e-10], [48682200, 5e-10], [48700200, 2.5e-10], [48718200, 2.5e-10], [48736200, 2.5e-10], [48754200, 2.5e-10], [48772200, 1e-10], [48790200, 1e-10], [48808200, 1e-10], [48826200, 5e-11], [48844200, 5e-11], [48862200, 5e-11]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.3, "final_epsilon": 0.01, "epsilon_timesteps": 48880200}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 1200, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17eb87820>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 381.16515350341797, "iterations_since_restore": 36, "perf": {"cpu_util_percent": 17.913333333333338, "ram_util_percent": 55.286666666666655}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 9.999999999999999e-10, "entropy_coeff": 0.10000000000000002, "policy_entropy": -364.01456536187067, "policy_loss": -4376109.145833333, "vf_loss": 9932705.194444444}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 2655.5, "diff_num_grad_updates_vs_sampler_policy": 2654.5}}, "num_env_steps_sampled": 48586200, "num_env_steps_trained": 48586200, "num_agent_steps_sampled": 48586200, "num_agent_steps_trained": 48586200}, "sampler_results": {"episode_reward_max": -6833.375325217441, "episode_reward_min": -7193.148038609042, "episode_reward_mean": -7032.093113665858, "episode_len_mean": 1200.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-7100.72250874128, -7021.215123461855, -7078.492281506492, -7058.18426651735, -7165.856608548078, -7091.593360217844, -6982.041884454672, -6995.766701171402, -7005.125250829107, -6998.122880892173, -6999.881975986087, -6897.575843580419, -6999.032029919281, -6927.287035903237, -7075.565754985772, -6833.375325217441, -7113.299728443704, -7152.451555348877, -7176.19230452039, -7055.762398842322, -6962.554228305463, -6994.231144372555, -7093.922080242668, -7073.69185690152, -7061.972758395433, -7098.346686411997, -7059.960118478598, -7141.666941964138, -6964.956240607673, -7024.262777255779, -6984.5164476153195, -7146.26719683038, -7052.197402042947, -6926.088343663724, -6930.404533176647, -7091.509670576999, -7000.025414988401, -7155.803125543254, -6930.210957654184, -7029.909811377778, -7072.606524772726, -7193.148038609042, -7006.156456292769, -7001.914382608852, -7144.865642034664, -6995.5622990461, -6974.745524322425, -6968.304171338026, -6980.846861410689, -7075.252526474274, -7032.610450405647, -6955.7915913561255, -7060.5960455186205, -7114.440117574603, -7037.721288460172, -6987.778599980701, -6959.082944138272, -7126.327775626586, -7104.231212636027, -6978.756422626538, -7040.223373487282, -7008.819672401102, -6900.361053042657, -6962.0670007614835, -7063.371044769579, -6962.867246659552, -7131.790713000119, -7092.914351925807, -7165.682347164258, -6974.732658856332, -6987.338218700964, -6954.578180958785, -7003.6489920448175, -7026.794257404716, -6956.1188736786835, -7060.298430609567, -7016.830733976093, -6952.957068840482, -7135.422376976788, -7066.849244344521, -7040.896775796961, -6946.577431724025, -7023.730168227358, -7076.288791576191, -7018.620189142384, -6959.779870768019, -6975.804982984654, -7107.517259740744, -7035.256969146439, -7062.818438576796, -7116.9719381952345, -6978.387873273061, -7076.900494994287, -6992.520744634531, -7057.108872658992, -7000.437250026758, -7005.307220334115, -7044.628778415727, -7004.355102717656, -7000.9549433222455], "episode_lengths": [1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.3931020726967094, "mean_inference_ms": 0.2310321773941883, "mean_action_processing_ms": 0.05636184390449445, "mean_env_wait_ms": 0.4983628455785452, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002373933792114258, "StateBufferConnector_ms": 0.0018460750579833984, "ViewRequirementAgentConnector_ms": 0.04340100288391113}}, "episode_reward_max": -6833.375325217441, "episode_reward_min": -7193.148038609042, "episode_reward_mean": -7032.093113665858, "episode_len_mean": 1200.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-7100.72250874128, -7021.215123461855, -7078.492281506492, -7058.18426651735, -7165.856608548078, -7091.593360217844, -6982.041884454672, -6995.766701171402, -7005.125250829107, -6998.122880892173, -6999.881975986087, -6897.575843580419, -6999.032029919281, -6927.287035903237, -7075.565754985772, -6833.375325217441, -7113.299728443704, -7152.451555348877, -7176.19230452039, -7055.762398842322, -6962.554228305463, -6994.231144372555, -7093.922080242668, -7073.69185690152, -7061.972758395433, -7098.346686411997, -7059.960118478598, -7141.666941964138, -6964.956240607673, -7024.262777255779, -6984.5164476153195, -7146.26719683038, -7052.197402042947, -6926.088343663724, -6930.404533176647, -7091.509670576999, -7000.025414988401, -7155.803125543254, -6930.210957654184, -7029.909811377778, -7072.606524772726, -7193.148038609042, -7006.156456292769, -7001.914382608852, -7144.865642034664, -6995.5622990461, -6974.745524322425, -6968.304171338026, -6980.846861410689, -7075.252526474274, -7032.610450405647, -6955.7915913561255, -7060.5960455186205, -7114.440117574603, -7037.721288460172, -6987.778599980701, -6959.082944138272, -7126.327775626586, -7104.231212636027, -6978.756422626538, -7040.223373487282, -7008.819672401102, -6900.361053042657, -6962.0670007614835, -7063.371044769579, -6962.867246659552, -7131.790713000119, -7092.914351925807, -7165.682347164258, -6974.732658856332, -6987.338218700964, -6954.578180958785, -7003.6489920448175, -7026.794257404716, -6956.1188736786835, -7060.298430609567, -7016.830733976093, -6952.957068840482, -7135.422376976788, -7066.849244344521, -7040.896775796961, -6946.577431724025, -7023.730168227358, -7076.288791576191, -7018.620189142384, -6959.779870768019, -6975.804982984654, -7107.517259740744, -7035.256969146439, -7062.818438576796, -7116.9719381952345, -6978.387873273061, -7076.900494994287, -6992.520744634531, -7057.108872658992, -7000.437250026758, -7005.307220334115, -7044.628778415727, -7004.355102717656, -7000.9549433222455], "episode_lengths": [1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.3931020726967094, "mean_inference_ms": 0.2310321773941883, "mean_action_processing_ms": 0.05636184390449445, "mean_env_wait_ms": 0.4983628455785452, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002373933792114258, "StateBufferConnector_ms": 0.0018460750579833984, "ViewRequirementAgentConnector_ms": 0.04340100288391113}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 48586200, "num_agent_steps_trained": 48586200, "num_env_steps_sampled": 48586200, "num_env_steps_trained": 48586200, "num_env_steps_sampled_this_iter": 4800, "num_env_steps_trained_this_iter": 4800, "num_env_steps_sampled_throughput_per_sec": 449.6699851561499, "num_env_steps_trained_throughput_per_sec": 449.6699851561499, "timesteps_total": 48586200, "num_steps_trained_this_iter": 4800, "agent_timesteps_total": 48586200, "timers": {"training_iteration_time_ms": 2654.386, "sample_time_ms": 2633.718, "load_time_ms": 0.411, "load_throughput": 2920485.552, "learn_time_ms": 19.656, "learn_throughput": 61051.423, "synch_weights_time_ms": 0.565}, "counters": {"num_env_steps_sampled": 48586200, "num_env_steps_trained": 48586200, "num_agent_steps_sampled": 48586200, "num_agent_steps_trained": 48586200}, "done": false, "episodes_total": 10065, "training_iteration": 3152, "trial_id": "4bd41_00000", "date": "2023-08-08_07-37-02", "timestamp": 1691469422, "time_this_iter_s": 10.676772832870483, "time_total_s": 83870.053814888, "pid": 11406, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 10, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[48412200, 5e-09], [48430200, 5e-09], [48448200, 5e-09], [48466200, 2.5e-09], [48484200, 2.5e-09], [48502200, 2.5e-09], [48520200, 2.5e-09], [48538200, 1e-09], [48556200, 1e-09], [48574200, 1e-09], [48592200, 1e-09], [48610200, 1e-09], [48628200, 5e-10], [48646200, 5e-10], [48664200, 5e-10], [48682200, 5e-10], [48700200, 2.5e-10], [48718200, 2.5e-10], [48736200, 2.5e-10], [48754200, 2.5e-10], [48772200, 1e-10], [48790200, 1e-10], [48808200, 1e-10], [48826200, 5e-11], [48844200, 5e-11], [48862200, 5e-11]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.3, "final_epsilon": 0.01, "epsilon_timesteps": 48880200}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 1200, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17eb87820>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 391.84192633628845, "iterations_since_restore": 37, "perf": {"cpu_util_percent": 20.68, "ram_util_percent": 55.626666666666665}}
