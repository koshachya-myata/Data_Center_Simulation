{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 0.0026, "entropy_coeff": 0.1, "policy_entropy": -132.2721160888672, "policy_loss": -907696246294.9625, "vf_loss": 1043048851.2}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 18.0, "diff_num_grad_updates_vs_sampler_policy": 17.0}}, "num_env_steps_sampled": 1440, "num_env_steps_trained": 1440, "num_agent_steps_sampled": 1440, "num_agent_steps_trained": 1440}, "sampler_results": {"episode_reward_max": -2422.3370447059615, "episode_reward_min": -24990.34634919007, "episode_reward_mean": -9973.171607454296, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-6436.033434161671, -6043.969601759489, -2422.3370447059615, -24990.34634919007], "episode_lengths": [360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.420150906405955, "mean_inference_ms": 0.25447220706344065, "mean_action_processing_ms": 0.06027373896962152, "mean_env_wait_ms": 2.6823931647041954, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0022411346435546875, "StateBufferConnector_ms": 0.0017404556274414062, "ViewRequirementAgentConnector_ms": 0.04337430000305176}}, "episode_reward_max": -2422.3370447059615, "episode_reward_min": -24990.34634919007, "episode_reward_mean": -9973.171607454296, "episode_len_mean": 360.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-6436.033434161671, -6043.969601759489, -2422.3370447059615, -24990.34634919007], "episode_lengths": [360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.420150906405955, "mean_inference_ms": 0.25447220706344065, "mean_action_processing_ms": 0.06027373896962152, "mean_env_wait_ms": 2.6823931647041954, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0022411346435546875, "StateBufferConnector_ms": 0.0017404556274414062, "ViewRequirementAgentConnector_ms": 0.04337430000305176}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1440, "num_agent_steps_trained": 1440, "num_env_steps_sampled": 1440, "num_env_steps_trained": 1440, "num_env_steps_sampled_this_iter": 1440, "num_env_steps_trained_this_iter": 1440, "num_env_steps_sampled_throughput_per_sec": 133.82800301149678, "num_env_steps_trained_throughput_per_sec": 133.82800301149678, "timesteps_total": 1440, "num_steps_trained_this_iter": 1440, "agent_timesteps_total": 1440, "timers": {"training_iteration_time_ms": 2690.004, "sample_time_ms": 2679.402, "load_time_ms": 0.255, "load_throughput": 1413479.466, "learn_time_ms": 9.77, "learn_throughput": 36846.009, "synch_weights_time_ms": 0.544}, "counters": {"num_env_steps_sampled": 1440, "num_env_steps_trained": 1440, "num_agent_steps_sampled": 1440, "num_agent_steps_trained": 1440}, "done": false, "episodes_total": 4, "training_iteration": 1, "trial_id": "f5e97_00000", "date": "2023-07-25_16-56-04", "timestamp": 1690293364, "time_this_iter_s": 10.761929035186768, "time_total_s": 10.761929035186768, "pid": 71917, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[0, 0.003], [5400, 0.001], [10800, 0.00075], [16200, 0.0005], [21600, 0.00025], [27000, 0.0001], [32400, 7.5e-05], [37800, 5e-05], [43200, 2.5e-05], [48600, 1e-05], [54000, 7.5e-06], [59400, 5e-06], [64800, 2.5e-06], [70200, 1e-06], [75600, 5e-07], [81000, 1e-07]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x304530310>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 10.761929035186768, "iterations_since_restore": 1, "perf": {"cpu_util_percent": 27.4125, "ram_util_percent": 77.25}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 0.0019333333333333333, "entropy_coeff": 0.1, "policy_entropy": -831.9997680664062, "policy_loss": -1.374818784066063e+20, "vf_loss": 1087136608.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 43.0, "diff_num_grad_updates_vs_sampler_policy": 42.0}}, "num_env_steps_sampled": 3240, "num_env_steps_trained": 3240, "num_agent_steps_sampled": 3240, "num_agent_steps_trained": 3240}, "sampler_results": {"episode_reward_max": -2422.3370447059615, "episode_reward_min": -25733.06477177539, "episode_reward_mean": -18634.29305006073, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-6436.033434161671, -6043.969601759489, -2422.3370447059615, -24990.34634919007, -25452.837867188566, -25310.57312518208, -25686.93441898636, -25733.06477177539, -25632.540837596986], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.409131743508016, "mean_inference_ms": 0.25265499662677104, "mean_action_processing_ms": 0.05991084756600529, "mean_env_wait_ms": 2.3072897968034156, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0024583604600694445, "StateBufferConnector_ms": 0.0017722447713216145, "ViewRequirementAgentConnector_ms": 0.04374980926513672}}, "episode_reward_max": -2422.3370447059615, "episode_reward_min": -25733.06477177539, "episode_reward_mean": -18634.29305006073, "episode_len_mean": 360.0, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-6436.033434161671, -6043.969601759489, -2422.3370447059615, -24990.34634919007, -25452.837867188566, -25310.57312518208, -25686.93441898636, -25733.06477177539, -25632.540837596986], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.409131743508016, "mean_inference_ms": 0.25265499662677104, "mean_action_processing_ms": 0.05991084756600529, "mean_env_wait_ms": 2.3072897968034156, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0024583604600694445, "StateBufferConnector_ms": 0.0017722447713216145, "ViewRequirementAgentConnector_ms": 0.04374980926513672}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 3240, "num_agent_steps_trained": 3240, "num_env_steps_sampled": 3240, "num_env_steps_trained": 3240, "num_env_steps_sampled_this_iter": 1800, "num_env_steps_trained_this_iter": 1800, "num_env_steps_sampled_throughput_per_sec": 161.2408520516738, "num_env_steps_trained_throughput_per_sec": 161.2408520516738, "timesteps_total": 3240, "num_steps_trained_this_iter": 1800, "agent_timesteps_total": 3240, "timers": {"training_iteration_time_ms": 2435.933, "sample_time_ms": 2426.981, "load_time_ms": 0.23, "load_throughput": 1565255.121, "learn_time_ms": 8.131, "learn_throughput": 44277.157, "synch_weights_time_ms": 0.558}, "counters": {"num_env_steps_sampled": 3240, "num_env_steps_trained": 3240, "num_agent_steps_sampled": 3240, "num_agent_steps_trained": 3240}, "done": false, "episodes_total": 9, "training_iteration": 2, "trial_id": "f5e97_00000", "date": "2023-07-25_16-56-15", "timestamp": 1690293375, "time_this_iter_s": 11.165281057357788, "time_total_s": 21.927210092544556, "pid": 71917, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[0, 0.003], [5400, 0.001], [10800, 0.00075], [16200, 0.0005], [21600, 0.00025], [27000, 0.0001], [32400, 7.5e-05], [37800, 5e-05], [43200, 2.5e-05], [48600, 1e-05], [54000, 7.5e-06], [59400, 5e-06], [64800, 2.5e-06], [70200, 1e-06], [75600, 5e-07], [81000, 1e-07]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x304530310>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 21.927210092544556, "iterations_since_restore": 2, "perf": {"cpu_util_percent": 25.05, "ram_util_percent": 76.91874999999999}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 0.0012666666666666666, "entropy_coeff": 0.1, "policy_entropy": -921.257470703125, "policy_loss": -3.631133280756741e+20, "vf_loss": 1109055148.8}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 68.0, "diff_num_grad_updates_vs_sampler_policy": 67.0}}, "num_env_steps_sampled": 5040, "num_env_steps_trained": 5040, "num_agent_steps_sampled": 5040, "num_agent_steps_trained": 5040}, "sampler_results": {"episode_reward_max": -2422.3370447059615, "episode_reward_min": -25876.087019490118, "episode_reward_mean": -21191.13536602107, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-6436.033434161671, -6043.969601759489, -2422.3370447059615, -24990.34634919007, -25452.837867188566, -25310.57312518208, -25686.93441898636, -25733.06477177539, -25632.540837596986, -25741.25838094305, -25682.951867265267, -25875.54927130328, -25791.41113474669, -25876.087019490118], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.407392819982701, "mean_inference_ms": 0.25133440246761246, "mean_action_processing_ms": 0.05963858886986053, "mean_env_wait_ms": 2.12686688017907, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0025442668369838168, "StateBufferConnector_ms": 0.0018290110996791295, "ViewRequirementAgentConnector_ms": 0.04444973809378488}}, "episode_reward_max": -2422.3370447059615, "episode_reward_min": -25876.087019490118, "episode_reward_mean": -21191.13536602107, "episode_len_mean": 360.0, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-6436.033434161671, -6043.969601759489, -2422.3370447059615, -24990.34634919007, -25452.837867188566, -25310.57312518208, -25686.93441898636, -25733.06477177539, -25632.540837596986, -25741.25838094305, -25682.951867265267, -25875.54927130328, -25791.41113474669, -25876.087019490118], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.407392819982701, "mean_inference_ms": 0.25133440246761246, "mean_action_processing_ms": 0.05963858886986053, "mean_env_wait_ms": 2.12686688017907, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0025442668369838168, "StateBufferConnector_ms": 0.0018290110996791295, "ViewRequirementAgentConnector_ms": 0.04444973809378488}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 5040, "num_agent_steps_trained": 5040, "num_env_steps_sampled": 5040, "num_env_steps_trained": 5040, "num_env_steps_sampled_this_iter": 1800, "num_env_steps_trained_this_iter": 1800, "num_env_steps_sampled_throughput_per_sec": 161.640846121176, "num_env_steps_trained_throughput_per_sec": 161.640846121176, "timesteps_total": 5040, "num_steps_trained_this_iter": 1800, "agent_timesteps_total": 5040, "timers": {"training_iteration_time_ms": 2229.913, "sample_time_ms": 2222.611, "load_time_ms": 0.209, "load_throughput": 1719172.766, "learn_time_ms": 6.526, "learn_throughput": 55161.597, "synch_weights_time_ms": 0.534}, "counters": {"num_env_steps_sampled": 5040, "num_env_steps_trained": 5040, "num_agent_steps_sampled": 5040, "num_agent_steps_trained": 5040}, "done": false, "episodes_total": 14, "training_iteration": 3, "trial_id": "f5e97_00000", "date": "2023-07-25_16-56-26", "timestamp": 1690293386, "time_this_iter_s": 11.13768982887268, "time_total_s": 33.064899921417236, "pid": 71917, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[0, 0.003], [5400, 0.001], [10800, 0.00075], [16200, 0.0005], [21600, 0.00025], [27000, 0.0001], [32400, 7.5e-05], [37800, 5e-05], [43200, 2.5e-05], [48600, 1e-05], [54000, 7.5e-06], [59400, 5e-06], [64800, 2.5e-06], [70200, 1e-06], [75600, 5e-07], [81000, 1e-07]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x304530310>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 33.064899921417236, "iterations_since_restore": 3, "perf": {"cpu_util_percent": 25.30625, "ram_util_percent": 76.1}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 0.00095, "entropy_coeff": 0.1, "policy_entropy": -926.2906005859375, "policy_loss": -1.0081997599464122e+19, "vf_loss": 1096691200.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 93.0, "diff_num_grad_updates_vs_sampler_policy": 92.0}}, "num_env_steps_sampled": 6840, "num_env_steps_trained": 6840, "num_agent_steps_sampled": 6840, "num_agent_steps_trained": 6840}, "sampler_results": {"episode_reward_max": -2422.3370447059615, "episode_reward_min": -25876.087019490118, "episode_reward_mean": -22362.78405435583, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-6436.033434161671, -6043.969601759489, -2422.3370447059615, -24990.34634919007, -25452.837867188566, -25310.57312518208, -25686.93441898636, -25733.06477177539, -25632.540837596986, -25741.25838094305, -25682.951867265267, -25875.54927130328, -25791.41113474669, -25876.087019490118, -25758.293694585434, -25634.18668867263, -25774.040714141163, -25322.081785864284, -25728.39902520237], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.406412990290276, "mean_inference_ms": 0.2503298859995251, "mean_action_processing_ms": 0.059450666646270016, "mean_env_wait_ms": 2.017266958972467, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00244065334922389, "StateBufferConnector_ms": 0.0018107263665450247, "ViewRequirementAgentConnector_ms": 0.04417017886513158}}, "episode_reward_max": -2422.3370447059615, "episode_reward_min": -25876.087019490118, "episode_reward_mean": -22362.78405435583, "episode_len_mean": 360.0, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-6436.033434161671, -6043.969601759489, -2422.3370447059615, -24990.34634919007, -25452.837867188566, -25310.57312518208, -25686.93441898636, -25733.06477177539, -25632.540837596986, -25741.25838094305, -25682.951867265267, -25875.54927130328, -25791.41113474669, -25876.087019490118, -25758.293694585434, -25634.18668867263, -25774.040714141163, -25322.081785864284, -25728.39902520237], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.406412990290276, "mean_inference_ms": 0.2503298859995251, "mean_action_processing_ms": 0.059450666646270016, "mean_env_wait_ms": 2.017266958972467, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00244065334922389, "StateBufferConnector_ms": 0.0018107263665450247, "ViewRequirementAgentConnector_ms": 0.04417017886513158}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 6840, "num_agent_steps_trained": 6840, "num_env_steps_sampled": 6840, "num_env_steps_trained": 6840, "num_env_steps_sampled_this_iter": 1800, "num_env_steps_trained_this_iter": 1800, "num_env_steps_sampled_throughput_per_sec": 161.37122339684933, "num_env_steps_trained_throughput_per_sec": 161.37122339684933, "timesteps_total": 6840, "num_steps_trained_this_iter": 1800, "agent_timesteps_total": 6840, "timers": {"training_iteration_time_ms": 2229.011, "sample_time_ms": 2221.958, "load_time_ms": 0.21, "load_throughput": 1715461.759, "learn_time_ms": 6.307, "learn_throughput": 57083.051, "synch_weights_time_ms": 0.505}, "counters": {"num_env_steps_sampled": 6840, "num_env_steps_trained": 6840, "num_agent_steps_sampled": 6840, "num_agent_steps_trained": 6840}, "done": false, "episodes_total": 19, "training_iteration": 4, "trial_id": "f5e97_00000", "date": "2023-07-25_16-56-37", "timestamp": 1690293397, "time_this_iter_s": 11.156280755996704, "time_total_s": 44.22118067741394, "pid": 71917, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[0, 0.003], [5400, 0.001], [10800, 0.00075], [16200, 0.0005], [21600, 0.00025], [27000, 0.0001], [32400, 7.5e-05], [37800, 5e-05], [43200, 2.5e-05], [48600, 1e-05], [54000, 7.5e-06], [59400, 5e-06], [64800, 2.5e-06], [70200, 1e-06], [75600, 5e-07], [81000, 1e-07]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x304530310>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 44.22118067741394, "iterations_since_restore": 4, "perf": {"cpu_util_percent": 27.32666666666667, "ram_util_percent": 76.44666666666667}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 0.0008666666666666666, "entropy_coeff": 0.1, "policy_entropy": -926.64033203125, "policy_loss": -4.022273898800293e+20, "vf_loss": 1106433612.8}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 118.0, "diff_num_grad_updates_vs_sampler_policy": 117.0}}, "num_env_steps_sampled": 8640, "num_env_steps_trained": 8640, "num_agent_steps_sampled": 8640, "num_agent_steps_trained": 8640}, "sampler_results": {"episode_reward_max": -2422.3370447059615, "episode_reward_min": -26046.034745217887, "episode_reward_mean": -23094.272806945297, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-6436.033434161671, -6043.969601759489, -2422.3370447059615, -24990.34634919007, -25452.837867188566, -25310.57312518208, -25686.93441898636, -25733.06477177539, -25632.540837596986, -25741.25838094305, -25682.951867265267, -25875.54927130328, -25791.41113474669, -25876.087019490118, -25758.293694585434, -25634.18668867263, -25774.040714141163, -25322.081785864284, -25728.39902520237, -26006.438038763314, -25689.929666468986, -26046.034745217887, -25784.412419518667, -25842.835463957334], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.406052726934463, "mean_inference_ms": 0.2496677562504095, "mean_action_processing_ms": 0.05932682442738141, "mean_env_wait_ms": 1.9414195036108584, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0024686257044474282, "StateBufferConnector_ms": 0.0018239021301269531, "ViewRequirementAgentConnector_ms": 0.0440448522567749}}, "episode_reward_max": -2422.3370447059615, "episode_reward_min": -26046.034745217887, "episode_reward_mean": -23094.272806945297, "episode_len_mean": 360.0, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-6436.033434161671, -6043.969601759489, -2422.3370447059615, -24990.34634919007, -25452.837867188566, -25310.57312518208, -25686.93441898636, -25733.06477177539, -25632.540837596986, -25741.25838094305, -25682.951867265267, -25875.54927130328, -25791.41113474669, -25876.087019490118, -25758.293694585434, -25634.18668867263, -25774.040714141163, -25322.081785864284, -25728.39902520237, -26006.438038763314, -25689.929666468986, -26046.034745217887, -25784.412419518667, -25842.835463957334], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.406052726934463, "mean_inference_ms": 0.2496677562504095, "mean_action_processing_ms": 0.05932682442738141, "mean_env_wait_ms": 1.9414195036108584, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0024686257044474282, "StateBufferConnector_ms": 0.0018239021301269531, "ViewRequirementAgentConnector_ms": 0.0440448522567749}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 8640, "num_agent_steps_trained": 8640, "num_env_steps_sampled": 8640, "num_env_steps_trained": 8640, "num_env_steps_sampled_this_iter": 1800, "num_env_steps_trained_this_iter": 1800, "num_env_steps_sampled_throughput_per_sec": 161.5723800337875, "num_env_steps_trained_throughput_per_sec": 161.5723800337875, "timesteps_total": 8640, "num_steps_trained_this_iter": 1800, "agent_timesteps_total": 8640, "timers": {"training_iteration_time_ms": 2229.482, "sample_time_ms": 2222.27, "load_time_ms": 0.212, "load_throughput": 1699627.915, "learn_time_ms": 6.433, "learn_throughput": 55963.02, "synch_weights_time_ms": 0.536}, "counters": {"num_env_steps_sampled": 8640, "num_env_steps_trained": 8640, "num_agent_steps_sampled": 8640, "num_agent_steps_trained": 8640}, "done": false, "episodes_total": 24, "training_iteration": 5, "trial_id": "f5e97_00000", "date": "2023-07-25_16-56-48", "timestamp": 1690293408, "time_this_iter_s": 11.142423152923584, "time_total_s": 55.363603830337524, "pid": 71917, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[0, 0.003], [5400, 0.001], [10800, 0.00075], [16200, 0.0005], [21600, 0.00025], [27000, 0.0001], [32400, 7.5e-05], [37800, 5e-05], [43200, 2.5e-05], [48600, 1e-05], [54000, 7.5e-06], [59400, 5e-06], [64800, 2.5e-06], [70200, 1e-06], [75600, 5e-07], [81000, 1e-07]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x304530310>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 55.363603830337524, "iterations_since_restore": 5, "perf": {"cpu_util_percent": 24.43125, "ram_util_percent": 76.63749999999999}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 0.0007833333333333335, "entropy_coeff": 0.1, "policy_entropy": -926.6677612304687, "policy_loss": -3.89038294110739e+19, "vf_loss": 1096247769.6}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 143.0, "diff_num_grad_updates_vs_sampler_policy": 142.0}}, "num_env_steps_sampled": 10440, "num_env_steps_trained": 10440, "num_agent_steps_sampled": 10440, "num_agent_steps_trained": 10440}, "sampler_results": {"episode_reward_max": -2422.3370447059615, "episode_reward_min": -26046.034745217887, "episode_reward_mean": -23549.797490732148, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-6436.033434161671, -6043.969601759489, -2422.3370447059615, -24990.34634919007, -25452.837867188566, -25310.57312518208, -25686.93441898636, -25733.06477177539, -25632.540837596986, -25741.25838094305, -25682.951867265267, -25875.54927130328, -25791.41113474669, -25876.087019490118, -25758.293694585434, -25634.18668867263, -25774.040714141163, -25322.081785864284, -25728.39902520237, -26006.438038763314, -25689.929666468986, -26046.034745217887, -25784.412419518667, -25842.835463957334, -25734.83061046133, -25844.28041359334, -25635.44875060622, -25803.193126233928, -25663.826963650325], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.406559826138338, "mean_inference_ms": 0.2492433346760548, "mean_action_processing_ms": 0.05924695961268471, "mean_env_wait_ms": 1.885648835086127, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002499284415409483, "StateBufferConnector_ms": 0.001830890260893723, "ViewRequirementAgentConnector_ms": 0.044284195735536776}}, "episode_reward_max": -2422.3370447059615, "episode_reward_min": -26046.034745217887, "episode_reward_mean": -23549.797490732148, "episode_len_mean": 360.0, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-6436.033434161671, -6043.969601759489, -2422.3370447059615, -24990.34634919007, -25452.837867188566, -25310.57312518208, -25686.93441898636, -25733.06477177539, -25632.540837596986, -25741.25838094305, -25682.951867265267, -25875.54927130328, -25791.41113474669, -25876.087019490118, -25758.293694585434, -25634.18668867263, -25774.040714141163, -25322.081785864284, -25728.39902520237, -26006.438038763314, -25689.929666468986, -26046.034745217887, -25784.412419518667, -25842.835463957334, -25734.83061046133, -25844.28041359334, -25635.44875060622, -25803.193126233928, -25663.826963650325], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.406559826138338, "mean_inference_ms": 0.2492433346760548, "mean_action_processing_ms": 0.05924695961268471, "mean_env_wait_ms": 1.885648835086127, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002499284415409483, "StateBufferConnector_ms": 0.001830890260893723, "ViewRequirementAgentConnector_ms": 0.044284195735536776}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 10440, "num_agent_steps_trained": 10440, "num_env_steps_sampled": 10440, "num_env_steps_trained": 10440, "num_env_steps_sampled_this_iter": 1800, "num_env_steps_trained_this_iter": 1800, "num_env_steps_sampled_throughput_per_sec": 160.65790999957463, "num_env_steps_trained_throughput_per_sec": 160.65790999957463, "timesteps_total": 10440, "num_steps_trained_this_iter": 1800, "agent_timesteps_total": 10440, "timers": {"training_iteration_time_ms": 2234.435, "sample_time_ms": 2227.243, "load_time_ms": 0.219, "load_throughput": 1641249.391, "learn_time_ms": 6.411, "learn_throughput": 56150.318, "synch_weights_time_ms": 0.53}, "counters": {"num_env_steps_sampled": 10440, "num_env_steps_trained": 10440, "num_agent_steps_sampled": 10440, "num_agent_steps_trained": 10440}, "done": false, "episodes_total": 29, "training_iteration": 6, "trial_id": "f5e97_00000", "date": "2023-07-25_16-56-59", "timestamp": 1690293419, "time_this_iter_s": 11.206015825271606, "time_total_s": 66.56961965560913, "pid": 71917, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[0, 0.003], [5400, 0.001], [10800, 0.00075], [16200, 0.0005], [21600, 0.00025], [27000, 0.0001], [32400, 7.5e-05], [37800, 5e-05], [43200, 2.5e-05], [48600, 1e-05], [54000, 7.5e-06], [59400, 5e-06], [64800, 2.5e-06], [70200, 1e-06], [75600, 5e-07], [81000, 1e-07]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x304530310>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 66.56961965560913, "iterations_since_restore": 6, "perf": {"cpu_util_percent": 24.687500000000004, "ram_util_percent": 77.05}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 0.0007, "entropy_coeff": 0.1, "policy_entropy": -926.6711303710938, "policy_loss": -3.184076558571954e+20, "vf_loss": 1086358726.4}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 168.0, "diff_num_grad_updates_vs_sampler_policy": 167.0}}, "num_env_steps_sampled": 12240, "num_env_steps_trained": 12240, "num_agent_steps_sampled": 12240, "num_agent_steps_trained": 12240}, "sampler_results": {"episode_reward_max": -2422.3370447059615, "episode_reward_min": -26099.42399150872, "episode_reward_mean": -23873.30018329586, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-6436.033434161671, -6043.969601759489, -2422.3370447059615, -24990.34634919007, -25452.837867188566, -25310.57312518208, -25686.93441898636, -25733.06477177539, -25632.540837596986, -25741.25838094305, -25682.951867265267, -25875.54927130328, -25791.41113474669, -25876.087019490118, -25758.293694585434, -25634.18668867263, -25774.040714141163, -25322.081785864284, -25728.39902520237, -26006.438038763314, -25689.929666468986, -26046.034745217887, -25784.412419518667, -25842.835463957334, -25734.83061046133, -25844.28041359334, -25635.44875060622, -25803.193126233928, -25663.826963650325, -25802.505894538343, -25696.01838045785, -25481.06001408537, -26099.42399150872, -25669.070720236832], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.406914623897434, "mean_inference_ms": 0.2488927227122912, "mean_action_processing_ms": 0.05917741348480801, "mean_env_wait_ms": 1.8422433174321469, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0024578150580911074, "StateBufferConnector_ms": 0.0018358230590820312, "ViewRequirementAgentConnector_ms": 0.04432061139275046}}, "episode_reward_max": -2422.3370447059615, "episode_reward_min": -26099.42399150872, "episode_reward_mean": -23873.30018329586, "episode_len_mean": 360.0, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-6436.033434161671, -6043.969601759489, -2422.3370447059615, -24990.34634919007, -25452.837867188566, -25310.57312518208, -25686.93441898636, -25733.06477177539, -25632.540837596986, -25741.25838094305, -25682.951867265267, -25875.54927130328, -25791.41113474669, -25876.087019490118, -25758.293694585434, -25634.18668867263, -25774.040714141163, -25322.081785864284, -25728.39902520237, -26006.438038763314, -25689.929666468986, -26046.034745217887, -25784.412419518667, -25842.835463957334, -25734.83061046133, -25844.28041359334, -25635.44875060622, -25803.193126233928, -25663.826963650325, -25802.505894538343, -25696.01838045785, -25481.06001408537, -26099.42399150872, -25669.070720236832], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.406914623897434, "mean_inference_ms": 0.2488927227122912, "mean_action_processing_ms": 0.05917741348480801, "mean_env_wait_ms": 1.8422433174321469, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0024578150580911074, "StateBufferConnector_ms": 0.0018358230590820312, "ViewRequirementAgentConnector_ms": 0.04432061139275046}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 12240, "num_agent_steps_trained": 12240, "num_env_steps_sampled": 12240, "num_env_steps_trained": 12240, "num_env_steps_sampled_this_iter": 1800, "num_env_steps_trained_this_iter": 1800, "num_env_steps_sampled_throughput_per_sec": 161.73019312902576, "num_env_steps_trained_throughput_per_sec": 161.73019312902576, "timesteps_total": 12240, "num_steps_trained_this_iter": 1800, "agent_timesteps_total": 12240, "timers": {"training_iteration_time_ms": 2233.348, "sample_time_ms": 2226.218, "load_time_ms": 0.225, "load_throughput": 1599522.712, "learn_time_ms": 6.354, "learn_throughput": 56656.602, "synch_weights_time_ms": 0.519}, "counters": {"num_env_steps_sampled": 12240, "num_env_steps_trained": 12240, "num_agent_steps_sampled": 12240, "num_agent_steps_trained": 12240}, "done": false, "episodes_total": 34, "training_iteration": 7, "trial_id": "f5e97_00000", "date": "2023-07-25_16-57-11", "timestamp": 1690293431, "time_this_iter_s": 11.131549835205078, "time_total_s": 77.70116949081421, "pid": 71917, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[0, 0.003], [5400, 0.001], [10800, 0.00075], [16200, 0.0005], [21600, 0.00025], [27000, 0.0001], [32400, 7.5e-05], [37800, 5e-05], [43200, 2.5e-05], [48600, 1e-05], [54000, 7.5e-06], [59400, 5e-06], [64800, 2.5e-06], [70200, 1e-06], [75600, 5e-07], [81000, 1e-07]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x304530310>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 77.70116949081421, "iterations_since_restore": 7, "perf": {"cpu_util_percent": 28.8375, "ram_util_percent": 77.2125}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 0.0006166666666666666, "entropy_coeff": 0.1, "policy_entropy": -926.6709350585937, "policy_loss": -9.802350848403336e+19, "vf_loss": 1077552838.4}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 193.0, "diff_num_grad_updates_vs_sampler_policy": 192.0}}, "num_env_steps_sampled": 14040, "num_env_steps_trained": 14040, "num_agent_steps_sampled": 14040, "num_agent_steps_trained": 14040}, "sampler_results": {"episode_reward_max": -2422.3370447059615, "episode_reward_min": -26099.42399150872, "episode_reward_mean": -24096.926719343443, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-6436.033434161671, -6043.969601759489, -2422.3370447059615, -24990.34634919007, -25452.837867188566, -25310.57312518208, -25686.93441898636, -25733.06477177539, -25632.540837596986, -25741.25838094305, -25682.951867265267, -25875.54927130328, -25791.41113474669, -25876.087019490118, -25758.293694585434, -25634.18668867263, -25774.040714141163, -25322.081785864284, -25728.39902520237, -26006.438038763314, -25689.929666468986, -26046.034745217887, -25784.412419518667, -25842.835463957334, -25734.83061046133, -25844.28041359334, -25635.44875060622, -25803.193126233928, -25663.826963650325, -25802.505894538343, -25696.01838045785, -25481.06001408537, -26099.42399150872, -25669.070720236832, -25574.459522488956, -25661.384923105496, -25628.895882615365, -25692.711051277838, -25530.484442847315], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.407213868038216, "mean_inference_ms": 0.24858674744441983, "mean_action_processing_ms": 0.05911537185942593, "mean_env_wait_ms": 1.807554251462849, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002389076428535657, "StateBufferConnector_ms": 0.0018443816747420873, "ViewRequirementAgentConnector_ms": 0.0441887439825596}}, "episode_reward_max": -2422.3370447059615, "episode_reward_min": -26099.42399150872, "episode_reward_mean": -24096.926719343443, "episode_len_mean": 360.0, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-6436.033434161671, -6043.969601759489, -2422.3370447059615, -24990.34634919007, -25452.837867188566, -25310.57312518208, -25686.93441898636, -25733.06477177539, -25632.540837596986, -25741.25838094305, -25682.951867265267, -25875.54927130328, -25791.41113474669, -25876.087019490118, -25758.293694585434, -25634.18668867263, -25774.040714141163, -25322.081785864284, -25728.39902520237, -26006.438038763314, -25689.929666468986, -26046.034745217887, -25784.412419518667, -25842.835463957334, -25734.83061046133, -25844.28041359334, -25635.44875060622, -25803.193126233928, -25663.826963650325, -25802.505894538343, -25696.01838045785, -25481.06001408537, -26099.42399150872, -25669.070720236832, -25574.459522488956, -25661.384923105496, -25628.895882615365, -25692.711051277838, -25530.484442847315], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.407213868038216, "mean_inference_ms": 0.24858674744441983, "mean_action_processing_ms": 0.05911537185942593, "mean_env_wait_ms": 1.807554251462849, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002389076428535657, "StateBufferConnector_ms": 0.0018443816747420873, "ViewRequirementAgentConnector_ms": 0.0441887439825596}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 14040, "num_agent_steps_trained": 14040, "num_env_steps_sampled": 14040, "num_env_steps_trained": 14040, "num_env_steps_sampled_this_iter": 1800, "num_env_steps_trained_this_iter": 1800, "num_env_steps_sampled_throughput_per_sec": 161.36642223786686, "num_env_steps_trained_throughput_per_sec": 161.36642223786686, "timesteps_total": 14040, "num_steps_trained_this_iter": 1800, "agent_timesteps_total": 14040, "timers": {"training_iteration_time_ms": 2228.428, "sample_time_ms": 2221.205, "load_time_ms": 0.222, "load_throughput": 1618380.965, "learn_time_ms": 6.432, "learn_throughput": 55974.223, "synch_weights_time_ms": 0.537}, "counters": {"num_env_steps_sampled": 14040, "num_env_steps_trained": 14040, "num_agent_steps_sampled": 14040, "num_agent_steps_trained": 14040}, "done": false, "episodes_total": 39, "training_iteration": 8, "trial_id": "f5e97_00000", "date": "2023-07-25_16-57-22", "timestamp": 1690293442, "time_this_iter_s": 11.156621217727661, "time_total_s": 88.85779070854187, "pid": 71917, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[0, 0.003], [5400, 0.001], [10800, 0.00075], [16200, 0.0005], [21600, 0.00025], [27000, 0.0001], [32400, 7.5e-05], [37800, 5e-05], [43200, 2.5e-05], [48600, 1e-05], [54000, 7.5e-06], [59400, 5e-06], [64800, 2.5e-06], [70200, 1e-06], [75600, 5e-07], [81000, 1e-07]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x304530310>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 88.85779070854187, "iterations_since_restore": 8, "perf": {"cpu_util_percent": 25.89375, "ram_util_percent": 77.4375}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 0.0005333333333333334, "entropy_coeff": 0.1, "policy_entropy": -926.6711303710938, "policy_loss": -9.84234593518251e+19, "vf_loss": 1091691456.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 218.0, "diff_num_grad_updates_vs_sampler_policy": 217.0}}, "num_env_steps_sampled": 15840, "num_env_steps_trained": 15840, "num_agent_steps_sampled": 15840, "num_agent_steps_trained": 15840}, "sampler_results": {"episode_reward_max": -2422.3370447059615, "episode_reward_min": -26099.42399150872, "episode_reward_mean": -24288.504757337967, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-6436.033434161671, -6043.969601759489, -2422.3370447059615, -24990.34634919007, -25452.837867188566, -25310.57312518208, -25686.93441898636, -25733.06477177539, -25632.540837596986, -25741.25838094305, -25682.951867265267, -25875.54927130328, -25791.41113474669, -25876.087019490118, -25758.293694585434, -25634.18668867263, -25774.040714141163, -25322.081785864284, -25728.39902520237, -26006.438038763314, -25689.929666468986, -26046.034745217887, -25784.412419518667, -25842.835463957334, -25734.83061046133, -25844.28041359334, -25635.44875060622, -25803.193126233928, -25663.826963650325, -25802.505894538343, -25696.01838045785, -25481.06001408537, -26099.42399150872, -25669.070720236832, -25574.459522488956, -25661.384923105496, -25628.895882615365, -25692.711051277838, -25530.484442847315, -25739.569920149836, -25575.22608879392, -25806.46826871708, -26030.406526650026, -25762.396464165115], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.4078325023395495, "mean_inference_ms": 0.24833478606211135, "mean_action_processing_ms": 0.0590674425708682, "mean_env_wait_ms": 1.779196455613504, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0024817206642844462, "StateBufferConnector_ms": 0.001810355619950728, "ViewRequirementAgentConnector_ms": 0.04406354644081809}}, "episode_reward_max": -2422.3370447059615, "episode_reward_min": -26099.42399150872, "episode_reward_mean": -24288.504757337967, "episode_len_mean": 360.0, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-6436.033434161671, -6043.969601759489, -2422.3370447059615, -24990.34634919007, -25452.837867188566, -25310.57312518208, -25686.93441898636, -25733.06477177539, -25632.540837596986, -25741.25838094305, -25682.951867265267, -25875.54927130328, -25791.41113474669, -25876.087019490118, -25758.293694585434, -25634.18668867263, -25774.040714141163, -25322.081785864284, -25728.39902520237, -26006.438038763314, -25689.929666468986, -26046.034745217887, -25784.412419518667, -25842.835463957334, -25734.83061046133, -25844.28041359334, -25635.44875060622, -25803.193126233928, -25663.826963650325, -25802.505894538343, -25696.01838045785, -25481.06001408537, -26099.42399150872, -25669.070720236832, -25574.459522488956, -25661.384923105496, -25628.895882615365, -25692.711051277838, -25530.484442847315, -25739.569920149836, -25575.22608879392, -25806.46826871708, -26030.406526650026, -25762.396464165115], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.4078325023395495, "mean_inference_ms": 0.24833478606211135, "mean_action_processing_ms": 0.0590674425708682, "mean_env_wait_ms": 1.779196455613504, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0024817206642844462, "StateBufferConnector_ms": 0.001810355619950728, "ViewRequirementAgentConnector_ms": 0.04406354644081809}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 15840, "num_agent_steps_trained": 15840, "num_env_steps_sampled": 15840, "num_env_steps_trained": 15840, "num_env_steps_sampled_this_iter": 1800, "num_env_steps_trained_this_iter": 1800, "num_env_steps_sampled_throughput_per_sec": 160.31464341750453, "num_env_steps_trained_throughput_per_sec": 160.31464341750453, "timesteps_total": 15840, "num_steps_trained_this_iter": 1800, "agent_timesteps_total": 15840, "timers": {"training_iteration_time_ms": 2238.256, "sample_time_ms": 2230.674, "load_time_ms": 0.222, "load_throughput": 1618034.119, "learn_time_ms": 6.787, "learn_throughput": 53040.422, "synch_weights_time_ms": 0.539}, "counters": {"num_env_steps_sampled": 15840, "num_env_steps_trained": 15840, "num_agent_steps_sampled": 15840, "num_agent_steps_trained": 15840}, "done": false, "episodes_total": 44, "training_iteration": 9, "trial_id": "f5e97_00000", "date": "2023-07-25_16-57-33", "timestamp": 1690293453, "time_this_iter_s": 11.229753017425537, "time_total_s": 100.08754372596741, "pid": 71917, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[0, 0.003], [5400, 0.001], [10800, 0.00075], [16200, 0.0005], [21600, 0.00025], [27000, 0.0001], [32400, 7.5e-05], [37800, 5e-05], [43200, 2.5e-05], [48600, 1e-05], [54000, 7.5e-06], [59400, 5e-06], [64800, 2.5e-06], [70200, 1e-06], [75600, 5e-07], [81000, 1e-07]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x304530310>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 100.08754372596741, "iterations_since_restore": 9, "perf": {"cpu_util_percent": 26.51875, "ram_util_percent": 77.5625}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 0.00045, "entropy_coeff": 0.1, "policy_entropy": -926.6713500976563, "policy_loss": -5.539077745205685e+18, "vf_loss": 1087954604.8}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 243.0, "diff_num_grad_updates_vs_sampler_policy": 242.0}}, "num_env_steps_sampled": 17640, "num_env_steps_trained": 17640, "num_agent_steps_sampled": 17640, "num_agent_steps_trained": 17640}, "sampler_results": {"episode_reward_max": -2422.3370447059615, "episode_reward_min": -26099.42399150872, "episode_reward_mean": -24422.15321075046, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-6436.033434161671, -6043.969601759489, -2422.3370447059615, -24990.34634919007, -25452.837867188566, -25310.57312518208, -25686.93441898636, -25733.06477177539, -25632.540837596986, -25741.25838094305, -25682.951867265267, -25875.54927130328, -25791.41113474669, -25876.087019490118, -25758.293694585434, -25634.18668867263, -25774.040714141163, -25322.081785864284, -25728.39902520237, -26006.438038763314, -25689.929666468986, -26046.034745217887, -25784.412419518667, -25842.835463957334, -25734.83061046133, -25844.28041359334, -25635.44875060622, -25803.193126233928, -25663.826963650325, -25802.505894538343, -25696.01838045785, -25481.06001408537, -26099.42399150872, -25669.070720236832, -25574.459522488956, -25661.384923105496, -25628.895882615365, -25692.711051277838, -25530.484442847315, -25739.569920149836, -25575.22608879392, -25806.46826871708, -26030.406526650026, -25762.396464165115, -25472.808615743124, -25512.665211606723, -25694.924278548217, -25700.022311652854, -25610.877586351526], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.408073902089295, "mean_inference_ms": 0.24811633886108686, "mean_action_processing_ms": 0.05902625554669563, "mean_env_wait_ms": 1.7556808967905717, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002514099588199538, "StateBufferConnector_ms": 0.0018139274752869898, "ViewRequirementAgentConnector_ms": 0.044260219651825576}}, "episode_reward_max": -2422.3370447059615, "episode_reward_min": -26099.42399150872, "episode_reward_mean": -24422.15321075046, "episode_len_mean": 360.0, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-6436.033434161671, -6043.969601759489, -2422.3370447059615, -24990.34634919007, -25452.837867188566, -25310.57312518208, -25686.93441898636, -25733.06477177539, -25632.540837596986, -25741.25838094305, -25682.951867265267, -25875.54927130328, -25791.41113474669, -25876.087019490118, -25758.293694585434, -25634.18668867263, -25774.040714141163, -25322.081785864284, -25728.39902520237, -26006.438038763314, -25689.929666468986, -26046.034745217887, -25784.412419518667, -25842.835463957334, -25734.83061046133, -25844.28041359334, -25635.44875060622, -25803.193126233928, -25663.826963650325, -25802.505894538343, -25696.01838045785, -25481.06001408537, -26099.42399150872, -25669.070720236832, -25574.459522488956, -25661.384923105496, -25628.895882615365, -25692.711051277838, -25530.484442847315, -25739.569920149836, -25575.22608879392, -25806.46826871708, -26030.406526650026, -25762.396464165115, -25472.808615743124, -25512.665211606723, -25694.924278548217, -25700.022311652854, -25610.877586351526], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.408073902089295, "mean_inference_ms": 0.24811633886108686, "mean_action_processing_ms": 0.05902625554669563, "mean_env_wait_ms": 1.7556808967905717, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002514099588199538, "StateBufferConnector_ms": 0.0018139274752869898, "ViewRequirementAgentConnector_ms": 0.044260219651825576}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 17640, "num_agent_steps_trained": 17640, "num_env_steps_sampled": 17640, "num_env_steps_trained": 17640, "num_env_steps_sampled_this_iter": 1800, "num_env_steps_trained_this_iter": 1800, "num_env_steps_sampled_throughput_per_sec": 161.32751648742294, "num_env_steps_trained_throughput_per_sec": 161.32751648742294, "timesteps_total": 17640, "num_steps_trained_this_iter": 1800, "agent_timesteps_total": 17640, "timers": {"training_iteration_time_ms": 2238.525, "sample_time_ms": 2231.068, "load_time_ms": 0.219, "load_throughput": 1640714.376, "learn_time_ms": 6.677, "learn_throughput": 53915.79, "synch_weights_time_ms": 0.528}, "counters": {"num_env_steps_sampled": 17640, "num_env_steps_trained": 17640, "num_agent_steps_sampled": 17640, "num_agent_steps_trained": 17640}, "done": false, "episodes_total": 49, "training_iteration": 10, "trial_id": "f5e97_00000", "date": "2023-07-25_16-57-44", "timestamp": 1690293464, "time_this_iter_s": 11.159456014633179, "time_total_s": 111.24699974060059, "pid": 71917, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[0, 0.003], [5400, 0.001], [10800, 0.00075], [16200, 0.0005], [21600, 0.00025], [27000, 0.0001], [32400, 7.5e-05], [37800, 5e-05], [43200, 2.5e-05], [48600, 1e-05], [54000, 7.5e-06], [59400, 5e-06], [64800, 2.5e-06], [70200, 1e-06], [75600, 5e-07], [81000, 1e-07]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x304530310>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 111.24699974060059, "iterations_since_restore": 10, "perf": {"cpu_util_percent": 26.56875, "ram_util_percent": 77.21875}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 0.00036666666666666667, "entropy_coeff": 0.1, "policy_entropy": -926.671484375, "policy_loss": -1.407579393015113e+20, "vf_loss": 1099790470.4}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 268.0, "diff_num_grad_updates_vs_sampler_policy": 267.0}}, "num_env_steps_sampled": 19440, "num_env_steps_trained": 19440, "num_agent_steps_sampled": 19440, "num_agent_steps_trained": 19440}, "sampler_results": {"episode_reward_max": -2422.3370447059615, "episode_reward_min": -26099.42399150872, "episode_reward_mean": -24546.34271422623, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-6436.033434161671, -6043.969601759489, -2422.3370447059615, -24990.34634919007, -25452.837867188566, -25310.57312518208, -25686.93441898636, -25733.06477177539, -25632.540837596986, -25741.25838094305, -25682.951867265267, -25875.54927130328, -25791.41113474669, -25876.087019490118, -25758.293694585434, -25634.18668867263, -25774.040714141163, -25322.081785864284, -25728.39902520237, -26006.438038763314, -25689.929666468986, -26046.034745217887, -25784.412419518667, -25842.835463957334, -25734.83061046133, -25844.28041359334, -25635.44875060622, -25803.193126233928, -25663.826963650325, -25802.505894538343, -25696.01838045785, -25481.06001408537, -26099.42399150872, -25669.070720236832, -25574.459522488956, -25661.384923105496, -25628.895882615365, -25692.711051277838, -25530.484442847315, -25739.569920149836, -25575.22608879392, -25806.46826871708, -26030.406526650026, -25762.396464165115, -25472.808615743124, -25512.665211606723, -25694.924278548217, -25700.022311652854, -25610.877586351526, -25766.714040352563, -25633.132008411972, -25910.175594312626, -25714.65018026558, -25792.327418101308], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.408580182029255, "mean_inference_ms": 0.24795586888997653, "mean_action_processing_ms": 0.0589955743877482, "mean_env_wait_ms": 1.7355289069555115, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002476021095558449, "StateBufferConnector_ms": 0.0018102151376229744, "ViewRequirementAgentConnector_ms": 0.04420148001776801}}, "episode_reward_max": -2422.3370447059615, "episode_reward_min": -26099.42399150872, "episode_reward_mean": -24546.34271422623, "episode_len_mean": 360.0, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-6436.033434161671, -6043.969601759489, -2422.3370447059615, -24990.34634919007, -25452.837867188566, -25310.57312518208, -25686.93441898636, -25733.06477177539, -25632.540837596986, -25741.25838094305, -25682.951867265267, -25875.54927130328, -25791.41113474669, -25876.087019490118, -25758.293694585434, -25634.18668867263, -25774.040714141163, -25322.081785864284, -25728.39902520237, -26006.438038763314, -25689.929666468986, -26046.034745217887, -25784.412419518667, -25842.835463957334, -25734.83061046133, -25844.28041359334, -25635.44875060622, -25803.193126233928, -25663.826963650325, -25802.505894538343, -25696.01838045785, -25481.06001408537, -26099.42399150872, -25669.070720236832, -25574.459522488956, -25661.384923105496, -25628.895882615365, -25692.711051277838, -25530.484442847315, -25739.569920149836, -25575.22608879392, -25806.46826871708, -26030.406526650026, -25762.396464165115, -25472.808615743124, -25512.665211606723, -25694.924278548217, -25700.022311652854, -25610.877586351526, -25766.714040352563, -25633.132008411972, -25910.175594312626, -25714.65018026558, -25792.327418101308], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.408580182029255, "mean_inference_ms": 0.24795586888997653, "mean_action_processing_ms": 0.0589955743877482, "mean_env_wait_ms": 1.7355289069555115, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002476021095558449, "StateBufferConnector_ms": 0.0018102151376229744, "ViewRequirementAgentConnector_ms": 0.04420148001776801}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 19440, "num_agent_steps_trained": 19440, "num_env_steps_sampled": 19440, "num_env_steps_trained": 19440, "num_env_steps_sampled_this_iter": 1800, "num_env_steps_trained_this_iter": 1800, "num_env_steps_sampled_throughput_per_sec": 160.6088175746733, "num_env_steps_trained_throughput_per_sec": 160.6088175746733, "timesteps_total": 19440, "num_steps_trained_this_iter": 1800, "agent_timesteps_total": 19440, "timers": {"training_iteration_time_ms": 2236.469, "sample_time_ms": 2229.408, "load_time_ms": 0.215, "load_throughput": 1674558.545, "learn_time_ms": 6.304, "learn_throughput": 57108.094, "synch_weights_time_ms": 0.512}, "counters": {"num_env_steps_sampled": 19440, "num_env_steps_trained": 19440, "num_agent_steps_sampled": 19440, "num_agent_steps_trained": 19440}, "done": false, "episodes_total": 54, "training_iteration": 11, "trial_id": "f5e97_00000", "date": "2023-07-25_16-57-55", "timestamp": 1690293475, "time_this_iter_s": 11.209558963775635, "time_total_s": 122.45655870437622, "pid": 71917, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[0, 0.003], [5400, 0.001], [10800, 0.00075], [16200, 0.0005], [21600, 0.00025], [27000, 0.0001], [32400, 7.5e-05], [37800, 5e-05], [43200, 2.5e-05], [48600, 1e-05], [54000, 7.5e-06], [59400, 5e-06], [64800, 2.5e-06], [70200, 1e-06], [75600, 5e-07], [81000, 1e-07]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x304530310>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 122.45655870437622, "iterations_since_restore": 11, "perf": {"cpu_util_percent": 25.793750000000003, "ram_util_percent": 78.06875}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 0.00028333333333333335, "entropy_coeff": 0.1, "policy_entropy": -926.6714233398437, "policy_loss": -7.52406704483731e+18, "vf_loss": 1082896627.2}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 293.0, "diff_num_grad_updates_vs_sampler_policy": 292.0}}, "num_env_steps_sampled": 21240, "num_env_steps_trained": 21240, "num_agent_steps_sampled": 21240, "num_agent_steps_trained": 21240}, "sampler_results": {"episode_reward_max": -2422.3370447059615, "episode_reward_min": -26099.42399150872, "episode_reward_mean": -24646.54509937735, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-6436.033434161671, -6043.969601759489, -2422.3370447059615, -24990.34634919007, -25452.837867188566, -25310.57312518208, -25686.93441898636, -25733.06477177539, -25632.540837596986, -25741.25838094305, -25682.951867265267, -25875.54927130328, -25791.41113474669, -25876.087019490118, -25758.293694585434, -25634.18668867263, -25774.040714141163, -25322.081785864284, -25728.39902520237, -26006.438038763314, -25689.929666468986, -26046.034745217887, -25784.412419518667, -25842.835463957334, -25734.83061046133, -25844.28041359334, -25635.44875060622, -25803.193126233928, -25663.826963650325, -25802.505894538343, -25696.01838045785, -25481.06001408537, -26099.42399150872, -25669.070720236832, -25574.459522488956, -25661.384923105496, -25628.895882615365, -25692.711051277838, -25530.484442847315, -25739.569920149836, -25575.22608879392, -25806.46826871708, -26030.406526650026, -25762.396464165115, -25472.808615743124, -25512.665211606723, -25694.924278548217, -25700.022311652854, -25610.877586351526, -25766.714040352563, -25633.132008411972, -25910.175594312626, -25714.65018026558, -25792.327418101308, -25778.692984522557, -26007.63610235267, -25675.403200363275, -25552.72024906665, -25629.20175874157], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.408924092218216, "mean_inference_ms": 0.2478167525602246, "mean_action_processing_ms": 0.058969675219657555, "mean_env_wait_ms": 1.7181505282861975, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0024565195633193195, "StateBufferConnector_ms": 0.001803091016866393, "ViewRequirementAgentConnector_ms": 0.0441809832039526}}, "episode_reward_max": -2422.3370447059615, "episode_reward_min": -26099.42399150872, "episode_reward_mean": -24646.54509937735, "episode_len_mean": 360.0, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-6436.033434161671, -6043.969601759489, -2422.3370447059615, -24990.34634919007, -25452.837867188566, -25310.57312518208, -25686.93441898636, -25733.06477177539, -25632.540837596986, -25741.25838094305, -25682.951867265267, -25875.54927130328, -25791.41113474669, -25876.087019490118, -25758.293694585434, -25634.18668867263, -25774.040714141163, -25322.081785864284, -25728.39902520237, -26006.438038763314, -25689.929666468986, -26046.034745217887, -25784.412419518667, -25842.835463957334, -25734.83061046133, -25844.28041359334, -25635.44875060622, -25803.193126233928, -25663.826963650325, -25802.505894538343, -25696.01838045785, -25481.06001408537, -26099.42399150872, -25669.070720236832, -25574.459522488956, -25661.384923105496, -25628.895882615365, -25692.711051277838, -25530.484442847315, -25739.569920149836, -25575.22608879392, -25806.46826871708, -26030.406526650026, -25762.396464165115, -25472.808615743124, -25512.665211606723, -25694.924278548217, -25700.022311652854, -25610.877586351526, -25766.714040352563, -25633.132008411972, -25910.175594312626, -25714.65018026558, -25792.327418101308, -25778.692984522557, -26007.63610235267, -25675.403200363275, -25552.72024906665, -25629.20175874157], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.408924092218216, "mean_inference_ms": 0.2478167525602246, "mean_action_processing_ms": 0.058969675219657555, "mean_env_wait_ms": 1.7181505282861975, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0024565195633193195, "StateBufferConnector_ms": 0.001803091016866393, "ViewRequirementAgentConnector_ms": 0.0441809832039526}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 21240, "num_agent_steps_trained": 21240, "num_env_steps_sampled": 21240, "num_env_steps_trained": 21240, "num_env_steps_sampled_this_iter": 1800, "num_env_steps_trained_this_iter": 1800, "num_env_steps_sampled_throughput_per_sec": 161.41528875040586, "num_env_steps_trained_throughput_per_sec": 161.41528875040586, "timesteps_total": 21240, "num_steps_trained_this_iter": 1800, "agent_timesteps_total": 21240, "timers": {"training_iteration_time_ms": 2235.861, "sample_time_ms": 2228.785, "load_time_ms": 0.217, "load_throughput": 1662573.706, "learn_time_ms": 6.304, "learn_throughput": 57106.151, "synch_weights_time_ms": 0.525}, "counters": {"num_env_steps_sampled": 21240, "num_env_steps_trained": 21240, "num_agent_steps_sampled": 21240, "num_agent_steps_trained": 21240}, "done": false, "episodes_total": 59, "training_iteration": 12, "trial_id": "f5e97_00000", "date": "2023-07-25_16-58-07", "timestamp": 1690293487, "time_this_iter_s": 11.153310775756836, "time_total_s": 133.60986948013306, "pid": 71917, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[0, 0.003], [5400, 0.001], [10800, 0.00075], [16200, 0.0005], [21600, 0.00025], [27000, 0.0001], [32400, 7.5e-05], [37800, 5e-05], [43200, 2.5e-05], [48600, 1e-05], [54000, 7.5e-06], [59400, 5e-06], [64800, 2.5e-06], [70200, 1e-06], [75600, 5e-07], [81000, 1e-07]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x304530310>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 133.60986948013306, "iterations_since_restore": 12, "perf": {"cpu_util_percent": 27.387500000000003, "ram_util_percent": 77.925}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 0.00022, "entropy_coeff": 0.1, "policy_entropy": -926.6711669921875, "policy_loss": -1.2317004096182124e+18, "vf_loss": 1110722726.4}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 318.0, "diff_num_grad_updates_vs_sampler_policy": 317.0}}, "num_env_steps_sampled": 23040, "num_env_steps_trained": 23040, "num_agent_steps_sampled": 23040, "num_agent_steps_trained": 23040}, "sampler_results": {"episode_reward_max": -2422.3370447059615, "episode_reward_min": -26099.42399150872, "episode_reward_mean": -24734.648526369856, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-6436.033434161671, -6043.969601759489, -2422.3370447059615, -24990.34634919007, -25452.837867188566, -25310.57312518208, -25686.93441898636, -25733.06477177539, -25632.540837596986, -25741.25838094305, -25682.951867265267, -25875.54927130328, -25791.41113474669, -25876.087019490118, -25758.293694585434, -25634.18668867263, -25774.040714141163, -25322.081785864284, -25728.39902520237, -26006.438038763314, -25689.929666468986, -26046.034745217887, -25784.412419518667, -25842.835463957334, -25734.83061046133, -25844.28041359334, -25635.44875060622, -25803.193126233928, -25663.826963650325, -25802.505894538343, -25696.01838045785, -25481.06001408537, -26099.42399150872, -25669.070720236832, -25574.459522488956, -25661.384923105496, -25628.895882615365, -25692.711051277838, -25530.484442847315, -25739.569920149836, -25575.22608879392, -25806.46826871708, -26030.406526650026, -25762.396464165115, -25472.808615743124, -25512.665211606723, -25694.924278548217, -25700.022311652854, -25610.877586351526, -25766.714040352563, -25633.132008411972, -25910.175594312626, -25714.65018026558, -25792.327418101308, -25778.692984522557, -26007.63610235267, -25675.403200363275, -25552.72024906665, -25629.20175874157, -25809.535388943135, -25818.56046598507, -25878.391237373035, -25570.150043400514, -25794.707688705443], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.408919949898646, "mean_inference_ms": 0.24766626440458878, "mean_action_processing_ms": 0.05894230511722133, "mean_env_wait_ms": 1.7027904730904981, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0024672597646713257, "StateBufferConnector_ms": 0.0018052756786346436, "ViewRequirementAgentConnector_ms": 0.044118985533714294}}, "episode_reward_max": -2422.3370447059615, "episode_reward_min": -26099.42399150872, "episode_reward_mean": -24734.648526369856, "episode_len_mean": 360.0, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-6436.033434161671, -6043.969601759489, -2422.3370447059615, -24990.34634919007, -25452.837867188566, -25310.57312518208, -25686.93441898636, -25733.06477177539, -25632.540837596986, -25741.25838094305, -25682.951867265267, -25875.54927130328, -25791.41113474669, -25876.087019490118, -25758.293694585434, -25634.18668867263, -25774.040714141163, -25322.081785864284, -25728.39902520237, -26006.438038763314, -25689.929666468986, -26046.034745217887, -25784.412419518667, -25842.835463957334, -25734.83061046133, -25844.28041359334, -25635.44875060622, -25803.193126233928, -25663.826963650325, -25802.505894538343, -25696.01838045785, -25481.06001408537, -26099.42399150872, -25669.070720236832, -25574.459522488956, -25661.384923105496, -25628.895882615365, -25692.711051277838, -25530.484442847315, -25739.569920149836, -25575.22608879392, -25806.46826871708, -26030.406526650026, -25762.396464165115, -25472.808615743124, -25512.665211606723, -25694.924278548217, -25700.022311652854, -25610.877586351526, -25766.714040352563, -25633.132008411972, -25910.175594312626, -25714.65018026558, -25792.327418101308, -25778.692984522557, -26007.63610235267, -25675.403200363275, -25552.72024906665, -25629.20175874157, -25809.535388943135, -25818.56046598507, -25878.391237373035, -25570.150043400514, -25794.707688705443], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.408919949898646, "mean_inference_ms": 0.24766626440458878, "mean_action_processing_ms": 0.05894230511722133, "mean_env_wait_ms": 1.7027904730904981, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0024672597646713257, "StateBufferConnector_ms": 0.0018052756786346436, "ViewRequirementAgentConnector_ms": 0.044118985533714294}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 23040, "num_agent_steps_trained": 23040, "num_env_steps_sampled": 23040, "num_env_steps_trained": 23040, "num_env_steps_sampled_this_iter": 1800, "num_env_steps_trained_this_iter": 1800, "num_env_steps_sampled_throughput_per_sec": 163.42719029423853, "num_env_steps_trained_throughput_per_sec": 163.42719029423853, "timesteps_total": 23040, "num_steps_trained_this_iter": 1800, "agent_timesteps_total": 23040, "timers": {"training_iteration_time_ms": 2216.534, "sample_time_ms": 2209.436, "load_time_ms": 0.215, "load_throughput": 1675487.617, "learn_time_ms": 6.325, "learn_throughput": 56914.792, "synch_weights_time_ms": 0.527}, "counters": {"num_env_steps_sampled": 23040, "num_env_steps_trained": 23040, "num_agent_steps_sampled": 23040, "num_agent_steps_trained": 23040}, "done": false, "episodes_total": 64, "training_iteration": 13, "trial_id": "f5e97_00000", "date": "2023-07-25_16-58-18", "timestamp": 1690293498, "time_this_iter_s": 11.016224145889282, "time_total_s": 144.62609362602234, "pid": 71917, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[0, 0.003], [5400, 0.001], [10800, 0.00075], [16200, 0.0005], [21600, 0.00025], [27000, 0.0001], [32400, 7.5e-05], [37800, 5e-05], [43200, 2.5e-05], [48600, 1e-05], [54000, 7.5e-06], [59400, 5e-06], [64800, 2.5e-06], [70200, 1e-06], [75600, 5e-07], [81000, 1e-07]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x304530310>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 144.62609362602234, "iterations_since_restore": 13, "perf": {"cpu_util_percent": 25.826666666666664, "ram_util_percent": 77.85333333333331}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 0.00017, "entropy_coeff": 0.1, "policy_entropy": -926.671484375, "policy_loss": -2.001619506400292e+19, "vf_loss": 1079174272.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 343.0, "diff_num_grad_updates_vs_sampler_policy": 342.0}}, "num_env_steps_sampled": 24840, "num_env_steps_trained": 24840, "num_agent_steps_sampled": 24840, "num_agent_steps_trained": 24840}, "sampler_results": {"episode_reward_max": -2422.3370447059615, "episode_reward_min": -26099.42399150872, "episode_reward_mean": -24808.940162542625, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-6436.033434161671, -6043.969601759489, -2422.3370447059615, -24990.34634919007, -25452.837867188566, -25310.57312518208, -25686.93441898636, -25733.06477177539, -25632.540837596986, -25741.25838094305, -25682.951867265267, -25875.54927130328, -25791.41113474669, -25876.087019490118, -25758.293694585434, -25634.18668867263, -25774.040714141163, -25322.081785864284, -25728.39902520237, -26006.438038763314, -25689.929666468986, -26046.034745217887, -25784.412419518667, -25842.835463957334, -25734.83061046133, -25844.28041359334, -25635.44875060622, -25803.193126233928, -25663.826963650325, -25802.505894538343, -25696.01838045785, -25481.06001408537, -26099.42399150872, -25669.070720236832, -25574.459522488956, -25661.384923105496, -25628.895882615365, -25692.711051277838, -25530.484442847315, -25739.569920149836, -25575.22608879392, -25806.46826871708, -26030.406526650026, -25762.396464165115, -25472.808615743124, -25512.665211606723, -25694.924278548217, -25700.022311652854, -25610.877586351526, -25766.714040352563, -25633.132008411972, -25910.175594312626, -25714.65018026558, -25792.327418101308, -25778.692984522557, -26007.63610235267, -25675.403200363275, -25552.72024906665, -25629.20175874157, -25809.535388943135, -25818.56046598507, -25878.391237373035, -25570.150043400514, -25794.707688705443, -25857.340110996713, -25560.244690377833, -25892.030930636447, -25948.775583705134, -25540.974212054138], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.408657315693264, "mean_inference_ms": 0.24751472243225817, "mean_action_processing_ms": 0.05891470010435884, "mean_env_wait_ms": 1.6892602424850114, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0024757523467575293, "StateBufferConnector_ms": 0.001803688381029212, "ViewRequirementAgentConnector_ms": 0.044062172157177025}}, "episode_reward_max": -2422.3370447059615, "episode_reward_min": -26099.42399150872, "episode_reward_mean": -24808.940162542625, "episode_len_mean": 360.0, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-6436.033434161671, -6043.969601759489, -2422.3370447059615, -24990.34634919007, -25452.837867188566, -25310.57312518208, -25686.93441898636, -25733.06477177539, -25632.540837596986, -25741.25838094305, -25682.951867265267, -25875.54927130328, -25791.41113474669, -25876.087019490118, -25758.293694585434, -25634.18668867263, -25774.040714141163, -25322.081785864284, -25728.39902520237, -26006.438038763314, -25689.929666468986, -26046.034745217887, -25784.412419518667, -25842.835463957334, -25734.83061046133, -25844.28041359334, -25635.44875060622, -25803.193126233928, -25663.826963650325, -25802.505894538343, -25696.01838045785, -25481.06001408537, -26099.42399150872, -25669.070720236832, -25574.459522488956, -25661.384923105496, -25628.895882615365, -25692.711051277838, -25530.484442847315, -25739.569920149836, -25575.22608879392, -25806.46826871708, -26030.406526650026, -25762.396464165115, -25472.808615743124, -25512.665211606723, -25694.924278548217, -25700.022311652854, -25610.877586351526, -25766.714040352563, -25633.132008411972, -25910.175594312626, -25714.65018026558, -25792.327418101308, -25778.692984522557, -26007.63610235267, -25675.403200363275, -25552.72024906665, -25629.20175874157, -25809.535388943135, -25818.56046598507, -25878.391237373035, -25570.150043400514, -25794.707688705443, -25857.340110996713, -25560.244690377833, -25892.030930636447, -25948.775583705134, -25540.974212054138], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.408657315693264, "mean_inference_ms": 0.24751472243225817, "mean_action_processing_ms": 0.05891470010435884, "mean_env_wait_ms": 1.6892602424850114, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0024757523467575293, "StateBufferConnector_ms": 0.001803688381029212, "ViewRequirementAgentConnector_ms": 0.044062172157177025}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 24840, "num_agent_steps_trained": 24840, "num_env_steps_sampled": 24840, "num_env_steps_trained": 24840, "num_env_steps_sampled_this_iter": 1800, "num_env_steps_trained_this_iter": 1800, "num_env_steps_sampled_throughput_per_sec": 162.75070402815012, "num_env_steps_trained_throughput_per_sec": 162.75070402815012, "timesteps_total": 24840, "num_steps_trained_this_iter": 1800, "agent_timesteps_total": 24840, "timers": {"training_iteration_time_ms": 2207.384, "sample_time_ms": 2200.285, "load_time_ms": 0.213, "load_throughput": 1688226.118, "learn_time_ms": 6.333, "learn_throughput": 56843.015, "synch_weights_time_ms": 0.521}, "counters": {"num_env_steps_sampled": 24840, "num_env_steps_trained": 24840, "num_agent_steps_sampled": 24840, "num_agent_steps_trained": 24840}, "done": false, "episodes_total": 69, "training_iteration": 14, "trial_id": "f5e97_00000", "date": "2023-07-25_16-58-29", "timestamp": 1690293509, "time_this_iter_s": 11.061883926391602, "time_total_s": 155.68797755241394, "pid": 71917, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[0, 0.003], [5400, 0.001], [10800, 0.00075], [16200, 0.0005], [21600, 0.00025], [27000, 0.0001], [32400, 7.5e-05], [37800, 5e-05], [43200, 2.5e-05], [48600, 1e-05], [54000, 7.5e-06], [59400, 5e-06], [64800, 2.5e-06], [70200, 1e-06], [75600, 5e-07], [81000, 1e-07]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x304530310>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 155.68797755241394, "iterations_since_restore": 14, "perf": {"cpu_util_percent": 25.50625, "ram_util_percent": 77.69375}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 0.00011999999999999999, "entropy_coeff": 0.1, "policy_entropy": -926.6856323242188, "policy_loss": -1.0359520626221566e+19, "vf_loss": 1097130048.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 368.0, "diff_num_grad_updates_vs_sampler_policy": 367.0}}, "num_env_steps_sampled": 26640, "num_env_steps_trained": 26640, "num_agent_steps_sampled": 26640, "num_agent_steps_trained": 26640}, "sampler_results": {"episode_reward_max": -2422.3370447059615, "episode_reward_min": -26099.42399150872, "episode_reward_mean": -24867.582369833894, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-6436.033434161671, -6043.969601759489, -2422.3370447059615, -24990.34634919007, -25452.837867188566, -25310.57312518208, -25686.93441898636, -25733.06477177539, -25632.540837596986, -25741.25838094305, -25682.951867265267, -25875.54927130328, -25791.41113474669, -25876.087019490118, -25758.293694585434, -25634.18668867263, -25774.040714141163, -25322.081785864284, -25728.39902520237, -26006.438038763314, -25689.929666468986, -26046.034745217887, -25784.412419518667, -25842.835463957334, -25734.83061046133, -25844.28041359334, -25635.44875060622, -25803.193126233928, -25663.826963650325, -25802.505894538343, -25696.01838045785, -25481.06001408537, -26099.42399150872, -25669.070720236832, -25574.459522488956, -25661.384923105496, -25628.895882615365, -25692.711051277838, -25530.484442847315, -25739.569920149836, -25575.22608879392, -25806.46826871708, -26030.406526650026, -25762.396464165115, -25472.808615743124, -25512.665211606723, -25694.924278548217, -25700.022311652854, -25610.877586351526, -25766.714040352563, -25633.132008411972, -25910.175594312626, -25714.65018026558, -25792.327418101308, -25778.692984522557, -26007.63610235267, -25675.403200363275, -25552.72024906665, -25629.20175874157, -25809.535388943135, -25818.56046598507, -25878.391237373035, -25570.150043400514, -25794.707688705443, -25857.340110996713, -25560.244690377833, -25892.030930636447, -25948.775583705134, -25540.974212054138, -25702.090137226263, -25690.626525256663, -25693.172602679162, -25607.345925140522, -25690.98896196435], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.4085425329396, "mean_inference_ms": 0.24737250387597887, "mean_action_processing_ms": 0.058888408922976074, "mean_env_wait_ms": 1.677104183398879, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002459577611974768, "StateBufferConnector_ms": 0.0018036043321764147, "ViewRequirementAgentConnector_ms": 0.0441512546023807}}, "episode_reward_max": -2422.3370447059615, "episode_reward_min": -26099.42399150872, "episode_reward_mean": -24867.582369833894, "episode_len_mean": 360.0, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-6436.033434161671, -6043.969601759489, -2422.3370447059615, -24990.34634919007, -25452.837867188566, -25310.57312518208, -25686.93441898636, -25733.06477177539, -25632.540837596986, -25741.25838094305, -25682.951867265267, -25875.54927130328, -25791.41113474669, -25876.087019490118, -25758.293694585434, -25634.18668867263, -25774.040714141163, -25322.081785864284, -25728.39902520237, -26006.438038763314, -25689.929666468986, -26046.034745217887, -25784.412419518667, -25842.835463957334, -25734.83061046133, -25844.28041359334, -25635.44875060622, -25803.193126233928, -25663.826963650325, -25802.505894538343, -25696.01838045785, -25481.06001408537, -26099.42399150872, -25669.070720236832, -25574.459522488956, -25661.384923105496, -25628.895882615365, -25692.711051277838, -25530.484442847315, -25739.569920149836, -25575.22608879392, -25806.46826871708, -26030.406526650026, -25762.396464165115, -25472.808615743124, -25512.665211606723, -25694.924278548217, -25700.022311652854, -25610.877586351526, -25766.714040352563, -25633.132008411972, -25910.175594312626, -25714.65018026558, -25792.327418101308, -25778.692984522557, -26007.63610235267, -25675.403200363275, -25552.72024906665, -25629.20175874157, -25809.535388943135, -25818.56046598507, -25878.391237373035, -25570.150043400514, -25794.707688705443, -25857.340110996713, -25560.244690377833, -25892.030930636447, -25948.775583705134, -25540.974212054138, -25702.090137226263, -25690.626525256663, -25693.172602679162, -25607.345925140522, -25690.98896196435], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.4085425329396, "mean_inference_ms": 0.24737250387597887, "mean_action_processing_ms": 0.058888408922976074, "mean_env_wait_ms": 1.677104183398879, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002459577611974768, "StateBufferConnector_ms": 0.0018036043321764147, "ViewRequirementAgentConnector_ms": 0.0441512546023807}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 26640, "num_agent_steps_trained": 26640, "num_env_steps_sampled": 26640, "num_env_steps_trained": 26640, "num_env_steps_sampled_this_iter": 1800, "num_env_steps_trained_this_iter": 1800, "num_env_steps_sampled_throughput_per_sec": 161.63067562642976, "num_env_steps_trained_throughput_per_sec": 161.63067562642976, "timesteps_total": 26640, "num_steps_trained_this_iter": 1800, "agent_timesteps_total": 26640, "timers": {"training_iteration_time_ms": 2219.626, "sample_time_ms": 2212.555, "load_time_ms": 0.215, "load_throughput": 1673816.029, "learn_time_ms": 6.302, "learn_throughput": 57123.866, "synch_weights_time_ms": 0.522}, "counters": {"num_env_steps_sampled": 26640, "num_env_steps_trained": 26640, "num_agent_steps_sampled": 26640, "num_agent_steps_trained": 26640}, "done": false, "episodes_total": 74, "training_iteration": 15, "trial_id": "f5e97_00000", "date": "2023-07-25_16-58-40", "timestamp": 1690293520, "time_this_iter_s": 11.138550996780396, "time_total_s": 166.82652854919434, "pid": 71917, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[0, 0.003], [5400, 0.001], [10800, 0.00075], [16200, 0.0005], [21600, 0.00025], [27000, 0.0001], [32400, 7.5e-05], [37800, 5e-05], [43200, 2.5e-05], [48600, 1e-05], [54000, 7.5e-06], [59400, 5e-06], [64800, 2.5e-06], [70200, 1e-06], [75600, 5e-07], [81000, 1e-07]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x304530310>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 166.82652854919434, "iterations_since_restore": 15, "perf": {"cpu_util_percent": 28.7, "ram_util_percent": 77.89375000000001}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 9.5e-05, "entropy_coeff": 0.1, "policy_entropy": -926.687841796875, "policy_loss": -3.109499168589152e+17, "vf_loss": 1095452864.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 393.0, "diff_num_grad_updates_vs_sampler_policy": 392.0}}, "num_env_steps_sampled": 28440, "num_env_steps_trained": 28440, "num_agent_steps_sampled": 28440, "num_agent_steps_trained": 28440}, "sampler_results": {"episode_reward_max": -2422.3370447059615, "episode_reward_min": -26099.42399150872, "episode_reward_mean": -24922.638899443828, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-6436.033434161671, -6043.969601759489, -2422.3370447059615, -24990.34634919007, -25452.837867188566, -25310.57312518208, -25686.93441898636, -25733.06477177539, -25632.540837596986, -25741.25838094305, -25682.951867265267, -25875.54927130328, -25791.41113474669, -25876.087019490118, -25758.293694585434, -25634.18668867263, -25774.040714141163, -25322.081785864284, -25728.39902520237, -26006.438038763314, -25689.929666468986, -26046.034745217887, -25784.412419518667, -25842.835463957334, -25734.83061046133, -25844.28041359334, -25635.44875060622, -25803.193126233928, -25663.826963650325, -25802.505894538343, -25696.01838045785, -25481.06001408537, -26099.42399150872, -25669.070720236832, -25574.459522488956, -25661.384923105496, -25628.895882615365, -25692.711051277838, -25530.484442847315, -25739.569920149836, -25575.22608879392, -25806.46826871708, -26030.406526650026, -25762.396464165115, -25472.808615743124, -25512.665211606723, -25694.924278548217, -25700.022311652854, -25610.877586351526, -25766.714040352563, -25633.132008411972, -25910.175594312626, -25714.65018026558, -25792.327418101308, -25778.692984522557, -26007.63610235267, -25675.403200363275, -25552.72024906665, -25629.20175874157, -25809.535388943135, -25818.56046598507, -25878.391237373035, -25570.150043400514, -25794.707688705443, -25857.340110996713, -25560.244690377833, -25892.030930636447, -25948.775583705134, -25540.974212054138, -25702.090137226263, -25690.626525256663, -25693.172602679162, -25607.345925140522, -25690.98896196435, -25803.890518293992, -25734.94249507384, -25744.72705686407, -25770.29113828817, -25633.526479834145], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.4084911526831, "mean_inference_ms": 0.2472441775909988, "mean_action_processing_ms": 0.058864989764768776, "mean_env_wait_ms": 1.6661551532427035, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0024330766895149327, "StateBufferConnector_ms": 0.0017987021917029273, "ViewRequirementAgentConnector_ms": 0.0440854060498974}}, "episode_reward_max": -2422.3370447059615, "episode_reward_min": -26099.42399150872, "episode_reward_mean": -24922.638899443828, "episode_len_mean": 360.0, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-6436.033434161671, -6043.969601759489, -2422.3370447059615, -24990.34634919007, -25452.837867188566, -25310.57312518208, -25686.93441898636, -25733.06477177539, -25632.540837596986, -25741.25838094305, -25682.951867265267, -25875.54927130328, -25791.41113474669, -25876.087019490118, -25758.293694585434, -25634.18668867263, -25774.040714141163, -25322.081785864284, -25728.39902520237, -26006.438038763314, -25689.929666468986, -26046.034745217887, -25784.412419518667, -25842.835463957334, -25734.83061046133, -25844.28041359334, -25635.44875060622, -25803.193126233928, -25663.826963650325, -25802.505894538343, -25696.01838045785, -25481.06001408537, -26099.42399150872, -25669.070720236832, -25574.459522488956, -25661.384923105496, -25628.895882615365, -25692.711051277838, -25530.484442847315, -25739.569920149836, -25575.22608879392, -25806.46826871708, -26030.406526650026, -25762.396464165115, -25472.808615743124, -25512.665211606723, -25694.924278548217, -25700.022311652854, -25610.877586351526, -25766.714040352563, -25633.132008411972, -25910.175594312626, -25714.65018026558, -25792.327418101308, -25778.692984522557, -26007.63610235267, -25675.403200363275, -25552.72024906665, -25629.20175874157, -25809.535388943135, -25818.56046598507, -25878.391237373035, -25570.150043400514, -25794.707688705443, -25857.340110996713, -25560.244690377833, -25892.030930636447, -25948.775583705134, -25540.974212054138, -25702.090137226263, -25690.626525256663, -25693.172602679162, -25607.345925140522, -25690.98896196435, -25803.890518293992, -25734.94249507384, -25744.72705686407, -25770.29113828817, -25633.526479834145], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.4084911526831, "mean_inference_ms": 0.2472441775909988, "mean_action_processing_ms": 0.058864989764768776, "mean_env_wait_ms": 1.6661551532427035, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0024330766895149327, "StateBufferConnector_ms": 0.0017987021917029273, "ViewRequirementAgentConnector_ms": 0.0440854060498974}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 28440, "num_agent_steps_trained": 28440, "num_env_steps_sampled": 28440, "num_env_steps_trained": 28440, "num_env_steps_sampled_this_iter": 1800, "num_env_steps_trained_this_iter": 1800, "num_env_steps_sampled_throughput_per_sec": 161.56428915035502, "num_env_steps_trained_throughput_per_sec": 161.56428915035502, "timesteps_total": 28440, "num_steps_trained_this_iter": 1800, "agent_timesteps_total": 28440, "timers": {"training_iteration_time_ms": 2227.747, "sample_time_ms": 2220.383, "load_time_ms": 0.215, "load_throughput": 1670852.54, "learn_time_ms": 6.54, "learn_throughput": 55045.968, "synch_weights_time_ms": 0.576}, "counters": {"num_env_steps_sampled": 28440, "num_env_steps_trained": 28440, "num_agent_steps_sampled": 28440, "num_agent_steps_trained": 28440}, "done": false, "episodes_total": 79, "training_iteration": 16, "trial_id": "f5e97_00000", "date": "2023-07-25_16-58-51", "timestamp": 1690293531, "time_this_iter_s": 11.143089056015015, "time_total_s": 177.96961760520935, "pid": 71917, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[0, 0.003], [5400, 0.001], [10800, 0.00075], [16200, 0.0005], [21600, 0.00025], [27000, 0.0001], [32400, 7.5e-05], [37800, 5e-05], [43200, 2.5e-05], [48600, 1e-05], [54000, 7.5e-06], [59400, 5e-06], [64800, 2.5e-06], [70200, 1e-06], [75600, 5e-07], [81000, 1e-07]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x304530310>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 177.96961760520935, "iterations_since_restore": 16, "perf": {"cpu_util_percent": 25.88125, "ram_util_percent": 78.08125}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 8.666666666666667e-05, "entropy_coeff": 0.1, "policy_entropy": -926.6878295898438, "policy_loss": -7.841586087414726e+17, "vf_loss": 1088499302.4}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 418.0, "diff_num_grad_updates_vs_sampler_policy": 417.0}}, "num_env_steps_sampled": 30240, "num_env_steps_trained": 30240, "num_agent_steps_sampled": 30240, "num_agent_steps_trained": 30240}, "sampler_results": {"episode_reward_max": -2422.3370447059615, "episode_reward_min": -26099.42399150872, "episode_reward_mean": -24972.74085193904, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-6436.033434161671, -6043.969601759489, -2422.3370447059615, -24990.34634919007, -25452.837867188566, -25310.57312518208, -25686.93441898636, -25733.06477177539, -25632.540837596986, -25741.25838094305, -25682.951867265267, -25875.54927130328, -25791.41113474669, -25876.087019490118, -25758.293694585434, -25634.18668867263, -25774.040714141163, -25322.081785864284, -25728.39902520237, -26006.438038763314, -25689.929666468986, -26046.034745217887, -25784.412419518667, -25842.835463957334, -25734.83061046133, -25844.28041359334, -25635.44875060622, -25803.193126233928, -25663.826963650325, -25802.505894538343, -25696.01838045785, -25481.06001408537, -26099.42399150872, -25669.070720236832, -25574.459522488956, -25661.384923105496, -25628.895882615365, -25692.711051277838, -25530.484442847315, -25739.569920149836, -25575.22608879392, -25806.46826871708, -26030.406526650026, -25762.396464165115, -25472.808615743124, -25512.665211606723, -25694.924278548217, -25700.022311652854, -25610.877586351526, -25766.714040352563, -25633.132008411972, -25910.175594312626, -25714.65018026558, -25792.327418101308, -25778.692984522557, -26007.63610235267, -25675.403200363275, -25552.72024906665, -25629.20175874157, -25809.535388943135, -25818.56046598507, -25878.391237373035, -25570.150043400514, -25794.707688705443, -25857.340110996713, -25560.244690377833, -25892.030930636447, -25948.775583705134, -25540.974212054138, -25702.090137226263, -25690.626525256663, -25693.172602679162, -25607.345925140522, -25690.98896196435, -25803.890518293992, -25734.94249507384, -25744.72705686407, -25770.29113828817, -25633.526479834145, -25763.380903443955, -25994.644736679224, -25562.739129391666, -25809.002674179115, -25691.99106312291], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.408357415842433, "mean_inference_ms": 0.24714551864385234, "mean_action_processing_ms": 0.05884600765087736, "mean_env_wait_ms": 1.6563175679802886, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002490906488327753, "StateBufferConnector_ms": 0.0018395128704252698, "ViewRequirementAgentConnector_ms": 0.045151653743925546}}, "episode_reward_max": -2422.3370447059615, "episode_reward_min": -26099.42399150872, "episode_reward_mean": -24972.74085193904, "episode_len_mean": 360.0, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-6436.033434161671, -6043.969601759489, -2422.3370447059615, -24990.34634919007, -25452.837867188566, -25310.57312518208, -25686.93441898636, -25733.06477177539, -25632.540837596986, -25741.25838094305, -25682.951867265267, -25875.54927130328, -25791.41113474669, -25876.087019490118, -25758.293694585434, -25634.18668867263, -25774.040714141163, -25322.081785864284, -25728.39902520237, -26006.438038763314, -25689.929666468986, -26046.034745217887, -25784.412419518667, -25842.835463957334, -25734.83061046133, -25844.28041359334, -25635.44875060622, -25803.193126233928, -25663.826963650325, -25802.505894538343, -25696.01838045785, -25481.06001408537, -26099.42399150872, -25669.070720236832, -25574.459522488956, -25661.384923105496, -25628.895882615365, -25692.711051277838, -25530.484442847315, -25739.569920149836, -25575.22608879392, -25806.46826871708, -26030.406526650026, -25762.396464165115, -25472.808615743124, -25512.665211606723, -25694.924278548217, -25700.022311652854, -25610.877586351526, -25766.714040352563, -25633.132008411972, -25910.175594312626, -25714.65018026558, -25792.327418101308, -25778.692984522557, -26007.63610235267, -25675.403200363275, -25552.72024906665, -25629.20175874157, -25809.535388943135, -25818.56046598507, -25878.391237373035, -25570.150043400514, -25794.707688705443, -25857.340110996713, -25560.244690377833, -25892.030930636447, -25948.775583705134, -25540.974212054138, -25702.090137226263, -25690.626525256663, -25693.172602679162, -25607.345925140522, -25690.98896196435, -25803.890518293992, -25734.94249507384, -25744.72705686407, -25770.29113828817, -25633.526479834145, -25763.380903443955, -25994.644736679224, -25562.739129391666, -25809.002674179115, -25691.99106312291], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.408357415842433, "mean_inference_ms": 0.24714551864385234, "mean_action_processing_ms": 0.05884600765087736, "mean_env_wait_ms": 1.6563175679802886, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002490906488327753, "StateBufferConnector_ms": 0.0018395128704252698, "ViewRequirementAgentConnector_ms": 0.045151653743925546}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 30240, "num_agent_steps_trained": 30240, "num_env_steps_sampled": 30240, "num_env_steps_trained": 30240, "num_env_steps_sampled_this_iter": 1800, "num_env_steps_trained_this_iter": 1800, "num_env_steps_sampled_throughput_per_sec": 161.71756920801235, "num_env_steps_trained_throughput_per_sec": 161.71756920801235, "timesteps_total": 30240, "num_steps_trained_this_iter": 1800, "agent_timesteps_total": 30240, "timers": {"training_iteration_time_ms": 2227.148, "sample_time_ms": 2219.571, "load_time_ms": 0.216, "load_throughput": 1664222.903, "learn_time_ms": 6.738, "learn_throughput": 53431.38, "synch_weights_time_ms": 0.589}, "counters": {"num_env_steps_sampled": 30240, "num_env_steps_trained": 30240, "num_agent_steps_sampled": 30240, "num_agent_steps_trained": 30240}, "done": false, "episodes_total": 84, "training_iteration": 17, "trial_id": "f5e97_00000", "date": "2023-07-25_16-59-02", "timestamp": 1690293542, "time_this_iter_s": 11.133020877838135, "time_total_s": 189.10263848304749, "pid": 71917, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[0, 0.003], [5400, 0.001], [10800, 0.00075], [16200, 0.0005], [21600, 0.00025], [27000, 0.0001], [32400, 7.5e-05], [37800, 5e-05], [43200, 2.5e-05], [48600, 1e-05], [54000, 7.5e-06], [59400, 5e-06], [64800, 2.5e-06], [70200, 1e-06], [75600, 5e-07], [81000, 1e-07]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x304530310>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 189.10263848304749, "iterations_since_restore": 17, "perf": {"cpu_util_percent": 26.193333333333335, "ram_util_percent": 77.88000000000001}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 7.833333333333333e-05, "entropy_coeff": 0.1, "policy_entropy": -926.6877197265625, "policy_loss": -1.8024760307844751e+18, "vf_loss": 1090915475.2}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 443.0, "diff_num_grad_updates_vs_sampler_policy": 442.0}}, "num_env_steps_sampled": 32040, "num_env_steps_trained": 32040, "num_agent_steps_sampled": 32040, "num_agent_steps_trained": 32040}, "sampler_results": {"episode_reward_max": -2422.3370447059615, "episode_reward_min": -26099.42399150872, "episode_reward_mean": -25017.301581329204, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-6436.033434161671, -6043.969601759489, -2422.3370447059615, -24990.34634919007, -25452.837867188566, -25310.57312518208, -25686.93441898636, -25733.06477177539, -25632.540837596986, -25741.25838094305, -25682.951867265267, -25875.54927130328, -25791.41113474669, -25876.087019490118, -25758.293694585434, -25634.18668867263, -25774.040714141163, -25322.081785864284, -25728.39902520237, -26006.438038763314, -25689.929666468986, -26046.034745217887, -25784.412419518667, -25842.835463957334, -25734.83061046133, -25844.28041359334, -25635.44875060622, -25803.193126233928, -25663.826963650325, -25802.505894538343, -25696.01838045785, -25481.06001408537, -26099.42399150872, -25669.070720236832, -25574.459522488956, -25661.384923105496, -25628.895882615365, -25692.711051277838, -25530.484442847315, -25739.569920149836, -25575.22608879392, -25806.46826871708, -26030.406526650026, -25762.396464165115, -25472.808615743124, -25512.665211606723, -25694.924278548217, -25700.022311652854, -25610.877586351526, -25766.714040352563, -25633.132008411972, -25910.175594312626, -25714.65018026558, -25792.327418101308, -25778.692984522557, -26007.63610235267, -25675.403200363275, -25552.72024906665, -25629.20175874157, -25809.535388943135, -25818.56046598507, -25878.391237373035, -25570.150043400514, -25794.707688705443, -25857.340110996713, -25560.244690377833, -25892.030930636447, -25948.775583705134, -25540.974212054138, -25702.090137226263, -25690.626525256663, -25693.172602679162, -25607.345925140522, -25690.98896196435, -25803.890518293992, -25734.94249507384, -25744.72705686407, -25770.29113828817, -25633.526479834145, -25763.380903443955, -25994.644736679224, -25562.739129391666, -25809.002674179115, -25691.99106312291, -25536.953614818452, -26089.458519239386, -25728.991995568085, -25743.012710942498, -25731.19233485226], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.4083103431940796, "mean_inference_ms": 0.24706074725497712, "mean_action_processing_ms": 0.058828945920671304, "mean_env_wait_ms": 1.6474322726176944, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0025092885735329617, "StateBufferConnector_ms": 0.0018363588311699, "ViewRequirementAgentConnector_ms": 0.04534480277072178}}, "episode_reward_max": -2422.3370447059615, "episode_reward_min": -26099.42399150872, "episode_reward_mean": -25017.301581329204, "episode_len_mean": 360.0, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-6436.033434161671, -6043.969601759489, -2422.3370447059615, -24990.34634919007, -25452.837867188566, -25310.57312518208, -25686.93441898636, -25733.06477177539, -25632.540837596986, -25741.25838094305, -25682.951867265267, -25875.54927130328, -25791.41113474669, -25876.087019490118, -25758.293694585434, -25634.18668867263, -25774.040714141163, -25322.081785864284, -25728.39902520237, -26006.438038763314, -25689.929666468986, -26046.034745217887, -25784.412419518667, -25842.835463957334, -25734.83061046133, -25844.28041359334, -25635.44875060622, -25803.193126233928, -25663.826963650325, -25802.505894538343, -25696.01838045785, -25481.06001408537, -26099.42399150872, -25669.070720236832, -25574.459522488956, -25661.384923105496, -25628.895882615365, -25692.711051277838, -25530.484442847315, -25739.569920149836, -25575.22608879392, -25806.46826871708, -26030.406526650026, -25762.396464165115, -25472.808615743124, -25512.665211606723, -25694.924278548217, -25700.022311652854, -25610.877586351526, -25766.714040352563, -25633.132008411972, -25910.175594312626, -25714.65018026558, -25792.327418101308, -25778.692984522557, -26007.63610235267, -25675.403200363275, -25552.72024906665, -25629.20175874157, -25809.535388943135, -25818.56046598507, -25878.391237373035, -25570.150043400514, -25794.707688705443, -25857.340110996713, -25560.244690377833, -25892.030930636447, -25948.775583705134, -25540.974212054138, -25702.090137226263, -25690.626525256663, -25693.172602679162, -25607.345925140522, -25690.98896196435, -25803.890518293992, -25734.94249507384, -25744.72705686407, -25770.29113828817, -25633.526479834145, -25763.380903443955, -25994.644736679224, -25562.739129391666, -25809.002674179115, -25691.99106312291, -25536.953614818452, -26089.458519239386, -25728.991995568085, -25743.012710942498, -25731.19233485226], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.4083103431940796, "mean_inference_ms": 0.24706074725497712, "mean_action_processing_ms": 0.058828945920671304, "mean_env_wait_ms": 1.6474322726176944, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0025092885735329617, "StateBufferConnector_ms": 0.0018363588311699, "ViewRequirementAgentConnector_ms": 0.04534480277072178}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 32040, "num_agent_steps_trained": 32040, "num_env_steps_sampled": 32040, "num_env_steps_trained": 32040, "num_env_steps_sampled_this_iter": 1800, "num_env_steps_trained_this_iter": 1800, "num_env_steps_sampled_throughput_per_sec": 160.61535056346284, "num_env_steps_trained_throughput_per_sec": 160.61535056346284, "timesteps_total": 32040, "num_steps_trained_this_iter": 1800, "agent_timesteps_total": 32040, "timers": {"training_iteration_time_ms": 2233.731, "sample_time_ms": 2226.402, "load_time_ms": 0.215, "load_throughput": 1675115.864, "learn_time_ms": 6.547, "learn_throughput": 54985.432, "synch_weights_time_ms": 0.533}, "counters": {"num_env_steps_sampled": 32040, "num_env_steps_trained": 32040, "num_agent_steps_sampled": 32040, "num_agent_steps_trained": 32040}, "done": false, "episodes_total": 89, "training_iteration": 18, "trial_id": "f5e97_00000", "date": "2023-07-25_16-59-13", "timestamp": 1690293553, "time_this_iter_s": 11.2089102268219, "time_total_s": 200.31154870986938, "pid": 71917, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[0, 0.003], [5400, 0.001], [10800, 0.00075], [16200, 0.0005], [21600, 0.00025], [27000, 0.0001], [32400, 7.5e-05], [37800, 5e-05], [43200, 2.5e-05], [48600, 1e-05], [54000, 7.5e-06], [59400, 5e-06], [64800, 2.5e-06], [70200, 1e-06], [75600, 5e-07], [81000, 1e-07]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x304530310>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 200.31154870986938, "iterations_since_restore": 18, "perf": {"cpu_util_percent": 26.55, "ram_util_percent": 77.975}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 7e-05, "entropy_coeff": 0.1, "policy_entropy": -926.6878784179687, "policy_loss": -4.058471625876293e+18, "vf_loss": 1082197241.6}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 468.0, "diff_num_grad_updates_vs_sampler_policy": 467.0}}, "num_env_steps_sampled": 33840, "num_env_steps_trained": 33840, "num_agent_steps_sampled": 33840, "num_agent_steps_trained": 33840}, "sampler_results": {"episode_reward_max": -2422.3370447059615, "episode_reward_min": -26099.42399150872, "episode_reward_mean": -25053.909227669687, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-6436.033434161671, -6043.969601759489, -2422.3370447059615, -24990.34634919007, -25452.837867188566, -25310.57312518208, -25686.93441898636, -25733.06477177539, -25632.540837596986, -25741.25838094305, -25682.951867265267, -25875.54927130328, -25791.41113474669, -25876.087019490118, -25758.293694585434, -25634.18668867263, -25774.040714141163, -25322.081785864284, -25728.39902520237, -26006.438038763314, -25689.929666468986, -26046.034745217887, -25784.412419518667, -25842.835463957334, -25734.83061046133, -25844.28041359334, -25635.44875060622, -25803.193126233928, -25663.826963650325, -25802.505894538343, -25696.01838045785, -25481.06001408537, -26099.42399150872, -25669.070720236832, -25574.459522488956, -25661.384923105496, -25628.895882615365, -25692.711051277838, -25530.484442847315, -25739.569920149836, -25575.22608879392, -25806.46826871708, -26030.406526650026, -25762.396464165115, -25472.808615743124, -25512.665211606723, -25694.924278548217, -25700.022311652854, -25610.877586351526, -25766.714040352563, -25633.132008411972, -25910.175594312626, -25714.65018026558, -25792.327418101308, -25778.692984522557, -26007.63610235267, -25675.403200363275, -25552.72024906665, -25629.20175874157, -25809.535388943135, -25818.56046598507, -25878.391237373035, -25570.150043400514, -25794.707688705443, -25857.340110996713, -25560.244690377833, -25892.030930636447, -25948.775583705134, -25540.974212054138, -25702.090137226263, -25690.626525256663, -25693.172602679162, -25607.345925140522, -25690.98896196435, -25803.890518293992, -25734.94249507384, -25744.72705686407, -25770.29113828817, -25633.526479834145, -25763.380903443955, -25994.644736679224, -25562.739129391666, -25809.002674179115, -25691.99106312291, -25536.953614818452, -26089.458519239386, -25728.991995568085, -25743.012710942498, -25731.19233485226, -25635.56251138054, -25555.852056140535, -25960.016379683682, -25775.473635270748, -25600.72208017551], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.4083049813799455, "mean_inference_ms": 0.24697903705522584, "mean_action_processing_ms": 0.05881249946356194, "mean_env_wait_ms": 1.6393080137786826, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0024808214065876414, "StateBufferConnector_ms": 0.0018271994083485705, "ViewRequirementAgentConnector_ms": 0.045225214450917345}}, "episode_reward_max": -2422.3370447059615, "episode_reward_min": -26099.42399150872, "episode_reward_mean": -25053.909227669687, "episode_len_mean": 360.0, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-6436.033434161671, -6043.969601759489, -2422.3370447059615, -24990.34634919007, -25452.837867188566, -25310.57312518208, -25686.93441898636, -25733.06477177539, -25632.540837596986, -25741.25838094305, -25682.951867265267, -25875.54927130328, -25791.41113474669, -25876.087019490118, -25758.293694585434, -25634.18668867263, -25774.040714141163, -25322.081785864284, -25728.39902520237, -26006.438038763314, -25689.929666468986, -26046.034745217887, -25784.412419518667, -25842.835463957334, -25734.83061046133, -25844.28041359334, -25635.44875060622, -25803.193126233928, -25663.826963650325, -25802.505894538343, -25696.01838045785, -25481.06001408537, -26099.42399150872, -25669.070720236832, -25574.459522488956, -25661.384923105496, -25628.895882615365, -25692.711051277838, -25530.484442847315, -25739.569920149836, -25575.22608879392, -25806.46826871708, -26030.406526650026, -25762.396464165115, -25472.808615743124, -25512.665211606723, -25694.924278548217, -25700.022311652854, -25610.877586351526, -25766.714040352563, -25633.132008411972, -25910.175594312626, -25714.65018026558, -25792.327418101308, -25778.692984522557, -26007.63610235267, -25675.403200363275, -25552.72024906665, -25629.20175874157, -25809.535388943135, -25818.56046598507, -25878.391237373035, -25570.150043400514, -25794.707688705443, -25857.340110996713, -25560.244690377833, -25892.030930636447, -25948.775583705134, -25540.974212054138, -25702.090137226263, -25690.626525256663, -25693.172602679162, -25607.345925140522, -25690.98896196435, -25803.890518293992, -25734.94249507384, -25744.72705686407, -25770.29113828817, -25633.526479834145, -25763.380903443955, -25994.644736679224, -25562.739129391666, -25809.002674179115, -25691.99106312291, -25536.953614818452, -26089.458519239386, -25728.991995568085, -25743.012710942498, -25731.19233485226, -25635.56251138054, -25555.852056140535, -25960.016379683682, -25775.473635270748, -25600.72208017551], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.4083049813799455, "mean_inference_ms": 0.24697903705522584, "mean_action_processing_ms": 0.05881249946356194, "mean_env_wait_ms": 1.6393080137786826, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0024808214065876414, "StateBufferConnector_ms": 0.0018271994083485705, "ViewRequirementAgentConnector_ms": 0.045225214450917345}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 33840, "num_agent_steps_trained": 33840, "num_env_steps_sampled": 33840, "num_env_steps_trained": 33840, "num_env_steps_sampled_this_iter": 1800, "num_env_steps_trained_this_iter": 1800, "num_env_steps_sampled_throughput_per_sec": 161.41804277126985, "num_env_steps_trained_throughput_per_sec": 161.41804277126985, "timesteps_total": 33840, "num_steps_trained_this_iter": 1800, "agent_timesteps_total": 33840, "timers": {"training_iteration_time_ms": 2235.798, "sample_time_ms": 2228.647, "load_time_ms": 0.216, "load_throughput": 1670298.053, "learn_time_ms": 6.387, "learn_throughput": 56368.74, "synch_weights_time_ms": 0.516}, "counters": {"num_env_steps_sampled": 33840, "num_env_steps_trained": 33840, "num_agent_steps_sampled": 33840, "num_agent_steps_trained": 33840}, "done": false, "episodes_total": 94, "training_iteration": 19, "trial_id": "f5e97_00000", "date": "2023-07-25_16-59-25", "timestamp": 1690293565, "time_this_iter_s": 11.15322494506836, "time_total_s": 211.46477365493774, "pid": 71917, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[0, 0.003], [5400, 0.001], [10800, 0.00075], [16200, 0.0005], [21600, 0.00025], [27000, 0.0001], [32400, 7.5e-05], [37800, 5e-05], [43200, 2.5e-05], [48600, 1e-05], [54000, 7.5e-06], [59400, 5e-06], [64800, 2.5e-06], [70200, 1e-06], [75600, 5e-07], [81000, 1e-07]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x304530310>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 211.46477365493774, "iterations_since_restore": 19, "perf": {"cpu_util_percent": 25.5, "ram_util_percent": 77.99375}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 6.166666666666667e-05, "entropy_coeff": 0.1, "policy_entropy": -926.687841796875, "policy_loss": -1.0937215586629189e+18, "vf_loss": 1108468000.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 493.0, "diff_num_grad_updates_vs_sampler_policy": 492.0}}, "num_env_steps_sampled": 35640, "num_env_steps_trained": 35640, "num_agent_steps_sampled": 35640, "num_agent_steps_trained": 35640}, "sampler_results": {"episode_reward_max": -2422.3370447059615, "episode_reward_min": -26099.42399150872, "episode_reward_mean": -25089.692195663018, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-6436.033434161671, -6043.969601759489, -2422.3370447059615, -24990.34634919007, -25452.837867188566, -25310.57312518208, -25686.93441898636, -25733.06477177539, -25632.540837596986, -25741.25838094305, -25682.951867265267, -25875.54927130328, -25791.41113474669, -25876.087019490118, -25758.293694585434, -25634.18668867263, -25774.040714141163, -25322.081785864284, -25728.39902520237, -26006.438038763314, -25689.929666468986, -26046.034745217887, -25784.412419518667, -25842.835463957334, -25734.83061046133, -25844.28041359334, -25635.44875060622, -25803.193126233928, -25663.826963650325, -25802.505894538343, -25696.01838045785, -25481.06001408537, -26099.42399150872, -25669.070720236832, -25574.459522488956, -25661.384923105496, -25628.895882615365, -25692.711051277838, -25530.484442847315, -25739.569920149836, -25575.22608879392, -25806.46826871708, -26030.406526650026, -25762.396464165115, -25472.808615743124, -25512.665211606723, -25694.924278548217, -25700.022311652854, -25610.877586351526, -25766.714040352563, -25633.132008411972, -25910.175594312626, -25714.65018026558, -25792.327418101308, -25778.692984522557, -26007.63610235267, -25675.403200363275, -25552.72024906665, -25629.20175874157, -25809.535388943135, -25818.56046598507, -25878.391237373035, -25570.150043400514, -25794.707688705443, -25857.340110996713, -25560.244690377833, -25892.030930636447, -25948.775583705134, -25540.974212054138, -25702.090137226263, -25690.626525256663, -25693.172602679162, -25607.345925140522, -25690.98896196435, -25803.890518293992, -25734.94249507384, -25744.72705686407, -25770.29113828817, -25633.526479834145, -25763.380903443955, -25994.644736679224, -25562.739129391666, -25809.002674179115, -25691.99106312291, -25536.953614818452, -26089.458519239386, -25728.991995568085, -25743.012710942498, -25731.19233485226, -25635.56251138054, -25555.852056140535, -25960.016379683682, -25775.473635270748, -25600.72208017551, -25739.55659743875, -25725.58944046207, -25968.460313317206, -25552.31023615267, -25826.14338231702], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.4083315165471735, "mean_inference_ms": 0.24690594372655736, "mean_action_processing_ms": 0.05879704959799047, "mean_env_wait_ms": 1.631888056818556, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0024658260923443418, "StateBufferConnector_ms": 0.001813426162257339, "ViewRequirementAgentConnector_ms": 0.045156960535531095}}, "episode_reward_max": -2422.3370447059615, "episode_reward_min": -26099.42399150872, "episode_reward_mean": -25089.692195663018, "episode_len_mean": 360.0, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-6436.033434161671, -6043.969601759489, -2422.3370447059615, -24990.34634919007, -25452.837867188566, -25310.57312518208, -25686.93441898636, -25733.06477177539, -25632.540837596986, -25741.25838094305, -25682.951867265267, -25875.54927130328, -25791.41113474669, -25876.087019490118, -25758.293694585434, -25634.18668867263, -25774.040714141163, -25322.081785864284, -25728.39902520237, -26006.438038763314, -25689.929666468986, -26046.034745217887, -25784.412419518667, -25842.835463957334, -25734.83061046133, -25844.28041359334, -25635.44875060622, -25803.193126233928, -25663.826963650325, -25802.505894538343, -25696.01838045785, -25481.06001408537, -26099.42399150872, -25669.070720236832, -25574.459522488956, -25661.384923105496, -25628.895882615365, -25692.711051277838, -25530.484442847315, -25739.569920149836, -25575.22608879392, -25806.46826871708, -26030.406526650026, -25762.396464165115, -25472.808615743124, -25512.665211606723, -25694.924278548217, -25700.022311652854, -25610.877586351526, -25766.714040352563, -25633.132008411972, -25910.175594312626, -25714.65018026558, -25792.327418101308, -25778.692984522557, -26007.63610235267, -25675.403200363275, -25552.72024906665, -25629.20175874157, -25809.535388943135, -25818.56046598507, -25878.391237373035, -25570.150043400514, -25794.707688705443, -25857.340110996713, -25560.244690377833, -25892.030930636447, -25948.775583705134, -25540.974212054138, -25702.090137226263, -25690.626525256663, -25693.172602679162, -25607.345925140522, -25690.98896196435, -25803.890518293992, -25734.94249507384, -25744.72705686407, -25770.29113828817, -25633.526479834145, -25763.380903443955, -25994.644736679224, -25562.739129391666, -25809.002674179115, -25691.99106312291, -25536.953614818452, -26089.458519239386, -25728.991995568085, -25743.012710942498, -25731.19233485226, -25635.56251138054, -25555.852056140535, -25960.016379683682, -25775.473635270748, -25600.72208017551, -25739.55659743875, -25725.58944046207, -25968.460313317206, -25552.31023615267, -25826.14338231702], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.4083315165471735, "mean_inference_ms": 0.24690594372655736, "mean_action_processing_ms": 0.05879704959799047, "mean_env_wait_ms": 1.631888056818556, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0024658260923443418, "StateBufferConnector_ms": 0.001813426162257339, "ViewRequirementAgentConnector_ms": 0.045156960535531095}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 35640, "num_agent_steps_trained": 35640, "num_env_steps_sampled": 35640, "num_env_steps_trained": 35640, "num_env_steps_sampled_this_iter": 1800, "num_env_steps_trained_this_iter": 1800, "num_env_steps_sampled_throughput_per_sec": 160.9492426263805, "num_env_steps_trained_throughput_per_sec": 160.9492426263805, "timesteps_total": 35640, "num_steps_trained_this_iter": 1800, "agent_timesteps_total": 35640, "timers": {"training_iteration_time_ms": 2233.473, "sample_time_ms": 2226.384, "load_time_ms": 0.216, "load_throughput": 1666426.929, "learn_time_ms": 6.326, "learn_throughput": 56903.853, "synch_weights_time_ms": 0.515}, "counters": {"num_env_steps_sampled": 35640, "num_env_steps_trained": 35640, "num_agent_steps_sampled": 35640, "num_agent_steps_trained": 35640}, "done": false, "episodes_total": 99, "training_iteration": 20, "trial_id": "f5e97_00000", "date": "2023-07-25_16-59-36", "timestamp": 1690293576, "time_this_iter_s": 11.186477184295654, "time_total_s": 222.6512508392334, "pid": 71917, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[0, 0.003], [5400, 0.001], [10800, 0.00075], [16200, 0.0005], [21600, 0.00025], [27000, 0.0001], [32400, 7.5e-05], [37800, 5e-05], [43200, 2.5e-05], [48600, 1e-05], [54000, 7.5e-06], [59400, 5e-06], [64800, 2.5e-06], [70200, 1e-06], [75600, 5e-07], [81000, 1e-07]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x304530310>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 222.6512508392334, "iterations_since_restore": 20, "perf": {"cpu_util_percent": 25.56875, "ram_util_percent": 77.95625}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 5.333333333333333e-05, "entropy_coeff": 0.1, "policy_entropy": -926.6877319335938, "policy_loss": -3.358271189803467e+17, "vf_loss": 1105957158.4}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 518.0, "diff_num_grad_updates_vs_sampler_policy": 517.0}}, "num_env_steps_sampled": 37440, "num_env_steps_trained": 37440, "num_agent_steps_sampled": 37440, "num_agent_steps_trained": 37440}, "sampler_results": {"episode_reward_max": -25310.57312518208, "episode_reward_min": -26099.42399150872, "episode_reward_mean": -25731.421587965022, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-25452.837867188566, -25310.57312518208, -25686.93441898636, -25733.06477177539, -25632.540837596986, -25741.25838094305, -25682.951867265267, -25875.54927130328, -25791.41113474669, -25876.087019490118, -25758.293694585434, -25634.18668867263, -25774.040714141163, -25322.081785864284, -25728.39902520237, -26006.438038763314, -25689.929666468986, -26046.034745217887, -25784.412419518667, -25842.835463957334, -25734.83061046133, -25844.28041359334, -25635.44875060622, -25803.193126233928, -25663.826963650325, -25802.505894538343, -25696.01838045785, -25481.06001408537, -26099.42399150872, -25669.070720236832, -25574.459522488956, -25661.384923105496, -25628.895882615365, -25692.711051277838, -25530.484442847315, -25739.569920149836, -25575.22608879392, -25806.46826871708, -26030.406526650026, -25762.396464165115, -25472.808615743124, -25512.665211606723, -25694.924278548217, -25700.022311652854, -25610.877586351526, -25766.714040352563, -25633.132008411972, -25910.175594312626, -25714.65018026558, -25792.327418101308, -25778.692984522557, -26007.63610235267, -25675.403200363275, -25552.72024906665, -25629.20175874157, -25809.535388943135, -25818.56046598507, -25878.391237373035, -25570.150043400514, -25794.707688705443, -25857.340110996713, -25560.244690377833, -25892.030930636447, -25948.775583705134, -25540.974212054138, -25702.090137226263, -25690.626525256663, -25693.172602679162, -25607.345925140522, -25690.98896196435, -25803.890518293992, -25734.94249507384, -25744.72705686407, -25770.29113828817, -25633.526479834145, -25763.380903443955, -25994.644736679224, -25562.739129391666, -25809.002674179115, -25691.99106312291, -25536.953614818452, -26089.458519239386, -25728.991995568085, -25743.012710942498, -25731.19233485226, -25635.56251138054, -25555.852056140535, -25960.016379683682, -25775.473635270748, -25600.72208017551, -25739.55659743875, -25725.58944046207, -25968.460313317206, -25552.31023615267, -25826.14338231702, -25851.657935559237, -25870.772929873903, -25857.31829782494, -25725.81508575221, -25849.753606671016], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.407873306392827, "mean_inference_ms": 0.24653903151513284, "mean_action_processing_ms": 0.05872426564371944, "mean_env_wait_ms": 1.5827765451571423, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0024673938751220703, "StateBufferConnector_ms": 0.0018122196197509766, "ViewRequirementAgentConnector_ms": 0.04516720771789551}}, "episode_reward_max": -25310.57312518208, "episode_reward_min": -26099.42399150872, "episode_reward_mean": -25731.421587965022, "episode_len_mean": 360.0, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-25452.837867188566, -25310.57312518208, -25686.93441898636, -25733.06477177539, -25632.540837596986, -25741.25838094305, -25682.951867265267, -25875.54927130328, -25791.41113474669, -25876.087019490118, -25758.293694585434, -25634.18668867263, -25774.040714141163, -25322.081785864284, -25728.39902520237, -26006.438038763314, -25689.929666468986, -26046.034745217887, -25784.412419518667, -25842.835463957334, -25734.83061046133, -25844.28041359334, -25635.44875060622, -25803.193126233928, -25663.826963650325, -25802.505894538343, -25696.01838045785, -25481.06001408537, -26099.42399150872, -25669.070720236832, -25574.459522488956, -25661.384923105496, -25628.895882615365, -25692.711051277838, -25530.484442847315, -25739.569920149836, -25575.22608879392, -25806.46826871708, -26030.406526650026, -25762.396464165115, -25472.808615743124, -25512.665211606723, -25694.924278548217, -25700.022311652854, -25610.877586351526, -25766.714040352563, -25633.132008411972, -25910.175594312626, -25714.65018026558, -25792.327418101308, -25778.692984522557, -26007.63610235267, -25675.403200363275, -25552.72024906665, -25629.20175874157, -25809.535388943135, -25818.56046598507, -25878.391237373035, -25570.150043400514, -25794.707688705443, -25857.340110996713, -25560.244690377833, -25892.030930636447, -25948.775583705134, -25540.974212054138, -25702.090137226263, -25690.626525256663, -25693.172602679162, -25607.345925140522, -25690.98896196435, -25803.890518293992, -25734.94249507384, -25744.72705686407, -25770.29113828817, -25633.526479834145, -25763.380903443955, -25994.644736679224, -25562.739129391666, -25809.002674179115, -25691.99106312291, -25536.953614818452, -26089.458519239386, -25728.991995568085, -25743.012710942498, -25731.19233485226, -25635.56251138054, -25555.852056140535, -25960.016379683682, -25775.473635270748, -25600.72208017551, -25739.55659743875, -25725.58944046207, -25968.460313317206, -25552.31023615267, -25826.14338231702, -25851.657935559237, -25870.772929873903, -25857.31829782494, -25725.81508575221, -25849.753606671016], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.407873306392827, "mean_inference_ms": 0.24653903151513284, "mean_action_processing_ms": 0.05872426564371944, "mean_env_wait_ms": 1.5827765451571423, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0024673938751220703, "StateBufferConnector_ms": 0.0018122196197509766, "ViewRequirementAgentConnector_ms": 0.04516720771789551}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 37440, "num_agent_steps_trained": 37440, "num_env_steps_sampled": 37440, "num_env_steps_trained": 37440, "num_env_steps_sampled_this_iter": 1800, "num_env_steps_trained_this_iter": 1800, "num_env_steps_sampled_throughput_per_sec": 161.4338474222011, "num_env_steps_trained_throughput_per_sec": 161.4338474222011, "timesteps_total": 37440, "num_steps_trained_this_iter": 1800, "agent_timesteps_total": 37440, "timers": {"training_iteration_time_ms": 2233.363, "sample_time_ms": 2226.299, "load_time_ms": 0.217, "load_throughput": 1658556.063, "learn_time_ms": 6.286, "learn_throughput": 57266.203, "synch_weights_time_ms": 0.529}, "counters": {"num_env_steps_sampled": 37440, "num_env_steps_trained": 37440, "num_agent_steps_sampled": 37440, "num_agent_steps_trained": 37440}, "done": false, "episodes_total": 104, "training_iteration": 21, "trial_id": "f5e97_00000", "date": "2023-07-25_16-59-47", "timestamp": 1690293587, "time_this_iter_s": 11.152312994003296, "time_total_s": 233.8035638332367, "pid": 71917, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[0, 0.003], [5400, 0.001], [10800, 0.00075], [16200, 0.0005], [21600, 0.00025], [27000, 0.0001], [32400, 7.5e-05], [37800, 5e-05], [43200, 2.5e-05], [48600, 1e-05], [54000, 7.5e-06], [59400, 5e-06], [64800, 2.5e-06], [70200, 1e-06], [75600, 5e-07], [81000, 1e-07]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x304530310>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 233.8035638332367, "iterations_since_restore": 21, "perf": {"cpu_util_percent": 27.125, "ram_util_percent": 77.9125}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 4.5e-05, "entropy_coeff": 0.1, "policy_entropy": -926.6876831054688, "policy_loss": -1.648830888396066e+18, "vf_loss": 1104596966.4}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 543.0, "diff_num_grad_updates_vs_sampler_policy": 542.0}}, "num_env_steps_sampled": 39240, "num_env_steps_trained": 39240, "num_agent_steps_sampled": 39240, "num_agent_steps_trained": 39240}, "sampler_results": {"episode_reward_max": -25322.081785864284, "episode_reward_min": -26099.42399150872, "episode_reward_mean": -25740.701146272626, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-25741.25838094305, -25682.951867265267, -25875.54927130328, -25791.41113474669, -25876.087019490118, -25758.293694585434, -25634.18668867263, -25774.040714141163, -25322.081785864284, -25728.39902520237, -26006.438038763314, -25689.929666468986, -26046.034745217887, -25784.412419518667, -25842.835463957334, -25734.83061046133, -25844.28041359334, -25635.44875060622, -25803.193126233928, -25663.826963650325, -25802.505894538343, -25696.01838045785, -25481.06001408537, -26099.42399150872, -25669.070720236832, -25574.459522488956, -25661.384923105496, -25628.895882615365, -25692.711051277838, -25530.484442847315, -25739.569920149836, -25575.22608879392, -25806.46826871708, -26030.406526650026, -25762.396464165115, -25472.808615743124, -25512.665211606723, -25694.924278548217, -25700.022311652854, -25610.877586351526, -25766.714040352563, -25633.132008411972, -25910.175594312626, -25714.65018026558, -25792.327418101308, -25778.692984522557, -26007.63610235267, -25675.403200363275, -25552.72024906665, -25629.20175874157, -25809.535388943135, -25818.56046598507, -25878.391237373035, -25570.150043400514, -25794.707688705443, -25857.340110996713, -25560.244690377833, -25892.030930636447, -25948.775583705134, -25540.974212054138, -25702.090137226263, -25690.626525256663, -25693.172602679162, -25607.345925140522, -25690.98896196435, -25803.890518293992, -25734.94249507384, -25744.72705686407, -25770.29113828817, -25633.526479834145, -25763.380903443955, -25994.644736679224, -25562.739129391666, -25809.002674179115, -25691.99106312291, -25536.953614818452, -26089.458519239386, -25728.991995568085, -25743.012710942498, -25731.19233485226, -25635.56251138054, -25555.852056140535, -25960.016379683682, -25775.473635270748, -25600.72208017551, -25739.55659743875, -25725.58944046207, -25968.460313317206, -25552.31023615267, -25826.14338231702, -25851.657935559237, -25870.772929873903, -25857.31829782494, -25725.81508575221, -25849.753606671016, -25774.36638573008, -25750.61390274705, -25795.093836279437, -25607.763441825202, -25816.06928490739], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.408315735841578, "mean_inference_ms": 0.2462582137887403, "mean_action_processing_ms": 0.05866913145834029, "mean_env_wait_ms": 1.556825906771279, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0024623870849609375, "StateBufferConnector_ms": 0.0018074512481689453, "ViewRequirementAgentConnector_ms": 0.0451507568359375}}, "episode_reward_max": -25322.081785864284, "episode_reward_min": -26099.42399150872, "episode_reward_mean": -25740.701146272626, "episode_len_mean": 360.0, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-25741.25838094305, -25682.951867265267, -25875.54927130328, -25791.41113474669, -25876.087019490118, -25758.293694585434, -25634.18668867263, -25774.040714141163, -25322.081785864284, -25728.39902520237, -26006.438038763314, -25689.929666468986, -26046.034745217887, -25784.412419518667, -25842.835463957334, -25734.83061046133, -25844.28041359334, -25635.44875060622, -25803.193126233928, -25663.826963650325, -25802.505894538343, -25696.01838045785, -25481.06001408537, -26099.42399150872, -25669.070720236832, -25574.459522488956, -25661.384923105496, -25628.895882615365, -25692.711051277838, -25530.484442847315, -25739.569920149836, -25575.22608879392, -25806.46826871708, -26030.406526650026, -25762.396464165115, -25472.808615743124, -25512.665211606723, -25694.924278548217, -25700.022311652854, -25610.877586351526, -25766.714040352563, -25633.132008411972, -25910.175594312626, -25714.65018026558, -25792.327418101308, -25778.692984522557, -26007.63610235267, -25675.403200363275, -25552.72024906665, -25629.20175874157, -25809.535388943135, -25818.56046598507, -25878.391237373035, -25570.150043400514, -25794.707688705443, -25857.340110996713, -25560.244690377833, -25892.030930636447, -25948.775583705134, -25540.974212054138, -25702.090137226263, -25690.626525256663, -25693.172602679162, -25607.345925140522, -25690.98896196435, -25803.890518293992, -25734.94249507384, -25744.72705686407, -25770.29113828817, -25633.526479834145, -25763.380903443955, -25994.644736679224, -25562.739129391666, -25809.002674179115, -25691.99106312291, -25536.953614818452, -26089.458519239386, -25728.991995568085, -25743.012710942498, -25731.19233485226, -25635.56251138054, -25555.852056140535, -25960.016379683682, -25775.473635270748, -25600.72208017551, -25739.55659743875, -25725.58944046207, -25968.460313317206, -25552.31023615267, -25826.14338231702, -25851.657935559237, -25870.772929873903, -25857.31829782494, -25725.81508575221, -25849.753606671016, -25774.36638573008, -25750.61390274705, -25795.093836279437, -25607.763441825202, -25816.06928490739], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.408315735841578, "mean_inference_ms": 0.2462582137887403, "mean_action_processing_ms": 0.05866913145834029, "mean_env_wait_ms": 1.556825906771279, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0024623870849609375, "StateBufferConnector_ms": 0.0018074512481689453, "ViewRequirementAgentConnector_ms": 0.0451507568359375}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 39240, "num_agent_steps_trained": 39240, "num_env_steps_sampled": 39240, "num_env_steps_trained": 39240, "num_env_steps_sampled_this_iter": 1800, "num_env_steps_trained_this_iter": 1800, "num_env_steps_sampled_throughput_per_sec": 160.9536758530873, "num_env_steps_trained_throughput_per_sec": 160.9536758530873, "timesteps_total": 39240, "num_steps_trained_this_iter": 1800, "agent_timesteps_total": 39240, "timers": {"training_iteration_time_ms": 2233.333, "sample_time_ms": 2226.217, "load_time_ms": 0.218, "load_throughput": 1649496.876, "learn_time_ms": 6.335, "learn_throughput": 56823.763, "synch_weights_time_ms": 0.53}, "counters": {"num_env_steps_sampled": 39240, "num_env_steps_trained": 39240, "num_agent_steps_sampled": 39240, "num_agent_steps_trained": 39240}, "done": false, "episodes_total": 109, "training_iteration": 22, "trial_id": "f5e97_00000", "date": "2023-07-25_16-59-58", "timestamp": 1690293598, "time_this_iter_s": 11.185364007949829, "time_total_s": 244.98892784118652, "pid": 71917, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[0, 0.003], [5400, 0.001], [10800, 0.00075], [16200, 0.0005], [21600, 0.00025], [27000, 0.0001], [32400, 7.5e-05], [37800, 5e-05], [43200, 2.5e-05], [48600, 1e-05], [54000, 7.5e-06], [59400, 5e-06], [64800, 2.5e-06], [70200, 1e-06], [75600, 5e-07], [81000, 1e-07]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x304530310>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 244.98892784118652, "iterations_since_restore": 22, "perf": {"cpu_util_percent": 25.275, "ram_util_percent": 78.48125}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 3.666666666666667e-05, "entropy_coeff": 0.1, "policy_entropy": -926.6875610351562, "policy_loss": -2.72017889158955e+16, "vf_loss": 1117555443.2}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 568.0, "diff_num_grad_updates_vs_sampler_policy": 567.0}}, "num_env_steps_sampled": 41040, "num_env_steps_trained": 41040, "num_agent_steps_sampled": 41040, "num_agent_steps_trained": 41040}, "sampler_results": {"episode_reward_max": -25322.081785864284, "episode_reward_min": -26099.42399150872, "episode_reward_mean": -25743.459624905194, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-25758.293694585434, -25634.18668867263, -25774.040714141163, -25322.081785864284, -25728.39902520237, -26006.438038763314, -25689.929666468986, -26046.034745217887, -25784.412419518667, -25842.835463957334, -25734.83061046133, -25844.28041359334, -25635.44875060622, -25803.193126233928, -25663.826963650325, -25802.505894538343, -25696.01838045785, -25481.06001408537, -26099.42399150872, -25669.070720236832, -25574.459522488956, -25661.384923105496, -25628.895882615365, -25692.711051277838, -25530.484442847315, -25739.569920149836, -25575.22608879392, -25806.46826871708, -26030.406526650026, -25762.396464165115, -25472.808615743124, -25512.665211606723, -25694.924278548217, -25700.022311652854, -25610.877586351526, -25766.714040352563, -25633.132008411972, -25910.175594312626, -25714.65018026558, -25792.327418101308, -25778.692984522557, -26007.63610235267, -25675.403200363275, -25552.72024906665, -25629.20175874157, -25809.535388943135, -25818.56046598507, -25878.391237373035, -25570.150043400514, -25794.707688705443, -25857.340110996713, -25560.244690377833, -25892.030930636447, -25948.775583705134, -25540.974212054138, -25702.090137226263, -25690.626525256663, -25693.172602679162, -25607.345925140522, -25690.98896196435, -25803.890518293992, -25734.94249507384, -25744.72705686407, -25770.29113828817, -25633.526479834145, -25763.380903443955, -25994.644736679224, -25562.739129391666, -25809.002674179115, -25691.99106312291, -25536.953614818452, -26089.458519239386, -25728.991995568085, -25743.012710942498, -25731.19233485226, -25635.56251138054, -25555.852056140535, -25960.016379683682, -25775.473635270748, -25600.72208017551, -25739.55659743875, -25725.58944046207, -25968.460313317206, -25552.31023615267, -25826.14338231702, -25851.657935559237, -25870.772929873903, -25857.31829782494, -25725.81508575221, -25849.753606671016, -25774.36638573008, -25750.61390274705, -25795.093836279437, -25607.763441825202, -25816.06928490739, -26032.52816587912, -25611.90048073366, -25758.81026738292, -25818.19909581026, -26021.667527199745], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.408597427601718, "mean_inference_ms": 0.24609070280635248, "mean_action_processing_ms": 0.05863746713140595, "mean_env_wait_ms": 1.541003800813984, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002452373504638672, "StateBufferConnector_ms": 0.0017995834350585938, "ViewRequirementAgentConnector_ms": 0.04507803916931152}}, "episode_reward_max": -25322.081785864284, "episode_reward_min": -26099.42399150872, "episode_reward_mean": -25743.459624905194, "episode_len_mean": 360.0, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-25758.293694585434, -25634.18668867263, -25774.040714141163, -25322.081785864284, -25728.39902520237, -26006.438038763314, -25689.929666468986, -26046.034745217887, -25784.412419518667, -25842.835463957334, -25734.83061046133, -25844.28041359334, -25635.44875060622, -25803.193126233928, -25663.826963650325, -25802.505894538343, -25696.01838045785, -25481.06001408537, -26099.42399150872, -25669.070720236832, -25574.459522488956, -25661.384923105496, -25628.895882615365, -25692.711051277838, -25530.484442847315, -25739.569920149836, -25575.22608879392, -25806.46826871708, -26030.406526650026, -25762.396464165115, -25472.808615743124, -25512.665211606723, -25694.924278548217, -25700.022311652854, -25610.877586351526, -25766.714040352563, -25633.132008411972, -25910.175594312626, -25714.65018026558, -25792.327418101308, -25778.692984522557, -26007.63610235267, -25675.403200363275, -25552.72024906665, -25629.20175874157, -25809.535388943135, -25818.56046598507, -25878.391237373035, -25570.150043400514, -25794.707688705443, -25857.340110996713, -25560.244690377833, -25892.030930636447, -25948.775583705134, -25540.974212054138, -25702.090137226263, -25690.626525256663, -25693.172602679162, -25607.345925140522, -25690.98896196435, -25803.890518293992, -25734.94249507384, -25744.72705686407, -25770.29113828817, -25633.526479834145, -25763.380903443955, -25994.644736679224, -25562.739129391666, -25809.002674179115, -25691.99106312291, -25536.953614818452, -26089.458519239386, -25728.991995568085, -25743.012710942498, -25731.19233485226, -25635.56251138054, -25555.852056140535, -25960.016379683682, -25775.473635270748, -25600.72208017551, -25739.55659743875, -25725.58944046207, -25968.460313317206, -25552.31023615267, -25826.14338231702, -25851.657935559237, -25870.772929873903, -25857.31829782494, -25725.81508575221, -25849.753606671016, -25774.36638573008, -25750.61390274705, -25795.093836279437, -25607.763441825202, -25816.06928490739, -26032.52816587912, -25611.90048073366, -25758.81026738292, -25818.19909581026, -26021.667527199745], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.408597427601718, "mean_inference_ms": 0.24609070280635248, "mean_action_processing_ms": 0.05863746713140595, "mean_env_wait_ms": 1.541003800813984, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002452373504638672, "StateBufferConnector_ms": 0.0017995834350585938, "ViewRequirementAgentConnector_ms": 0.04507803916931152}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 41040, "num_agent_steps_trained": 41040, "num_env_steps_sampled": 41040, "num_env_steps_trained": 41040, "num_env_steps_sampled_this_iter": 1800, "num_env_steps_trained_this_iter": 1800, "num_env_steps_sampled_throughput_per_sec": 161.2382108229658, "num_env_steps_trained_throughput_per_sec": 161.2382108229658, "timesteps_total": 41040, "num_steps_trained_this_iter": 1800, "agent_timesteps_total": 41040, "timers": {"training_iteration_time_ms": 2234.685, "sample_time_ms": 2227.406, "load_time_ms": 0.223, "load_throughput": 1616302.119, "learn_time_ms": 6.472, "learn_throughput": 55621.841, "synch_weights_time_ms": 0.545}, "counters": {"num_env_steps_sampled": 41040, "num_env_steps_trained": 41040, "num_agent_steps_sampled": 41040, "num_agent_steps_trained": 41040}, "done": false, "episodes_total": 114, "training_iteration": 23, "trial_id": "f5e97_00000", "date": "2023-07-25_17-00-09", "timestamp": 1690293609, "time_this_iter_s": 11.166067838668823, "time_total_s": 256.15499567985535, "pid": 71917, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[0, 0.003], [5400, 0.001], [10800, 0.00075], [16200, 0.0005], [21600, 0.00025], [27000, 0.0001], [32400, 7.5e-05], [37800, 5e-05], [43200, 2.5e-05], [48600, 1e-05], [54000, 7.5e-06], [59400, 5e-06], [64800, 2.5e-06], [70200, 1e-06], [75600, 5e-07], [81000, 1e-07]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x304530310>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 256.15499567985535, "iterations_since_restore": 23, "perf": {"cpu_util_percent": 24.73125, "ram_util_percent": 78.75625}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 2.8333333333333335e-05, "entropy_coeff": 0.1, "policy_entropy": -926.6880981445313, "policy_loss": -6.227476872034369e+17, "vf_loss": 1082226208.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 593.0, "diff_num_grad_updates_vs_sampler_policy": 592.0}}, "num_env_steps_sampled": 42840, "num_env_steps_trained": 42840, "num_agent_steps_sampled": 42840, "num_agent_steps_trained": 42840}, "sampler_results": {"episode_reward_max": -25450.449219021648, "episode_reward_min": -26099.42399150872, "episode_reward_mean": -25739.852051566602, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-26006.438038763314, -25689.929666468986, -26046.034745217887, -25784.412419518667, -25842.835463957334, -25734.83061046133, -25844.28041359334, -25635.44875060622, -25803.193126233928, -25663.826963650325, -25802.505894538343, -25696.01838045785, -25481.06001408537, -26099.42399150872, -25669.070720236832, -25574.459522488956, -25661.384923105496, -25628.895882615365, -25692.711051277838, -25530.484442847315, -25739.569920149836, -25575.22608879392, -25806.46826871708, -26030.406526650026, -25762.396464165115, -25472.808615743124, -25512.665211606723, -25694.924278548217, -25700.022311652854, -25610.877586351526, -25766.714040352563, -25633.132008411972, -25910.175594312626, -25714.65018026558, -25792.327418101308, -25778.692984522557, -26007.63610235267, -25675.403200363275, -25552.72024906665, -25629.20175874157, -25809.535388943135, -25818.56046598507, -25878.391237373035, -25570.150043400514, -25794.707688705443, -25857.340110996713, -25560.244690377833, -25892.030930636447, -25948.775583705134, -25540.974212054138, -25702.090137226263, -25690.626525256663, -25693.172602679162, -25607.345925140522, -25690.98896196435, -25803.890518293992, -25734.94249507384, -25744.72705686407, -25770.29113828817, -25633.526479834145, -25763.380903443955, -25994.644736679224, -25562.739129391666, -25809.002674179115, -25691.99106312291, -25536.953614818452, -26089.458519239386, -25728.991995568085, -25743.012710942498, -25731.19233485226, -25635.56251138054, -25555.852056140535, -25960.016379683682, -25775.473635270748, -25600.72208017551, -25739.55659743875, -25725.58944046207, -25968.460313317206, -25552.31023615267, -25826.14338231702, -25851.657935559237, -25870.772929873903, -25857.31829782494, -25725.81508575221, -25849.753606671016, -25774.36638573008, -25750.61390274705, -25795.093836279437, -25607.763441825202, -25816.06928490739, -26032.52816587912, -25611.90048073366, -25758.81026738292, -25818.19909581026, -26021.667527199745, -25469.791996477663, -25662.03471436753, -25450.449219021648, -25721.838868787392, -25552.129775951857], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.40888105182959, "mean_inference_ms": 0.24599692346581992, "mean_action_processing_ms": 0.05861755423947567, "mean_env_wait_ms": 1.529680322572359, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002456188201904297, "StateBufferConnector_ms": 0.0018088817596435547, "ViewRequirementAgentConnector_ms": 0.0451662540435791}}, "episode_reward_max": -25450.449219021648, "episode_reward_min": -26099.42399150872, "episode_reward_mean": -25739.852051566602, "episode_len_mean": 360.0, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-26006.438038763314, -25689.929666468986, -26046.034745217887, -25784.412419518667, -25842.835463957334, -25734.83061046133, -25844.28041359334, -25635.44875060622, -25803.193126233928, -25663.826963650325, -25802.505894538343, -25696.01838045785, -25481.06001408537, -26099.42399150872, -25669.070720236832, -25574.459522488956, -25661.384923105496, -25628.895882615365, -25692.711051277838, -25530.484442847315, -25739.569920149836, -25575.22608879392, -25806.46826871708, -26030.406526650026, -25762.396464165115, -25472.808615743124, -25512.665211606723, -25694.924278548217, -25700.022311652854, -25610.877586351526, -25766.714040352563, -25633.132008411972, -25910.175594312626, -25714.65018026558, -25792.327418101308, -25778.692984522557, -26007.63610235267, -25675.403200363275, -25552.72024906665, -25629.20175874157, -25809.535388943135, -25818.56046598507, -25878.391237373035, -25570.150043400514, -25794.707688705443, -25857.340110996713, -25560.244690377833, -25892.030930636447, -25948.775583705134, -25540.974212054138, -25702.090137226263, -25690.626525256663, -25693.172602679162, -25607.345925140522, -25690.98896196435, -25803.890518293992, -25734.94249507384, -25744.72705686407, -25770.29113828817, -25633.526479834145, -25763.380903443955, -25994.644736679224, -25562.739129391666, -25809.002674179115, -25691.99106312291, -25536.953614818452, -26089.458519239386, -25728.991995568085, -25743.012710942498, -25731.19233485226, -25635.56251138054, -25555.852056140535, -25960.016379683682, -25775.473635270748, -25600.72208017551, -25739.55659743875, -25725.58944046207, -25968.460313317206, -25552.31023615267, -25826.14338231702, -25851.657935559237, -25870.772929873903, -25857.31829782494, -25725.81508575221, -25849.753606671016, -25774.36638573008, -25750.61390274705, -25795.093836279437, -25607.763441825202, -25816.06928490739, -26032.52816587912, -25611.90048073366, -25758.81026738292, -25818.19909581026, -26021.667527199745, -25469.791996477663, -25662.03471436753, -25450.449219021648, -25721.838868787392, -25552.129775951857], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.40888105182959, "mean_inference_ms": 0.24599692346581992, "mean_action_processing_ms": 0.05861755423947567, "mean_env_wait_ms": 1.529680322572359, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002456188201904297, "StateBufferConnector_ms": 0.0018088817596435547, "ViewRequirementAgentConnector_ms": 0.0451662540435791}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 42840, "num_agent_steps_trained": 42840, "num_env_steps_sampled": 42840, "num_env_steps_trained": 42840, "num_env_steps_sampled_this_iter": 1800, "num_env_steps_trained_this_iter": 1800, "num_env_steps_sampled_throughput_per_sec": 161.59796846358208, "num_env_steps_trained_throughput_per_sec": 161.59796846358208, "timesteps_total": 42840, "num_steps_trained_this_iter": 1800, "agent_timesteps_total": 42840, "timers": {"training_iteration_time_ms": 2230.225, "sample_time_ms": 2222.6, "load_time_ms": 0.227, "load_throughput": 1588918.699, "learn_time_ms": 6.797, "learn_throughput": 52963.771, "synch_weights_time_ms": 0.561}, "counters": {"num_env_steps_sampled": 42840, "num_env_steps_trained": 42840, "num_agent_steps_sampled": 42840, "num_agent_steps_trained": 42840}, "done": false, "episodes_total": 119, "training_iteration": 24, "trial_id": "f5e97_00000", "date": "2023-07-25_17-00-20", "timestamp": 1690293620, "time_this_iter_s": 11.141093730926514, "time_total_s": 267.29608941078186, "pid": 71917, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[0, 0.003], [5400, 0.001], [10800, 0.00075], [16200, 0.0005], [21600, 0.00025], [27000, 0.0001], [32400, 7.5e-05], [37800, 5e-05], [43200, 2.5e-05], [48600, 1e-05], [54000, 7.5e-06], [59400, 5e-06], [64800, 2.5e-06], [70200, 1e-06], [75600, 5e-07], [81000, 1e-07]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x304530310>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 267.29608941078186, "iterations_since_restore": 24, "perf": {"cpu_util_percent": 27.662499999999998, "ram_util_percent": 78.525}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 2.2e-05, "entropy_coeff": 0.1, "policy_entropy": -926.687744140625, "policy_loss": -3.4563259880682292e+16, "vf_loss": 1100791680.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 618.0, "diff_num_grad_updates_vs_sampler_policy": 617.0}}, "num_env_steps_sampled": 44640, "num_env_steps_trained": 44640, "num_agent_steps_sampled": 44640, "num_agent_steps_trained": 44640}, "sampler_results": {"episode_reward_max": -25450.449219021648, "episode_reward_min": -26099.42399150872, "episode_reward_mean": -25733.00807153527, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-25734.83061046133, -25844.28041359334, -25635.44875060622, -25803.193126233928, -25663.826963650325, -25802.505894538343, -25696.01838045785, -25481.06001408537, -26099.42399150872, -25669.070720236832, -25574.459522488956, -25661.384923105496, -25628.895882615365, -25692.711051277838, -25530.484442847315, -25739.569920149836, -25575.22608879392, -25806.46826871708, -26030.406526650026, -25762.396464165115, -25472.808615743124, -25512.665211606723, -25694.924278548217, -25700.022311652854, -25610.877586351526, -25766.714040352563, -25633.132008411972, -25910.175594312626, -25714.65018026558, -25792.327418101308, -25778.692984522557, -26007.63610235267, -25675.403200363275, -25552.72024906665, -25629.20175874157, -25809.535388943135, -25818.56046598507, -25878.391237373035, -25570.150043400514, -25794.707688705443, -25857.340110996713, -25560.244690377833, -25892.030930636447, -25948.775583705134, -25540.974212054138, -25702.090137226263, -25690.626525256663, -25693.172602679162, -25607.345925140522, -25690.98896196435, -25803.890518293992, -25734.94249507384, -25744.72705686407, -25770.29113828817, -25633.526479834145, -25763.380903443955, -25994.644736679224, -25562.739129391666, -25809.002674179115, -25691.99106312291, -25536.953614818452, -26089.458519239386, -25728.991995568085, -25743.012710942498, -25731.19233485226, -25635.56251138054, -25555.852056140535, -25960.016379683682, -25775.473635270748, -25600.72208017551, -25739.55659743875, -25725.58944046207, -25968.460313317206, -25552.31023615267, -25826.14338231702, -25851.657935559237, -25870.772929873903, -25857.31829782494, -25725.81508575221, -25849.753606671016, -25774.36638573008, -25750.61390274705, -25795.093836279437, -25607.763441825202, -25816.06928490739, -26032.52816587912, -25611.90048073366, -25758.81026738292, -25818.19909581026, -26021.667527199745, -25469.791996477663, -25662.03471436753, -25450.449219021648, -25721.838868787392, -25552.129775951857, -25781.631834194155, -25781.779352048346, -25769.891713527846, -25576.89087717169, -25775.058553851224], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.409100080754412, "mean_inference_ms": 0.24592184451342178, "mean_action_processing_ms": 0.058600654285496316, "mean_env_wait_ms": 1.521131822153178, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0024576187133789062, "StateBufferConnector_ms": 0.0018112659454345703, "ViewRequirementAgentConnector_ms": 0.0452578067779541}}, "episode_reward_max": -25450.449219021648, "episode_reward_min": -26099.42399150872, "episode_reward_mean": -25733.00807153527, "episode_len_mean": 360.0, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-25734.83061046133, -25844.28041359334, -25635.44875060622, -25803.193126233928, -25663.826963650325, -25802.505894538343, -25696.01838045785, -25481.06001408537, -26099.42399150872, -25669.070720236832, -25574.459522488956, -25661.384923105496, -25628.895882615365, -25692.711051277838, -25530.484442847315, -25739.569920149836, -25575.22608879392, -25806.46826871708, -26030.406526650026, -25762.396464165115, -25472.808615743124, -25512.665211606723, -25694.924278548217, -25700.022311652854, -25610.877586351526, -25766.714040352563, -25633.132008411972, -25910.175594312626, -25714.65018026558, -25792.327418101308, -25778.692984522557, -26007.63610235267, -25675.403200363275, -25552.72024906665, -25629.20175874157, -25809.535388943135, -25818.56046598507, -25878.391237373035, -25570.150043400514, -25794.707688705443, -25857.340110996713, -25560.244690377833, -25892.030930636447, -25948.775583705134, -25540.974212054138, -25702.090137226263, -25690.626525256663, -25693.172602679162, -25607.345925140522, -25690.98896196435, -25803.890518293992, -25734.94249507384, -25744.72705686407, -25770.29113828817, -25633.526479834145, -25763.380903443955, -25994.644736679224, -25562.739129391666, -25809.002674179115, -25691.99106312291, -25536.953614818452, -26089.458519239386, -25728.991995568085, -25743.012710942498, -25731.19233485226, -25635.56251138054, -25555.852056140535, -25960.016379683682, -25775.473635270748, -25600.72208017551, -25739.55659743875, -25725.58944046207, -25968.460313317206, -25552.31023615267, -25826.14338231702, -25851.657935559237, -25870.772929873903, -25857.31829782494, -25725.81508575221, -25849.753606671016, -25774.36638573008, -25750.61390274705, -25795.093836279437, -25607.763441825202, -25816.06928490739, -26032.52816587912, -25611.90048073366, -25758.81026738292, -25818.19909581026, -26021.667527199745, -25469.791996477663, -25662.03471436753, -25450.449219021648, -25721.838868787392, -25552.129775951857, -25781.631834194155, -25781.779352048346, -25769.891713527846, -25576.89087717169, -25775.058553851224], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.409100080754412, "mean_inference_ms": 0.24592184451342178, "mean_action_processing_ms": 0.058600654285496316, "mean_env_wait_ms": 1.521131822153178, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0024576187133789062, "StateBufferConnector_ms": 0.0018112659454345703, "ViewRequirementAgentConnector_ms": 0.0452578067779541}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 44640, "num_agent_steps_trained": 44640, "num_env_steps_sampled": 44640, "num_env_steps_trained": 44640, "num_env_steps_sampled_this_iter": 1800, "num_env_steps_trained_this_iter": 1800, "num_env_steps_sampled_throughput_per_sec": 161.60356517535902, "num_env_steps_trained_throughput_per_sec": 161.60356517535902, "timesteps_total": 44640, "num_steps_trained_this_iter": 1800, "agent_timesteps_total": 44640, "timers": {"training_iteration_time_ms": 2227.702, "sample_time_ms": 2220.28, "load_time_ms": 0.219, "load_throughput": 1642677.807, "learn_time_ms": 6.642, "learn_throughput": 54200.478, "synch_weights_time_ms": 0.527}, "counters": {"num_env_steps_sampled": 44640, "num_env_steps_trained": 44640, "num_agent_steps_sampled": 44640, "num_agent_steps_trained": 44640}, "done": false, "episodes_total": 124, "training_iteration": 25, "trial_id": "f5e97_00000", "date": "2023-07-25_17-00-32", "timestamp": 1690293632, "time_this_iter_s": 11.140443086624146, "time_total_s": 278.436532497406, "pid": 71917, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[0, 0.003], [5400, 0.001], [10800, 0.00075], [16200, 0.0005], [21600, 0.00025], [27000, 0.0001], [32400, 7.5e-05], [37800, 5e-05], [43200, 2.5e-05], [48600, 1e-05], [54000, 7.5e-06], [59400, 5e-06], [64800, 2.5e-06], [70200, 1e-06], [75600, 5e-07], [81000, 1e-07]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x304530310>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 278.436532497406, "iterations_since_restore": 25, "perf": {"cpu_util_percent": 25.23125, "ram_util_percent": 78.8625}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1.7e-05, "entropy_coeff": 0.1, "policy_entropy": -926.6877685546875, "policy_loss": -8.850146199393403e+16, "vf_loss": 1092566931.2}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 643.0, "diff_num_grad_updates_vs_sampler_policy": 642.0}}, "num_env_steps_sampled": 46440, "num_env_steps_trained": 46440, "num_agent_steps_sampled": 46440, "num_agent_steps_trained": 46440}, "sampler_results": {"episode_reward_max": -25450.449219021648, "episode_reward_min": -26099.42399150872, "episode_reward_mean": -25737.854610483228, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-25802.505894538343, -25696.01838045785, -25481.06001408537, -26099.42399150872, -25669.070720236832, -25574.459522488956, -25661.384923105496, -25628.895882615365, -25692.711051277838, -25530.484442847315, -25739.569920149836, -25575.22608879392, -25806.46826871708, -26030.406526650026, -25762.396464165115, -25472.808615743124, -25512.665211606723, -25694.924278548217, -25700.022311652854, -25610.877586351526, -25766.714040352563, -25633.132008411972, -25910.175594312626, -25714.65018026558, -25792.327418101308, -25778.692984522557, -26007.63610235267, -25675.403200363275, -25552.72024906665, -25629.20175874157, -25809.535388943135, -25818.56046598507, -25878.391237373035, -25570.150043400514, -25794.707688705443, -25857.340110996713, -25560.244690377833, -25892.030930636447, -25948.775583705134, -25540.974212054138, -25702.090137226263, -25690.626525256663, -25693.172602679162, -25607.345925140522, -25690.98896196435, -25803.890518293992, -25734.94249507384, -25744.72705686407, -25770.29113828817, -25633.526479834145, -25763.380903443955, -25994.644736679224, -25562.739129391666, -25809.002674179115, -25691.99106312291, -25536.953614818452, -26089.458519239386, -25728.991995568085, -25743.012710942498, -25731.19233485226, -25635.56251138054, -25555.852056140535, -25960.016379683682, -25775.473635270748, -25600.72208017551, -25739.55659743875, -25725.58944046207, -25968.460313317206, -25552.31023615267, -25826.14338231702, -25851.657935559237, -25870.772929873903, -25857.31829782494, -25725.81508575221, -25849.753606671016, -25774.36638573008, -25750.61390274705, -25795.093836279437, -25607.763441825202, -25816.06928490739, -26032.52816587912, -25611.90048073366, -25758.81026738292, -25818.19909581026, -26021.667527199745, -25469.791996477663, -25662.03471436753, -25450.449219021648, -25721.838868787392, -25552.129775951857, -25781.631834194155, -25781.779352048346, -25769.891713527846, -25576.89087717169, -25775.058553851224, -25724.49296241185, -25938.574078295227, -25881.009915002218, -25980.650822639815, -25641.505980991944], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.409078142411039, "mean_inference_ms": 0.24584650404095143, "mean_action_processing_ms": 0.058583797400067486, "mean_env_wait_ms": 1.5142812235205296, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0024466514587402344, "StateBufferConnector_ms": 0.0018033981323242188, "ViewRequirementAgentConnector_ms": 0.04515480995178223}}, "episode_reward_max": -25450.449219021648, "episode_reward_min": -26099.42399150872, "episode_reward_mean": -25737.854610483228, "episode_len_mean": 360.0, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-25802.505894538343, -25696.01838045785, -25481.06001408537, -26099.42399150872, -25669.070720236832, -25574.459522488956, -25661.384923105496, -25628.895882615365, -25692.711051277838, -25530.484442847315, -25739.569920149836, -25575.22608879392, -25806.46826871708, -26030.406526650026, -25762.396464165115, -25472.808615743124, -25512.665211606723, -25694.924278548217, -25700.022311652854, -25610.877586351526, -25766.714040352563, -25633.132008411972, -25910.175594312626, -25714.65018026558, -25792.327418101308, -25778.692984522557, -26007.63610235267, -25675.403200363275, -25552.72024906665, -25629.20175874157, -25809.535388943135, -25818.56046598507, -25878.391237373035, -25570.150043400514, -25794.707688705443, -25857.340110996713, -25560.244690377833, -25892.030930636447, -25948.775583705134, -25540.974212054138, -25702.090137226263, -25690.626525256663, -25693.172602679162, -25607.345925140522, -25690.98896196435, -25803.890518293992, -25734.94249507384, -25744.72705686407, -25770.29113828817, -25633.526479834145, -25763.380903443955, -25994.644736679224, -25562.739129391666, -25809.002674179115, -25691.99106312291, -25536.953614818452, -26089.458519239386, -25728.991995568085, -25743.012710942498, -25731.19233485226, -25635.56251138054, -25555.852056140535, -25960.016379683682, -25775.473635270748, -25600.72208017551, -25739.55659743875, -25725.58944046207, -25968.460313317206, -25552.31023615267, -25826.14338231702, -25851.657935559237, -25870.772929873903, -25857.31829782494, -25725.81508575221, -25849.753606671016, -25774.36638573008, -25750.61390274705, -25795.093836279437, -25607.763441825202, -25816.06928490739, -26032.52816587912, -25611.90048073366, -25758.81026738292, -25818.19909581026, -26021.667527199745, -25469.791996477663, -25662.03471436753, -25450.449219021648, -25721.838868787392, -25552.129775951857, -25781.631834194155, -25781.779352048346, -25769.891713527846, -25576.89087717169, -25775.058553851224, -25724.49296241185, -25938.574078295227, -25881.009915002218, -25980.650822639815, -25641.505980991944], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.409078142411039, "mean_inference_ms": 0.24584650404095143, "mean_action_processing_ms": 0.058583797400067486, "mean_env_wait_ms": 1.5142812235205296, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0024466514587402344, "StateBufferConnector_ms": 0.0018033981323242188, "ViewRequirementAgentConnector_ms": 0.04515480995178223}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 46440, "num_agent_steps_trained": 46440, "num_env_steps_sampled": 46440, "num_env_steps_trained": 46440, "num_env_steps_sampled_this_iter": 1800, "num_env_steps_trained_this_iter": 1800, "num_env_steps_sampled_throughput_per_sec": 161.48967685988703, "num_env_steps_trained_throughput_per_sec": 161.48967685988703, "timesteps_total": 46440, "num_steps_trained_this_iter": 1800, "agent_timesteps_total": 46440, "timers": {"training_iteration_time_ms": 2228.449, "sample_time_ms": 2221.088, "load_time_ms": 0.22, "load_throughput": 1637866.84, "learn_time_ms": 6.589, "learn_throughput": 54635.466, "synch_weights_time_ms": 0.52}, "counters": {"num_env_steps_sampled": 46440, "num_env_steps_trained": 46440, "num_agent_steps_sampled": 46440, "num_agent_steps_trained": 46440}, "done": false, "episodes_total": 129, "training_iteration": 26, "trial_id": "f5e97_00000", "date": "2023-07-25_17-00-43", "timestamp": 1690293643, "time_this_iter_s": 11.14841604232788, "time_total_s": 289.5849485397339, "pid": 71917, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[0, 0.003], [5400, 0.001], [10800, 0.00075], [16200, 0.0005], [21600, 0.00025], [27000, 0.0001], [32400, 7.5e-05], [37800, 5e-05], [43200, 2.5e-05], [48600, 1e-05], [54000, 7.5e-06], [59400, 5e-06], [64800, 2.5e-06], [70200, 1e-06], [75600, 5e-07], [81000, 1e-07]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x304530310>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 289.5849485397339, "iterations_since_restore": 26, "perf": {"cpu_util_percent": 27.640000000000004, "ram_util_percent": 78.75333333333333}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1.2e-05, "entropy_coeff": 0.1, "policy_entropy": -926.6887573242187, "policy_loss": -1.7217359470342964e+16, "vf_loss": 1094558156.8}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 668.0, "diff_num_grad_updates_vs_sampler_policy": 667.0}}, "num_env_steps_sampled": 48240, "num_env_steps_trained": 48240, "num_agent_steps_sampled": 48240, "num_agent_steps_trained": 48240}, "sampler_results": {"episode_reward_max": -25450.449219021648, "episode_reward_min": -26089.458519239386, "episode_reward_mean": -25740.21091047372, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-25574.459522488956, -25661.384923105496, -25628.895882615365, -25692.711051277838, -25530.484442847315, -25739.569920149836, -25575.22608879392, -25806.46826871708, -26030.406526650026, -25762.396464165115, -25472.808615743124, -25512.665211606723, -25694.924278548217, -25700.022311652854, -25610.877586351526, -25766.714040352563, -25633.132008411972, -25910.175594312626, -25714.65018026558, -25792.327418101308, -25778.692984522557, -26007.63610235267, -25675.403200363275, -25552.72024906665, -25629.20175874157, -25809.535388943135, -25818.56046598507, -25878.391237373035, -25570.150043400514, -25794.707688705443, -25857.340110996713, -25560.244690377833, -25892.030930636447, -25948.775583705134, -25540.974212054138, -25702.090137226263, -25690.626525256663, -25693.172602679162, -25607.345925140522, -25690.98896196435, -25803.890518293992, -25734.94249507384, -25744.72705686407, -25770.29113828817, -25633.526479834145, -25763.380903443955, -25994.644736679224, -25562.739129391666, -25809.002674179115, -25691.99106312291, -25536.953614818452, -26089.458519239386, -25728.991995568085, -25743.012710942498, -25731.19233485226, -25635.56251138054, -25555.852056140535, -25960.016379683682, -25775.473635270748, -25600.72208017551, -25739.55659743875, -25725.58944046207, -25968.460313317206, -25552.31023615267, -25826.14338231702, -25851.657935559237, -25870.772929873903, -25857.31829782494, -25725.81508575221, -25849.753606671016, -25774.36638573008, -25750.61390274705, -25795.093836279437, -25607.763441825202, -25816.06928490739, -26032.52816587912, -25611.90048073366, -25758.81026738292, -25818.19909581026, -26021.667527199745, -25469.791996477663, -25662.03471436753, -25450.449219021648, -25721.838868787392, -25552.129775951857, -25781.631834194155, -25781.779352048346, -25769.891713527846, -25576.89087717169, -25775.058553851224, -25724.49296241185, -25938.574078295227, -25881.009915002218, -25980.650822639815, -25641.505980991944, -25657.719780325508, -25696.245921458067, -25920.578145431282, -26037.82700757382, -25671.338145087437], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.40911800816582, "mean_inference_ms": 0.24579181814732962, "mean_action_processing_ms": 0.058571476452213014, "mean_env_wait_ms": 1.508742507516258, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002437114715576172, "StateBufferConnector_ms": 0.0017960071563720703, "ViewRequirementAgentConnector_ms": 0.04510307312011719}}, "episode_reward_max": -25450.449219021648, "episode_reward_min": -26089.458519239386, "episode_reward_mean": -25740.21091047372, "episode_len_mean": 360.0, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-25574.459522488956, -25661.384923105496, -25628.895882615365, -25692.711051277838, -25530.484442847315, -25739.569920149836, -25575.22608879392, -25806.46826871708, -26030.406526650026, -25762.396464165115, -25472.808615743124, -25512.665211606723, -25694.924278548217, -25700.022311652854, -25610.877586351526, -25766.714040352563, -25633.132008411972, -25910.175594312626, -25714.65018026558, -25792.327418101308, -25778.692984522557, -26007.63610235267, -25675.403200363275, -25552.72024906665, -25629.20175874157, -25809.535388943135, -25818.56046598507, -25878.391237373035, -25570.150043400514, -25794.707688705443, -25857.340110996713, -25560.244690377833, -25892.030930636447, -25948.775583705134, -25540.974212054138, -25702.090137226263, -25690.626525256663, -25693.172602679162, -25607.345925140522, -25690.98896196435, -25803.890518293992, -25734.94249507384, -25744.72705686407, -25770.29113828817, -25633.526479834145, -25763.380903443955, -25994.644736679224, -25562.739129391666, -25809.002674179115, -25691.99106312291, -25536.953614818452, -26089.458519239386, -25728.991995568085, -25743.012710942498, -25731.19233485226, -25635.56251138054, -25555.852056140535, -25960.016379683682, -25775.473635270748, -25600.72208017551, -25739.55659743875, -25725.58944046207, -25968.460313317206, -25552.31023615267, -25826.14338231702, -25851.657935559237, -25870.772929873903, -25857.31829782494, -25725.81508575221, -25849.753606671016, -25774.36638573008, -25750.61390274705, -25795.093836279437, -25607.763441825202, -25816.06928490739, -26032.52816587912, -25611.90048073366, -25758.81026738292, -25818.19909581026, -26021.667527199745, -25469.791996477663, -25662.03471436753, -25450.449219021648, -25721.838868787392, -25552.129775951857, -25781.631834194155, -25781.779352048346, -25769.891713527846, -25576.89087717169, -25775.058553851224, -25724.49296241185, -25938.574078295227, -25881.009915002218, -25980.650822639815, -25641.505980991944, -25657.719780325508, -25696.245921458067, -25920.578145431282, -26037.82700757382, -25671.338145087437], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.40911800816582, "mean_inference_ms": 0.24579181814732962, "mean_action_processing_ms": 0.058571476452213014, "mean_env_wait_ms": 1.508742507516258, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002437114715576172, "StateBufferConnector_ms": 0.0017960071563720703, "ViewRequirementAgentConnector_ms": 0.04510307312011719}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 48240, "num_agent_steps_trained": 48240, "num_env_steps_sampled": 48240, "num_env_steps_trained": 48240, "num_env_steps_sampled_this_iter": 1800, "num_env_steps_trained_this_iter": 1800, "num_env_steps_sampled_throughput_per_sec": 160.32315775250325, "num_env_steps_trained_throughput_per_sec": 160.32315775250325, "timesteps_total": 48240, "num_steps_trained_this_iter": 1800, "agent_timesteps_total": 48240, "timers": {"training_iteration_time_ms": 2237.345, "sample_time_ms": 2229.874, "load_time_ms": 0.239, "load_throughput": 1507085.977, "learn_time_ms": 6.656, "learn_throughput": 54087.095, "synch_weights_time_ms": 0.543}, "counters": {"num_env_steps_sampled": 48240, "num_env_steps_trained": 48240, "num_agent_steps_sampled": 48240, "num_agent_steps_trained": 48240}, "done": false, "episodes_total": 134, "training_iteration": 27, "trial_id": "f5e97_00000", "date": "2023-07-25_17-00-54", "timestamp": 1690293654, "time_this_iter_s": 11.229460954666138, "time_total_s": 300.8144094944, "pid": 71917, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[0, 0.003], [5400, 0.001], [10800, 0.00075], [16200, 0.0005], [21600, 0.00025], [27000, 0.0001], [32400, 7.5e-05], [37800, 5e-05], [43200, 2.5e-05], [48600, 1e-05], [54000, 7.5e-06], [59400, 5e-06], [64800, 2.5e-06], [70200, 1e-06], [75600, 5e-07], [81000, 1e-07]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x304530310>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 300.8144094944, "iterations_since_restore": 27, "perf": {"cpu_util_percent": 25.28125, "ram_util_percent": 80.06875}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 9.5e-06, "entropy_coeff": 0.1, "policy_entropy": -926.6899169921875, "policy_loss": -5.720747403480597e+16, "vf_loss": 1082147584.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 693.0, "diff_num_grad_updates_vs_sampler_policy": 692.0}}, "num_env_steps_sampled": 50040, "num_env_steps_trained": 50040, "num_agent_steps_sampled": 50040, "num_agent_steps_trained": 50040}, "sampler_results": {"episode_reward_max": -25450.449219021648, "episode_reward_min": -26089.458519239386, "episode_reward_mean": -25740.882270583552, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-25739.569920149836, -25575.22608879392, -25806.46826871708, -26030.406526650026, -25762.396464165115, -25472.808615743124, -25512.665211606723, -25694.924278548217, -25700.022311652854, -25610.877586351526, -25766.714040352563, -25633.132008411972, -25910.175594312626, -25714.65018026558, -25792.327418101308, -25778.692984522557, -26007.63610235267, -25675.403200363275, -25552.72024906665, -25629.20175874157, -25809.535388943135, -25818.56046598507, -25878.391237373035, -25570.150043400514, -25794.707688705443, -25857.340110996713, -25560.244690377833, -25892.030930636447, -25948.775583705134, -25540.974212054138, -25702.090137226263, -25690.626525256663, -25693.172602679162, -25607.345925140522, -25690.98896196435, -25803.890518293992, -25734.94249507384, -25744.72705686407, -25770.29113828817, -25633.526479834145, -25763.380903443955, -25994.644736679224, -25562.739129391666, -25809.002674179115, -25691.99106312291, -25536.953614818452, -26089.458519239386, -25728.991995568085, -25743.012710942498, -25731.19233485226, -25635.56251138054, -25555.852056140535, -25960.016379683682, -25775.473635270748, -25600.72208017551, -25739.55659743875, -25725.58944046207, -25968.460313317206, -25552.31023615267, -25826.14338231702, -25851.657935559237, -25870.772929873903, -25857.31829782494, -25725.81508575221, -25849.753606671016, -25774.36638573008, -25750.61390274705, -25795.093836279437, -25607.763441825202, -25816.06928490739, -26032.52816587912, -25611.90048073366, -25758.81026738292, -25818.19909581026, -26021.667527199745, -25469.791996477663, -25662.03471436753, -25450.449219021648, -25721.838868787392, -25552.129775951857, -25781.631834194155, -25781.779352048346, -25769.891713527846, -25576.89087717169, -25775.058553851224, -25724.49296241185, -25938.574078295227, -25881.009915002218, -25980.650822639815, -25641.505980991944, -25657.719780325508, -25696.245921458067, -25920.578145431282, -26037.82700757382, -25671.338145087437, -25721.578692764626, -25656.373507476896, -25571.601382625424, -25668.30631840905, -25537.21193204283], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.409078191106309, "mean_inference_ms": 0.24575503692655803, "mean_action_processing_ms": 0.058562797728266835, "mean_env_wait_ms": 1.5041091261607342, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0024526119232177734, "StateBufferConnector_ms": 0.001796722412109375, "ViewRequirementAgentConnector_ms": 0.04525899887084961}}, "episode_reward_max": -25450.449219021648, "episode_reward_min": -26089.458519239386, "episode_reward_mean": -25740.882270583552, "episode_len_mean": 360.0, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-25739.569920149836, -25575.22608879392, -25806.46826871708, -26030.406526650026, -25762.396464165115, -25472.808615743124, -25512.665211606723, -25694.924278548217, -25700.022311652854, -25610.877586351526, -25766.714040352563, -25633.132008411972, -25910.175594312626, -25714.65018026558, -25792.327418101308, -25778.692984522557, -26007.63610235267, -25675.403200363275, -25552.72024906665, -25629.20175874157, -25809.535388943135, -25818.56046598507, -25878.391237373035, -25570.150043400514, -25794.707688705443, -25857.340110996713, -25560.244690377833, -25892.030930636447, -25948.775583705134, -25540.974212054138, -25702.090137226263, -25690.626525256663, -25693.172602679162, -25607.345925140522, -25690.98896196435, -25803.890518293992, -25734.94249507384, -25744.72705686407, -25770.29113828817, -25633.526479834145, -25763.380903443955, -25994.644736679224, -25562.739129391666, -25809.002674179115, -25691.99106312291, -25536.953614818452, -26089.458519239386, -25728.991995568085, -25743.012710942498, -25731.19233485226, -25635.56251138054, -25555.852056140535, -25960.016379683682, -25775.473635270748, -25600.72208017551, -25739.55659743875, -25725.58944046207, -25968.460313317206, -25552.31023615267, -25826.14338231702, -25851.657935559237, -25870.772929873903, -25857.31829782494, -25725.81508575221, -25849.753606671016, -25774.36638573008, -25750.61390274705, -25795.093836279437, -25607.763441825202, -25816.06928490739, -26032.52816587912, -25611.90048073366, -25758.81026738292, -25818.19909581026, -26021.667527199745, -25469.791996477663, -25662.03471436753, -25450.449219021648, -25721.838868787392, -25552.129775951857, -25781.631834194155, -25781.779352048346, -25769.891713527846, -25576.89087717169, -25775.058553851224, -25724.49296241185, -25938.574078295227, -25881.009915002218, -25980.650822639815, -25641.505980991944, -25657.719780325508, -25696.245921458067, -25920.578145431282, -26037.82700757382, -25671.338145087437, -25721.578692764626, -25656.373507476896, -25571.601382625424, -25668.30631840905, -25537.21193204283], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.409078191106309, "mean_inference_ms": 0.24575503692655803, "mean_action_processing_ms": 0.058562797728266835, "mean_env_wait_ms": 1.5041091261607342, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0024526119232177734, "StateBufferConnector_ms": 0.001796722412109375, "ViewRequirementAgentConnector_ms": 0.04525899887084961}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 50040, "num_agent_steps_trained": 50040, "num_env_steps_sampled": 50040, "num_env_steps_trained": 50040, "num_env_steps_sampled_this_iter": 1800, "num_env_steps_trained_this_iter": 1800, "num_env_steps_sampled_throughput_per_sec": 161.8494970513893, "num_env_steps_trained_throughput_per_sec": 161.8494970513893, "timesteps_total": 50040, "num_steps_trained_this_iter": 1800, "agent_timesteps_total": 50040, "timers": {"training_iteration_time_ms": 2234.867, "sample_time_ms": 2227.531, "load_time_ms": 0.235, "load_throughput": 1528753.103, "learn_time_ms": 6.524, "learn_throughput": 55177.724, "synch_weights_time_ms": 0.543}, "counters": {"num_env_steps_sampled": 50040, "num_env_steps_trained": 50040, "num_agent_steps_sampled": 50040, "num_agent_steps_trained": 50040}, "done": false, "episodes_total": 139, "training_iteration": 28, "trial_id": "f5e97_00000", "date": "2023-07-25_17-01-05", "timestamp": 1690293665, "time_this_iter_s": 11.12353515625, "time_total_s": 311.93794465065, "pid": 71917, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[0, 0.003], [5400, 0.001], [10800, 0.00075], [16200, 0.0005], [21600, 0.00025], [27000, 0.0001], [32400, 7.5e-05], [37800, 5e-05], [43200, 2.5e-05], [48600, 1e-05], [54000, 7.5e-06], [59400, 5e-06], [64800, 2.5e-06], [70200, 1e-06], [75600, 5e-07], [81000, 1e-07]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x304530310>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 311.93794465065, "iterations_since_restore": 28, "perf": {"cpu_util_percent": 24.231250000000003, "ram_util_percent": 79.0375}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 8.666666666666668e-06, "entropy_coeff": 0.1, "policy_entropy": -926.6903686523438, "policy_loss": -1.5884210587408794e+16, "vf_loss": 1079158515.2}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 718.0, "diff_num_grad_updates_vs_sampler_policy": 717.0}}, "num_env_steps_sampled": 51840, "num_env_steps_trained": 51840, "num_agent_steps_sampled": 51840, "num_agent_steps_trained": 51840}, "sampler_results": {"episode_reward_max": -25450.449219021648, "episode_reward_min": -26089.458519239386, "episode_reward_mean": -25742.025622339672, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-25472.808615743124, -25512.665211606723, -25694.924278548217, -25700.022311652854, -25610.877586351526, -25766.714040352563, -25633.132008411972, -25910.175594312626, -25714.65018026558, -25792.327418101308, -25778.692984522557, -26007.63610235267, -25675.403200363275, -25552.72024906665, -25629.20175874157, -25809.535388943135, -25818.56046598507, -25878.391237373035, -25570.150043400514, -25794.707688705443, -25857.340110996713, -25560.244690377833, -25892.030930636447, -25948.775583705134, -25540.974212054138, -25702.090137226263, -25690.626525256663, -25693.172602679162, -25607.345925140522, -25690.98896196435, -25803.890518293992, -25734.94249507384, -25744.72705686407, -25770.29113828817, -25633.526479834145, -25763.380903443955, -25994.644736679224, -25562.739129391666, -25809.002674179115, -25691.99106312291, -25536.953614818452, -26089.458519239386, -25728.991995568085, -25743.012710942498, -25731.19233485226, -25635.56251138054, -25555.852056140535, -25960.016379683682, -25775.473635270748, -25600.72208017551, -25739.55659743875, -25725.58944046207, -25968.460313317206, -25552.31023615267, -25826.14338231702, -25851.657935559237, -25870.772929873903, -25857.31829782494, -25725.81508575221, -25849.753606671016, -25774.36638573008, -25750.61390274705, -25795.093836279437, -25607.763441825202, -25816.06928490739, -26032.52816587912, -25611.90048073366, -25758.81026738292, -25818.19909581026, -26021.667527199745, -25469.791996477663, -25662.03471436753, -25450.449219021648, -25721.838868787392, -25552.129775951857, -25781.631834194155, -25781.779352048346, -25769.891713527846, -25576.89087717169, -25775.058553851224, -25724.49296241185, -25938.574078295227, -25881.009915002218, -25980.650822639815, -25641.505980991944, -25657.719780325508, -25696.245921458067, -25920.578145431282, -26037.82700757382, -25671.338145087437, -25721.578692764626, -25656.373507476896, -25571.601382625424, -25668.30631840905, -25537.21193204283, -26026.414440841196, -25750.765021518066, -25888.63987625073, -25759.592285610575, -25602.9908198676], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.408737654416759, "mean_inference_ms": 0.2457225587854762, "mean_action_processing_ms": 0.05855369463793623, "mean_env_wait_ms": 1.5000791440214536, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002454042434692383, "StateBufferConnector_ms": 0.0018131732940673828, "ViewRequirementAgentConnector_ms": 0.04533267021179199}}, "episode_reward_max": -25450.449219021648, "episode_reward_min": -26089.458519239386, "episode_reward_mean": -25742.025622339672, "episode_len_mean": 360.0, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-25472.808615743124, -25512.665211606723, -25694.924278548217, -25700.022311652854, -25610.877586351526, -25766.714040352563, -25633.132008411972, -25910.175594312626, -25714.65018026558, -25792.327418101308, -25778.692984522557, -26007.63610235267, -25675.403200363275, -25552.72024906665, -25629.20175874157, -25809.535388943135, -25818.56046598507, -25878.391237373035, -25570.150043400514, -25794.707688705443, -25857.340110996713, -25560.244690377833, -25892.030930636447, -25948.775583705134, -25540.974212054138, -25702.090137226263, -25690.626525256663, -25693.172602679162, -25607.345925140522, -25690.98896196435, -25803.890518293992, -25734.94249507384, -25744.72705686407, -25770.29113828817, -25633.526479834145, -25763.380903443955, -25994.644736679224, -25562.739129391666, -25809.002674179115, -25691.99106312291, -25536.953614818452, -26089.458519239386, -25728.991995568085, -25743.012710942498, -25731.19233485226, -25635.56251138054, -25555.852056140535, -25960.016379683682, -25775.473635270748, -25600.72208017551, -25739.55659743875, -25725.58944046207, -25968.460313317206, -25552.31023615267, -25826.14338231702, -25851.657935559237, -25870.772929873903, -25857.31829782494, -25725.81508575221, -25849.753606671016, -25774.36638573008, -25750.61390274705, -25795.093836279437, -25607.763441825202, -25816.06928490739, -26032.52816587912, -25611.90048073366, -25758.81026738292, -25818.19909581026, -26021.667527199745, -25469.791996477663, -25662.03471436753, -25450.449219021648, -25721.838868787392, -25552.129775951857, -25781.631834194155, -25781.779352048346, -25769.891713527846, -25576.89087717169, -25775.058553851224, -25724.49296241185, -25938.574078295227, -25881.009915002218, -25980.650822639815, -25641.505980991944, -25657.719780325508, -25696.245921458067, -25920.578145431282, -26037.82700757382, -25671.338145087437, -25721.578692764626, -25656.373507476896, -25571.601382625424, -25668.30631840905, -25537.21193204283, -26026.414440841196, -25750.765021518066, -25888.63987625073, -25759.592285610575, -25602.9908198676], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.408737654416759, "mean_inference_ms": 0.2457225587854762, "mean_action_processing_ms": 0.05855369463793623, "mean_env_wait_ms": 1.5000791440214536, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002454042434692383, "StateBufferConnector_ms": 0.0018131732940673828, "ViewRequirementAgentConnector_ms": 0.04533267021179199}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 51840, "num_agent_steps_trained": 51840, "num_env_steps_sampled": 51840, "num_env_steps_trained": 51840, "num_env_steps_sampled_this_iter": 1800, "num_env_steps_trained_this_iter": 1800, "num_env_steps_sampled_throughput_per_sec": 163.60251362551193, "num_env_steps_trained_throughput_per_sec": 163.60251362551193, "timesteps_total": 51840, "num_steps_trained_this_iter": 1800, "agent_timesteps_total": 51840, "timers": {"training_iteration_time_ms": 2212.361, "sample_time_ms": 2204.891, "load_time_ms": 0.223, "load_throughput": 1613021.515, "learn_time_ms": 6.645, "learn_throughput": 54176.364, "synch_weights_time_ms": 0.569}, "counters": {"num_env_steps_sampled": 51840, "num_env_steps_trained": 51840, "num_agent_steps_sampled": 51840, "num_agent_steps_trained": 51840}, "done": false, "episodes_total": 144, "training_iteration": 29, "trial_id": "f5e97_00000", "date": "2023-07-25_17-01-16", "timestamp": 1690293676, "time_this_iter_s": 11.004339933395386, "time_total_s": 322.9422845840454, "pid": 71917, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[0, 0.003], [5400, 0.001], [10800, 0.00075], [16200, 0.0005], [21600, 0.00025], [27000, 0.0001], [32400, 7.5e-05], [37800, 5e-05], [43200, 2.5e-05], [48600, 1e-05], [54000, 7.5e-06], [59400, 5e-06], [64800, 2.5e-06], [70200, 1e-06], [75600, 5e-07], [81000, 1e-07]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x304530310>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 322.9422845840454, "iterations_since_restore": 29, "perf": {"cpu_util_percent": 23.643749999999997, "ram_util_percent": 77.78125}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 7.833333333333333e-06, "entropy_coeff": 0.1, "policy_entropy": -926.691015625, "policy_loss": -3048781046802022.5, "vf_loss": 1065639174.4}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 743.0, "diff_num_grad_updates_vs_sampler_policy": 742.0}}, "num_env_steps_sampled": 53640, "num_env_steps_trained": 53640, "num_agent_steps_sampled": 53640, "num_agent_steps_trained": 53640}, "sampler_results": {"episode_reward_max": -25394.76801455681, "episode_reward_min": -26089.458519239386, "episode_reward_mean": -25746.4423950997, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-25766.714040352563, -25633.132008411972, -25910.175594312626, -25714.65018026558, -25792.327418101308, -25778.692984522557, -26007.63610235267, -25675.403200363275, -25552.72024906665, -25629.20175874157, -25809.535388943135, -25818.56046598507, -25878.391237373035, -25570.150043400514, -25794.707688705443, -25857.340110996713, -25560.244690377833, -25892.030930636447, -25948.775583705134, -25540.974212054138, -25702.090137226263, -25690.626525256663, -25693.172602679162, -25607.345925140522, -25690.98896196435, -25803.890518293992, -25734.94249507384, -25744.72705686407, -25770.29113828817, -25633.526479834145, -25763.380903443955, -25994.644736679224, -25562.739129391666, -25809.002674179115, -25691.99106312291, -25536.953614818452, -26089.458519239386, -25728.991995568085, -25743.012710942498, -25731.19233485226, -25635.56251138054, -25555.852056140535, -25960.016379683682, -25775.473635270748, -25600.72208017551, -25739.55659743875, -25725.58944046207, -25968.460313317206, -25552.31023615267, -25826.14338231702, -25851.657935559237, -25870.772929873903, -25857.31829782494, -25725.81508575221, -25849.753606671016, -25774.36638573008, -25750.61390274705, -25795.093836279437, -25607.763441825202, -25816.06928490739, -26032.52816587912, -25611.90048073366, -25758.81026738292, -25818.19909581026, -26021.667527199745, -25469.791996477663, -25662.03471436753, -25450.449219021648, -25721.838868787392, -25552.129775951857, -25781.631834194155, -25781.779352048346, -25769.891713527846, -25576.89087717169, -25775.058553851224, -25724.49296241185, -25938.574078295227, -25881.009915002218, -25980.650822639815, -25641.505980991944, -25657.719780325508, -25696.245921458067, -25920.578145431282, -26037.82700757382, -25671.338145087437, -25721.578692764626, -25656.373507476896, -25571.601382625424, -25668.30631840905, -25537.21193204283, -26026.414440841196, -25750.765021518066, -25888.63987625073, -25759.592285610575, -25602.9908198676, -25917.72251357423, -25625.738540594783, -25728.07455428508, -25766.671656894046, -25394.76801455681], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.408474575655512, "mean_inference_ms": 0.24570079865755454, "mean_action_processing_ms": 0.05854664407203008, "mean_env_wait_ms": 1.4964134339436748, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0024428367614746094, "StateBufferConnector_ms": 0.0018088817596435547, "ViewRequirementAgentConnector_ms": 0.0452578067779541}}, "episode_reward_max": -25394.76801455681, "episode_reward_min": -26089.458519239386, "episode_reward_mean": -25746.4423950997, "episode_len_mean": 360.0, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-25766.714040352563, -25633.132008411972, -25910.175594312626, -25714.65018026558, -25792.327418101308, -25778.692984522557, -26007.63610235267, -25675.403200363275, -25552.72024906665, -25629.20175874157, -25809.535388943135, -25818.56046598507, -25878.391237373035, -25570.150043400514, -25794.707688705443, -25857.340110996713, -25560.244690377833, -25892.030930636447, -25948.775583705134, -25540.974212054138, -25702.090137226263, -25690.626525256663, -25693.172602679162, -25607.345925140522, -25690.98896196435, -25803.890518293992, -25734.94249507384, -25744.72705686407, -25770.29113828817, -25633.526479834145, -25763.380903443955, -25994.644736679224, -25562.739129391666, -25809.002674179115, -25691.99106312291, -25536.953614818452, -26089.458519239386, -25728.991995568085, -25743.012710942498, -25731.19233485226, -25635.56251138054, -25555.852056140535, -25960.016379683682, -25775.473635270748, -25600.72208017551, -25739.55659743875, -25725.58944046207, -25968.460313317206, -25552.31023615267, -25826.14338231702, -25851.657935559237, -25870.772929873903, -25857.31829782494, -25725.81508575221, -25849.753606671016, -25774.36638573008, -25750.61390274705, -25795.093836279437, -25607.763441825202, -25816.06928490739, -26032.52816587912, -25611.90048073366, -25758.81026738292, -25818.19909581026, -26021.667527199745, -25469.791996477663, -25662.03471436753, -25450.449219021648, -25721.838868787392, -25552.129775951857, -25781.631834194155, -25781.779352048346, -25769.891713527846, -25576.89087717169, -25775.058553851224, -25724.49296241185, -25938.574078295227, -25881.009915002218, -25980.650822639815, -25641.505980991944, -25657.719780325508, -25696.245921458067, -25920.578145431282, -26037.82700757382, -25671.338145087437, -25721.578692764626, -25656.373507476896, -25571.601382625424, -25668.30631840905, -25537.21193204283, -26026.414440841196, -25750.765021518066, -25888.63987625073, -25759.592285610575, -25602.9908198676, -25917.72251357423, -25625.738540594783, -25728.07455428508, -25766.671656894046, -25394.76801455681], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.408474575655512, "mean_inference_ms": 0.24570079865755454, "mean_action_processing_ms": 0.05854664407203008, "mean_env_wait_ms": 1.4964134339436748, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0024428367614746094, "StateBufferConnector_ms": 0.0018088817596435547, "ViewRequirementAgentConnector_ms": 0.0452578067779541}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 53640, "num_agent_steps_trained": 53640, "num_env_steps_sampled": 53640, "num_env_steps_trained": 53640, "num_env_steps_sampled_this_iter": 1800, "num_env_steps_trained_this_iter": 1800, "num_env_steps_sampled_throughput_per_sec": 162.8009252146214, "num_env_steps_trained_throughput_per_sec": 162.8009252146214, "timesteps_total": 53640, "num_steps_trained_this_iter": 1800, "agent_timesteps_total": 53640, "timers": {"training_iteration_time_ms": 2205.862, "sample_time_ms": 2198.541, "load_time_ms": 0.222, "load_throughput": 1623601.548, "learn_time_ms": 6.508, "learn_throughput": 55319.027, "synch_weights_time_ms": 0.558}, "counters": {"num_env_steps_sampled": 53640, "num_env_steps_trained": 53640, "num_agent_steps_sampled": 53640, "num_agent_steps_trained": 53640}, "done": false, "episodes_total": 149, "training_iteration": 30, "trial_id": "f5e97_00000", "date": "2023-07-25_17-01-27", "timestamp": 1690293687, "time_this_iter_s": 11.058480739593506, "time_total_s": 334.0007653236389, "pid": 71917, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[0, 0.003], [5400, 0.001], [10800, 0.00075], [16200, 0.0005], [21600, 0.00025], [27000, 0.0001], [32400, 7.5e-05], [37800, 5e-05], [43200, 2.5e-05], [48600, 1e-05], [54000, 7.5e-06], [59400, 5e-06], [64800, 2.5e-06], [70200, 1e-06], [75600, 5e-07], [81000, 1e-07]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x304530310>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 334.0007653236389, "iterations_since_restore": 30, "perf": {"cpu_util_percent": 29.153333333333332, "ram_util_percent": 78.18}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 6.999999999999999e-06, "entropy_coeff": 0.1, "policy_entropy": -926.6908203125, "policy_loss": -1.436743844757504e+16, "vf_loss": 1088058118.4}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 768.0, "diff_num_grad_updates_vs_sampler_policy": 767.0}}, "num_env_steps_sampled": 55440, "num_env_steps_trained": 55440, "num_agent_steps_sampled": 55440, "num_agent_steps_trained": 55440}, "sampler_results": {"episode_reward_max": -25394.76801455681, "episode_reward_min": -26089.458519239386, "episode_reward_mean": -25741.018483805034, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-25778.692984522557, -26007.63610235267, -25675.403200363275, -25552.72024906665, -25629.20175874157, -25809.535388943135, -25818.56046598507, -25878.391237373035, -25570.150043400514, -25794.707688705443, -25857.340110996713, -25560.244690377833, -25892.030930636447, -25948.775583705134, -25540.974212054138, -25702.090137226263, -25690.626525256663, -25693.172602679162, -25607.345925140522, -25690.98896196435, -25803.890518293992, -25734.94249507384, -25744.72705686407, -25770.29113828817, -25633.526479834145, -25763.380903443955, -25994.644736679224, -25562.739129391666, -25809.002674179115, -25691.99106312291, -25536.953614818452, -26089.458519239386, -25728.991995568085, -25743.012710942498, -25731.19233485226, -25635.56251138054, -25555.852056140535, -25960.016379683682, -25775.473635270748, -25600.72208017551, -25739.55659743875, -25725.58944046207, -25968.460313317206, -25552.31023615267, -25826.14338231702, -25851.657935559237, -25870.772929873903, -25857.31829782494, -25725.81508575221, -25849.753606671016, -25774.36638573008, -25750.61390274705, -25795.093836279437, -25607.763441825202, -25816.06928490739, -26032.52816587912, -25611.90048073366, -25758.81026738292, -25818.19909581026, -26021.667527199745, -25469.791996477663, -25662.03471436753, -25450.449219021648, -25721.838868787392, -25552.129775951857, -25781.631834194155, -25781.779352048346, -25769.891713527846, -25576.89087717169, -25775.058553851224, -25724.49296241185, -25938.574078295227, -25881.009915002218, -25980.650822639815, -25641.505980991944, -25657.719780325508, -25696.245921458067, -25920.578145431282, -26037.82700757382, -25671.338145087437, -25721.578692764626, -25656.373507476896, -25571.601382625424, -25668.30631840905, -25537.21193204283, -26026.414440841196, -25750.765021518066, -25888.63987625073, -25759.592285610575, -25602.9908198676, -25917.72251357423, -25625.738540594783, -25728.07455428508, -25766.671656894046, -25394.76801455681, -25524.319504516105, -25695.237048209357, -25443.608011136792, -25990.957539052048, -25620.486009063137], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.408081975483821, "mean_inference_ms": 0.24567821616687419, "mean_action_processing_ms": 0.05853868187969247, "mean_env_wait_ms": 1.4932355137228857, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002446889877319336, "StateBufferConnector_ms": 0.0018198490142822266, "ViewRequirementAgentConnector_ms": 0.04538464546203613}}, "episode_reward_max": -25394.76801455681, "episode_reward_min": -26089.458519239386, "episode_reward_mean": -25741.018483805034, "episode_len_mean": 360.0, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-25778.692984522557, -26007.63610235267, -25675.403200363275, -25552.72024906665, -25629.20175874157, -25809.535388943135, -25818.56046598507, -25878.391237373035, -25570.150043400514, -25794.707688705443, -25857.340110996713, -25560.244690377833, -25892.030930636447, -25948.775583705134, -25540.974212054138, -25702.090137226263, -25690.626525256663, -25693.172602679162, -25607.345925140522, -25690.98896196435, -25803.890518293992, -25734.94249507384, -25744.72705686407, -25770.29113828817, -25633.526479834145, -25763.380903443955, -25994.644736679224, -25562.739129391666, -25809.002674179115, -25691.99106312291, -25536.953614818452, -26089.458519239386, -25728.991995568085, -25743.012710942498, -25731.19233485226, -25635.56251138054, -25555.852056140535, -25960.016379683682, -25775.473635270748, -25600.72208017551, -25739.55659743875, -25725.58944046207, -25968.460313317206, -25552.31023615267, -25826.14338231702, -25851.657935559237, -25870.772929873903, -25857.31829782494, -25725.81508575221, -25849.753606671016, -25774.36638573008, -25750.61390274705, -25795.093836279437, -25607.763441825202, -25816.06928490739, -26032.52816587912, -25611.90048073366, -25758.81026738292, -25818.19909581026, -26021.667527199745, -25469.791996477663, -25662.03471436753, -25450.449219021648, -25721.838868787392, -25552.129775951857, -25781.631834194155, -25781.779352048346, -25769.891713527846, -25576.89087717169, -25775.058553851224, -25724.49296241185, -25938.574078295227, -25881.009915002218, -25980.650822639815, -25641.505980991944, -25657.719780325508, -25696.245921458067, -25920.578145431282, -26037.82700757382, -25671.338145087437, -25721.578692764626, -25656.373507476896, -25571.601382625424, -25668.30631840905, -25537.21193204283, -26026.414440841196, -25750.765021518066, -25888.63987625073, -25759.592285610575, -25602.9908198676, -25917.72251357423, -25625.738540594783, -25728.07455428508, -25766.671656894046, -25394.76801455681, -25524.319504516105, -25695.237048209357, -25443.608011136792, -25990.957539052048, -25620.486009063137], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.408081975483821, "mean_inference_ms": 0.24567821616687419, "mean_action_processing_ms": 0.05853868187969247, "mean_env_wait_ms": 1.4932355137228857, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002446889877319336, "StateBufferConnector_ms": 0.0018198490142822266, "ViewRequirementAgentConnector_ms": 0.04538464546203613}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 55440, "num_agent_steps_trained": 55440, "num_env_steps_sampled": 55440, "num_env_steps_trained": 55440, "num_env_steps_sampled_this_iter": 1800, "num_env_steps_trained_this_iter": 1800, "num_env_steps_sampled_throughput_per_sec": 160.67083404724295, "num_env_steps_trained_throughput_per_sec": 160.67083404724295, "timesteps_total": 55440, "num_steps_trained_this_iter": 1800, "agent_timesteps_total": 55440, "timers": {"training_iteration_time_ms": 2225.938, "sample_time_ms": 2218.818, "load_time_ms": 0.217, "load_throughput": 1657099.912, "learn_time_ms": 6.348, "learn_throughput": 56714.272, "synch_weights_time_ms": 0.523}, "counters": {"num_env_steps_sampled": 55440, "num_env_steps_trained": 55440, "num_agent_steps_sampled": 55440, "num_agent_steps_trained": 55440}, "done": false, "episodes_total": 154, "training_iteration": 31, "trial_id": "f5e97_00000", "date": "2023-07-25_17-01-39", "timestamp": 1690293699, "time_this_iter_s": 11.205248832702637, "time_total_s": 345.20601415634155, "pid": 71917, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[0, 0.003], [5400, 0.001], [10800, 0.00075], [16200, 0.0005], [21600, 0.00025], [27000, 0.0001], [32400, 7.5e-05], [37800, 5e-05], [43200, 2.5e-05], [48600, 1e-05], [54000, 7.5e-06], [59400, 5e-06], [64800, 2.5e-06], [70200, 1e-06], [75600, 5e-07], [81000, 1e-07]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x304530310>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 345.20601415634155, "iterations_since_restore": 31, "perf": {"cpu_util_percent": 32.112500000000004, "ram_util_percent": 78.49374999999999}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 6.166666666666667e-06, "entropy_coeff": 0.1, "policy_entropy": -926.6920043945313, "policy_loss": -667004002779136.0, "vf_loss": 1083623859.2}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 793.0, "diff_num_grad_updates_vs_sampler_policy": 792.0}}, "num_env_steps_sampled": 57240, "num_env_steps_trained": 57240, "num_agent_steps_sampled": 57240, "num_agent_steps_trained": 57240}, "sampler_results": {"episode_reward_max": -25394.76801455681, "episode_reward_min": -26089.458519239386, "episode_reward_mean": -25733.74037347852, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-25809.535388943135, -25818.56046598507, -25878.391237373035, -25570.150043400514, -25794.707688705443, -25857.340110996713, -25560.244690377833, -25892.030930636447, -25948.775583705134, -25540.974212054138, -25702.090137226263, -25690.626525256663, -25693.172602679162, -25607.345925140522, -25690.98896196435, -25803.890518293992, -25734.94249507384, -25744.72705686407, -25770.29113828817, -25633.526479834145, -25763.380903443955, -25994.644736679224, -25562.739129391666, -25809.002674179115, -25691.99106312291, -25536.953614818452, -26089.458519239386, -25728.991995568085, -25743.012710942498, -25731.19233485226, -25635.56251138054, -25555.852056140535, -25960.016379683682, -25775.473635270748, -25600.72208017551, -25739.55659743875, -25725.58944046207, -25968.460313317206, -25552.31023615267, -25826.14338231702, -25851.657935559237, -25870.772929873903, -25857.31829782494, -25725.81508575221, -25849.753606671016, -25774.36638573008, -25750.61390274705, -25795.093836279437, -25607.763441825202, -25816.06928490739, -26032.52816587912, -25611.90048073366, -25758.81026738292, -25818.19909581026, -26021.667527199745, -25469.791996477663, -25662.03471436753, -25450.449219021648, -25721.838868787392, -25552.129775951857, -25781.631834194155, -25781.779352048346, -25769.891713527846, -25576.89087717169, -25775.058553851224, -25724.49296241185, -25938.574078295227, -25881.009915002218, -25980.650822639815, -25641.505980991944, -25657.719780325508, -25696.245921458067, -25920.578145431282, -26037.82700757382, -25671.338145087437, -25721.578692764626, -25656.373507476896, -25571.601382625424, -25668.30631840905, -25537.21193204283, -26026.414440841196, -25750.765021518066, -25888.63987625073, -25759.592285610575, -25602.9908198676, -25917.72251357423, -25625.738540594783, -25728.07455428508, -25766.671656894046, -25394.76801455681, -25524.319504516105, -25695.237048209357, -25443.608011136792, -25990.957539052048, -25620.486009063137, -25584.920994110576, -25737.453984501746, -25486.29476159542, -25615.386595685624, -25491.78692650146], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.4077056369648915, "mean_inference_ms": 0.24565679274059626, "mean_action_processing_ms": 0.05853047527187208, "mean_env_wait_ms": 1.49039581045134, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0024421215057373047, "StateBufferConnector_ms": 0.0018243789672851562, "ViewRequirementAgentConnector_ms": 0.04536795616149902}}, "episode_reward_max": -25394.76801455681, "episode_reward_min": -26089.458519239386, "episode_reward_mean": -25733.74037347852, "episode_len_mean": 360.0, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-25809.535388943135, -25818.56046598507, -25878.391237373035, -25570.150043400514, -25794.707688705443, -25857.340110996713, -25560.244690377833, -25892.030930636447, -25948.775583705134, -25540.974212054138, -25702.090137226263, -25690.626525256663, -25693.172602679162, -25607.345925140522, -25690.98896196435, -25803.890518293992, -25734.94249507384, -25744.72705686407, -25770.29113828817, -25633.526479834145, -25763.380903443955, -25994.644736679224, -25562.739129391666, -25809.002674179115, -25691.99106312291, -25536.953614818452, -26089.458519239386, -25728.991995568085, -25743.012710942498, -25731.19233485226, -25635.56251138054, -25555.852056140535, -25960.016379683682, -25775.473635270748, -25600.72208017551, -25739.55659743875, -25725.58944046207, -25968.460313317206, -25552.31023615267, -25826.14338231702, -25851.657935559237, -25870.772929873903, -25857.31829782494, -25725.81508575221, -25849.753606671016, -25774.36638573008, -25750.61390274705, -25795.093836279437, -25607.763441825202, -25816.06928490739, -26032.52816587912, -25611.90048073366, -25758.81026738292, -25818.19909581026, -26021.667527199745, -25469.791996477663, -25662.03471436753, -25450.449219021648, -25721.838868787392, -25552.129775951857, -25781.631834194155, -25781.779352048346, -25769.891713527846, -25576.89087717169, -25775.058553851224, -25724.49296241185, -25938.574078295227, -25881.009915002218, -25980.650822639815, -25641.505980991944, -25657.719780325508, -25696.245921458067, -25920.578145431282, -26037.82700757382, -25671.338145087437, -25721.578692764626, -25656.373507476896, -25571.601382625424, -25668.30631840905, -25537.21193204283, -26026.414440841196, -25750.765021518066, -25888.63987625073, -25759.592285610575, -25602.9908198676, -25917.72251357423, -25625.738540594783, -25728.07455428508, -25766.671656894046, -25394.76801455681, -25524.319504516105, -25695.237048209357, -25443.608011136792, -25990.957539052048, -25620.486009063137, -25584.920994110576, -25737.453984501746, -25486.29476159542, -25615.386595685624, -25491.78692650146], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.4077056369648915, "mean_inference_ms": 0.24565679274059626, "mean_action_processing_ms": 0.05853047527187208, "mean_env_wait_ms": 1.49039581045134, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0024421215057373047, "StateBufferConnector_ms": 0.0018243789672851562, "ViewRequirementAgentConnector_ms": 0.04536795616149902}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 57240, "num_agent_steps_trained": 57240, "num_env_steps_sampled": 57240, "num_env_steps_trained": 57240, "num_env_steps_sampled_this_iter": 1800, "num_env_steps_trained_this_iter": 1800, "num_env_steps_sampled_throughput_per_sec": 161.85982002857875, "num_env_steps_trained_throughput_per_sec": 161.85982002857875, "timesteps_total": 57240, "num_steps_trained_this_iter": 1800, "agent_timesteps_total": 57240, "timers": {"training_iteration_time_ms": 2232.367, "sample_time_ms": 2225.283, "load_time_ms": 0.217, "load_throughput": 1659832.296, "learn_time_ms": 6.305, "learn_throughput": 57094.922, "synch_weights_time_ms": 0.529}, "counters": {"num_env_steps_sampled": 57240, "num_env_steps_trained": 57240, "num_agent_steps_sampled": 57240, "num_agent_steps_trained": 57240}, "done": false, "episodes_total": 159, "training_iteration": 32, "trial_id": "f5e97_00000", "date": "2023-07-25_17-01-50", "timestamp": 1690293710, "time_this_iter_s": 11.12281608581543, "time_total_s": 356.328830242157, "pid": 71917, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[0, 0.003], [5400, 0.001], [10800, 0.00075], [16200, 0.0005], [21600, 0.00025], [27000, 0.0001], [32400, 7.5e-05], [37800, 5e-05], [43200, 2.5e-05], [48600, 1e-05], [54000, 7.5e-06], [59400, 5e-06], [64800, 2.5e-06], [70200, 1e-06], [75600, 5e-07], [81000, 1e-07]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x304530310>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 356.328830242157, "iterations_since_restore": 32, "perf": {"cpu_util_percent": 27.818749999999998, "ram_util_percent": 78.16250000000001}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 5.333333333333334e-06, "entropy_coeff": 0.1, "policy_entropy": -926.6946899414063, "policy_loss": -751927577765478.4, "vf_loss": 1113268204.8}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 818.0, "diff_num_grad_updates_vs_sampler_policy": 817.0}}, "num_env_steps_sampled": 59040, "num_env_steps_trained": 59040, "num_agent_steps_sampled": 59040, "num_agent_steps_trained": 59040}, "sampler_results": {"episode_reward_max": -25394.76801455681, "episode_reward_min": -26089.458519239386, "episode_reward_mean": -25734.449730586348, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-25857.340110996713, -25560.244690377833, -25892.030930636447, -25948.775583705134, -25540.974212054138, -25702.090137226263, -25690.626525256663, -25693.172602679162, -25607.345925140522, -25690.98896196435, -25803.890518293992, -25734.94249507384, -25744.72705686407, -25770.29113828817, -25633.526479834145, -25763.380903443955, -25994.644736679224, -25562.739129391666, -25809.002674179115, -25691.99106312291, -25536.953614818452, -26089.458519239386, -25728.991995568085, -25743.012710942498, -25731.19233485226, -25635.56251138054, -25555.852056140535, -25960.016379683682, -25775.473635270748, -25600.72208017551, -25739.55659743875, -25725.58944046207, -25968.460313317206, -25552.31023615267, -25826.14338231702, -25851.657935559237, -25870.772929873903, -25857.31829782494, -25725.81508575221, -25849.753606671016, -25774.36638573008, -25750.61390274705, -25795.093836279437, -25607.763441825202, -25816.06928490739, -26032.52816587912, -25611.90048073366, -25758.81026738292, -25818.19909581026, -26021.667527199745, -25469.791996477663, -25662.03471436753, -25450.449219021648, -25721.838868787392, -25552.129775951857, -25781.631834194155, -25781.779352048346, -25769.891713527846, -25576.89087717169, -25775.058553851224, -25724.49296241185, -25938.574078295227, -25881.009915002218, -25980.650822639815, -25641.505980991944, -25657.719780325508, -25696.245921458067, -25920.578145431282, -26037.82700757382, -25671.338145087437, -25721.578692764626, -25656.373507476896, -25571.601382625424, -25668.30631840905, -25537.21193204283, -26026.414440841196, -25750.765021518066, -25888.63987625073, -25759.592285610575, -25602.9908198676, -25917.72251357423, -25625.738540594783, -25728.07455428508, -25766.671656894046, -25394.76801455681, -25524.319504516105, -25695.237048209357, -25443.608011136792, -25990.957539052048, -25620.486009063137, -25584.920994110576, -25737.453984501746, -25486.29476159542, -25615.386595685624, -25491.78692650146, -25788.11901700035, -25938.02912172231, -25645.68545622272, -25657.869840681724, -25912.577099563492], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.407617643383747, "mean_inference_ms": 0.24567618655467022, "mean_action_processing_ms": 0.05852853257198259, "mean_env_wait_ms": 1.4880197876177306, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0024480819702148438, "StateBufferConnector_ms": 0.001819610595703125, "ViewRequirementAgentConnector_ms": 0.04541659355163574}}, "episode_reward_max": -25394.76801455681, "episode_reward_min": -26089.458519239386, "episode_reward_mean": -25734.449730586348, "episode_len_mean": 360.0, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-25857.340110996713, -25560.244690377833, -25892.030930636447, -25948.775583705134, -25540.974212054138, -25702.090137226263, -25690.626525256663, -25693.172602679162, -25607.345925140522, -25690.98896196435, -25803.890518293992, -25734.94249507384, -25744.72705686407, -25770.29113828817, -25633.526479834145, -25763.380903443955, -25994.644736679224, -25562.739129391666, -25809.002674179115, -25691.99106312291, -25536.953614818452, -26089.458519239386, -25728.991995568085, -25743.012710942498, -25731.19233485226, -25635.56251138054, -25555.852056140535, -25960.016379683682, -25775.473635270748, -25600.72208017551, -25739.55659743875, -25725.58944046207, -25968.460313317206, -25552.31023615267, -25826.14338231702, -25851.657935559237, -25870.772929873903, -25857.31829782494, -25725.81508575221, -25849.753606671016, -25774.36638573008, -25750.61390274705, -25795.093836279437, -25607.763441825202, -25816.06928490739, -26032.52816587912, -25611.90048073366, -25758.81026738292, -25818.19909581026, -26021.667527199745, -25469.791996477663, -25662.03471436753, -25450.449219021648, -25721.838868787392, -25552.129775951857, -25781.631834194155, -25781.779352048346, -25769.891713527846, -25576.89087717169, -25775.058553851224, -25724.49296241185, -25938.574078295227, -25881.009915002218, -25980.650822639815, -25641.505980991944, -25657.719780325508, -25696.245921458067, -25920.578145431282, -26037.82700757382, -25671.338145087437, -25721.578692764626, -25656.373507476896, -25571.601382625424, -25668.30631840905, -25537.21193204283, -26026.414440841196, -25750.765021518066, -25888.63987625073, -25759.592285610575, -25602.9908198676, -25917.72251357423, -25625.738540594783, -25728.07455428508, -25766.671656894046, -25394.76801455681, -25524.319504516105, -25695.237048209357, -25443.608011136792, -25990.957539052048, -25620.486009063137, -25584.920994110576, -25737.453984501746, -25486.29476159542, -25615.386595685624, -25491.78692650146, -25788.11901700035, -25938.02912172231, -25645.68545622272, -25657.869840681724, -25912.577099563492], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.407617643383747, "mean_inference_ms": 0.24567618655467022, "mean_action_processing_ms": 0.05852853257198259, "mean_env_wait_ms": 1.4880197876177306, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0024480819702148438, "StateBufferConnector_ms": 0.001819610595703125, "ViewRequirementAgentConnector_ms": 0.04541659355163574}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 59040, "num_agent_steps_trained": 59040, "num_env_steps_sampled": 59040, "num_env_steps_trained": 59040, "num_env_steps_sampled_this_iter": 1800, "num_env_steps_trained_this_iter": 1800, "num_env_steps_sampled_throughput_per_sec": 158.33352557694263, "num_env_steps_trained_throughput_per_sec": 158.33352557694263, "timesteps_total": 59040, "num_steps_trained_this_iter": 1800, "agent_timesteps_total": 59040, "timers": {"training_iteration_time_ms": 2248.904, "sample_time_ms": 2241.711, "load_time_ms": 0.224, "load_throughput": 1604622.147, "learn_time_ms": 6.395, "learn_throughput": 56294.555, "synch_weights_time_ms": 0.54}, "counters": {"num_env_steps_sampled": 59040, "num_env_steps_trained": 59040, "num_agent_steps_sampled": 59040, "num_agent_steps_trained": 59040}, "done": false, "episodes_total": 164, "training_iteration": 33, "trial_id": "f5e97_00000", "date": "2023-07-25_17-02-01", "timestamp": 1690293721, "time_this_iter_s": 11.370577096939087, "time_total_s": 367.69940733909607, "pid": 71917, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[0, 0.003], [5400, 0.001], [10800, 0.00075], [16200, 0.0005], [21600, 0.00025], [27000, 0.0001], [32400, 7.5e-05], [37800, 5e-05], [43200, 2.5e-05], [48600, 1e-05], [54000, 7.5e-06], [59400, 5e-06], [64800, 2.5e-06], [70200, 1e-06], [75600, 5e-07], [81000, 1e-07]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x304530310>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 367.69940733909607, "iterations_since_restore": 33, "perf": {"cpu_util_percent": 28.424999999999997, "ram_util_percent": 79.31875}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 4.5e-06, "entropy_coeff": 0.1, "policy_entropy": -926.6971069335938, "policy_loss": -2517202703954739.0, "vf_loss": 1116953523.2}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 843.0, "diff_num_grad_updates_vs_sampler_policy": 842.0}}, "num_env_steps_sampled": 60840, "num_env_steps_trained": 60840, "num_agent_steps_sampled": 60840, "num_agent_steps_trained": 60840}, "sampler_results": {"episode_reward_max": -25394.76801455681, "episode_reward_min": -26089.458519239386, "episode_reward_mean": -25735.16799348972, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-25702.090137226263, -25690.626525256663, -25693.172602679162, -25607.345925140522, -25690.98896196435, -25803.890518293992, -25734.94249507384, -25744.72705686407, -25770.29113828817, -25633.526479834145, -25763.380903443955, -25994.644736679224, -25562.739129391666, -25809.002674179115, -25691.99106312291, -25536.953614818452, -26089.458519239386, -25728.991995568085, -25743.012710942498, -25731.19233485226, -25635.56251138054, -25555.852056140535, -25960.016379683682, -25775.473635270748, -25600.72208017551, -25739.55659743875, -25725.58944046207, -25968.460313317206, -25552.31023615267, -25826.14338231702, -25851.657935559237, -25870.772929873903, -25857.31829782494, -25725.81508575221, -25849.753606671016, -25774.36638573008, -25750.61390274705, -25795.093836279437, -25607.763441825202, -25816.06928490739, -26032.52816587912, -25611.90048073366, -25758.81026738292, -25818.19909581026, -26021.667527199745, -25469.791996477663, -25662.03471436753, -25450.449219021648, -25721.838868787392, -25552.129775951857, -25781.631834194155, -25781.779352048346, -25769.891713527846, -25576.89087717169, -25775.058553851224, -25724.49296241185, -25938.574078295227, -25881.009915002218, -25980.650822639815, -25641.505980991944, -25657.719780325508, -25696.245921458067, -25920.578145431282, -26037.82700757382, -25671.338145087437, -25721.578692764626, -25656.373507476896, -25571.601382625424, -25668.30631840905, -25537.21193204283, -26026.414440841196, -25750.765021518066, -25888.63987625073, -25759.592285610575, -25602.9908198676, -25917.72251357423, -25625.738540594783, -25728.07455428508, -25766.671656894046, -25394.76801455681, -25524.319504516105, -25695.237048209357, -25443.608011136792, -25990.957539052048, -25620.486009063137, -25584.920994110576, -25737.453984501746, -25486.29476159542, -25615.386595685624, -25491.78692650146, -25788.11901700035, -25938.02912172231, -25645.68545622272, -25657.869840681724, -25912.577099563492, -26000.048036124903, -25645.351863889933, -25508.66099078769, -25802.368309252677, -25914.762618051565], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.407702216888878, "mean_inference_ms": 0.24570861135288927, "mean_action_processing_ms": 0.05852899622252901, "mean_env_wait_ms": 1.485842709547506, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002450227737426758, "StateBufferConnector_ms": 0.0018150806427001953, "ViewRequirementAgentConnector_ms": 0.04553365707397461}}, "episode_reward_max": -25394.76801455681, "episode_reward_min": -26089.458519239386, "episode_reward_mean": -25735.16799348972, "episode_len_mean": 360.0, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-25702.090137226263, -25690.626525256663, -25693.172602679162, -25607.345925140522, -25690.98896196435, -25803.890518293992, -25734.94249507384, -25744.72705686407, -25770.29113828817, -25633.526479834145, -25763.380903443955, -25994.644736679224, -25562.739129391666, -25809.002674179115, -25691.99106312291, -25536.953614818452, -26089.458519239386, -25728.991995568085, -25743.012710942498, -25731.19233485226, -25635.56251138054, -25555.852056140535, -25960.016379683682, -25775.473635270748, -25600.72208017551, -25739.55659743875, -25725.58944046207, -25968.460313317206, -25552.31023615267, -25826.14338231702, -25851.657935559237, -25870.772929873903, -25857.31829782494, -25725.81508575221, -25849.753606671016, -25774.36638573008, -25750.61390274705, -25795.093836279437, -25607.763441825202, -25816.06928490739, -26032.52816587912, -25611.90048073366, -25758.81026738292, -25818.19909581026, -26021.667527199745, -25469.791996477663, -25662.03471436753, -25450.449219021648, -25721.838868787392, -25552.129775951857, -25781.631834194155, -25781.779352048346, -25769.891713527846, -25576.89087717169, -25775.058553851224, -25724.49296241185, -25938.574078295227, -25881.009915002218, -25980.650822639815, -25641.505980991944, -25657.719780325508, -25696.245921458067, -25920.578145431282, -26037.82700757382, -25671.338145087437, -25721.578692764626, -25656.373507476896, -25571.601382625424, -25668.30631840905, -25537.21193204283, -26026.414440841196, -25750.765021518066, -25888.63987625073, -25759.592285610575, -25602.9908198676, -25917.72251357423, -25625.738540594783, -25728.07455428508, -25766.671656894046, -25394.76801455681, -25524.319504516105, -25695.237048209357, -25443.608011136792, -25990.957539052048, -25620.486009063137, -25584.920994110576, -25737.453984501746, -25486.29476159542, -25615.386595685624, -25491.78692650146, -25788.11901700035, -25938.02912172231, -25645.68545622272, -25657.869840681724, -25912.577099563492, -26000.048036124903, -25645.351863889933, -25508.66099078769, -25802.368309252677, -25914.762618051565], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.407702216888878, "mean_inference_ms": 0.24570861135288927, "mean_action_processing_ms": 0.05852899622252901, "mean_env_wait_ms": 1.485842709547506, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002450227737426758, "StateBufferConnector_ms": 0.0018150806427001953, "ViewRequirementAgentConnector_ms": 0.04553365707397461}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 60840, "num_agent_steps_trained": 60840, "num_env_steps_sampled": 60840, "num_env_steps_trained": 60840, "num_env_steps_sampled_this_iter": 1800, "num_env_steps_trained_this_iter": 1800, "num_env_steps_sampled_throughput_per_sec": 162.07456551237877, "num_env_steps_trained_throughput_per_sec": 162.07456551237877, "timesteps_total": 60840, "num_steps_trained_this_iter": 1800, "agent_timesteps_total": 60840, "timers": {"training_iteration_time_ms": 2247.43, "sample_time_ms": 2240.03, "load_time_ms": 0.228, "load_throughput": 1579445.021, "learn_time_ms": 6.592, "learn_throughput": 54615.309, "synch_weights_time_ms": 0.546}, "counters": {"num_env_steps_sampled": 60840, "num_env_steps_trained": 60840, "num_agent_steps_sampled": 60840, "num_agent_steps_trained": 60840}, "done": false, "episodes_total": 169, "training_iteration": 34, "trial_id": "f5e97_00000", "date": "2023-07-25_17-02-12", "timestamp": 1690293732, "time_this_iter_s": 11.108043909072876, "time_total_s": 378.80745124816895, "pid": 71917, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[0, 0.003], [5400, 0.001], [10800, 0.00075], [16200, 0.0005], [21600, 0.00025], [27000, 0.0001], [32400, 7.5e-05], [37800, 5e-05], [43200, 2.5e-05], [48600, 1e-05], [54000, 7.5e-06], [59400, 5e-06], [64800, 2.5e-06], [70200, 1e-06], [75600, 5e-07], [81000, 1e-07]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x304530310>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 378.80745124816895, "iterations_since_restore": 34, "perf": {"cpu_util_percent": 25.21875, "ram_util_percent": 79.31875}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 3.6666666666666674e-06, "entropy_coeff": 0.1, "policy_entropy": -926.69833984375, "policy_loss": -751846855213056.0, "vf_loss": 1075551110.4}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 868.0, "diff_num_grad_updates_vs_sampler_policy": 867.0}}, "num_env_steps_sampled": 62640, "num_env_steps_trained": 62640, "num_agent_steps_sampled": 62640, "num_agent_steps_trained": 62640}, "sampler_results": {"episode_reward_max": -25394.76801455681, "episode_reward_min": -26089.458519239386, "episode_reward_mean": -25740.602438662605, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-25803.890518293992, -25734.94249507384, -25744.72705686407, -25770.29113828817, -25633.526479834145, -25763.380903443955, -25994.644736679224, -25562.739129391666, -25809.002674179115, -25691.99106312291, -25536.953614818452, -26089.458519239386, -25728.991995568085, -25743.012710942498, -25731.19233485226, -25635.56251138054, -25555.852056140535, -25960.016379683682, -25775.473635270748, -25600.72208017551, -25739.55659743875, -25725.58944046207, -25968.460313317206, -25552.31023615267, -25826.14338231702, -25851.657935559237, -25870.772929873903, -25857.31829782494, -25725.81508575221, -25849.753606671016, -25774.36638573008, -25750.61390274705, -25795.093836279437, -25607.763441825202, -25816.06928490739, -26032.52816587912, -25611.90048073366, -25758.81026738292, -25818.19909581026, -26021.667527199745, -25469.791996477663, -25662.03471436753, -25450.449219021648, -25721.838868787392, -25552.129775951857, -25781.631834194155, -25781.779352048346, -25769.891713527846, -25576.89087717169, -25775.058553851224, -25724.49296241185, -25938.574078295227, -25881.009915002218, -25980.650822639815, -25641.505980991944, -25657.719780325508, -25696.245921458067, -25920.578145431282, -26037.82700757382, -25671.338145087437, -25721.578692764626, -25656.373507476896, -25571.601382625424, -25668.30631840905, -25537.21193204283, -26026.414440841196, -25750.765021518066, -25888.63987625073, -25759.592285610575, -25602.9908198676, -25917.72251357423, -25625.738540594783, -25728.07455428508, -25766.671656894046, -25394.76801455681, -25524.319504516105, -25695.237048209357, -25443.608011136792, -25990.957539052048, -25620.486009063137, -25584.920994110576, -25737.453984501746, -25486.29476159542, -25615.386595685624, -25491.78692650146, -25788.11901700035, -25938.02912172231, -25645.68545622272, -25657.869840681724, -25912.577099563492, -26000.048036124903, -25645.351863889933, -25508.66099078769, -25802.368309252677, -25914.762618051565, -25843.30730086229, -25842.047477590306, -25815.192077501775, -25930.200027114544, -25496.92178648706], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.407669278885183, "mean_inference_ms": 0.2457479090145593, "mean_action_processing_ms": 0.05853084498784538, "mean_env_wait_ms": 1.4839644644364784, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002444028854370117, "StateBufferConnector_ms": 0.0018177032470703125, "ViewRequirementAgentConnector_ms": 0.0454256534576416}}, "episode_reward_max": -25394.76801455681, "episode_reward_min": -26089.458519239386, "episode_reward_mean": -25740.602438662605, "episode_len_mean": 360.0, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-25803.890518293992, -25734.94249507384, -25744.72705686407, -25770.29113828817, -25633.526479834145, -25763.380903443955, -25994.644736679224, -25562.739129391666, -25809.002674179115, -25691.99106312291, -25536.953614818452, -26089.458519239386, -25728.991995568085, -25743.012710942498, -25731.19233485226, -25635.56251138054, -25555.852056140535, -25960.016379683682, -25775.473635270748, -25600.72208017551, -25739.55659743875, -25725.58944046207, -25968.460313317206, -25552.31023615267, -25826.14338231702, -25851.657935559237, -25870.772929873903, -25857.31829782494, -25725.81508575221, -25849.753606671016, -25774.36638573008, -25750.61390274705, -25795.093836279437, -25607.763441825202, -25816.06928490739, -26032.52816587912, -25611.90048073366, -25758.81026738292, -25818.19909581026, -26021.667527199745, -25469.791996477663, -25662.03471436753, -25450.449219021648, -25721.838868787392, -25552.129775951857, -25781.631834194155, -25781.779352048346, -25769.891713527846, -25576.89087717169, -25775.058553851224, -25724.49296241185, -25938.574078295227, -25881.009915002218, -25980.650822639815, -25641.505980991944, -25657.719780325508, -25696.245921458067, -25920.578145431282, -26037.82700757382, -25671.338145087437, -25721.578692764626, -25656.373507476896, -25571.601382625424, -25668.30631840905, -25537.21193204283, -26026.414440841196, -25750.765021518066, -25888.63987625073, -25759.592285610575, -25602.9908198676, -25917.72251357423, -25625.738540594783, -25728.07455428508, -25766.671656894046, -25394.76801455681, -25524.319504516105, -25695.237048209357, -25443.608011136792, -25990.957539052048, -25620.486009063137, -25584.920994110576, -25737.453984501746, -25486.29476159542, -25615.386595685624, -25491.78692650146, -25788.11901700035, -25938.02912172231, -25645.68545622272, -25657.869840681724, -25912.577099563492, -26000.048036124903, -25645.351863889933, -25508.66099078769, -25802.368309252677, -25914.762618051565, -25843.30730086229, -25842.047477590306, -25815.192077501775, -25930.200027114544, -25496.92178648706], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.407669278885183, "mean_inference_ms": 0.2457479090145593, "mean_action_processing_ms": 0.05853084498784538, "mean_env_wait_ms": 1.4839644644364784, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002444028854370117, "StateBufferConnector_ms": 0.0018177032470703125, "ViewRequirementAgentConnector_ms": 0.0454256534576416}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 62640, "num_agent_steps_trained": 62640, "num_env_steps_sampled": 62640, "num_env_steps_trained": 62640, "num_env_steps_sampled_this_iter": 1800, "num_env_steps_trained_this_iter": 1800, "num_env_steps_sampled_throughput_per_sec": 161.982870606797, "num_env_steps_trained_throughput_per_sec": 161.982870606797, "timesteps_total": 62640, "num_steps_trained_this_iter": 1800, "agent_timesteps_total": 62640, "timers": {"training_iteration_time_ms": 2221.817, "sample_time_ms": 2214.471, "load_time_ms": 0.218, "load_throughput": 1653832.903, "learn_time_ms": 6.52, "learn_throughput": 55216.666, "synch_weights_time_ms": 0.574}, "counters": {"num_env_steps_sampled": 62640, "num_env_steps_trained": 62640, "num_agent_steps_sampled": 62640, "num_agent_steps_trained": 62640}, "done": false, "episodes_total": 174, "training_iteration": 35, "trial_id": "f5e97_00000", "date": "2023-07-25_17-02-23", "timestamp": 1690293743, "time_this_iter_s": 11.114537954330444, "time_total_s": 389.9219892024994, "pid": 71917, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[0, 0.003], [5400, 0.001], [10800, 0.00075], [16200, 0.0005], [21600, 0.00025], [27000, 0.0001], [32400, 7.5e-05], [37800, 5e-05], [43200, 2.5e-05], [48600, 1e-05], [54000, 7.5e-06], [59400, 5e-06], [64800, 2.5e-06], [70200, 1e-06], [75600, 5e-07], [81000, 1e-07]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x304530310>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 389.9219892024994, "iterations_since_restore": 35, "perf": {"cpu_util_percent": 26.36875, "ram_util_percent": 79.4625}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 2.8333333333333335e-06, "entropy_coeff": 0.1, "policy_entropy": -926.6983764648437, "policy_loss": -5387653871776563.0, "vf_loss": 1127592832.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 893.0, "diff_num_grad_updates_vs_sampler_policy": 892.0}}, "num_env_steps_sampled": 64440, "num_env_steps_trained": 64440, "num_agent_steps_sampled": 64440, "num_agent_steps_trained": 64440}, "sampler_results": {"episode_reward_max": -25394.76801455681, "episode_reward_min": -26089.458519239386, "episode_reward_mean": -25742.33613768818, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-25763.380903443955, -25994.644736679224, -25562.739129391666, -25809.002674179115, -25691.99106312291, -25536.953614818452, -26089.458519239386, -25728.991995568085, -25743.012710942498, -25731.19233485226, -25635.56251138054, -25555.852056140535, -25960.016379683682, -25775.473635270748, -25600.72208017551, -25739.55659743875, -25725.58944046207, -25968.460313317206, -25552.31023615267, -25826.14338231702, -25851.657935559237, -25870.772929873903, -25857.31829782494, -25725.81508575221, -25849.753606671016, -25774.36638573008, -25750.61390274705, -25795.093836279437, -25607.763441825202, -25816.06928490739, -26032.52816587912, -25611.90048073366, -25758.81026738292, -25818.19909581026, -26021.667527199745, -25469.791996477663, -25662.03471436753, -25450.449219021648, -25721.838868787392, -25552.129775951857, -25781.631834194155, -25781.779352048346, -25769.891713527846, -25576.89087717169, -25775.058553851224, -25724.49296241185, -25938.574078295227, -25881.009915002218, -25980.650822639815, -25641.505980991944, -25657.719780325508, -25696.245921458067, -25920.578145431282, -26037.82700757382, -25671.338145087437, -25721.578692764626, -25656.373507476896, -25571.601382625424, -25668.30631840905, -25537.21193204283, -26026.414440841196, -25750.765021518066, -25888.63987625073, -25759.592285610575, -25602.9908198676, -25917.72251357423, -25625.738540594783, -25728.07455428508, -25766.671656894046, -25394.76801455681, -25524.319504516105, -25695.237048209357, -25443.608011136792, -25990.957539052048, -25620.486009063137, -25584.920994110576, -25737.453984501746, -25486.29476159542, -25615.386595685624, -25491.78692650146, -25788.11901700035, -25938.02912172231, -25645.68545622272, -25657.869840681724, -25912.577099563492, -26000.048036124903, -25645.351863889933, -25508.66099078769, -25802.368309252677, -25914.762618051565, -25843.30730086229, -25842.047477590306, -25815.192077501775, -25930.200027114544, -25496.92178648706, -25752.813173693678, -25753.395098784287, -25725.75446765467, -25673.519089850408, -25955.26576092845], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.407567023732887, "mean_inference_ms": 0.24579584269407953, "mean_action_processing_ms": 0.05853398307175693, "mean_env_wait_ms": 1.482304047287018, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0024576187133789062, "StateBufferConnector_ms": 0.0018262863159179688, "ViewRequirementAgentConnector_ms": 0.04552769660949707}}, "episode_reward_max": -25394.76801455681, "episode_reward_min": -26089.458519239386, "episode_reward_mean": -25742.33613768818, "episode_len_mean": 360.0, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-25763.380903443955, -25994.644736679224, -25562.739129391666, -25809.002674179115, -25691.99106312291, -25536.953614818452, -26089.458519239386, -25728.991995568085, -25743.012710942498, -25731.19233485226, -25635.56251138054, -25555.852056140535, -25960.016379683682, -25775.473635270748, -25600.72208017551, -25739.55659743875, -25725.58944046207, -25968.460313317206, -25552.31023615267, -25826.14338231702, -25851.657935559237, -25870.772929873903, -25857.31829782494, -25725.81508575221, -25849.753606671016, -25774.36638573008, -25750.61390274705, -25795.093836279437, -25607.763441825202, -25816.06928490739, -26032.52816587912, -25611.90048073366, -25758.81026738292, -25818.19909581026, -26021.667527199745, -25469.791996477663, -25662.03471436753, -25450.449219021648, -25721.838868787392, -25552.129775951857, -25781.631834194155, -25781.779352048346, -25769.891713527846, -25576.89087717169, -25775.058553851224, -25724.49296241185, -25938.574078295227, -25881.009915002218, -25980.650822639815, -25641.505980991944, -25657.719780325508, -25696.245921458067, -25920.578145431282, -26037.82700757382, -25671.338145087437, -25721.578692764626, -25656.373507476896, -25571.601382625424, -25668.30631840905, -25537.21193204283, -26026.414440841196, -25750.765021518066, -25888.63987625073, -25759.592285610575, -25602.9908198676, -25917.72251357423, -25625.738540594783, -25728.07455428508, -25766.671656894046, -25394.76801455681, -25524.319504516105, -25695.237048209357, -25443.608011136792, -25990.957539052048, -25620.486009063137, -25584.920994110576, -25737.453984501746, -25486.29476159542, -25615.386595685624, -25491.78692650146, -25788.11901700035, -25938.02912172231, -25645.68545622272, -25657.869840681724, -25912.577099563492, -26000.048036124903, -25645.351863889933, -25508.66099078769, -25802.368309252677, -25914.762618051565, -25843.30730086229, -25842.047477590306, -25815.192077501775, -25930.200027114544, -25496.92178648706, -25752.813173693678, -25753.395098784287, -25725.75446765467, -25673.519089850408, -25955.26576092845], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.407567023732887, "mean_inference_ms": 0.24579584269407953, "mean_action_processing_ms": 0.05853398307175693, "mean_env_wait_ms": 1.482304047287018, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0024576187133789062, "StateBufferConnector_ms": 0.0018262863159179688, "ViewRequirementAgentConnector_ms": 0.04552769660949707}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 64440, "num_agent_steps_trained": 64440, "num_env_steps_sampled": 64440, "num_env_steps_trained": 64440, "num_env_steps_sampled_this_iter": 1800, "num_env_steps_trained_this_iter": 1800, "num_env_steps_sampled_throughput_per_sec": 161.98610975164573, "num_env_steps_trained_throughput_per_sec": 161.98610975164573, "timesteps_total": 64440, "num_steps_trained_this_iter": 1800, "agent_timesteps_total": 64440, "timers": {"training_iteration_time_ms": 2222.425, "sample_time_ms": 2215.257, "load_time_ms": 0.222, "load_throughput": 1622903.525, "learn_time_ms": 6.347, "learn_throughput": 56718.107, "synch_weights_time_ms": 0.563}, "counters": {"num_env_steps_sampled": 64440, "num_env_steps_trained": 64440, "num_agent_steps_sampled": 64440, "num_agent_steps_trained": 64440}, "done": false, "episodes_total": 179, "training_iteration": 36, "trial_id": "f5e97_00000", "date": "2023-07-25_17-02-34", "timestamp": 1690293754, "time_this_iter_s": 11.114224910736084, "time_total_s": 401.0362141132355, "pid": 71917, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[0, 0.003], [5400, 0.001], [10800, 0.00075], [16200, 0.0005], [21600, 0.00025], [27000, 0.0001], [32400, 7.5e-05], [37800, 5e-05], [43200, 2.5e-05], [48600, 1e-05], [54000, 7.5e-06], [59400, 5e-06], [64800, 2.5e-06], [70200, 1e-06], [75600, 5e-07], [81000, 1e-07]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x304530310>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 401.0362141132355, "iterations_since_restore": 36, "perf": {"cpu_util_percent": 27.8375, "ram_util_percent": 78.65}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 2.2e-06, "entropy_coeff": 0.1, "policy_entropy": -926.6994506835938, "policy_loss": -5551557408797491.0, "vf_loss": 1112023110.4}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 918.0, "diff_num_grad_updates_vs_sampler_policy": 917.0}}, "num_env_steps_sampled": 66240, "num_env_steps_trained": 66240, "num_agent_steps_sampled": 66240, "num_agent_steps_trained": 66240}, "sampler_results": {"episode_reward_max": -25394.76801455681, "episode_reward_min": -26089.458519239386, "episode_reward_mean": -25738.336121820164, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-25536.953614818452, -26089.458519239386, -25728.991995568085, -25743.012710942498, -25731.19233485226, -25635.56251138054, -25555.852056140535, -25960.016379683682, -25775.473635270748, -25600.72208017551, -25739.55659743875, -25725.58944046207, -25968.460313317206, -25552.31023615267, -25826.14338231702, -25851.657935559237, -25870.772929873903, -25857.31829782494, -25725.81508575221, -25849.753606671016, -25774.36638573008, -25750.61390274705, -25795.093836279437, -25607.763441825202, -25816.06928490739, -26032.52816587912, -25611.90048073366, -25758.81026738292, -25818.19909581026, -26021.667527199745, -25469.791996477663, -25662.03471436753, -25450.449219021648, -25721.838868787392, -25552.129775951857, -25781.631834194155, -25781.779352048346, -25769.891713527846, -25576.89087717169, -25775.058553851224, -25724.49296241185, -25938.574078295227, -25881.009915002218, -25980.650822639815, -25641.505980991944, -25657.719780325508, -25696.245921458067, -25920.578145431282, -26037.82700757382, -25671.338145087437, -25721.578692764626, -25656.373507476896, -25571.601382625424, -25668.30631840905, -25537.21193204283, -26026.414440841196, -25750.765021518066, -25888.63987625073, -25759.592285610575, -25602.9908198676, -25917.72251357423, -25625.738540594783, -25728.07455428508, -25766.671656894046, -25394.76801455681, -25524.319504516105, -25695.237048209357, -25443.608011136792, -25990.957539052048, -25620.486009063137, -25584.920994110576, -25737.453984501746, -25486.29476159542, -25615.386595685624, -25491.78692650146, -25788.11901700035, -25938.02912172231, -25645.68545622272, -25657.869840681724, -25912.577099563492, -26000.048036124903, -25645.351863889933, -25508.66099078769, -25802.368309252677, -25914.762618051565, -25843.30730086229, -25842.047477590306, -25815.192077501775, -25930.200027114544, -25496.92178648706, -25752.813173693678, -25753.395098784287, -25725.75446765467, -25673.519089850408, -25955.26576092845, -25642.890215674477, -25568.95617611713, -25548.1774575833, -25752.215860747718, -25909.517209893296], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.407501291624056, "mean_inference_ms": 0.24582903864841654, "mean_action_processing_ms": 0.05853534582015716, "mean_env_wait_ms": 1.4808017589423317, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0024149417877197266, "StateBufferConnector_ms": 0.0017931461334228516, "ViewRequirementAgentConnector_ms": 0.044675350189208984}}, "episode_reward_max": -25394.76801455681, "episode_reward_min": -26089.458519239386, "episode_reward_mean": -25738.336121820164, "episode_len_mean": 360.0, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-25536.953614818452, -26089.458519239386, -25728.991995568085, -25743.012710942498, -25731.19233485226, -25635.56251138054, -25555.852056140535, -25960.016379683682, -25775.473635270748, -25600.72208017551, -25739.55659743875, -25725.58944046207, -25968.460313317206, -25552.31023615267, -25826.14338231702, -25851.657935559237, -25870.772929873903, -25857.31829782494, -25725.81508575221, -25849.753606671016, -25774.36638573008, -25750.61390274705, -25795.093836279437, -25607.763441825202, -25816.06928490739, -26032.52816587912, -25611.90048073366, -25758.81026738292, -25818.19909581026, -26021.667527199745, -25469.791996477663, -25662.03471436753, -25450.449219021648, -25721.838868787392, -25552.129775951857, -25781.631834194155, -25781.779352048346, -25769.891713527846, -25576.89087717169, -25775.058553851224, -25724.49296241185, -25938.574078295227, -25881.009915002218, -25980.650822639815, -25641.505980991944, -25657.719780325508, -25696.245921458067, -25920.578145431282, -26037.82700757382, -25671.338145087437, -25721.578692764626, -25656.373507476896, -25571.601382625424, -25668.30631840905, -25537.21193204283, -26026.414440841196, -25750.765021518066, -25888.63987625073, -25759.592285610575, -25602.9908198676, -25917.72251357423, -25625.738540594783, -25728.07455428508, -25766.671656894046, -25394.76801455681, -25524.319504516105, -25695.237048209357, -25443.608011136792, -25990.957539052048, -25620.486009063137, -25584.920994110576, -25737.453984501746, -25486.29476159542, -25615.386595685624, -25491.78692650146, -25788.11901700035, -25938.02912172231, -25645.68545622272, -25657.869840681724, -25912.577099563492, -26000.048036124903, -25645.351863889933, -25508.66099078769, -25802.368309252677, -25914.762618051565, -25843.30730086229, -25842.047477590306, -25815.192077501775, -25930.200027114544, -25496.92178648706, -25752.813173693678, -25753.395098784287, -25725.75446765467, -25673.519089850408, -25955.26576092845, -25642.890215674477, -25568.95617611713, -25548.1774575833, -25752.215860747718, -25909.517209893296], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.407501291624056, "mean_inference_ms": 0.24582903864841654, "mean_action_processing_ms": 0.05853534582015716, "mean_env_wait_ms": 1.4808017589423317, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0024149417877197266, "StateBufferConnector_ms": 0.0017931461334228516, "ViewRequirementAgentConnector_ms": 0.044675350189208984}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 66240, "num_agent_steps_trained": 66240, "num_env_steps_sampled": 66240, "num_env_steps_trained": 66240, "num_env_steps_sampled_this_iter": 1800, "num_env_steps_trained_this_iter": 1800, "num_env_steps_sampled_throughput_per_sec": 161.58424467045214, "num_env_steps_trained_throughput_per_sec": 161.58424467045214, "timesteps_total": 66240, "num_steps_trained_this_iter": 1800, "agent_timesteps_total": 66240, "timers": {"training_iteration_time_ms": 2225.167, "sample_time_ms": 2218.102, "load_time_ms": 0.228, "load_throughput": 1580767.839, "learn_time_ms": 6.277, "learn_throughput": 57356.696, "synch_weights_time_ms": 0.527}, "counters": {"num_env_steps_sampled": 66240, "num_env_steps_trained": 66240, "num_agent_steps_sampled": 66240, "num_agent_steps_trained": 66240}, "done": false, "episodes_total": 184, "training_iteration": 37, "trial_id": "f5e97_00000", "date": "2023-07-25_17-02-46", "timestamp": 1690293766, "time_this_iter_s": 11.14208722114563, "time_total_s": 412.1783013343811, "pid": 71917, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[0, 0.003], [5400, 0.001], [10800, 0.00075], [16200, 0.0005], [21600, 0.00025], [27000, 0.0001], [32400, 7.5e-05], [37800, 5e-05], [43200, 2.5e-05], [48600, 1e-05], [54000, 7.5e-06], [59400, 5e-06], [64800, 2.5e-06], [70200, 1e-06], [75600, 5e-07], [81000, 1e-07]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x304530310>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 412.1783013343811, "iterations_since_restore": 37, "perf": {"cpu_util_percent": 24.62666666666667, "ram_util_percent": 78.82}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1.7000000000000002e-06, "entropy_coeff": 0.1, "policy_entropy": -926.6996215820312, "policy_loss": -4080391839763661.0, "vf_loss": 1102878796.8}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 943.0, "diff_num_grad_updates_vs_sampler_policy": 942.0}}, "num_env_steps_sampled": 68040, "num_env_steps_trained": 68040, "num_agent_steps_sampled": 68040, "num_agent_steps_trained": 68040}, "sampler_results": {"episode_reward_max": -25394.76801455681, "episode_reward_min": -26037.82700757382, "episode_reward_mean": -25735.08029185801, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-25635.56251138054, -25555.852056140535, -25960.016379683682, -25775.473635270748, -25600.72208017551, -25739.55659743875, -25725.58944046207, -25968.460313317206, -25552.31023615267, -25826.14338231702, -25851.657935559237, -25870.772929873903, -25857.31829782494, -25725.81508575221, -25849.753606671016, -25774.36638573008, -25750.61390274705, -25795.093836279437, -25607.763441825202, -25816.06928490739, -26032.52816587912, -25611.90048073366, -25758.81026738292, -25818.19909581026, -26021.667527199745, -25469.791996477663, -25662.03471436753, -25450.449219021648, -25721.838868787392, -25552.129775951857, -25781.631834194155, -25781.779352048346, -25769.891713527846, -25576.89087717169, -25775.058553851224, -25724.49296241185, -25938.574078295227, -25881.009915002218, -25980.650822639815, -25641.505980991944, -25657.719780325508, -25696.245921458067, -25920.578145431282, -26037.82700757382, -25671.338145087437, -25721.578692764626, -25656.373507476896, -25571.601382625424, -25668.30631840905, -25537.21193204283, -26026.414440841196, -25750.765021518066, -25888.63987625073, -25759.592285610575, -25602.9908198676, -25917.72251357423, -25625.738540594783, -25728.07455428508, -25766.671656894046, -25394.76801455681, -25524.319504516105, -25695.237048209357, -25443.608011136792, -25990.957539052048, -25620.486009063137, -25584.920994110576, -25737.453984501746, -25486.29476159542, -25615.386595685624, -25491.78692650146, -25788.11901700035, -25938.02912172231, -25645.68545622272, -25657.869840681724, -25912.577099563492, -26000.048036124903, -25645.351863889933, -25508.66099078769, -25802.368309252677, -25914.762618051565, -25843.30730086229, -25842.047477590306, -25815.192077501775, -25930.200027114544, -25496.92178648706, -25752.813173693678, -25753.395098784287, -25725.75446765467, -25673.519089850408, -25955.26576092845, -25642.890215674477, -25568.95617611713, -25548.1774575833, -25752.215860747718, -25909.517209893296, -25850.959082006375, -25610.5546102421, -25498.06790014565, -25700.241765192157, -25844.20282161848], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.407359005670331, "mean_inference_ms": 0.2458621392671818, "mean_action_processing_ms": 0.058537300437115365, "mean_env_wait_ms": 1.4794302791671592, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0023996829986572266, "StateBufferConnector_ms": 0.0017921924591064453, "ViewRequirementAgentConnector_ms": 0.0444483757019043}}, "episode_reward_max": -25394.76801455681, "episode_reward_min": -26037.82700757382, "episode_reward_mean": -25735.08029185801, "episode_len_mean": 360.0, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-25635.56251138054, -25555.852056140535, -25960.016379683682, -25775.473635270748, -25600.72208017551, -25739.55659743875, -25725.58944046207, -25968.460313317206, -25552.31023615267, -25826.14338231702, -25851.657935559237, -25870.772929873903, -25857.31829782494, -25725.81508575221, -25849.753606671016, -25774.36638573008, -25750.61390274705, -25795.093836279437, -25607.763441825202, -25816.06928490739, -26032.52816587912, -25611.90048073366, -25758.81026738292, -25818.19909581026, -26021.667527199745, -25469.791996477663, -25662.03471436753, -25450.449219021648, -25721.838868787392, -25552.129775951857, -25781.631834194155, -25781.779352048346, -25769.891713527846, -25576.89087717169, -25775.058553851224, -25724.49296241185, -25938.574078295227, -25881.009915002218, -25980.650822639815, -25641.505980991944, -25657.719780325508, -25696.245921458067, -25920.578145431282, -26037.82700757382, -25671.338145087437, -25721.578692764626, -25656.373507476896, -25571.601382625424, -25668.30631840905, -25537.21193204283, -26026.414440841196, -25750.765021518066, -25888.63987625073, -25759.592285610575, -25602.9908198676, -25917.72251357423, -25625.738540594783, -25728.07455428508, -25766.671656894046, -25394.76801455681, -25524.319504516105, -25695.237048209357, -25443.608011136792, -25990.957539052048, -25620.486009063137, -25584.920994110576, -25737.453984501746, -25486.29476159542, -25615.386595685624, -25491.78692650146, -25788.11901700035, -25938.02912172231, -25645.68545622272, -25657.869840681724, -25912.577099563492, -26000.048036124903, -25645.351863889933, -25508.66099078769, -25802.368309252677, -25914.762618051565, -25843.30730086229, -25842.047477590306, -25815.192077501775, -25930.200027114544, -25496.92178648706, -25752.813173693678, -25753.395098784287, -25725.75446765467, -25673.519089850408, -25955.26576092845, -25642.890215674477, -25568.95617611713, -25548.1774575833, -25752.215860747718, -25909.517209893296, -25850.959082006375, -25610.5546102421, -25498.06790014565, -25700.241765192157, -25844.20282161848], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.407359005670331, "mean_inference_ms": 0.2458621392671818, "mean_action_processing_ms": 0.058537300437115365, "mean_env_wait_ms": 1.4794302791671592, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0023996829986572266, "StateBufferConnector_ms": 0.0017921924591064453, "ViewRequirementAgentConnector_ms": 0.0444483757019043}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 68040, "num_agent_steps_trained": 68040, "num_env_steps_sampled": 68040, "num_env_steps_trained": 68040, "num_env_steps_sampled_this_iter": 1800, "num_env_steps_trained_this_iter": 1800, "num_env_steps_sampled_throughput_per_sec": 161.053790396683, "num_env_steps_trained_throughput_per_sec": 161.053790396683, "timesteps_total": 68040, "num_steps_trained_this_iter": 1800, "agent_timesteps_total": 68040, "timers": {"training_iteration_time_ms": 2231.599, "sample_time_ms": 2224.492, "load_time_ms": 0.222, "load_throughput": 1623077.975, "learn_time_ms": 6.309, "learn_throughput": 57057.813, "synch_weights_time_ms": 0.543}, "counters": {"num_env_steps_sampled": 68040, "num_env_steps_trained": 68040, "num_agent_steps_sampled": 68040, "num_agent_steps_trained": 68040}, "done": false, "episodes_total": 189, "training_iteration": 38, "trial_id": "f5e97_00000", "date": "2023-07-25_17-02-57", "timestamp": 1690293777, "time_this_iter_s": 11.178519010543823, "time_total_s": 423.3568203449249, "pid": 71917, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[0, 0.003], [5400, 0.001], [10800, 0.00075], [16200, 0.0005], [21600, 0.00025], [27000, 0.0001], [32400, 7.5e-05], [37800, 5e-05], [43200, 2.5e-05], [48600, 1e-05], [54000, 7.5e-06], [59400, 5e-06], [64800, 2.5e-06], [70200, 1e-06], [75600, 5e-07], [81000, 1e-07]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x304530310>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 423.3568203449249, "iterations_since_restore": 38, "perf": {"cpu_util_percent": 25.16875, "ram_util_percent": 79.21875}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1.2e-06, "entropy_coeff": 0.1, "policy_entropy": -926.699560546875, "policy_loss": -261198544116121.6, "vf_loss": 1097634681.6}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 968.0, "diff_num_grad_updates_vs_sampler_policy": 967.0}}, "num_env_steps_sampled": 69840, "num_env_steps_trained": 69840, "num_agent_steps_sampled": 69840, "num_agent_steps_trained": 69840}, "sampler_results": {"episode_reward_max": -25394.76801455681, "episode_reward_min": -26037.82700757382, "episode_reward_mean": -25734.393700082415, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-25739.55659743875, -25725.58944046207, -25968.460313317206, -25552.31023615267, -25826.14338231702, -25851.657935559237, -25870.772929873903, -25857.31829782494, -25725.81508575221, -25849.753606671016, -25774.36638573008, -25750.61390274705, -25795.093836279437, -25607.763441825202, -25816.06928490739, -26032.52816587912, -25611.90048073366, -25758.81026738292, -25818.19909581026, -26021.667527199745, -25469.791996477663, -25662.03471436753, -25450.449219021648, -25721.838868787392, -25552.129775951857, -25781.631834194155, -25781.779352048346, -25769.891713527846, -25576.89087717169, -25775.058553851224, -25724.49296241185, -25938.574078295227, -25881.009915002218, -25980.650822639815, -25641.505980991944, -25657.719780325508, -25696.245921458067, -25920.578145431282, -26037.82700757382, -25671.338145087437, -25721.578692764626, -25656.373507476896, -25571.601382625424, -25668.30631840905, -25537.21193204283, -26026.414440841196, -25750.765021518066, -25888.63987625073, -25759.592285610575, -25602.9908198676, -25917.72251357423, -25625.738540594783, -25728.07455428508, -25766.671656894046, -25394.76801455681, -25524.319504516105, -25695.237048209357, -25443.608011136792, -25990.957539052048, -25620.486009063137, -25584.920994110576, -25737.453984501746, -25486.29476159542, -25615.386595685624, -25491.78692650146, -25788.11901700035, -25938.02912172231, -25645.68545622272, -25657.869840681724, -25912.577099563492, -26000.048036124903, -25645.351863889933, -25508.66099078769, -25802.368309252677, -25914.762618051565, -25843.30730086229, -25842.047477590306, -25815.192077501775, -25930.200027114544, -25496.92178648706, -25752.813173693678, -25753.395098784287, -25725.75446765467, -25673.519089850408, -25955.26576092845, -25642.890215674477, -25568.95617611713, -25548.1774575833, -25752.215860747718, -25909.517209893296, -25850.959082006375, -25610.5546102421, -25498.06790014565, -25700.241765192157, -25844.20282161848, -25809.050492066646, -25653.451397396937, -25694.216643221138, -25508.41792507436, -25793.831027332115], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.407175414079596, "mean_inference_ms": 0.24590130118588036, "mean_action_processing_ms": 0.05854044469828629, "mean_env_wait_ms": 1.4782007323229507, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0024271011352539062, "StateBufferConnector_ms": 0.0017902851104736328, "ViewRequirementAgentConnector_ms": 0.04454684257507324}}, "episode_reward_max": -25394.76801455681, "episode_reward_min": -26037.82700757382, "episode_reward_mean": -25734.393700082415, "episode_len_mean": 360.0, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-25739.55659743875, -25725.58944046207, -25968.460313317206, -25552.31023615267, -25826.14338231702, -25851.657935559237, -25870.772929873903, -25857.31829782494, -25725.81508575221, -25849.753606671016, -25774.36638573008, -25750.61390274705, -25795.093836279437, -25607.763441825202, -25816.06928490739, -26032.52816587912, -25611.90048073366, -25758.81026738292, -25818.19909581026, -26021.667527199745, -25469.791996477663, -25662.03471436753, -25450.449219021648, -25721.838868787392, -25552.129775951857, -25781.631834194155, -25781.779352048346, -25769.891713527846, -25576.89087717169, -25775.058553851224, -25724.49296241185, -25938.574078295227, -25881.009915002218, -25980.650822639815, -25641.505980991944, -25657.719780325508, -25696.245921458067, -25920.578145431282, -26037.82700757382, -25671.338145087437, -25721.578692764626, -25656.373507476896, -25571.601382625424, -25668.30631840905, -25537.21193204283, -26026.414440841196, -25750.765021518066, -25888.63987625073, -25759.592285610575, -25602.9908198676, -25917.72251357423, -25625.738540594783, -25728.07455428508, -25766.671656894046, -25394.76801455681, -25524.319504516105, -25695.237048209357, -25443.608011136792, -25990.957539052048, -25620.486009063137, -25584.920994110576, -25737.453984501746, -25486.29476159542, -25615.386595685624, -25491.78692650146, -25788.11901700035, -25938.02912172231, -25645.68545622272, -25657.869840681724, -25912.577099563492, -26000.048036124903, -25645.351863889933, -25508.66099078769, -25802.368309252677, -25914.762618051565, -25843.30730086229, -25842.047477590306, -25815.192077501775, -25930.200027114544, -25496.92178648706, -25752.813173693678, -25753.395098784287, -25725.75446765467, -25673.519089850408, -25955.26576092845, -25642.890215674477, -25568.95617611713, -25548.1774575833, -25752.215860747718, -25909.517209893296, -25850.959082006375, -25610.5546102421, -25498.06790014565, -25700.241765192157, -25844.20282161848, -25809.050492066646, -25653.451397396937, -25694.216643221138, -25508.41792507436, -25793.831027332115], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.407175414079596, "mean_inference_ms": 0.24590130118588036, "mean_action_processing_ms": 0.05854044469828629, "mean_env_wait_ms": 1.4782007323229507, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0024271011352539062, "StateBufferConnector_ms": 0.0017902851104736328, "ViewRequirementAgentConnector_ms": 0.04454684257507324}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 69840, "num_agent_steps_trained": 69840, "num_env_steps_sampled": 69840, "num_env_steps_trained": 69840, "num_env_steps_sampled_this_iter": 1800, "num_env_steps_trained_this_iter": 1800, "num_env_steps_sampled_throughput_per_sec": 161.53187842083287, "num_env_steps_trained_throughput_per_sec": 161.53187842083287, "timesteps_total": 69840, "num_steps_trained_this_iter": 1800, "agent_timesteps_total": 69840, "timers": {"training_iteration_time_ms": 2231.96, "sample_time_ms": 2224.795, "load_time_ms": 0.22, "load_throughput": 1636624.149, "learn_time_ms": 6.383, "learn_throughput": 56398.427, "synch_weights_time_ms": 0.529}, "counters": {"num_env_steps_sampled": 69840, "num_env_steps_trained": 69840, "num_agent_steps_sampled": 69840, "num_agent_steps_trained": 69840}, "done": false, "episodes_total": 194, "training_iteration": 39, "trial_id": "f5e97_00000", "date": "2023-07-25_17-03-08", "timestamp": 1690293788, "time_this_iter_s": 11.145535945892334, "time_total_s": 434.50235629081726, "pid": 71917, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[0, 0.003], [5400, 0.001], [10800, 0.00075], [16200, 0.0005], [21600, 0.00025], [27000, 0.0001], [32400, 7.5e-05], [37800, 5e-05], [43200, 2.5e-05], [48600, 1e-05], [54000, 7.5e-06], [59400, 5e-06], [64800, 2.5e-06], [70200, 1e-06], [75600, 5e-07], [81000, 1e-07]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x304530310>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 434.50235629081726, "iterations_since_restore": 39, "perf": {"cpu_util_percent": 25.65625, "ram_util_percent": 79.25625}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 9.000000000000001e-07, "entropy_coeff": 0.1, "policy_entropy": -926.6998168945313, "policy_loss": -116991876382720.0, "vf_loss": 1094632633.6}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 993.0, "diff_num_grad_updates_vs_sampler_policy": 992.0}}, "num_env_steps_sampled": 71640, "num_env_steps_trained": 71640, "num_agent_steps_sampled": 71640, "num_agent_steps_trained": 71640}, "sampler_results": {"episode_reward_max": -25394.76801455681, "episode_reward_min": -26094.663579417545, "episode_reward_mean": -25734.59997834596, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-25851.657935559237, -25870.772929873903, -25857.31829782494, -25725.81508575221, -25849.753606671016, -25774.36638573008, -25750.61390274705, -25795.093836279437, -25607.763441825202, -25816.06928490739, -26032.52816587912, -25611.90048073366, -25758.81026738292, -25818.19909581026, -26021.667527199745, -25469.791996477663, -25662.03471436753, -25450.449219021648, -25721.838868787392, -25552.129775951857, -25781.631834194155, -25781.779352048346, -25769.891713527846, -25576.89087717169, -25775.058553851224, -25724.49296241185, -25938.574078295227, -25881.009915002218, -25980.650822639815, -25641.505980991944, -25657.719780325508, -25696.245921458067, -25920.578145431282, -26037.82700757382, -25671.338145087437, -25721.578692764626, -25656.373507476896, -25571.601382625424, -25668.30631840905, -25537.21193204283, -26026.414440841196, -25750.765021518066, -25888.63987625073, -25759.592285610575, -25602.9908198676, -25917.72251357423, -25625.738540594783, -25728.07455428508, -25766.671656894046, -25394.76801455681, -25524.319504516105, -25695.237048209357, -25443.608011136792, -25990.957539052048, -25620.486009063137, -25584.920994110576, -25737.453984501746, -25486.29476159542, -25615.386595685624, -25491.78692650146, -25788.11901700035, -25938.02912172231, -25645.68545622272, -25657.869840681724, -25912.577099563492, -26000.048036124903, -25645.351863889933, -25508.66099078769, -25802.368309252677, -25914.762618051565, -25843.30730086229, -25842.047477590306, -25815.192077501775, -25930.200027114544, -25496.92178648706, -25752.813173693678, -25753.395098784287, -25725.75446765467, -25673.519089850408, -25955.26576092845, -25642.890215674477, -25568.95617611713, -25548.1774575833, -25752.215860747718, -25909.517209893296, -25850.959082006375, -25610.5546102421, -25498.06790014565, -25700.241765192157, -25844.20282161848, -25809.050492066646, -25653.451397396937, -25694.216643221138, -25508.41792507436, -25793.831027332115, -25697.684362738815, -25508.048711270992, -26094.663579417545, -25816.146718002194, -25716.144424613198], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.406933037556903, "mean_inference_ms": 0.2459408096359899, "mean_action_processing_ms": 0.05854429388629449, "mean_env_wait_ms": 1.4770455425036584, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0024237632751464844, "StateBufferConnector_ms": 0.001798868179321289, "ViewRequirementAgentConnector_ms": 0.04455089569091797}}, "episode_reward_max": -25394.76801455681, "episode_reward_min": -26094.663579417545, "episode_reward_mean": -25734.59997834596, "episode_len_mean": 360.0, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-25851.657935559237, -25870.772929873903, -25857.31829782494, -25725.81508575221, -25849.753606671016, -25774.36638573008, -25750.61390274705, -25795.093836279437, -25607.763441825202, -25816.06928490739, -26032.52816587912, -25611.90048073366, -25758.81026738292, -25818.19909581026, -26021.667527199745, -25469.791996477663, -25662.03471436753, -25450.449219021648, -25721.838868787392, -25552.129775951857, -25781.631834194155, -25781.779352048346, -25769.891713527846, -25576.89087717169, -25775.058553851224, -25724.49296241185, -25938.574078295227, -25881.009915002218, -25980.650822639815, -25641.505980991944, -25657.719780325508, -25696.245921458067, -25920.578145431282, -26037.82700757382, -25671.338145087437, -25721.578692764626, -25656.373507476896, -25571.601382625424, -25668.30631840905, -25537.21193204283, -26026.414440841196, -25750.765021518066, -25888.63987625073, -25759.592285610575, -25602.9908198676, -25917.72251357423, -25625.738540594783, -25728.07455428508, -25766.671656894046, -25394.76801455681, -25524.319504516105, -25695.237048209357, -25443.608011136792, -25990.957539052048, -25620.486009063137, -25584.920994110576, -25737.453984501746, -25486.29476159542, -25615.386595685624, -25491.78692650146, -25788.11901700035, -25938.02912172231, -25645.68545622272, -25657.869840681724, -25912.577099563492, -26000.048036124903, -25645.351863889933, -25508.66099078769, -25802.368309252677, -25914.762618051565, -25843.30730086229, -25842.047477590306, -25815.192077501775, -25930.200027114544, -25496.92178648706, -25752.813173693678, -25753.395098784287, -25725.75446765467, -25673.519089850408, -25955.26576092845, -25642.890215674477, -25568.95617611713, -25548.1774575833, -25752.215860747718, -25909.517209893296, -25850.959082006375, -25610.5546102421, -25498.06790014565, -25700.241765192157, -25844.20282161848, -25809.050492066646, -25653.451397396937, -25694.216643221138, -25508.41792507436, -25793.831027332115, -25697.684362738815, -25508.048711270992, -26094.663579417545, -25816.146718002194, -25716.144424613198], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.406933037556903, "mean_inference_ms": 0.2459408096359899, "mean_action_processing_ms": 0.05854429388629449, "mean_env_wait_ms": 1.4770455425036584, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0024237632751464844, "StateBufferConnector_ms": 0.001798868179321289, "ViewRequirementAgentConnector_ms": 0.04455089569091797}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 71640, "num_agent_steps_trained": 71640, "num_env_steps_sampled": 71640, "num_env_steps_trained": 71640, "num_env_steps_sampled_this_iter": 1800, "num_env_steps_trained_this_iter": 1800, "num_env_steps_sampled_throughput_per_sec": 162.18991123918983, "num_env_steps_trained_throughput_per_sec": 162.18991123918983, "timesteps_total": 71640, "num_steps_trained_this_iter": 1800, "agent_timesteps_total": 71640, "timers": {"training_iteration_time_ms": 2224.131, "sample_time_ms": 2216.934, "load_time_ms": 0.222, "load_throughput": 1618901.512, "learn_time_ms": 6.414, "learn_throughput": 56126.733, "synch_weights_time_ms": 0.529}, "counters": {"num_env_steps_sampled": 71640, "num_env_steps_trained": 71640, "num_agent_steps_sampled": 71640, "num_agent_steps_trained": 71640}, "done": false, "episodes_total": 199, "training_iteration": 40, "trial_id": "f5e97_00000", "date": "2023-07-25_17-03-19", "timestamp": 1690293799, "time_this_iter_s": 11.100214004516602, "time_total_s": 445.60257029533386, "pid": 71917, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[0, 0.003], [5400, 0.001], [10800, 0.00075], [16200, 0.0005], [21600, 0.00025], [27000, 0.0001], [32400, 7.5e-05], [37800, 5e-05], [43200, 2.5e-05], [48600, 1e-05], [54000, 7.5e-06], [59400, 5e-06], [64800, 2.5e-06], [70200, 1e-06], [75600, 5e-07], [81000, 1e-07]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x304530310>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 445.60257029533386, "iterations_since_restore": 40, "perf": {"cpu_util_percent": 22.28125, "ram_util_percent": 79.03125}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 7.333333333333332e-07, "entropy_coeff": 0.1, "policy_entropy": -926.6996826171875, "policy_loss": -632991642773094.4, "vf_loss": 1109097075.2}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 1018.0, "diff_num_grad_updates_vs_sampler_policy": 1017.0}}, "num_env_steps_sampled": 73440, "num_env_steps_trained": 73440, "num_agent_steps_sampled": 73440, "num_agent_steps_trained": 73440}, "sampler_results": {"episode_reward_max": -25394.76801455681, "episode_reward_min": -26094.663579417545, "episode_reward_mean": -25729.573312506873, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-25774.36638573008, -25750.61390274705, -25795.093836279437, -25607.763441825202, -25816.06928490739, -26032.52816587912, -25611.90048073366, -25758.81026738292, -25818.19909581026, -26021.667527199745, -25469.791996477663, -25662.03471436753, -25450.449219021648, -25721.838868787392, -25552.129775951857, -25781.631834194155, -25781.779352048346, -25769.891713527846, -25576.89087717169, -25775.058553851224, -25724.49296241185, -25938.574078295227, -25881.009915002218, -25980.650822639815, -25641.505980991944, -25657.719780325508, -25696.245921458067, -25920.578145431282, -26037.82700757382, -25671.338145087437, -25721.578692764626, -25656.373507476896, -25571.601382625424, -25668.30631840905, -25537.21193204283, -26026.414440841196, -25750.765021518066, -25888.63987625073, -25759.592285610575, -25602.9908198676, -25917.72251357423, -25625.738540594783, -25728.07455428508, -25766.671656894046, -25394.76801455681, -25524.319504516105, -25695.237048209357, -25443.608011136792, -25990.957539052048, -25620.486009063137, -25584.920994110576, -25737.453984501746, -25486.29476159542, -25615.386595685624, -25491.78692650146, -25788.11901700035, -25938.02912172231, -25645.68545622272, -25657.869840681724, -25912.577099563492, -26000.048036124903, -25645.351863889933, -25508.66099078769, -25802.368309252677, -25914.762618051565, -25843.30730086229, -25842.047477590306, -25815.192077501775, -25930.200027114544, -25496.92178648706, -25752.813173693678, -25753.395098784287, -25725.75446765467, -25673.519089850408, -25955.26576092845, -25642.890215674477, -25568.95617611713, -25548.1774575833, -25752.215860747718, -25909.517209893296, -25850.959082006375, -25610.5546102421, -25498.06790014565, -25700.241765192157, -25844.20282161848, -25809.050492066646, -25653.451397396937, -25694.216643221138, -25508.41792507436, -25793.831027332115, -25697.684362738815, -25508.048711270992, -26094.663579417545, -25816.146718002194, -25716.144424613198, -25716.9481468649, -25665.566155129305, -25659.414796121277, -25772.670297136126, -25838.051876520363], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.406662361871798, "mean_inference_ms": 0.24597669751023304, "mean_action_processing_ms": 0.05854795028074477, "mean_env_wait_ms": 1.4759650096349504, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0024192333221435547, "StateBufferConnector_ms": 0.0017955303192138672, "ViewRequirementAgentConnector_ms": 0.044561147689819336}}, "episode_reward_max": -25394.76801455681, "episode_reward_min": -26094.663579417545, "episode_reward_mean": -25729.573312506873, "episode_len_mean": 360.0, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-25774.36638573008, -25750.61390274705, -25795.093836279437, -25607.763441825202, -25816.06928490739, -26032.52816587912, -25611.90048073366, -25758.81026738292, -25818.19909581026, -26021.667527199745, -25469.791996477663, -25662.03471436753, -25450.449219021648, -25721.838868787392, -25552.129775951857, -25781.631834194155, -25781.779352048346, -25769.891713527846, -25576.89087717169, -25775.058553851224, -25724.49296241185, -25938.574078295227, -25881.009915002218, -25980.650822639815, -25641.505980991944, -25657.719780325508, -25696.245921458067, -25920.578145431282, -26037.82700757382, -25671.338145087437, -25721.578692764626, -25656.373507476896, -25571.601382625424, -25668.30631840905, -25537.21193204283, -26026.414440841196, -25750.765021518066, -25888.63987625073, -25759.592285610575, -25602.9908198676, -25917.72251357423, -25625.738540594783, -25728.07455428508, -25766.671656894046, -25394.76801455681, -25524.319504516105, -25695.237048209357, -25443.608011136792, -25990.957539052048, -25620.486009063137, -25584.920994110576, -25737.453984501746, -25486.29476159542, -25615.386595685624, -25491.78692650146, -25788.11901700035, -25938.02912172231, -25645.68545622272, -25657.869840681724, -25912.577099563492, -26000.048036124903, -25645.351863889933, -25508.66099078769, -25802.368309252677, -25914.762618051565, -25843.30730086229, -25842.047477590306, -25815.192077501775, -25930.200027114544, -25496.92178648706, -25752.813173693678, -25753.395098784287, -25725.75446765467, -25673.519089850408, -25955.26576092845, -25642.890215674477, -25568.95617611713, -25548.1774575833, -25752.215860747718, -25909.517209893296, -25850.959082006375, -25610.5546102421, -25498.06790014565, -25700.241765192157, -25844.20282161848, -25809.050492066646, -25653.451397396937, -25694.216643221138, -25508.41792507436, -25793.831027332115, -25697.684362738815, -25508.048711270992, -26094.663579417545, -25816.146718002194, -25716.144424613198, -25716.9481468649, -25665.566155129305, -25659.414796121277, -25772.670297136126, -25838.051876520363], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.406662361871798, "mean_inference_ms": 0.24597669751023304, "mean_action_processing_ms": 0.05854795028074477, "mean_env_wait_ms": 1.4759650096349504, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0024192333221435547, "StateBufferConnector_ms": 0.0017955303192138672, "ViewRequirementAgentConnector_ms": 0.044561147689819336}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 73440, "num_agent_steps_trained": 73440, "num_env_steps_sampled": 73440, "num_env_steps_trained": 73440, "num_env_steps_sampled_this_iter": 1800, "num_env_steps_trained_this_iter": 1800, "num_env_steps_sampled_throughput_per_sec": 162.4375589555126, "num_env_steps_trained_throughput_per_sec": 162.4375589555126, "timesteps_total": 73440, "num_steps_trained_this_iter": 1800, "agent_timesteps_total": 73440, "timers": {"training_iteration_time_ms": 2217.918, "sample_time_ms": 2210.495, "load_time_ms": 0.222, "load_throughput": 1619943.611, "learn_time_ms": 6.603, "learn_throughput": 54518.486, "synch_weights_time_ms": 0.566}, "counters": {"num_env_steps_sampled": 73440, "num_env_steps_trained": 73440, "num_agent_steps_sampled": 73440, "num_agent_steps_trained": 73440}, "done": false, "episodes_total": 204, "training_iteration": 41, "trial_id": "f5e97_00000", "date": "2023-07-25_17-03-30", "timestamp": 1690293810, "time_this_iter_s": 11.083328008651733, "time_total_s": 456.6858983039856, "pid": 71917, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[0, 0.003], [5400, 0.001], [10800, 0.00075], [16200, 0.0005], [21600, 0.00025], [27000, 0.0001], [32400, 7.5e-05], [37800, 5e-05], [43200, 2.5e-05], [48600, 1e-05], [54000, 7.5e-06], [59400, 5e-06], [64800, 2.5e-06], [70200, 1e-06], [75600, 5e-07], [81000, 1e-07]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x304530310>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 456.6858983039856, "iterations_since_restore": 41, "perf": {"cpu_util_percent": 25.30625, "ram_util_percent": 78.94999999999999}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 5.666666666666666e-07, "entropy_coeff": 0.1, "policy_entropy": -926.6996948242188, "policy_loss": -86108348750233.6, "vf_loss": 1091821644.8}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 1043.0, "diff_num_grad_updates_vs_sampler_policy": 1042.0}}, "num_env_steps_sampled": 75240, "num_env_steps_trained": 75240, "num_agent_steps_sampled": 75240, "num_agent_steps_trained": 75240}, "sampler_results": {"episode_reward_max": -25394.76801455681, "episode_reward_min": -26094.663579417545, "episode_reward_mean": -25726.31623867633, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-26032.52816587912, -25611.90048073366, -25758.81026738292, -25818.19909581026, -26021.667527199745, -25469.791996477663, -25662.03471436753, -25450.449219021648, -25721.838868787392, -25552.129775951857, -25781.631834194155, -25781.779352048346, -25769.891713527846, -25576.89087717169, -25775.058553851224, -25724.49296241185, -25938.574078295227, -25881.009915002218, -25980.650822639815, -25641.505980991944, -25657.719780325508, -25696.245921458067, -25920.578145431282, -26037.82700757382, -25671.338145087437, -25721.578692764626, -25656.373507476896, -25571.601382625424, -25668.30631840905, -25537.21193204283, -26026.414440841196, -25750.765021518066, -25888.63987625073, -25759.592285610575, -25602.9908198676, -25917.72251357423, -25625.738540594783, -25728.07455428508, -25766.671656894046, -25394.76801455681, -25524.319504516105, -25695.237048209357, -25443.608011136792, -25990.957539052048, -25620.486009063137, -25584.920994110576, -25737.453984501746, -25486.29476159542, -25615.386595685624, -25491.78692650146, -25788.11901700035, -25938.02912172231, -25645.68545622272, -25657.869840681724, -25912.577099563492, -26000.048036124903, -25645.351863889933, -25508.66099078769, -25802.368309252677, -25914.762618051565, -25843.30730086229, -25842.047477590306, -25815.192077501775, -25930.200027114544, -25496.92178648706, -25752.813173693678, -25753.395098784287, -25725.75446765467, -25673.519089850408, -25955.26576092845, -25642.890215674477, -25568.95617611713, -25548.1774575833, -25752.215860747718, -25909.517209893296, -25850.959082006375, -25610.5546102421, -25498.06790014565, -25700.241765192157, -25844.20282161848, -25809.050492066646, -25653.451397396937, -25694.216643221138, -25508.41792507436, -25793.831027332115, -25697.684362738815, -25508.048711270992, -26094.663579417545, -25816.146718002194, -25716.144424613198, -25716.9481468649, -25665.566155129305, -25659.414796121277, -25772.670297136126, -25838.051876520363, -25714.847273388325, -25604.794673633114, -25870.42453626149, -25584.03090843049, -25644.102076721312], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.406380917519945, "mean_inference_ms": 0.24601867825923954, "mean_action_processing_ms": 0.05855210502815925, "mean_env_wait_ms": 1.4749635119821978, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002414703369140625, "StateBufferConnector_ms": 0.001800537109375, "ViewRequirementAgentConnector_ms": 0.04454636573791504}}, "episode_reward_max": -25394.76801455681, "episode_reward_min": -26094.663579417545, "episode_reward_mean": -25726.31623867633, "episode_len_mean": 360.0, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-26032.52816587912, -25611.90048073366, -25758.81026738292, -25818.19909581026, -26021.667527199745, -25469.791996477663, -25662.03471436753, -25450.449219021648, -25721.838868787392, -25552.129775951857, -25781.631834194155, -25781.779352048346, -25769.891713527846, -25576.89087717169, -25775.058553851224, -25724.49296241185, -25938.574078295227, -25881.009915002218, -25980.650822639815, -25641.505980991944, -25657.719780325508, -25696.245921458067, -25920.578145431282, -26037.82700757382, -25671.338145087437, -25721.578692764626, -25656.373507476896, -25571.601382625424, -25668.30631840905, -25537.21193204283, -26026.414440841196, -25750.765021518066, -25888.63987625073, -25759.592285610575, -25602.9908198676, -25917.72251357423, -25625.738540594783, -25728.07455428508, -25766.671656894046, -25394.76801455681, -25524.319504516105, -25695.237048209357, -25443.608011136792, -25990.957539052048, -25620.486009063137, -25584.920994110576, -25737.453984501746, -25486.29476159542, -25615.386595685624, -25491.78692650146, -25788.11901700035, -25938.02912172231, -25645.68545622272, -25657.869840681724, -25912.577099563492, -26000.048036124903, -25645.351863889933, -25508.66099078769, -25802.368309252677, -25914.762618051565, -25843.30730086229, -25842.047477590306, -25815.192077501775, -25930.200027114544, -25496.92178648706, -25752.813173693678, -25753.395098784287, -25725.75446765467, -25673.519089850408, -25955.26576092845, -25642.890215674477, -25568.95617611713, -25548.1774575833, -25752.215860747718, -25909.517209893296, -25850.959082006375, -25610.5546102421, -25498.06790014565, -25700.241765192157, -25844.20282161848, -25809.050492066646, -25653.451397396937, -25694.216643221138, -25508.41792507436, -25793.831027332115, -25697.684362738815, -25508.048711270992, -26094.663579417545, -25816.146718002194, -25716.144424613198, -25716.9481468649, -25665.566155129305, -25659.414796121277, -25772.670297136126, -25838.051876520363, -25714.847273388325, -25604.794673633114, -25870.42453626149, -25584.03090843049, -25644.102076721312], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.406380917519945, "mean_inference_ms": 0.24601867825923954, "mean_action_processing_ms": 0.05855210502815925, "mean_env_wait_ms": 1.4749635119821978, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002414703369140625, "StateBufferConnector_ms": 0.001800537109375, "ViewRequirementAgentConnector_ms": 0.04454636573791504}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 75240, "num_agent_steps_trained": 75240, "num_env_steps_sampled": 75240, "num_env_steps_trained": 75240, "num_env_steps_sampled_this_iter": 1800, "num_env_steps_trained_this_iter": 1800, "num_env_steps_sampled_throughput_per_sec": 160.72978791430768, "num_env_steps_trained_throughput_per_sec": 160.72978791430768, "timesteps_total": 75240, "num_steps_trained_this_iter": 1800, "agent_timesteps_total": 75240, "timers": {"training_iteration_time_ms": 2228.0, "sample_time_ms": 2220.647, "load_time_ms": 0.227, "load_throughput": 1585748.204, "learn_time_ms": 6.539, "learn_throughput": 55051.588, "synch_weights_time_ms": 0.554}, "counters": {"num_env_steps_sampled": 75240, "num_env_steps_trained": 75240, "num_agent_steps_sampled": 75240, "num_agent_steps_trained": 75240}, "done": false, "episodes_total": 209, "training_iteration": 42, "trial_id": "f5e97_00000", "date": "2023-07-25_17-03-41", "timestamp": 1690293821, "time_this_iter_s": 11.200932264328003, "time_total_s": 467.8868305683136, "pid": 71917, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[0, 0.003], [5400, 0.001], [10800, 0.00075], [16200, 0.0005], [21600, 0.00025], [27000, 0.0001], [32400, 7.5e-05], [37800, 5e-05], [43200, 2.5e-05], [48600, 1e-05], [54000, 7.5e-06], [59400, 5e-06], [64800, 2.5e-06], [70200, 1e-06], [75600, 5e-07], [81000, 1e-07]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x304530310>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 467.8868305683136, "iterations_since_restore": 42, "perf": {"cpu_util_percent": 25.91875, "ram_util_percent": 79.30000000000001}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 4.2000000000000006e-07, "entropy_coeff": 0.1, "policy_entropy": -926.6998046875, "policy_loss": -204763004800204.8, "vf_loss": 1087836633.6}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 1068.0, "diff_num_grad_updates_vs_sampler_policy": 1067.0}}, "num_env_steps_sampled": 77040, "num_env_steps_trained": 77040, "num_agent_steps_sampled": 77040, "num_agent_steps_trained": 77040}, "sampler_results": {"episode_reward_max": -25344.64897438416, "episode_reward_min": -26094.663579417545, "episode_reward_mean": -25717.640440182447, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-25469.791996477663, -25662.03471436753, -25450.449219021648, -25721.838868787392, -25552.129775951857, -25781.631834194155, -25781.779352048346, -25769.891713527846, -25576.89087717169, -25775.058553851224, -25724.49296241185, -25938.574078295227, -25881.009915002218, -25980.650822639815, -25641.505980991944, -25657.719780325508, -25696.245921458067, -25920.578145431282, -26037.82700757382, -25671.338145087437, -25721.578692764626, -25656.373507476896, -25571.601382625424, -25668.30631840905, -25537.21193204283, -26026.414440841196, -25750.765021518066, -25888.63987625073, -25759.592285610575, -25602.9908198676, -25917.72251357423, -25625.738540594783, -25728.07455428508, -25766.671656894046, -25394.76801455681, -25524.319504516105, -25695.237048209357, -25443.608011136792, -25990.957539052048, -25620.486009063137, -25584.920994110576, -25737.453984501746, -25486.29476159542, -25615.386595685624, -25491.78692650146, -25788.11901700035, -25938.02912172231, -25645.68545622272, -25657.869840681724, -25912.577099563492, -26000.048036124903, -25645.351863889933, -25508.66099078769, -25802.368309252677, -25914.762618051565, -25843.30730086229, -25842.047477590306, -25815.192077501775, -25930.200027114544, -25496.92178648706, -25752.813173693678, -25753.395098784287, -25725.75446765467, -25673.519089850408, -25955.26576092845, -25642.890215674477, -25568.95617611713, -25548.1774575833, -25752.215860747718, -25909.517209893296, -25850.959082006375, -25610.5546102421, -25498.06790014565, -25700.241765192157, -25844.20282161848, -25809.050492066646, -25653.451397396937, -25694.216643221138, -25508.41792507436, -25793.831027332115, -25697.684362738815, -25508.048711270992, -26094.663579417545, -25816.146718002194, -25716.144424613198, -25716.9481468649, -25665.566155129305, -25659.414796121277, -25772.670297136126, -25838.051876520363, -25714.847273388325, -25604.794673633114, -25870.42453626149, -25584.03090843049, -25644.102076721312, -25752.654664348305, -25728.72420860095, -25344.64897438416, -25870.13531983831, -25679.36252044645], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.406086971547203, "mean_inference_ms": 0.24605798349607053, "mean_action_processing_ms": 0.05855612861666733, "mean_env_wait_ms": 1.474066024888453, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0024220943450927734, "StateBufferConnector_ms": 0.0017957687377929688, "ViewRequirementAgentConnector_ms": 0.044509172439575195}}, "episode_reward_max": -25344.64897438416, "episode_reward_min": -26094.663579417545, "episode_reward_mean": -25717.640440182447, "episode_len_mean": 360.0, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-25469.791996477663, -25662.03471436753, -25450.449219021648, -25721.838868787392, -25552.129775951857, -25781.631834194155, -25781.779352048346, -25769.891713527846, -25576.89087717169, -25775.058553851224, -25724.49296241185, -25938.574078295227, -25881.009915002218, -25980.650822639815, -25641.505980991944, -25657.719780325508, -25696.245921458067, -25920.578145431282, -26037.82700757382, -25671.338145087437, -25721.578692764626, -25656.373507476896, -25571.601382625424, -25668.30631840905, -25537.21193204283, -26026.414440841196, -25750.765021518066, -25888.63987625073, -25759.592285610575, -25602.9908198676, -25917.72251357423, -25625.738540594783, -25728.07455428508, -25766.671656894046, -25394.76801455681, -25524.319504516105, -25695.237048209357, -25443.608011136792, -25990.957539052048, -25620.486009063137, -25584.920994110576, -25737.453984501746, -25486.29476159542, -25615.386595685624, -25491.78692650146, -25788.11901700035, -25938.02912172231, -25645.68545622272, -25657.869840681724, -25912.577099563492, -26000.048036124903, -25645.351863889933, -25508.66099078769, -25802.368309252677, -25914.762618051565, -25843.30730086229, -25842.047477590306, -25815.192077501775, -25930.200027114544, -25496.92178648706, -25752.813173693678, -25753.395098784287, -25725.75446765467, -25673.519089850408, -25955.26576092845, -25642.890215674477, -25568.95617611713, -25548.1774575833, -25752.215860747718, -25909.517209893296, -25850.959082006375, -25610.5546102421, -25498.06790014565, -25700.241765192157, -25844.20282161848, -25809.050492066646, -25653.451397396937, -25694.216643221138, -25508.41792507436, -25793.831027332115, -25697.684362738815, -25508.048711270992, -26094.663579417545, -25816.146718002194, -25716.144424613198, -25716.9481468649, -25665.566155129305, -25659.414796121277, -25772.670297136126, -25838.051876520363, -25714.847273388325, -25604.794673633114, -25870.42453626149, -25584.03090843049, -25644.102076721312, -25752.654664348305, -25728.72420860095, -25344.64897438416, -25870.13531983831, -25679.36252044645], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.406086971547203, "mean_inference_ms": 0.24605798349607053, "mean_action_processing_ms": 0.05855612861666733, "mean_env_wait_ms": 1.474066024888453, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0024220943450927734, "StateBufferConnector_ms": 0.0017957687377929688, "ViewRequirementAgentConnector_ms": 0.044509172439575195}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 77040, "num_agent_steps_trained": 77040, "num_env_steps_sampled": 77040, "num_env_steps_trained": 77040, "num_env_steps_sampled_this_iter": 1800, "num_env_steps_trained_this_iter": 1800, "num_env_steps_sampled_throughput_per_sec": 160.87323638141146, "num_env_steps_trained_throughput_per_sec": 160.87323638141146, "timesteps_total": 77040, "num_steps_trained_this_iter": 1800, "agent_timesteps_total": 77040, "timers": {"training_iteration_time_ms": 2238.775, "sample_time_ms": 2231.634, "load_time_ms": 0.232, "load_throughput": 1554245.435, "learn_time_ms": 6.347, "learn_throughput": 56716.829, "synch_weights_time_ms": 0.527}, "counters": {"num_env_steps_sampled": 77040, "num_env_steps_trained": 77040, "num_agent_steps_sampled": 77040, "num_agent_steps_trained": 77040}, "done": false, "episodes_total": 214, "training_iteration": 43, "trial_id": "f5e97_00000", "date": "2023-07-25_17-03-53", "timestamp": 1690293833, "time_this_iter_s": 11.191191911697388, "time_total_s": 479.078022480011, "pid": 71917, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[0, 0.003], [5400, 0.001], [10800, 0.00075], [16200, 0.0005], [21600, 0.00025], [27000, 0.0001], [32400, 7.5e-05], [37800, 5e-05], [43200, 2.5e-05], [48600, 1e-05], [54000, 7.5e-06], [59400, 5e-06], [64800, 2.5e-06], [70200, 1e-06], [75600, 5e-07], [81000, 1e-07]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x304530310>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 479.078022480011, "iterations_since_restore": 43, "perf": {"cpu_util_percent": 28.15, "ram_util_percent": 78.53125}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 2.8666666666666664e-07, "entropy_coeff": 0.1, "policy_entropy": -926.6995361328125, "policy_loss": -83816225544601.6, "vf_loss": 1109260729.6}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 1093.0, "diff_num_grad_updates_vs_sampler_policy": 1092.0}}, "num_env_steps_sampled": 78840, "num_env_steps_trained": 78840, "num_agent_steps_sampled": 78840, "num_agent_steps_trained": 78840}, "sampler_results": {"episode_reward_max": -25344.64897438416, "episode_reward_min": -26094.663579417545, "episode_reward_mean": -25726.42511412576, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-25781.631834194155, -25781.779352048346, -25769.891713527846, -25576.89087717169, -25775.058553851224, -25724.49296241185, -25938.574078295227, -25881.009915002218, -25980.650822639815, -25641.505980991944, -25657.719780325508, -25696.245921458067, -25920.578145431282, -26037.82700757382, -25671.338145087437, -25721.578692764626, -25656.373507476896, -25571.601382625424, -25668.30631840905, -25537.21193204283, -26026.414440841196, -25750.765021518066, -25888.63987625073, -25759.592285610575, -25602.9908198676, -25917.72251357423, -25625.738540594783, -25728.07455428508, -25766.671656894046, -25394.76801455681, -25524.319504516105, -25695.237048209357, -25443.608011136792, -25990.957539052048, -25620.486009063137, -25584.920994110576, -25737.453984501746, -25486.29476159542, -25615.386595685624, -25491.78692650146, -25788.11901700035, -25938.02912172231, -25645.68545622272, -25657.869840681724, -25912.577099563492, -26000.048036124903, -25645.351863889933, -25508.66099078769, -25802.368309252677, -25914.762618051565, -25843.30730086229, -25842.047477590306, -25815.192077501775, -25930.200027114544, -25496.92178648706, -25752.813173693678, -25753.395098784287, -25725.75446765467, -25673.519089850408, -25955.26576092845, -25642.890215674477, -25568.95617611713, -25548.1774575833, -25752.215860747718, -25909.517209893296, -25850.959082006375, -25610.5546102421, -25498.06790014565, -25700.241765192157, -25844.20282161848, -25809.050492066646, -25653.451397396937, -25694.216643221138, -25508.41792507436, -25793.831027332115, -25697.684362738815, -25508.048711270992, -26094.663579417545, -25816.146718002194, -25716.144424613198, -25716.9481468649, -25665.566155129305, -25659.414796121277, -25772.670297136126, -25838.051876520363, -25714.847273388325, -25604.794673633114, -25870.42453626149, -25584.03090843049, -25644.102076721312, -25752.654664348305, -25728.72420860095, -25344.64897438416, -25870.13531983831, -25679.36252044645, -25520.5175893975, -25877.87854023866, -25703.58373654276, -25725.653965028694, -25907.07813772965], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.405853104141549, "mean_inference_ms": 0.24609796563184666, "mean_action_processing_ms": 0.05855992162773061, "mean_env_wait_ms": 1.473262341120926, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0024225711822509766, "StateBufferConnector_ms": 0.0017948150634765625, "ViewRequirementAgentConnector_ms": 0.04453396797180176}}, "episode_reward_max": -25344.64897438416, "episode_reward_min": -26094.663579417545, "episode_reward_mean": -25726.42511412576, "episode_len_mean": 360.0, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-25781.631834194155, -25781.779352048346, -25769.891713527846, -25576.89087717169, -25775.058553851224, -25724.49296241185, -25938.574078295227, -25881.009915002218, -25980.650822639815, -25641.505980991944, -25657.719780325508, -25696.245921458067, -25920.578145431282, -26037.82700757382, -25671.338145087437, -25721.578692764626, -25656.373507476896, -25571.601382625424, -25668.30631840905, -25537.21193204283, -26026.414440841196, -25750.765021518066, -25888.63987625073, -25759.592285610575, -25602.9908198676, -25917.72251357423, -25625.738540594783, -25728.07455428508, -25766.671656894046, -25394.76801455681, -25524.319504516105, -25695.237048209357, -25443.608011136792, -25990.957539052048, -25620.486009063137, -25584.920994110576, -25737.453984501746, -25486.29476159542, -25615.386595685624, -25491.78692650146, -25788.11901700035, -25938.02912172231, -25645.68545622272, -25657.869840681724, -25912.577099563492, -26000.048036124903, -25645.351863889933, -25508.66099078769, -25802.368309252677, -25914.762618051565, -25843.30730086229, -25842.047477590306, -25815.192077501775, -25930.200027114544, -25496.92178648706, -25752.813173693678, -25753.395098784287, -25725.75446765467, -25673.519089850408, -25955.26576092845, -25642.890215674477, -25568.95617611713, -25548.1774575833, -25752.215860747718, -25909.517209893296, -25850.959082006375, -25610.5546102421, -25498.06790014565, -25700.241765192157, -25844.20282161848, -25809.050492066646, -25653.451397396937, -25694.216643221138, -25508.41792507436, -25793.831027332115, -25697.684362738815, -25508.048711270992, -26094.663579417545, -25816.146718002194, -25716.144424613198, -25716.9481468649, -25665.566155129305, -25659.414796121277, -25772.670297136126, -25838.051876520363, -25714.847273388325, -25604.794673633114, -25870.42453626149, -25584.03090843049, -25644.102076721312, -25752.654664348305, -25728.72420860095, -25344.64897438416, -25870.13531983831, -25679.36252044645, -25520.5175893975, -25877.87854023866, -25703.58373654276, -25725.653965028694, -25907.07813772965], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.405853104141549, "mean_inference_ms": 0.24609796563184666, "mean_action_processing_ms": 0.05855992162773061, "mean_env_wait_ms": 1.473262341120926, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0024225711822509766, "StateBufferConnector_ms": 0.0017948150634765625, "ViewRequirementAgentConnector_ms": 0.04453396797180176}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 78840, "num_agent_steps_trained": 78840, "num_env_steps_sampled": 78840, "num_env_steps_trained": 78840, "num_env_steps_sampled_this_iter": 1800, "num_env_steps_trained_this_iter": 1800, "num_env_steps_sampled_throughput_per_sec": 159.91216778961598, "num_env_steps_trained_throughput_per_sec": 159.91216778961598, "timesteps_total": 78840, "num_steps_trained_this_iter": 1800, "agent_timesteps_total": 78840, "timers": {"training_iteration_time_ms": 2244.502, "sample_time_ms": 2237.288, "load_time_ms": 0.223, "load_throughput": 1612504.742, "learn_time_ms": 6.423, "learn_throughput": 56045.485, "synch_weights_time_ms": 0.532}, "counters": {"num_env_steps_sampled": 78840, "num_env_steps_trained": 78840, "num_agent_steps_sampled": 78840, "num_agent_steps_trained": 78840}, "done": false, "episodes_total": 219, "training_iteration": 44, "trial_id": "f5e97_00000", "date": "2023-07-25_17-04-04", "timestamp": 1690293844, "time_this_iter_s": 11.258502960205078, "time_total_s": 490.33652544021606, "pid": 71917, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[0, 0.003], [5400, 0.001], [10800, 0.00075], [16200, 0.0005], [21600, 0.00025], [27000, 0.0001], [32400, 7.5e-05], [37800, 5e-05], [43200, 2.5e-05], [48600, 1e-05], [54000, 7.5e-06], [59400, 5e-06], [64800, 2.5e-06], [70200, 1e-06], [75600, 5e-07], [81000, 1e-07]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x304530310>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 490.33652544021606, "iterations_since_restore": 44, "perf": {"cpu_util_percent": 26.8, "ram_util_percent": 79.36875}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1.5333333333333333e-07, "entropy_coeff": 0.1, "policy_entropy": -926.6996826171875, "policy_loss": -51417607058227.2, "vf_loss": 1100720806.4}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 1118.0, "diff_num_grad_updates_vs_sampler_policy": 1117.0}}, "num_env_steps_sampled": 80640, "num_env_steps_trained": 80640, "num_agent_steps_sampled": 80640, "num_agent_steps_trained": 80640}, "sampler_results": {"episode_reward_max": -25344.64897438416, "episode_reward_min": -26094.663579417545, "episode_reward_mean": -25721.339051088846, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-25724.49296241185, -25938.574078295227, -25881.009915002218, -25980.650822639815, -25641.505980991944, -25657.719780325508, -25696.245921458067, -25920.578145431282, -26037.82700757382, -25671.338145087437, -25721.578692764626, -25656.373507476896, -25571.601382625424, -25668.30631840905, -25537.21193204283, -26026.414440841196, -25750.765021518066, -25888.63987625073, -25759.592285610575, -25602.9908198676, -25917.72251357423, -25625.738540594783, -25728.07455428508, -25766.671656894046, -25394.76801455681, -25524.319504516105, -25695.237048209357, -25443.608011136792, -25990.957539052048, -25620.486009063137, -25584.920994110576, -25737.453984501746, -25486.29476159542, -25615.386595685624, -25491.78692650146, -25788.11901700035, -25938.02912172231, -25645.68545622272, -25657.869840681724, -25912.577099563492, -26000.048036124903, -25645.351863889933, -25508.66099078769, -25802.368309252677, -25914.762618051565, -25843.30730086229, -25842.047477590306, -25815.192077501775, -25930.200027114544, -25496.92178648706, -25752.813173693678, -25753.395098784287, -25725.75446765467, -25673.519089850408, -25955.26576092845, -25642.890215674477, -25568.95617611713, -25548.1774575833, -25752.215860747718, -25909.517209893296, -25850.959082006375, -25610.5546102421, -25498.06790014565, -25700.241765192157, -25844.20282161848, -25809.050492066646, -25653.451397396937, -25694.216643221138, -25508.41792507436, -25793.831027332115, -25697.684362738815, -25508.048711270992, -26094.663579417545, -25816.146718002194, -25716.144424613198, -25716.9481468649, -25665.566155129305, -25659.414796121277, -25772.670297136126, -25838.051876520363, -25714.847273388325, -25604.794673633114, -25870.42453626149, -25584.03090843049, -25644.102076721312, -25752.654664348305, -25728.72420860095, -25344.64897438416, -25870.13531983831, -25679.36252044645, -25520.5175893975, -25877.87854023866, -25703.58373654276, -25725.653965028694, -25907.07813772965, -25727.131715233652, -25480.010086560058, -25445.419991757793, -25741.123343990854, -25782.960889559843], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.405599961272388, "mean_inference_ms": 0.24613922630237753, "mean_action_processing_ms": 0.05856425294921408, "mean_env_wait_ms": 1.4725137209825032, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002420186996459961, "StateBufferConnector_ms": 0.0017840862274169922, "ViewRequirementAgentConnector_ms": 0.04447746276855469}}, "episode_reward_max": -25344.64897438416, "episode_reward_min": -26094.663579417545, "episode_reward_mean": -25721.339051088846, "episode_len_mean": 360.0, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-25724.49296241185, -25938.574078295227, -25881.009915002218, -25980.650822639815, -25641.505980991944, -25657.719780325508, -25696.245921458067, -25920.578145431282, -26037.82700757382, -25671.338145087437, -25721.578692764626, -25656.373507476896, -25571.601382625424, -25668.30631840905, -25537.21193204283, -26026.414440841196, -25750.765021518066, -25888.63987625073, -25759.592285610575, -25602.9908198676, -25917.72251357423, -25625.738540594783, -25728.07455428508, -25766.671656894046, -25394.76801455681, -25524.319504516105, -25695.237048209357, -25443.608011136792, -25990.957539052048, -25620.486009063137, -25584.920994110576, -25737.453984501746, -25486.29476159542, -25615.386595685624, -25491.78692650146, -25788.11901700035, -25938.02912172231, -25645.68545622272, -25657.869840681724, -25912.577099563492, -26000.048036124903, -25645.351863889933, -25508.66099078769, -25802.368309252677, -25914.762618051565, -25843.30730086229, -25842.047477590306, -25815.192077501775, -25930.200027114544, -25496.92178648706, -25752.813173693678, -25753.395098784287, -25725.75446765467, -25673.519089850408, -25955.26576092845, -25642.890215674477, -25568.95617611713, -25548.1774575833, -25752.215860747718, -25909.517209893296, -25850.959082006375, -25610.5546102421, -25498.06790014565, -25700.241765192157, -25844.20282161848, -25809.050492066646, -25653.451397396937, -25694.216643221138, -25508.41792507436, -25793.831027332115, -25697.684362738815, -25508.048711270992, -26094.663579417545, -25816.146718002194, -25716.144424613198, -25716.9481468649, -25665.566155129305, -25659.414796121277, -25772.670297136126, -25838.051876520363, -25714.847273388325, -25604.794673633114, -25870.42453626149, -25584.03090843049, -25644.102076721312, -25752.654664348305, -25728.72420860095, -25344.64897438416, -25870.13531983831, -25679.36252044645, -25520.5175893975, -25877.87854023866, -25703.58373654276, -25725.653965028694, -25907.07813772965, -25727.131715233652, -25480.010086560058, -25445.419991757793, -25741.123343990854, -25782.960889559843], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.405599961272388, "mean_inference_ms": 0.24613922630237753, "mean_action_processing_ms": 0.05856425294921408, "mean_env_wait_ms": 1.4725137209825032, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002420186996459961, "StateBufferConnector_ms": 0.0017840862274169922, "ViewRequirementAgentConnector_ms": 0.04447746276855469}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 80640, "num_agent_steps_trained": 80640, "num_env_steps_sampled": 80640, "num_env_steps_trained": 80640, "num_env_steps_sampled_this_iter": 1800, "num_env_steps_trained_this_iter": 1800, "num_env_steps_sampled_throughput_per_sec": 162.1159524325132, "num_env_steps_trained_throughput_per_sec": 162.1159524325132, "timesteps_total": 80640, "num_steps_trained_this_iter": 1800, "agent_timesteps_total": 80640, "timers": {"training_iteration_time_ms": 2235.924, "sample_time_ms": 2228.432, "load_time_ms": 0.22, "load_throughput": 1633083.971, "learn_time_ms": 6.531, "learn_throughput": 55122.33, "synch_weights_time_ms": 0.708}, "counters": {"num_env_steps_sampled": 80640, "num_env_steps_trained": 80640, "num_agent_steps_sampled": 80640, "num_agent_steps_trained": 80640}, "done": false, "episodes_total": 224, "training_iteration": 45, "trial_id": "f5e97_00000", "date": "2023-07-25_17-04-15", "timestamp": 1690293855, "time_this_iter_s": 11.105710983276367, "time_total_s": 501.44223642349243, "pid": 71917, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[0, 0.003], [5400, 0.001], [10800, 0.00075], [16200, 0.0005], [21600, 0.00025], [27000, 0.0001], [32400, 7.5e-05], [37800, 5e-05], [43200, 2.5e-05], [48600, 1e-05], [54000, 7.5e-06], [59400, 5e-06], [64800, 2.5e-06], [70200, 1e-06], [75600, 5e-07], [81000, 1e-07]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x304530310>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 501.44223642349243, "iterations_since_restore": 45, "perf": {"cpu_util_percent": 26.143749999999997, "ram_util_percent": 78.38125}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-07, "entropy_coeff": 0.1, "policy_entropy": -926.6998779296875, "policy_loss": -35603367880294.4, "vf_loss": 1093982886.4}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 1143.0, "diff_num_grad_updates_vs_sampler_policy": 1142.0}}, "num_env_steps_sampled": 82440, "num_env_steps_trained": 82440, "num_agent_steps_sampled": 82440, "num_agent_steps_trained": 82440}, "sampler_results": {"episode_reward_max": -25344.64897438416, "episode_reward_min": -26094.663579417545, "episode_reward_mean": -25718.75789578295, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-25657.719780325508, -25696.245921458067, -25920.578145431282, -26037.82700757382, -25671.338145087437, -25721.578692764626, -25656.373507476896, -25571.601382625424, -25668.30631840905, -25537.21193204283, -26026.414440841196, -25750.765021518066, -25888.63987625073, -25759.592285610575, -25602.9908198676, -25917.72251357423, -25625.738540594783, -25728.07455428508, -25766.671656894046, -25394.76801455681, -25524.319504516105, -25695.237048209357, -25443.608011136792, -25990.957539052048, -25620.486009063137, -25584.920994110576, -25737.453984501746, -25486.29476159542, -25615.386595685624, -25491.78692650146, -25788.11901700035, -25938.02912172231, -25645.68545622272, -25657.869840681724, -25912.577099563492, -26000.048036124903, -25645.351863889933, -25508.66099078769, -25802.368309252677, -25914.762618051565, -25843.30730086229, -25842.047477590306, -25815.192077501775, -25930.200027114544, -25496.92178648706, -25752.813173693678, -25753.395098784287, -25725.75446765467, -25673.519089850408, -25955.26576092845, -25642.890215674477, -25568.95617611713, -25548.1774575833, -25752.215860747718, -25909.517209893296, -25850.959082006375, -25610.5546102421, -25498.06790014565, -25700.241765192157, -25844.20282161848, -25809.050492066646, -25653.451397396937, -25694.216643221138, -25508.41792507436, -25793.831027332115, -25697.684362738815, -25508.048711270992, -26094.663579417545, -25816.146718002194, -25716.144424613198, -25716.9481468649, -25665.566155129305, -25659.414796121277, -25772.670297136126, -25838.051876520363, -25714.847273388325, -25604.794673633114, -25870.42453626149, -25584.03090843049, -25644.102076721312, -25752.654664348305, -25728.72420860095, -25344.64897438416, -25870.13531983831, -25679.36252044645, -25520.5175893975, -25877.87854023866, -25703.58373654276, -25725.653965028694, -25907.07813772965, -25727.131715233652, -25480.010086560058, -25445.419991757793, -25741.123343990854, -25782.960889559843, -25872.899679976377, -25794.34741318721, -25799.76148173705, -25692.890423418765, -25748.219230430648], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.4053670957778115, "mean_inference_ms": 0.24617830659314152, "mean_action_processing_ms": 0.058568362296920994, "mean_env_wait_ms": 1.471800448274341, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002432107925415039, "StateBufferConnector_ms": 0.0017855167388916016, "ViewRequirementAgentConnector_ms": 0.04461407661437988}}, "episode_reward_max": -25344.64897438416, "episode_reward_min": -26094.663579417545, "episode_reward_mean": -25718.75789578295, "episode_len_mean": 360.0, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-25657.719780325508, -25696.245921458067, -25920.578145431282, -26037.82700757382, -25671.338145087437, -25721.578692764626, -25656.373507476896, -25571.601382625424, -25668.30631840905, -25537.21193204283, -26026.414440841196, -25750.765021518066, -25888.63987625073, -25759.592285610575, -25602.9908198676, -25917.72251357423, -25625.738540594783, -25728.07455428508, -25766.671656894046, -25394.76801455681, -25524.319504516105, -25695.237048209357, -25443.608011136792, -25990.957539052048, -25620.486009063137, -25584.920994110576, -25737.453984501746, -25486.29476159542, -25615.386595685624, -25491.78692650146, -25788.11901700035, -25938.02912172231, -25645.68545622272, -25657.869840681724, -25912.577099563492, -26000.048036124903, -25645.351863889933, -25508.66099078769, -25802.368309252677, -25914.762618051565, -25843.30730086229, -25842.047477590306, -25815.192077501775, -25930.200027114544, -25496.92178648706, -25752.813173693678, -25753.395098784287, -25725.75446765467, -25673.519089850408, -25955.26576092845, -25642.890215674477, -25568.95617611713, -25548.1774575833, -25752.215860747718, -25909.517209893296, -25850.959082006375, -25610.5546102421, -25498.06790014565, -25700.241765192157, -25844.20282161848, -25809.050492066646, -25653.451397396937, -25694.216643221138, -25508.41792507436, -25793.831027332115, -25697.684362738815, -25508.048711270992, -26094.663579417545, -25816.146718002194, -25716.144424613198, -25716.9481468649, -25665.566155129305, -25659.414796121277, -25772.670297136126, -25838.051876520363, -25714.847273388325, -25604.794673633114, -25870.42453626149, -25584.03090843049, -25644.102076721312, -25752.654664348305, -25728.72420860095, -25344.64897438416, -25870.13531983831, -25679.36252044645, -25520.5175893975, -25877.87854023866, -25703.58373654276, -25725.653965028694, -25907.07813772965, -25727.131715233652, -25480.010086560058, -25445.419991757793, -25741.123343990854, -25782.960889559843, -25872.899679976377, -25794.34741318721, -25799.76148173705, -25692.890423418765, -25748.219230430648], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.4053670957778115, "mean_inference_ms": 0.24617830659314152, "mean_action_processing_ms": 0.058568362296920994, "mean_env_wait_ms": 1.471800448274341, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002432107925415039, "StateBufferConnector_ms": 0.0017855167388916016, "ViewRequirementAgentConnector_ms": 0.04461407661437988}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 82440, "num_agent_steps_trained": 82440, "num_env_steps_sampled": 82440, "num_env_steps_trained": 82440, "num_env_steps_sampled_this_iter": 1800, "num_env_steps_trained_this_iter": 1800, "num_env_steps_sampled_throughput_per_sec": 161.68631927958046, "num_env_steps_trained_throughput_per_sec": 161.68631927958046, "timesteps_total": 82440, "num_steps_trained_this_iter": 1800, "agent_timesteps_total": 82440, "timers": {"training_iteration_time_ms": 2223.573, "sample_time_ms": 2216.185, "load_time_ms": 0.225, "load_throughput": 1599183.902, "learn_time_ms": 6.434, "learn_throughput": 55949.956, "synch_weights_time_ms": 0.696}, "counters": {"num_env_steps_sampled": 82440, "num_env_steps_trained": 82440, "num_agent_steps_sampled": 82440, "num_agent_steps_trained": 82440}, "done": false, "episodes_total": 229, "training_iteration": 46, "trial_id": "f5e97_00000", "date": "2023-07-25_17-04-26", "timestamp": 1690293866, "time_this_iter_s": 11.134746789932251, "time_total_s": 512.5769832134247, "pid": 71917, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[0, 0.003], [5400, 0.001], [10800, 0.00075], [16200, 0.0005], [21600, 0.00025], [27000, 0.0001], [32400, 7.5e-05], [37800, 5e-05], [43200, 2.5e-05], [48600, 1e-05], [54000, 7.5e-06], [59400, 5e-06], [64800, 2.5e-06], [70200, 1e-06], [75600, 5e-07], [81000, 1e-07]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x304530310>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 512.5769832134247, "iterations_since_restore": 46, "perf": {"cpu_util_percent": 23.253333333333334, "ram_util_percent": 78.82}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-07, "entropy_coeff": 0.1, "policy_entropy": -926.6999145507813, "policy_loss": -33843424018432.0, "vf_loss": 1086580096.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 1168.0, "diff_num_grad_updates_vs_sampler_policy": 1167.0}}, "num_env_steps_sampled": 84240, "num_env_steps_trained": 84240, "num_agent_steps_sampled": 84240, "num_agent_steps_trained": 84240}, "sampler_results": {"episode_reward_max": -25344.64897438416, "episode_reward_min": -26094.663579417545, "episode_reward_mean": -25718.27580363688, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-25721.578692764626, -25656.373507476896, -25571.601382625424, -25668.30631840905, -25537.21193204283, -26026.414440841196, -25750.765021518066, -25888.63987625073, -25759.592285610575, -25602.9908198676, -25917.72251357423, -25625.738540594783, -25728.07455428508, -25766.671656894046, -25394.76801455681, -25524.319504516105, -25695.237048209357, -25443.608011136792, -25990.957539052048, -25620.486009063137, -25584.920994110576, -25737.453984501746, -25486.29476159542, -25615.386595685624, -25491.78692650146, -25788.11901700035, -25938.02912172231, -25645.68545622272, -25657.869840681724, -25912.577099563492, -26000.048036124903, -25645.351863889933, -25508.66099078769, -25802.368309252677, -25914.762618051565, -25843.30730086229, -25842.047477590306, -25815.192077501775, -25930.200027114544, -25496.92178648706, -25752.813173693678, -25753.395098784287, -25725.75446765467, -25673.519089850408, -25955.26576092845, -25642.890215674477, -25568.95617611713, -25548.1774575833, -25752.215860747718, -25909.517209893296, -25850.959082006375, -25610.5546102421, -25498.06790014565, -25700.241765192157, -25844.20282161848, -25809.050492066646, -25653.451397396937, -25694.216643221138, -25508.41792507436, -25793.831027332115, -25697.684362738815, -25508.048711270992, -26094.663579417545, -25816.146718002194, -25716.144424613198, -25716.9481468649, -25665.566155129305, -25659.414796121277, -25772.670297136126, -25838.051876520363, -25714.847273388325, -25604.794673633114, -25870.42453626149, -25584.03090843049, -25644.102076721312, -25752.654664348305, -25728.72420860095, -25344.64897438416, -25870.13531983831, -25679.36252044645, -25520.5175893975, -25877.87854023866, -25703.58373654276, -25725.653965028694, -25907.07813772965, -25727.131715233652, -25480.010086560058, -25445.419991757793, -25741.123343990854, -25782.960889559843, -25872.899679976377, -25794.34741318721, -25799.76148173705, -25692.890423418765, -25748.219230430648, -25736.440535675774, -25811.304235029627, -25784.8955521969, -25953.75570528783, -25649.10375708023], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.405056469707622, "mean_inference_ms": 0.24621614247303644, "mean_action_processing_ms": 0.058572916117082506, "mean_env_wait_ms": 1.4711327920843889, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0024309158325195312, "StateBufferConnector_ms": 0.0017871856689453125, "ViewRequirementAgentConnector_ms": 0.04458475112915039}}, "episode_reward_max": -25344.64897438416, "episode_reward_min": -26094.663579417545, "episode_reward_mean": -25718.27580363688, "episode_len_mean": 360.0, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-25721.578692764626, -25656.373507476896, -25571.601382625424, -25668.30631840905, -25537.21193204283, -26026.414440841196, -25750.765021518066, -25888.63987625073, -25759.592285610575, -25602.9908198676, -25917.72251357423, -25625.738540594783, -25728.07455428508, -25766.671656894046, -25394.76801455681, -25524.319504516105, -25695.237048209357, -25443.608011136792, -25990.957539052048, -25620.486009063137, -25584.920994110576, -25737.453984501746, -25486.29476159542, -25615.386595685624, -25491.78692650146, -25788.11901700035, -25938.02912172231, -25645.68545622272, -25657.869840681724, -25912.577099563492, -26000.048036124903, -25645.351863889933, -25508.66099078769, -25802.368309252677, -25914.762618051565, -25843.30730086229, -25842.047477590306, -25815.192077501775, -25930.200027114544, -25496.92178648706, -25752.813173693678, -25753.395098784287, -25725.75446765467, -25673.519089850408, -25955.26576092845, -25642.890215674477, -25568.95617611713, -25548.1774575833, -25752.215860747718, -25909.517209893296, -25850.959082006375, -25610.5546102421, -25498.06790014565, -25700.241765192157, -25844.20282161848, -25809.050492066646, -25653.451397396937, -25694.216643221138, -25508.41792507436, -25793.831027332115, -25697.684362738815, -25508.048711270992, -26094.663579417545, -25816.146718002194, -25716.144424613198, -25716.9481468649, -25665.566155129305, -25659.414796121277, -25772.670297136126, -25838.051876520363, -25714.847273388325, -25604.794673633114, -25870.42453626149, -25584.03090843049, -25644.102076721312, -25752.654664348305, -25728.72420860095, -25344.64897438416, -25870.13531983831, -25679.36252044645, -25520.5175893975, -25877.87854023866, -25703.58373654276, -25725.653965028694, -25907.07813772965, -25727.131715233652, -25480.010086560058, -25445.419991757793, -25741.123343990854, -25782.960889559843, -25872.899679976377, -25794.34741318721, -25799.76148173705, -25692.890423418765, -25748.219230430648, -25736.440535675774, -25811.304235029627, -25784.8955521969, -25953.75570528783, -25649.10375708023], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.405056469707622, "mean_inference_ms": 0.24621614247303644, "mean_action_processing_ms": 0.058572916117082506, "mean_env_wait_ms": 1.4711327920843889, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0024309158325195312, "StateBufferConnector_ms": 0.0017871856689453125, "ViewRequirementAgentConnector_ms": 0.04458475112915039}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 84240, "num_agent_steps_trained": 84240, "num_env_steps_sampled": 84240, "num_env_steps_trained": 84240, "num_env_steps_sampled_this_iter": 1800, "num_env_steps_trained_this_iter": 1800, "num_env_steps_sampled_throughput_per_sec": 161.6066127444759, "num_env_steps_trained_throughput_per_sec": 161.6066127444759, "timesteps_total": 84240, "num_steps_trained_this_iter": 1800, "agent_timesteps_total": 84240, "timers": {"training_iteration_time_ms": 2227.073, "sample_time_ms": 2219.893, "load_time_ms": 0.221, "load_throughput": 1627100.69, "learn_time_ms": 6.4, "learn_throughput": 56253.239, "synch_weights_time_ms": 0.527}, "counters": {"num_env_steps_sampled": 84240, "num_env_steps_trained": 84240, "num_agent_steps_sampled": 84240, "num_agent_steps_trained": 84240}, "done": false, "episodes_total": 234, "training_iteration": 47, "trial_id": "f5e97_00000", "date": "2023-07-25_17-04-37", "timestamp": 1690293877, "time_this_iter_s": 11.140347957611084, "time_total_s": 523.7173311710358, "pid": 71917, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[0, 0.003], [5400, 0.001], [10800, 0.00075], [16200, 0.0005], [21600, 0.00025], [27000, 0.0001], [32400, 7.5e-05], [37800, 5e-05], [43200, 2.5e-05], [48600, 1e-05], [54000, 7.5e-06], [59400, 5e-06], [64800, 2.5e-06], [70200, 1e-06], [75600, 5e-07], [81000, 1e-07]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x304530310>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 523.7173311710358, "iterations_since_restore": 47, "perf": {"cpu_util_percent": 25.4375, "ram_util_percent": 79.26249999999999}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-07, "entropy_coeff": 0.1, "policy_entropy": -926.6999145507813, "policy_loss": -37761210481868.8, "vf_loss": 1092571904.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 1193.0, "diff_num_grad_updates_vs_sampler_policy": 1192.0}}, "num_env_steps_sampled": 86040, "num_env_steps_trained": 86040, "num_agent_steps_sampled": 86040, "num_agent_steps_trained": 86040}, "sampler_results": {"episode_reward_max": -25344.64897438416, "episode_reward_min": -26205.70083769718, "episode_reward_mean": -25730.340403823127, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-26026.414440841196, -25750.765021518066, -25888.63987625073, -25759.592285610575, -25602.9908198676, -25917.72251357423, -25625.738540594783, -25728.07455428508, -25766.671656894046, -25394.76801455681, -25524.319504516105, -25695.237048209357, -25443.608011136792, -25990.957539052048, -25620.486009063137, -25584.920994110576, -25737.453984501746, -25486.29476159542, -25615.386595685624, -25491.78692650146, -25788.11901700035, -25938.02912172231, -25645.68545622272, -25657.869840681724, -25912.577099563492, -26000.048036124903, -25645.351863889933, -25508.66099078769, -25802.368309252677, -25914.762618051565, -25843.30730086229, -25842.047477590306, -25815.192077501775, -25930.200027114544, -25496.92178648706, -25752.813173693678, -25753.395098784287, -25725.75446765467, -25673.519089850408, -25955.26576092845, -25642.890215674477, -25568.95617611713, -25548.1774575833, -25752.215860747718, -25909.517209893296, -25850.959082006375, -25610.5546102421, -25498.06790014565, -25700.241765192157, -25844.20282161848, -25809.050492066646, -25653.451397396937, -25694.216643221138, -25508.41792507436, -25793.831027332115, -25697.684362738815, -25508.048711270992, -26094.663579417545, -25816.146718002194, -25716.144424613198, -25716.9481468649, -25665.566155129305, -25659.414796121277, -25772.670297136126, -25838.051876520363, -25714.847273388325, -25604.794673633114, -25870.42453626149, -25584.03090843049, -25644.102076721312, -25752.654664348305, -25728.72420860095, -25344.64897438416, -25870.13531983831, -25679.36252044645, -25520.5175893975, -25877.87854023866, -25703.58373654276, -25725.653965028694, -25907.07813772965, -25727.131715233652, -25480.010086560058, -25445.419991757793, -25741.123343990854, -25782.960889559843, -25872.899679976377, -25794.34741318721, -25799.76148173705, -25692.890423418765, -25748.219230430648, -25736.440535675774, -25811.304235029627, -25784.8955521969, -25953.75570528783, -25649.10375708023, -25940.48352988541, -25841.448422768386, -25735.38842146472, -26205.70083769718, -25638.51064012693], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.404884986380154, "mean_inference_ms": 0.2462542396016144, "mean_action_processing_ms": 0.05857809104985005, "mean_env_wait_ms": 1.4704654276776568, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0024285316467285156, "StateBufferConnector_ms": 0.0017790794372558594, "ViewRequirementAgentConnector_ms": 0.04448366165161133}}, "episode_reward_max": -25344.64897438416, "episode_reward_min": -26205.70083769718, "episode_reward_mean": -25730.340403823127, "episode_len_mean": 360.0, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-26026.414440841196, -25750.765021518066, -25888.63987625073, -25759.592285610575, -25602.9908198676, -25917.72251357423, -25625.738540594783, -25728.07455428508, -25766.671656894046, -25394.76801455681, -25524.319504516105, -25695.237048209357, -25443.608011136792, -25990.957539052048, -25620.486009063137, -25584.920994110576, -25737.453984501746, -25486.29476159542, -25615.386595685624, -25491.78692650146, -25788.11901700035, -25938.02912172231, -25645.68545622272, -25657.869840681724, -25912.577099563492, -26000.048036124903, -25645.351863889933, -25508.66099078769, -25802.368309252677, -25914.762618051565, -25843.30730086229, -25842.047477590306, -25815.192077501775, -25930.200027114544, -25496.92178648706, -25752.813173693678, -25753.395098784287, -25725.75446765467, -25673.519089850408, -25955.26576092845, -25642.890215674477, -25568.95617611713, -25548.1774575833, -25752.215860747718, -25909.517209893296, -25850.959082006375, -25610.5546102421, -25498.06790014565, -25700.241765192157, -25844.20282161848, -25809.050492066646, -25653.451397396937, -25694.216643221138, -25508.41792507436, -25793.831027332115, -25697.684362738815, -25508.048711270992, -26094.663579417545, -25816.146718002194, -25716.144424613198, -25716.9481468649, -25665.566155129305, -25659.414796121277, -25772.670297136126, -25838.051876520363, -25714.847273388325, -25604.794673633114, -25870.42453626149, -25584.03090843049, -25644.102076721312, -25752.654664348305, -25728.72420860095, -25344.64897438416, -25870.13531983831, -25679.36252044645, -25520.5175893975, -25877.87854023866, -25703.58373654276, -25725.653965028694, -25907.07813772965, -25727.131715233652, -25480.010086560058, -25445.419991757793, -25741.123343990854, -25782.960889559843, -25872.899679976377, -25794.34741318721, -25799.76148173705, -25692.890423418765, -25748.219230430648, -25736.440535675774, -25811.304235029627, -25784.8955521969, -25953.75570528783, -25649.10375708023, -25940.48352988541, -25841.448422768386, -25735.38842146472, -26205.70083769718, -25638.51064012693], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.404884986380154, "mean_inference_ms": 0.2462542396016144, "mean_action_processing_ms": 0.05857809104985005, "mean_env_wait_ms": 1.4704654276776568, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0024285316467285156, "StateBufferConnector_ms": 0.0017790794372558594, "ViewRequirementAgentConnector_ms": 0.04448366165161133}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 86040, "num_agent_steps_trained": 86040, "num_env_steps_sampled": 86040, "num_env_steps_trained": 86040, "num_env_steps_sampled_this_iter": 1800, "num_env_steps_trained_this_iter": 1800, "num_env_steps_sampled_throughput_per_sec": 159.9136445876707, "num_env_steps_trained_throughput_per_sec": 159.9136445876707, "timesteps_total": 86040, "num_steps_trained_this_iter": 1800, "agent_timesteps_total": 86040, "timers": {"training_iteration_time_ms": 2239.412, "sample_time_ms": 2232.041, "load_time_ms": 0.229, "load_throughput": 1571554.371, "learn_time_ms": 6.552, "learn_throughput": 54948.814, "synch_weights_time_ms": 0.552}, "counters": {"num_env_steps_sampled": 86040, "num_env_steps_trained": 86040, "num_agent_steps_sampled": 86040, "num_agent_steps_trained": 86040}, "done": false, "episodes_total": 239, "training_iteration": 48, "trial_id": "f5e97_00000", "date": "2023-07-25_17-04-49", "timestamp": 1690293889, "time_this_iter_s": 11.25835108757019, "time_total_s": 534.975682258606, "pid": 71917, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[0, 0.003], [5400, 0.001], [10800, 0.00075], [16200, 0.0005], [21600, 0.00025], [27000, 0.0001], [32400, 7.5e-05], [37800, 5e-05], [43200, 2.5e-05], [48600, 1e-05], [54000, 7.5e-06], [59400, 5e-06], [64800, 2.5e-06], [70200, 1e-06], [75600, 5e-07], [81000, 1e-07]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x304530310>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 534.975682258606, "iterations_since_restore": 48, "perf": {"cpu_util_percent": 27.2875, "ram_util_percent": 79.54375}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-07, "entropy_coeff": 0.1, "policy_entropy": -926.6997436523437, "policy_loss": -36480293063884.8, "vf_loss": 1112186329.6}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 1218.0, "diff_num_grad_updates_vs_sampler_policy": 1217.0}}, "num_env_steps_sampled": 87840, "num_env_steps_trained": 87840, "num_agent_steps_sampled": 87840, "num_agent_steps_trained": 87840}, "sampler_results": {"episode_reward_max": -25344.64897438416, "episode_reward_min": -26205.70083769718, "episode_reward_mean": -25734.870159191847, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-25917.72251357423, -25625.738540594783, -25728.07455428508, -25766.671656894046, -25394.76801455681, -25524.319504516105, -25695.237048209357, -25443.608011136792, -25990.957539052048, -25620.486009063137, -25584.920994110576, -25737.453984501746, -25486.29476159542, -25615.386595685624, -25491.78692650146, -25788.11901700035, -25938.02912172231, -25645.68545622272, -25657.869840681724, -25912.577099563492, -26000.048036124903, -25645.351863889933, -25508.66099078769, -25802.368309252677, -25914.762618051565, -25843.30730086229, -25842.047477590306, -25815.192077501775, -25930.200027114544, -25496.92178648706, -25752.813173693678, -25753.395098784287, -25725.75446765467, -25673.519089850408, -25955.26576092845, -25642.890215674477, -25568.95617611713, -25548.1774575833, -25752.215860747718, -25909.517209893296, -25850.959082006375, -25610.5546102421, -25498.06790014565, -25700.241765192157, -25844.20282161848, -25809.050492066646, -25653.451397396937, -25694.216643221138, -25508.41792507436, -25793.831027332115, -25697.684362738815, -25508.048711270992, -26094.663579417545, -25816.146718002194, -25716.144424613198, -25716.9481468649, -25665.566155129305, -25659.414796121277, -25772.670297136126, -25838.051876520363, -25714.847273388325, -25604.794673633114, -25870.42453626149, -25584.03090843049, -25644.102076721312, -25752.654664348305, -25728.72420860095, -25344.64897438416, -25870.13531983831, -25679.36252044645, -25520.5175893975, -25877.87854023866, -25703.58373654276, -25725.653965028694, -25907.07813772965, -25727.131715233652, -25480.010086560058, -25445.419991757793, -25741.123343990854, -25782.960889559843, -25872.899679976377, -25794.34741318721, -25799.76148173705, -25692.890423418765, -25748.219230430648, -25736.440535675774, -25811.304235029627, -25784.8955521969, -25953.75570528783, -25649.10375708023, -25940.48352988541, -25841.448422768386, -25735.38842146472, -26205.70083769718, -25638.51064012693, -26031.456607431224, -25792.880448707605, -25841.402077860756, -25972.625161817006, -25843.01368514434], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.404830431167354, "mean_inference_ms": 0.24629324881875056, "mean_action_processing_ms": 0.05858353825184048, "mean_env_wait_ms": 1.469838727661788, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0024132728576660156, "StateBufferConnector_ms": 0.0017657279968261719, "ViewRequirementAgentConnector_ms": 0.044367074966430664}}, "episode_reward_max": -25344.64897438416, "episode_reward_min": -26205.70083769718, "episode_reward_mean": -25734.870159191847, "episode_len_mean": 360.0, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-25917.72251357423, -25625.738540594783, -25728.07455428508, -25766.671656894046, -25394.76801455681, -25524.319504516105, -25695.237048209357, -25443.608011136792, -25990.957539052048, -25620.486009063137, -25584.920994110576, -25737.453984501746, -25486.29476159542, -25615.386595685624, -25491.78692650146, -25788.11901700035, -25938.02912172231, -25645.68545622272, -25657.869840681724, -25912.577099563492, -26000.048036124903, -25645.351863889933, -25508.66099078769, -25802.368309252677, -25914.762618051565, -25843.30730086229, -25842.047477590306, -25815.192077501775, -25930.200027114544, -25496.92178648706, -25752.813173693678, -25753.395098784287, -25725.75446765467, -25673.519089850408, -25955.26576092845, -25642.890215674477, -25568.95617611713, -25548.1774575833, -25752.215860747718, -25909.517209893296, -25850.959082006375, -25610.5546102421, -25498.06790014565, -25700.241765192157, -25844.20282161848, -25809.050492066646, -25653.451397396937, -25694.216643221138, -25508.41792507436, -25793.831027332115, -25697.684362738815, -25508.048711270992, -26094.663579417545, -25816.146718002194, -25716.144424613198, -25716.9481468649, -25665.566155129305, -25659.414796121277, -25772.670297136126, -25838.051876520363, -25714.847273388325, -25604.794673633114, -25870.42453626149, -25584.03090843049, -25644.102076721312, -25752.654664348305, -25728.72420860095, -25344.64897438416, -25870.13531983831, -25679.36252044645, -25520.5175893975, -25877.87854023866, -25703.58373654276, -25725.653965028694, -25907.07813772965, -25727.131715233652, -25480.010086560058, -25445.419991757793, -25741.123343990854, -25782.960889559843, -25872.899679976377, -25794.34741318721, -25799.76148173705, -25692.890423418765, -25748.219230430648, -25736.440535675774, -25811.304235029627, -25784.8955521969, -25953.75570528783, -25649.10375708023, -25940.48352988541, -25841.448422768386, -25735.38842146472, -26205.70083769718, -25638.51064012693, -26031.456607431224, -25792.880448707605, -25841.402077860756, -25972.625161817006, -25843.01368514434], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.404830431167354, "mean_inference_ms": 0.24629324881875056, "mean_action_processing_ms": 0.05858353825184048, "mean_env_wait_ms": 1.469838727661788, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0024132728576660156, "StateBufferConnector_ms": 0.0017657279968261719, "ViewRequirementAgentConnector_ms": 0.044367074966430664}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 87840, "num_agent_steps_trained": 87840, "num_env_steps_sampled": 87840, "num_env_steps_trained": 87840, "num_env_steps_sampled_this_iter": 1800, "num_env_steps_trained_this_iter": 1800, "num_env_steps_sampled_throughput_per_sec": 162.23698033647744, "num_env_steps_trained_throughput_per_sec": 162.23698033647744, "timesteps_total": 87840, "num_steps_trained_this_iter": 1800, "agent_timesteps_total": 87840, "timers": {"training_iteration_time_ms": 2235.084, "sample_time_ms": 2227.636, "load_time_ms": 0.23, "load_throughput": 1566825.195, "learn_time_ms": 6.631, "learn_throughput": 54292.659, "synch_weights_time_ms": 0.549}, "counters": {"num_env_steps_sampled": 87840, "num_env_steps_trained": 87840, "num_agent_steps_sampled": 87840, "num_agent_steps_trained": 87840}, "done": false, "episodes_total": 244, "training_iteration": 49, "trial_id": "f5e97_00000", "date": "2023-07-25_17-05-00", "timestamp": 1690293900, "time_this_iter_s": 11.096918106079102, "time_total_s": 546.0726003646851, "pid": 71917, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[0, 0.003], [5400, 0.001], [10800, 0.00075], [16200, 0.0005], [21600, 0.00025], [27000, 0.0001], [32400, 7.5e-05], [37800, 5e-05], [43200, 2.5e-05], [48600, 1e-05], [54000, 7.5e-06], [59400, 5e-06], [64800, 2.5e-06], [70200, 1e-06], [75600, 5e-07], [81000, 1e-07]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x304530310>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 546.0726003646851, "iterations_since_restore": 49, "perf": {"cpu_util_percent": 25.09375, "ram_util_percent": 78.10624999999999}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-07, "entropy_coeff": 0.1, "policy_entropy": -926.6995727539063, "policy_loss": -20080142267187.2, "vf_loss": 1112739385.6}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 1243.0, "diff_num_grad_updates_vs_sampler_policy": 1242.0}}, "num_env_steps_sampled": 89640, "num_env_steps_trained": 89640, "num_agent_steps_sampled": 89640, "num_agent_steps_trained": 89640}, "sampler_results": {"episode_reward_max": -25344.64897438416, "episode_reward_min": -26205.70083769718, "episode_reward_mean": -25739.114263222706, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-25524.319504516105, -25695.237048209357, -25443.608011136792, -25990.957539052048, -25620.486009063137, -25584.920994110576, -25737.453984501746, -25486.29476159542, -25615.386595685624, -25491.78692650146, -25788.11901700035, -25938.02912172231, -25645.68545622272, -25657.869840681724, -25912.577099563492, -26000.048036124903, -25645.351863889933, -25508.66099078769, -25802.368309252677, -25914.762618051565, -25843.30730086229, -25842.047477590306, -25815.192077501775, -25930.200027114544, -25496.92178648706, -25752.813173693678, -25753.395098784287, -25725.75446765467, -25673.519089850408, -25955.26576092845, -25642.890215674477, -25568.95617611713, -25548.1774575833, -25752.215860747718, -25909.517209893296, -25850.959082006375, -25610.5546102421, -25498.06790014565, -25700.241765192157, -25844.20282161848, -25809.050492066646, -25653.451397396937, -25694.216643221138, -25508.41792507436, -25793.831027332115, -25697.684362738815, -25508.048711270992, -26094.663579417545, -25816.146718002194, -25716.144424613198, -25716.9481468649, -25665.566155129305, -25659.414796121277, -25772.670297136126, -25838.051876520363, -25714.847273388325, -25604.794673633114, -25870.42453626149, -25584.03090843049, -25644.102076721312, -25752.654664348305, -25728.72420860095, -25344.64897438416, -25870.13531983831, -25679.36252044645, -25520.5175893975, -25877.87854023866, -25703.58373654276, -25725.653965028694, -25907.07813772965, -25727.131715233652, -25480.010086560058, -25445.419991757793, -25741.123343990854, -25782.960889559843, -25872.899679976377, -25794.34741318721, -25799.76148173705, -25692.890423418765, -25748.219230430648, -25736.440535675774, -25811.304235029627, -25784.8955521969, -25953.75570528783, -25649.10375708023, -25940.48352988541, -25841.448422768386, -25735.38842146472, -26205.70083769718, -25638.51064012693, -26031.456607431224, -25792.880448707605, -25841.402077860756, -25972.625161817006, -25843.01368514434, -25908.119496861847, -25692.733137276053, -25525.769012512654, -25823.480394710994, -25907.283641629238], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.404801882831276, "mean_inference_ms": 0.24632806336979915, "mean_action_processing_ms": 0.05858815873460152, "mean_env_wait_ms": 1.4693087250510157, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0024154186248779297, "StateBufferConnector_ms": 0.0017652511596679688, "ViewRequirementAgentConnector_ms": 0.04436230659484863}}, "episode_reward_max": -25344.64897438416, "episode_reward_min": -26205.70083769718, "episode_reward_mean": -25739.114263222706, "episode_len_mean": 360.0, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-25524.319504516105, -25695.237048209357, -25443.608011136792, -25990.957539052048, -25620.486009063137, -25584.920994110576, -25737.453984501746, -25486.29476159542, -25615.386595685624, -25491.78692650146, -25788.11901700035, -25938.02912172231, -25645.68545622272, -25657.869840681724, -25912.577099563492, -26000.048036124903, -25645.351863889933, -25508.66099078769, -25802.368309252677, -25914.762618051565, -25843.30730086229, -25842.047477590306, -25815.192077501775, -25930.200027114544, -25496.92178648706, -25752.813173693678, -25753.395098784287, -25725.75446765467, -25673.519089850408, -25955.26576092845, -25642.890215674477, -25568.95617611713, -25548.1774575833, -25752.215860747718, -25909.517209893296, -25850.959082006375, -25610.5546102421, -25498.06790014565, -25700.241765192157, -25844.20282161848, -25809.050492066646, -25653.451397396937, -25694.216643221138, -25508.41792507436, -25793.831027332115, -25697.684362738815, -25508.048711270992, -26094.663579417545, -25816.146718002194, -25716.144424613198, -25716.9481468649, -25665.566155129305, -25659.414796121277, -25772.670297136126, -25838.051876520363, -25714.847273388325, -25604.794673633114, -25870.42453626149, -25584.03090843049, -25644.102076721312, -25752.654664348305, -25728.72420860095, -25344.64897438416, -25870.13531983831, -25679.36252044645, -25520.5175893975, -25877.87854023866, -25703.58373654276, -25725.653965028694, -25907.07813772965, -25727.131715233652, -25480.010086560058, -25445.419991757793, -25741.123343990854, -25782.960889559843, -25872.899679976377, -25794.34741318721, -25799.76148173705, -25692.890423418765, -25748.219230430648, -25736.440535675774, -25811.304235029627, -25784.8955521969, -25953.75570528783, -25649.10375708023, -25940.48352988541, -25841.448422768386, -25735.38842146472, -26205.70083769718, -25638.51064012693, -26031.456607431224, -25792.880448707605, -25841.402077860756, -25972.625161817006, -25843.01368514434, -25908.119496861847, -25692.733137276053, -25525.769012512654, -25823.480394710994, -25907.283641629238], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.404801882831276, "mean_inference_ms": 0.24632806336979915, "mean_action_processing_ms": 0.05858815873460152, "mean_env_wait_ms": 1.4693087250510157, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0024154186248779297, "StateBufferConnector_ms": 0.0017652511596679688, "ViewRequirementAgentConnector_ms": 0.04436230659484863}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 89640, "num_agent_steps_trained": 89640, "num_env_steps_sampled": 89640, "num_env_steps_trained": 89640, "num_env_steps_sampled_this_iter": 1800, "num_env_steps_trained_this_iter": 1800, "num_env_steps_sampled_throughput_per_sec": 161.54739426454594, "num_env_steps_trained_throughput_per_sec": 161.54739426454594, "timesteps_total": 89640, "num_steps_trained_this_iter": 1800, "agent_timesteps_total": 89640, "timers": {"training_iteration_time_ms": 2223.702, "sample_time_ms": 2216.455, "load_time_ms": 0.216, "load_throughput": 1663672.807, "learn_time_ms": 6.481, "learn_throughput": 55546.134, "synch_weights_time_ms": 0.517}, "counters": {"num_env_steps_sampled": 89640, "num_env_steps_trained": 89640, "num_agent_steps_sampled": 89640, "num_agent_steps_trained": 89640}, "done": false, "episodes_total": 249, "training_iteration": 50, "trial_id": "f5e97_00000", "date": "2023-07-25_17-05-11", "timestamp": 1690293911, "time_this_iter_s": 11.144484996795654, "time_total_s": 557.2170853614807, "pid": 71917, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[0, 0.003], [5400, 0.001], [10800, 0.00075], [16200, 0.0005], [21600, 0.00025], [27000, 0.0001], [32400, 7.5e-05], [37800, 5e-05], [43200, 2.5e-05], [48600, 1e-05], [54000, 7.5e-06], [59400, 5e-06], [64800, 2.5e-06], [70200, 1e-06], [75600, 5e-07], [81000, 1e-07]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x304530310>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 557.2170853614807, "iterations_since_restore": 50, "perf": {"cpu_util_percent": 24.98125, "ram_util_percent": 77.13125}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-07, "entropy_coeff": 0.1, "policy_entropy": -926.7, "policy_loss": -16348247909990.4, "vf_loss": 1083442656.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 1268.0, "diff_num_grad_updates_vs_sampler_policy": 1267.0}}, "num_env_steps_sampled": 91440, "num_env_steps_trained": 91440, "num_agent_steps_sampled": 91440, "num_agent_steps_trained": 91440}, "sampler_results": {"episode_reward_max": -25344.64897438416, "episode_reward_min": -26205.70083769718, "episode_reward_mean": -25740.72816184436, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-25584.920994110576, -25737.453984501746, -25486.29476159542, -25615.386595685624, -25491.78692650146, -25788.11901700035, -25938.02912172231, -25645.68545622272, -25657.869840681724, -25912.577099563492, -26000.048036124903, -25645.351863889933, -25508.66099078769, -25802.368309252677, -25914.762618051565, -25843.30730086229, -25842.047477590306, -25815.192077501775, -25930.200027114544, -25496.92178648706, -25752.813173693678, -25753.395098784287, -25725.75446765467, -25673.519089850408, -25955.26576092845, -25642.890215674477, -25568.95617611713, -25548.1774575833, -25752.215860747718, -25909.517209893296, -25850.959082006375, -25610.5546102421, -25498.06790014565, -25700.241765192157, -25844.20282161848, -25809.050492066646, -25653.451397396937, -25694.216643221138, -25508.41792507436, -25793.831027332115, -25697.684362738815, -25508.048711270992, -26094.663579417545, -25816.146718002194, -25716.144424613198, -25716.9481468649, -25665.566155129305, -25659.414796121277, -25772.670297136126, -25838.051876520363, -25714.847273388325, -25604.794673633114, -25870.42453626149, -25584.03090843049, -25644.102076721312, -25752.654664348305, -25728.72420860095, -25344.64897438416, -25870.13531983831, -25679.36252044645, -25520.5175893975, -25877.87854023866, -25703.58373654276, -25725.653965028694, -25907.07813772965, -25727.131715233652, -25480.010086560058, -25445.419991757793, -25741.123343990854, -25782.960889559843, -25872.899679976377, -25794.34741318721, -25799.76148173705, -25692.890423418765, -25748.219230430648, -25736.440535675774, -25811.304235029627, -25784.8955521969, -25953.75570528783, -25649.10375708023, -25940.48352988541, -25841.448422768386, -25735.38842146472, -26205.70083769718, -25638.51064012693, -26031.456607431224, -25792.880448707605, -25841.402077860756, -25972.625161817006, -25843.01368514434, -25908.119496861847, -25692.733137276053, -25525.769012512654, -25823.480394710994, -25907.283641629238, -25515.59897538544, -25868.589035265955, -25577.18772125025, -25877.66864154889, -25596.9536006921], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.4047035163155055, "mean_inference_ms": 0.24635248703320323, "mean_action_processing_ms": 0.058591872254166406, "mean_env_wait_ms": 1.4688045181160652, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002413511276245117, "StateBufferConnector_ms": 0.0017559528350830078, "ViewRequirementAgentConnector_ms": 0.0442347526550293}}, "episode_reward_max": -25344.64897438416, "episode_reward_min": -26205.70083769718, "episode_reward_mean": -25740.72816184436, "episode_len_mean": 360.0, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-25584.920994110576, -25737.453984501746, -25486.29476159542, -25615.386595685624, -25491.78692650146, -25788.11901700035, -25938.02912172231, -25645.68545622272, -25657.869840681724, -25912.577099563492, -26000.048036124903, -25645.351863889933, -25508.66099078769, -25802.368309252677, -25914.762618051565, -25843.30730086229, -25842.047477590306, -25815.192077501775, -25930.200027114544, -25496.92178648706, -25752.813173693678, -25753.395098784287, -25725.75446765467, -25673.519089850408, -25955.26576092845, -25642.890215674477, -25568.95617611713, -25548.1774575833, -25752.215860747718, -25909.517209893296, -25850.959082006375, -25610.5546102421, -25498.06790014565, -25700.241765192157, -25844.20282161848, -25809.050492066646, -25653.451397396937, -25694.216643221138, -25508.41792507436, -25793.831027332115, -25697.684362738815, -25508.048711270992, -26094.663579417545, -25816.146718002194, -25716.144424613198, -25716.9481468649, -25665.566155129305, -25659.414796121277, -25772.670297136126, -25838.051876520363, -25714.847273388325, -25604.794673633114, -25870.42453626149, -25584.03090843049, -25644.102076721312, -25752.654664348305, -25728.72420860095, -25344.64897438416, -25870.13531983831, -25679.36252044645, -25520.5175893975, -25877.87854023866, -25703.58373654276, -25725.653965028694, -25907.07813772965, -25727.131715233652, -25480.010086560058, -25445.419991757793, -25741.123343990854, -25782.960889559843, -25872.899679976377, -25794.34741318721, -25799.76148173705, -25692.890423418765, -25748.219230430648, -25736.440535675774, -25811.304235029627, -25784.8955521969, -25953.75570528783, -25649.10375708023, -25940.48352988541, -25841.448422768386, -25735.38842146472, -26205.70083769718, -25638.51064012693, -26031.456607431224, -25792.880448707605, -25841.402077860756, -25972.625161817006, -25843.01368514434, -25908.119496861847, -25692.733137276053, -25525.769012512654, -25823.480394710994, -25907.283641629238, -25515.59897538544, -25868.589035265955, -25577.18772125025, -25877.66864154889, -25596.9536006921], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.4047035163155055, "mean_inference_ms": 0.24635248703320323, "mean_action_processing_ms": 0.058591872254166406, "mean_env_wait_ms": 1.4688045181160652, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002413511276245117, "StateBufferConnector_ms": 0.0017559528350830078, "ViewRequirementAgentConnector_ms": 0.0442347526550293}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 91440, "num_agent_steps_trained": 91440, "num_env_steps_sampled": 91440, "num_env_steps_trained": 91440, "num_env_steps_sampled_this_iter": 1800, "num_env_steps_trained_this_iter": 1800, "num_env_steps_sampled_throughput_per_sec": 162.39391880445163, "num_env_steps_trained_throughput_per_sec": 162.39391880445163, "timesteps_total": 91440, "num_steps_trained_this_iter": 1800, "agent_timesteps_total": 91440, "timers": {"training_iteration_time_ms": 2222.631, "sample_time_ms": 2215.395, "load_time_ms": 0.215, "load_throughput": 1670667.67, "learn_time_ms": 6.458, "learn_throughput": 55744.432, "synch_weights_time_ms": 0.529}, "counters": {"num_env_steps_sampled": 91440, "num_env_steps_trained": 91440, "num_agent_steps_sampled": 91440, "num_agent_steps_trained": 91440}, "done": false, "episodes_total": 254, "training_iteration": 51, "trial_id": "f5e97_00000", "date": "2023-07-25_17-05-22", "timestamp": 1690293922, "time_this_iter_s": 11.086271047592163, "time_total_s": 568.3033564090729, "pid": 71917, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[0, 0.003], [5400, 0.001], [10800, 0.00075], [16200, 0.0005], [21600, 0.00025], [27000, 0.0001], [32400, 7.5e-05], [37800, 5e-05], [43200, 2.5e-05], [48600, 1e-05], [54000, 7.5e-06], [59400, 5e-06], [64800, 2.5e-06], [70200, 1e-06], [75600, 5e-07], [81000, 1e-07]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x304530310>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 568.3033564090729, "iterations_since_restore": 51, "perf": {"cpu_util_percent": 25.56875, "ram_util_percent": 77.7}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-07, "entropy_coeff": 0.1, "policy_entropy": -926.7000122070312, "policy_loss": -25860170642227.2, "vf_loss": 1071450694.4}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 1293.0, "diff_num_grad_updates_vs_sampler_policy": 1292.0}}, "num_env_steps_sampled": 93240, "num_env_steps_trained": 93240, "num_agent_steps_sampled": 93240, "num_agent_steps_trained": 93240}, "sampler_results": {"episode_reward_max": -25344.64897438416, "episode_reward_min": -26205.70083769718, "episode_reward_mean": -25743.679870948996, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-25788.11901700035, -25938.02912172231, -25645.68545622272, -25657.869840681724, -25912.577099563492, -26000.048036124903, -25645.351863889933, -25508.66099078769, -25802.368309252677, -25914.762618051565, -25843.30730086229, -25842.047477590306, -25815.192077501775, -25930.200027114544, -25496.92178648706, -25752.813173693678, -25753.395098784287, -25725.75446765467, -25673.519089850408, -25955.26576092845, -25642.890215674477, -25568.95617611713, -25548.1774575833, -25752.215860747718, -25909.517209893296, -25850.959082006375, -25610.5546102421, -25498.06790014565, -25700.241765192157, -25844.20282161848, -25809.050492066646, -25653.451397396937, -25694.216643221138, -25508.41792507436, -25793.831027332115, -25697.684362738815, -25508.048711270992, -26094.663579417545, -25816.146718002194, -25716.144424613198, -25716.9481468649, -25665.566155129305, -25659.414796121277, -25772.670297136126, -25838.051876520363, -25714.847273388325, -25604.794673633114, -25870.42453626149, -25584.03090843049, -25644.102076721312, -25752.654664348305, -25728.72420860095, -25344.64897438416, -25870.13531983831, -25679.36252044645, -25520.5175893975, -25877.87854023866, -25703.58373654276, -25725.653965028694, -25907.07813772965, -25727.131715233652, -25480.010086560058, -25445.419991757793, -25741.123343990854, -25782.960889559843, -25872.899679976377, -25794.34741318721, -25799.76148173705, -25692.890423418765, -25748.219230430648, -25736.440535675774, -25811.304235029627, -25784.8955521969, -25953.75570528783, -25649.10375708023, -25940.48352988541, -25841.448422768386, -25735.38842146472, -26205.70083769718, -25638.51064012693, -26031.456607431224, -25792.880448707605, -25841.402077860756, -25972.625161817006, -25843.01368514434, -25908.119496861847, -25692.733137276053, -25525.769012512654, -25823.480394710994, -25907.283641629238, -25515.59897538544, -25868.589035265955, -25577.18772125025, -25877.66864154889, -25596.9536006921, -25788.25850036741, -25427.471536829886, -26112.41235184759, -25471.38449448666, -25411.487289326662], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.404612373187996, "mean_inference_ms": 0.24637587108582223, "mean_action_processing_ms": 0.058595684924662945, "mean_env_wait_ms": 1.4683309747654887, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0024123191833496094, "StateBufferConnector_ms": 0.0017516613006591797, "ViewRequirementAgentConnector_ms": 0.0442962646484375}}, "episode_reward_max": -25344.64897438416, "episode_reward_min": -26205.70083769718, "episode_reward_mean": -25743.679870948996, "episode_len_mean": 360.0, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-25788.11901700035, -25938.02912172231, -25645.68545622272, -25657.869840681724, -25912.577099563492, -26000.048036124903, -25645.351863889933, -25508.66099078769, -25802.368309252677, -25914.762618051565, -25843.30730086229, -25842.047477590306, -25815.192077501775, -25930.200027114544, -25496.92178648706, -25752.813173693678, -25753.395098784287, -25725.75446765467, -25673.519089850408, -25955.26576092845, -25642.890215674477, -25568.95617611713, -25548.1774575833, -25752.215860747718, -25909.517209893296, -25850.959082006375, -25610.5546102421, -25498.06790014565, -25700.241765192157, -25844.20282161848, -25809.050492066646, -25653.451397396937, -25694.216643221138, -25508.41792507436, -25793.831027332115, -25697.684362738815, -25508.048711270992, -26094.663579417545, -25816.146718002194, -25716.144424613198, -25716.9481468649, -25665.566155129305, -25659.414796121277, -25772.670297136126, -25838.051876520363, -25714.847273388325, -25604.794673633114, -25870.42453626149, -25584.03090843049, -25644.102076721312, -25752.654664348305, -25728.72420860095, -25344.64897438416, -25870.13531983831, -25679.36252044645, -25520.5175893975, -25877.87854023866, -25703.58373654276, -25725.653965028694, -25907.07813772965, -25727.131715233652, -25480.010086560058, -25445.419991757793, -25741.123343990854, -25782.960889559843, -25872.899679976377, -25794.34741318721, -25799.76148173705, -25692.890423418765, -25748.219230430648, -25736.440535675774, -25811.304235029627, -25784.8955521969, -25953.75570528783, -25649.10375708023, -25940.48352988541, -25841.448422768386, -25735.38842146472, -26205.70083769718, -25638.51064012693, -26031.456607431224, -25792.880448707605, -25841.402077860756, -25972.625161817006, -25843.01368514434, -25908.119496861847, -25692.733137276053, -25525.769012512654, -25823.480394710994, -25907.283641629238, -25515.59897538544, -25868.589035265955, -25577.18772125025, -25877.66864154889, -25596.9536006921, -25788.25850036741, -25427.471536829886, -26112.41235184759, -25471.38449448666, -25411.487289326662], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.404612373187996, "mean_inference_ms": 0.24637587108582223, "mean_action_processing_ms": 0.058595684924662945, "mean_env_wait_ms": 1.4683309747654887, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0024123191833496094, "StateBufferConnector_ms": 0.0017516613006591797, "ViewRequirementAgentConnector_ms": 0.0442962646484375}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 93240, "num_agent_steps_trained": 93240, "num_env_steps_sampled": 93240, "num_env_steps_trained": 93240, "num_env_steps_sampled_this_iter": 1800, "num_env_steps_trained_this_iter": 1800, "num_env_steps_sampled_throughput_per_sec": 161.92581061595425, "num_env_steps_trained_throughput_per_sec": 161.92581061595425, "timesteps_total": 93240, "num_steps_trained_this_iter": 1800, "agent_timesteps_total": 93240, "timers": {"training_iteration_time_ms": 2220.026, "sample_time_ms": 2212.835, "load_time_ms": 0.215, "load_throughput": 1673074.172, "learn_time_ms": 6.42, "learn_throughput": 56075.457, "synch_weights_time_ms": 0.524}, "counters": {"num_env_steps_sampled": 93240, "num_env_steps_trained": 93240, "num_agent_steps_sampled": 93240, "num_agent_steps_trained": 93240}, "done": false, "episodes_total": 259, "training_iteration": 52, "trial_id": "f5e97_00000", "date": "2023-07-25_17-05-33", "timestamp": 1690293933, "time_this_iter_s": 11.118298053741455, "time_total_s": 579.4216544628143, "pid": 71917, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[0, 0.003], [5400, 0.001], [10800, 0.00075], [16200, 0.0005], [21600, 0.00025], [27000, 0.0001], [32400, 7.5e-05], [37800, 5e-05], [43200, 2.5e-05], [48600, 1e-05], [54000, 7.5e-06], [59400, 5e-06], [64800, 2.5e-06], [70200, 1e-06], [75600, 5e-07], [81000, 1e-07]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x304530310>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 579.4216544628143, "iterations_since_restore": 52, "perf": {"cpu_util_percent": 25.0875, "ram_util_percent": 78.4375}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-07, "entropy_coeff": 0.1, "policy_entropy": -926.7000122070312, "policy_loss": -16526435346022.4, "vf_loss": 1075260774.4}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 1318.0, "diff_num_grad_updates_vs_sampler_policy": 1317.0}}, "num_env_steps_sampled": 95040, "num_env_steps_trained": 95040, "num_agent_steps_sampled": 95040, "num_agent_steps_trained": 95040}, "sampler_results": {"episode_reward_max": -25344.64897438416, "episode_reward_min": -26205.70083769718, "episode_reward_mean": -25739.397366897567, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-26000.048036124903, -25645.351863889933, -25508.66099078769, -25802.368309252677, -25914.762618051565, -25843.30730086229, -25842.047477590306, -25815.192077501775, -25930.200027114544, -25496.92178648706, -25752.813173693678, -25753.395098784287, -25725.75446765467, -25673.519089850408, -25955.26576092845, -25642.890215674477, -25568.95617611713, -25548.1774575833, -25752.215860747718, -25909.517209893296, -25850.959082006375, -25610.5546102421, -25498.06790014565, -25700.241765192157, -25844.20282161848, -25809.050492066646, -25653.451397396937, -25694.216643221138, -25508.41792507436, -25793.831027332115, -25697.684362738815, -25508.048711270992, -26094.663579417545, -25816.146718002194, -25716.144424613198, -25716.9481468649, -25665.566155129305, -25659.414796121277, -25772.670297136126, -25838.051876520363, -25714.847273388325, -25604.794673633114, -25870.42453626149, -25584.03090843049, -25644.102076721312, -25752.654664348305, -25728.72420860095, -25344.64897438416, -25870.13531983831, -25679.36252044645, -25520.5175893975, -25877.87854023866, -25703.58373654276, -25725.653965028694, -25907.07813772965, -25727.131715233652, -25480.010086560058, -25445.419991757793, -25741.123343990854, -25782.960889559843, -25872.899679976377, -25794.34741318721, -25799.76148173705, -25692.890423418765, -25748.219230430648, -25736.440535675774, -25811.304235029627, -25784.8955521969, -25953.75570528783, -25649.10375708023, -25940.48352988541, -25841.448422768386, -25735.38842146472, -26205.70083769718, -25638.51064012693, -26031.456607431224, -25792.880448707605, -25841.402077860756, -25972.625161817006, -25843.01368514434, -25908.119496861847, -25692.733137276053, -25525.769012512654, -25823.480394710994, -25907.283641629238, -25515.59897538544, -25868.589035265955, -25577.18772125025, -25877.66864154889, -25596.9536006921, -25788.25850036741, -25427.471536829886, -26112.41235184759, -25471.38449448666, -25411.487289326662, -25860.155843439974, -25803.86093513066, -25562.412268598353, -25803.546394953195, -25484.054687925844], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.404428244853042, "mean_inference_ms": 0.24637935334714914, "mean_action_processing_ms": 0.05859688805689647, "mean_env_wait_ms": 1.4678418117323173, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0024013519287109375, "StateBufferConnector_ms": 0.0017490386962890625, "ViewRequirementAgentConnector_ms": 0.04426765441894531}}, "episode_reward_max": -25344.64897438416, "episode_reward_min": -26205.70083769718, "episode_reward_mean": -25739.397366897567, "episode_len_mean": 360.0, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-26000.048036124903, -25645.351863889933, -25508.66099078769, -25802.368309252677, -25914.762618051565, -25843.30730086229, -25842.047477590306, -25815.192077501775, -25930.200027114544, -25496.92178648706, -25752.813173693678, -25753.395098784287, -25725.75446765467, -25673.519089850408, -25955.26576092845, -25642.890215674477, -25568.95617611713, -25548.1774575833, -25752.215860747718, -25909.517209893296, -25850.959082006375, -25610.5546102421, -25498.06790014565, -25700.241765192157, -25844.20282161848, -25809.050492066646, -25653.451397396937, -25694.216643221138, -25508.41792507436, -25793.831027332115, -25697.684362738815, -25508.048711270992, -26094.663579417545, -25816.146718002194, -25716.144424613198, -25716.9481468649, -25665.566155129305, -25659.414796121277, -25772.670297136126, -25838.051876520363, -25714.847273388325, -25604.794673633114, -25870.42453626149, -25584.03090843049, -25644.102076721312, -25752.654664348305, -25728.72420860095, -25344.64897438416, -25870.13531983831, -25679.36252044645, -25520.5175893975, -25877.87854023866, -25703.58373654276, -25725.653965028694, -25907.07813772965, -25727.131715233652, -25480.010086560058, -25445.419991757793, -25741.123343990854, -25782.960889559843, -25872.899679976377, -25794.34741318721, -25799.76148173705, -25692.890423418765, -25748.219230430648, -25736.440535675774, -25811.304235029627, -25784.8955521969, -25953.75570528783, -25649.10375708023, -25940.48352988541, -25841.448422768386, -25735.38842146472, -26205.70083769718, -25638.51064012693, -26031.456607431224, -25792.880448707605, -25841.402077860756, -25972.625161817006, -25843.01368514434, -25908.119496861847, -25692.733137276053, -25525.769012512654, -25823.480394710994, -25907.283641629238, -25515.59897538544, -25868.589035265955, -25577.18772125025, -25877.66864154889, -25596.9536006921, -25788.25850036741, -25427.471536829886, -26112.41235184759, -25471.38449448666, -25411.487289326662, -25860.155843439974, -25803.86093513066, -25562.412268598353, -25803.546394953195, -25484.054687925844], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.404428244853042, "mean_inference_ms": 0.24637935334714914, "mean_action_processing_ms": 0.05859688805689647, "mean_env_wait_ms": 1.4678418117323173, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0024013519287109375, "StateBufferConnector_ms": 0.0017490386962890625, "ViewRequirementAgentConnector_ms": 0.04426765441894531}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 95040, "num_agent_steps_trained": 95040, "num_env_steps_sampled": 95040, "num_env_steps_trained": 95040, "num_env_steps_sampled_this_iter": 1800, "num_env_steps_trained_this_iter": 1800, "num_env_steps_sampled_throughput_per_sec": 160.71616670379584, "num_env_steps_trained_throughput_per_sec": 160.71616670379584, "timesteps_total": 95040, "num_steps_trained_this_iter": 1800, "agent_timesteps_total": 95040, "timers": {"training_iteration_time_ms": 2231.597, "sample_time_ms": 2224.452, "load_time_ms": 0.217, "load_throughput": 1659467.458, "learn_time_ms": 6.367, "learn_throughput": 56545.636, "synch_weights_time_ms": 0.529}, "counters": {"num_env_steps_sampled": 95040, "num_env_steps_trained": 95040, "num_agent_steps_sampled": 95040, "num_agent_steps_trained": 95040}, "done": false, "episodes_total": 264, "training_iteration": 53, "trial_id": "f5e97_00000", "date": "2023-07-25_17-05-44", "timestamp": 1690293944, "time_this_iter_s": 11.202292919158936, "time_total_s": 590.6239473819733, "pid": 71917, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[0, 0.003], [5400, 0.001], [10800, 0.00075], [16200, 0.0005], [21600, 0.00025], [27000, 0.0001], [32400, 7.5e-05], [37800, 5e-05], [43200, 2.5e-05], [48600, 1e-05], [54000, 7.5e-06], [59400, 5e-06], [64800, 2.5e-06], [70200, 1e-06], [75600, 5e-07], [81000, 1e-07]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x304530310>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 590.6239473819733, "iterations_since_restore": 53, "perf": {"cpu_util_percent": 26.893333333333338, "ram_util_percent": 79.24}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-07, "entropy_coeff": 0.1, "policy_entropy": -926.6996704101563, "policy_loss": -16187444671283.2, "vf_loss": 1090227052.8}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 1343.0, "diff_num_grad_updates_vs_sampler_policy": 1342.0}}, "num_env_steps_sampled": 96840, "num_env_steps_trained": 96840, "num_agent_steps_sampled": 96840, "num_agent_steps_trained": 96840}, "sampler_results": {"episode_reward_max": -25344.64897438416, "episode_reward_min": -26205.70083769718, "episode_reward_mean": -25744.332013582694, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-25843.30730086229, -25842.047477590306, -25815.192077501775, -25930.200027114544, -25496.92178648706, -25752.813173693678, -25753.395098784287, -25725.75446765467, -25673.519089850408, -25955.26576092845, -25642.890215674477, -25568.95617611713, -25548.1774575833, -25752.215860747718, -25909.517209893296, -25850.959082006375, -25610.5546102421, -25498.06790014565, -25700.241765192157, -25844.20282161848, -25809.050492066646, -25653.451397396937, -25694.216643221138, -25508.41792507436, -25793.831027332115, -25697.684362738815, -25508.048711270992, -26094.663579417545, -25816.146718002194, -25716.144424613198, -25716.9481468649, -25665.566155129305, -25659.414796121277, -25772.670297136126, -25838.051876520363, -25714.847273388325, -25604.794673633114, -25870.42453626149, -25584.03090843049, -25644.102076721312, -25752.654664348305, -25728.72420860095, -25344.64897438416, -25870.13531983831, -25679.36252044645, -25520.5175893975, -25877.87854023866, -25703.58373654276, -25725.653965028694, -25907.07813772965, -25727.131715233652, -25480.010086560058, -25445.419991757793, -25741.123343990854, -25782.960889559843, -25872.899679976377, -25794.34741318721, -25799.76148173705, -25692.890423418765, -25748.219230430648, -25736.440535675774, -25811.304235029627, -25784.8955521969, -25953.75570528783, -25649.10375708023, -25940.48352988541, -25841.448422768386, -25735.38842146472, -26205.70083769718, -25638.51064012693, -26031.456607431224, -25792.880448707605, -25841.402077860756, -25972.625161817006, -25843.01368514434, -25908.119496861847, -25692.733137276053, -25525.769012512654, -25823.480394710994, -25907.283641629238, -25515.59897538544, -25868.589035265955, -25577.18772125025, -25877.66864154889, -25596.9536006921, -25788.25850036741, -25427.471536829886, -26112.41235184759, -25471.38449448666, -25411.487289326662, -25860.155843439974, -25803.86093513066, -25562.412268598353, -25803.546394953195, -25484.054687925844, -26073.427377665303, -26012.300427767903, -25876.122433853667, -25756.47538442769, -25646.33086290482], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.404342613049449, "mean_inference_ms": 0.24638563802112742, "mean_action_processing_ms": 0.05859867804413112, "mean_env_wait_ms": 1.4674076335535131, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002393007278442383, "StateBufferConnector_ms": 0.0017542839050292969, "ViewRequirementAgentConnector_ms": 0.04412841796875}}, "episode_reward_max": -25344.64897438416, "episode_reward_min": -26205.70083769718, "episode_reward_mean": -25744.332013582694, "episode_len_mean": 360.0, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-25843.30730086229, -25842.047477590306, -25815.192077501775, -25930.200027114544, -25496.92178648706, -25752.813173693678, -25753.395098784287, -25725.75446765467, -25673.519089850408, -25955.26576092845, -25642.890215674477, -25568.95617611713, -25548.1774575833, -25752.215860747718, -25909.517209893296, -25850.959082006375, -25610.5546102421, -25498.06790014565, -25700.241765192157, -25844.20282161848, -25809.050492066646, -25653.451397396937, -25694.216643221138, -25508.41792507436, -25793.831027332115, -25697.684362738815, -25508.048711270992, -26094.663579417545, -25816.146718002194, -25716.144424613198, -25716.9481468649, -25665.566155129305, -25659.414796121277, -25772.670297136126, -25838.051876520363, -25714.847273388325, -25604.794673633114, -25870.42453626149, -25584.03090843049, -25644.102076721312, -25752.654664348305, -25728.72420860095, -25344.64897438416, -25870.13531983831, -25679.36252044645, -25520.5175893975, -25877.87854023866, -25703.58373654276, -25725.653965028694, -25907.07813772965, -25727.131715233652, -25480.010086560058, -25445.419991757793, -25741.123343990854, -25782.960889559843, -25872.899679976377, -25794.34741318721, -25799.76148173705, -25692.890423418765, -25748.219230430648, -25736.440535675774, -25811.304235029627, -25784.8955521969, -25953.75570528783, -25649.10375708023, -25940.48352988541, -25841.448422768386, -25735.38842146472, -26205.70083769718, -25638.51064012693, -26031.456607431224, -25792.880448707605, -25841.402077860756, -25972.625161817006, -25843.01368514434, -25908.119496861847, -25692.733137276053, -25525.769012512654, -25823.480394710994, -25907.283641629238, -25515.59897538544, -25868.589035265955, -25577.18772125025, -25877.66864154889, -25596.9536006921, -25788.25850036741, -25427.471536829886, -26112.41235184759, -25471.38449448666, -25411.487289326662, -25860.155843439974, -25803.86093513066, -25562.412268598353, -25803.546394953195, -25484.054687925844, -26073.427377665303, -26012.300427767903, -25876.122433853667, -25756.47538442769, -25646.33086290482], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.404342613049449, "mean_inference_ms": 0.24638563802112742, "mean_action_processing_ms": 0.05859867804413112, "mean_env_wait_ms": 1.4674076335535131, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002393007278442383, "StateBufferConnector_ms": 0.0017542839050292969, "ViewRequirementAgentConnector_ms": 0.04412841796875}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 96840, "num_agent_steps_trained": 96840, "num_env_steps_sampled": 96840, "num_env_steps_trained": 96840, "num_env_steps_sampled_this_iter": 1800, "num_env_steps_trained_this_iter": 1800, "num_env_steps_sampled_throughput_per_sec": 158.97627809204894, "num_env_steps_trained_throughput_per_sec": 158.97627809204894, "timesteps_total": 96840, "num_steps_trained_this_iter": 1800, "agent_timesteps_total": 96840, "timers": {"training_iteration_time_ms": 2252.221, "sample_time_ms": 2245.061, "load_time_ms": 0.22, "load_throughput": 1635206.238, "learn_time_ms": 6.37, "learn_throughput": 56517.487, "synch_weights_time_ms": 0.538}, "counters": {"num_env_steps_sampled": 96840, "num_env_steps_trained": 96840, "num_agent_steps_sampled": 96840, "num_agent_steps_trained": 96840}, "done": false, "episodes_total": 269, "training_iteration": 54, "trial_id": "f5e97_00000", "date": "2023-07-25_17-05-56", "timestamp": 1690293956, "time_this_iter_s": 11.324483156204224, "time_total_s": 601.9484305381775, "pid": 71917, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[0, 0.003], [5400, 0.001], [10800, 0.00075], [16200, 0.0005], [21600, 0.00025], [27000, 0.0001], [32400, 7.5e-05], [37800, 5e-05], [43200, 2.5e-05], [48600, 1e-05], [54000, 7.5e-06], [59400, 5e-06], [64800, 2.5e-06], [70200, 1e-06], [75600, 5e-07], [81000, 1e-07]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x304530310>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 601.9484305381775, "iterations_since_restore": 54, "perf": {"cpu_util_percent": 27.900000000000002, "ram_util_percent": 78.69999999999999}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-07, "entropy_coeff": 0.1, "policy_entropy": -926.6998046875, "policy_loss": -18952751878963.2, "vf_loss": 1100857356.8}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 1368.0, "diff_num_grad_updates_vs_sampler_policy": 1367.0}}, "num_env_steps_sampled": 98640, "num_env_steps_trained": 98640, "num_agent_steps_sampled": 98640, "num_agent_steps_trained": 98640}, "sampler_results": {"episode_reward_max": -25344.64897438416, "episode_reward_min": -26205.70083769718, "episode_reward_mean": -25732.638760153182, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-25752.813173693678, -25753.395098784287, -25725.75446765467, -25673.519089850408, -25955.26576092845, -25642.890215674477, -25568.95617611713, -25548.1774575833, -25752.215860747718, -25909.517209893296, -25850.959082006375, -25610.5546102421, -25498.06790014565, -25700.241765192157, -25844.20282161848, -25809.050492066646, -25653.451397396937, -25694.216643221138, -25508.41792507436, -25793.831027332115, -25697.684362738815, -25508.048711270992, -26094.663579417545, -25816.146718002194, -25716.144424613198, -25716.9481468649, -25665.566155129305, -25659.414796121277, -25772.670297136126, -25838.051876520363, -25714.847273388325, -25604.794673633114, -25870.42453626149, -25584.03090843049, -25644.102076721312, -25752.654664348305, -25728.72420860095, -25344.64897438416, -25870.13531983831, -25679.36252044645, -25520.5175893975, -25877.87854023866, -25703.58373654276, -25725.653965028694, -25907.07813772965, -25727.131715233652, -25480.010086560058, -25445.419991757793, -25741.123343990854, -25782.960889559843, -25872.899679976377, -25794.34741318721, -25799.76148173705, -25692.890423418765, -25748.219230430648, -25736.440535675774, -25811.304235029627, -25784.8955521969, -25953.75570528783, -25649.10375708023, -25940.48352988541, -25841.448422768386, -25735.38842146472, -26205.70083769718, -25638.51064012693, -26031.456607431224, -25792.880448707605, -25841.402077860756, -25972.625161817006, -25843.01368514434, -25908.119496861847, -25692.733137276053, -25525.769012512654, -25823.480394710994, -25907.283641629238, -25515.59897538544, -25868.589035265955, -25577.18772125025, -25877.66864154889, -25596.9536006921, -25788.25850036741, -25427.471536829886, -26112.41235184759, -25471.38449448666, -25411.487289326662, -25860.155843439974, -25803.86093513066, -25562.412268598353, -25803.546394953195, -25484.054687925844, -26073.427377665303, -26012.300427767903, -25876.122433853667, -25756.47538442769, -25646.33086290482, -25487.666593624537, -25390.160806222, -25606.10411112896, -25560.898605591057, -25713.51321003798], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.40426263170851, "mean_inference_ms": 0.24639397857092674, "mean_action_processing_ms": 0.05860111461156195, "mean_env_wait_ms": 1.4670025444344845, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0024156570434570312, "StateBufferConnector_ms": 0.0017497539520263672, "ViewRequirementAgentConnector_ms": 0.04427814483642578}}, "episode_reward_max": -25344.64897438416, "episode_reward_min": -26205.70083769718, "episode_reward_mean": -25732.638760153182, "episode_len_mean": 360.0, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-25752.813173693678, -25753.395098784287, -25725.75446765467, -25673.519089850408, -25955.26576092845, -25642.890215674477, -25568.95617611713, -25548.1774575833, -25752.215860747718, -25909.517209893296, -25850.959082006375, -25610.5546102421, -25498.06790014565, -25700.241765192157, -25844.20282161848, -25809.050492066646, -25653.451397396937, -25694.216643221138, -25508.41792507436, -25793.831027332115, -25697.684362738815, -25508.048711270992, -26094.663579417545, -25816.146718002194, -25716.144424613198, -25716.9481468649, -25665.566155129305, -25659.414796121277, -25772.670297136126, -25838.051876520363, -25714.847273388325, -25604.794673633114, -25870.42453626149, -25584.03090843049, -25644.102076721312, -25752.654664348305, -25728.72420860095, -25344.64897438416, -25870.13531983831, -25679.36252044645, -25520.5175893975, -25877.87854023866, -25703.58373654276, -25725.653965028694, -25907.07813772965, -25727.131715233652, -25480.010086560058, -25445.419991757793, -25741.123343990854, -25782.960889559843, -25872.899679976377, -25794.34741318721, -25799.76148173705, -25692.890423418765, -25748.219230430648, -25736.440535675774, -25811.304235029627, -25784.8955521969, -25953.75570528783, -25649.10375708023, -25940.48352988541, -25841.448422768386, -25735.38842146472, -26205.70083769718, -25638.51064012693, -26031.456607431224, -25792.880448707605, -25841.402077860756, -25972.625161817006, -25843.01368514434, -25908.119496861847, -25692.733137276053, -25525.769012512654, -25823.480394710994, -25907.283641629238, -25515.59897538544, -25868.589035265955, -25577.18772125025, -25877.66864154889, -25596.9536006921, -25788.25850036741, -25427.471536829886, -26112.41235184759, -25471.38449448666, -25411.487289326662, -25860.155843439974, -25803.86093513066, -25562.412268598353, -25803.546394953195, -25484.054687925844, -26073.427377665303, -26012.300427767903, -25876.122433853667, -25756.47538442769, -25646.33086290482, -25487.666593624537, -25390.160806222, -25606.10411112896, -25560.898605591057, -25713.51321003798], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.40426263170851, "mean_inference_ms": 0.24639397857092674, "mean_action_processing_ms": 0.05860111461156195, "mean_env_wait_ms": 1.4670025444344845, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0024156570434570312, "StateBufferConnector_ms": 0.0017497539520263672, "ViewRequirementAgentConnector_ms": 0.04427814483642578}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 98640, "num_agent_steps_trained": 98640, "num_env_steps_sampled": 98640, "num_env_steps_trained": 98640, "num_env_steps_sampled_this_iter": 1800, "num_env_steps_trained_this_iter": 1800, "num_env_steps_sampled_throughput_per_sec": 161.87057120419936, "num_env_steps_trained_throughput_per_sec": 161.87057120419936, "timesteps_total": 98640, "num_steps_trained_this_iter": 1800, "agent_timesteps_total": 98640, "timers": {"training_iteration_time_ms": 2244.234, "sample_time_ms": 2236.959, "load_time_ms": 0.282, "load_throughput": 1276912.846, "learn_time_ms": 6.44, "learn_throughput": 55896.312, "synch_weights_time_ms": 0.517}, "counters": {"num_env_steps_sampled": 98640, "num_env_steps_trained": 98640, "num_agent_steps_sampled": 98640, "num_agent_steps_trained": 98640}, "done": false, "episodes_total": 274, "training_iteration": 55, "trial_id": "f5e97_00000", "date": "2023-07-25_17-06-07", "timestamp": 1690293967, "time_this_iter_s": 11.122145175933838, "time_total_s": 613.0705757141113, "pid": 71917, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[0, 0.003], [5400, 0.001], [10800, 0.00075], [16200, 0.0005], [21600, 0.00025], [27000, 0.0001], [32400, 7.5e-05], [37800, 5e-05], [43200, 2.5e-05], [48600, 1e-05], [54000, 7.5e-06], [59400, 5e-06], [64800, 2.5e-06], [70200, 1e-06], [75600, 5e-07], [81000, 1e-07]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x304530310>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 613.0705757141113, "iterations_since_restore": 55, "perf": {"cpu_util_percent": 26.513333333333335, "ram_util_percent": 78.64}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-07, "entropy_coeff": 0.1, "policy_entropy": -926.6995483398438, "policy_loss": -15250729877504.0, "vf_loss": 1106753920.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 1393.0, "diff_num_grad_updates_vs_sampler_policy": 1392.0}}, "num_env_steps_sampled": 100440, "num_env_steps_trained": 100440, "num_agent_steps_sampled": 100440, "num_agent_steps_trained": 100440}, "sampler_results": {"episode_reward_max": -25344.64897438416, "episode_reward_min": -26205.70083769718, "episode_reward_mean": -25733.002463882018, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-25642.890215674477, -25568.95617611713, -25548.1774575833, -25752.215860747718, -25909.517209893296, -25850.959082006375, -25610.5546102421, -25498.06790014565, -25700.241765192157, -25844.20282161848, -25809.050492066646, -25653.451397396937, -25694.216643221138, -25508.41792507436, -25793.831027332115, -25697.684362738815, -25508.048711270992, -26094.663579417545, -25816.146718002194, -25716.144424613198, -25716.9481468649, -25665.566155129305, -25659.414796121277, -25772.670297136126, -25838.051876520363, -25714.847273388325, -25604.794673633114, -25870.42453626149, -25584.03090843049, -25644.102076721312, -25752.654664348305, -25728.72420860095, -25344.64897438416, -25870.13531983831, -25679.36252044645, -25520.5175893975, -25877.87854023866, -25703.58373654276, -25725.653965028694, -25907.07813772965, -25727.131715233652, -25480.010086560058, -25445.419991757793, -25741.123343990854, -25782.960889559843, -25872.899679976377, -25794.34741318721, -25799.76148173705, -25692.890423418765, -25748.219230430648, -25736.440535675774, -25811.304235029627, -25784.8955521969, -25953.75570528783, -25649.10375708023, -25940.48352988541, -25841.448422768386, -25735.38842146472, -26205.70083769718, -25638.51064012693, -26031.456607431224, -25792.880448707605, -25841.402077860756, -25972.625161817006, -25843.01368514434, -25908.119496861847, -25692.733137276053, -25525.769012512654, -25823.480394710994, -25907.283641629238, -25515.59897538544, -25868.589035265955, -25577.18772125025, -25877.66864154889, -25596.9536006921, -25788.25850036741, -25427.471536829886, -26112.41235184759, -25471.38449448666, -25411.487289326662, -25860.155843439974, -25803.86093513066, -25562.412268598353, -25803.546394953195, -25484.054687925844, -26073.427377665303, -26012.300427767903, -25876.122433853667, -25756.47538442769, -25646.33086290482, -25487.666593624537, -25390.160806222, -25606.10411112896, -25560.898605591057, -25713.51321003798, -25802.15825834444, -25559.61234837715, -25889.63188350402, -25739.953136814795, -25905.76233675474], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.404219359695208, "mean_inference_ms": 0.2463999099412682, "mean_action_processing_ms": 0.05860325331377728, "mean_env_wait_ms": 1.4666338618208283, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002420663833618164, "StateBufferConnector_ms": 0.0017473697662353516, "ViewRequirementAgentConnector_ms": 0.04424691200256348}}, "episode_reward_max": -25344.64897438416, "episode_reward_min": -26205.70083769718, "episode_reward_mean": -25733.002463882018, "episode_len_mean": 360.0, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-25642.890215674477, -25568.95617611713, -25548.1774575833, -25752.215860747718, -25909.517209893296, -25850.959082006375, -25610.5546102421, -25498.06790014565, -25700.241765192157, -25844.20282161848, -25809.050492066646, -25653.451397396937, -25694.216643221138, -25508.41792507436, -25793.831027332115, -25697.684362738815, -25508.048711270992, -26094.663579417545, -25816.146718002194, -25716.144424613198, -25716.9481468649, -25665.566155129305, -25659.414796121277, -25772.670297136126, -25838.051876520363, -25714.847273388325, -25604.794673633114, -25870.42453626149, -25584.03090843049, -25644.102076721312, -25752.654664348305, -25728.72420860095, -25344.64897438416, -25870.13531983831, -25679.36252044645, -25520.5175893975, -25877.87854023866, -25703.58373654276, -25725.653965028694, -25907.07813772965, -25727.131715233652, -25480.010086560058, -25445.419991757793, -25741.123343990854, -25782.960889559843, -25872.899679976377, -25794.34741318721, -25799.76148173705, -25692.890423418765, -25748.219230430648, -25736.440535675774, -25811.304235029627, -25784.8955521969, -25953.75570528783, -25649.10375708023, -25940.48352988541, -25841.448422768386, -25735.38842146472, -26205.70083769718, -25638.51064012693, -26031.456607431224, -25792.880448707605, -25841.402077860756, -25972.625161817006, -25843.01368514434, -25908.119496861847, -25692.733137276053, -25525.769012512654, -25823.480394710994, -25907.283641629238, -25515.59897538544, -25868.589035265955, -25577.18772125025, -25877.66864154889, -25596.9536006921, -25788.25850036741, -25427.471536829886, -26112.41235184759, -25471.38449448666, -25411.487289326662, -25860.155843439974, -25803.86093513066, -25562.412268598353, -25803.546394953195, -25484.054687925844, -26073.427377665303, -26012.300427767903, -25876.122433853667, -25756.47538442769, -25646.33086290482, -25487.666593624537, -25390.160806222, -25606.10411112896, -25560.898605591057, -25713.51321003798, -25802.15825834444, -25559.61234837715, -25889.63188350402, -25739.953136814795, -25905.76233675474], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.404219359695208, "mean_inference_ms": 0.2463999099412682, "mean_action_processing_ms": 0.05860325331377728, "mean_env_wait_ms": 1.4666338618208283, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002420663833618164, "StateBufferConnector_ms": 0.0017473697662353516, "ViewRequirementAgentConnector_ms": 0.04424691200256348}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 100440, "num_agent_steps_trained": 100440, "num_env_steps_sampled": 100440, "num_env_steps_trained": 100440, "num_env_steps_sampled_this_iter": 1800, "num_env_steps_trained_this_iter": 1800, "num_env_steps_sampled_throughput_per_sec": 160.88115877692897, "num_env_steps_trained_throughput_per_sec": 160.88115877692897, "timesteps_total": 100440, "num_steps_trained_this_iter": 1800, "agent_timesteps_total": 100440, "timers": {"training_iteration_time_ms": 2230.828, "sample_time_ms": 2223.396, "load_time_ms": 0.3, "load_throughput": 1200373.193, "learn_time_ms": 6.571, "learn_throughput": 54790.101, "synch_weights_time_ms": 0.526}, "counters": {"num_env_steps_sampled": 100440, "num_env_steps_trained": 100440, "num_agent_steps_sampled": 100440, "num_agent_steps_trained": 100440}, "done": false, "episodes_total": 279, "training_iteration": 56, "trial_id": "f5e97_00000", "date": "2023-07-25_17-06-18", "timestamp": 1690293978, "time_this_iter_s": 11.190519094467163, "time_total_s": 624.2610948085785, "pid": 71917, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[0, 0.003], [5400, 0.001], [10800, 0.00075], [16200, 0.0005], [21600, 0.00025], [27000, 0.0001], [32400, 7.5e-05], [37800, 5e-05], [43200, 2.5e-05], [48600, 1e-05], [54000, 7.5e-06], [59400, 5e-06], [64800, 2.5e-06], [70200, 1e-06], [75600, 5e-07], [81000, 1e-07]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x304530310>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 624.2610948085785, "iterations_since_restore": 56, "perf": {"cpu_util_percent": 25.58125, "ram_util_percent": 78.74375}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-07, "entropy_coeff": 0.1, "policy_entropy": -926.6998657226562, "policy_loss": -34106497658060.8, "vf_loss": 1086253478.4}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 1418.0, "diff_num_grad_updates_vs_sampler_policy": 1417.0}}, "num_env_steps_sampled": 102240, "num_env_steps_trained": 102240, "num_agent_steps_sampled": 102240, "num_agent_steps_trained": 102240}, "sampler_results": {"episode_reward_max": -25344.64897438416, "episode_reward_min": -26205.70083769718, "episode_reward_mean": -25735.018015623577, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-25850.959082006375, -25610.5546102421, -25498.06790014565, -25700.241765192157, -25844.20282161848, -25809.050492066646, -25653.451397396937, -25694.216643221138, -25508.41792507436, -25793.831027332115, -25697.684362738815, -25508.048711270992, -26094.663579417545, -25816.146718002194, -25716.144424613198, -25716.9481468649, -25665.566155129305, -25659.414796121277, -25772.670297136126, -25838.051876520363, -25714.847273388325, -25604.794673633114, -25870.42453626149, -25584.03090843049, -25644.102076721312, -25752.654664348305, -25728.72420860095, -25344.64897438416, -25870.13531983831, -25679.36252044645, -25520.5175893975, -25877.87854023866, -25703.58373654276, -25725.653965028694, -25907.07813772965, -25727.131715233652, -25480.010086560058, -25445.419991757793, -25741.123343990854, -25782.960889559843, -25872.899679976377, -25794.34741318721, -25799.76148173705, -25692.890423418765, -25748.219230430648, -25736.440535675774, -25811.304235029627, -25784.8955521969, -25953.75570528783, -25649.10375708023, -25940.48352988541, -25841.448422768386, -25735.38842146472, -26205.70083769718, -25638.51064012693, -26031.456607431224, -25792.880448707605, -25841.402077860756, -25972.625161817006, -25843.01368514434, -25908.119496861847, -25692.733137276053, -25525.769012512654, -25823.480394710994, -25907.283641629238, -25515.59897538544, -25868.589035265955, -25577.18772125025, -25877.66864154889, -25596.9536006921, -25788.25850036741, -25427.471536829886, -26112.41235184759, -25471.38449448666, -25411.487289326662, -25860.155843439974, -25803.86093513066, -25562.412268598353, -25803.546394953195, -25484.054687925844, -26073.427377665303, -26012.300427767903, -25876.122433853667, -25756.47538442769, -25646.33086290482, -25487.666593624537, -25390.160806222, -25606.10411112896, -25560.898605591057, -25713.51321003798, -25802.15825834444, -25559.61234837715, -25889.63188350402, -25739.953136814795, -25905.76233675474, -25818.73858470875, -25626.132600040637, -25647.313681746455, -25892.368079272357, -25638.759148403686], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.404305024077117, "mean_inference_ms": 0.24643612191119316, "mean_action_processing_ms": 0.05861090868349568, "mean_env_wait_ms": 1.46633048653367, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002442598342895508, "StateBufferConnector_ms": 0.0017547607421875, "ViewRequirementAgentConnector_ms": 0.044623374938964844}}, "episode_reward_max": -25344.64897438416, "episode_reward_min": -26205.70083769718, "episode_reward_mean": -25735.018015623577, "episode_len_mean": 360.0, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-25850.959082006375, -25610.5546102421, -25498.06790014565, -25700.241765192157, -25844.20282161848, -25809.050492066646, -25653.451397396937, -25694.216643221138, -25508.41792507436, -25793.831027332115, -25697.684362738815, -25508.048711270992, -26094.663579417545, -25816.146718002194, -25716.144424613198, -25716.9481468649, -25665.566155129305, -25659.414796121277, -25772.670297136126, -25838.051876520363, -25714.847273388325, -25604.794673633114, -25870.42453626149, -25584.03090843049, -25644.102076721312, -25752.654664348305, -25728.72420860095, -25344.64897438416, -25870.13531983831, -25679.36252044645, -25520.5175893975, -25877.87854023866, -25703.58373654276, -25725.653965028694, -25907.07813772965, -25727.131715233652, -25480.010086560058, -25445.419991757793, -25741.123343990854, -25782.960889559843, -25872.899679976377, -25794.34741318721, -25799.76148173705, -25692.890423418765, -25748.219230430648, -25736.440535675774, -25811.304235029627, -25784.8955521969, -25953.75570528783, -25649.10375708023, -25940.48352988541, -25841.448422768386, -25735.38842146472, -26205.70083769718, -25638.51064012693, -26031.456607431224, -25792.880448707605, -25841.402077860756, -25972.625161817006, -25843.01368514434, -25908.119496861847, -25692.733137276053, -25525.769012512654, -25823.480394710994, -25907.283641629238, -25515.59897538544, -25868.589035265955, -25577.18772125025, -25877.66864154889, -25596.9536006921, -25788.25850036741, -25427.471536829886, -26112.41235184759, -25471.38449448666, -25411.487289326662, -25860.155843439974, -25803.86093513066, -25562.412268598353, -25803.546394953195, -25484.054687925844, -26073.427377665303, -26012.300427767903, -25876.122433853667, -25756.47538442769, -25646.33086290482, -25487.666593624537, -25390.160806222, -25606.10411112896, -25560.898605591057, -25713.51321003798, -25802.15825834444, -25559.61234837715, -25889.63188350402, -25739.953136814795, -25905.76233675474, -25818.73858470875, -25626.132600040637, -25647.313681746455, -25892.368079272357, -25638.759148403686], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.404305024077117, "mean_inference_ms": 0.24643612191119316, "mean_action_processing_ms": 0.05861090868349568, "mean_env_wait_ms": 1.46633048653367, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002442598342895508, "StateBufferConnector_ms": 0.0017547607421875, "ViewRequirementAgentConnector_ms": 0.044623374938964844}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 102240, "num_agent_steps_trained": 102240, "num_env_steps_sampled": 102240, "num_env_steps_trained": 102240, "num_env_steps_sampled_this_iter": 1800, "num_env_steps_trained_this_iter": 1800, "num_env_steps_sampled_throughput_per_sec": 155.637893162986, "num_env_steps_trained_throughput_per_sec": 155.637893162986, "timesteps_total": 102240, "num_steps_trained_this_iter": 1800, "agent_timesteps_total": 102240, "timers": {"training_iteration_time_ms": 2275.36, "sample_time_ms": 2268.216, "load_time_ms": 0.234, "load_throughput": 1539664.974, "learn_time_ms": 6.364, "learn_throughput": 56570.423, "synch_weights_time_ms": 0.514}, "counters": {"num_env_steps_sampled": 102240, "num_env_steps_trained": 102240, "num_agent_steps_sampled": 102240, "num_agent_steps_trained": 102240}, "done": false, "episodes_total": 284, "training_iteration": 57, "trial_id": "f5e97_00000", "date": "2023-07-25_17-06-30", "timestamp": 1690293990, "time_this_iter_s": 11.567425966262817, "time_total_s": 635.8285207748413, "pid": 71917, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[0, 0.003], [5400, 0.001], [10800, 0.00075], [16200, 0.0005], [21600, 0.00025], [27000, 0.0001], [32400, 7.5e-05], [37800, 5e-05], [43200, 2.5e-05], [48600, 1e-05], [54000, 7.5e-06], [59400, 5e-06], [64800, 2.5e-06], [70200, 1e-06], [75600, 5e-07], [81000, 1e-07]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x304530310>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 635.8285207748413, "iterations_since_restore": 57, "perf": {"cpu_util_percent": 29.329411764705885, "ram_util_percent": 79.18823529411765}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-07, "entropy_coeff": 0.1, "policy_entropy": -926.6997924804688, "policy_loss": -39718427433369.6, "vf_loss": 1090617472.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 1443.0, "diff_num_grad_updates_vs_sampler_policy": 1442.0}}, "num_env_steps_sampled": 104040, "num_env_steps_trained": 104040, "num_agent_steps_sampled": 104040, "num_agent_steps_trained": 104040}, "sampler_results": {"episode_reward_max": -25344.64897438416, "episode_reward_min": -26205.70083769718, "episode_reward_mean": -25740.16683109802, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-25809.050492066646, -25653.451397396937, -25694.216643221138, -25508.41792507436, -25793.831027332115, -25697.684362738815, -25508.048711270992, -26094.663579417545, -25816.146718002194, -25716.144424613198, -25716.9481468649, -25665.566155129305, -25659.414796121277, -25772.670297136126, -25838.051876520363, -25714.847273388325, -25604.794673633114, -25870.42453626149, -25584.03090843049, -25644.102076721312, -25752.654664348305, -25728.72420860095, -25344.64897438416, -25870.13531983831, -25679.36252044645, -25520.5175893975, -25877.87854023866, -25703.58373654276, -25725.653965028694, -25907.07813772965, -25727.131715233652, -25480.010086560058, -25445.419991757793, -25741.123343990854, -25782.960889559843, -25872.899679976377, -25794.34741318721, -25799.76148173705, -25692.890423418765, -25748.219230430648, -25736.440535675774, -25811.304235029627, -25784.8955521969, -25953.75570528783, -25649.10375708023, -25940.48352988541, -25841.448422768386, -25735.38842146472, -26205.70083769718, -25638.51064012693, -26031.456607431224, -25792.880448707605, -25841.402077860756, -25972.625161817006, -25843.01368514434, -25908.119496861847, -25692.733137276053, -25525.769012512654, -25823.480394710994, -25907.283641629238, -25515.59897538544, -25868.589035265955, -25577.18772125025, -25877.66864154889, -25596.9536006921, -25788.25850036741, -25427.471536829886, -26112.41235184759, -25471.38449448666, -25411.487289326662, -25860.155843439974, -25803.86093513066, -25562.412268598353, -25803.546394953195, -25484.054687925844, -26073.427377665303, -26012.300427767903, -25876.122433853667, -25756.47538442769, -25646.33086290482, -25487.666593624537, -25390.160806222, -25606.10411112896, -25560.898605591057, -25713.51321003798, -25802.15825834444, -25559.61234837715, -25889.63188350402, -25739.953136814795, -25905.76233675474, -25818.73858470875, -25626.132600040637, -25647.313681746455, -25892.368079272357, -25638.759148403686, -25715.057738798045, -25844.66944533116, -25870.25614207713, -25920.880645498226, -25668.043754945003], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.404412108335937, "mean_inference_ms": 0.2464688599966044, "mean_action_processing_ms": 0.05861807212674881, "mean_env_wait_ms": 1.466018012019672, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002440929412841797, "StateBufferConnector_ms": 0.001750946044921875, "ViewRequirementAgentConnector_ms": 0.04465746879577637}}, "episode_reward_max": -25344.64897438416, "episode_reward_min": -26205.70083769718, "episode_reward_mean": -25740.16683109802, "episode_len_mean": 360.0, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-25809.050492066646, -25653.451397396937, -25694.216643221138, -25508.41792507436, -25793.831027332115, -25697.684362738815, -25508.048711270992, -26094.663579417545, -25816.146718002194, -25716.144424613198, -25716.9481468649, -25665.566155129305, -25659.414796121277, -25772.670297136126, -25838.051876520363, -25714.847273388325, -25604.794673633114, -25870.42453626149, -25584.03090843049, -25644.102076721312, -25752.654664348305, -25728.72420860095, -25344.64897438416, -25870.13531983831, -25679.36252044645, -25520.5175893975, -25877.87854023866, -25703.58373654276, -25725.653965028694, -25907.07813772965, -25727.131715233652, -25480.010086560058, -25445.419991757793, -25741.123343990854, -25782.960889559843, -25872.899679976377, -25794.34741318721, -25799.76148173705, -25692.890423418765, -25748.219230430648, -25736.440535675774, -25811.304235029627, -25784.8955521969, -25953.75570528783, -25649.10375708023, -25940.48352988541, -25841.448422768386, -25735.38842146472, -26205.70083769718, -25638.51064012693, -26031.456607431224, -25792.880448707605, -25841.402077860756, -25972.625161817006, -25843.01368514434, -25908.119496861847, -25692.733137276053, -25525.769012512654, -25823.480394710994, -25907.283641629238, -25515.59897538544, -25868.589035265955, -25577.18772125025, -25877.66864154889, -25596.9536006921, -25788.25850036741, -25427.471536829886, -26112.41235184759, -25471.38449448666, -25411.487289326662, -25860.155843439974, -25803.86093513066, -25562.412268598353, -25803.546394953195, -25484.054687925844, -26073.427377665303, -26012.300427767903, -25876.122433853667, -25756.47538442769, -25646.33086290482, -25487.666593624537, -25390.160806222, -25606.10411112896, -25560.898605591057, -25713.51321003798, -25802.15825834444, -25559.61234837715, -25889.63188350402, -25739.953136814795, -25905.76233675474, -25818.73858470875, -25626.132600040637, -25647.313681746455, -25892.368079272357, -25638.759148403686, -25715.057738798045, -25844.66944533116, -25870.25614207713, -25920.880645498226, -25668.043754945003], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.404412108335937, "mean_inference_ms": 0.2464688599966044, "mean_action_processing_ms": 0.05861807212674881, "mean_env_wait_ms": 1.466018012019672, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002440929412841797, "StateBufferConnector_ms": 0.001750946044921875, "ViewRequirementAgentConnector_ms": 0.04465746879577637}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 104040, "num_agent_steps_trained": 104040, "num_env_steps_sampled": 104040, "num_env_steps_trained": 104040, "num_env_steps_sampled_this_iter": 1800, "num_env_steps_trained_this_iter": 1800, "num_env_steps_sampled_throughput_per_sec": 161.01516916052324, "num_env_steps_trained_throughput_per_sec": 161.01516916052324, "timesteps_total": 104040, "num_steps_trained_this_iter": 1800, "agent_timesteps_total": 104040, "timers": {"training_iteration_time_ms": 2274.428, "sample_time_ms": 2267.093, "load_time_ms": 0.213, "load_throughput": 1688792.574, "learn_time_ms": 6.554, "learn_throughput": 54926.427, "synch_weights_time_ms": 0.534}, "counters": {"num_env_steps_sampled": 104040, "num_env_steps_trained": 104040, "num_agent_steps_sampled": 104040, "num_agent_steps_trained": 104040}, "done": false, "episodes_total": 289, "training_iteration": 58, "trial_id": "f5e97_00000", "date": "2023-07-25_17-06-41", "timestamp": 1690294001, "time_this_iter_s": 11.181259632110596, "time_total_s": 647.0097804069519, "pid": 71917, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[0, 0.003], [5400, 0.001], [10800, 0.00075], [16200, 0.0005], [21600, 0.00025], [27000, 0.0001], [32400, 7.5e-05], [37800, 5e-05], [43200, 2.5e-05], [48600, 1e-05], [54000, 7.5e-06], [59400, 5e-06], [64800, 2.5e-06], [70200, 1e-06], [75600, 5e-07], [81000, 1e-07]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x304530310>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 647.0097804069519, "iterations_since_restore": 58, "perf": {"cpu_util_percent": 25.55, "ram_util_percent": 79.4375}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-07, "entropy_coeff": 0.1, "policy_entropy": -926.6999633789062, "policy_loss": -41731988625817.6, "vf_loss": 1082553619.2}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 1468.0, "diff_num_grad_updates_vs_sampler_policy": 1467.0}}, "num_env_steps_sampled": 105840, "num_env_steps_trained": 105840, "num_agent_steps_sampled": 105840, "num_agent_steps_trained": 105840}, "sampler_results": {"episode_reward_max": -25344.64897438416, "episode_reward_min": -26205.70083769718, "episode_reward_mean": -25741.41728710454, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-25697.684362738815, -25508.048711270992, -26094.663579417545, -25816.146718002194, -25716.144424613198, -25716.9481468649, -25665.566155129305, -25659.414796121277, -25772.670297136126, -25838.051876520363, -25714.847273388325, -25604.794673633114, -25870.42453626149, -25584.03090843049, -25644.102076721312, -25752.654664348305, -25728.72420860095, -25344.64897438416, -25870.13531983831, -25679.36252044645, -25520.5175893975, -25877.87854023866, -25703.58373654276, -25725.653965028694, -25907.07813772965, -25727.131715233652, -25480.010086560058, -25445.419991757793, -25741.123343990854, -25782.960889559843, -25872.899679976377, -25794.34741318721, -25799.76148173705, -25692.890423418765, -25748.219230430648, -25736.440535675774, -25811.304235029627, -25784.8955521969, -25953.75570528783, -25649.10375708023, -25940.48352988541, -25841.448422768386, -25735.38842146472, -26205.70083769718, -25638.51064012693, -26031.456607431224, -25792.880448707605, -25841.402077860756, -25972.625161817006, -25843.01368514434, -25908.119496861847, -25692.733137276053, -25525.769012512654, -25823.480394710994, -25907.283641629238, -25515.59897538544, -25868.589035265955, -25577.18772125025, -25877.66864154889, -25596.9536006921, -25788.25850036741, -25427.471536829886, -26112.41235184759, -25471.38449448666, -25411.487289326662, -25860.155843439974, -25803.86093513066, -25562.412268598353, -25803.546394953195, -25484.054687925844, -26073.427377665303, -26012.300427767903, -25876.122433853667, -25756.47538442769, -25646.33086290482, -25487.666593624537, -25390.160806222, -25606.10411112896, -25560.898605591057, -25713.51321003798, -25802.15825834444, -25559.61234837715, -25889.63188350402, -25739.953136814795, -25905.76233675474, -25818.73858470875, -25626.132600040637, -25647.313681746455, -25892.368079272357, -25638.759148403686, -25715.057738798045, -25844.66944533116, -25870.25614207713, -25920.880645498226, -25668.043754945003, -25738.768563863236, -25892.207337860433, -25581.518823479943, -25814.845674665205, -25556.672685873964], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.40454268590368, "mean_inference_ms": 0.24650096965893592, "mean_action_processing_ms": 0.058625255803207973, "mean_env_wait_ms": 1.465710382666437, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00241851806640625, "StateBufferConnector_ms": 0.0017590522766113281, "ViewRequirementAgentConnector_ms": 0.04457378387451172}}, "episode_reward_max": -25344.64897438416, "episode_reward_min": -26205.70083769718, "episode_reward_mean": -25741.41728710454, "episode_len_mean": 360.0, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-25697.684362738815, -25508.048711270992, -26094.663579417545, -25816.146718002194, -25716.144424613198, -25716.9481468649, -25665.566155129305, -25659.414796121277, -25772.670297136126, -25838.051876520363, -25714.847273388325, -25604.794673633114, -25870.42453626149, -25584.03090843049, -25644.102076721312, -25752.654664348305, -25728.72420860095, -25344.64897438416, -25870.13531983831, -25679.36252044645, -25520.5175893975, -25877.87854023866, -25703.58373654276, -25725.653965028694, -25907.07813772965, -25727.131715233652, -25480.010086560058, -25445.419991757793, -25741.123343990854, -25782.960889559843, -25872.899679976377, -25794.34741318721, -25799.76148173705, -25692.890423418765, -25748.219230430648, -25736.440535675774, -25811.304235029627, -25784.8955521969, -25953.75570528783, -25649.10375708023, -25940.48352988541, -25841.448422768386, -25735.38842146472, -26205.70083769718, -25638.51064012693, -26031.456607431224, -25792.880448707605, -25841.402077860756, -25972.625161817006, -25843.01368514434, -25908.119496861847, -25692.733137276053, -25525.769012512654, -25823.480394710994, -25907.283641629238, -25515.59897538544, -25868.589035265955, -25577.18772125025, -25877.66864154889, -25596.9536006921, -25788.25850036741, -25427.471536829886, -26112.41235184759, -25471.38449448666, -25411.487289326662, -25860.155843439974, -25803.86093513066, -25562.412268598353, -25803.546394953195, -25484.054687925844, -26073.427377665303, -26012.300427767903, -25876.122433853667, -25756.47538442769, -25646.33086290482, -25487.666593624537, -25390.160806222, -25606.10411112896, -25560.898605591057, -25713.51321003798, -25802.15825834444, -25559.61234837715, -25889.63188350402, -25739.953136814795, -25905.76233675474, -25818.73858470875, -25626.132600040637, -25647.313681746455, -25892.368079272357, -25638.759148403686, -25715.057738798045, -25844.66944533116, -25870.25614207713, -25920.880645498226, -25668.043754945003, -25738.768563863236, -25892.207337860433, -25581.518823479943, -25814.845674665205, -25556.672685873964], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.40454268590368, "mean_inference_ms": 0.24650096965893592, "mean_action_processing_ms": 0.058625255803207973, "mean_env_wait_ms": 1.465710382666437, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00241851806640625, "StateBufferConnector_ms": 0.0017590522766113281, "ViewRequirementAgentConnector_ms": 0.04457378387451172}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 105840, "num_agent_steps_trained": 105840, "num_env_steps_sampled": 105840, "num_env_steps_trained": 105840, "num_env_steps_sampled_this_iter": 1800, "num_env_steps_trained_this_iter": 1800, "num_env_steps_sampled_throughput_per_sec": 161.16140855518228, "num_env_steps_trained_throughput_per_sec": 161.16140855518228, "timesteps_total": 105840, "num_steps_trained_this_iter": 1800, "agent_timesteps_total": 105840, "timers": {"training_iteration_time_ms": 2234.79, "sample_time_ms": 2227.411, "load_time_ms": 0.216, "load_throughput": 1665140.538, "learn_time_ms": 6.579, "learn_throughput": 54717.433, "synch_weights_time_ms": 0.548}, "counters": {"num_env_steps_sampled": 105840, "num_env_steps_trained": 105840, "num_agent_steps_sampled": 105840, "num_agent_steps_trained": 105840}, "done": false, "episodes_total": 294, "training_iteration": 59, "trial_id": "f5e97_00000", "date": "2023-07-25_17-06-52", "timestamp": 1690294012, "time_this_iter_s": 11.17105221748352, "time_total_s": 658.1808326244354, "pid": 71917, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[0, 0.003], [5400, 0.001], [10800, 0.00075], [16200, 0.0005], [21600, 0.00025], [27000, 0.0001], [32400, 7.5e-05], [37800, 5e-05], [43200, 2.5e-05], [48600, 1e-05], [54000, 7.5e-06], [59400, 5e-06], [64800, 2.5e-06], [70200, 1e-06], [75600, 5e-07], [81000, 1e-07]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x304530310>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 658.1808326244354, "iterations_since_restore": 59, "perf": {"cpu_util_percent": 23.75625, "ram_util_percent": 79.30000000000001}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-07, "entropy_coeff": 0.1, "policy_entropy": -926.6997436523437, "policy_loss": -40160488924774.4, "vf_loss": 1079474585.6}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 1493.0, "diff_num_grad_updates_vs_sampler_policy": 1492.0}}, "num_env_steps_sampled": 107640, "num_env_steps_trained": 107640, "num_agent_steps_sampled": 107640, "num_agent_steps_trained": 107640}, "sampler_results": {"episode_reward_max": -25344.64897438416, "episode_reward_min": -26205.70083769718, "episode_reward_mean": -25741.63528848441, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-25716.9481468649, -25665.566155129305, -25659.414796121277, -25772.670297136126, -25838.051876520363, -25714.847273388325, -25604.794673633114, -25870.42453626149, -25584.03090843049, -25644.102076721312, -25752.654664348305, -25728.72420860095, -25344.64897438416, -25870.13531983831, -25679.36252044645, -25520.5175893975, -25877.87854023866, -25703.58373654276, -25725.653965028694, -25907.07813772965, -25727.131715233652, -25480.010086560058, -25445.419991757793, -25741.123343990854, -25782.960889559843, -25872.899679976377, -25794.34741318721, -25799.76148173705, -25692.890423418765, -25748.219230430648, -25736.440535675774, -25811.304235029627, -25784.8955521969, -25953.75570528783, -25649.10375708023, -25940.48352988541, -25841.448422768386, -25735.38842146472, -26205.70083769718, -25638.51064012693, -26031.456607431224, -25792.880448707605, -25841.402077860756, -25972.625161817006, -25843.01368514434, -25908.119496861847, -25692.733137276053, -25525.769012512654, -25823.480394710994, -25907.283641629238, -25515.59897538544, -25868.589035265955, -25577.18772125025, -25877.66864154889, -25596.9536006921, -25788.25850036741, -25427.471536829886, -26112.41235184759, -25471.38449448666, -25411.487289326662, -25860.155843439974, -25803.86093513066, -25562.412268598353, -25803.546394953195, -25484.054687925844, -26073.427377665303, -26012.300427767903, -25876.122433853667, -25756.47538442769, -25646.33086290482, -25487.666593624537, -25390.160806222, -25606.10411112896, -25560.898605591057, -25713.51321003798, -25802.15825834444, -25559.61234837715, -25889.63188350402, -25739.953136814795, -25905.76233675474, -25818.73858470875, -25626.132600040637, -25647.313681746455, -25892.368079272357, -25638.759148403686, -25715.057738798045, -25844.66944533116, -25870.25614207713, -25920.880645498226, -25668.043754945003, -25738.768563863236, -25892.207337860433, -25581.518823479943, -25814.845674665205, -25556.672685873964, -25752.225778040585, -25770.54105836333, -25899.106776175176, -25840.86293602915, -25591.75138542168], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.4046828297851235, "mean_inference_ms": 0.24653145542641763, "mean_action_processing_ms": 0.05863225161354558, "mean_env_wait_ms": 1.4654283050562094, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0024247169494628906, "StateBufferConnector_ms": 0.0017647743225097656, "ViewRequirementAgentConnector_ms": 0.044643402099609375}}, "episode_reward_max": -25344.64897438416, "episode_reward_min": -26205.70083769718, "episode_reward_mean": -25741.63528848441, "episode_len_mean": 360.0, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-25716.9481468649, -25665.566155129305, -25659.414796121277, -25772.670297136126, -25838.051876520363, -25714.847273388325, -25604.794673633114, -25870.42453626149, -25584.03090843049, -25644.102076721312, -25752.654664348305, -25728.72420860095, -25344.64897438416, -25870.13531983831, -25679.36252044645, -25520.5175893975, -25877.87854023866, -25703.58373654276, -25725.653965028694, -25907.07813772965, -25727.131715233652, -25480.010086560058, -25445.419991757793, -25741.123343990854, -25782.960889559843, -25872.899679976377, -25794.34741318721, -25799.76148173705, -25692.890423418765, -25748.219230430648, -25736.440535675774, -25811.304235029627, -25784.8955521969, -25953.75570528783, -25649.10375708023, -25940.48352988541, -25841.448422768386, -25735.38842146472, -26205.70083769718, -25638.51064012693, -26031.456607431224, -25792.880448707605, -25841.402077860756, -25972.625161817006, -25843.01368514434, -25908.119496861847, -25692.733137276053, -25525.769012512654, -25823.480394710994, -25907.283641629238, -25515.59897538544, -25868.589035265955, -25577.18772125025, -25877.66864154889, -25596.9536006921, -25788.25850036741, -25427.471536829886, -26112.41235184759, -25471.38449448666, -25411.487289326662, -25860.155843439974, -25803.86093513066, -25562.412268598353, -25803.546394953195, -25484.054687925844, -26073.427377665303, -26012.300427767903, -25876.122433853667, -25756.47538442769, -25646.33086290482, -25487.666593624537, -25390.160806222, -25606.10411112896, -25560.898605591057, -25713.51321003798, -25802.15825834444, -25559.61234837715, -25889.63188350402, -25739.953136814795, -25905.76233675474, -25818.73858470875, -25626.132600040637, -25647.313681746455, -25892.368079272357, -25638.759148403686, -25715.057738798045, -25844.66944533116, -25870.25614207713, -25920.880645498226, -25668.043754945003, -25738.768563863236, -25892.207337860433, -25581.518823479943, -25814.845674665205, -25556.672685873964, -25752.225778040585, -25770.54105836333, -25899.106776175176, -25840.86293602915, -25591.75138542168], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.4046828297851235, "mean_inference_ms": 0.24653145542641763, "mean_action_processing_ms": 0.05863225161354558, "mean_env_wait_ms": 1.4654283050562094, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0024247169494628906, "StateBufferConnector_ms": 0.0017647743225097656, "ViewRequirementAgentConnector_ms": 0.044643402099609375}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 107640, "num_agent_steps_trained": 107640, "num_env_steps_sampled": 107640, "num_env_steps_trained": 107640, "num_env_steps_sampled_this_iter": 1800, "num_env_steps_trained_this_iter": 1800, "num_env_steps_sampled_throughput_per_sec": 161.9247860993104, "num_env_steps_trained_throughput_per_sec": 161.9247860993104, "timesteps_total": 107640, "num_steps_trained_this_iter": 1800, "agent_timesteps_total": 107640, "timers": {"training_iteration_time_ms": 2228.51, "sample_time_ms": 2221.321, "load_time_ms": 0.216, "load_throughput": 1664773.363, "learn_time_ms": 6.386, "learn_throughput": 56374.843, "synch_weights_time_ms": 0.553}, "counters": {"num_env_steps_sampled": 107640, "num_env_steps_trained": 107640, "num_agent_steps_sampled": 107640, "num_agent_steps_trained": 107640}, "done": false, "episodes_total": 299, "training_iteration": 60, "trial_id": "f5e97_00000", "date": "2023-07-25_17-07-03", "timestamp": 1690294023, "time_this_iter_s": 11.1197350025177, "time_total_s": 669.3005676269531, "pid": 71917, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[0, 0.003], [5400, 0.001], [10800, 0.00075], [16200, 0.0005], [21600, 0.00025], [27000, 0.0001], [32400, 7.5e-05], [37800, 5e-05], [43200, 2.5e-05], [48600, 1e-05], [54000, 7.5e-06], [59400, 5e-06], [64800, 2.5e-06], [70200, 1e-06], [75600, 5e-07], [81000, 1e-07]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x304530310>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 669.3005676269531, "iterations_since_restore": 60, "perf": {"cpu_util_percent": 21.773333333333333, "ram_util_percent": 79.09333333333333}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-07, "entropy_coeff": 0.1, "policy_entropy": -926.699609375, "policy_loss": -37616421588172.8, "vf_loss": 1107014387.2}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 1518.0, "diff_num_grad_updates_vs_sampler_policy": 1517.0}}, "num_env_steps_sampled": 109440, "num_env_steps_trained": 109440, "num_agent_steps_sampled": 109440, "num_agent_steps_trained": 109440}, "sampler_results": {"episode_reward_max": -25344.64897438416, "episode_reward_min": -26205.70083769718, "episode_reward_mean": -25741.382227119375, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-25714.847273388325, -25604.794673633114, -25870.42453626149, -25584.03090843049, -25644.102076721312, -25752.654664348305, -25728.72420860095, -25344.64897438416, -25870.13531983831, -25679.36252044645, -25520.5175893975, -25877.87854023866, -25703.58373654276, -25725.653965028694, -25907.07813772965, -25727.131715233652, -25480.010086560058, -25445.419991757793, -25741.123343990854, -25782.960889559843, -25872.899679976377, -25794.34741318721, -25799.76148173705, -25692.890423418765, -25748.219230430648, -25736.440535675774, -25811.304235029627, -25784.8955521969, -25953.75570528783, -25649.10375708023, -25940.48352988541, -25841.448422768386, -25735.38842146472, -26205.70083769718, -25638.51064012693, -26031.456607431224, -25792.880448707605, -25841.402077860756, -25972.625161817006, -25843.01368514434, -25908.119496861847, -25692.733137276053, -25525.769012512654, -25823.480394710994, -25907.283641629238, -25515.59897538544, -25868.589035265955, -25577.18772125025, -25877.66864154889, -25596.9536006921, -25788.25850036741, -25427.471536829886, -26112.41235184759, -25471.38449448666, -25411.487289326662, -25860.155843439974, -25803.86093513066, -25562.412268598353, -25803.546394953195, -25484.054687925844, -26073.427377665303, -26012.300427767903, -25876.122433853667, -25756.47538442769, -25646.33086290482, -25487.666593624537, -25390.160806222, -25606.10411112896, -25560.898605591057, -25713.51321003798, -25802.15825834444, -25559.61234837715, -25889.63188350402, -25739.953136814795, -25905.76233675474, -25818.73858470875, -25626.132600040637, -25647.313681746455, -25892.368079272357, -25638.759148403686, -25715.057738798045, -25844.66944533116, -25870.25614207713, -25920.880645498226, -25668.043754945003, -25738.768563863236, -25892.207337860433, -25581.518823479943, -25814.845674665205, -25556.672685873964, -25752.225778040585, -25770.54105836333, -25899.106776175176, -25840.86293602915, -25591.75138542168, -25510.290830657505, -25511.778369728654, -25812.90503700192, -25931.909280124957, -25860.461617755886], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.40487703616982, "mean_inference_ms": 0.24655893636645318, "mean_action_processing_ms": 0.05863839185168869, "mean_env_wait_ms": 1.4651671609279966, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0024187564849853516, "StateBufferConnector_ms": 0.0017719268798828125, "ViewRequirementAgentConnector_ms": 0.04459118843078613}}, "episode_reward_max": -25344.64897438416, "episode_reward_min": -26205.70083769718, "episode_reward_mean": -25741.382227119375, "episode_len_mean": 360.0, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-25714.847273388325, -25604.794673633114, -25870.42453626149, -25584.03090843049, -25644.102076721312, -25752.654664348305, -25728.72420860095, -25344.64897438416, -25870.13531983831, -25679.36252044645, -25520.5175893975, -25877.87854023866, -25703.58373654276, -25725.653965028694, -25907.07813772965, -25727.131715233652, -25480.010086560058, -25445.419991757793, -25741.123343990854, -25782.960889559843, -25872.899679976377, -25794.34741318721, -25799.76148173705, -25692.890423418765, -25748.219230430648, -25736.440535675774, -25811.304235029627, -25784.8955521969, -25953.75570528783, -25649.10375708023, -25940.48352988541, -25841.448422768386, -25735.38842146472, -26205.70083769718, -25638.51064012693, -26031.456607431224, -25792.880448707605, -25841.402077860756, -25972.625161817006, -25843.01368514434, -25908.119496861847, -25692.733137276053, -25525.769012512654, -25823.480394710994, -25907.283641629238, -25515.59897538544, -25868.589035265955, -25577.18772125025, -25877.66864154889, -25596.9536006921, -25788.25850036741, -25427.471536829886, -26112.41235184759, -25471.38449448666, -25411.487289326662, -25860.155843439974, -25803.86093513066, -25562.412268598353, -25803.546394953195, -25484.054687925844, -26073.427377665303, -26012.300427767903, -25876.122433853667, -25756.47538442769, -25646.33086290482, -25487.666593624537, -25390.160806222, -25606.10411112896, -25560.898605591057, -25713.51321003798, -25802.15825834444, -25559.61234837715, -25889.63188350402, -25739.953136814795, -25905.76233675474, -25818.73858470875, -25626.132600040637, -25647.313681746455, -25892.368079272357, -25638.759148403686, -25715.057738798045, -25844.66944533116, -25870.25614207713, -25920.880645498226, -25668.043754945003, -25738.768563863236, -25892.207337860433, -25581.518823479943, -25814.845674665205, -25556.672685873964, -25752.225778040585, -25770.54105836333, -25899.106776175176, -25840.86293602915, -25591.75138542168, -25510.290830657505, -25511.778369728654, -25812.90503700192, -25931.909280124957, -25860.461617755886], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.40487703616982, "mean_inference_ms": 0.24655893636645318, "mean_action_processing_ms": 0.05863839185168869, "mean_env_wait_ms": 1.4651671609279966, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0024187564849853516, "StateBufferConnector_ms": 0.0017719268798828125, "ViewRequirementAgentConnector_ms": 0.04459118843078613}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 109440, "num_agent_steps_trained": 109440, "num_env_steps_sampled": 109440, "num_env_steps_trained": 109440, "num_env_steps_sampled_this_iter": 1800, "num_env_steps_trained_this_iter": 1800, "num_env_steps_sampled_throughput_per_sec": 161.09645878496087, "num_env_steps_trained_throughput_per_sec": 161.09645878496087, "timesteps_total": 109440, "num_steps_trained_this_iter": 1800, "agent_timesteps_total": 109440, "timers": {"training_iteration_time_ms": 2228.959, "sample_time_ms": 2221.606, "load_time_ms": 0.221, "load_throughput": 1630791.057, "learn_time_ms": 6.528, "learn_throughput": 55145.481, "synch_weights_time_ms": 0.566}, "counters": {"num_env_steps_sampled": 109440, "num_env_steps_trained": 109440, "num_agent_steps_sampled": 109440, "num_agent_steps_trained": 109440}, "done": false, "episodes_total": 304, "training_iteration": 61, "trial_id": "f5e97_00000", "date": "2023-07-25_17-07-14", "timestamp": 1690294034, "time_this_iter_s": 11.17563271522522, "time_total_s": 680.4762003421783, "pid": 71917, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[0, 0.003], [5400, 0.001], [10800, 0.00075], [16200, 0.0005], [21600, 0.00025], [27000, 0.0001], [32400, 7.5e-05], [37800, 5e-05], [43200, 2.5e-05], [48600, 1e-05], [54000, 7.5e-06], [59400, 5e-06], [64800, 2.5e-06], [70200, 1e-06], [75600, 5e-07], [81000, 1e-07]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x304530310>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 680.4762003421783, "iterations_since_restore": 61, "perf": {"cpu_util_percent": 24.96875, "ram_util_percent": 79.03125}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-07, "entropy_coeff": 0.1, "policy_entropy": -926.6998413085937, "policy_loss": -29749429479014.4, "vf_loss": 1091600972.8}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 1543.0, "diff_num_grad_updates_vs_sampler_policy": 1542.0}}, "num_env_steps_sampled": 111240, "num_env_steps_trained": 111240, "num_agent_steps_sampled": 111240, "num_agent_steps_trained": 111240}, "sampler_results": {"episode_reward_max": -25344.64897438416, "episode_reward_min": -26205.70083769718, "episode_reward_mean": -25746.804384523166, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-25752.654664348305, -25728.72420860095, -25344.64897438416, -25870.13531983831, -25679.36252044645, -25520.5175893975, -25877.87854023866, -25703.58373654276, -25725.653965028694, -25907.07813772965, -25727.131715233652, -25480.010086560058, -25445.419991757793, -25741.123343990854, -25782.960889559843, -25872.899679976377, -25794.34741318721, -25799.76148173705, -25692.890423418765, -25748.219230430648, -25736.440535675774, -25811.304235029627, -25784.8955521969, -25953.75570528783, -25649.10375708023, -25940.48352988541, -25841.448422768386, -25735.38842146472, -26205.70083769718, -25638.51064012693, -26031.456607431224, -25792.880448707605, -25841.402077860756, -25972.625161817006, -25843.01368514434, -25908.119496861847, -25692.733137276053, -25525.769012512654, -25823.480394710994, -25907.283641629238, -25515.59897538544, -25868.589035265955, -25577.18772125025, -25877.66864154889, -25596.9536006921, -25788.25850036741, -25427.471536829886, -26112.41235184759, -25471.38449448666, -25411.487289326662, -25860.155843439974, -25803.86093513066, -25562.412268598353, -25803.546394953195, -25484.054687925844, -26073.427377665303, -26012.300427767903, -25876.122433853667, -25756.47538442769, -25646.33086290482, -25487.666593624537, -25390.160806222, -25606.10411112896, -25560.898605591057, -25713.51321003798, -25802.15825834444, -25559.61234837715, -25889.63188350402, -25739.953136814795, -25905.76233675474, -25818.73858470875, -25626.132600040637, -25647.313681746455, -25892.368079272357, -25638.759148403686, -25715.057738798045, -25844.66944533116, -25870.25614207713, -25920.880645498226, -25668.043754945003, -25738.768563863236, -25892.207337860433, -25581.518823479943, -25814.845674665205, -25556.672685873964, -25752.225778040585, -25770.54105836333, -25899.106776175176, -25840.86293602915, -25591.75138542168, -25510.290830657505, -25511.778369728654, -25812.90503700192, -25931.909280124957, -25860.461617755886, -25897.511315067466, -25792.746336386426, -25964.12300908346, -25634.24535731137, -25671.789190964275], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.405021504323455, "mean_inference_ms": 0.246580222398031, "mean_action_processing_ms": 0.0586439126247479, "mean_env_wait_ms": 1.4648862725888614, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002424001693725586, "StateBufferConnector_ms": 0.0017712116241455078, "ViewRequirementAgentConnector_ms": 0.04460453987121582}}, "episode_reward_max": -25344.64897438416, "episode_reward_min": -26205.70083769718, "episode_reward_mean": -25746.804384523166, "episode_len_mean": 360.0, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-25752.654664348305, -25728.72420860095, -25344.64897438416, -25870.13531983831, -25679.36252044645, -25520.5175893975, -25877.87854023866, -25703.58373654276, -25725.653965028694, -25907.07813772965, -25727.131715233652, -25480.010086560058, -25445.419991757793, -25741.123343990854, -25782.960889559843, -25872.899679976377, -25794.34741318721, -25799.76148173705, -25692.890423418765, -25748.219230430648, -25736.440535675774, -25811.304235029627, -25784.8955521969, -25953.75570528783, -25649.10375708023, -25940.48352988541, -25841.448422768386, -25735.38842146472, -26205.70083769718, -25638.51064012693, -26031.456607431224, -25792.880448707605, -25841.402077860756, -25972.625161817006, -25843.01368514434, -25908.119496861847, -25692.733137276053, -25525.769012512654, -25823.480394710994, -25907.283641629238, -25515.59897538544, -25868.589035265955, -25577.18772125025, -25877.66864154889, -25596.9536006921, -25788.25850036741, -25427.471536829886, -26112.41235184759, -25471.38449448666, -25411.487289326662, -25860.155843439974, -25803.86093513066, -25562.412268598353, -25803.546394953195, -25484.054687925844, -26073.427377665303, -26012.300427767903, -25876.122433853667, -25756.47538442769, -25646.33086290482, -25487.666593624537, -25390.160806222, -25606.10411112896, -25560.898605591057, -25713.51321003798, -25802.15825834444, -25559.61234837715, -25889.63188350402, -25739.953136814795, -25905.76233675474, -25818.73858470875, -25626.132600040637, -25647.313681746455, -25892.368079272357, -25638.759148403686, -25715.057738798045, -25844.66944533116, -25870.25614207713, -25920.880645498226, -25668.043754945003, -25738.768563863236, -25892.207337860433, -25581.518823479943, -25814.845674665205, -25556.672685873964, -25752.225778040585, -25770.54105836333, -25899.106776175176, -25840.86293602915, -25591.75138542168, -25510.290830657505, -25511.778369728654, -25812.90503700192, -25931.909280124957, -25860.461617755886, -25897.511315067466, -25792.746336386426, -25964.12300908346, -25634.24535731137, -25671.789190964275], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.405021504323455, "mean_inference_ms": 0.246580222398031, "mean_action_processing_ms": 0.0586439126247479, "mean_env_wait_ms": 1.4648862725888614, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002424001693725586, "StateBufferConnector_ms": 0.0017712116241455078, "ViewRequirementAgentConnector_ms": 0.04460453987121582}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 111240, "num_agent_steps_trained": 111240, "num_env_steps_sampled": 111240, "num_env_steps_trained": 111240, "num_env_steps_sampled_this_iter": 1800, "num_env_steps_trained_this_iter": 1800, "num_env_steps_sampled_throughput_per_sec": 163.15064955906035, "num_env_steps_trained_throughput_per_sec": 163.15064955906035, "timesteps_total": 111240, "num_steps_trained_this_iter": 1800, "agent_timesteps_total": 111240, "timers": {"training_iteration_time_ms": 2220.608, "sample_time_ms": 2213.394, "load_time_ms": 0.222, "load_throughput": 1623077.975, "learn_time_ms": 6.42, "learn_throughput": 56076.707, "synch_weights_time_ms": 0.534}, "counters": {"num_env_steps_sampled": 111240, "num_env_steps_trained": 111240, "num_agent_steps_sampled": 111240, "num_agent_steps_trained": 111240}, "done": false, "episodes_total": 309, "training_iteration": 62, "trial_id": "f5e97_00000", "date": "2023-07-25_17-07-25", "timestamp": 1690294045, "time_this_iter_s": 11.034918785095215, "time_total_s": 691.5111191272736, "pid": 71917, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[0, 0.003], [5400, 0.001], [10800, 0.00075], [16200, 0.0005], [21600, 0.00025], [27000, 0.0001], [32400, 7.5e-05], [37800, 5e-05], [43200, 2.5e-05], [48600, 1e-05], [54000, 7.5e-06], [59400, 5e-06], [64800, 2.5e-06], [70200, 1e-06], [75600, 5e-07], [81000, 1e-07]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x304530310>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 691.5111191272736, "iterations_since_restore": 62, "perf": {"cpu_util_percent": 26.425, "ram_util_percent": 77.68125}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-07, "entropy_coeff": 0.1, "policy_entropy": -926.6995849609375, "policy_loss": -32932918261350.4, "vf_loss": 1110327750.4}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 1568.0, "diff_num_grad_updates_vs_sampler_policy": 1567.0}}, "num_env_steps_sampled": 113040, "num_env_steps_trained": 113040, "num_agent_steps_sampled": 113040, "num_agent_steps_trained": 113040}, "sampler_results": {"episode_reward_max": -25390.160806222, "episode_reward_min": -26205.70083769718, "episode_reward_mean": -25747.00354426154, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-25520.5175893975, -25877.87854023866, -25703.58373654276, -25725.653965028694, -25907.07813772965, -25727.131715233652, -25480.010086560058, -25445.419991757793, -25741.123343990854, -25782.960889559843, -25872.899679976377, -25794.34741318721, -25799.76148173705, -25692.890423418765, -25748.219230430648, -25736.440535675774, -25811.304235029627, -25784.8955521969, -25953.75570528783, -25649.10375708023, -25940.48352988541, -25841.448422768386, -25735.38842146472, -26205.70083769718, -25638.51064012693, -26031.456607431224, -25792.880448707605, -25841.402077860756, -25972.625161817006, -25843.01368514434, -25908.119496861847, -25692.733137276053, -25525.769012512654, -25823.480394710994, -25907.283641629238, -25515.59897538544, -25868.589035265955, -25577.18772125025, -25877.66864154889, -25596.9536006921, -25788.25850036741, -25427.471536829886, -26112.41235184759, -25471.38449448666, -25411.487289326662, -25860.155843439974, -25803.86093513066, -25562.412268598353, -25803.546394953195, -25484.054687925844, -26073.427377665303, -26012.300427767903, -25876.122433853667, -25756.47538442769, -25646.33086290482, -25487.666593624537, -25390.160806222, -25606.10411112896, -25560.898605591057, -25713.51321003798, -25802.15825834444, -25559.61234837715, -25889.63188350402, -25739.953136814795, -25905.76233675474, -25818.73858470875, -25626.132600040637, -25647.313681746455, -25892.368079272357, -25638.759148403686, -25715.057738798045, -25844.66944533116, -25870.25614207713, -25920.880645498226, -25668.043754945003, -25738.768563863236, -25892.207337860433, -25581.518823479943, -25814.845674665205, -25556.672685873964, -25752.225778040585, -25770.54105836333, -25899.106776175176, -25840.86293602915, -25591.75138542168, -25510.290830657505, -25511.778369728654, -25812.90503700192, -25931.909280124957, -25860.461617755886, -25897.511315067466, -25792.746336386426, -25964.12300908346, -25634.24535731137, -25671.789190964275, -25518.673086091916, -25813.547403917546, -25526.71753209267, -25735.383906722796, -25801.119732630206], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.405138121491125, "mean_inference_ms": 0.2466022921444891, "mean_action_processing_ms": 0.058649559438292566, "mean_env_wait_ms": 1.4646250395748115, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0024216175079345703, "StateBufferConnector_ms": 0.0017728805541992188, "ViewRequirementAgentConnector_ms": 0.0447390079498291}}, "episode_reward_max": -25390.160806222, "episode_reward_min": -26205.70083769718, "episode_reward_mean": -25747.00354426154, "episode_len_mean": 360.0, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-25520.5175893975, -25877.87854023866, -25703.58373654276, -25725.653965028694, -25907.07813772965, -25727.131715233652, -25480.010086560058, -25445.419991757793, -25741.123343990854, -25782.960889559843, -25872.899679976377, -25794.34741318721, -25799.76148173705, -25692.890423418765, -25748.219230430648, -25736.440535675774, -25811.304235029627, -25784.8955521969, -25953.75570528783, -25649.10375708023, -25940.48352988541, -25841.448422768386, -25735.38842146472, -26205.70083769718, -25638.51064012693, -26031.456607431224, -25792.880448707605, -25841.402077860756, -25972.625161817006, -25843.01368514434, -25908.119496861847, -25692.733137276053, -25525.769012512654, -25823.480394710994, -25907.283641629238, -25515.59897538544, -25868.589035265955, -25577.18772125025, -25877.66864154889, -25596.9536006921, -25788.25850036741, -25427.471536829886, -26112.41235184759, -25471.38449448666, -25411.487289326662, -25860.155843439974, -25803.86093513066, -25562.412268598353, -25803.546394953195, -25484.054687925844, -26073.427377665303, -26012.300427767903, -25876.122433853667, -25756.47538442769, -25646.33086290482, -25487.666593624537, -25390.160806222, -25606.10411112896, -25560.898605591057, -25713.51321003798, -25802.15825834444, -25559.61234837715, -25889.63188350402, -25739.953136814795, -25905.76233675474, -25818.73858470875, -25626.132600040637, -25647.313681746455, -25892.368079272357, -25638.759148403686, -25715.057738798045, -25844.66944533116, -25870.25614207713, -25920.880645498226, -25668.043754945003, -25738.768563863236, -25892.207337860433, -25581.518823479943, -25814.845674665205, -25556.672685873964, -25752.225778040585, -25770.54105836333, -25899.106776175176, -25840.86293602915, -25591.75138542168, -25510.290830657505, -25511.778369728654, -25812.90503700192, -25931.909280124957, -25860.461617755886, -25897.511315067466, -25792.746336386426, -25964.12300908346, -25634.24535731137, -25671.789190964275, -25518.673086091916, -25813.547403917546, -25526.71753209267, -25735.383906722796, -25801.119732630206], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.405138121491125, "mean_inference_ms": 0.2466022921444891, "mean_action_processing_ms": 0.058649559438292566, "mean_env_wait_ms": 1.4646250395748115, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0024216175079345703, "StateBufferConnector_ms": 0.0017728805541992188, "ViewRequirementAgentConnector_ms": 0.0447390079498291}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 113040, "num_agent_steps_trained": 113040, "num_env_steps_sampled": 113040, "num_env_steps_trained": 113040, "num_env_steps_sampled_this_iter": 1800, "num_env_steps_trained_this_iter": 1800, "num_env_steps_sampled_throughput_per_sec": 161.17367397124522, "num_env_steps_trained_throughput_per_sec": 161.17367397124522, "timesteps_total": 113040, "num_steps_trained_this_iter": 1800, "agent_timesteps_total": 113040, "timers": {"training_iteration_time_ms": 2220.072, "sample_time_ms": 2213.026, "load_time_ms": 0.215, "load_throughput": 1671777.502, "learn_time_ms": 6.266, "learn_throughput": 57452.503, "synch_weights_time_ms": 0.532}, "counters": {"num_env_steps_sampled": 113040, "num_env_steps_trained": 113040, "num_agent_steps_sampled": 113040, "num_agent_steps_trained": 113040}, "done": false, "episodes_total": 314, "training_iteration": 63, "trial_id": "f5e97_00000", "date": "2023-07-25_17-07-37", "timestamp": 1690294057, "time_this_iter_s": 11.170248985290527, "time_total_s": 702.6813681125641, "pid": 71917, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[0, 0.003], [5400, 0.001], [10800, 0.00075], [16200, 0.0005], [21600, 0.00025], [27000, 0.0001], [32400, 7.5e-05], [37800, 5e-05], [43200, 2.5e-05], [48600, 1e-05], [54000, 7.5e-06], [59400, 5e-06], [64800, 2.5e-06], [70200, 1e-06], [75600, 5e-07], [81000, 1e-07]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x304530310>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 702.6813681125641, "iterations_since_restore": 63, "perf": {"cpu_util_percent": 25.91875, "ram_util_percent": 79.54375}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-07, "entropy_coeff": 0.1, "policy_entropy": -926.6993896484375, "policy_loss": -35405194067968.0, "vf_loss": 1130818880.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 1593.0, "diff_num_grad_updates_vs_sampler_policy": 1592.0}}, "num_env_steps_sampled": 114840, "num_env_steps_trained": 114840, "num_agent_steps_sampled": 114840, "num_agent_steps_trained": 114840}, "sampler_results": {"episode_reward_max": -25390.160806222, "episode_reward_min": -26205.70083769718, "episode_reward_mean": -25749.971514874574, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-25727.131715233652, -25480.010086560058, -25445.419991757793, -25741.123343990854, -25782.960889559843, -25872.899679976377, -25794.34741318721, -25799.76148173705, -25692.890423418765, -25748.219230430648, -25736.440535675774, -25811.304235029627, -25784.8955521969, -25953.75570528783, -25649.10375708023, -25940.48352988541, -25841.448422768386, -25735.38842146472, -26205.70083769718, -25638.51064012693, -26031.456607431224, -25792.880448707605, -25841.402077860756, -25972.625161817006, -25843.01368514434, -25908.119496861847, -25692.733137276053, -25525.769012512654, -25823.480394710994, -25907.283641629238, -25515.59897538544, -25868.589035265955, -25577.18772125025, -25877.66864154889, -25596.9536006921, -25788.25850036741, -25427.471536829886, -26112.41235184759, -25471.38449448666, -25411.487289326662, -25860.155843439974, -25803.86093513066, -25562.412268598353, -25803.546394953195, -25484.054687925844, -26073.427377665303, -26012.300427767903, -25876.122433853667, -25756.47538442769, -25646.33086290482, -25487.666593624537, -25390.160806222, -25606.10411112896, -25560.898605591057, -25713.51321003798, -25802.15825834444, -25559.61234837715, -25889.63188350402, -25739.953136814795, -25905.76233675474, -25818.73858470875, -25626.132600040637, -25647.313681746455, -25892.368079272357, -25638.759148403686, -25715.057738798045, -25844.66944533116, -25870.25614207713, -25920.880645498226, -25668.043754945003, -25738.768563863236, -25892.207337860433, -25581.518823479943, -25814.845674665205, -25556.672685873964, -25752.225778040585, -25770.54105836333, -25899.106776175176, -25840.86293602915, -25591.75138542168, -25510.290830657505, -25511.778369728654, -25812.90503700192, -25931.909280124957, -25860.461617755886, -25897.511315067466, -25792.746336386426, -25964.12300908346, -25634.24535731137, -25671.789190964275, -25518.673086091916, -25813.547403917546, -25526.71753209267, -25735.383906722796, -25801.119732630206, -25828.88528263503, -25831.823059561135, -25677.197986224346, -25687.04960455717, -26006.55309726376], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.4052092388919455, "mean_inference_ms": 0.2466207939566994, "mean_action_processing_ms": 0.058654663281338525, "mean_env_wait_ms": 1.464343379828861, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0024204254150390625, "StateBufferConnector_ms": 0.001764059066772461, "ViewRequirementAgentConnector_ms": 0.044640302658081055}}, "episode_reward_max": -25390.160806222, "episode_reward_min": -26205.70083769718, "episode_reward_mean": -25749.971514874574, "episode_len_mean": 360.0, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-25727.131715233652, -25480.010086560058, -25445.419991757793, -25741.123343990854, -25782.960889559843, -25872.899679976377, -25794.34741318721, -25799.76148173705, -25692.890423418765, -25748.219230430648, -25736.440535675774, -25811.304235029627, -25784.8955521969, -25953.75570528783, -25649.10375708023, -25940.48352988541, -25841.448422768386, -25735.38842146472, -26205.70083769718, -25638.51064012693, -26031.456607431224, -25792.880448707605, -25841.402077860756, -25972.625161817006, -25843.01368514434, -25908.119496861847, -25692.733137276053, -25525.769012512654, -25823.480394710994, -25907.283641629238, -25515.59897538544, -25868.589035265955, -25577.18772125025, -25877.66864154889, -25596.9536006921, -25788.25850036741, -25427.471536829886, -26112.41235184759, -25471.38449448666, -25411.487289326662, -25860.155843439974, -25803.86093513066, -25562.412268598353, -25803.546394953195, -25484.054687925844, -26073.427377665303, -26012.300427767903, -25876.122433853667, -25756.47538442769, -25646.33086290482, -25487.666593624537, -25390.160806222, -25606.10411112896, -25560.898605591057, -25713.51321003798, -25802.15825834444, -25559.61234837715, -25889.63188350402, -25739.953136814795, -25905.76233675474, -25818.73858470875, -25626.132600040637, -25647.313681746455, -25892.368079272357, -25638.759148403686, -25715.057738798045, -25844.66944533116, -25870.25614207713, -25920.880645498226, -25668.043754945003, -25738.768563863236, -25892.207337860433, -25581.518823479943, -25814.845674665205, -25556.672685873964, -25752.225778040585, -25770.54105836333, -25899.106776175176, -25840.86293602915, -25591.75138542168, -25510.290830657505, -25511.778369728654, -25812.90503700192, -25931.909280124957, -25860.461617755886, -25897.511315067466, -25792.746336386426, -25964.12300908346, -25634.24535731137, -25671.789190964275, -25518.673086091916, -25813.547403917546, -25526.71753209267, -25735.383906722796, -25801.119732630206, -25828.88528263503, -25831.823059561135, -25677.197986224346, -25687.04960455717, -26006.55309726376], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.4052092388919455, "mean_inference_ms": 0.2466207939566994, "mean_action_processing_ms": 0.058654663281338525, "mean_env_wait_ms": 1.464343379828861, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0024204254150390625, "StateBufferConnector_ms": 0.001764059066772461, "ViewRequirementAgentConnector_ms": 0.044640302658081055}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 114840, "num_agent_steps_trained": 114840, "num_env_steps_sampled": 114840, "num_env_steps_trained": 114840, "num_env_steps_sampled_this_iter": 1800, "num_env_steps_trained_this_iter": 1800, "num_env_steps_sampled_throughput_per_sec": 161.8545768325821, "num_env_steps_trained_throughput_per_sec": 161.8545768325821, "timesteps_total": 114840, "num_steps_trained_this_iter": 1800, "agent_timesteps_total": 114840, "timers": {"training_iteration_time_ms": 2228.907, "sample_time_ms": 2221.726, "load_time_ms": 0.214, "load_throughput": 1682957.468, "learn_time_ms": 6.385, "learn_throughput": 56378.422, "synch_weights_time_ms": 0.549}, "counters": {"num_env_steps_sampled": 114840, "num_env_steps_trained": 114840, "num_agent_steps_sampled": 114840, "num_agent_steps_trained": 114840}, "done": false, "episodes_total": 319, "training_iteration": 64, "trial_id": "f5e97_00000", "date": "2023-07-25_17-07-48", "timestamp": 1690294068, "time_this_iter_s": 11.123125076293945, "time_total_s": 713.804493188858, "pid": 71917, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[0, 0.003], [5400, 0.001], [10800, 0.00075], [16200, 0.0005], [21600, 0.00025], [27000, 0.0001], [32400, 7.5e-05], [37800, 5e-05], [43200, 2.5e-05], [48600, 1e-05], [54000, 7.5e-06], [59400, 5e-06], [64800, 2.5e-06], [70200, 1e-06], [75600, 5e-07], [81000, 1e-07]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x304530310>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 713.804493188858, "iterations_since_restore": 64, "perf": {"cpu_util_percent": 27.219999999999995, "ram_util_percent": 79.01333333333334}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-07, "entropy_coeff": 0.1, "policy_entropy": -926.6998168945313, "policy_loss": -34278987058380.8, "vf_loss": 1079440569.6}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 1618.0, "diff_num_grad_updates_vs_sampler_policy": 1617.0}}, "num_env_steps_sampled": 116640, "num_env_steps_trained": 116640, "num_agent_steps_sampled": 116640, "num_agent_steps_trained": 116640}, "sampler_results": {"episode_reward_max": -25390.160806222, "episode_reward_min": -26205.70083769718, "episode_reward_mean": -25753.876742133194, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-25872.899679976377, -25794.34741318721, -25799.76148173705, -25692.890423418765, -25748.219230430648, -25736.440535675774, -25811.304235029627, -25784.8955521969, -25953.75570528783, -25649.10375708023, -25940.48352988541, -25841.448422768386, -25735.38842146472, -26205.70083769718, -25638.51064012693, -26031.456607431224, -25792.880448707605, -25841.402077860756, -25972.625161817006, -25843.01368514434, -25908.119496861847, -25692.733137276053, -25525.769012512654, -25823.480394710994, -25907.283641629238, -25515.59897538544, -25868.589035265955, -25577.18772125025, -25877.66864154889, -25596.9536006921, -25788.25850036741, -25427.471536829886, -26112.41235184759, -25471.38449448666, -25411.487289326662, -25860.155843439974, -25803.86093513066, -25562.412268598353, -25803.546394953195, -25484.054687925844, -26073.427377665303, -26012.300427767903, -25876.122433853667, -25756.47538442769, -25646.33086290482, -25487.666593624537, -25390.160806222, -25606.10411112896, -25560.898605591057, -25713.51321003798, -25802.15825834444, -25559.61234837715, -25889.63188350402, -25739.953136814795, -25905.76233675474, -25818.73858470875, -25626.132600040637, -25647.313681746455, -25892.368079272357, -25638.759148403686, -25715.057738798045, -25844.66944533116, -25870.25614207713, -25920.880645498226, -25668.043754945003, -25738.768563863236, -25892.207337860433, -25581.518823479943, -25814.845674665205, -25556.672685873964, -25752.225778040585, -25770.54105836333, -25899.106776175176, -25840.86293602915, -25591.75138542168, -25510.290830657505, -25511.778369728654, -25812.90503700192, -25931.909280124957, -25860.461617755886, -25897.511315067466, -25792.746336386426, -25964.12300908346, -25634.24535731137, -25671.789190964275, -25518.673086091916, -25813.547403917546, -25526.71753209267, -25735.383906722796, -25801.119732630206, -25828.88528263503, -25831.823059561135, -25677.197986224346, -25687.04960455717, -26006.55309726376, -25695.4367463259, -25864.959502008885, -25787.11193002619, -25638.423404895515, -25581.237169707812], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.405263994577908, "mean_inference_ms": 0.24664037913169715, "mean_action_processing_ms": 0.0586600138308732, "mean_env_wait_ms": 1.4641064181758605, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002422332763671875, "StateBufferConnector_ms": 0.00176239013671875, "ViewRequirementAgentConnector_ms": 0.0446016788482666}}, "episode_reward_max": -25390.160806222, "episode_reward_min": -26205.70083769718, "episode_reward_mean": -25753.876742133194, "episode_len_mean": 360.0, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-25872.899679976377, -25794.34741318721, -25799.76148173705, -25692.890423418765, -25748.219230430648, -25736.440535675774, -25811.304235029627, -25784.8955521969, -25953.75570528783, -25649.10375708023, -25940.48352988541, -25841.448422768386, -25735.38842146472, -26205.70083769718, -25638.51064012693, -26031.456607431224, -25792.880448707605, -25841.402077860756, -25972.625161817006, -25843.01368514434, -25908.119496861847, -25692.733137276053, -25525.769012512654, -25823.480394710994, -25907.283641629238, -25515.59897538544, -25868.589035265955, -25577.18772125025, -25877.66864154889, -25596.9536006921, -25788.25850036741, -25427.471536829886, -26112.41235184759, -25471.38449448666, -25411.487289326662, -25860.155843439974, -25803.86093513066, -25562.412268598353, -25803.546394953195, -25484.054687925844, -26073.427377665303, -26012.300427767903, -25876.122433853667, -25756.47538442769, -25646.33086290482, -25487.666593624537, -25390.160806222, -25606.10411112896, -25560.898605591057, -25713.51321003798, -25802.15825834444, -25559.61234837715, -25889.63188350402, -25739.953136814795, -25905.76233675474, -25818.73858470875, -25626.132600040637, -25647.313681746455, -25892.368079272357, -25638.759148403686, -25715.057738798045, -25844.66944533116, -25870.25614207713, -25920.880645498226, -25668.043754945003, -25738.768563863236, -25892.207337860433, -25581.518823479943, -25814.845674665205, -25556.672685873964, -25752.225778040585, -25770.54105836333, -25899.106776175176, -25840.86293602915, -25591.75138542168, -25510.290830657505, -25511.778369728654, -25812.90503700192, -25931.909280124957, -25860.461617755886, -25897.511315067466, -25792.746336386426, -25964.12300908346, -25634.24535731137, -25671.789190964275, -25518.673086091916, -25813.547403917546, -25526.71753209267, -25735.383906722796, -25801.119732630206, -25828.88528263503, -25831.823059561135, -25677.197986224346, -25687.04960455717, -26006.55309726376, -25695.4367463259, -25864.959502008885, -25787.11193002619, -25638.423404895515, -25581.237169707812], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.405263994577908, "mean_inference_ms": 0.24664037913169715, "mean_action_processing_ms": 0.0586600138308732, "mean_env_wait_ms": 1.4641064181758605, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002422332763671875, "StateBufferConnector_ms": 0.00176239013671875, "ViewRequirementAgentConnector_ms": 0.0446016788482666}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 116640, "num_agent_steps_trained": 116640, "num_env_steps_sampled": 116640, "num_env_steps_trained": 116640, "num_env_steps_sampled_this_iter": 1800, "num_env_steps_trained_this_iter": 1800, "num_env_steps_sampled_throughput_per_sec": 161.98905359328748, "num_env_steps_trained_throughput_per_sec": 161.98905359328748, "timesteps_total": 116640, "num_steps_trained_this_iter": 1800, "agent_timesteps_total": 116640, "timers": {"training_iteration_time_ms": 2223.286, "sample_time_ms": 2216.142, "load_time_ms": 0.216, "load_throughput": 1668821.22, "learn_time_ms": 6.367, "learn_throughput": 56544.154, "synch_weights_time_ms": 0.529}, "counters": {"num_env_steps_sampled": 116640, "num_env_steps_trained": 116640, "num_agent_steps_sampled": 116640, "num_agent_steps_trained": 116640}, "done": false, "episodes_total": 324, "training_iteration": 65, "trial_id": "f5e97_00000", "date": "2023-07-25_17-07-59", "timestamp": 1690294079, "time_this_iter_s": 11.113880157470703, "time_total_s": 724.9183733463287, "pid": 71917, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[0, 0.003], [5400, 0.001], [10800, 0.00075], [16200, 0.0005], [21600, 0.00025], [27000, 0.0001], [32400, 7.5e-05], [37800, 5e-05], [43200, 2.5e-05], [48600, 1e-05], [54000, 7.5e-06], [59400, 5e-06], [64800, 2.5e-06], [70200, 1e-06], [75600, 5e-07], [81000, 1e-07]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x304530310>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 724.9183733463287, "iterations_since_restore": 65, "perf": {"cpu_util_percent": 23.2, "ram_util_percent": 78.90625}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-07, "entropy_coeff": 0.1, "policy_entropy": -926.69970703125, "policy_loss": -25727465796403.2, "vf_loss": 1110824019.2}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 1643.0, "diff_num_grad_updates_vs_sampler_policy": 1642.0}}, "num_env_steps_sampled": 118440, "num_env_steps_trained": 118440, "num_agent_steps_sampled": 118440, "num_agent_steps_trained": 118440}, "sampler_results": {"episode_reward_max": -25390.160806222, "episode_reward_min": -26205.70083769718, "episode_reward_mean": -25755.32875383303, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-25736.440535675774, -25811.304235029627, -25784.8955521969, -25953.75570528783, -25649.10375708023, -25940.48352988541, -25841.448422768386, -25735.38842146472, -26205.70083769718, -25638.51064012693, -26031.456607431224, -25792.880448707605, -25841.402077860756, -25972.625161817006, -25843.01368514434, -25908.119496861847, -25692.733137276053, -25525.769012512654, -25823.480394710994, -25907.283641629238, -25515.59897538544, -25868.589035265955, -25577.18772125025, -25877.66864154889, -25596.9536006921, -25788.25850036741, -25427.471536829886, -26112.41235184759, -25471.38449448666, -25411.487289326662, -25860.155843439974, -25803.86093513066, -25562.412268598353, -25803.546394953195, -25484.054687925844, -26073.427377665303, -26012.300427767903, -25876.122433853667, -25756.47538442769, -25646.33086290482, -25487.666593624537, -25390.160806222, -25606.10411112896, -25560.898605591057, -25713.51321003798, -25802.15825834444, -25559.61234837715, -25889.63188350402, -25739.953136814795, -25905.76233675474, -25818.73858470875, -25626.132600040637, -25647.313681746455, -25892.368079272357, -25638.759148403686, -25715.057738798045, -25844.66944533116, -25870.25614207713, -25920.880645498226, -25668.043754945003, -25738.768563863236, -25892.207337860433, -25581.518823479943, -25814.845674665205, -25556.672685873964, -25752.225778040585, -25770.54105836333, -25899.106776175176, -25840.86293602915, -25591.75138542168, -25510.290830657505, -25511.778369728654, -25812.90503700192, -25931.909280124957, -25860.461617755886, -25897.511315067466, -25792.746336386426, -25964.12300908346, -25634.24535731137, -25671.789190964275, -25518.673086091916, -25813.547403917546, -25526.71753209267, -25735.383906722796, -25801.119732630206, -25828.88528263503, -25831.823059561135, -25677.197986224346, -25687.04960455717, -26006.55309726376, -25695.4367463259, -25864.959502008885, -25787.11193002619, -25638.423404895515, -25581.237169707812, -25573.249009628562, -25905.690998452712, -26024.856504878888, -25706.668344990532, -25842.854540782766], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.405311504820527, "mean_inference_ms": 0.24665926899230256, "mean_action_processing_ms": 0.05866532365258333, "mean_env_wait_ms": 1.4638780185066917, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002421140670776367, "StateBufferConnector_ms": 0.0017681121826171875, "ViewRequirementAgentConnector_ms": 0.04472470283508301}}, "episode_reward_max": -25390.160806222, "episode_reward_min": -26205.70083769718, "episode_reward_mean": -25755.32875383303, "episode_len_mean": 360.0, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-25736.440535675774, -25811.304235029627, -25784.8955521969, -25953.75570528783, -25649.10375708023, -25940.48352988541, -25841.448422768386, -25735.38842146472, -26205.70083769718, -25638.51064012693, -26031.456607431224, -25792.880448707605, -25841.402077860756, -25972.625161817006, -25843.01368514434, -25908.119496861847, -25692.733137276053, -25525.769012512654, -25823.480394710994, -25907.283641629238, -25515.59897538544, -25868.589035265955, -25577.18772125025, -25877.66864154889, -25596.9536006921, -25788.25850036741, -25427.471536829886, -26112.41235184759, -25471.38449448666, -25411.487289326662, -25860.155843439974, -25803.86093513066, -25562.412268598353, -25803.546394953195, -25484.054687925844, -26073.427377665303, -26012.300427767903, -25876.122433853667, -25756.47538442769, -25646.33086290482, -25487.666593624537, -25390.160806222, -25606.10411112896, -25560.898605591057, -25713.51321003798, -25802.15825834444, -25559.61234837715, -25889.63188350402, -25739.953136814795, -25905.76233675474, -25818.73858470875, -25626.132600040637, -25647.313681746455, -25892.368079272357, -25638.759148403686, -25715.057738798045, -25844.66944533116, -25870.25614207713, -25920.880645498226, -25668.043754945003, -25738.768563863236, -25892.207337860433, -25581.518823479943, -25814.845674665205, -25556.672685873964, -25752.225778040585, -25770.54105836333, -25899.106776175176, -25840.86293602915, -25591.75138542168, -25510.290830657505, -25511.778369728654, -25812.90503700192, -25931.909280124957, -25860.461617755886, -25897.511315067466, -25792.746336386426, -25964.12300908346, -25634.24535731137, -25671.789190964275, -25518.673086091916, -25813.547403917546, -25526.71753209267, -25735.383906722796, -25801.119732630206, -25828.88528263503, -25831.823059561135, -25677.197986224346, -25687.04960455717, -26006.55309726376, -25695.4367463259, -25864.959502008885, -25787.11193002619, -25638.423404895515, -25581.237169707812, -25573.249009628562, -25905.690998452712, -26024.856504878888, -25706.668344990532, -25842.854540782766], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.405311504820527, "mean_inference_ms": 0.24665926899230256, "mean_action_processing_ms": 0.05866532365258333, "mean_env_wait_ms": 1.4638780185066917, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002421140670776367, "StateBufferConnector_ms": 0.0017681121826171875, "ViewRequirementAgentConnector_ms": 0.04472470283508301}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 118440, "num_agent_steps_trained": 118440, "num_env_steps_sampled": 118440, "num_env_steps_trained": 118440, "num_env_steps_sampled_this_iter": 1800, "num_env_steps_trained_this_iter": 1800, "num_env_steps_sampled_throughput_per_sec": 162.11877218940788, "num_env_steps_trained_throughput_per_sec": 162.11877218940788, "timesteps_total": 118440, "num_steps_trained_this_iter": 1800, "agent_timesteps_total": 118440, "timers": {"training_iteration_time_ms": 2221.474, "sample_time_ms": 2214.52, "load_time_ms": 0.216, "load_throughput": 1669005.681, "learn_time_ms": 6.185, "learn_throughput": 58204.147, "synch_weights_time_ms": 0.52}, "counters": {"num_env_steps_sampled": 118440, "num_env_steps_trained": 118440, "num_agent_steps_sampled": 118440, "num_agent_steps_trained": 118440}, "done": false, "episodes_total": 329, "training_iteration": 66, "trial_id": "f5e97_00000", "date": "2023-07-25_17-08-10", "timestamp": 1690294090, "time_this_iter_s": 11.105114221572876, "time_total_s": 736.0234875679016, "pid": 71917, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[0, 0.003], [5400, 0.001], [10800, 0.00075], [16200, 0.0005], [21600, 0.00025], [27000, 0.0001], [32400, 7.5e-05], [37800, 5e-05], [43200, 2.5e-05], [48600, 1e-05], [54000, 7.5e-06], [59400, 5e-06], [64800, 2.5e-06], [70200, 1e-06], [75600, 5e-07], [81000, 1e-07]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x304530310>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 736.0234875679016, "iterations_since_restore": 66, "perf": {"cpu_util_percent": 25.150000000000002, "ram_util_percent": 79.36875}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-07, "entropy_coeff": 0.1, "policy_entropy": -926.6996215820312, "policy_loss": -12774251030118.4, "vf_loss": 1115403180.8}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 1668.0, "diff_num_grad_updates_vs_sampler_policy": 1667.0}}, "num_env_steps_sampled": 120240, "num_env_steps_trained": 120240, "num_agent_steps_sampled": 120240, "num_agent_steps_trained": 120240}, "sampler_results": {"episode_reward_max": -25390.160806222, "episode_reward_min": -26205.70083769718, "episode_reward_mean": -25760.159976728937, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-25940.48352988541, -25841.448422768386, -25735.38842146472, -26205.70083769718, -25638.51064012693, -26031.456607431224, -25792.880448707605, -25841.402077860756, -25972.625161817006, -25843.01368514434, -25908.119496861847, -25692.733137276053, -25525.769012512654, -25823.480394710994, -25907.283641629238, -25515.59897538544, -25868.589035265955, -25577.18772125025, -25877.66864154889, -25596.9536006921, -25788.25850036741, -25427.471536829886, -26112.41235184759, -25471.38449448666, -25411.487289326662, -25860.155843439974, -25803.86093513066, -25562.412268598353, -25803.546394953195, -25484.054687925844, -26073.427377665303, -26012.300427767903, -25876.122433853667, -25756.47538442769, -25646.33086290482, -25487.666593624537, -25390.160806222, -25606.10411112896, -25560.898605591057, -25713.51321003798, -25802.15825834444, -25559.61234837715, -25889.63188350402, -25739.953136814795, -25905.76233675474, -25818.73858470875, -25626.132600040637, -25647.313681746455, -25892.368079272357, -25638.759148403686, -25715.057738798045, -25844.66944533116, -25870.25614207713, -25920.880645498226, -25668.043754945003, -25738.768563863236, -25892.207337860433, -25581.518823479943, -25814.845674665205, -25556.672685873964, -25752.225778040585, -25770.54105836333, -25899.106776175176, -25840.86293602915, -25591.75138542168, -25510.290830657505, -25511.778369728654, -25812.90503700192, -25931.909280124957, -25860.461617755886, -25897.511315067466, -25792.746336386426, -25964.12300908346, -25634.24535731137, -25671.789190964275, -25518.673086091916, -25813.547403917546, -25526.71753209267, -25735.383906722796, -25801.119732630206, -25828.88528263503, -25831.823059561135, -25677.197986224346, -25687.04960455717, -26006.55309726376, -25695.4367463259, -25864.959502008885, -25787.11193002619, -25638.423404895515, -25581.237169707812, -25573.249009628562, -25905.690998452712, -26024.856504878888, -25706.668344990532, -25842.854540782766, -25728.393436948525, -25760.387993940018, -26184.635395319758, -25797.144567018688, -25948.060681634084], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.405373950918822, "mean_inference_ms": 0.24667767423064638, "mean_action_processing_ms": 0.05867022495018049, "mean_env_wait_ms": 1.4636276722957842, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00244140625, "StateBufferConnector_ms": 0.0017695426940917969, "ViewRequirementAgentConnector_ms": 0.04493260383605957}}, "episode_reward_max": -25390.160806222, "episode_reward_min": -26205.70083769718, "episode_reward_mean": -25760.159976728937, "episode_len_mean": 360.0, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-25940.48352988541, -25841.448422768386, -25735.38842146472, -26205.70083769718, -25638.51064012693, -26031.456607431224, -25792.880448707605, -25841.402077860756, -25972.625161817006, -25843.01368514434, -25908.119496861847, -25692.733137276053, -25525.769012512654, -25823.480394710994, -25907.283641629238, -25515.59897538544, -25868.589035265955, -25577.18772125025, -25877.66864154889, -25596.9536006921, -25788.25850036741, -25427.471536829886, -26112.41235184759, -25471.38449448666, -25411.487289326662, -25860.155843439974, -25803.86093513066, -25562.412268598353, -25803.546394953195, -25484.054687925844, -26073.427377665303, -26012.300427767903, -25876.122433853667, -25756.47538442769, -25646.33086290482, -25487.666593624537, -25390.160806222, -25606.10411112896, -25560.898605591057, -25713.51321003798, -25802.15825834444, -25559.61234837715, -25889.63188350402, -25739.953136814795, -25905.76233675474, -25818.73858470875, -25626.132600040637, -25647.313681746455, -25892.368079272357, -25638.759148403686, -25715.057738798045, -25844.66944533116, -25870.25614207713, -25920.880645498226, -25668.043754945003, -25738.768563863236, -25892.207337860433, -25581.518823479943, -25814.845674665205, -25556.672685873964, -25752.225778040585, -25770.54105836333, -25899.106776175176, -25840.86293602915, -25591.75138542168, -25510.290830657505, -25511.778369728654, -25812.90503700192, -25931.909280124957, -25860.461617755886, -25897.511315067466, -25792.746336386426, -25964.12300908346, -25634.24535731137, -25671.789190964275, -25518.673086091916, -25813.547403917546, -25526.71753209267, -25735.383906722796, -25801.119732630206, -25828.88528263503, -25831.823059561135, -25677.197986224346, -25687.04960455717, -26006.55309726376, -25695.4367463259, -25864.959502008885, -25787.11193002619, -25638.423404895515, -25581.237169707812, -25573.249009628562, -25905.690998452712, -26024.856504878888, -25706.668344990532, -25842.854540782766, -25728.393436948525, -25760.387993940018, -26184.635395319758, -25797.144567018688, -25948.060681634084], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.405373950918822, "mean_inference_ms": 0.24667767423064638, "mean_action_processing_ms": 0.05867022495018049, "mean_env_wait_ms": 1.4636276722957842, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00244140625, "StateBufferConnector_ms": 0.0017695426940917969, "ViewRequirementAgentConnector_ms": 0.04493260383605957}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 120240, "num_agent_steps_trained": 120240, "num_env_steps_sampled": 120240, "num_env_steps_trained": 120240, "num_env_steps_sampled_this_iter": 1800, "num_env_steps_trained_this_iter": 1800, "num_env_steps_sampled_throughput_per_sec": 162.2959449784996, "num_env_steps_trained_throughput_per_sec": 162.2959449784996, "timesteps_total": 120240, "num_steps_trained_this_iter": 1800, "agent_timesteps_total": 120240, "timers": {"training_iteration_time_ms": 2219.373, "sample_time_ms": 2212.42, "load_time_ms": 0.213, "load_throughput": 1692768.43, "learn_time_ms": 6.19, "learn_throughput": 58156.845, "synch_weights_time_ms": 0.518}, "counters": {"num_env_steps_sampled": 120240, "num_env_steps_trained": 120240, "num_agent_steps_sampled": 120240, "num_agent_steps_trained": 120240}, "done": false, "episodes_total": 334, "training_iteration": 67, "trial_id": "f5e97_00000", "date": "2023-07-25_17-08-21", "timestamp": 1690294101, "time_this_iter_s": 11.092880964279175, "time_total_s": 747.1163685321808, "pid": 71917, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[0, 0.003], [5400, 0.001], [10800, 0.00075], [16200, 0.0005], [21600, 0.00025], [27000, 0.0001], [32400, 7.5e-05], [37800, 5e-05], [43200, 2.5e-05], [48600, 1e-05], [54000, 7.5e-06], [59400, 5e-06], [64800, 2.5e-06], [70200, 1e-06], [75600, 5e-07], [81000, 1e-07]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x304530310>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 747.1163685321808, "iterations_since_restore": 67, "perf": {"cpu_util_percent": 25.19375, "ram_util_percent": 79.90625}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-07, "entropy_coeff": 0.1, "policy_entropy": -926.700048828125, "policy_loss": -10486178152448.0, "vf_loss": 1062761075.2}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 1693.0, "diff_num_grad_updates_vs_sampler_policy": 1692.0}}, "num_env_steps_sampled": 122040, "num_env_steps_trained": 122040, "num_agent_steps_sampled": 122040, "num_agent_steps_trained": 122040}, "sampler_results": {"episode_reward_max": -25363.73074076344, "episode_reward_min": -26184.635395319758, "episode_reward_mean": -25748.105948310484, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-26031.456607431224, -25792.880448707605, -25841.402077860756, -25972.625161817006, -25843.01368514434, -25908.119496861847, -25692.733137276053, -25525.769012512654, -25823.480394710994, -25907.283641629238, -25515.59897538544, -25868.589035265955, -25577.18772125025, -25877.66864154889, -25596.9536006921, -25788.25850036741, -25427.471536829886, -26112.41235184759, -25471.38449448666, -25411.487289326662, -25860.155843439974, -25803.86093513066, -25562.412268598353, -25803.546394953195, -25484.054687925844, -26073.427377665303, -26012.300427767903, -25876.122433853667, -25756.47538442769, -25646.33086290482, -25487.666593624537, -25390.160806222, -25606.10411112896, -25560.898605591057, -25713.51321003798, -25802.15825834444, -25559.61234837715, -25889.63188350402, -25739.953136814795, -25905.76233675474, -25818.73858470875, -25626.132600040637, -25647.313681746455, -25892.368079272357, -25638.759148403686, -25715.057738798045, -25844.66944533116, -25870.25614207713, -25920.880645498226, -25668.043754945003, -25738.768563863236, -25892.207337860433, -25581.518823479943, -25814.845674665205, -25556.672685873964, -25752.225778040585, -25770.54105836333, -25899.106776175176, -25840.86293602915, -25591.75138542168, -25510.290830657505, -25511.778369728654, -25812.90503700192, -25931.909280124957, -25860.461617755886, -25897.511315067466, -25792.746336386426, -25964.12300908346, -25634.24535731137, -25671.789190964275, -25518.673086091916, -25813.547403917546, -25526.71753209267, -25735.383906722796, -25801.119732630206, -25828.88528263503, -25831.823059561135, -25677.197986224346, -25687.04960455717, -26006.55309726376, -25695.4367463259, -25864.959502008885, -25787.11193002619, -25638.423404895515, -25581.237169707812, -25573.249009628562, -25905.690998452712, -26024.856504878888, -25706.668344990532, -25842.854540782766, -25728.393436948525, -25760.387993940018, -26184.635395319758, -25797.144567018688, -25948.060681634084, -25835.186169563676, -25866.614190566837, -25611.345078587674, -25479.25283061606, -25363.73074076344], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.4053519029492945, "mean_inference_ms": 0.24669291880607636, "mean_action_processing_ms": 0.05867444647555731, "mean_env_wait_ms": 1.4634006447833878, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0024340152740478516, "StateBufferConnector_ms": 0.0017631053924560547, "ViewRequirementAgentConnector_ms": 0.04496002197265625}}, "episode_reward_max": -25363.73074076344, "episode_reward_min": -26184.635395319758, "episode_reward_mean": -25748.105948310484, "episode_len_mean": 360.0, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-26031.456607431224, -25792.880448707605, -25841.402077860756, -25972.625161817006, -25843.01368514434, -25908.119496861847, -25692.733137276053, -25525.769012512654, -25823.480394710994, -25907.283641629238, -25515.59897538544, -25868.589035265955, -25577.18772125025, -25877.66864154889, -25596.9536006921, -25788.25850036741, -25427.471536829886, -26112.41235184759, -25471.38449448666, -25411.487289326662, -25860.155843439974, -25803.86093513066, -25562.412268598353, -25803.546394953195, -25484.054687925844, -26073.427377665303, -26012.300427767903, -25876.122433853667, -25756.47538442769, -25646.33086290482, -25487.666593624537, -25390.160806222, -25606.10411112896, -25560.898605591057, -25713.51321003798, -25802.15825834444, -25559.61234837715, -25889.63188350402, -25739.953136814795, -25905.76233675474, -25818.73858470875, -25626.132600040637, -25647.313681746455, -25892.368079272357, -25638.759148403686, -25715.057738798045, -25844.66944533116, -25870.25614207713, -25920.880645498226, -25668.043754945003, -25738.768563863236, -25892.207337860433, -25581.518823479943, -25814.845674665205, -25556.672685873964, -25752.225778040585, -25770.54105836333, -25899.106776175176, -25840.86293602915, -25591.75138542168, -25510.290830657505, -25511.778369728654, -25812.90503700192, -25931.909280124957, -25860.461617755886, -25897.511315067466, -25792.746336386426, -25964.12300908346, -25634.24535731137, -25671.789190964275, -25518.673086091916, -25813.547403917546, -25526.71753209267, -25735.383906722796, -25801.119732630206, -25828.88528263503, -25831.823059561135, -25677.197986224346, -25687.04960455717, -26006.55309726376, -25695.4367463259, -25864.959502008885, -25787.11193002619, -25638.423404895515, -25581.237169707812, -25573.249009628562, -25905.690998452712, -26024.856504878888, -25706.668344990532, -25842.854540782766, -25728.393436948525, -25760.387993940018, -26184.635395319758, -25797.144567018688, -25948.060681634084, -25835.186169563676, -25866.614190566837, -25611.345078587674, -25479.25283061606, -25363.73074076344], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.4053519029492945, "mean_inference_ms": 0.24669291880607636, "mean_action_processing_ms": 0.05867444647555731, "mean_env_wait_ms": 1.4634006447833878, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0024340152740478516, "StateBufferConnector_ms": 0.0017631053924560547, "ViewRequirementAgentConnector_ms": 0.04496002197265625}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 122040, "num_agent_steps_trained": 122040, "num_env_steps_sampled": 122040, "num_env_steps_trained": 122040, "num_env_steps_sampled_this_iter": 1800, "num_env_steps_trained_this_iter": 1800, "num_env_steps_sampled_throughput_per_sec": 161.93314931248926, "num_env_steps_trained_throughput_per_sec": 161.93314931248926, "timesteps_total": 122040, "num_steps_trained_this_iter": 1800, "agent_timesteps_total": 122040, "timers": {"training_iteration_time_ms": 2220.645, "sample_time_ms": 2213.647, "load_time_ms": 0.214, "load_throughput": 1679214.235, "learn_time_ms": 6.239, "learn_throughput": 57698.826, "synch_weights_time_ms": 0.513}, "counters": {"num_env_steps_sampled": 122040, "num_env_steps_trained": 122040, "num_agent_steps_sampled": 122040, "num_agent_steps_trained": 122040}, "done": false, "episodes_total": 339, "training_iteration": 68, "trial_id": "f5e97_00000", "date": "2023-07-25_17-08-32", "timestamp": 1690294112, "time_this_iter_s": 11.117645025253296, "time_total_s": 758.2340135574341, "pid": 71917, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[0, 0.003], [5400, 0.001], [10800, 0.00075], [16200, 0.0005], [21600, 0.00025], [27000, 0.0001], [32400, 7.5e-05], [37800, 5e-05], [43200, 2.5e-05], [48600, 1e-05], [54000, 7.5e-06], [59400, 5e-06], [64800, 2.5e-06], [70200, 1e-06], [75600, 5e-07], [81000, 1e-07]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x304530310>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 758.2340135574341, "iterations_since_restore": 68, "perf": {"cpu_util_percent": 24.4, "ram_util_percent": 78.94000000000001}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-07, "entropy_coeff": 0.1, "policy_entropy": -926.6996704101563, "policy_loss": -23043859330662.4, "vf_loss": 1109291584.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 1718.0, "diff_num_grad_updates_vs_sampler_policy": 1717.0}}, "num_env_steps_sampled": 123840, "num_env_steps_trained": 123840, "num_agent_steps_sampled": 123840, "num_agent_steps_trained": 123840}, "sampler_results": {"episode_reward_max": -25363.73074076344, "episode_reward_min": -26184.635395319758, "episode_reward_mean": -25742.32224642585, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-25908.119496861847, -25692.733137276053, -25525.769012512654, -25823.480394710994, -25907.283641629238, -25515.59897538544, -25868.589035265955, -25577.18772125025, -25877.66864154889, -25596.9536006921, -25788.25850036741, -25427.471536829886, -26112.41235184759, -25471.38449448666, -25411.487289326662, -25860.155843439974, -25803.86093513066, -25562.412268598353, -25803.546394953195, -25484.054687925844, -26073.427377665303, -26012.300427767903, -25876.122433853667, -25756.47538442769, -25646.33086290482, -25487.666593624537, -25390.160806222, -25606.10411112896, -25560.898605591057, -25713.51321003798, -25802.15825834444, -25559.61234837715, -25889.63188350402, -25739.953136814795, -25905.76233675474, -25818.73858470875, -25626.132600040637, -25647.313681746455, -25892.368079272357, -25638.759148403686, -25715.057738798045, -25844.66944533116, -25870.25614207713, -25920.880645498226, -25668.043754945003, -25738.768563863236, -25892.207337860433, -25581.518823479943, -25814.845674665205, -25556.672685873964, -25752.225778040585, -25770.54105836333, -25899.106776175176, -25840.86293602915, -25591.75138542168, -25510.290830657505, -25511.778369728654, -25812.90503700192, -25931.909280124957, -25860.461617755886, -25897.511315067466, -25792.746336386426, -25964.12300908346, -25634.24535731137, -25671.789190964275, -25518.673086091916, -25813.547403917546, -25526.71753209267, -25735.383906722796, -25801.119732630206, -25828.88528263503, -25831.823059561135, -25677.197986224346, -25687.04960455717, -26006.55309726376, -25695.4367463259, -25864.959502008885, -25787.11193002619, -25638.423404895515, -25581.237169707812, -25573.249009628562, -25905.690998452712, -26024.856504878888, -25706.668344990532, -25842.854540782766, -25728.393436948525, -25760.387993940018, -26184.635395319758, -25797.144567018688, -25948.060681634084, -25835.186169563676, -25866.614190566837, -25611.345078587674, -25479.25283061606, -25363.73074076344, -25887.061436977747, -25629.454968292463, -25640.349731648043, -25825.84153766307, -25920.300117916227], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.4053060163739035, "mean_inference_ms": 0.2467106145502102, "mean_action_processing_ms": 0.058678916446651325, "mean_env_wait_ms": 1.4632080071163995, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0024421215057373047, "StateBufferConnector_ms": 0.001771688461303711, "ViewRequirementAgentConnector_ms": 0.044973134994506836}}, "episode_reward_max": -25363.73074076344, "episode_reward_min": -26184.635395319758, "episode_reward_mean": -25742.32224642585, "episode_len_mean": 360.0, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-25908.119496861847, -25692.733137276053, -25525.769012512654, -25823.480394710994, -25907.283641629238, -25515.59897538544, -25868.589035265955, -25577.18772125025, -25877.66864154889, -25596.9536006921, -25788.25850036741, -25427.471536829886, -26112.41235184759, -25471.38449448666, -25411.487289326662, -25860.155843439974, -25803.86093513066, -25562.412268598353, -25803.546394953195, -25484.054687925844, -26073.427377665303, -26012.300427767903, -25876.122433853667, -25756.47538442769, -25646.33086290482, -25487.666593624537, -25390.160806222, -25606.10411112896, -25560.898605591057, -25713.51321003798, -25802.15825834444, -25559.61234837715, -25889.63188350402, -25739.953136814795, -25905.76233675474, -25818.73858470875, -25626.132600040637, -25647.313681746455, -25892.368079272357, -25638.759148403686, -25715.057738798045, -25844.66944533116, -25870.25614207713, -25920.880645498226, -25668.043754945003, -25738.768563863236, -25892.207337860433, -25581.518823479943, -25814.845674665205, -25556.672685873964, -25752.225778040585, -25770.54105836333, -25899.106776175176, -25840.86293602915, -25591.75138542168, -25510.290830657505, -25511.778369728654, -25812.90503700192, -25931.909280124957, -25860.461617755886, -25897.511315067466, -25792.746336386426, -25964.12300908346, -25634.24535731137, -25671.789190964275, -25518.673086091916, -25813.547403917546, -25526.71753209267, -25735.383906722796, -25801.119732630206, -25828.88528263503, -25831.823059561135, -25677.197986224346, -25687.04960455717, -26006.55309726376, -25695.4367463259, -25864.959502008885, -25787.11193002619, -25638.423404895515, -25581.237169707812, -25573.249009628562, -25905.690998452712, -26024.856504878888, -25706.668344990532, -25842.854540782766, -25728.393436948525, -25760.387993940018, -26184.635395319758, -25797.144567018688, -25948.060681634084, -25835.186169563676, -25866.614190566837, -25611.345078587674, -25479.25283061606, -25363.73074076344, -25887.061436977747, -25629.454968292463, -25640.349731648043, -25825.84153766307, -25920.300117916227], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.4053060163739035, "mean_inference_ms": 0.2467106145502102, "mean_action_processing_ms": 0.058678916446651325, "mean_env_wait_ms": 1.4632080071163995, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0024421215057373047, "StateBufferConnector_ms": 0.001771688461303711, "ViewRequirementAgentConnector_ms": 0.044973134994506836}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 123840, "num_agent_steps_trained": 123840, "num_env_steps_sampled": 123840, "num_env_steps_trained": 123840, "num_env_steps_sampled_this_iter": 1800, "num_env_steps_trained_this_iter": 1800, "num_env_steps_sampled_throughput_per_sec": 162.42985995387914, "num_env_steps_trained_throughput_per_sec": 162.42985995387914, "timesteps_total": 123840, "num_steps_trained_this_iter": 1800, "agent_timesteps_total": 123840, "timers": {"training_iteration_time_ms": 2219.731, "sample_time_ms": 2212.654, "load_time_ms": 0.218, "load_throughput": 1648236.481, "learn_time_ms": 6.299, "learn_throughput": 57155.219, "synch_weights_time_ms": 0.526}, "counters": {"num_env_steps_sampled": 123840, "num_env_steps_trained": 123840, "num_agent_steps_sampled": 123840, "num_agent_steps_trained": 123840}, "done": false, "episodes_total": 344, "training_iteration": 69, "trial_id": "f5e97_00000", "date": "2023-07-25_17-08-43", "timestamp": 1690294123, "time_this_iter_s": 11.084099292755127, "time_total_s": 769.3181128501892, "pid": 71917, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[0, 0.003], [5400, 0.001], [10800, 0.00075], [16200, 0.0005], [21600, 0.00025], [27000, 0.0001], [32400, 7.5e-05], [37800, 5e-05], [43200, 2.5e-05], [48600, 1e-05], [54000, 7.5e-06], [59400, 5e-06], [64800, 2.5e-06], [70200, 1e-06], [75600, 5e-07], [81000, 1e-07]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x304530310>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 769.3181128501892, "iterations_since_restore": 69, "perf": {"cpu_util_percent": 25.68125, "ram_util_percent": 78.94375}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-07, "entropy_coeff": 0.1, "policy_entropy": -926.699755859375, "policy_loss": -29400323666739.2, "vf_loss": 1092372544.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 1743.0, "diff_num_grad_updates_vs_sampler_policy": 1742.0}}, "num_env_steps_sampled": 125640, "num_env_steps_trained": 125640, "num_agent_steps_sampled": 125640, "num_agent_steps_trained": 125640}, "sampler_results": {"episode_reward_max": -25363.73074076344, "episode_reward_min": -26184.635395319758, "episode_reward_mean": -25742.42611159802, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-25515.59897538544, -25868.589035265955, -25577.18772125025, -25877.66864154889, -25596.9536006921, -25788.25850036741, -25427.471536829886, -26112.41235184759, -25471.38449448666, -25411.487289326662, -25860.155843439974, -25803.86093513066, -25562.412268598353, -25803.546394953195, -25484.054687925844, -26073.427377665303, -26012.300427767903, -25876.122433853667, -25756.47538442769, -25646.33086290482, -25487.666593624537, -25390.160806222, -25606.10411112896, -25560.898605591057, -25713.51321003798, -25802.15825834444, -25559.61234837715, -25889.63188350402, -25739.953136814795, -25905.76233675474, -25818.73858470875, -25626.132600040637, -25647.313681746455, -25892.368079272357, -25638.759148403686, -25715.057738798045, -25844.66944533116, -25870.25614207713, -25920.880645498226, -25668.043754945003, -25738.768563863236, -25892.207337860433, -25581.518823479943, -25814.845674665205, -25556.672685873964, -25752.225778040585, -25770.54105836333, -25899.106776175176, -25840.86293602915, -25591.75138542168, -25510.290830657505, -25511.778369728654, -25812.90503700192, -25931.909280124957, -25860.461617755886, -25897.511315067466, -25792.746336386426, -25964.12300908346, -25634.24535731137, -25671.789190964275, -25518.673086091916, -25813.547403917546, -25526.71753209267, -25735.383906722796, -25801.119732630206, -25828.88528263503, -25831.823059561135, -25677.197986224346, -25687.04960455717, -26006.55309726376, -25695.4367463259, -25864.959502008885, -25787.11193002619, -25638.423404895515, -25581.237169707812, -25573.249009628562, -25905.690998452712, -26024.856504878888, -25706.668344990532, -25842.854540782766, -25728.393436948525, -25760.387993940018, -26184.635395319758, -25797.144567018688, -25948.060681634084, -25835.186169563676, -25866.614190566837, -25611.345078587674, -25479.25283061606, -25363.73074076344, -25887.061436977747, -25629.454968292463, -25640.349731648043, -25825.84153766307, -25920.300117916227, -25715.827265320084, -25781.78025677285, -25730.27264555775, -25943.576108077425, -25696.315924479346], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.4052672789863445, "mean_inference_ms": 0.2467306094809384, "mean_action_processing_ms": 0.058683560765251955, "mean_env_wait_ms": 1.46300851926846, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0024611949920654297, "StateBufferConnector_ms": 0.0017712116241455078, "ViewRequirementAgentConnector_ms": 0.04499030113220215}}, "episode_reward_max": -25363.73074076344, "episode_reward_min": -26184.635395319758, "episode_reward_mean": -25742.42611159802, "episode_len_mean": 360.0, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-25515.59897538544, -25868.589035265955, -25577.18772125025, -25877.66864154889, -25596.9536006921, -25788.25850036741, -25427.471536829886, -26112.41235184759, -25471.38449448666, -25411.487289326662, -25860.155843439974, -25803.86093513066, -25562.412268598353, -25803.546394953195, -25484.054687925844, -26073.427377665303, -26012.300427767903, -25876.122433853667, -25756.47538442769, -25646.33086290482, -25487.666593624537, -25390.160806222, -25606.10411112896, -25560.898605591057, -25713.51321003798, -25802.15825834444, -25559.61234837715, -25889.63188350402, -25739.953136814795, -25905.76233675474, -25818.73858470875, -25626.132600040637, -25647.313681746455, -25892.368079272357, -25638.759148403686, -25715.057738798045, -25844.66944533116, -25870.25614207713, -25920.880645498226, -25668.043754945003, -25738.768563863236, -25892.207337860433, -25581.518823479943, -25814.845674665205, -25556.672685873964, -25752.225778040585, -25770.54105836333, -25899.106776175176, -25840.86293602915, -25591.75138542168, -25510.290830657505, -25511.778369728654, -25812.90503700192, -25931.909280124957, -25860.461617755886, -25897.511315067466, -25792.746336386426, -25964.12300908346, -25634.24535731137, -25671.789190964275, -25518.673086091916, -25813.547403917546, -25526.71753209267, -25735.383906722796, -25801.119732630206, -25828.88528263503, -25831.823059561135, -25677.197986224346, -25687.04960455717, -26006.55309726376, -25695.4367463259, -25864.959502008885, -25787.11193002619, -25638.423404895515, -25581.237169707812, -25573.249009628562, -25905.690998452712, -26024.856504878888, -25706.668344990532, -25842.854540782766, -25728.393436948525, -25760.387993940018, -26184.635395319758, -25797.144567018688, -25948.060681634084, -25835.186169563676, -25866.614190566837, -25611.345078587674, -25479.25283061606, -25363.73074076344, -25887.061436977747, -25629.454968292463, -25640.349731648043, -25825.84153766307, -25920.300117916227, -25715.827265320084, -25781.78025677285, -25730.27264555775, -25943.576108077425, -25696.315924479346], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.4052672789863445, "mean_inference_ms": 0.2467306094809384, "mean_action_processing_ms": 0.058683560765251955, "mean_env_wait_ms": 1.46300851926846, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0024611949920654297, "StateBufferConnector_ms": 0.0017712116241455078, "ViewRequirementAgentConnector_ms": 0.04499030113220215}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 125640, "num_agent_steps_trained": 125640, "num_env_steps_sampled": 125640, "num_env_steps_trained": 125640, "num_env_steps_sampled_this_iter": 1800, "num_env_steps_trained_this_iter": 1800, "num_env_steps_sampled_throughput_per_sec": 161.7923472057451, "num_env_steps_trained_throughput_per_sec": 161.7923472057451, "timesteps_total": 125640, "num_steps_trained_this_iter": 1800, "agent_timesteps_total": 125640, "timers": {"training_iteration_time_ms": 2220.698, "sample_time_ms": 2213.567, "load_time_ms": 0.217, "load_throughput": 1661293.256, "learn_time_ms": 6.351, "learn_throughput": 56681.699, "synch_weights_time_ms": 0.531}, "counters": {"num_env_steps_sampled": 125640, "num_env_steps_trained": 125640, "num_agent_steps_sampled": 125640, "num_agent_steps_trained": 125640}, "done": false, "episodes_total": 349, "training_iteration": 70, "trial_id": "f5e97_00000", "date": "2023-07-25_17-08-54", "timestamp": 1690294134, "time_this_iter_s": 11.127524852752686, "time_total_s": 780.4456377029419, "pid": 71917, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[0, 0.003], [5400, 0.001], [10800, 0.00075], [16200, 0.0005], [21600, 0.00025], [27000, 0.0001], [32400, 7.5e-05], [37800, 5e-05], [43200, 2.5e-05], [48600, 1e-05], [54000, 7.5e-06], [59400, 5e-06], [64800, 2.5e-06], [70200, 1e-06], [75600, 5e-07], [81000, 1e-07]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x304530310>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 780.4456377029419, "iterations_since_restore": 70, "perf": {"cpu_util_percent": 25.10625, "ram_util_percent": 79.35625}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-07, "entropy_coeff": 0.1, "policy_entropy": -926.6996459960938, "policy_loss": -36702556979200.0, "vf_loss": 1104619123.2}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 1768.0, "diff_num_grad_updates_vs_sampler_policy": 1767.0}}, "num_env_steps_sampled": 127440, "num_env_steps_trained": 127440, "num_agent_steps_sampled": 127440, "num_agent_steps_trained": 127440}, "sampler_results": {"episode_reward_max": -25363.73074076344, "episode_reward_min": -26184.635395319758, "episode_reward_mean": -25749.555259127006, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-25788.25850036741, -25427.471536829886, -26112.41235184759, -25471.38449448666, -25411.487289326662, -25860.155843439974, -25803.86093513066, -25562.412268598353, -25803.546394953195, -25484.054687925844, -26073.427377665303, -26012.300427767903, -25876.122433853667, -25756.47538442769, -25646.33086290482, -25487.666593624537, -25390.160806222, -25606.10411112896, -25560.898605591057, -25713.51321003798, -25802.15825834444, -25559.61234837715, -25889.63188350402, -25739.953136814795, -25905.76233675474, -25818.73858470875, -25626.132600040637, -25647.313681746455, -25892.368079272357, -25638.759148403686, -25715.057738798045, -25844.66944533116, -25870.25614207713, -25920.880645498226, -25668.043754945003, -25738.768563863236, -25892.207337860433, -25581.518823479943, -25814.845674665205, -25556.672685873964, -25752.225778040585, -25770.54105836333, -25899.106776175176, -25840.86293602915, -25591.75138542168, -25510.290830657505, -25511.778369728654, -25812.90503700192, -25931.909280124957, -25860.461617755886, -25897.511315067466, -25792.746336386426, -25964.12300908346, -25634.24535731137, -25671.789190964275, -25518.673086091916, -25813.547403917546, -25526.71753209267, -25735.383906722796, -25801.119732630206, -25828.88528263503, -25831.823059561135, -25677.197986224346, -25687.04960455717, -26006.55309726376, -25695.4367463259, -25864.959502008885, -25787.11193002619, -25638.423404895515, -25581.237169707812, -25573.249009628562, -25905.690998452712, -26024.856504878888, -25706.668344990532, -25842.854540782766, -25728.393436948525, -25760.387993940018, -26184.635395319758, -25797.144567018688, -25948.060681634084, -25835.186169563676, -25866.614190566837, -25611.345078587674, -25479.25283061606, -25363.73074076344, -25887.061436977747, -25629.454968292463, -25640.349731648043, -25825.84153766307, -25920.300117916227, -25715.827265320084, -25781.78025677285, -25730.27264555775, -25943.576108077425, -25696.315924479346, -26015.101783501606, -25772.965387701348, -25639.14263189877, -25945.23576689735, -25776.46715704166], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.40528687372626, "mean_inference_ms": 0.24676232184211613, "mean_action_processing_ms": 0.058690300711494864, "mean_env_wait_ms": 1.462832587849806, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0024628639221191406, "StateBufferConnector_ms": 0.0017712116241455078, "ViewRequirementAgentConnector_ms": 0.04509854316711426}}, "episode_reward_max": -25363.73074076344, "episode_reward_min": -26184.635395319758, "episode_reward_mean": -25749.555259127006, "episode_len_mean": 360.0, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-25788.25850036741, -25427.471536829886, -26112.41235184759, -25471.38449448666, -25411.487289326662, -25860.155843439974, -25803.86093513066, -25562.412268598353, -25803.546394953195, -25484.054687925844, -26073.427377665303, -26012.300427767903, -25876.122433853667, -25756.47538442769, -25646.33086290482, -25487.666593624537, -25390.160806222, -25606.10411112896, -25560.898605591057, -25713.51321003798, -25802.15825834444, -25559.61234837715, -25889.63188350402, -25739.953136814795, -25905.76233675474, -25818.73858470875, -25626.132600040637, -25647.313681746455, -25892.368079272357, -25638.759148403686, -25715.057738798045, -25844.66944533116, -25870.25614207713, -25920.880645498226, -25668.043754945003, -25738.768563863236, -25892.207337860433, -25581.518823479943, -25814.845674665205, -25556.672685873964, -25752.225778040585, -25770.54105836333, -25899.106776175176, -25840.86293602915, -25591.75138542168, -25510.290830657505, -25511.778369728654, -25812.90503700192, -25931.909280124957, -25860.461617755886, -25897.511315067466, -25792.746336386426, -25964.12300908346, -25634.24535731137, -25671.789190964275, -25518.673086091916, -25813.547403917546, -25526.71753209267, -25735.383906722796, -25801.119732630206, -25828.88528263503, -25831.823059561135, -25677.197986224346, -25687.04960455717, -26006.55309726376, -25695.4367463259, -25864.959502008885, -25787.11193002619, -25638.423404895515, -25581.237169707812, -25573.249009628562, -25905.690998452712, -26024.856504878888, -25706.668344990532, -25842.854540782766, -25728.393436948525, -25760.387993940018, -26184.635395319758, -25797.144567018688, -25948.060681634084, -25835.186169563676, -25866.614190566837, -25611.345078587674, -25479.25283061606, -25363.73074076344, -25887.061436977747, -25629.454968292463, -25640.349731648043, -25825.84153766307, -25920.300117916227, -25715.827265320084, -25781.78025677285, -25730.27264555775, -25943.576108077425, -25696.315924479346, -26015.101783501606, -25772.965387701348, -25639.14263189877, -25945.23576689735, -25776.46715704166], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.40528687372626, "mean_inference_ms": 0.24676232184211613, "mean_action_processing_ms": 0.058690300711494864, "mean_env_wait_ms": 1.462832587849806, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0024628639221191406, "StateBufferConnector_ms": 0.0017712116241455078, "ViewRequirementAgentConnector_ms": 0.04509854316711426}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 127440, "num_agent_steps_trained": 127440, "num_env_steps_sampled": 127440, "num_env_steps_trained": 127440, "num_env_steps_sampled_this_iter": 1800, "num_env_steps_trained_this_iter": 1800, "num_env_steps_sampled_throughput_per_sec": 159.5800709565368, "num_env_steps_trained_throughput_per_sec": 159.5800709565368, "timesteps_total": 127440, "num_steps_trained_this_iter": 1800, "agent_timesteps_total": 127440, "timers": {"training_iteration_time_ms": 2240.488, "sample_time_ms": 2233.404, "load_time_ms": 0.217, "load_throughput": 1662573.706, "learn_time_ms": 6.317, "learn_throughput": 56984.815, "synch_weights_time_ms": 0.519}, "counters": {"num_env_steps_sampled": 127440, "num_env_steps_trained": 127440, "num_agent_steps_sampled": 127440, "num_agent_steps_trained": 127440}, "done": false, "episodes_total": 354, "training_iteration": 71, "trial_id": "f5e97_00000", "date": "2023-07-25_17-09-06", "timestamp": 1690294146, "time_this_iter_s": 11.28174376487732, "time_total_s": 791.7273814678192, "pid": 71917, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[0, 0.003], [5400, 0.001], [10800, 0.00075], [16200, 0.0005], [21600, 0.00025], [27000, 0.0001], [32400, 7.5e-05], [37800, 5e-05], [43200, 2.5e-05], [48600, 1e-05], [54000, 7.5e-06], [59400, 5e-06], [64800, 2.5e-06], [70200, 1e-06], [75600, 5e-07], [81000, 1e-07]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x304530310>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 791.7273814678192, "iterations_since_restore": 71, "perf": {"cpu_util_percent": 30.81875, "ram_util_percent": 79.725}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-07, "entropy_coeff": 0.1, "policy_entropy": -926.6996826171875, "policy_loss": -26673542027673.6, "vf_loss": 1107035008.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 1793.0, "diff_num_grad_updates_vs_sampler_policy": 1792.0}}, "num_env_steps_sampled": 129240, "num_env_steps_trained": 129240, "num_agent_steps_sampled": 129240, "num_agent_steps_trained": 129240}, "sampler_results": {"episode_reward_max": -25363.73074076344, "episode_reward_min": -26184.635395319758, "episode_reward_mean": -25752.27898484703, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-25860.155843439974, -25803.86093513066, -25562.412268598353, -25803.546394953195, -25484.054687925844, -26073.427377665303, -26012.300427767903, -25876.122433853667, -25756.47538442769, -25646.33086290482, -25487.666593624537, -25390.160806222, -25606.10411112896, -25560.898605591057, -25713.51321003798, -25802.15825834444, -25559.61234837715, -25889.63188350402, -25739.953136814795, -25905.76233675474, -25818.73858470875, -25626.132600040637, -25647.313681746455, -25892.368079272357, -25638.759148403686, -25715.057738798045, -25844.66944533116, -25870.25614207713, -25920.880645498226, -25668.043754945003, -25738.768563863236, -25892.207337860433, -25581.518823479943, -25814.845674665205, -25556.672685873964, -25752.225778040585, -25770.54105836333, -25899.106776175176, -25840.86293602915, -25591.75138542168, -25510.290830657505, -25511.778369728654, -25812.90503700192, -25931.909280124957, -25860.461617755886, -25897.511315067466, -25792.746336386426, -25964.12300908346, -25634.24535731137, -25671.789190964275, -25518.673086091916, -25813.547403917546, -25526.71753209267, -25735.383906722796, -25801.119732630206, -25828.88528263503, -25831.823059561135, -25677.197986224346, -25687.04960455717, -26006.55309726376, -25695.4367463259, -25864.959502008885, -25787.11193002619, -25638.423404895515, -25581.237169707812, -25573.249009628562, -25905.690998452712, -26024.856504878888, -25706.668344990532, -25842.854540782766, -25728.393436948525, -25760.387993940018, -26184.635395319758, -25797.144567018688, -25948.060681634084, -25835.186169563676, -25866.614190566837, -25611.345078587674, -25479.25283061606, -25363.73074076344, -25887.061436977747, -25629.454968292463, -25640.349731648043, -25825.84153766307, -25920.300117916227, -25715.827265320084, -25781.78025677285, -25730.27264555775, -25943.576108077425, -25696.315924479346, -26015.101783501606, -25772.965387701348, -25639.14263189877, -25945.23576689735, -25776.46715704166, -25629.17291252169, -25824.38469927601, -25474.585936104304, -25738.491769587905, -25816.75142737078], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.405356184844882, "mean_inference_ms": 0.24679880812025645, "mean_action_processing_ms": 0.05869763126861905, "mean_env_wait_ms": 1.4626539827378604, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0024650096893310547, "StateBufferConnector_ms": 0.001768350601196289, "ViewRequirementAgentConnector_ms": 0.04508042335510254}}, "episode_reward_max": -25363.73074076344, "episode_reward_min": -26184.635395319758, "episode_reward_mean": -25752.27898484703, "episode_len_mean": 360.0, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-25860.155843439974, -25803.86093513066, -25562.412268598353, -25803.546394953195, -25484.054687925844, -26073.427377665303, -26012.300427767903, -25876.122433853667, -25756.47538442769, -25646.33086290482, -25487.666593624537, -25390.160806222, -25606.10411112896, -25560.898605591057, -25713.51321003798, -25802.15825834444, -25559.61234837715, -25889.63188350402, -25739.953136814795, -25905.76233675474, -25818.73858470875, -25626.132600040637, -25647.313681746455, -25892.368079272357, -25638.759148403686, -25715.057738798045, -25844.66944533116, -25870.25614207713, -25920.880645498226, -25668.043754945003, -25738.768563863236, -25892.207337860433, -25581.518823479943, -25814.845674665205, -25556.672685873964, -25752.225778040585, -25770.54105836333, -25899.106776175176, -25840.86293602915, -25591.75138542168, -25510.290830657505, -25511.778369728654, -25812.90503700192, -25931.909280124957, -25860.461617755886, -25897.511315067466, -25792.746336386426, -25964.12300908346, -25634.24535731137, -25671.789190964275, -25518.673086091916, -25813.547403917546, -25526.71753209267, -25735.383906722796, -25801.119732630206, -25828.88528263503, -25831.823059561135, -25677.197986224346, -25687.04960455717, -26006.55309726376, -25695.4367463259, -25864.959502008885, -25787.11193002619, -25638.423404895515, -25581.237169707812, -25573.249009628562, -25905.690998452712, -26024.856504878888, -25706.668344990532, -25842.854540782766, -25728.393436948525, -25760.387993940018, -26184.635395319758, -25797.144567018688, -25948.060681634084, -25835.186169563676, -25866.614190566837, -25611.345078587674, -25479.25283061606, -25363.73074076344, -25887.061436977747, -25629.454968292463, -25640.349731648043, -25825.84153766307, -25920.300117916227, -25715.827265320084, -25781.78025677285, -25730.27264555775, -25943.576108077425, -25696.315924479346, -26015.101783501606, -25772.965387701348, -25639.14263189877, -25945.23576689735, -25776.46715704166, -25629.17291252169, -25824.38469927601, -25474.585936104304, -25738.491769587905, -25816.75142737078], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.405356184844882, "mean_inference_ms": 0.24679880812025645, "mean_action_processing_ms": 0.05869763126861905, "mean_env_wait_ms": 1.4626539827378604, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0024650096893310547, "StateBufferConnector_ms": 0.001768350601196289, "ViewRequirementAgentConnector_ms": 0.04508042335510254}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 129240, "num_agent_steps_trained": 129240, "num_env_steps_sampled": 129240, "num_env_steps_trained": 129240, "num_env_steps_sampled_this_iter": 1800, "num_env_steps_trained_this_iter": 1800, "num_env_steps_sampled_throughput_per_sec": 160.23940866409748, "num_env_steps_trained_throughput_per_sec": 160.23940866409748, "timesteps_total": 129240, "num_steps_trained_this_iter": 1800, "agent_timesteps_total": 129240, "timers": {"training_iteration_time_ms": 2251.266, "sample_time_ms": 2243.546, "load_time_ms": 0.226, "load_throughput": 1596309.8, "learn_time_ms": 6.819, "learn_throughput": 52790.82, "synch_weights_time_ms": 0.64}, "counters": {"num_env_steps_sampled": 129240, "num_env_steps_trained": 129240, "num_agent_steps_sampled": 129240, "num_agent_steps_trained": 129240}, "done": false, "episodes_total": 359, "training_iteration": 72, "trial_id": "f5e97_00000", "date": "2023-07-25_17-09-17", "timestamp": 1690294157, "time_this_iter_s": 11.23523211479187, "time_total_s": 802.9626135826111, "pid": 71917, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[0, 0.003], [5400, 0.001], [10800, 0.00075], [16200, 0.0005], [21600, 0.00025], [27000, 0.0001], [32400, 7.5e-05], [37800, 5e-05], [43200, 2.5e-05], [48600, 1e-05], [54000, 7.5e-06], [59400, 5e-06], [64800, 2.5e-06], [70200, 1e-06], [75600, 5e-07], [81000, 1e-07]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x304530310>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 802.9626135826111, "iterations_since_restore": 72, "perf": {"cpu_util_percent": 30.8, "ram_util_percent": 80.275}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-07, "entropy_coeff": 0.1, "policy_entropy": -926.699560546875, "policy_loss": -9865868204441.6, "vf_loss": 1124870707.2}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 1818.0, "diff_num_grad_updates_vs_sampler_policy": 1817.0}}, "num_env_steps_sampled": 131040, "num_env_steps_trained": 131040, "num_agent_steps_sampled": 131040, "num_agent_steps_trained": 131040}, "sampler_results": {"episode_reward_max": -25363.73074076344, "episode_reward_min": -26184.635395319758, "episode_reward_mean": -25756.481640000242, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-26073.427377665303, -26012.300427767903, -25876.122433853667, -25756.47538442769, -25646.33086290482, -25487.666593624537, -25390.160806222, -25606.10411112896, -25560.898605591057, -25713.51321003798, -25802.15825834444, -25559.61234837715, -25889.63188350402, -25739.953136814795, -25905.76233675474, -25818.73858470875, -25626.132600040637, -25647.313681746455, -25892.368079272357, -25638.759148403686, -25715.057738798045, -25844.66944533116, -25870.25614207713, -25920.880645498226, -25668.043754945003, -25738.768563863236, -25892.207337860433, -25581.518823479943, -25814.845674665205, -25556.672685873964, -25752.225778040585, -25770.54105836333, -25899.106776175176, -25840.86293602915, -25591.75138542168, -25510.290830657505, -25511.778369728654, -25812.90503700192, -25931.909280124957, -25860.461617755886, -25897.511315067466, -25792.746336386426, -25964.12300908346, -25634.24535731137, -25671.789190964275, -25518.673086091916, -25813.547403917546, -25526.71753209267, -25735.383906722796, -25801.119732630206, -25828.88528263503, -25831.823059561135, -25677.197986224346, -25687.04960455717, -26006.55309726376, -25695.4367463259, -25864.959502008885, -25787.11193002619, -25638.423404895515, -25581.237169707812, -25573.249009628562, -25905.690998452712, -26024.856504878888, -25706.668344990532, -25842.854540782766, -25728.393436948525, -25760.387993940018, -26184.635395319758, -25797.144567018688, -25948.060681634084, -25835.186169563676, -25866.614190566837, -25611.345078587674, -25479.25283061606, -25363.73074076344, -25887.061436977747, -25629.454968292463, -25640.349731648043, -25825.84153766307, -25920.300117916227, -25715.827265320084, -25781.78025677285, -25730.27264555775, -25943.576108077425, -25696.315924479346, -26015.101783501606, -25772.965387701348, -25639.14263189877, -25945.23576689735, -25776.46715704166, -25629.17291252169, -25824.38469927601, -25474.585936104304, -25738.491769587905, -25816.75142737078, -25633.590016855636, -25663.914401143084, -25809.1681167664, -25814.495198137734, -26013.12791246673], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.405424851407224, "mean_inference_ms": 0.24683477919961505, "mean_action_processing_ms": 0.05870464756735057, "mean_env_wait_ms": 1.462455616811327, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002457141876220703, "StateBufferConnector_ms": 0.0017604827880859375, "ViewRequirementAgentConnector_ms": 0.04505443572998047}}, "episode_reward_max": -25363.73074076344, "episode_reward_min": -26184.635395319758, "episode_reward_mean": -25756.481640000242, "episode_len_mean": 360.0, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-26073.427377665303, -26012.300427767903, -25876.122433853667, -25756.47538442769, -25646.33086290482, -25487.666593624537, -25390.160806222, -25606.10411112896, -25560.898605591057, -25713.51321003798, -25802.15825834444, -25559.61234837715, -25889.63188350402, -25739.953136814795, -25905.76233675474, -25818.73858470875, -25626.132600040637, -25647.313681746455, -25892.368079272357, -25638.759148403686, -25715.057738798045, -25844.66944533116, -25870.25614207713, -25920.880645498226, -25668.043754945003, -25738.768563863236, -25892.207337860433, -25581.518823479943, -25814.845674665205, -25556.672685873964, -25752.225778040585, -25770.54105836333, -25899.106776175176, -25840.86293602915, -25591.75138542168, -25510.290830657505, -25511.778369728654, -25812.90503700192, -25931.909280124957, -25860.461617755886, -25897.511315067466, -25792.746336386426, -25964.12300908346, -25634.24535731137, -25671.789190964275, -25518.673086091916, -25813.547403917546, -25526.71753209267, -25735.383906722796, -25801.119732630206, -25828.88528263503, -25831.823059561135, -25677.197986224346, -25687.04960455717, -26006.55309726376, -25695.4367463259, -25864.959502008885, -25787.11193002619, -25638.423404895515, -25581.237169707812, -25573.249009628562, -25905.690998452712, -26024.856504878888, -25706.668344990532, -25842.854540782766, -25728.393436948525, -25760.387993940018, -26184.635395319758, -25797.144567018688, -25948.060681634084, -25835.186169563676, -25866.614190566837, -25611.345078587674, -25479.25283061606, -25363.73074076344, -25887.061436977747, -25629.454968292463, -25640.349731648043, -25825.84153766307, -25920.300117916227, -25715.827265320084, -25781.78025677285, -25730.27264555775, -25943.576108077425, -25696.315924479346, -26015.101783501606, -25772.965387701348, -25639.14263189877, -25945.23576689735, -25776.46715704166, -25629.17291252169, -25824.38469927601, -25474.585936104304, -25738.491769587905, -25816.75142737078, -25633.590016855636, -25663.914401143084, -25809.1681167664, -25814.495198137734, -26013.12791246673], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.405424851407224, "mean_inference_ms": 0.24683477919961505, "mean_action_processing_ms": 0.05870464756735057, "mean_env_wait_ms": 1.462455616811327, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002457141876220703, "StateBufferConnector_ms": 0.0017604827880859375, "ViewRequirementAgentConnector_ms": 0.04505443572998047}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 131040, "num_agent_steps_trained": 131040, "num_env_steps_sampled": 131040, "num_env_steps_trained": 131040, "num_env_steps_sampled_this_iter": 1800, "num_env_steps_trained_this_iter": 1800, "num_env_steps_sampled_throughput_per_sec": 161.44589541287343, "num_env_steps_trained_throughput_per_sec": 161.44589541287343, "timesteps_total": 131040, "num_steps_trained_this_iter": 1800, "agent_timesteps_total": 131040, "timers": {"training_iteration_time_ms": 2238.229, "sample_time_ms": 2230.391, "load_time_ms": 0.23, "load_throughput": 1563418.347, "learn_time_ms": 6.907, "learn_throughput": 52122.58, "synch_weights_time_ms": 0.658}, "counters": {"num_env_steps_sampled": 131040, "num_env_steps_trained": 131040, "num_agent_steps_sampled": 131040, "num_agent_steps_trained": 131040}, "done": false, "episodes_total": 364, "training_iteration": 73, "trial_id": "f5e97_00000", "date": "2023-07-25_17-09-28", "timestamp": 1690294168, "time_this_iter_s": 11.15137267112732, "time_total_s": 814.1139862537384, "pid": 71917, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[0, 0.003], [5400, 0.001], [10800, 0.00075], [16200, 0.0005], [21600, 0.00025], [27000, 0.0001], [32400, 7.5e-05], [37800, 5e-05], [43200, 2.5e-05], [48600, 1e-05], [54000, 7.5e-06], [59400, 5e-06], [64800, 2.5e-06], [70200, 1e-06], [75600, 5e-07], [81000, 1e-07]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x304530310>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 814.1139862537384, "iterations_since_restore": 73, "perf": {"cpu_util_percent": 22.8125, "ram_util_percent": 81.6125}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-07, "entropy_coeff": 0.1, "policy_entropy": -926.7001831054688, "policy_loss": -11917806767308.8, "vf_loss": 1069403091.2}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 1843.0, "diff_num_grad_updates_vs_sampler_policy": 1842.0}}, "num_env_steps_sampled": 132840, "num_env_steps_trained": 132840, "num_agent_steps_sampled": 132840, "num_agent_steps_trained": 132840}, "sampler_results": {"episode_reward_max": -25363.73074076344, "episode_reward_min": -26184.635395319758, "episode_reward_mean": -25748.459626822085, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-25487.666593624537, -25390.160806222, -25606.10411112896, -25560.898605591057, -25713.51321003798, -25802.15825834444, -25559.61234837715, -25889.63188350402, -25739.953136814795, -25905.76233675474, -25818.73858470875, -25626.132600040637, -25647.313681746455, -25892.368079272357, -25638.759148403686, -25715.057738798045, -25844.66944533116, -25870.25614207713, -25920.880645498226, -25668.043754945003, -25738.768563863236, -25892.207337860433, -25581.518823479943, -25814.845674665205, -25556.672685873964, -25752.225778040585, -25770.54105836333, -25899.106776175176, -25840.86293602915, -25591.75138542168, -25510.290830657505, -25511.778369728654, -25812.90503700192, -25931.909280124957, -25860.461617755886, -25897.511315067466, -25792.746336386426, -25964.12300908346, -25634.24535731137, -25671.789190964275, -25518.673086091916, -25813.547403917546, -25526.71753209267, -25735.383906722796, -25801.119732630206, -25828.88528263503, -25831.823059561135, -25677.197986224346, -25687.04960455717, -26006.55309726376, -25695.4367463259, -25864.959502008885, -25787.11193002619, -25638.423404895515, -25581.237169707812, -25573.249009628562, -25905.690998452712, -26024.856504878888, -25706.668344990532, -25842.854540782766, -25728.393436948525, -25760.387993940018, -26184.635395319758, -25797.144567018688, -25948.060681634084, -25835.186169563676, -25866.614190566837, -25611.345078587674, -25479.25283061606, -25363.73074076344, -25887.061436977747, -25629.454968292463, -25640.349731648043, -25825.84153766307, -25920.300117916227, -25715.827265320084, -25781.78025677285, -25730.27264555775, -25943.576108077425, -25696.315924479346, -26015.101783501606, -25772.965387701348, -25639.14263189877, -25945.23576689735, -25776.46715704166, -25629.17291252169, -25824.38469927601, -25474.585936104304, -25738.491769587905, -25816.75142737078, -25633.590016855636, -25663.914401143084, -25809.1681167664, -25814.495198137734, -26013.12791246673, -25751.15506361066, -26024.23204956907, -25585.56141120515, -25803.91135088509, -25397.59529353382], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.405381314934797, "mean_inference_ms": 0.2468716422835513, "mean_action_processing_ms": 0.05871168418111109, "mean_env_wait_ms": 1.462275433307492, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0024709701538085938, "StateBufferConnector_ms": 0.001760721206665039, "ViewRequirementAgentConnector_ms": 0.04511070251464844}}, "episode_reward_max": -25363.73074076344, "episode_reward_min": -26184.635395319758, "episode_reward_mean": -25748.459626822085, "episode_len_mean": 360.0, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-25487.666593624537, -25390.160806222, -25606.10411112896, -25560.898605591057, -25713.51321003798, -25802.15825834444, -25559.61234837715, -25889.63188350402, -25739.953136814795, -25905.76233675474, -25818.73858470875, -25626.132600040637, -25647.313681746455, -25892.368079272357, -25638.759148403686, -25715.057738798045, -25844.66944533116, -25870.25614207713, -25920.880645498226, -25668.043754945003, -25738.768563863236, -25892.207337860433, -25581.518823479943, -25814.845674665205, -25556.672685873964, -25752.225778040585, -25770.54105836333, -25899.106776175176, -25840.86293602915, -25591.75138542168, -25510.290830657505, -25511.778369728654, -25812.90503700192, -25931.909280124957, -25860.461617755886, -25897.511315067466, -25792.746336386426, -25964.12300908346, -25634.24535731137, -25671.789190964275, -25518.673086091916, -25813.547403917546, -25526.71753209267, -25735.383906722796, -25801.119732630206, -25828.88528263503, -25831.823059561135, -25677.197986224346, -25687.04960455717, -26006.55309726376, -25695.4367463259, -25864.959502008885, -25787.11193002619, -25638.423404895515, -25581.237169707812, -25573.249009628562, -25905.690998452712, -26024.856504878888, -25706.668344990532, -25842.854540782766, -25728.393436948525, -25760.387993940018, -26184.635395319758, -25797.144567018688, -25948.060681634084, -25835.186169563676, -25866.614190566837, -25611.345078587674, -25479.25283061606, -25363.73074076344, -25887.061436977747, -25629.454968292463, -25640.349731648043, -25825.84153766307, -25920.300117916227, -25715.827265320084, -25781.78025677285, -25730.27264555775, -25943.576108077425, -25696.315924479346, -26015.101783501606, -25772.965387701348, -25639.14263189877, -25945.23576689735, -25776.46715704166, -25629.17291252169, -25824.38469927601, -25474.585936104304, -25738.491769587905, -25816.75142737078, -25633.590016855636, -25663.914401143084, -25809.1681167664, -25814.495198137734, -26013.12791246673, -25751.15506361066, -26024.23204956907, -25585.56141120515, -25803.91135088509, -25397.59529353382], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.405381314934797, "mean_inference_ms": 0.2468716422835513, "mean_action_processing_ms": 0.05871168418111109, "mean_env_wait_ms": 1.462275433307492, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0024709701538085938, "StateBufferConnector_ms": 0.001760721206665039, "ViewRequirementAgentConnector_ms": 0.04511070251464844}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 132840, "num_agent_steps_trained": 132840, "num_env_steps_sampled": 132840, "num_env_steps_trained": 132840, "num_env_steps_sampled_this_iter": 1800, "num_env_steps_trained_this_iter": 1800, "num_env_steps_sampled_throughput_per_sec": 161.73855011252238, "num_env_steps_trained_throughput_per_sec": 161.73855011252238, "timesteps_total": 132840, "num_steps_trained_this_iter": 1800, "agent_timesteps_total": 132840, "timers": {"training_iteration_time_ms": 2227.82, "sample_time_ms": 2220.554, "load_time_ms": 0.224, "load_throughput": 1604622.147, "learn_time_ms": 6.452, "learn_throughput": 55792.425, "synch_weights_time_ms": 0.549}, "counters": {"num_env_steps_sampled": 132840, "num_env_steps_trained": 132840, "num_agent_steps_sampled": 132840, "num_agent_steps_trained": 132840}, "done": false, "episodes_total": 369, "training_iteration": 74, "trial_id": "f5e97_00000", "date": "2023-07-25_17-09-39", "timestamp": 1690294179, "time_this_iter_s": 11.131344318389893, "time_total_s": 825.2453305721283, "pid": 71917, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[0, 0.003], [5400, 0.001], [10800, 0.00075], [16200, 0.0005], [21600, 0.00025], [27000, 0.0001], [32400, 7.5e-05], [37800, 5e-05], [43200, 2.5e-05], [48600, 1e-05], [54000, 7.5e-06], [59400, 5e-06], [64800, 2.5e-06], [70200, 1e-06], [75600, 5e-07], [81000, 1e-07]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x304530310>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 825.2453305721283, "iterations_since_restore": 74, "perf": {"cpu_util_percent": 24.939999999999994, "ram_util_percent": 77.67333333333335}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-07, "entropy_coeff": 0.1, "policy_entropy": -926.6999267578125, "policy_loss": -31799082215014.4, "vf_loss": 1090352403.2}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 1868.0, "diff_num_grad_updates_vs_sampler_policy": 1867.0}}, "num_env_steps_sampled": 134640, "num_env_steps_trained": 134640, "num_agent_steps_sampled": 134640, "num_agent_steps_trained": 134640}, "sampler_results": {"episode_reward_max": -25363.73074076344, "episode_reward_min": -26184.635395319758, "episode_reward_mean": -25755.00106862986, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-25802.15825834444, -25559.61234837715, -25889.63188350402, -25739.953136814795, -25905.76233675474, -25818.73858470875, -25626.132600040637, -25647.313681746455, -25892.368079272357, -25638.759148403686, -25715.057738798045, -25844.66944533116, -25870.25614207713, -25920.880645498226, -25668.043754945003, -25738.768563863236, -25892.207337860433, -25581.518823479943, -25814.845674665205, -25556.672685873964, -25752.225778040585, -25770.54105836333, -25899.106776175176, -25840.86293602915, -25591.75138542168, -25510.290830657505, -25511.778369728654, -25812.90503700192, -25931.909280124957, -25860.461617755886, -25897.511315067466, -25792.746336386426, -25964.12300908346, -25634.24535731137, -25671.789190964275, -25518.673086091916, -25813.547403917546, -25526.71753209267, -25735.383906722796, -25801.119732630206, -25828.88528263503, -25831.823059561135, -25677.197986224346, -25687.04960455717, -26006.55309726376, -25695.4367463259, -25864.959502008885, -25787.11193002619, -25638.423404895515, -25581.237169707812, -25573.249009628562, -25905.690998452712, -26024.856504878888, -25706.668344990532, -25842.854540782766, -25728.393436948525, -25760.387993940018, -26184.635395319758, -25797.144567018688, -25948.060681634084, -25835.186169563676, -25866.614190566837, -25611.345078587674, -25479.25283061606, -25363.73074076344, -25887.061436977747, -25629.454968292463, -25640.349731648043, -25825.84153766307, -25920.300117916227, -25715.827265320084, -25781.78025677285, -25730.27264555775, -25943.576108077425, -25696.315924479346, -26015.101783501606, -25772.965387701348, -25639.14263189877, -25945.23576689735, -25776.46715704166, -25629.17291252169, -25824.38469927601, -25474.585936104304, -25738.491769587905, -25816.75142737078, -25633.590016855636, -25663.914401143084, -25809.1681167664, -25814.495198137734, -26013.12791246673, -25751.15506361066, -26024.23204956907, -25585.56141120515, -25803.91135088509, -25397.59529353382, -25689.83339877553, -25792.64632575422, -25762.25726873361, -25513.363584614537, -25654.386929504642], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.405379823361149, "mean_inference_ms": 0.24690840565898, "mean_action_processing_ms": 0.058718475399095714, "mean_env_wait_ms": 1.462093121034228, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0024504661560058594, "StateBufferConnector_ms": 0.0017554759979248047, "ViewRequirementAgentConnector_ms": 0.04500532150268555}}, "episode_reward_max": -25363.73074076344, "episode_reward_min": -26184.635395319758, "episode_reward_mean": -25755.00106862986, "episode_len_mean": 360.0, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-25802.15825834444, -25559.61234837715, -25889.63188350402, -25739.953136814795, -25905.76233675474, -25818.73858470875, -25626.132600040637, -25647.313681746455, -25892.368079272357, -25638.759148403686, -25715.057738798045, -25844.66944533116, -25870.25614207713, -25920.880645498226, -25668.043754945003, -25738.768563863236, -25892.207337860433, -25581.518823479943, -25814.845674665205, -25556.672685873964, -25752.225778040585, -25770.54105836333, -25899.106776175176, -25840.86293602915, -25591.75138542168, -25510.290830657505, -25511.778369728654, -25812.90503700192, -25931.909280124957, -25860.461617755886, -25897.511315067466, -25792.746336386426, -25964.12300908346, -25634.24535731137, -25671.789190964275, -25518.673086091916, -25813.547403917546, -25526.71753209267, -25735.383906722796, -25801.119732630206, -25828.88528263503, -25831.823059561135, -25677.197986224346, -25687.04960455717, -26006.55309726376, -25695.4367463259, -25864.959502008885, -25787.11193002619, -25638.423404895515, -25581.237169707812, -25573.249009628562, -25905.690998452712, -26024.856504878888, -25706.668344990532, -25842.854540782766, -25728.393436948525, -25760.387993940018, -26184.635395319758, -25797.144567018688, -25948.060681634084, -25835.186169563676, -25866.614190566837, -25611.345078587674, -25479.25283061606, -25363.73074076344, -25887.061436977747, -25629.454968292463, -25640.349731648043, -25825.84153766307, -25920.300117916227, -25715.827265320084, -25781.78025677285, -25730.27264555775, -25943.576108077425, -25696.315924479346, -26015.101783501606, -25772.965387701348, -25639.14263189877, -25945.23576689735, -25776.46715704166, -25629.17291252169, -25824.38469927601, -25474.585936104304, -25738.491769587905, -25816.75142737078, -25633.590016855636, -25663.914401143084, -25809.1681167664, -25814.495198137734, -26013.12791246673, -25751.15506361066, -26024.23204956907, -25585.56141120515, -25803.91135088509, -25397.59529353382, -25689.83339877553, -25792.64632575422, -25762.25726873361, -25513.363584614537, -25654.386929504642], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.405379823361149, "mean_inference_ms": 0.24690840565898, "mean_action_processing_ms": 0.058718475399095714, "mean_env_wait_ms": 1.462093121034228, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0024504661560058594, "StateBufferConnector_ms": 0.0017554759979248047, "ViewRequirementAgentConnector_ms": 0.04500532150268555}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 134640, "num_agent_steps_trained": 134640, "num_env_steps_sampled": 134640, "num_env_steps_trained": 134640, "num_env_steps_sampled_this_iter": 1800, "num_env_steps_trained_this_iter": 1800, "num_env_steps_sampled_throughput_per_sec": 160.88566025189442, "num_env_steps_trained_throughput_per_sec": 160.88566025189442, "timesteps_total": 134640, "num_steps_trained_this_iter": 1800, "agent_timesteps_total": 134640, "timers": {"training_iteration_time_ms": 2231.704, "sample_time_ms": 2224.557, "load_time_ms": 0.221, "load_throughput": 1630262.837, "learn_time_ms": 6.356, "learn_throughput": 56637.051, "synch_weights_time_ms": 0.537}, "counters": {"num_env_steps_sampled": 134640, "num_env_steps_trained": 134640, "num_agent_steps_sampled": 134640, "num_agent_steps_trained": 134640}, "done": false, "episodes_total": 374, "training_iteration": 75, "trial_id": "f5e97_00000", "date": "2023-07-25_17-09-51", "timestamp": 1690294191, "time_this_iter_s": 11.19028115272522, "time_total_s": 836.4356117248535, "pid": 71917, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[0, 0.003], [5400, 0.001], [10800, 0.00075], [16200, 0.0005], [21600, 0.00025], [27000, 0.0001], [32400, 7.5e-05], [37800, 5e-05], [43200, 2.5e-05], [48600, 1e-05], [54000, 7.5e-06], [59400, 5e-06], [64800, 2.5e-06], [70200, 1e-06], [75600, 5e-07], [81000, 1e-07]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x304530310>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 836.4356117248535, "iterations_since_restore": 75, "perf": {"cpu_util_percent": 24.925, "ram_util_percent": 79.51875000000001}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-07, "entropy_coeff": 0.1, "policy_entropy": -926.6995239257812, "policy_loss": -14023219648921.6, "vf_loss": 1125296691.2}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 1893.0, "diff_num_grad_updates_vs_sampler_policy": 1892.0}}, "num_env_steps_sampled": 136440, "num_env_steps_trained": 136440, "num_agent_steps_sampled": 136440, "num_agent_steps_trained": 136440}, "sampler_results": {"episode_reward_max": -25363.73074076344, "episode_reward_min": -26184.635395319758, "episode_reward_mean": -25757.6558132229, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-25818.73858470875, -25626.132600040637, -25647.313681746455, -25892.368079272357, -25638.759148403686, -25715.057738798045, -25844.66944533116, -25870.25614207713, -25920.880645498226, -25668.043754945003, -25738.768563863236, -25892.207337860433, -25581.518823479943, -25814.845674665205, -25556.672685873964, -25752.225778040585, -25770.54105836333, -25899.106776175176, -25840.86293602915, -25591.75138542168, -25510.290830657505, -25511.778369728654, -25812.90503700192, -25931.909280124957, -25860.461617755886, -25897.511315067466, -25792.746336386426, -25964.12300908346, -25634.24535731137, -25671.789190964275, -25518.673086091916, -25813.547403917546, -25526.71753209267, -25735.383906722796, -25801.119732630206, -25828.88528263503, -25831.823059561135, -25677.197986224346, -25687.04960455717, -26006.55309726376, -25695.4367463259, -25864.959502008885, -25787.11193002619, -25638.423404895515, -25581.237169707812, -25573.249009628562, -25905.690998452712, -26024.856504878888, -25706.668344990532, -25842.854540782766, -25728.393436948525, -25760.387993940018, -26184.635395319758, -25797.144567018688, -25948.060681634084, -25835.186169563676, -25866.614190566837, -25611.345078587674, -25479.25283061606, -25363.73074076344, -25887.061436977747, -25629.454968292463, -25640.349731648043, -25825.84153766307, -25920.300117916227, -25715.827265320084, -25781.78025677285, -25730.27264555775, -25943.576108077425, -25696.315924479346, -26015.101783501606, -25772.965387701348, -25639.14263189877, -25945.23576689735, -25776.46715704166, -25629.17291252169, -25824.38469927601, -25474.585936104304, -25738.491769587905, -25816.75142737078, -25633.590016855636, -25663.914401143084, -25809.1681167664, -25814.495198137734, -26013.12791246673, -25751.15506361066, -26024.23204956907, -25585.56141120515, -25803.91135088509, -25397.59529353382, -25689.83339877553, -25792.64632575422, -25762.25726873361, -25513.363584614537, -25654.386929504642, -25946.441046369913, -25736.046238825897, -25745.792221471816, -25757.18296566674, -25977.129950764425], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.40536896078284, "mean_inference_ms": 0.24694411796537497, "mean_action_processing_ms": 0.05872521762830406, "mean_env_wait_ms": 1.4619109569915816, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0024366378784179688, "StateBufferConnector_ms": 0.0017514228820800781, "ViewRequirementAgentConnector_ms": 0.04502367973327637}}, "episode_reward_max": -25363.73074076344, "episode_reward_min": -26184.635395319758, "episode_reward_mean": -25757.6558132229, "episode_len_mean": 360.0, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-25818.73858470875, -25626.132600040637, -25647.313681746455, -25892.368079272357, -25638.759148403686, -25715.057738798045, -25844.66944533116, -25870.25614207713, -25920.880645498226, -25668.043754945003, -25738.768563863236, -25892.207337860433, -25581.518823479943, -25814.845674665205, -25556.672685873964, -25752.225778040585, -25770.54105836333, -25899.106776175176, -25840.86293602915, -25591.75138542168, -25510.290830657505, -25511.778369728654, -25812.90503700192, -25931.909280124957, -25860.461617755886, -25897.511315067466, -25792.746336386426, -25964.12300908346, -25634.24535731137, -25671.789190964275, -25518.673086091916, -25813.547403917546, -25526.71753209267, -25735.383906722796, -25801.119732630206, -25828.88528263503, -25831.823059561135, -25677.197986224346, -25687.04960455717, -26006.55309726376, -25695.4367463259, -25864.959502008885, -25787.11193002619, -25638.423404895515, -25581.237169707812, -25573.249009628562, -25905.690998452712, -26024.856504878888, -25706.668344990532, -25842.854540782766, -25728.393436948525, -25760.387993940018, -26184.635395319758, -25797.144567018688, -25948.060681634084, -25835.186169563676, -25866.614190566837, -25611.345078587674, -25479.25283061606, -25363.73074076344, -25887.061436977747, -25629.454968292463, -25640.349731648043, -25825.84153766307, -25920.300117916227, -25715.827265320084, -25781.78025677285, -25730.27264555775, -25943.576108077425, -25696.315924479346, -26015.101783501606, -25772.965387701348, -25639.14263189877, -25945.23576689735, -25776.46715704166, -25629.17291252169, -25824.38469927601, -25474.585936104304, -25738.491769587905, -25816.75142737078, -25633.590016855636, -25663.914401143084, -25809.1681167664, -25814.495198137734, -26013.12791246673, -25751.15506361066, -26024.23204956907, -25585.56141120515, -25803.91135088509, -25397.59529353382, -25689.83339877553, -25792.64632575422, -25762.25726873361, -25513.363584614537, -25654.386929504642, -25946.441046369913, -25736.046238825897, -25745.792221471816, -25757.18296566674, -25977.129950764425], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.40536896078284, "mean_inference_ms": 0.24694411796537497, "mean_action_processing_ms": 0.05872521762830406, "mean_env_wait_ms": 1.4619109569915816, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0024366378784179688, "StateBufferConnector_ms": 0.0017514228820800781, "ViewRequirementAgentConnector_ms": 0.04502367973327637}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 136440, "num_agent_steps_trained": 136440, "num_env_steps_sampled": 136440, "num_env_steps_trained": 136440, "num_env_steps_sampled_this_iter": 1800, "num_env_steps_trained_this_iter": 1800, "num_env_steps_sampled_throughput_per_sec": 161.3427034625261, "num_env_steps_trained_throughput_per_sec": 161.3427034625261, "timesteps_total": 136440, "num_steps_trained_this_iter": 1800, "agent_timesteps_total": 136440, "timers": {"training_iteration_time_ms": 2234.435, "sample_time_ms": 2227.283, "load_time_ms": 0.231, "load_throughput": 1559220.818, "learn_time_ms": 6.365, "learn_throughput": 56560.463, "synch_weights_time_ms": 0.524}, "counters": {"num_env_steps_sampled": 136440, "num_env_steps_trained": 136440, "num_agent_steps_sampled": 136440, "num_agent_steps_trained": 136440}, "done": false, "episodes_total": 379, "training_iteration": 76, "trial_id": "f5e97_00000", "date": "2023-07-25_17-10-02", "timestamp": 1690294202, "time_this_iter_s": 11.158491849899292, "time_total_s": 847.5941035747528, "pid": 71917, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[0, 0.003], [5400, 0.001], [10800, 0.00075], [16200, 0.0005], [21600, 0.00025], [27000, 0.0001], [32400, 7.5e-05], [37800, 5e-05], [43200, 2.5e-05], [48600, 1e-05], [54000, 7.5e-06], [59400, 5e-06], [64800, 2.5e-06], [70200, 1e-06], [75600, 5e-07], [81000, 1e-07]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x304530310>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 847.5941035747528, "iterations_since_restore": 76, "perf": {"cpu_util_percent": 24.13125, "ram_util_percent": 80.04374999999999}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-07, "entropy_coeff": 0.1, "policy_entropy": -926.6998901367188, "policy_loss": -20669612241715.2, "vf_loss": 1099016889.6}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 1918.0, "diff_num_grad_updates_vs_sampler_policy": 1917.0}}, "num_env_steps_sampled": 138240, "num_env_steps_trained": 138240, "num_agent_steps_sampled": 138240, "num_agent_steps_trained": 138240}, "sampler_results": {"episode_reward_max": -25363.73074076344, "episode_reward_min": -26184.635395319758, "episode_reward_mean": -25757.33260706153, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-25715.057738798045, -25844.66944533116, -25870.25614207713, -25920.880645498226, -25668.043754945003, -25738.768563863236, -25892.207337860433, -25581.518823479943, -25814.845674665205, -25556.672685873964, -25752.225778040585, -25770.54105836333, -25899.106776175176, -25840.86293602915, -25591.75138542168, -25510.290830657505, -25511.778369728654, -25812.90503700192, -25931.909280124957, -25860.461617755886, -25897.511315067466, -25792.746336386426, -25964.12300908346, -25634.24535731137, -25671.789190964275, -25518.673086091916, -25813.547403917546, -25526.71753209267, -25735.383906722796, -25801.119732630206, -25828.88528263503, -25831.823059561135, -25677.197986224346, -25687.04960455717, -26006.55309726376, -25695.4367463259, -25864.959502008885, -25787.11193002619, -25638.423404895515, -25581.237169707812, -25573.249009628562, -25905.690998452712, -26024.856504878888, -25706.668344990532, -25842.854540782766, -25728.393436948525, -25760.387993940018, -26184.635395319758, -25797.144567018688, -25948.060681634084, -25835.186169563676, -25866.614190566837, -25611.345078587674, -25479.25283061606, -25363.73074076344, -25887.061436977747, -25629.454968292463, -25640.349731648043, -25825.84153766307, -25920.300117916227, -25715.827265320084, -25781.78025677285, -25730.27264555775, -25943.576108077425, -25696.315924479346, -26015.101783501606, -25772.965387701348, -25639.14263189877, -25945.23576689735, -25776.46715704166, -25629.17291252169, -25824.38469927601, -25474.585936104304, -25738.491769587905, -25816.75142737078, -25633.590016855636, -25663.914401143084, -25809.1681167664, -25814.495198137734, -26013.12791246673, -25751.15506361066, -26024.23204956907, -25585.56141120515, -25803.91135088509, -25397.59529353382, -25689.83339877553, -25792.64632575422, -25762.25726873361, -25513.363584614537, -25654.386929504642, -25946.441046369913, -25736.046238825897, -25745.792221471816, -25757.18296566674, -25977.129950764425, -25760.824563126018, -25769.812329952805, -25641.00711604146, -25670.716394367177, -25748.631074546764], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.405237242635397, "mean_inference_ms": 0.24695069529504934, "mean_action_processing_ms": 0.058726567568564064, "mean_env_wait_ms": 1.4616490465914904, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002414226531982422, "StateBufferConnector_ms": 0.0017399787902832031, "ViewRequirementAgentConnector_ms": 0.044584035873413086}}, "episode_reward_max": -25363.73074076344, "episode_reward_min": -26184.635395319758, "episode_reward_mean": -25757.33260706153, "episode_len_mean": 360.0, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-25715.057738798045, -25844.66944533116, -25870.25614207713, -25920.880645498226, -25668.043754945003, -25738.768563863236, -25892.207337860433, -25581.518823479943, -25814.845674665205, -25556.672685873964, -25752.225778040585, -25770.54105836333, -25899.106776175176, -25840.86293602915, -25591.75138542168, -25510.290830657505, -25511.778369728654, -25812.90503700192, -25931.909280124957, -25860.461617755886, -25897.511315067466, -25792.746336386426, -25964.12300908346, -25634.24535731137, -25671.789190964275, -25518.673086091916, -25813.547403917546, -25526.71753209267, -25735.383906722796, -25801.119732630206, -25828.88528263503, -25831.823059561135, -25677.197986224346, -25687.04960455717, -26006.55309726376, -25695.4367463259, -25864.959502008885, -25787.11193002619, -25638.423404895515, -25581.237169707812, -25573.249009628562, -25905.690998452712, -26024.856504878888, -25706.668344990532, -25842.854540782766, -25728.393436948525, -25760.387993940018, -26184.635395319758, -25797.144567018688, -25948.060681634084, -25835.186169563676, -25866.614190566837, -25611.345078587674, -25479.25283061606, -25363.73074076344, -25887.061436977747, -25629.454968292463, -25640.349731648043, -25825.84153766307, -25920.300117916227, -25715.827265320084, -25781.78025677285, -25730.27264555775, -25943.576108077425, -25696.315924479346, -26015.101783501606, -25772.965387701348, -25639.14263189877, -25945.23576689735, -25776.46715704166, -25629.17291252169, -25824.38469927601, -25474.585936104304, -25738.491769587905, -25816.75142737078, -25633.590016855636, -25663.914401143084, -25809.1681167664, -25814.495198137734, -26013.12791246673, -25751.15506361066, -26024.23204956907, -25585.56141120515, -25803.91135088509, -25397.59529353382, -25689.83339877553, -25792.64632575422, -25762.25726873361, -25513.363584614537, -25654.386929504642, -25946.441046369913, -25736.046238825897, -25745.792221471816, -25757.18296566674, -25977.129950764425, -25760.824563126018, -25769.812329952805, -25641.00711604146, -25670.716394367177, -25748.631074546764], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.405237242635397, "mean_inference_ms": 0.24695069529504934, "mean_action_processing_ms": 0.058726567568564064, "mean_env_wait_ms": 1.4616490465914904, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002414226531982422, "StateBufferConnector_ms": 0.0017399787902832031, "ViewRequirementAgentConnector_ms": 0.044584035873413086}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 138240, "num_agent_steps_trained": 138240, "num_env_steps_sampled": 138240, "num_env_steps_trained": 138240, "num_env_steps_sampled_this_iter": 1800, "num_env_steps_trained_this_iter": 1800, "num_env_steps_sampled_throughput_per_sec": 163.00490056638003, "num_env_steps_trained_throughput_per_sec": 163.00490056638003, "timesteps_total": 138240, "num_steps_trained_this_iter": 1800, "agent_timesteps_total": 138240, "timers": {"training_iteration_time_ms": 2219.889, "sample_time_ms": 2212.72, "load_time_ms": 0.228, "load_throughput": 1581595.726, "learn_time_ms": 6.386, "learn_throughput": 56373.16, "synch_weights_time_ms": 0.524}, "counters": {"num_env_steps_sampled": 138240, "num_env_steps_trained": 138240, "num_agent_steps_sampled": 138240, "num_agent_steps_trained": 138240}, "done": false, "episodes_total": 384, "training_iteration": 77, "trial_id": "f5e97_00000", "date": "2023-07-25_17-10-13", "timestamp": 1690294213, "time_this_iter_s": 11.044902801513672, "time_total_s": 858.6390063762665, "pid": 71917, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[0, 0.003], [5400, 0.001], [10800, 0.00075], [16200, 0.0005], [21600, 0.00025], [27000, 0.0001], [32400, 7.5e-05], [37800, 5e-05], [43200, 2.5e-05], [48600, 1e-05], [54000, 7.5e-06], [59400, 5e-06], [64800, 2.5e-06], [70200, 1e-06], [75600, 5e-07], [81000, 1e-07]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x304530310>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 858.6390063762665, "iterations_since_restore": 77, "perf": {"cpu_util_percent": 23.5375, "ram_util_percent": 79.32499999999999}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-07, "entropy_coeff": 0.1, "policy_entropy": -926.699755859375, "policy_loss": -32240898955673.6, "vf_loss": 1101996390.4}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 1943.0, "diff_num_grad_updates_vs_sampler_policy": 1942.0}}, "num_env_steps_sampled": 140040, "num_env_steps_trained": 140040, "num_agent_steps_sampled": 140040, "num_agent_steps_trained": 140040}, "sampler_results": {"episode_reward_max": -25363.73074076344, "episode_reward_min": -26184.635395319758, "episode_reward_mean": -25754.572879416708, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-25738.768563863236, -25892.207337860433, -25581.518823479943, -25814.845674665205, -25556.672685873964, -25752.225778040585, -25770.54105836333, -25899.106776175176, -25840.86293602915, -25591.75138542168, -25510.290830657505, -25511.778369728654, -25812.90503700192, -25931.909280124957, -25860.461617755886, -25897.511315067466, -25792.746336386426, -25964.12300908346, -25634.24535731137, -25671.789190964275, -25518.673086091916, -25813.547403917546, -25526.71753209267, -25735.383906722796, -25801.119732630206, -25828.88528263503, -25831.823059561135, -25677.197986224346, -25687.04960455717, -26006.55309726376, -25695.4367463259, -25864.959502008885, -25787.11193002619, -25638.423404895515, -25581.237169707812, -25573.249009628562, -25905.690998452712, -26024.856504878888, -25706.668344990532, -25842.854540782766, -25728.393436948525, -25760.387993940018, -26184.635395319758, -25797.144567018688, -25948.060681634084, -25835.186169563676, -25866.614190566837, -25611.345078587674, -25479.25283061606, -25363.73074076344, -25887.061436977747, -25629.454968292463, -25640.349731648043, -25825.84153766307, -25920.300117916227, -25715.827265320084, -25781.78025677285, -25730.27264555775, -25943.576108077425, -25696.315924479346, -26015.101783501606, -25772.965387701348, -25639.14263189877, -25945.23576689735, -25776.46715704166, -25629.17291252169, -25824.38469927601, -25474.585936104304, -25738.491769587905, -25816.75142737078, -25633.590016855636, -25663.914401143084, -25809.1681167664, -25814.495198137734, -26013.12791246673, -25751.15506361066, -26024.23204956907, -25585.56141120515, -25803.91135088509, -25397.59529353382, -25689.83339877553, -25792.64632575422, -25762.25726873361, -25513.363584614537, -25654.386929504642, -25946.441046369913, -25736.046238825897, -25745.792221471816, -25757.18296566674, -25977.129950764425, -25760.824563126018, -25769.812329952805, -25641.00711604146, -25670.716394367177, -25748.631074546764, -25660.03871004826, -25727.09740035645, -25926.264704644032, -25665.57958125113, -25763.954565868127], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.405070554784459, "mean_inference_ms": 0.24695647167198803, "mean_action_processing_ms": 0.05872777742127463, "mean_env_wait_ms": 1.4614046129810128, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002416849136352539, "StateBufferConnector_ms": 0.001741647720336914, "ViewRequirementAgentConnector_ms": 0.04457902908325195}}, "episode_reward_max": -25363.73074076344, "episode_reward_min": -26184.635395319758, "episode_reward_mean": -25754.572879416708, "episode_len_mean": 360.0, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-25738.768563863236, -25892.207337860433, -25581.518823479943, -25814.845674665205, -25556.672685873964, -25752.225778040585, -25770.54105836333, -25899.106776175176, -25840.86293602915, -25591.75138542168, -25510.290830657505, -25511.778369728654, -25812.90503700192, -25931.909280124957, -25860.461617755886, -25897.511315067466, -25792.746336386426, -25964.12300908346, -25634.24535731137, -25671.789190964275, -25518.673086091916, -25813.547403917546, -25526.71753209267, -25735.383906722796, -25801.119732630206, -25828.88528263503, -25831.823059561135, -25677.197986224346, -25687.04960455717, -26006.55309726376, -25695.4367463259, -25864.959502008885, -25787.11193002619, -25638.423404895515, -25581.237169707812, -25573.249009628562, -25905.690998452712, -26024.856504878888, -25706.668344990532, -25842.854540782766, -25728.393436948525, -25760.387993940018, -26184.635395319758, -25797.144567018688, -25948.060681634084, -25835.186169563676, -25866.614190566837, -25611.345078587674, -25479.25283061606, -25363.73074076344, -25887.061436977747, -25629.454968292463, -25640.349731648043, -25825.84153766307, -25920.300117916227, -25715.827265320084, -25781.78025677285, -25730.27264555775, -25943.576108077425, -25696.315924479346, -26015.101783501606, -25772.965387701348, -25639.14263189877, -25945.23576689735, -25776.46715704166, -25629.17291252169, -25824.38469927601, -25474.585936104304, -25738.491769587905, -25816.75142737078, -25633.590016855636, -25663.914401143084, -25809.1681167664, -25814.495198137734, -26013.12791246673, -25751.15506361066, -26024.23204956907, -25585.56141120515, -25803.91135088509, -25397.59529353382, -25689.83339877553, -25792.64632575422, -25762.25726873361, -25513.363584614537, -25654.386929504642, -25946.441046369913, -25736.046238825897, -25745.792221471816, -25757.18296566674, -25977.129950764425, -25760.824563126018, -25769.812329952805, -25641.00711604146, -25670.716394367177, -25748.631074546764, -25660.03871004826, -25727.09740035645, -25926.264704644032, -25665.57958125113, -25763.954565868127], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.405070554784459, "mean_inference_ms": 0.24695647167198803, "mean_action_processing_ms": 0.05872777742127463, "mean_env_wait_ms": 1.4614046129810128, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002416849136352539, "StateBufferConnector_ms": 0.001741647720336914, "ViewRequirementAgentConnector_ms": 0.04457902908325195}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 140040, "num_agent_steps_trained": 140040, "num_env_steps_sampled": 140040, "num_env_steps_trained": 140040, "num_env_steps_sampled_this_iter": 1800, "num_env_steps_trained_this_iter": 1800, "num_env_steps_sampled_throughput_per_sec": 162.07249185011042, "num_env_steps_trained_throughput_per_sec": 162.07249185011042, "timesteps_total": 140040, "num_steps_trained_this_iter": 1800, "agent_timesteps_total": 140040, "timers": {"training_iteration_time_ms": 2214.865, "sample_time_ms": 2207.657, "load_time_ms": 0.239, "load_throughput": 1503783.926, "learn_time_ms": 6.402, "learn_throughput": 56228.311, "synch_weights_time_ms": 0.533}, "counters": {"num_env_steps_sampled": 140040, "num_env_steps_trained": 140040, "num_agent_steps_sampled": 140040, "num_agent_steps_trained": 140040}, "done": false, "episodes_total": 389, "training_iteration": 78, "trial_id": "f5e97_00000", "date": "2023-07-25_17-10-24", "timestamp": 1690294224, "time_this_iter_s": 11.108266115188599, "time_total_s": 869.7472724914551, "pid": 71917, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[0, 0.003], [5400, 0.001], [10800, 0.00075], [16200, 0.0005], [21600, 0.00025], [27000, 0.0001], [32400, 7.5e-05], [37800, 5e-05], [43200, 2.5e-05], [48600, 1e-05], [54000, 7.5e-06], [59400, 5e-06], [64800, 2.5e-06], [70200, 1e-06], [75600, 5e-07], [81000, 1e-07]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x304530310>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 869.7472724914551, "iterations_since_restore": 78, "perf": {"cpu_util_percent": 22.979999999999997, "ram_util_percent": 79.73333333333333}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-07, "entropy_coeff": 0.1, "policy_entropy": -926.69951171875, "policy_loss": -34580486710067.2, "vf_loss": 1104736672.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 1968.0, "diff_num_grad_updates_vs_sampler_policy": 1967.0}}, "num_env_steps_sampled": 141840, "num_env_steps_trained": 141840, "num_agent_steps_sampled": 141840, "num_agent_steps_trained": 141840}, "sampler_results": {"episode_reward_max": -25363.73074076344, "episode_reward_min": -26184.635395319758, "episode_reward_mean": -25752.736330230986, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-25752.225778040585, -25770.54105836333, -25899.106776175176, -25840.86293602915, -25591.75138542168, -25510.290830657505, -25511.778369728654, -25812.90503700192, -25931.909280124957, -25860.461617755886, -25897.511315067466, -25792.746336386426, -25964.12300908346, -25634.24535731137, -25671.789190964275, -25518.673086091916, -25813.547403917546, -25526.71753209267, -25735.383906722796, -25801.119732630206, -25828.88528263503, -25831.823059561135, -25677.197986224346, -25687.04960455717, -26006.55309726376, -25695.4367463259, -25864.959502008885, -25787.11193002619, -25638.423404895515, -25581.237169707812, -25573.249009628562, -25905.690998452712, -26024.856504878888, -25706.668344990532, -25842.854540782766, -25728.393436948525, -25760.387993940018, -26184.635395319758, -25797.144567018688, -25948.060681634084, -25835.186169563676, -25866.614190566837, -25611.345078587674, -25479.25283061606, -25363.73074076344, -25887.061436977747, -25629.454968292463, -25640.349731648043, -25825.84153766307, -25920.300117916227, -25715.827265320084, -25781.78025677285, -25730.27264555775, -25943.576108077425, -25696.315924479346, -26015.101783501606, -25772.965387701348, -25639.14263189877, -25945.23576689735, -25776.46715704166, -25629.17291252169, -25824.38469927601, -25474.585936104304, -25738.491769587905, -25816.75142737078, -25633.590016855636, -25663.914401143084, -25809.1681167664, -25814.495198137734, -26013.12791246673, -25751.15506361066, -26024.23204956907, -25585.56141120515, -25803.91135088509, -25397.59529353382, -25689.83339877553, -25792.64632575422, -25762.25726873361, -25513.363584614537, -25654.386929504642, -25946.441046369913, -25736.046238825897, -25745.792221471816, -25757.18296566674, -25977.129950764425, -25760.824563126018, -25769.812329952805, -25641.00711604146, -25670.716394367177, -25748.631074546764, -25660.03871004826, -25727.09740035645, -25926.264704644032, -25665.57958125113, -25763.954565868127, -25446.306983019582, -25722.919963325443, -25501.036084131996, -25828.842520491533, -25901.25261620219], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.404854310472188, "mean_inference_ms": 0.24695980558236413, "mean_action_processing_ms": 0.05872850834766247, "mean_env_wait_ms": 1.4611673003147587, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002420186996459961, "StateBufferConnector_ms": 0.0017414093017578125, "ViewRequirementAgentConnector_ms": 0.044580936431884766}}, "episode_reward_max": -25363.73074076344, "episode_reward_min": -26184.635395319758, "episode_reward_mean": -25752.736330230986, "episode_len_mean": 360.0, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-25752.225778040585, -25770.54105836333, -25899.106776175176, -25840.86293602915, -25591.75138542168, -25510.290830657505, -25511.778369728654, -25812.90503700192, -25931.909280124957, -25860.461617755886, -25897.511315067466, -25792.746336386426, -25964.12300908346, -25634.24535731137, -25671.789190964275, -25518.673086091916, -25813.547403917546, -25526.71753209267, -25735.383906722796, -25801.119732630206, -25828.88528263503, -25831.823059561135, -25677.197986224346, -25687.04960455717, -26006.55309726376, -25695.4367463259, -25864.959502008885, -25787.11193002619, -25638.423404895515, -25581.237169707812, -25573.249009628562, -25905.690998452712, -26024.856504878888, -25706.668344990532, -25842.854540782766, -25728.393436948525, -25760.387993940018, -26184.635395319758, -25797.144567018688, -25948.060681634084, -25835.186169563676, -25866.614190566837, -25611.345078587674, -25479.25283061606, -25363.73074076344, -25887.061436977747, -25629.454968292463, -25640.349731648043, -25825.84153766307, -25920.300117916227, -25715.827265320084, -25781.78025677285, -25730.27264555775, -25943.576108077425, -25696.315924479346, -26015.101783501606, -25772.965387701348, -25639.14263189877, -25945.23576689735, -25776.46715704166, -25629.17291252169, -25824.38469927601, -25474.585936104304, -25738.491769587905, -25816.75142737078, -25633.590016855636, -25663.914401143084, -25809.1681167664, -25814.495198137734, -26013.12791246673, -25751.15506361066, -26024.23204956907, -25585.56141120515, -25803.91135088509, -25397.59529353382, -25689.83339877553, -25792.64632575422, -25762.25726873361, -25513.363584614537, -25654.386929504642, -25946.441046369913, -25736.046238825897, -25745.792221471816, -25757.18296566674, -25977.129950764425, -25760.824563126018, -25769.812329952805, -25641.00711604146, -25670.716394367177, -25748.631074546764, -25660.03871004826, -25727.09740035645, -25926.264704644032, -25665.57958125113, -25763.954565868127, -25446.306983019582, -25722.919963325443, -25501.036084131996, -25828.842520491533, -25901.25261620219], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.404854310472188, "mean_inference_ms": 0.24695980558236413, "mean_action_processing_ms": 0.05872850834766247, "mean_env_wait_ms": 1.4611673003147587, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002420186996459961, "StateBufferConnector_ms": 0.0017414093017578125, "ViewRequirementAgentConnector_ms": 0.044580936431884766}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 141840, "num_agent_steps_trained": 141840, "num_env_steps_sampled": 141840, "num_env_steps_trained": 141840, "num_env_steps_sampled_this_iter": 1800, "num_env_steps_trained_this_iter": 1800, "num_env_steps_sampled_throughput_per_sec": 163.33471512638928, "num_env_steps_trained_throughput_per_sec": 163.33471512638928, "timesteps_total": 141840, "num_steps_trained_this_iter": 1800, "agent_timesteps_total": 141840, "timers": {"training_iteration_time_ms": 2212.635, "sample_time_ms": 2205.349, "load_time_ms": 0.239, "load_throughput": 1506785.191, "learn_time_ms": 6.466, "learn_throughput": 55677.834, "synch_weights_time_ms": 0.547}, "counters": {"num_env_steps_sampled": 141840, "num_env_steps_trained": 141840, "num_agent_steps_sampled": 141840, "num_agent_steps_trained": 141840}, "done": false, "episodes_total": 394, "training_iteration": 79, "trial_id": "f5e97_00000", "date": "2023-07-25_17-10-35", "timestamp": 1690294235, "time_this_iter_s": 11.022466897964478, "time_total_s": 880.7697393894196, "pid": 71917, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[0, 0.003], [5400, 0.001], [10800, 0.00075], [16200, 0.0005], [21600, 0.00025], [27000, 0.0001], [32400, 7.5e-05], [37800, 5e-05], [43200, 2.5e-05], [48600, 1e-05], [54000, 7.5e-06], [59400, 5e-06], [64800, 2.5e-06], [70200, 1e-06], [75600, 5e-07], [81000, 1e-07]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x304530310>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 880.7697393894196, "iterations_since_restore": 79, "perf": {"cpu_util_percent": 23.275, "ram_util_percent": 78.56875000000001}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-07, "entropy_coeff": 0.1, "policy_entropy": -926.6994140625, "policy_loss": -13629514868326.4, "vf_loss": 1107352473.6}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 1993.0, "diff_num_grad_updates_vs_sampler_policy": 1992.0}}, "num_env_steps_sampled": 143640, "num_env_steps_trained": 143640, "num_agent_steps_sampled": 143640, "num_agent_steps_trained": 143640}, "sampler_results": {"episode_reward_max": -25332.38893781996, "episode_reward_min": -26184.635395319758, "episode_reward_mean": -25747.537464576562, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-25510.290830657505, -25511.778369728654, -25812.90503700192, -25931.909280124957, -25860.461617755886, -25897.511315067466, -25792.746336386426, -25964.12300908346, -25634.24535731137, -25671.789190964275, -25518.673086091916, -25813.547403917546, -25526.71753209267, -25735.383906722796, -25801.119732630206, -25828.88528263503, -25831.823059561135, -25677.197986224346, -25687.04960455717, -26006.55309726376, -25695.4367463259, -25864.959502008885, -25787.11193002619, -25638.423404895515, -25581.237169707812, -25573.249009628562, -25905.690998452712, -26024.856504878888, -25706.668344990532, -25842.854540782766, -25728.393436948525, -25760.387993940018, -26184.635395319758, -25797.144567018688, -25948.060681634084, -25835.186169563676, -25866.614190566837, -25611.345078587674, -25479.25283061606, -25363.73074076344, -25887.061436977747, -25629.454968292463, -25640.349731648043, -25825.84153766307, -25920.300117916227, -25715.827265320084, -25781.78025677285, -25730.27264555775, -25943.576108077425, -25696.315924479346, -26015.101783501606, -25772.965387701348, -25639.14263189877, -25945.23576689735, -25776.46715704166, -25629.17291252169, -25824.38469927601, -25474.585936104304, -25738.491769587905, -25816.75142737078, -25633.590016855636, -25663.914401143084, -25809.1681167664, -25814.495198137734, -26013.12791246673, -25751.15506361066, -26024.23204956907, -25585.56141120515, -25803.91135088509, -25397.59529353382, -25689.83339877553, -25792.64632575422, -25762.25726873361, -25513.363584614537, -25654.386929504642, -25946.441046369913, -25736.046238825897, -25745.792221471816, -25757.18296566674, -25977.129950764425, -25760.824563126018, -25769.812329952805, -25641.00711604146, -25670.716394367177, -25748.631074546764, -25660.03871004826, -25727.09740035645, -25926.264704644032, -25665.57958125113, -25763.954565868127, -25446.306983019582, -25722.919963325443, -25501.036084131996, -25828.842520491533, -25901.25261620219, -25822.875830047342, -25599.110810399325, -25332.38893781996, -25702.585527102023, -25877.640263218895], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.404635040457659, "mean_inference_ms": 0.24696544190739872, "mean_action_processing_ms": 0.058729440470847064, "mean_env_wait_ms": 1.4609360847083002, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002413511276245117, "StateBufferConnector_ms": 0.0017418861389160156, "ViewRequirementAgentConnector_ms": 0.04450035095214844}}, "episode_reward_max": -25332.38893781996, "episode_reward_min": -26184.635395319758, "episode_reward_mean": -25747.537464576562, "episode_len_mean": 360.0, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-25510.290830657505, -25511.778369728654, -25812.90503700192, -25931.909280124957, -25860.461617755886, -25897.511315067466, -25792.746336386426, -25964.12300908346, -25634.24535731137, -25671.789190964275, -25518.673086091916, -25813.547403917546, -25526.71753209267, -25735.383906722796, -25801.119732630206, -25828.88528263503, -25831.823059561135, -25677.197986224346, -25687.04960455717, -26006.55309726376, -25695.4367463259, -25864.959502008885, -25787.11193002619, -25638.423404895515, -25581.237169707812, -25573.249009628562, -25905.690998452712, -26024.856504878888, -25706.668344990532, -25842.854540782766, -25728.393436948525, -25760.387993940018, -26184.635395319758, -25797.144567018688, -25948.060681634084, -25835.186169563676, -25866.614190566837, -25611.345078587674, -25479.25283061606, -25363.73074076344, -25887.061436977747, -25629.454968292463, -25640.349731648043, -25825.84153766307, -25920.300117916227, -25715.827265320084, -25781.78025677285, -25730.27264555775, -25943.576108077425, -25696.315924479346, -26015.101783501606, -25772.965387701348, -25639.14263189877, -25945.23576689735, -25776.46715704166, -25629.17291252169, -25824.38469927601, -25474.585936104304, -25738.491769587905, -25816.75142737078, -25633.590016855636, -25663.914401143084, -25809.1681167664, -25814.495198137734, -26013.12791246673, -25751.15506361066, -26024.23204956907, -25585.56141120515, -25803.91135088509, -25397.59529353382, -25689.83339877553, -25792.64632575422, -25762.25726873361, -25513.363584614537, -25654.386929504642, -25946.441046369913, -25736.046238825897, -25745.792221471816, -25757.18296566674, -25977.129950764425, -25760.824563126018, -25769.812329952805, -25641.00711604146, -25670.716394367177, -25748.631074546764, -25660.03871004826, -25727.09740035645, -25926.264704644032, -25665.57958125113, -25763.954565868127, -25446.306983019582, -25722.919963325443, -25501.036084131996, -25828.842520491533, -25901.25261620219, -25822.875830047342, -25599.110810399325, -25332.38893781996, -25702.585527102023, -25877.640263218895], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.404635040457659, "mean_inference_ms": 0.24696544190739872, "mean_action_processing_ms": 0.058729440470847064, "mean_env_wait_ms": 1.4609360847083002, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002413511276245117, "StateBufferConnector_ms": 0.0017418861389160156, "ViewRequirementAgentConnector_ms": 0.04450035095214844}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 143640, "num_agent_steps_trained": 143640, "num_env_steps_sampled": 143640, "num_env_steps_trained": 143640, "num_env_steps_sampled_this_iter": 1800, "num_env_steps_trained_this_iter": 1800, "num_env_steps_sampled_throughput_per_sec": 162.2279303535398, "num_env_steps_trained_throughput_per_sec": 162.2279303535398, "timesteps_total": 143640, "num_steps_trained_this_iter": 1800, "agent_timesteps_total": 143640, "timers": {"training_iteration_time_ms": 2211.571, "sample_time_ms": 2204.069, "load_time_ms": 0.214, "load_throughput": 1681270.95, "learn_time_ms": 6.695, "learn_throughput": 53772.362, "synch_weights_time_ms": 0.56}, "counters": {"num_env_steps_sampled": 143640, "num_env_steps_trained": 143640, "num_agent_steps_sampled": 143640, "num_agent_steps_trained": 143640}, "done": false, "episodes_total": 399, "training_iteration": 80, "trial_id": "f5e97_00000", "date": "2023-07-25_17-10-46", "timestamp": 1690294246, "time_this_iter_s": 11.097522974014282, "time_total_s": 891.8672623634338, "pid": 71917, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[0, 0.003], [5400, 0.001], [10800, 0.00075], [16200, 0.0005], [21600, 0.00025], [27000, 0.0001], [32400, 7.5e-05], [37800, 5e-05], [43200, 2.5e-05], [48600, 1e-05], [54000, 7.5e-06], [59400, 5e-06], [64800, 2.5e-06], [70200, 1e-06], [75600, 5e-07], [81000, 1e-07]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x304530310>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 891.8672623634338, "iterations_since_restore": 80, "perf": {"cpu_util_percent": 24.912499999999998, "ram_util_percent": 78.3375}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-07, "entropy_coeff": 0.1, "policy_entropy": -926.699853515625, "policy_loss": -11292305509580.8, "vf_loss": 1091874630.4}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 2018.0, "diff_num_grad_updates_vs_sampler_policy": 2017.0}}, "num_env_steps_sampled": 145440, "num_env_steps_trained": 145440, "num_agent_steps_sampled": 145440, "num_agent_steps_trained": 145440}, "sampler_results": {"episode_reward_max": -25332.38893781996, "episode_reward_min": -26184.635395319758, "episode_reward_mean": -25747.38619264433, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-25897.511315067466, -25792.746336386426, -25964.12300908346, -25634.24535731137, -25671.789190964275, -25518.673086091916, -25813.547403917546, -25526.71753209267, -25735.383906722796, -25801.119732630206, -25828.88528263503, -25831.823059561135, -25677.197986224346, -25687.04960455717, -26006.55309726376, -25695.4367463259, -25864.959502008885, -25787.11193002619, -25638.423404895515, -25581.237169707812, -25573.249009628562, -25905.690998452712, -26024.856504878888, -25706.668344990532, -25842.854540782766, -25728.393436948525, -25760.387993940018, -26184.635395319758, -25797.144567018688, -25948.060681634084, -25835.186169563676, -25866.614190566837, -25611.345078587674, -25479.25283061606, -25363.73074076344, -25887.061436977747, -25629.454968292463, -25640.349731648043, -25825.84153766307, -25920.300117916227, -25715.827265320084, -25781.78025677285, -25730.27264555775, -25943.576108077425, -25696.315924479346, -26015.101783501606, -25772.965387701348, -25639.14263189877, -25945.23576689735, -25776.46715704166, -25629.17291252169, -25824.38469927601, -25474.585936104304, -25738.491769587905, -25816.75142737078, -25633.590016855636, -25663.914401143084, -25809.1681167664, -25814.495198137734, -26013.12791246673, -25751.15506361066, -26024.23204956907, -25585.56141120515, -25803.91135088509, -25397.59529353382, -25689.83339877553, -25792.64632575422, -25762.25726873361, -25513.363584614537, -25654.386929504642, -25946.441046369913, -25736.046238825897, -25745.792221471816, -25757.18296566674, -25977.129950764425, -25760.824563126018, -25769.812329952805, -25641.00711604146, -25670.716394367177, -25748.631074546764, -25660.03871004826, -25727.09740035645, -25926.264704644032, -25665.57958125113, -25763.954565868127, -25446.306983019582, -25722.919963325443, -25501.036084131996, -25828.842520491533, -25901.25261620219, -25822.875830047342, -25599.110810399325, -25332.38893781996, -25702.585527102023, -25877.640263218895, -25670.29335235874, -25811.00160919924, -25738.87637535293, -25706.803192808555, -25685.243412325974], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.404400667616347, "mean_inference_ms": 0.24697624896268425, "mean_action_processing_ms": 0.05873098057703459, "mean_env_wait_ms": 1.460721386288459, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002420186996459961, "StateBufferConnector_ms": 0.001734018325805664, "ViewRequirementAgentConnector_ms": 0.04455828666687012}}, "episode_reward_max": -25332.38893781996, "episode_reward_min": -26184.635395319758, "episode_reward_mean": -25747.38619264433, "episode_len_mean": 360.0, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-25897.511315067466, -25792.746336386426, -25964.12300908346, -25634.24535731137, -25671.789190964275, -25518.673086091916, -25813.547403917546, -25526.71753209267, -25735.383906722796, -25801.119732630206, -25828.88528263503, -25831.823059561135, -25677.197986224346, -25687.04960455717, -26006.55309726376, -25695.4367463259, -25864.959502008885, -25787.11193002619, -25638.423404895515, -25581.237169707812, -25573.249009628562, -25905.690998452712, -26024.856504878888, -25706.668344990532, -25842.854540782766, -25728.393436948525, -25760.387993940018, -26184.635395319758, -25797.144567018688, -25948.060681634084, -25835.186169563676, -25866.614190566837, -25611.345078587674, -25479.25283061606, -25363.73074076344, -25887.061436977747, -25629.454968292463, -25640.349731648043, -25825.84153766307, -25920.300117916227, -25715.827265320084, -25781.78025677285, -25730.27264555775, -25943.576108077425, -25696.315924479346, -26015.101783501606, -25772.965387701348, -25639.14263189877, -25945.23576689735, -25776.46715704166, -25629.17291252169, -25824.38469927601, -25474.585936104304, -25738.491769587905, -25816.75142737078, -25633.590016855636, -25663.914401143084, -25809.1681167664, -25814.495198137734, -26013.12791246673, -25751.15506361066, -26024.23204956907, -25585.56141120515, -25803.91135088509, -25397.59529353382, -25689.83339877553, -25792.64632575422, -25762.25726873361, -25513.363584614537, -25654.386929504642, -25946.441046369913, -25736.046238825897, -25745.792221471816, -25757.18296566674, -25977.129950764425, -25760.824563126018, -25769.812329952805, -25641.00711604146, -25670.716394367177, -25748.631074546764, -25660.03871004826, -25727.09740035645, -25926.264704644032, -25665.57958125113, -25763.954565868127, -25446.306983019582, -25722.919963325443, -25501.036084131996, -25828.842520491533, -25901.25261620219, -25822.875830047342, -25599.110810399325, -25332.38893781996, -25702.585527102023, -25877.640263218895, -25670.29335235874, -25811.00160919924, -25738.87637535293, -25706.803192808555, -25685.243412325974], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.404400667616347, "mean_inference_ms": 0.24697624896268425, "mean_action_processing_ms": 0.05873098057703459, "mean_env_wait_ms": 1.460721386288459, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002420186996459961, "StateBufferConnector_ms": 0.001734018325805664, "ViewRequirementAgentConnector_ms": 0.04455828666687012}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 145440, "num_agent_steps_trained": 145440, "num_env_steps_sampled": 145440, "num_env_steps_trained": 145440, "num_env_steps_sampled_this_iter": 1800, "num_env_steps_trained_this_iter": 1800, "num_env_steps_sampled_throughput_per_sec": 161.13859950202024, "num_env_steps_trained_throughput_per_sec": 161.13859950202024, "timesteps_total": 145440, "num_steps_trained_this_iter": 1800, "agent_timesteps_total": 145440, "timers": {"training_iteration_time_ms": 2226.591, "sample_time_ms": 2219.2, "load_time_ms": 0.22, "load_throughput": 1633790.781, "learn_time_ms": 6.58, "learn_throughput": 54712.674, "synch_weights_time_ms": 0.558}, "counters": {"num_env_steps_sampled": 145440, "num_env_steps_trained": 145440, "num_agent_steps_sampled": 145440, "num_agent_steps_trained": 145440}, "done": false, "episodes_total": 404, "training_iteration": 81, "trial_id": "f5e97_00000", "date": "2023-07-25_17-10-57", "timestamp": 1690294257, "time_this_iter_s": 11.172504901885986, "time_total_s": 903.0397672653198, "pid": 71917, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[0, 0.003], [5400, 0.001], [10800, 0.00075], [16200, 0.0005], [21600, 0.00025], [27000, 0.0001], [32400, 7.5e-05], [37800, 5e-05], [43200, 2.5e-05], [48600, 1e-05], [54000, 7.5e-06], [59400, 5e-06], [64800, 2.5e-06], [70200, 1e-06], [75600, 5e-07], [81000, 1e-07]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x304530310>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 903.0397672653198, "iterations_since_restore": 81, "perf": {"cpu_util_percent": 26.2375, "ram_util_percent": 79.95625}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-07, "entropy_coeff": 0.1, "policy_entropy": -926.6999755859375, "policy_loss": -22098423678566.4, "vf_loss": 1091799232.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 2043.0, "diff_num_grad_updates_vs_sampler_policy": 2042.0}}, "num_env_steps_sampled": 147240, "num_env_steps_trained": 147240, "num_agent_steps_sampled": 147240, "num_agent_steps_trained": 147240}, "sampler_results": {"episode_reward_max": -25332.38893781996, "episode_reward_min": -26184.635395319758, "episode_reward_mean": -25737.32513531379, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-25518.673086091916, -25813.547403917546, -25526.71753209267, -25735.383906722796, -25801.119732630206, -25828.88528263503, -25831.823059561135, -25677.197986224346, -25687.04960455717, -26006.55309726376, -25695.4367463259, -25864.959502008885, -25787.11193002619, -25638.423404895515, -25581.237169707812, -25573.249009628562, -25905.690998452712, -26024.856504878888, -25706.668344990532, -25842.854540782766, -25728.393436948525, -25760.387993940018, -26184.635395319758, -25797.144567018688, -25948.060681634084, -25835.186169563676, -25866.614190566837, -25611.345078587674, -25479.25283061606, -25363.73074076344, -25887.061436977747, -25629.454968292463, -25640.349731648043, -25825.84153766307, -25920.300117916227, -25715.827265320084, -25781.78025677285, -25730.27264555775, -25943.576108077425, -25696.315924479346, -26015.101783501606, -25772.965387701348, -25639.14263189877, -25945.23576689735, -25776.46715704166, -25629.17291252169, -25824.38469927601, -25474.585936104304, -25738.491769587905, -25816.75142737078, -25633.590016855636, -25663.914401143084, -25809.1681167664, -25814.495198137734, -26013.12791246673, -25751.15506361066, -26024.23204956907, -25585.56141120515, -25803.91135088509, -25397.59529353382, -25689.83339877553, -25792.64632575422, -25762.25726873361, -25513.363584614537, -25654.386929504642, -25946.441046369913, -25736.046238825897, -25745.792221471816, -25757.18296566674, -25977.129950764425, -25760.824563126018, -25769.812329952805, -25641.00711604146, -25670.716394367177, -25748.631074546764, -25660.03871004826, -25727.09740035645, -25926.264704644032, -25665.57958125113, -25763.954565868127, -25446.306983019582, -25722.919963325443, -25501.036084131996, -25828.842520491533, -25901.25261620219, -25822.875830047342, -25599.110810399325, -25332.38893781996, -25702.585527102023, -25877.640263218895, -25670.29335235874, -25811.00160919924, -25738.87637535293, -25706.803192808555, -25685.243412325974, -25417.971821182156, -25354.848353986778, -25939.107425157636, -25574.779808877727, -25667.602066555202], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.404181575617246, "mean_inference_ms": 0.24698847726080378, "mean_action_processing_ms": 0.05873270460755244, "mean_env_wait_ms": 1.4605456215280899, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0024166107177734375, "StateBufferConnector_ms": 0.0017254352569580078, "ViewRequirementAgentConnector_ms": 0.04456281661987305}}, "episode_reward_max": -25332.38893781996, "episode_reward_min": -26184.635395319758, "episode_reward_mean": -25737.32513531379, "episode_len_mean": 360.0, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-25518.673086091916, -25813.547403917546, -25526.71753209267, -25735.383906722796, -25801.119732630206, -25828.88528263503, -25831.823059561135, -25677.197986224346, -25687.04960455717, -26006.55309726376, -25695.4367463259, -25864.959502008885, -25787.11193002619, -25638.423404895515, -25581.237169707812, -25573.249009628562, -25905.690998452712, -26024.856504878888, -25706.668344990532, -25842.854540782766, -25728.393436948525, -25760.387993940018, -26184.635395319758, -25797.144567018688, -25948.060681634084, -25835.186169563676, -25866.614190566837, -25611.345078587674, -25479.25283061606, -25363.73074076344, -25887.061436977747, -25629.454968292463, -25640.349731648043, -25825.84153766307, -25920.300117916227, -25715.827265320084, -25781.78025677285, -25730.27264555775, -25943.576108077425, -25696.315924479346, -26015.101783501606, -25772.965387701348, -25639.14263189877, -25945.23576689735, -25776.46715704166, -25629.17291252169, -25824.38469927601, -25474.585936104304, -25738.491769587905, -25816.75142737078, -25633.590016855636, -25663.914401143084, -25809.1681167664, -25814.495198137734, -26013.12791246673, -25751.15506361066, -26024.23204956907, -25585.56141120515, -25803.91135088509, -25397.59529353382, -25689.83339877553, -25792.64632575422, -25762.25726873361, -25513.363584614537, -25654.386929504642, -25946.441046369913, -25736.046238825897, -25745.792221471816, -25757.18296566674, -25977.129950764425, -25760.824563126018, -25769.812329952805, -25641.00711604146, -25670.716394367177, -25748.631074546764, -25660.03871004826, -25727.09740035645, -25926.264704644032, -25665.57958125113, -25763.954565868127, -25446.306983019582, -25722.919963325443, -25501.036084131996, -25828.842520491533, -25901.25261620219, -25822.875830047342, -25599.110810399325, -25332.38893781996, -25702.585527102023, -25877.640263218895, -25670.29335235874, -25811.00160919924, -25738.87637535293, -25706.803192808555, -25685.243412325974, -25417.971821182156, -25354.848353986778, -25939.107425157636, -25574.779808877727, -25667.602066555202], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.404181575617246, "mean_inference_ms": 0.24698847726080378, "mean_action_processing_ms": 0.05873270460755244, "mean_env_wait_ms": 1.4605456215280899, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0024166107177734375, "StateBufferConnector_ms": 0.0017254352569580078, "ViewRequirementAgentConnector_ms": 0.04456281661987305}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 147240, "num_agent_steps_trained": 147240, "num_env_steps_sampled": 147240, "num_env_steps_trained": 147240, "num_env_steps_sampled_this_iter": 1800, "num_env_steps_trained_this_iter": 1800, "num_env_steps_sampled_throughput_per_sec": 161.69256968422803, "num_env_steps_trained_throughput_per_sec": 161.69256968422803, "timesteps_total": 147240, "num_steps_trained_this_iter": 1800, "agent_timesteps_total": 147240, "timers": {"training_iteration_time_ms": 2230.265, "sample_time_ms": 2223.193, "load_time_ms": 0.224, "load_throughput": 1610612.736, "learn_time_ms": 6.292, "learn_throughput": 57211.308, "synch_weights_time_ms": 0.524}, "counters": {"num_env_steps_sampled": 147240, "num_env_steps_trained": 147240, "num_agent_steps_sampled": 147240, "num_agent_steps_trained": 147240}, "done": false, "episodes_total": 409, "training_iteration": 82, "trial_id": "f5e97_00000", "date": "2023-07-25_17-11-08", "timestamp": 1690294268, "time_this_iter_s": 11.134397983551025, "time_total_s": 914.1741652488708, "pid": 71917, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[0, 0.003], [5400, 0.001], [10800, 0.00075], [16200, 0.0005], [21600, 0.00025], [27000, 0.0001], [32400, 7.5e-05], [37800, 5e-05], [43200, 2.5e-05], [48600, 1e-05], [54000, 7.5e-06], [59400, 5e-06], [64800, 2.5e-06], [70200, 1e-06], [75600, 5e-07], [81000, 1e-07]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x304530310>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 914.1741652488708, "iterations_since_restore": 82, "perf": {"cpu_util_percent": 24.366666666666667, "ram_util_percent": 80.0}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-07, "entropy_coeff": 0.1, "policy_entropy": -926.6996826171875, "policy_loss": -23199111289241.6, "vf_loss": 1104867340.8}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 2068.0, "diff_num_grad_updates_vs_sampler_policy": 2067.0}}, "num_env_steps_sampled": 149040, "num_env_steps_trained": 149040, "num_agent_steps_sampled": 149040, "num_agent_steps_trained": 149040}, "sampler_results": {"episode_reward_max": -25332.38893781996, "episode_reward_min": -26184.635395319758, "episode_reward_mean": -25742.22157458239, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-25828.88528263503, -25831.823059561135, -25677.197986224346, -25687.04960455717, -26006.55309726376, -25695.4367463259, -25864.959502008885, -25787.11193002619, -25638.423404895515, -25581.237169707812, -25573.249009628562, -25905.690998452712, -26024.856504878888, -25706.668344990532, -25842.854540782766, -25728.393436948525, -25760.387993940018, -26184.635395319758, -25797.144567018688, -25948.060681634084, -25835.186169563676, -25866.614190566837, -25611.345078587674, -25479.25283061606, -25363.73074076344, -25887.061436977747, -25629.454968292463, -25640.349731648043, -25825.84153766307, -25920.300117916227, -25715.827265320084, -25781.78025677285, -25730.27264555775, -25943.576108077425, -25696.315924479346, -26015.101783501606, -25772.965387701348, -25639.14263189877, -25945.23576689735, -25776.46715704166, -25629.17291252169, -25824.38469927601, -25474.585936104304, -25738.491769587905, -25816.75142737078, -25633.590016855636, -25663.914401143084, -25809.1681167664, -25814.495198137734, -26013.12791246673, -25751.15506361066, -26024.23204956907, -25585.56141120515, -25803.91135088509, -25397.59529353382, -25689.83339877553, -25792.64632575422, -25762.25726873361, -25513.363584614537, -25654.386929504642, -25946.441046369913, -25736.046238825897, -25745.792221471816, -25757.18296566674, -25977.129950764425, -25760.824563126018, -25769.812329952805, -25641.00711604146, -25670.716394367177, -25748.631074546764, -25660.03871004826, -25727.09740035645, -25926.264704644032, -25665.57958125113, -25763.954565868127, -25446.306983019582, -25722.919963325443, -25501.036084131996, -25828.842520491533, -25901.25261620219, -25822.875830047342, -25599.110810399325, -25332.38893781996, -25702.585527102023, -25877.640263218895, -25670.29335235874, -25811.00160919924, -25738.87637535293, -25706.803192808555, -25685.243412325974, -25417.971821182156, -25354.848353986778, -25939.107425157636, -25574.779808877727, -25667.602066555202, -25467.080325284947, -25680.299637230575, -25940.706903617378, -25979.154482656842, -25817.84423952501], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.403950797849478, "mean_inference_ms": 0.2470022612169672, "mean_action_processing_ms": 0.058734719208498, "mean_env_wait_ms": 1.460380038175867, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002411365509033203, "StateBufferConnector_ms": 0.001729726791381836, "ViewRequirementAgentConnector_ms": 0.04441571235656738}}, "episode_reward_max": -25332.38893781996, "episode_reward_min": -26184.635395319758, "episode_reward_mean": -25742.22157458239, "episode_len_mean": 360.0, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-25828.88528263503, -25831.823059561135, -25677.197986224346, -25687.04960455717, -26006.55309726376, -25695.4367463259, -25864.959502008885, -25787.11193002619, -25638.423404895515, -25581.237169707812, -25573.249009628562, -25905.690998452712, -26024.856504878888, -25706.668344990532, -25842.854540782766, -25728.393436948525, -25760.387993940018, -26184.635395319758, -25797.144567018688, -25948.060681634084, -25835.186169563676, -25866.614190566837, -25611.345078587674, -25479.25283061606, -25363.73074076344, -25887.061436977747, -25629.454968292463, -25640.349731648043, -25825.84153766307, -25920.300117916227, -25715.827265320084, -25781.78025677285, -25730.27264555775, -25943.576108077425, -25696.315924479346, -26015.101783501606, -25772.965387701348, -25639.14263189877, -25945.23576689735, -25776.46715704166, -25629.17291252169, -25824.38469927601, -25474.585936104304, -25738.491769587905, -25816.75142737078, -25633.590016855636, -25663.914401143084, -25809.1681167664, -25814.495198137734, -26013.12791246673, -25751.15506361066, -26024.23204956907, -25585.56141120515, -25803.91135088509, -25397.59529353382, -25689.83339877553, -25792.64632575422, -25762.25726873361, -25513.363584614537, -25654.386929504642, -25946.441046369913, -25736.046238825897, -25745.792221471816, -25757.18296566674, -25977.129950764425, -25760.824563126018, -25769.812329952805, -25641.00711604146, -25670.716394367177, -25748.631074546764, -25660.03871004826, -25727.09740035645, -25926.264704644032, -25665.57958125113, -25763.954565868127, -25446.306983019582, -25722.919963325443, -25501.036084131996, -25828.842520491533, -25901.25261620219, -25822.875830047342, -25599.110810399325, -25332.38893781996, -25702.585527102023, -25877.640263218895, -25670.29335235874, -25811.00160919924, -25738.87637535293, -25706.803192808555, -25685.243412325974, -25417.971821182156, -25354.848353986778, -25939.107425157636, -25574.779808877727, -25667.602066555202, -25467.080325284947, -25680.299637230575, -25940.706903617378, -25979.154482656842, -25817.84423952501], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.403950797849478, "mean_inference_ms": 0.2470022612169672, "mean_action_processing_ms": 0.058734719208498, "mean_env_wait_ms": 1.460380038175867, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002411365509033203, "StateBufferConnector_ms": 0.001729726791381836, "ViewRequirementAgentConnector_ms": 0.04441571235656738}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 149040, "num_agent_steps_trained": 149040, "num_env_steps_sampled": 149040, "num_env_steps_trained": 149040, "num_env_steps_sampled_this_iter": 1800, "num_env_steps_trained_this_iter": 1800, "num_env_steps_sampled_throughput_per_sec": 161.41184808194933, "num_env_steps_trained_throughput_per_sec": 161.41184808194933, "timesteps_total": 149040, "num_steps_trained_this_iter": 1800, "agent_timesteps_total": 149040, "timers": {"training_iteration_time_ms": 2228.374, "sample_time_ms": 2221.158, "load_time_ms": 0.218, "load_throughput": 1649857.343, "learn_time_ms": 6.437, "learn_throughput": 55930.061, "synch_weights_time_ms": 0.529}, "counters": {"num_env_steps_sampled": 149040, "num_env_steps_trained": 149040, "num_agent_steps_sampled": 149040, "num_agent_steps_trained": 149040}, "done": false, "episodes_total": 414, "training_iteration": 83, "trial_id": "f5e97_00000", "date": "2023-07-25_17-11-20", "timestamp": 1690294280, "time_this_iter_s": 11.153621912002563, "time_total_s": 925.3277871608734, "pid": 71917, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[0, 0.003], [5400, 0.001], [10800, 0.00075], [16200, 0.0005], [21600, 0.00025], [27000, 0.0001], [32400, 7.5e-05], [37800, 5e-05], [43200, 2.5e-05], [48600, 1e-05], [54000, 7.5e-06], [59400, 5e-06], [64800, 2.5e-06], [70200, 1e-06], [75600, 5e-07], [81000, 1e-07]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x304530310>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 925.3277871608734, "iterations_since_restore": 83, "perf": {"cpu_util_percent": 23.19375, "ram_util_percent": 80.08125000000001}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-07, "entropy_coeff": 0.1, "policy_entropy": -926.6998657226562, "policy_loss": -16051182816460.8, "vf_loss": 1095143916.8}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 2093.0, "diff_num_grad_updates_vs_sampler_policy": 2092.0}}, "num_env_steps_sampled": 150840, "num_env_steps_trained": 150840, "num_agent_steps_sampled": 150840, "num_agent_steps_trained": 150840}, "sampler_results": {"episode_reward_max": -25332.38893781996, "episode_reward_min": -26184.635395319758, "episode_reward_mean": -25733.66353565643, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-25695.4367463259, -25864.959502008885, -25787.11193002619, -25638.423404895515, -25581.237169707812, -25573.249009628562, -25905.690998452712, -26024.856504878888, -25706.668344990532, -25842.854540782766, -25728.393436948525, -25760.387993940018, -26184.635395319758, -25797.144567018688, -25948.060681634084, -25835.186169563676, -25866.614190566837, -25611.345078587674, -25479.25283061606, -25363.73074076344, -25887.061436977747, -25629.454968292463, -25640.349731648043, -25825.84153766307, -25920.300117916227, -25715.827265320084, -25781.78025677285, -25730.27264555775, -25943.576108077425, -25696.315924479346, -26015.101783501606, -25772.965387701348, -25639.14263189877, -25945.23576689735, -25776.46715704166, -25629.17291252169, -25824.38469927601, -25474.585936104304, -25738.491769587905, -25816.75142737078, -25633.590016855636, -25663.914401143084, -25809.1681167664, -25814.495198137734, -26013.12791246673, -25751.15506361066, -26024.23204956907, -25585.56141120515, -25803.91135088509, -25397.59529353382, -25689.83339877553, -25792.64632575422, -25762.25726873361, -25513.363584614537, -25654.386929504642, -25946.441046369913, -25736.046238825897, -25745.792221471816, -25757.18296566674, -25977.129950764425, -25760.824563126018, -25769.812329952805, -25641.00711604146, -25670.716394367177, -25748.631074546764, -25660.03871004826, -25727.09740035645, -25926.264704644032, -25665.57958125113, -25763.954565868127, -25446.306983019582, -25722.919963325443, -25501.036084131996, -25828.842520491533, -25901.25261620219, -25822.875830047342, -25599.110810399325, -25332.38893781996, -25702.585527102023, -25877.640263218895, -25670.29335235874, -25811.00160919924, -25738.87637535293, -25706.803192808555, -25685.243412325974, -25417.971821182156, -25354.848353986778, -25939.107425157636, -25574.779808877727, -25667.602066555202, -25467.080325284947, -25680.299637230575, -25940.706903617378, -25979.154482656842, -25817.84423952501, -25611.069215305495, -25447.410392182308, -25592.70170342282, -25779.69322995973, -25744.830596774704], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.403721872996232, "mean_inference_ms": 0.24701407614648677, "mean_action_processing_ms": 0.058736513428788086, "mean_env_wait_ms": 1.4602193273940172, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0024039745330810547, "StateBufferConnector_ms": 0.0017282962799072266, "ViewRequirementAgentConnector_ms": 0.044409751892089844}}, "episode_reward_max": -25332.38893781996, "episode_reward_min": -26184.635395319758, "episode_reward_mean": -25733.66353565643, "episode_len_mean": 360.0, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-25695.4367463259, -25864.959502008885, -25787.11193002619, -25638.423404895515, -25581.237169707812, -25573.249009628562, -25905.690998452712, -26024.856504878888, -25706.668344990532, -25842.854540782766, -25728.393436948525, -25760.387993940018, -26184.635395319758, -25797.144567018688, -25948.060681634084, -25835.186169563676, -25866.614190566837, -25611.345078587674, -25479.25283061606, -25363.73074076344, -25887.061436977747, -25629.454968292463, -25640.349731648043, -25825.84153766307, -25920.300117916227, -25715.827265320084, -25781.78025677285, -25730.27264555775, -25943.576108077425, -25696.315924479346, -26015.101783501606, -25772.965387701348, -25639.14263189877, -25945.23576689735, -25776.46715704166, -25629.17291252169, -25824.38469927601, -25474.585936104304, -25738.491769587905, -25816.75142737078, -25633.590016855636, -25663.914401143084, -25809.1681167664, -25814.495198137734, -26013.12791246673, -25751.15506361066, -26024.23204956907, -25585.56141120515, -25803.91135088509, -25397.59529353382, -25689.83339877553, -25792.64632575422, -25762.25726873361, -25513.363584614537, -25654.386929504642, -25946.441046369913, -25736.046238825897, -25745.792221471816, -25757.18296566674, -25977.129950764425, -25760.824563126018, -25769.812329952805, -25641.00711604146, -25670.716394367177, -25748.631074546764, -25660.03871004826, -25727.09740035645, -25926.264704644032, -25665.57958125113, -25763.954565868127, -25446.306983019582, -25722.919963325443, -25501.036084131996, -25828.842520491533, -25901.25261620219, -25822.875830047342, -25599.110810399325, -25332.38893781996, -25702.585527102023, -25877.640263218895, -25670.29335235874, -25811.00160919924, -25738.87637535293, -25706.803192808555, -25685.243412325974, -25417.971821182156, -25354.848353986778, -25939.107425157636, -25574.779808877727, -25667.602066555202, -25467.080325284947, -25680.299637230575, -25940.706903617378, -25979.154482656842, -25817.84423952501, -25611.069215305495, -25447.410392182308, -25592.70170342282, -25779.69322995973, -25744.830596774704], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.403721872996232, "mean_inference_ms": 0.24701407614648677, "mean_action_processing_ms": 0.058736513428788086, "mean_env_wait_ms": 1.4602193273940172, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0024039745330810547, "StateBufferConnector_ms": 0.0017282962799072266, "ViewRequirementAgentConnector_ms": 0.044409751892089844}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 150840, "num_agent_steps_trained": 150840, "num_env_steps_sampled": 150840, "num_env_steps_trained": 150840, "num_env_steps_sampled_this_iter": 1800, "num_env_steps_trained_this_iter": 1800, "num_env_steps_sampled_throughput_per_sec": 162.1777066625606, "num_env_steps_trained_throughput_per_sec": 162.1777066625606, "timesteps_total": 150840, "num_steps_trained_this_iter": 1800, "agent_timesteps_total": 150840, "timers": {"training_iteration_time_ms": 2225.044, "sample_time_ms": 2217.882, "load_time_ms": 0.215, "load_throughput": 1673074.172, "learn_time_ms": 6.387, "learn_throughput": 56362.849, "synch_weights_time_ms": 0.527}, "counters": {"num_env_steps_sampled": 150840, "num_env_steps_trained": 150840, "num_agent_steps_sampled": 150840, "num_agent_steps_trained": 150840}, "done": false, "episodes_total": 419, "training_iteration": 84, "trial_id": "f5e97_00000", "date": "2023-07-25_17-11-31", "timestamp": 1690294291, "time_this_iter_s": 11.10096788406372, "time_total_s": 936.4287550449371, "pid": 71917, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[0, 0.003], [5400, 0.001], [10800, 0.00075], [16200, 0.0005], [21600, 0.00025], [27000, 0.0001], [32400, 7.5e-05], [37800, 5e-05], [43200, 2.5e-05], [48600, 1e-05], [54000, 7.5e-06], [59400, 5e-06], [64800, 2.5e-06], [70200, 1e-06], [75600, 5e-07], [81000, 1e-07]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x304530310>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 936.4287550449371, "iterations_since_restore": 84, "perf": {"cpu_util_percent": 22.674999999999997, "ram_util_percent": 80.175}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-07, "entropy_coeff": 0.1, "policy_entropy": -926.6998168945313, "policy_loss": -29332148466483.2, "vf_loss": 1089049523.2}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 2118.0, "diff_num_grad_updates_vs_sampler_policy": 2117.0}}, "num_env_steps_sampled": 152640, "num_env_steps_trained": 152640, "num_agent_steps_sampled": 152640, "num_agent_steps_trained": 152640}, "sampler_results": {"episode_reward_max": -25332.38893781996, "episode_reward_min": -26184.635395319758, "episode_reward_mean": -25743.976828580635, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-25573.249009628562, -25905.690998452712, -26024.856504878888, -25706.668344990532, -25842.854540782766, -25728.393436948525, -25760.387993940018, -26184.635395319758, -25797.144567018688, -25948.060681634084, -25835.186169563676, -25866.614190566837, -25611.345078587674, -25479.25283061606, -25363.73074076344, -25887.061436977747, -25629.454968292463, -25640.349731648043, -25825.84153766307, -25920.300117916227, -25715.827265320084, -25781.78025677285, -25730.27264555775, -25943.576108077425, -25696.315924479346, -26015.101783501606, -25772.965387701348, -25639.14263189877, -25945.23576689735, -25776.46715704166, -25629.17291252169, -25824.38469927601, -25474.585936104304, -25738.491769587905, -25816.75142737078, -25633.590016855636, -25663.914401143084, -25809.1681167664, -25814.495198137734, -26013.12791246673, -25751.15506361066, -26024.23204956907, -25585.56141120515, -25803.91135088509, -25397.59529353382, -25689.83339877553, -25792.64632575422, -25762.25726873361, -25513.363584614537, -25654.386929504642, -25946.441046369913, -25736.046238825897, -25745.792221471816, -25757.18296566674, -25977.129950764425, -25760.824563126018, -25769.812329952805, -25641.00711604146, -25670.716394367177, -25748.631074546764, -25660.03871004826, -25727.09740035645, -25926.264704644032, -25665.57958125113, -25763.954565868127, -25446.306983019582, -25722.919963325443, -25501.036084131996, -25828.842520491533, -25901.25261620219, -25822.875830047342, -25599.110810399325, -25332.38893781996, -25702.585527102023, -25877.640263218895, -25670.29335235874, -25811.00160919924, -25738.87637535293, -25706.803192808555, -25685.243412325974, -25417.971821182156, -25354.848353986778, -25939.107425157636, -25574.779808877727, -25667.602066555202, -25467.080325284947, -25680.299637230575, -25940.706903617378, -25979.154482656842, -25817.84423952501, -25611.069215305495, -25447.410392182308, -25592.70170342282, -25779.69322995973, -25744.830596774704, -26108.241970624844, -25864.90503722851, -25950.90009105484, -26014.647527882316, -25659.80341859398], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.403552888644939, "mean_inference_ms": 0.2470223885656716, "mean_action_processing_ms": 0.05873785566742283, "mean_env_wait_ms": 1.4600236342257233, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0023932456970214844, "StateBufferConnector_ms": 0.0017232894897460938, "ViewRequirementAgentConnector_ms": 0.04439258575439453}}, "episode_reward_max": -25332.38893781996, "episode_reward_min": -26184.635395319758, "episode_reward_mean": -25743.976828580635, "episode_len_mean": 360.0, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-25573.249009628562, -25905.690998452712, -26024.856504878888, -25706.668344990532, -25842.854540782766, -25728.393436948525, -25760.387993940018, -26184.635395319758, -25797.144567018688, -25948.060681634084, -25835.186169563676, -25866.614190566837, -25611.345078587674, -25479.25283061606, -25363.73074076344, -25887.061436977747, -25629.454968292463, -25640.349731648043, -25825.84153766307, -25920.300117916227, -25715.827265320084, -25781.78025677285, -25730.27264555775, -25943.576108077425, -25696.315924479346, -26015.101783501606, -25772.965387701348, -25639.14263189877, -25945.23576689735, -25776.46715704166, -25629.17291252169, -25824.38469927601, -25474.585936104304, -25738.491769587905, -25816.75142737078, -25633.590016855636, -25663.914401143084, -25809.1681167664, -25814.495198137734, -26013.12791246673, -25751.15506361066, -26024.23204956907, -25585.56141120515, -25803.91135088509, -25397.59529353382, -25689.83339877553, -25792.64632575422, -25762.25726873361, -25513.363584614537, -25654.386929504642, -25946.441046369913, -25736.046238825897, -25745.792221471816, -25757.18296566674, -25977.129950764425, -25760.824563126018, -25769.812329952805, -25641.00711604146, -25670.716394367177, -25748.631074546764, -25660.03871004826, -25727.09740035645, -25926.264704644032, -25665.57958125113, -25763.954565868127, -25446.306983019582, -25722.919963325443, -25501.036084131996, -25828.842520491533, -25901.25261620219, -25822.875830047342, -25599.110810399325, -25332.38893781996, -25702.585527102023, -25877.640263218895, -25670.29335235874, -25811.00160919924, -25738.87637535293, -25706.803192808555, -25685.243412325974, -25417.971821182156, -25354.848353986778, -25939.107425157636, -25574.779808877727, -25667.602066555202, -25467.080325284947, -25680.299637230575, -25940.706903617378, -25979.154482656842, -25817.84423952501, -25611.069215305495, -25447.410392182308, -25592.70170342282, -25779.69322995973, -25744.830596774704, -26108.241970624844, -25864.90503722851, -25950.90009105484, -26014.647527882316, -25659.80341859398], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.403552888644939, "mean_inference_ms": 0.2470223885656716, "mean_action_processing_ms": 0.05873785566742283, "mean_env_wait_ms": 1.4600236342257233, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0023932456970214844, "StateBufferConnector_ms": 0.0017232894897460938, "ViewRequirementAgentConnector_ms": 0.04439258575439453}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 152640, "num_agent_steps_trained": 152640, "num_env_steps_sampled": 152640, "num_env_steps_trained": 152640, "num_env_steps_sampled_this_iter": 1800, "num_env_steps_trained_this_iter": 1800, "num_env_steps_sampled_throughput_per_sec": 161.57747009876695, "num_env_steps_trained_throughput_per_sec": 161.57747009876695, "timesteps_total": 152640, "num_steps_trained_this_iter": 1800, "agent_timesteps_total": 152640, "timers": {"training_iteration_time_ms": 2223.901, "sample_time_ms": 2216.852, "load_time_ms": 0.215, "load_throughput": 1673259.574, "learn_time_ms": 6.301, "learn_throughput": 57138.133, "synch_weights_time_ms": 0.501}, "counters": {"num_env_steps_sampled": 152640, "num_env_steps_trained": 152640, "num_agent_steps_sampled": 152640, "num_agent_steps_trained": 152640}, "done": false, "episodes_total": 424, "training_iteration": 85, "trial_id": "f5e97_00000", "date": "2023-07-25_17-11-42", "timestamp": 1690294302, "time_this_iter_s": 11.142327070236206, "time_total_s": 947.5710821151733, "pid": 71917, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[0, 0.003], [5400, 0.001], [10800, 0.00075], [16200, 0.0005], [21600, 0.00025], [27000, 0.0001], [32400, 7.5e-05], [37800, 5e-05], [43200, 2.5e-05], [48600, 1e-05], [54000, 7.5e-06], [59400, 5e-06], [64800, 2.5e-06], [70200, 1e-06], [75600, 5e-07], [81000, 1e-07]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x304530310>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 947.5710821151733, "iterations_since_restore": 85, "perf": {"cpu_util_percent": 24.65625, "ram_util_percent": 79.89375}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-07, "entropy_coeff": 0.1, "policy_entropy": -926.7000854492187, "policy_loss": -26368102078054.4, "vf_loss": 1087887116.8}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 2143.0, "diff_num_grad_updates_vs_sampler_policy": 2142.0}}, "num_env_steps_sampled": 154440, "num_env_steps_trained": 154440, "num_agent_steps_sampled": 154440, "num_agent_steps_trained": 154440}, "sampler_results": {"episode_reward_max": -25332.38893781996, "episode_reward_min": -26184.635395319758, "episode_reward_mean": -25738.40318690787, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-25728.393436948525, -25760.387993940018, -26184.635395319758, -25797.144567018688, -25948.060681634084, -25835.186169563676, -25866.614190566837, -25611.345078587674, -25479.25283061606, -25363.73074076344, -25887.061436977747, -25629.454968292463, -25640.349731648043, -25825.84153766307, -25920.300117916227, -25715.827265320084, -25781.78025677285, -25730.27264555775, -25943.576108077425, -25696.315924479346, -26015.101783501606, -25772.965387701348, -25639.14263189877, -25945.23576689735, -25776.46715704166, -25629.17291252169, -25824.38469927601, -25474.585936104304, -25738.491769587905, -25816.75142737078, -25633.590016855636, -25663.914401143084, -25809.1681167664, -25814.495198137734, -26013.12791246673, -25751.15506361066, -26024.23204956907, -25585.56141120515, -25803.91135088509, -25397.59529353382, -25689.83339877553, -25792.64632575422, -25762.25726873361, -25513.363584614537, -25654.386929504642, -25946.441046369913, -25736.046238825897, -25745.792221471816, -25757.18296566674, -25977.129950764425, -25760.824563126018, -25769.812329952805, -25641.00711604146, -25670.716394367177, -25748.631074546764, -25660.03871004826, -25727.09740035645, -25926.264704644032, -25665.57958125113, -25763.954565868127, -25446.306983019582, -25722.919963325443, -25501.036084131996, -25828.842520491533, -25901.25261620219, -25822.875830047342, -25599.110810399325, -25332.38893781996, -25702.585527102023, -25877.640263218895, -25670.29335235874, -25811.00160919924, -25738.87637535293, -25706.803192808555, -25685.243412325974, -25417.971821182156, -25354.848353986778, -25939.107425157636, -25574.779808877727, -25667.602066555202, -25467.080325284947, -25680.299637230575, -25940.706903617378, -25979.154482656842, -25817.84423952501, -25611.069215305495, -25447.410392182308, -25592.70170342282, -25779.69322995973, -25744.830596774704, -26108.241970624844, -25864.90503722851, -25950.90009105484, -26014.647527882316, -25659.80341859398, -25997.67723298258, -25624.324028795298, -25911.37404977576, -25351.166906271006, -25611.41301363248], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.403399777817614, "mean_inference_ms": 0.24703032813609943, "mean_action_processing_ms": 0.058738875615070546, "mean_env_wait_ms": 1.4598480952295474, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0023887157440185547, "StateBufferConnector_ms": 0.0017211437225341797, "ViewRequirementAgentConnector_ms": 0.04415726661682129}}, "episode_reward_max": -25332.38893781996, "episode_reward_min": -26184.635395319758, "episode_reward_mean": -25738.40318690787, "episode_len_mean": 360.0, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-25728.393436948525, -25760.387993940018, -26184.635395319758, -25797.144567018688, -25948.060681634084, -25835.186169563676, -25866.614190566837, -25611.345078587674, -25479.25283061606, -25363.73074076344, -25887.061436977747, -25629.454968292463, -25640.349731648043, -25825.84153766307, -25920.300117916227, -25715.827265320084, -25781.78025677285, -25730.27264555775, -25943.576108077425, -25696.315924479346, -26015.101783501606, -25772.965387701348, -25639.14263189877, -25945.23576689735, -25776.46715704166, -25629.17291252169, -25824.38469927601, -25474.585936104304, -25738.491769587905, -25816.75142737078, -25633.590016855636, -25663.914401143084, -25809.1681167664, -25814.495198137734, -26013.12791246673, -25751.15506361066, -26024.23204956907, -25585.56141120515, -25803.91135088509, -25397.59529353382, -25689.83339877553, -25792.64632575422, -25762.25726873361, -25513.363584614537, -25654.386929504642, -25946.441046369913, -25736.046238825897, -25745.792221471816, -25757.18296566674, -25977.129950764425, -25760.824563126018, -25769.812329952805, -25641.00711604146, -25670.716394367177, -25748.631074546764, -25660.03871004826, -25727.09740035645, -25926.264704644032, -25665.57958125113, -25763.954565868127, -25446.306983019582, -25722.919963325443, -25501.036084131996, -25828.842520491533, -25901.25261620219, -25822.875830047342, -25599.110810399325, -25332.38893781996, -25702.585527102023, -25877.640263218895, -25670.29335235874, -25811.00160919924, -25738.87637535293, -25706.803192808555, -25685.243412325974, -25417.971821182156, -25354.848353986778, -25939.107425157636, -25574.779808877727, -25667.602066555202, -25467.080325284947, -25680.299637230575, -25940.706903617378, -25979.154482656842, -25817.84423952501, -25611.069215305495, -25447.410392182308, -25592.70170342282, -25779.69322995973, -25744.830596774704, -26108.241970624844, -25864.90503722851, -25950.90009105484, -26014.647527882316, -25659.80341859398, -25997.67723298258, -25624.324028795298, -25911.37404977576, -25351.166906271006, -25611.41301363248], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.403399777817614, "mean_inference_ms": 0.24703032813609943, "mean_action_processing_ms": 0.058738875615070546, "mean_env_wait_ms": 1.4598480952295474, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0023887157440185547, "StateBufferConnector_ms": 0.0017211437225341797, "ViewRequirementAgentConnector_ms": 0.04415726661682129}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 154440, "num_agent_steps_trained": 154440, "num_env_steps_sampled": 154440, "num_env_steps_trained": 154440, "num_env_steps_sampled_this_iter": 1800, "num_env_steps_trained_this_iter": 1800, "num_env_steps_sampled_throughput_per_sec": 161.03675822279087, "num_env_steps_trained_throughput_per_sec": 161.03675822279087, "timesteps_total": 154440, "num_steps_trained_this_iter": 1800, "agent_timesteps_total": 154440, "timers": {"training_iteration_time_ms": 2231.764, "sample_time_ms": 2224.628, "load_time_ms": 0.22, "load_throughput": 1633083.971, "learn_time_ms": 6.364, "learn_throughput": 56564.065, "synch_weights_time_ms": 0.519}, "counters": {"num_env_steps_sampled": 154440, "num_env_steps_trained": 154440, "num_agent_steps_sampled": 154440, "num_agent_steps_trained": 154440}, "done": false, "episodes_total": 429, "training_iteration": 86, "trial_id": "f5e97_00000", "date": "2023-07-25_17-11-53", "timestamp": 1690294313, "time_this_iter_s": 11.179535865783691, "time_total_s": 958.750617980957, "pid": 71917, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[0, 0.003], [5400, 0.001], [10800, 0.00075], [16200, 0.0005], [21600, 0.00025], [27000, 0.0001], [32400, 7.5e-05], [37800, 5e-05], [43200, 2.5e-05], [48600, 1e-05], [54000, 7.5e-06], [59400, 5e-06], [64800, 2.5e-06], [70200, 1e-06], [75600, 5e-07], [81000, 1e-07]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x304530310>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 958.750617980957, "iterations_since_restore": 86, "perf": {"cpu_util_percent": 24.15, "ram_util_percent": 79.69375}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-07, "entropy_coeff": 0.1, "policy_entropy": -926.7000244140625, "policy_loss": -20198662956646.4, "vf_loss": 1099317376.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 2168.0, "diff_num_grad_updates_vs_sampler_policy": 2167.0}}, "num_env_steps_sampled": 156240, "num_env_steps_trained": 156240, "num_agent_steps_sampled": 156240, "num_agent_steps_trained": 156240}, "sampler_results": {"episode_reward_max": -25332.38893781996, "episode_reward_min": -26108.241970624844, "episode_reward_mean": -25729.019311609627, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-25835.186169563676, -25866.614190566837, -25611.345078587674, -25479.25283061606, -25363.73074076344, -25887.061436977747, -25629.454968292463, -25640.349731648043, -25825.84153766307, -25920.300117916227, -25715.827265320084, -25781.78025677285, -25730.27264555775, -25943.576108077425, -25696.315924479346, -26015.101783501606, -25772.965387701348, -25639.14263189877, -25945.23576689735, -25776.46715704166, -25629.17291252169, -25824.38469927601, -25474.585936104304, -25738.491769587905, -25816.75142737078, -25633.590016855636, -25663.914401143084, -25809.1681167664, -25814.495198137734, -26013.12791246673, -25751.15506361066, -26024.23204956907, -25585.56141120515, -25803.91135088509, -25397.59529353382, -25689.83339877553, -25792.64632575422, -25762.25726873361, -25513.363584614537, -25654.386929504642, -25946.441046369913, -25736.046238825897, -25745.792221471816, -25757.18296566674, -25977.129950764425, -25760.824563126018, -25769.812329952805, -25641.00711604146, -25670.716394367177, -25748.631074546764, -25660.03871004826, -25727.09740035645, -25926.264704644032, -25665.57958125113, -25763.954565868127, -25446.306983019582, -25722.919963325443, -25501.036084131996, -25828.842520491533, -25901.25261620219, -25822.875830047342, -25599.110810399325, -25332.38893781996, -25702.585527102023, -25877.640263218895, -25670.29335235874, -25811.00160919924, -25738.87637535293, -25706.803192808555, -25685.243412325974, -25417.971821182156, -25354.848353986778, -25939.107425157636, -25574.779808877727, -25667.602066555202, -25467.080325284947, -25680.299637230575, -25940.706903617378, -25979.154482656842, -25817.84423952501, -25611.069215305495, -25447.410392182308, -25592.70170342282, -25779.69322995973, -25744.830596774704, -26108.241970624844, -25864.90503722851, -25950.90009105484, -26014.647527882316, -25659.80341859398, -25997.67723298258, -25624.324028795298, -25911.37404977576, -25351.166906271006, -25611.41301363248, -25617.64346628109, -25548.094996977878, -26045.118213784343, -25564.877830007805, -25704.500037985872], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.403228464433553, "mean_inference_ms": 0.24703681786897852, "mean_action_processing_ms": 0.058739695420993526, "mean_env_wait_ms": 1.4596972194304374, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0023717880249023438, "StateBufferConnector_ms": 0.0017173290252685547, "ViewRequirementAgentConnector_ms": 0.04398369789123535}}, "episode_reward_max": -25332.38893781996, "episode_reward_min": -26108.241970624844, "episode_reward_mean": -25729.019311609627, "episode_len_mean": 360.0, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-25835.186169563676, -25866.614190566837, -25611.345078587674, -25479.25283061606, -25363.73074076344, -25887.061436977747, -25629.454968292463, -25640.349731648043, -25825.84153766307, -25920.300117916227, -25715.827265320084, -25781.78025677285, -25730.27264555775, -25943.576108077425, -25696.315924479346, -26015.101783501606, -25772.965387701348, -25639.14263189877, -25945.23576689735, -25776.46715704166, -25629.17291252169, -25824.38469927601, -25474.585936104304, -25738.491769587905, -25816.75142737078, -25633.590016855636, -25663.914401143084, -25809.1681167664, -25814.495198137734, -26013.12791246673, -25751.15506361066, -26024.23204956907, -25585.56141120515, -25803.91135088509, -25397.59529353382, -25689.83339877553, -25792.64632575422, -25762.25726873361, -25513.363584614537, -25654.386929504642, -25946.441046369913, -25736.046238825897, -25745.792221471816, -25757.18296566674, -25977.129950764425, -25760.824563126018, -25769.812329952805, -25641.00711604146, -25670.716394367177, -25748.631074546764, -25660.03871004826, -25727.09740035645, -25926.264704644032, -25665.57958125113, -25763.954565868127, -25446.306983019582, -25722.919963325443, -25501.036084131996, -25828.842520491533, -25901.25261620219, -25822.875830047342, -25599.110810399325, -25332.38893781996, -25702.585527102023, -25877.640263218895, -25670.29335235874, -25811.00160919924, -25738.87637535293, -25706.803192808555, -25685.243412325974, -25417.971821182156, -25354.848353986778, -25939.107425157636, -25574.779808877727, -25667.602066555202, -25467.080325284947, -25680.299637230575, -25940.706903617378, -25979.154482656842, -25817.84423952501, -25611.069215305495, -25447.410392182308, -25592.70170342282, -25779.69322995973, -25744.830596774704, -26108.241970624844, -25864.90503722851, -25950.90009105484, -26014.647527882316, -25659.80341859398, -25997.67723298258, -25624.324028795298, -25911.37404977576, -25351.166906271006, -25611.41301363248, -25617.64346628109, -25548.094996977878, -26045.118213784343, -25564.877830007805, -25704.500037985872], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.403228464433553, "mean_inference_ms": 0.24703681786897852, "mean_action_processing_ms": 0.058739695420993526, "mean_env_wait_ms": 1.4596972194304374, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0023717880249023438, "StateBufferConnector_ms": 0.0017173290252685547, "ViewRequirementAgentConnector_ms": 0.04398369789123535}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 156240, "num_agent_steps_trained": 156240, "num_env_steps_sampled": 156240, "num_env_steps_trained": 156240, "num_env_steps_sampled_this_iter": 1800, "num_env_steps_trained_this_iter": 1800, "num_env_steps_sampled_throughput_per_sec": 162.64830467395785, "num_env_steps_trained_throughput_per_sec": 162.64830467395785, "timesteps_total": 156240, "num_steps_trained_this_iter": 1800, "agent_timesteps_total": 156240, "timers": {"training_iteration_time_ms": 2224.43, "sample_time_ms": 2217.348, "load_time_ms": 0.219, "load_throughput": 1645183.526, "learn_time_ms": 6.301, "learn_throughput": 57137.268, "synch_weights_time_ms": 0.529}, "counters": {"num_env_steps_sampled": 156240, "num_env_steps_trained": 156240, "num_agent_steps_sampled": 156240, "num_agent_steps_trained": 156240}, "done": false, "episodes_total": 434, "training_iteration": 87, "trial_id": "f5e97_00000", "date": "2023-07-25_17-12-04", "timestamp": 1690294324, "time_this_iter_s": 11.06894588470459, "time_total_s": 969.8195638656616, "pid": 71917, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[0, 0.003], [5400, 0.001], [10800, 0.00075], [16200, 0.0005], [21600, 0.00025], [27000, 0.0001], [32400, 7.5e-05], [37800, 5e-05], [43200, 2.5e-05], [48600, 1e-05], [54000, 7.5e-06], [59400, 5e-06], [64800, 2.5e-06], [70200, 1e-06], [75600, 5e-07], [81000, 1e-07]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x304530310>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 969.8195638656616, "iterations_since_restore": 87, "perf": {"cpu_util_percent": 23.133333333333333, "ram_util_percent": 79.16666666666667}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-07, "entropy_coeff": 0.1, "policy_entropy": -926.6994384765625, "policy_loss": -19013006268825.6, "vf_loss": 1130244748.8}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 2193.0, "diff_num_grad_updates_vs_sampler_policy": 2192.0}}, "num_env_steps_sampled": 158040, "num_env_steps_trained": 158040, "num_agent_steps_sampled": 158040, "num_agent_steps_trained": 158040}, "sampler_results": {"episode_reward_max": -25265.065962054505, "episode_reward_min": -26108.241970624844, "episode_reward_mean": -25732.360653630993, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-25887.061436977747, -25629.454968292463, -25640.349731648043, -25825.84153766307, -25920.300117916227, -25715.827265320084, -25781.78025677285, -25730.27264555775, -25943.576108077425, -25696.315924479346, -26015.101783501606, -25772.965387701348, -25639.14263189877, -25945.23576689735, -25776.46715704166, -25629.17291252169, -25824.38469927601, -25474.585936104304, -25738.491769587905, -25816.75142737078, -25633.590016855636, -25663.914401143084, -25809.1681167664, -25814.495198137734, -26013.12791246673, -25751.15506361066, -26024.23204956907, -25585.56141120515, -25803.91135088509, -25397.59529353382, -25689.83339877553, -25792.64632575422, -25762.25726873361, -25513.363584614537, -25654.386929504642, -25946.441046369913, -25736.046238825897, -25745.792221471816, -25757.18296566674, -25977.129950764425, -25760.824563126018, -25769.812329952805, -25641.00711604146, -25670.716394367177, -25748.631074546764, -25660.03871004826, -25727.09740035645, -25926.264704644032, -25665.57958125113, -25763.954565868127, -25446.306983019582, -25722.919963325443, -25501.036084131996, -25828.842520491533, -25901.25261620219, -25822.875830047342, -25599.110810399325, -25332.38893781996, -25702.585527102023, -25877.640263218895, -25670.29335235874, -25811.00160919924, -25738.87637535293, -25706.803192808555, -25685.243412325974, -25417.971821182156, -25354.848353986778, -25939.107425157636, -25574.779808877727, -25667.602066555202, -25467.080325284947, -25680.299637230575, -25940.706903617378, -25979.154482656842, -25817.84423952501, -25611.069215305495, -25447.410392182308, -25592.70170342282, -25779.69322995973, -25744.830596774704, -26108.241970624844, -25864.90503722851, -25950.90009105484, -26014.647527882316, -25659.80341859398, -25997.67723298258, -25624.324028795298, -25911.37404977576, -25351.166906271006, -25611.41301363248, -25617.64346628109, -25548.094996977878, -26045.118213784343, -25564.877830007805, -25704.500037985872, -25492.64154021694, -25265.065962054505, -25778.36316369155, -25881.928155785667, -26072.264390486347], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.403066477401332, "mean_inference_ms": 0.24704444776519685, "mean_action_processing_ms": 0.05874072348220136, "mean_env_wait_ms": 1.4595414225827108, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002374887466430664, "StateBufferConnector_ms": 0.0017213821411132812, "ViewRequirementAgentConnector_ms": 0.044022560119628906}}, "episode_reward_max": -25265.065962054505, "episode_reward_min": -26108.241970624844, "episode_reward_mean": -25732.360653630993, "episode_len_mean": 360.0, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-25887.061436977747, -25629.454968292463, -25640.349731648043, -25825.84153766307, -25920.300117916227, -25715.827265320084, -25781.78025677285, -25730.27264555775, -25943.576108077425, -25696.315924479346, -26015.101783501606, -25772.965387701348, -25639.14263189877, -25945.23576689735, -25776.46715704166, -25629.17291252169, -25824.38469927601, -25474.585936104304, -25738.491769587905, -25816.75142737078, -25633.590016855636, -25663.914401143084, -25809.1681167664, -25814.495198137734, -26013.12791246673, -25751.15506361066, -26024.23204956907, -25585.56141120515, -25803.91135088509, -25397.59529353382, -25689.83339877553, -25792.64632575422, -25762.25726873361, -25513.363584614537, -25654.386929504642, -25946.441046369913, -25736.046238825897, -25745.792221471816, -25757.18296566674, -25977.129950764425, -25760.824563126018, -25769.812329952805, -25641.00711604146, -25670.716394367177, -25748.631074546764, -25660.03871004826, -25727.09740035645, -25926.264704644032, -25665.57958125113, -25763.954565868127, -25446.306983019582, -25722.919963325443, -25501.036084131996, -25828.842520491533, -25901.25261620219, -25822.875830047342, -25599.110810399325, -25332.38893781996, -25702.585527102023, -25877.640263218895, -25670.29335235874, -25811.00160919924, -25738.87637535293, -25706.803192808555, -25685.243412325974, -25417.971821182156, -25354.848353986778, -25939.107425157636, -25574.779808877727, -25667.602066555202, -25467.080325284947, -25680.299637230575, -25940.706903617378, -25979.154482656842, -25817.84423952501, -25611.069215305495, -25447.410392182308, -25592.70170342282, -25779.69322995973, -25744.830596774704, -26108.241970624844, -25864.90503722851, -25950.90009105484, -26014.647527882316, -25659.80341859398, -25997.67723298258, -25624.324028795298, -25911.37404977576, -25351.166906271006, -25611.41301363248, -25617.64346628109, -25548.094996977878, -26045.118213784343, -25564.877830007805, -25704.500037985872, -25492.64154021694, -25265.065962054505, -25778.36316369155, -25881.928155785667, -26072.264390486347], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.403066477401332, "mean_inference_ms": 0.24704444776519685, "mean_action_processing_ms": 0.05874072348220136, "mean_env_wait_ms": 1.4595414225827108, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002374887466430664, "StateBufferConnector_ms": 0.0017213821411132812, "ViewRequirementAgentConnector_ms": 0.044022560119628906}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 158040, "num_agent_steps_trained": 158040, "num_env_steps_sampled": 158040, "num_env_steps_trained": 158040, "num_env_steps_sampled_this_iter": 1800, "num_env_steps_trained_this_iter": 1800, "num_env_steps_sampled_throughput_per_sec": 162.0911045201874, "num_env_steps_trained_throughput_per_sec": 162.0911045201874, "timesteps_total": 158040, "num_steps_trained_this_iter": 1800, "agent_timesteps_total": 158040, "timers": {"training_iteration_time_ms": 2217.159, "sample_time_ms": 2210.017, "load_time_ms": 0.217, "load_throughput": 1661110.495, "learn_time_ms": 6.357, "learn_throughput": 56628.13, "synch_weights_time_ms": 0.535}, "counters": {"num_env_steps_sampled": 158040, "num_env_steps_trained": 158040, "num_agent_steps_sampled": 158040, "num_agent_steps_trained": 158040}, "done": false, "episodes_total": 439, "training_iteration": 88, "trial_id": "f5e97_00000", "date": "2023-07-25_17-12-15", "timestamp": 1690294335, "time_this_iter_s": 11.10716986656189, "time_total_s": 980.9267337322235, "pid": 71917, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[0, 0.003], [5400, 0.001], [10800, 0.00075], [16200, 0.0005], [21600, 0.00025], [27000, 0.0001], [32400, 7.5e-05], [37800, 5e-05], [43200, 2.5e-05], [48600, 1e-05], [54000, 7.5e-06], [59400, 5e-06], [64800, 2.5e-06], [70200, 1e-06], [75600, 5e-07], [81000, 1e-07]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x304530310>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 980.9267337322235, "iterations_since_restore": 88, "perf": {"cpu_util_percent": 22.7625, "ram_util_percent": 79.3625}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-07, "entropy_coeff": 0.1, "policy_entropy": -926.7004150390625, "policy_loss": -25897374371020.8, "vf_loss": 1065743769.6}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 2218.0, "diff_num_grad_updates_vs_sampler_policy": 2217.0}}, "num_env_steps_sampled": 159840, "num_env_steps_trained": 159840, "num_agent_steps_sampled": 159840, "num_agent_steps_trained": 159840}, "sampler_results": {"episode_reward_max": -25265.065962054505, "episode_reward_min": -26108.241970624844, "episode_reward_mean": -25720.411542167643, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-25715.827265320084, -25781.78025677285, -25730.27264555775, -25943.576108077425, -25696.315924479346, -26015.101783501606, -25772.965387701348, -25639.14263189877, -25945.23576689735, -25776.46715704166, -25629.17291252169, -25824.38469927601, -25474.585936104304, -25738.491769587905, -25816.75142737078, -25633.590016855636, -25663.914401143084, -25809.1681167664, -25814.495198137734, -26013.12791246673, -25751.15506361066, -26024.23204956907, -25585.56141120515, -25803.91135088509, -25397.59529353382, -25689.83339877553, -25792.64632575422, -25762.25726873361, -25513.363584614537, -25654.386929504642, -25946.441046369913, -25736.046238825897, -25745.792221471816, -25757.18296566674, -25977.129950764425, -25760.824563126018, -25769.812329952805, -25641.00711604146, -25670.716394367177, -25748.631074546764, -25660.03871004826, -25727.09740035645, -25926.264704644032, -25665.57958125113, -25763.954565868127, -25446.306983019582, -25722.919963325443, -25501.036084131996, -25828.842520491533, -25901.25261620219, -25822.875830047342, -25599.110810399325, -25332.38893781996, -25702.585527102023, -25877.640263218895, -25670.29335235874, -25811.00160919924, -25738.87637535293, -25706.803192808555, -25685.243412325974, -25417.971821182156, -25354.848353986778, -25939.107425157636, -25574.779808877727, -25667.602066555202, -25467.080325284947, -25680.299637230575, -25940.706903617378, -25979.154482656842, -25817.84423952501, -25611.069215305495, -25447.410392182308, -25592.70170342282, -25779.69322995973, -25744.830596774704, -26108.241970624844, -25864.90503722851, -25950.90009105484, -26014.647527882316, -25659.80341859398, -25997.67723298258, -25624.324028795298, -25911.37404977576, -25351.166906271006, -25611.41301363248, -25617.64346628109, -25548.094996977878, -26045.118213784343, -25564.877830007805, -25704.500037985872, -25492.64154021694, -25265.065962054505, -25778.36316369155, -25881.928155785667, -26072.264390486347, -25607.822119923723, -25606.638575328827, -25542.64381056869, -25568.85591304861, -25382.136227292147], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.402931691907277, "mean_inference_ms": 0.2470506724676487, "mean_action_processing_ms": 0.05874160871564986, "mean_env_wait_ms": 1.4593921624279613, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0023908615112304688, "StateBufferConnector_ms": 0.0017163753509521484, "ViewRequirementAgentConnector_ms": 0.04417753219604492}}, "episode_reward_max": -25265.065962054505, "episode_reward_min": -26108.241970624844, "episode_reward_mean": -25720.411542167643, "episode_len_mean": 360.0, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-25715.827265320084, -25781.78025677285, -25730.27264555775, -25943.576108077425, -25696.315924479346, -26015.101783501606, -25772.965387701348, -25639.14263189877, -25945.23576689735, -25776.46715704166, -25629.17291252169, -25824.38469927601, -25474.585936104304, -25738.491769587905, -25816.75142737078, -25633.590016855636, -25663.914401143084, -25809.1681167664, -25814.495198137734, -26013.12791246673, -25751.15506361066, -26024.23204956907, -25585.56141120515, -25803.91135088509, -25397.59529353382, -25689.83339877553, -25792.64632575422, -25762.25726873361, -25513.363584614537, -25654.386929504642, -25946.441046369913, -25736.046238825897, -25745.792221471816, -25757.18296566674, -25977.129950764425, -25760.824563126018, -25769.812329952805, -25641.00711604146, -25670.716394367177, -25748.631074546764, -25660.03871004826, -25727.09740035645, -25926.264704644032, -25665.57958125113, -25763.954565868127, -25446.306983019582, -25722.919963325443, -25501.036084131996, -25828.842520491533, -25901.25261620219, -25822.875830047342, -25599.110810399325, -25332.38893781996, -25702.585527102023, -25877.640263218895, -25670.29335235874, -25811.00160919924, -25738.87637535293, -25706.803192808555, -25685.243412325974, -25417.971821182156, -25354.848353986778, -25939.107425157636, -25574.779808877727, -25667.602066555202, -25467.080325284947, -25680.299637230575, -25940.706903617378, -25979.154482656842, -25817.84423952501, -25611.069215305495, -25447.410392182308, -25592.70170342282, -25779.69322995973, -25744.830596774704, -26108.241970624844, -25864.90503722851, -25950.90009105484, -26014.647527882316, -25659.80341859398, -25997.67723298258, -25624.324028795298, -25911.37404977576, -25351.166906271006, -25611.41301363248, -25617.64346628109, -25548.094996977878, -26045.118213784343, -25564.877830007805, -25704.500037985872, -25492.64154021694, -25265.065962054505, -25778.36316369155, -25881.928155785667, -26072.264390486347, -25607.822119923723, -25606.638575328827, -25542.64381056869, -25568.85591304861, -25382.136227292147], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.402931691907277, "mean_inference_ms": 0.2470506724676487, "mean_action_processing_ms": 0.05874160871564986, "mean_env_wait_ms": 1.4593921624279613, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0023908615112304688, "StateBufferConnector_ms": 0.0017163753509521484, "ViewRequirementAgentConnector_ms": 0.04417753219604492}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 159840, "num_agent_steps_trained": 159840, "num_env_steps_sampled": 159840, "num_env_steps_trained": 159840, "num_env_steps_sampled_this_iter": 1800, "num_env_steps_trained_this_iter": 1800, "num_env_steps_sampled_throughput_per_sec": 161.55677641881985, "num_env_steps_trained_throughput_per_sec": 161.55677641881985, "timesteps_total": 159840, "num_steps_trained_this_iter": 1800, "agent_timesteps_total": 159840, "timers": {"training_iteration_time_ms": 2224.636, "sample_time_ms": 2217.398, "load_time_ms": 0.218, "load_throughput": 1651481.396, "learn_time_ms": 6.43, "learn_throughput": 55984.6, "synch_weights_time_ms": 0.556}, "counters": {"num_env_steps_sampled": 159840, "num_env_steps_trained": 159840, "num_agent_steps_sampled": 159840, "num_agent_steps_trained": 159840}, "done": false, "episodes_total": 444, "training_iteration": 89, "trial_id": "f5e97_00000", "date": "2023-07-25_17-12-26", "timestamp": 1690294346, "time_this_iter_s": 11.14438796043396, "time_total_s": 992.0711216926575, "pid": 71917, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[0, 0.003], [5400, 0.001], [10800, 0.00075], [16200, 0.0005], [21600, 0.00025], [27000, 0.0001], [32400, 7.5e-05], [37800, 5e-05], [43200, 2.5e-05], [48600, 1e-05], [54000, 7.5e-06], [59400, 5e-06], [64800, 2.5e-06], [70200, 1e-06], [75600, 5e-07], [81000, 1e-07]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x304530310>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 992.0711216926575, "iterations_since_restore": 89, "perf": {"cpu_util_percent": 24.94375, "ram_util_percent": 79.50625}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-07, "entropy_coeff": 0.1, "policy_entropy": -926.6998657226562, "policy_loss": -19489901563084.8, "vf_loss": 1092381664.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 2243.0, "diff_num_grad_updates_vs_sampler_policy": 2242.0}}, "num_env_steps_sampled": 161640, "num_env_steps_trained": 161640, "num_agent_steps_sampled": 161640, "num_agent_steps_trained": 161640}, "sampler_results": {"episode_reward_max": -25265.065962054505, "episode_reward_min": -26108.241970624844, "episode_reward_mean": -25722.10706851251, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-26015.101783501606, -25772.965387701348, -25639.14263189877, -25945.23576689735, -25776.46715704166, -25629.17291252169, -25824.38469927601, -25474.585936104304, -25738.491769587905, -25816.75142737078, -25633.590016855636, -25663.914401143084, -25809.1681167664, -25814.495198137734, -26013.12791246673, -25751.15506361066, -26024.23204956907, -25585.56141120515, -25803.91135088509, -25397.59529353382, -25689.83339877553, -25792.64632575422, -25762.25726873361, -25513.363584614537, -25654.386929504642, -25946.441046369913, -25736.046238825897, -25745.792221471816, -25757.18296566674, -25977.129950764425, -25760.824563126018, -25769.812329952805, -25641.00711604146, -25670.716394367177, -25748.631074546764, -25660.03871004826, -25727.09740035645, -25926.264704644032, -25665.57958125113, -25763.954565868127, -25446.306983019582, -25722.919963325443, -25501.036084131996, -25828.842520491533, -25901.25261620219, -25822.875830047342, -25599.110810399325, -25332.38893781996, -25702.585527102023, -25877.640263218895, -25670.29335235874, -25811.00160919924, -25738.87637535293, -25706.803192808555, -25685.243412325974, -25417.971821182156, -25354.848353986778, -25939.107425157636, -25574.779808877727, -25667.602066555202, -25467.080325284947, -25680.299637230575, -25940.706903617378, -25979.154482656842, -25817.84423952501, -25611.069215305495, -25447.410392182308, -25592.70170342282, -25779.69322995973, -25744.830596774704, -26108.241970624844, -25864.90503722851, -25950.90009105484, -26014.647527882316, -25659.80341859398, -25997.67723298258, -25624.324028795298, -25911.37404977576, -25351.166906271006, -25611.41301363248, -25617.64346628109, -25548.094996977878, -26045.118213784343, -25564.877830007805, -25704.500037985872, -25492.64154021694, -25265.065962054505, -25778.36316369155, -25881.928155785667, -26072.264390486347, -25607.822119923723, -25606.638575328827, -25542.64381056869, -25568.85591304861, -25382.136227292147, -25954.705362132278, -25567.57184422557, -25657.18768976953, -26100.574437346037, -25757.28550122091], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.402798233721949, "mean_inference_ms": 0.2470559902076751, "mean_action_processing_ms": 0.05874251602276739, "mean_env_wait_ms": 1.4592377470693214, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0023665428161621094, "StateBufferConnector_ms": 0.0017192363739013672, "ViewRequirementAgentConnector_ms": 0.04414486885070801}}, "episode_reward_max": -25265.065962054505, "episode_reward_min": -26108.241970624844, "episode_reward_mean": -25722.10706851251, "episode_len_mean": 360.0, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-26015.101783501606, -25772.965387701348, -25639.14263189877, -25945.23576689735, -25776.46715704166, -25629.17291252169, -25824.38469927601, -25474.585936104304, -25738.491769587905, -25816.75142737078, -25633.590016855636, -25663.914401143084, -25809.1681167664, -25814.495198137734, -26013.12791246673, -25751.15506361066, -26024.23204956907, -25585.56141120515, -25803.91135088509, -25397.59529353382, -25689.83339877553, -25792.64632575422, -25762.25726873361, -25513.363584614537, -25654.386929504642, -25946.441046369913, -25736.046238825897, -25745.792221471816, -25757.18296566674, -25977.129950764425, -25760.824563126018, -25769.812329952805, -25641.00711604146, -25670.716394367177, -25748.631074546764, -25660.03871004826, -25727.09740035645, -25926.264704644032, -25665.57958125113, -25763.954565868127, -25446.306983019582, -25722.919963325443, -25501.036084131996, -25828.842520491533, -25901.25261620219, -25822.875830047342, -25599.110810399325, -25332.38893781996, -25702.585527102023, -25877.640263218895, -25670.29335235874, -25811.00160919924, -25738.87637535293, -25706.803192808555, -25685.243412325974, -25417.971821182156, -25354.848353986778, -25939.107425157636, -25574.779808877727, -25667.602066555202, -25467.080325284947, -25680.299637230575, -25940.706903617378, -25979.154482656842, -25817.84423952501, -25611.069215305495, -25447.410392182308, -25592.70170342282, -25779.69322995973, -25744.830596774704, -26108.241970624844, -25864.90503722851, -25950.90009105484, -26014.647527882316, -25659.80341859398, -25997.67723298258, -25624.324028795298, -25911.37404977576, -25351.166906271006, -25611.41301363248, -25617.64346628109, -25548.094996977878, -26045.118213784343, -25564.877830007805, -25704.500037985872, -25492.64154021694, -25265.065962054505, -25778.36316369155, -25881.928155785667, -26072.264390486347, -25607.822119923723, -25606.638575328827, -25542.64381056869, -25568.85591304861, -25382.136227292147, -25954.705362132278, -25567.57184422557, -25657.18768976953, -26100.574437346037, -25757.28550122091], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.402798233721949, "mean_inference_ms": 0.2470559902076751, "mean_action_processing_ms": 0.05874251602276739, "mean_env_wait_ms": 1.4592377470693214, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0023665428161621094, "StateBufferConnector_ms": 0.0017192363739013672, "ViewRequirementAgentConnector_ms": 0.04414486885070801}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 161640, "num_agent_steps_trained": 161640, "num_env_steps_sampled": 161640, "num_env_steps_trained": 161640, "num_env_steps_sampled_this_iter": 1800, "num_env_steps_trained_this_iter": 1800, "num_env_steps_sampled_throughput_per_sec": 162.40685466782287, "num_env_steps_trained_throughput_per_sec": 162.40685466782287, "timesteps_total": 161640, "num_steps_trained_this_iter": 1800, "agent_timesteps_total": 161640, "timers": {"training_iteration_time_ms": 2222.478, "sample_time_ms": 2215.377, "load_time_ms": 0.215, "load_throughput": 1671407.394, "learn_time_ms": 6.32, "learn_throughput": 56965.681, "synch_weights_time_ms": 0.533}, "counters": {"num_env_steps_sampled": 161640, "num_env_steps_trained": 161640, "num_agent_steps_sampled": 161640, "num_agent_steps_trained": 161640}, "done": false, "episodes_total": 449, "training_iteration": 90, "trial_id": "f5e97_00000", "date": "2023-07-25_17-12-38", "timestamp": 1690294358, "time_this_iter_s": 11.085445165634155, "time_total_s": 1003.1565668582916, "pid": 71917, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[0, 0.003], [5400, 0.001], [10800, 0.00075], [16200, 0.0005], [21600, 0.00025], [27000, 0.0001], [32400, 7.5e-05], [37800, 5e-05], [43200, 2.5e-05], [48600, 1e-05], [54000, 7.5e-06], [59400, 5e-06], [64800, 2.5e-06], [70200, 1e-06], [75600, 5e-07], [81000, 1e-07]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x304530310>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1003.1565668582916, "iterations_since_restore": 90, "perf": {"cpu_util_percent": 25.52, "ram_util_percent": 77.92666666666668}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-07, "entropy_coeff": 0.1, "policy_entropy": -926.6993896484375, "policy_loss": -22970532572364.8, "vf_loss": 1133641664.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 2268.0, "diff_num_grad_updates_vs_sampler_policy": 2267.0}}, "num_env_steps_sampled": 163440, "num_env_steps_trained": 163440, "num_agent_steps_sampled": 163440, "num_agent_steps_trained": 163440}, "sampler_results": {"episode_reward_max": -25265.065962054505, "episode_reward_min": -26151.302070778504, "episode_reward_mean": -25722.325866110026, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-25629.17291252169, -25824.38469927601, -25474.585936104304, -25738.491769587905, -25816.75142737078, -25633.590016855636, -25663.914401143084, -25809.1681167664, -25814.495198137734, -26013.12791246673, -25751.15506361066, -26024.23204956907, -25585.56141120515, -25803.91135088509, -25397.59529353382, -25689.83339877553, -25792.64632575422, -25762.25726873361, -25513.363584614537, -25654.386929504642, -25946.441046369913, -25736.046238825897, -25745.792221471816, -25757.18296566674, -25977.129950764425, -25760.824563126018, -25769.812329952805, -25641.00711604146, -25670.716394367177, -25748.631074546764, -25660.03871004826, -25727.09740035645, -25926.264704644032, -25665.57958125113, -25763.954565868127, -25446.306983019582, -25722.919963325443, -25501.036084131996, -25828.842520491533, -25901.25261620219, -25822.875830047342, -25599.110810399325, -25332.38893781996, -25702.585527102023, -25877.640263218895, -25670.29335235874, -25811.00160919924, -25738.87637535293, -25706.803192808555, -25685.243412325974, -25417.971821182156, -25354.848353986778, -25939.107425157636, -25574.779808877727, -25667.602066555202, -25467.080325284947, -25680.299637230575, -25940.706903617378, -25979.154482656842, -25817.84423952501, -25611.069215305495, -25447.410392182308, -25592.70170342282, -25779.69322995973, -25744.830596774704, -26108.241970624844, -25864.90503722851, -25950.90009105484, -26014.647527882316, -25659.80341859398, -25997.67723298258, -25624.324028795298, -25911.37404977576, -25351.166906271006, -25611.41301363248, -25617.64346628109, -25548.094996977878, -26045.118213784343, -25564.877830007805, -25704.500037985872, -25492.64154021694, -25265.065962054505, -25778.36316369155, -25881.928155785667, -26072.264390486347, -25607.822119923723, -25606.638575328827, -25542.64381056869, -25568.85591304861, -25382.136227292147, -25954.705362132278, -25567.57184422557, -25657.18768976953, -26100.574437346037, -25757.28550122091, -25618.053292995486, -26029.62052649127, -25627.929491083225, -25743.887105443853, -26151.302070778504], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.402614216589386, "mean_inference_ms": 0.2470537836892597, "mean_action_processing_ms": 0.05874192177523604, "mean_env_wait_ms": 1.4590685060479105, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0023660659790039062, "StateBufferConnector_ms": 0.001714468002319336, "ViewRequirementAgentConnector_ms": 0.04410219192504883}}, "episode_reward_max": -25265.065962054505, "episode_reward_min": -26151.302070778504, "episode_reward_mean": -25722.325866110026, "episode_len_mean": 360.0, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-25629.17291252169, -25824.38469927601, -25474.585936104304, -25738.491769587905, -25816.75142737078, -25633.590016855636, -25663.914401143084, -25809.1681167664, -25814.495198137734, -26013.12791246673, -25751.15506361066, -26024.23204956907, -25585.56141120515, -25803.91135088509, -25397.59529353382, -25689.83339877553, -25792.64632575422, -25762.25726873361, -25513.363584614537, -25654.386929504642, -25946.441046369913, -25736.046238825897, -25745.792221471816, -25757.18296566674, -25977.129950764425, -25760.824563126018, -25769.812329952805, -25641.00711604146, -25670.716394367177, -25748.631074546764, -25660.03871004826, -25727.09740035645, -25926.264704644032, -25665.57958125113, -25763.954565868127, -25446.306983019582, -25722.919963325443, -25501.036084131996, -25828.842520491533, -25901.25261620219, -25822.875830047342, -25599.110810399325, -25332.38893781996, -25702.585527102023, -25877.640263218895, -25670.29335235874, -25811.00160919924, -25738.87637535293, -25706.803192808555, -25685.243412325974, -25417.971821182156, -25354.848353986778, -25939.107425157636, -25574.779808877727, -25667.602066555202, -25467.080325284947, -25680.299637230575, -25940.706903617378, -25979.154482656842, -25817.84423952501, -25611.069215305495, -25447.410392182308, -25592.70170342282, -25779.69322995973, -25744.830596774704, -26108.241970624844, -25864.90503722851, -25950.90009105484, -26014.647527882316, -25659.80341859398, -25997.67723298258, -25624.324028795298, -25911.37404977576, -25351.166906271006, -25611.41301363248, -25617.64346628109, -25548.094996977878, -26045.118213784343, -25564.877830007805, -25704.500037985872, -25492.64154021694, -25265.065962054505, -25778.36316369155, -25881.928155785667, -26072.264390486347, -25607.822119923723, -25606.638575328827, -25542.64381056869, -25568.85591304861, -25382.136227292147, -25954.705362132278, -25567.57184422557, -25657.18768976953, -26100.574437346037, -25757.28550122091, -25618.053292995486, -26029.62052649127, -25627.929491083225, -25743.887105443853, -26151.302070778504], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.402614216589386, "mean_inference_ms": 0.2470537836892597, "mean_action_processing_ms": 0.05874192177523604, "mean_env_wait_ms": 1.4590685060479105, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0023660659790039062, "StateBufferConnector_ms": 0.001714468002319336, "ViewRequirementAgentConnector_ms": 0.04410219192504883}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 163440, "num_agent_steps_trained": 163440, "num_env_steps_sampled": 163440, "num_env_steps_trained": 163440, "num_env_steps_sampled_this_iter": 1800, "num_env_steps_trained_this_iter": 1800, "num_env_steps_sampled_throughput_per_sec": 162.8090737246598, "num_env_steps_trained_throughput_per_sec": 162.8090737246598, "timesteps_total": 163440, "num_steps_trained_this_iter": 1800, "agent_timesteps_total": 163440, "timers": {"training_iteration_time_ms": 2213.907, "sample_time_ms": 2206.741, "load_time_ms": 0.222, "load_throughput": 1624824.535, "learn_time_ms": 6.379, "learn_throughput": 56433.628, "synch_weights_time_ms": 0.528}, "counters": {"num_env_steps_sampled": 163440, "num_env_steps_trained": 163440, "num_agent_steps_sampled": 163440, "num_agent_steps_trained": 163440}, "done": false, "episodes_total": 454, "training_iteration": 91, "trial_id": "f5e97_00000", "date": "2023-07-25_17-12-49", "timestamp": 1690294369, "time_this_iter_s": 11.05811095237732, "time_total_s": 1014.214677810669, "pid": 71917, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[0, 0.003], [5400, 0.001], [10800, 0.00075], [16200, 0.0005], [21600, 0.00025], [27000, 0.0001], [32400, 7.5e-05], [37800, 5e-05], [43200, 2.5e-05], [48600, 1e-05], [54000, 7.5e-06], [59400, 5e-06], [64800, 2.5e-06], [70200, 1e-06], [75600, 5e-07], [81000, 1e-07]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x304530310>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1014.214677810669, "iterations_since_restore": 91, "perf": {"cpu_util_percent": 26.03125, "ram_util_percent": 76.50625}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-07, "entropy_coeff": 0.1, "policy_entropy": -926.6998901367188, "policy_loss": -23678214753484.8, "vf_loss": 1101038374.4}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 2293.0, "diff_num_grad_updates_vs_sampler_policy": 2292.0}}, "num_env_steps_sampled": 165240, "num_env_steps_trained": 165240, "num_agent_steps_sampled": 165240, "num_agent_steps_trained": 165240}, "sampler_results": {"episode_reward_max": -25265.065962054505, "episode_reward_min": -26151.302070778504, "episode_reward_mean": -25722.583881465318, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-25633.590016855636, -25663.914401143084, -25809.1681167664, -25814.495198137734, -26013.12791246673, -25751.15506361066, -26024.23204956907, -25585.56141120515, -25803.91135088509, -25397.59529353382, -25689.83339877553, -25792.64632575422, -25762.25726873361, -25513.363584614537, -25654.386929504642, -25946.441046369913, -25736.046238825897, -25745.792221471816, -25757.18296566674, -25977.129950764425, -25760.824563126018, -25769.812329952805, -25641.00711604146, -25670.716394367177, -25748.631074546764, -25660.03871004826, -25727.09740035645, -25926.264704644032, -25665.57958125113, -25763.954565868127, -25446.306983019582, -25722.919963325443, -25501.036084131996, -25828.842520491533, -25901.25261620219, -25822.875830047342, -25599.110810399325, -25332.38893781996, -25702.585527102023, -25877.640263218895, -25670.29335235874, -25811.00160919924, -25738.87637535293, -25706.803192808555, -25685.243412325974, -25417.971821182156, -25354.848353986778, -25939.107425157636, -25574.779808877727, -25667.602066555202, -25467.080325284947, -25680.299637230575, -25940.706903617378, -25979.154482656842, -25817.84423952501, -25611.069215305495, -25447.410392182308, -25592.70170342282, -25779.69322995973, -25744.830596774704, -26108.241970624844, -25864.90503722851, -25950.90009105484, -26014.647527882316, -25659.80341859398, -25997.67723298258, -25624.324028795298, -25911.37404977576, -25351.166906271006, -25611.41301363248, -25617.64346628109, -25548.094996977878, -26045.118213784343, -25564.877830007805, -25704.500037985872, -25492.64154021694, -25265.065962054505, -25778.36316369155, -25881.928155785667, -26072.264390486347, -25607.822119923723, -25606.638575328827, -25542.64381056869, -25568.85591304861, -25382.136227292147, -25954.705362132278, -25567.57184422557, -25657.18768976953, -26100.574437346037, -25757.28550122091, -25618.053292995486, -26029.62052649127, -25627.929491083225, -25743.887105443853, -26151.302070778504, -25672.852604474392, -25767.446060770482, -25672.48546610586, -25606.265294736724, -25790.13885430144], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.40238799361307, "mean_inference_ms": 0.24705056142735884, "mean_action_processing_ms": 0.05874124903366953, "mean_env_wait_ms": 1.4589138338924112, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0023658275604248047, "StateBufferConnector_ms": 0.0017216205596923828, "ViewRequirementAgentConnector_ms": 0.04407858848571777}}, "episode_reward_max": -25265.065962054505, "episode_reward_min": -26151.302070778504, "episode_reward_mean": -25722.583881465318, "episode_len_mean": 360.0, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-25633.590016855636, -25663.914401143084, -25809.1681167664, -25814.495198137734, -26013.12791246673, -25751.15506361066, -26024.23204956907, -25585.56141120515, -25803.91135088509, -25397.59529353382, -25689.83339877553, -25792.64632575422, -25762.25726873361, -25513.363584614537, -25654.386929504642, -25946.441046369913, -25736.046238825897, -25745.792221471816, -25757.18296566674, -25977.129950764425, -25760.824563126018, -25769.812329952805, -25641.00711604146, -25670.716394367177, -25748.631074546764, -25660.03871004826, -25727.09740035645, -25926.264704644032, -25665.57958125113, -25763.954565868127, -25446.306983019582, -25722.919963325443, -25501.036084131996, -25828.842520491533, -25901.25261620219, -25822.875830047342, -25599.110810399325, -25332.38893781996, -25702.585527102023, -25877.640263218895, -25670.29335235874, -25811.00160919924, -25738.87637535293, -25706.803192808555, -25685.243412325974, -25417.971821182156, -25354.848353986778, -25939.107425157636, -25574.779808877727, -25667.602066555202, -25467.080325284947, -25680.299637230575, -25940.706903617378, -25979.154482656842, -25817.84423952501, -25611.069215305495, -25447.410392182308, -25592.70170342282, -25779.69322995973, -25744.830596774704, -26108.241970624844, -25864.90503722851, -25950.90009105484, -26014.647527882316, -25659.80341859398, -25997.67723298258, -25624.324028795298, -25911.37404977576, -25351.166906271006, -25611.41301363248, -25617.64346628109, -25548.094996977878, -26045.118213784343, -25564.877830007805, -25704.500037985872, -25492.64154021694, -25265.065962054505, -25778.36316369155, -25881.928155785667, -26072.264390486347, -25607.822119923723, -25606.638575328827, -25542.64381056869, -25568.85591304861, -25382.136227292147, -25954.705362132278, -25567.57184422557, -25657.18768976953, -26100.574437346037, -25757.28550122091, -25618.053292995486, -26029.62052649127, -25627.929491083225, -25743.887105443853, -26151.302070778504, -25672.852604474392, -25767.446060770482, -25672.48546610586, -25606.265294736724, -25790.13885430144], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.40238799361307, "mean_inference_ms": 0.24705056142735884, "mean_action_processing_ms": 0.05874124903366953, "mean_env_wait_ms": 1.4589138338924112, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0023658275604248047, "StateBufferConnector_ms": 0.0017216205596923828, "ViewRequirementAgentConnector_ms": 0.04407858848571777}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 165240, "num_agent_steps_trained": 165240, "num_env_steps_sampled": 165240, "num_env_steps_trained": 165240, "num_env_steps_sampled_this_iter": 1800, "num_env_steps_trained_this_iter": 1800, "num_env_steps_sampled_throughput_per_sec": 161.75595287194992, "num_env_steps_trained_throughput_per_sec": 161.75595287194992, "timesteps_total": 165240, "num_steps_trained_this_iter": 1800, "agent_timesteps_total": 165240, "timers": {"training_iteration_time_ms": 2218.367, "sample_time_ms": 2211.184, "load_time_ms": 0.222, "load_throughput": 1625174.298, "learn_time_ms": 6.388, "learn_throughput": 56359.903, "synch_weights_time_ms": 0.536}, "counters": {"num_env_steps_sampled": 165240, "num_env_steps_trained": 165240, "num_agent_steps_sampled": 165240, "num_agent_steps_trained": 165240}, "done": false, "episodes_total": 459, "training_iteration": 92, "trial_id": "f5e97_00000", "date": "2023-07-25_17-13-00", "timestamp": 1690294380, "time_this_iter_s": 11.130022764205933, "time_total_s": 1025.3447005748749, "pid": 71917, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[0, 0.003], [5400, 0.001], [10800, 0.00075], [16200, 0.0005], [21600, 0.00025], [27000, 0.0001], [32400, 7.5e-05], [37800, 5e-05], [43200, 2.5e-05], [48600, 1e-05], [54000, 7.5e-06], [59400, 5e-06], [64800, 2.5e-06], [70200, 1e-06], [75600, 5e-07], [81000, 1e-07]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x304530310>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1025.3447005748749, "iterations_since_restore": 92, "perf": {"cpu_util_percent": 24.7875, "ram_util_percent": 79.28125}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-07, "entropy_coeff": 0.1, "policy_entropy": -926.6998291015625, "policy_loss": -37390399039078.4, "vf_loss": 1092692166.4}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 2318.0, "diff_num_grad_updates_vs_sampler_policy": 2317.0}}, "num_env_steps_sampled": 167040, "num_env_steps_trained": 167040, "num_agent_steps_sampled": 167040, "num_agent_steps_trained": 167040}, "sampler_results": {"episode_reward_max": -25265.065962054505, "episode_reward_min": -26151.302070778504, "episode_reward_mean": -25722.04809483821, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-25751.15506361066, -26024.23204956907, -25585.56141120515, -25803.91135088509, -25397.59529353382, -25689.83339877553, -25792.64632575422, -25762.25726873361, -25513.363584614537, -25654.386929504642, -25946.441046369913, -25736.046238825897, -25745.792221471816, -25757.18296566674, -25977.129950764425, -25760.824563126018, -25769.812329952805, -25641.00711604146, -25670.716394367177, -25748.631074546764, -25660.03871004826, -25727.09740035645, -25926.264704644032, -25665.57958125113, -25763.954565868127, -25446.306983019582, -25722.919963325443, -25501.036084131996, -25828.842520491533, -25901.25261620219, -25822.875830047342, -25599.110810399325, -25332.38893781996, -25702.585527102023, -25877.640263218895, -25670.29335235874, -25811.00160919924, -25738.87637535293, -25706.803192808555, -25685.243412325974, -25417.971821182156, -25354.848353986778, -25939.107425157636, -25574.779808877727, -25667.602066555202, -25467.080325284947, -25680.299637230575, -25940.706903617378, -25979.154482656842, -25817.84423952501, -25611.069215305495, -25447.410392182308, -25592.70170342282, -25779.69322995973, -25744.830596774704, -26108.241970624844, -25864.90503722851, -25950.90009105484, -26014.647527882316, -25659.80341859398, -25997.67723298258, -25624.324028795298, -25911.37404977576, -25351.166906271006, -25611.41301363248, -25617.64346628109, -25548.094996977878, -26045.118213784343, -25564.877830007805, -25704.500037985872, -25492.64154021694, -25265.065962054505, -25778.36316369155, -25881.928155785667, -26072.264390486347, -25607.822119923723, -25606.638575328827, -25542.64381056869, -25568.85591304861, -25382.136227292147, -25954.705362132278, -25567.57184422557, -25657.18768976953, -26100.574437346037, -25757.28550122091, -25618.053292995486, -26029.62052649127, -25627.929491083225, -25743.887105443853, -26151.302070778504, -25672.852604474392, -25767.446060770482, -25672.48546610586, -25606.265294736724, -25790.13885430144, -25867.090179034065, -26033.13106749242, -25610.889769114186, -25660.437953603592, -25709.168013415092], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.402153519550215, "mean_inference_ms": 0.24704662439259614, "mean_action_processing_ms": 0.0587406140440443, "mean_env_wait_ms": 1.458765171824505, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002380847930908203, "StateBufferConnector_ms": 0.0017421245574951172, "ViewRequirementAgentConnector_ms": 0.044181108474731445}}, "episode_reward_max": -25265.065962054505, "episode_reward_min": -26151.302070778504, "episode_reward_mean": -25722.04809483821, "episode_len_mean": 360.0, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-25751.15506361066, -26024.23204956907, -25585.56141120515, -25803.91135088509, -25397.59529353382, -25689.83339877553, -25792.64632575422, -25762.25726873361, -25513.363584614537, -25654.386929504642, -25946.441046369913, -25736.046238825897, -25745.792221471816, -25757.18296566674, -25977.129950764425, -25760.824563126018, -25769.812329952805, -25641.00711604146, -25670.716394367177, -25748.631074546764, -25660.03871004826, -25727.09740035645, -25926.264704644032, -25665.57958125113, -25763.954565868127, -25446.306983019582, -25722.919963325443, -25501.036084131996, -25828.842520491533, -25901.25261620219, -25822.875830047342, -25599.110810399325, -25332.38893781996, -25702.585527102023, -25877.640263218895, -25670.29335235874, -25811.00160919924, -25738.87637535293, -25706.803192808555, -25685.243412325974, -25417.971821182156, -25354.848353986778, -25939.107425157636, -25574.779808877727, -25667.602066555202, -25467.080325284947, -25680.299637230575, -25940.706903617378, -25979.154482656842, -25817.84423952501, -25611.069215305495, -25447.410392182308, -25592.70170342282, -25779.69322995973, -25744.830596774704, -26108.241970624844, -25864.90503722851, -25950.90009105484, -26014.647527882316, -25659.80341859398, -25997.67723298258, -25624.324028795298, -25911.37404977576, -25351.166906271006, -25611.41301363248, -25617.64346628109, -25548.094996977878, -26045.118213784343, -25564.877830007805, -25704.500037985872, -25492.64154021694, -25265.065962054505, -25778.36316369155, -25881.928155785667, -26072.264390486347, -25607.822119923723, -25606.638575328827, -25542.64381056869, -25568.85591304861, -25382.136227292147, -25954.705362132278, -25567.57184422557, -25657.18768976953, -26100.574437346037, -25757.28550122091, -25618.053292995486, -26029.62052649127, -25627.929491083225, -25743.887105443853, -26151.302070778504, -25672.852604474392, -25767.446060770482, -25672.48546610586, -25606.265294736724, -25790.13885430144, -25867.090179034065, -26033.13106749242, -25610.889769114186, -25660.437953603592, -25709.168013415092], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.402153519550215, "mean_inference_ms": 0.24704662439259614, "mean_action_processing_ms": 0.0587406140440443, "mean_env_wait_ms": 1.458765171824505, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002380847930908203, "StateBufferConnector_ms": 0.0017421245574951172, "ViewRequirementAgentConnector_ms": 0.044181108474731445}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 167040, "num_agent_steps_trained": 167040, "num_env_steps_sampled": 167040, "num_env_steps_trained": 167040, "num_env_steps_sampled_this_iter": 1800, "num_env_steps_trained_this_iter": 1800, "num_env_steps_sampled_throughput_per_sec": 161.92136882228115, "num_env_steps_trained_throughput_per_sec": 161.92136882228115, "timesteps_total": 167040, "num_steps_trained_this_iter": 1800, "agent_timesteps_total": 167040, "timers": {"training_iteration_time_ms": 2224.429, "sample_time_ms": 2217.254, "load_time_ms": 0.218, "load_throughput": 1654557.791, "learn_time_ms": 6.41, "learn_throughput": 56164.73, "synch_weights_time_ms": 0.515}, "counters": {"num_env_steps_sampled": 167040, "num_env_steps_trained": 167040, "num_agent_steps_sampled": 167040, "num_agent_steps_trained": 167040}, "done": false, "episodes_total": 464, "training_iteration": 93, "trial_id": "f5e97_00000", "date": "2023-07-25_17-13-11", "timestamp": 1690294391, "time_this_iter_s": 11.118772029876709, "time_total_s": 1036.4634726047516, "pid": 71917, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[0, 0.003], [5400, 0.001], [10800, 0.00075], [16200, 0.0005], [21600, 0.00025], [27000, 0.0001], [32400, 7.5e-05], [37800, 5e-05], [43200, 2.5e-05], [48600, 1e-05], [54000, 7.5e-06], [59400, 5e-06], [64800, 2.5e-06], [70200, 1e-06], [75600, 5e-07], [81000, 1e-07]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x304530310>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1036.4634726047516, "iterations_since_restore": 93, "perf": {"cpu_util_percent": 22.98125, "ram_util_percent": 80.70625000000001}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-07, "entropy_coeff": 0.1, "policy_entropy": -926.6997680664062, "policy_loss": -31505002863001.6, "vf_loss": 1105655865.6}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 2343.0, "diff_num_grad_updates_vs_sampler_policy": 2342.0}}, "num_env_steps_sampled": 168840, "num_env_steps_trained": 168840, "num_agent_steps_sampled": 168840, "num_agent_steps_trained": 168840}, "sampler_results": {"episode_reward_max": -25265.065962054505, "episode_reward_min": -26151.302070778504, "episode_reward_mean": -25723.719053234967, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-25689.83339877553, -25792.64632575422, -25762.25726873361, -25513.363584614537, -25654.386929504642, -25946.441046369913, -25736.046238825897, -25745.792221471816, -25757.18296566674, -25977.129950764425, -25760.824563126018, -25769.812329952805, -25641.00711604146, -25670.716394367177, -25748.631074546764, -25660.03871004826, -25727.09740035645, -25926.264704644032, -25665.57958125113, -25763.954565868127, -25446.306983019582, -25722.919963325443, -25501.036084131996, -25828.842520491533, -25901.25261620219, -25822.875830047342, -25599.110810399325, -25332.38893781996, -25702.585527102023, -25877.640263218895, -25670.29335235874, -25811.00160919924, -25738.87637535293, -25706.803192808555, -25685.243412325974, -25417.971821182156, -25354.848353986778, -25939.107425157636, -25574.779808877727, -25667.602066555202, -25467.080325284947, -25680.299637230575, -25940.706903617378, -25979.154482656842, -25817.84423952501, -25611.069215305495, -25447.410392182308, -25592.70170342282, -25779.69322995973, -25744.830596774704, -26108.241970624844, -25864.90503722851, -25950.90009105484, -26014.647527882316, -25659.80341859398, -25997.67723298258, -25624.324028795298, -25911.37404977576, -25351.166906271006, -25611.41301363248, -25617.64346628109, -25548.094996977878, -26045.118213784343, -25564.877830007805, -25704.500037985872, -25492.64154021694, -25265.065962054505, -25778.36316369155, -25881.928155785667, -26072.264390486347, -25607.822119923723, -25606.638575328827, -25542.64381056869, -25568.85591304861, -25382.136227292147, -25954.705362132278, -25567.57184422557, -25657.18768976953, -26100.574437346037, -25757.28550122091, -25618.053292995486, -26029.62052649127, -25627.929491083225, -25743.887105443853, -26151.302070778504, -25672.852604474392, -25767.446060770482, -25672.48546610586, -25606.265294736724, -25790.13885430144, -25867.090179034065, -26033.13106749242, -25610.889769114186, -25660.437953603592, -25709.168013415092, -25569.824594775288, -25732.30191489128, -25889.39176604255, -25729.758223910954, -25808.274508859773], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.401934875347688, "mean_inference_ms": 0.24704120305581082, "mean_action_processing_ms": 0.05873963721139839, "mean_env_wait_ms": 1.4586105753743686, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002379894256591797, "StateBufferConnector_ms": 0.001741170883178711, "ViewRequirementAgentConnector_ms": 0.04417228698730469}}, "episode_reward_max": -25265.065962054505, "episode_reward_min": -26151.302070778504, "episode_reward_mean": -25723.719053234967, "episode_len_mean": 360.0, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-25689.83339877553, -25792.64632575422, -25762.25726873361, -25513.363584614537, -25654.386929504642, -25946.441046369913, -25736.046238825897, -25745.792221471816, -25757.18296566674, -25977.129950764425, -25760.824563126018, -25769.812329952805, -25641.00711604146, -25670.716394367177, -25748.631074546764, -25660.03871004826, -25727.09740035645, -25926.264704644032, -25665.57958125113, -25763.954565868127, -25446.306983019582, -25722.919963325443, -25501.036084131996, -25828.842520491533, -25901.25261620219, -25822.875830047342, -25599.110810399325, -25332.38893781996, -25702.585527102023, -25877.640263218895, -25670.29335235874, -25811.00160919924, -25738.87637535293, -25706.803192808555, -25685.243412325974, -25417.971821182156, -25354.848353986778, -25939.107425157636, -25574.779808877727, -25667.602066555202, -25467.080325284947, -25680.299637230575, -25940.706903617378, -25979.154482656842, -25817.84423952501, -25611.069215305495, -25447.410392182308, -25592.70170342282, -25779.69322995973, -25744.830596774704, -26108.241970624844, -25864.90503722851, -25950.90009105484, -26014.647527882316, -25659.80341859398, -25997.67723298258, -25624.324028795298, -25911.37404977576, -25351.166906271006, -25611.41301363248, -25617.64346628109, -25548.094996977878, -26045.118213784343, -25564.877830007805, -25704.500037985872, -25492.64154021694, -25265.065962054505, -25778.36316369155, -25881.928155785667, -26072.264390486347, -25607.822119923723, -25606.638575328827, -25542.64381056869, -25568.85591304861, -25382.136227292147, -25954.705362132278, -25567.57184422557, -25657.18768976953, -26100.574437346037, -25757.28550122091, -25618.053292995486, -26029.62052649127, -25627.929491083225, -25743.887105443853, -26151.302070778504, -25672.852604474392, -25767.446060770482, -25672.48546610586, -25606.265294736724, -25790.13885430144, -25867.090179034065, -26033.13106749242, -25610.889769114186, -25660.437953603592, -25709.168013415092, -25569.824594775288, -25732.30191489128, -25889.39176604255, -25729.758223910954, -25808.274508859773], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.401934875347688, "mean_inference_ms": 0.24704120305581082, "mean_action_processing_ms": 0.05873963721139839, "mean_env_wait_ms": 1.4586105753743686, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002379894256591797, "StateBufferConnector_ms": 0.001741170883178711, "ViewRequirementAgentConnector_ms": 0.04417228698730469}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 168840, "num_agent_steps_trained": 168840, "num_env_steps_sampled": 168840, "num_env_steps_trained": 168840, "num_env_steps_sampled_this_iter": 1800, "num_env_steps_trained_this_iter": 1800, "num_env_steps_sampled_throughput_per_sec": 161.7922986644402, "num_env_steps_trained_throughput_per_sec": 161.7922986644402, "timesteps_total": 168840, "num_steps_trained_this_iter": 1800, "agent_timesteps_total": 168840, "timers": {"training_iteration_time_ms": 2224.178, "sample_time_ms": 2216.866, "load_time_ms": 0.218, "load_throughput": 1654195.267, "learn_time_ms": 6.534, "learn_throughput": 55093.971, "synch_weights_time_ms": 0.528}, "counters": {"num_env_steps_sampled": 168840, "num_env_steps_trained": 168840, "num_agent_steps_sampled": 168840, "num_agent_steps_trained": 168840}, "done": false, "episodes_total": 469, "training_iteration": 94, "trial_id": "f5e97_00000", "date": "2023-07-25_17-13-22", "timestamp": 1690294402, "time_this_iter_s": 11.127347946166992, "time_total_s": 1047.5908205509186, "pid": 71917, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[0, 0.003], [5400, 0.001], [10800, 0.00075], [16200, 0.0005], [21600, 0.00025], [27000, 0.0001], [32400, 7.5e-05], [37800, 5e-05], [43200, 2.5e-05], [48600, 1e-05], [54000, 7.5e-06], [59400, 5e-06], [64800, 2.5e-06], [70200, 1e-06], [75600, 5e-07], [81000, 1e-07]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x304530310>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1047.5908205509186, "iterations_since_restore": 94, "perf": {"cpu_util_percent": 23.419999999999998, "ram_util_percent": 79.16666666666667}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-07, "entropy_coeff": 0.1, "policy_entropy": -926.6998046875, "policy_loss": -26274778218496.0, "vf_loss": 1099906099.2}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 2368.0, "diff_num_grad_updates_vs_sampler_policy": 2367.0}}, "num_env_steps_sampled": 170640, "num_env_steps_trained": 170640, "num_agent_steps_sampled": 170640, "num_agent_steps_trained": 170640}, "sampler_results": {"episode_reward_max": -25265.065962054505, "episode_reward_min": -26151.302070778504, "episode_reward_mean": -25725.67394293378, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-25946.441046369913, -25736.046238825897, -25745.792221471816, -25757.18296566674, -25977.129950764425, -25760.824563126018, -25769.812329952805, -25641.00711604146, -25670.716394367177, -25748.631074546764, -25660.03871004826, -25727.09740035645, -25926.264704644032, -25665.57958125113, -25763.954565868127, -25446.306983019582, -25722.919963325443, -25501.036084131996, -25828.842520491533, -25901.25261620219, -25822.875830047342, -25599.110810399325, -25332.38893781996, -25702.585527102023, -25877.640263218895, -25670.29335235874, -25811.00160919924, -25738.87637535293, -25706.803192808555, -25685.243412325974, -25417.971821182156, -25354.848353986778, -25939.107425157636, -25574.779808877727, -25667.602066555202, -25467.080325284947, -25680.299637230575, -25940.706903617378, -25979.154482656842, -25817.84423952501, -25611.069215305495, -25447.410392182308, -25592.70170342282, -25779.69322995973, -25744.830596774704, -26108.241970624844, -25864.90503722851, -25950.90009105484, -26014.647527882316, -25659.80341859398, -25997.67723298258, -25624.324028795298, -25911.37404977576, -25351.166906271006, -25611.41301363248, -25617.64346628109, -25548.094996977878, -26045.118213784343, -25564.877830007805, -25704.500037985872, -25492.64154021694, -25265.065962054505, -25778.36316369155, -25881.928155785667, -26072.264390486347, -25607.822119923723, -25606.638575328827, -25542.64381056869, -25568.85591304861, -25382.136227292147, -25954.705362132278, -25567.57184422557, -25657.18768976953, -26100.574437346037, -25757.28550122091, -25618.053292995486, -26029.62052649127, -25627.929491083225, -25743.887105443853, -26151.302070778504, -25672.852604474392, -25767.446060770482, -25672.48546610586, -25606.265294736724, -25790.13885430144, -25867.090179034065, -26033.13106749242, -25610.889769114186, -25660.437953603592, -25709.168013415092, -25569.824594775288, -25732.30191489128, -25889.39176604255, -25729.758223910954, -25808.274508859773, -25638.239285290947, -25859.125107894786, -25560.01440077342, -25745.729717898535, -25804.867965406884], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.401701725574153, "mean_inference_ms": 0.24703473715479823, "mean_action_processing_ms": 0.05873847807541915, "mean_env_wait_ms": 1.4584480740725043, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0023856163024902344, "StateBufferConnector_ms": 0.0017464160919189453, "ViewRequirementAgentConnector_ms": 0.044191837310791016}}, "episode_reward_max": -25265.065962054505, "episode_reward_min": -26151.302070778504, "episode_reward_mean": -25725.67394293378, "episode_len_mean": 360.0, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-25946.441046369913, -25736.046238825897, -25745.792221471816, -25757.18296566674, -25977.129950764425, -25760.824563126018, -25769.812329952805, -25641.00711604146, -25670.716394367177, -25748.631074546764, -25660.03871004826, -25727.09740035645, -25926.264704644032, -25665.57958125113, -25763.954565868127, -25446.306983019582, -25722.919963325443, -25501.036084131996, -25828.842520491533, -25901.25261620219, -25822.875830047342, -25599.110810399325, -25332.38893781996, -25702.585527102023, -25877.640263218895, -25670.29335235874, -25811.00160919924, -25738.87637535293, -25706.803192808555, -25685.243412325974, -25417.971821182156, -25354.848353986778, -25939.107425157636, -25574.779808877727, -25667.602066555202, -25467.080325284947, -25680.299637230575, -25940.706903617378, -25979.154482656842, -25817.84423952501, -25611.069215305495, -25447.410392182308, -25592.70170342282, -25779.69322995973, -25744.830596774704, -26108.241970624844, -25864.90503722851, -25950.90009105484, -26014.647527882316, -25659.80341859398, -25997.67723298258, -25624.324028795298, -25911.37404977576, -25351.166906271006, -25611.41301363248, -25617.64346628109, -25548.094996977878, -26045.118213784343, -25564.877830007805, -25704.500037985872, -25492.64154021694, -25265.065962054505, -25778.36316369155, -25881.928155785667, -26072.264390486347, -25607.822119923723, -25606.638575328827, -25542.64381056869, -25568.85591304861, -25382.136227292147, -25954.705362132278, -25567.57184422557, -25657.18768976953, -26100.574437346037, -25757.28550122091, -25618.053292995486, -26029.62052649127, -25627.929491083225, -25743.887105443853, -26151.302070778504, -25672.852604474392, -25767.446060770482, -25672.48546610586, -25606.265294736724, -25790.13885430144, -25867.090179034065, -26033.13106749242, -25610.889769114186, -25660.437953603592, -25709.168013415092, -25569.824594775288, -25732.30191489128, -25889.39176604255, -25729.758223910954, -25808.274508859773, -25638.239285290947, -25859.125107894786, -25560.01440077342, -25745.729717898535, -25804.867965406884], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.401701725574153, "mean_inference_ms": 0.24703473715479823, "mean_action_processing_ms": 0.05873847807541915, "mean_env_wait_ms": 1.4584480740725043, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0023856163024902344, "StateBufferConnector_ms": 0.0017464160919189453, "ViewRequirementAgentConnector_ms": 0.044191837310791016}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 170640, "num_agent_steps_trained": 170640, "num_env_steps_sampled": 170640, "num_env_steps_trained": 170640, "num_env_steps_sampled_this_iter": 1800, "num_env_steps_trained_this_iter": 1800, "num_env_steps_sampled_throughput_per_sec": 162.21696086897228, "num_env_steps_trained_throughput_per_sec": 162.21696086897228, "timesteps_total": 170640, "num_steps_trained_this_iter": 1800, "agent_timesteps_total": 170640, "timers": {"training_iteration_time_ms": 2222.152, "sample_time_ms": 2214.953, "load_time_ms": 0.213, "load_throughput": 1687660.042, "learn_time_ms": 6.422, "learn_throughput": 56060.259, "synch_weights_time_ms": 0.532}, "counters": {"num_env_steps_sampled": 170640, "num_env_steps_trained": 170640, "num_agent_steps_sampled": 170640, "num_agent_steps_trained": 170640}, "done": false, "episodes_total": 474, "training_iteration": 95, "trial_id": "f5e97_00000", "date": "2023-07-25_17-13-33", "timestamp": 1690294413, "time_this_iter_s": 11.098309755325317, "time_total_s": 1058.689130306244, "pid": 71917, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[0, 0.003], [5400, 0.001], [10800, 0.00075], [16200, 0.0005], [21600, 0.00025], [27000, 0.0001], [32400, 7.5e-05], [37800, 5e-05], [43200, 2.5e-05], [48600, 1e-05], [54000, 7.5e-06], [59400, 5e-06], [64800, 2.5e-06], [70200, 1e-06], [75600, 5e-07], [81000, 1e-07]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x304530310>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1058.689130306244, "iterations_since_restore": 95, "perf": {"cpu_util_percent": 24.64375, "ram_util_percent": 79.21249999999999}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-07, "entropy_coeff": 0.1, "policy_entropy": -926.7001586914063, "policy_loss": -12462294423961.6, "vf_loss": 1086669216.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 2393.0, "diff_num_grad_updates_vs_sampler_policy": 2392.0}}, "num_env_steps_sampled": 172440, "num_env_steps_trained": 172440, "num_agent_steps_sampled": 172440, "num_agent_steps_trained": 172440}, "sampler_results": {"episode_reward_max": -25265.065962054505, "episode_reward_min": -26151.302070778504, "episode_reward_mean": -25713.374186205445, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-25760.824563126018, -25769.812329952805, -25641.00711604146, -25670.716394367177, -25748.631074546764, -25660.03871004826, -25727.09740035645, -25926.264704644032, -25665.57958125113, -25763.954565868127, -25446.306983019582, -25722.919963325443, -25501.036084131996, -25828.842520491533, -25901.25261620219, -25822.875830047342, -25599.110810399325, -25332.38893781996, -25702.585527102023, -25877.640263218895, -25670.29335235874, -25811.00160919924, -25738.87637535293, -25706.803192808555, -25685.243412325974, -25417.971821182156, -25354.848353986778, -25939.107425157636, -25574.779808877727, -25667.602066555202, -25467.080325284947, -25680.299637230575, -25940.706903617378, -25979.154482656842, -25817.84423952501, -25611.069215305495, -25447.410392182308, -25592.70170342282, -25779.69322995973, -25744.830596774704, -26108.241970624844, -25864.90503722851, -25950.90009105484, -26014.647527882316, -25659.80341859398, -25997.67723298258, -25624.324028795298, -25911.37404977576, -25351.166906271006, -25611.41301363248, -25617.64346628109, -25548.094996977878, -26045.118213784343, -25564.877830007805, -25704.500037985872, -25492.64154021694, -25265.065962054505, -25778.36316369155, -25881.928155785667, -26072.264390486347, -25607.822119923723, -25606.638575328827, -25542.64381056869, -25568.85591304861, -25382.136227292147, -25954.705362132278, -25567.57184422557, -25657.18768976953, -26100.574437346037, -25757.28550122091, -25618.053292995486, -26029.62052649127, -25627.929491083225, -25743.887105443853, -26151.302070778504, -25672.852604474392, -25767.446060770482, -25672.48546610586, -25606.265294736724, -25790.13885430144, -25867.090179034065, -26033.13106749242, -25610.889769114186, -25660.437953603592, -25709.168013415092, -25569.824594775288, -25732.30191489128, -25889.39176604255, -25729.758223910954, -25808.274508859773, -25638.239285290947, -25859.125107894786, -25560.01440077342, -25745.729717898535, -25804.867965406884, -25466.42580205111, -25600.832795789127, -25640.301030915405, -25634.036253129038, -25591.02086837972], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.401480368552233, "mean_inference_ms": 0.24702707298152904, "mean_action_processing_ms": 0.05873698833697978, "mean_env_wait_ms": 1.458294824888111, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002386808395385742, "StateBufferConnector_ms": 0.0017545223236083984, "ViewRequirementAgentConnector_ms": 0.044226646423339844}}, "episode_reward_max": -25265.065962054505, "episode_reward_min": -26151.302070778504, "episode_reward_mean": -25713.374186205445, "episode_len_mean": 360.0, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-25760.824563126018, -25769.812329952805, -25641.00711604146, -25670.716394367177, -25748.631074546764, -25660.03871004826, -25727.09740035645, -25926.264704644032, -25665.57958125113, -25763.954565868127, -25446.306983019582, -25722.919963325443, -25501.036084131996, -25828.842520491533, -25901.25261620219, -25822.875830047342, -25599.110810399325, -25332.38893781996, -25702.585527102023, -25877.640263218895, -25670.29335235874, -25811.00160919924, -25738.87637535293, -25706.803192808555, -25685.243412325974, -25417.971821182156, -25354.848353986778, -25939.107425157636, -25574.779808877727, -25667.602066555202, -25467.080325284947, -25680.299637230575, -25940.706903617378, -25979.154482656842, -25817.84423952501, -25611.069215305495, -25447.410392182308, -25592.70170342282, -25779.69322995973, -25744.830596774704, -26108.241970624844, -25864.90503722851, -25950.90009105484, -26014.647527882316, -25659.80341859398, -25997.67723298258, -25624.324028795298, -25911.37404977576, -25351.166906271006, -25611.41301363248, -25617.64346628109, -25548.094996977878, -26045.118213784343, -25564.877830007805, -25704.500037985872, -25492.64154021694, -25265.065962054505, -25778.36316369155, -25881.928155785667, -26072.264390486347, -25607.822119923723, -25606.638575328827, -25542.64381056869, -25568.85591304861, -25382.136227292147, -25954.705362132278, -25567.57184422557, -25657.18768976953, -26100.574437346037, -25757.28550122091, -25618.053292995486, -26029.62052649127, -25627.929491083225, -25743.887105443853, -26151.302070778504, -25672.852604474392, -25767.446060770482, -25672.48546610586, -25606.265294736724, -25790.13885430144, -25867.090179034065, -26033.13106749242, -25610.889769114186, -25660.437953603592, -25709.168013415092, -25569.824594775288, -25732.30191489128, -25889.39176604255, -25729.758223910954, -25808.274508859773, -25638.239285290947, -25859.125107894786, -25560.01440077342, -25745.729717898535, -25804.867965406884, -25466.42580205111, -25600.832795789127, -25640.301030915405, -25634.036253129038, -25591.02086837972], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.401480368552233, "mean_inference_ms": 0.24702707298152904, "mean_action_processing_ms": 0.05873698833697978, "mean_env_wait_ms": 1.458294824888111, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002386808395385742, "StateBufferConnector_ms": 0.0017545223236083984, "ViewRequirementAgentConnector_ms": 0.044226646423339844}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 172440, "num_agent_steps_trained": 172440, "num_env_steps_sampled": 172440, "num_env_steps_trained": 172440, "num_env_steps_sampled_this_iter": 1800, "num_env_steps_trained_this_iter": 1800, "num_env_steps_sampled_throughput_per_sec": 160.69392813731238, "num_env_steps_trained_throughput_per_sec": 160.69392813731238, "timesteps_total": 172440, "num_steps_trained_this_iter": 1800, "agent_timesteps_total": 172440, "timers": {"training_iteration_time_ms": 2229.758, "sample_time_ms": 2222.713, "load_time_ms": 0.217, "load_throughput": 1656009.476, "learn_time_ms": 6.284, "learn_throughput": 57287.061, "synch_weights_time_ms": 0.512}, "counters": {"num_env_steps_sampled": 172440, "num_env_steps_trained": 172440, "num_agent_steps_sampled": 172440, "num_agent_steps_trained": 172440}, "done": false, "episodes_total": 479, "training_iteration": 96, "trial_id": "f5e97_00000", "date": "2023-07-25_17-13-44", "timestamp": 1690294424, "time_this_iter_s": 11.203515768051147, "time_total_s": 1069.892646074295, "pid": 71917, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[0, 0.003], [5400, 0.001], [10800, 0.00075], [16200, 0.0005], [21600, 0.00025], [27000, 0.0001], [32400, 7.5e-05], [37800, 5e-05], [43200, 2.5e-05], [48600, 1e-05], [54000, 7.5e-06], [59400, 5e-06], [64800, 2.5e-06], [70200, 1e-06], [75600, 5e-07], [81000, 1e-07]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x304530310>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1069.892646074295, "iterations_since_restore": 96, "perf": {"cpu_util_percent": 25.91875, "ram_util_percent": 79.61875}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-07, "entropy_coeff": 0.1, "policy_entropy": -926.6997680664062, "policy_loss": -37695326838784.0, "vf_loss": 1118417459.2}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 2418.0, "diff_num_grad_updates_vs_sampler_policy": 2417.0}}, "num_env_steps_sampled": 174240, "num_env_steps_trained": 174240, "num_agent_steps_sampled": 174240, "num_agent_steps_trained": 174240}, "sampler_results": {"episode_reward_max": -25265.065962054505, "episode_reward_min": -26151.302070778504, "episode_reward_mean": -25707.449567083182, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-25660.03871004826, -25727.09740035645, -25926.264704644032, -25665.57958125113, -25763.954565868127, -25446.306983019582, -25722.919963325443, -25501.036084131996, -25828.842520491533, -25901.25261620219, -25822.875830047342, -25599.110810399325, -25332.38893781996, -25702.585527102023, -25877.640263218895, -25670.29335235874, -25811.00160919924, -25738.87637535293, -25706.803192808555, -25685.243412325974, -25417.971821182156, -25354.848353986778, -25939.107425157636, -25574.779808877727, -25667.602066555202, -25467.080325284947, -25680.299637230575, -25940.706903617378, -25979.154482656842, -25817.84423952501, -25611.069215305495, -25447.410392182308, -25592.70170342282, -25779.69322995973, -25744.830596774704, -26108.241970624844, -25864.90503722851, -25950.90009105484, -26014.647527882316, -25659.80341859398, -25997.67723298258, -25624.324028795298, -25911.37404977576, -25351.166906271006, -25611.41301363248, -25617.64346628109, -25548.094996977878, -26045.118213784343, -25564.877830007805, -25704.500037985872, -25492.64154021694, -25265.065962054505, -25778.36316369155, -25881.928155785667, -26072.264390486347, -25607.822119923723, -25606.638575328827, -25542.64381056869, -25568.85591304861, -25382.136227292147, -25954.705362132278, -25567.57184422557, -25657.18768976953, -26100.574437346037, -25757.28550122091, -25618.053292995486, -26029.62052649127, -25627.929491083225, -25743.887105443853, -26151.302070778504, -25672.852604474392, -25767.446060770482, -25672.48546610586, -25606.265294736724, -25790.13885430144, -25867.090179034065, -26033.13106749242, -25610.889769114186, -25660.437953603592, -25709.168013415092, -25569.824594775288, -25732.30191489128, -25889.39176604255, -25729.758223910954, -25808.274508859773, -25638.239285290947, -25859.125107894786, -25560.01440077342, -25745.729717898535, -25804.867965406884, -25466.42580205111, -25600.832795789127, -25640.301030915405, -25634.036253129038, -25591.02086837972, -25533.861930354342, -25760.32686276445, -25396.99210688679, -25382.538476417383, -25924.810189384803], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.40129066257269, "mean_inference_ms": 0.24701967266839134, "mean_action_processing_ms": 0.05873547331856221, "mean_env_wait_ms": 1.4581554283440912, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0023849010467529297, "StateBufferConnector_ms": 0.0017518997192382812, "ViewRequirementAgentConnector_ms": 0.044217586517333984}}, "episode_reward_max": -25265.065962054505, "episode_reward_min": -26151.302070778504, "episode_reward_mean": -25707.449567083182, "episode_len_mean": 360.0, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-25660.03871004826, -25727.09740035645, -25926.264704644032, -25665.57958125113, -25763.954565868127, -25446.306983019582, -25722.919963325443, -25501.036084131996, -25828.842520491533, -25901.25261620219, -25822.875830047342, -25599.110810399325, -25332.38893781996, -25702.585527102023, -25877.640263218895, -25670.29335235874, -25811.00160919924, -25738.87637535293, -25706.803192808555, -25685.243412325974, -25417.971821182156, -25354.848353986778, -25939.107425157636, -25574.779808877727, -25667.602066555202, -25467.080325284947, -25680.299637230575, -25940.706903617378, -25979.154482656842, -25817.84423952501, -25611.069215305495, -25447.410392182308, -25592.70170342282, -25779.69322995973, -25744.830596774704, -26108.241970624844, -25864.90503722851, -25950.90009105484, -26014.647527882316, -25659.80341859398, -25997.67723298258, -25624.324028795298, -25911.37404977576, -25351.166906271006, -25611.41301363248, -25617.64346628109, -25548.094996977878, -26045.118213784343, -25564.877830007805, -25704.500037985872, -25492.64154021694, -25265.065962054505, -25778.36316369155, -25881.928155785667, -26072.264390486347, -25607.822119923723, -25606.638575328827, -25542.64381056869, -25568.85591304861, -25382.136227292147, -25954.705362132278, -25567.57184422557, -25657.18768976953, -26100.574437346037, -25757.28550122091, -25618.053292995486, -26029.62052649127, -25627.929491083225, -25743.887105443853, -26151.302070778504, -25672.852604474392, -25767.446060770482, -25672.48546610586, -25606.265294736724, -25790.13885430144, -25867.090179034065, -26033.13106749242, -25610.889769114186, -25660.437953603592, -25709.168013415092, -25569.824594775288, -25732.30191489128, -25889.39176604255, -25729.758223910954, -25808.274508859773, -25638.239285290947, -25859.125107894786, -25560.01440077342, -25745.729717898535, -25804.867965406884, -25466.42580205111, -25600.832795789127, -25640.301030915405, -25634.036253129038, -25591.02086837972, -25533.861930354342, -25760.32686276445, -25396.99210688679, -25382.538476417383, -25924.810189384803], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.40129066257269, "mean_inference_ms": 0.24701967266839134, "mean_action_processing_ms": 0.05873547331856221, "mean_env_wait_ms": 1.4581554283440912, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0023849010467529297, "StateBufferConnector_ms": 0.0017518997192382812, "ViewRequirementAgentConnector_ms": 0.044217586517333984}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 174240, "num_agent_steps_trained": 174240, "num_env_steps_sampled": 174240, "num_env_steps_trained": 174240, "num_env_steps_sampled_this_iter": 1800, "num_env_steps_trained_this_iter": 1800, "num_env_steps_sampled_throughput_per_sec": 161.32250075941639, "num_env_steps_trained_throughput_per_sec": 161.32250075941639, "timesteps_total": 174240, "num_steps_trained_this_iter": 1800, "agent_timesteps_total": 174240, "timers": {"training_iteration_time_ms": 2235.91, "sample_time_ms": 2228.346, "load_time_ms": 0.222, "load_throughput": 1623426.986, "learn_time_ms": 6.782, "learn_throughput": 53078.458, "synch_weights_time_ms": 0.528}, "counters": {"num_env_steps_sampled": 174240, "num_env_steps_trained": 174240, "num_agent_steps_sampled": 174240, "num_agent_steps_trained": 174240}, "done": false, "episodes_total": 484, "training_iteration": 97, "trial_id": "f5e97_00000", "date": "2023-07-25_17-13-56", "timestamp": 1690294436, "time_this_iter_s": 11.159889221191406, "time_total_s": 1081.0525352954865, "pid": 71917, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[0, 0.003], [5400, 0.001], [10800, 0.00075], [16200, 0.0005], [21600, 0.00025], [27000, 0.0001], [32400, 7.5e-05], [37800, 5e-05], [43200, 2.5e-05], [48600, 1e-05], [54000, 7.5e-06], [59400, 5e-06], [64800, 2.5e-06], [70200, 1e-06], [75600, 5e-07], [81000, 1e-07]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x304530310>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1081.0525352954865, "iterations_since_restore": 97, "perf": {"cpu_util_percent": 23.98125, "ram_util_percent": 79.6625}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-07, "entropy_coeff": 0.1, "policy_entropy": -926.6997802734375, "policy_loss": -23007938921676.8, "vf_loss": 1109062099.2}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 2443.0, "diff_num_grad_updates_vs_sampler_policy": 2442.0}}, "num_env_steps_sampled": 176040, "num_env_steps_trained": 176040, "num_agent_steps_sampled": 176040, "num_agent_steps_trained": 176040}, "sampler_results": {"episode_reward_max": -25265.065962054505, "episode_reward_min": -26151.302070778504, "episode_reward_mean": -25709.07344358188, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-25446.306983019582, -25722.919963325443, -25501.036084131996, -25828.842520491533, -25901.25261620219, -25822.875830047342, -25599.110810399325, -25332.38893781996, -25702.585527102023, -25877.640263218895, -25670.29335235874, -25811.00160919924, -25738.87637535293, -25706.803192808555, -25685.243412325974, -25417.971821182156, -25354.848353986778, -25939.107425157636, -25574.779808877727, -25667.602066555202, -25467.080325284947, -25680.299637230575, -25940.706903617378, -25979.154482656842, -25817.84423952501, -25611.069215305495, -25447.410392182308, -25592.70170342282, -25779.69322995973, -25744.830596774704, -26108.241970624844, -25864.90503722851, -25950.90009105484, -26014.647527882316, -25659.80341859398, -25997.67723298258, -25624.324028795298, -25911.37404977576, -25351.166906271006, -25611.41301363248, -25617.64346628109, -25548.094996977878, -26045.118213784343, -25564.877830007805, -25704.500037985872, -25492.64154021694, -25265.065962054505, -25778.36316369155, -25881.928155785667, -26072.264390486347, -25607.822119923723, -25606.638575328827, -25542.64381056869, -25568.85591304861, -25382.136227292147, -25954.705362132278, -25567.57184422557, -25657.18768976953, -26100.574437346037, -25757.28550122091, -25618.053292995486, -26029.62052649127, -25627.929491083225, -25743.887105443853, -26151.302070778504, -25672.852604474392, -25767.446060770482, -25672.48546610586, -25606.265294736724, -25790.13885430144, -25867.090179034065, -26033.13106749242, -25610.889769114186, -25660.437953603592, -25709.168013415092, -25569.824594775288, -25732.30191489128, -25889.39176604255, -25729.758223910954, -25808.274508859773, -25638.239285290947, -25859.125107894786, -25560.01440077342, -25745.729717898535, -25804.867965406884, -25466.42580205111, -25600.832795789127, -25640.301030915405, -25634.036253129038, -25591.02086837972, -25533.861930354342, -25760.32686276445, -25396.99210688679, -25382.538476417383, -25924.810189384803, -25861.887425342076, -25855.252276196476, -25551.072579589287, -25775.999586885166, -25861.110744025074], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.4011255200124, "mean_inference_ms": 0.24701427888221442, "mean_action_processing_ms": 0.05873413287178195, "mean_env_wait_ms": 1.458006153704104, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002389192581176758, "StateBufferConnector_ms": 0.0017590522766113281, "ViewRequirementAgentConnector_ms": 0.0442652702331543}}, "episode_reward_max": -25265.065962054505, "episode_reward_min": -26151.302070778504, "episode_reward_mean": -25709.07344358188, "episode_len_mean": 360.0, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-25446.306983019582, -25722.919963325443, -25501.036084131996, -25828.842520491533, -25901.25261620219, -25822.875830047342, -25599.110810399325, -25332.38893781996, -25702.585527102023, -25877.640263218895, -25670.29335235874, -25811.00160919924, -25738.87637535293, -25706.803192808555, -25685.243412325974, -25417.971821182156, -25354.848353986778, -25939.107425157636, -25574.779808877727, -25667.602066555202, -25467.080325284947, -25680.299637230575, -25940.706903617378, -25979.154482656842, -25817.84423952501, -25611.069215305495, -25447.410392182308, -25592.70170342282, -25779.69322995973, -25744.830596774704, -26108.241970624844, -25864.90503722851, -25950.90009105484, -26014.647527882316, -25659.80341859398, -25997.67723298258, -25624.324028795298, -25911.37404977576, -25351.166906271006, -25611.41301363248, -25617.64346628109, -25548.094996977878, -26045.118213784343, -25564.877830007805, -25704.500037985872, -25492.64154021694, -25265.065962054505, -25778.36316369155, -25881.928155785667, -26072.264390486347, -25607.822119923723, -25606.638575328827, -25542.64381056869, -25568.85591304861, -25382.136227292147, -25954.705362132278, -25567.57184422557, -25657.18768976953, -26100.574437346037, -25757.28550122091, -25618.053292995486, -26029.62052649127, -25627.929491083225, -25743.887105443853, -26151.302070778504, -25672.852604474392, -25767.446060770482, -25672.48546610586, -25606.265294736724, -25790.13885430144, -25867.090179034065, -26033.13106749242, -25610.889769114186, -25660.437953603592, -25709.168013415092, -25569.824594775288, -25732.30191489128, -25889.39176604255, -25729.758223910954, -25808.274508859773, -25638.239285290947, -25859.125107894786, -25560.01440077342, -25745.729717898535, -25804.867965406884, -25466.42580205111, -25600.832795789127, -25640.301030915405, -25634.036253129038, -25591.02086837972, -25533.861930354342, -25760.32686276445, -25396.99210688679, -25382.538476417383, -25924.810189384803, -25861.887425342076, -25855.252276196476, -25551.072579589287, -25775.999586885166, -25861.110744025074], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.4011255200124, "mean_inference_ms": 0.24701427888221442, "mean_action_processing_ms": 0.05873413287178195, "mean_env_wait_ms": 1.458006153704104, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002389192581176758, "StateBufferConnector_ms": 0.0017590522766113281, "ViewRequirementAgentConnector_ms": 0.0442652702331543}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 176040, "num_agent_steps_trained": 176040, "num_env_steps_sampled": 176040, "num_env_steps_trained": 176040, "num_env_steps_sampled_this_iter": 1800, "num_env_steps_trained_this_iter": 1800, "num_env_steps_sampled_throughput_per_sec": 161.6730340136334, "num_env_steps_trained_throughput_per_sec": 161.6730340136334, "timesteps_total": 176040, "num_steps_trained_this_iter": 1800, "agent_timesteps_total": 176040, "timers": {"training_iteration_time_ms": 2229.126, "sample_time_ms": 2221.559, "load_time_ms": 0.217, "load_throughput": 1657281.791, "learn_time_ms": 6.787, "learn_throughput": 53045.826, "synch_weights_time_ms": 0.531}, "counters": {"num_env_steps_sampled": 176040, "num_env_steps_trained": 176040, "num_agent_steps_sampled": 176040, "num_agent_steps_trained": 176040}, "done": false, "episodes_total": 489, "training_iteration": 98, "trial_id": "f5e97_00000", "date": "2023-07-25_17-14-07", "timestamp": 1690294447, "time_this_iter_s": 11.135720014572144, "time_total_s": 1092.1882553100586, "pid": 71917, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[0, 0.003], [5400, 0.001], [10800, 0.00075], [16200, 0.0005], [21600, 0.00025], [27000, 0.0001], [32400, 7.5e-05], [37800, 5e-05], [43200, 2.5e-05], [48600, 1e-05], [54000, 7.5e-06], [59400, 5e-06], [64800, 2.5e-06], [70200, 1e-06], [75600, 5e-07], [81000, 1e-07]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x304530310>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1092.1882553100586, "iterations_since_restore": 98, "perf": {"cpu_util_percent": 22.674999999999997, "ram_util_percent": 79.66874999999999}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-07, "entropy_coeff": 0.1, "policy_entropy": -926.7, "policy_loss": -13212642036940.8, "vf_loss": 1088044211.2}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 2468.0, "diff_num_grad_updates_vs_sampler_policy": 2467.0}}, "num_env_steps_sampled": 177840, "num_env_steps_trained": 177840, "num_agent_steps_sampled": 177840, "num_agent_steps_trained": 177840}, "sampler_results": {"episode_reward_max": -25265.065962054505, "episode_reward_min": -26151.302070778504, "episode_reward_mean": -25704.639188014367, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-25822.875830047342, -25599.110810399325, -25332.38893781996, -25702.585527102023, -25877.640263218895, -25670.29335235874, -25811.00160919924, -25738.87637535293, -25706.803192808555, -25685.243412325974, -25417.971821182156, -25354.848353986778, -25939.107425157636, -25574.779808877727, -25667.602066555202, -25467.080325284947, -25680.299637230575, -25940.706903617378, -25979.154482656842, -25817.84423952501, -25611.069215305495, -25447.410392182308, -25592.70170342282, -25779.69322995973, -25744.830596774704, -26108.241970624844, -25864.90503722851, -25950.90009105484, -26014.647527882316, -25659.80341859398, -25997.67723298258, -25624.324028795298, -25911.37404977576, -25351.166906271006, -25611.41301363248, -25617.64346628109, -25548.094996977878, -26045.118213784343, -25564.877830007805, -25704.500037985872, -25492.64154021694, -25265.065962054505, -25778.36316369155, -25881.928155785667, -26072.264390486347, -25607.822119923723, -25606.638575328827, -25542.64381056869, -25568.85591304861, -25382.136227292147, -25954.705362132278, -25567.57184422557, -25657.18768976953, -26100.574437346037, -25757.28550122091, -25618.053292995486, -26029.62052649127, -25627.929491083225, -25743.887105443853, -26151.302070778504, -25672.852604474392, -25767.446060770482, -25672.48546610586, -25606.265294736724, -25790.13885430144, -25867.090179034065, -26033.13106749242, -25610.889769114186, -25660.437953603592, -25709.168013415092, -25569.824594775288, -25732.30191489128, -25889.39176604255, -25729.758223910954, -25808.274508859773, -25638.239285290947, -25859.125107894786, -25560.01440077342, -25745.729717898535, -25804.867965406884, -25466.42580205111, -25600.832795789127, -25640.301030915405, -25634.036253129038, -25591.02086837972, -25533.861930354342, -25760.32686276445, -25396.99210688679, -25382.538476417383, -25924.810189384803, -25861.887425342076, -25855.252276196476, -25551.072579589287, -25775.999586885166, -25861.110744025074, -25756.456716678895, -25617.208873794578, -25597.01947128544, -25343.268552303653, -25642.9789963566], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.400976460047249, "mean_inference_ms": 0.24701247724020037, "mean_action_processing_ms": 0.058733354878234036, "mean_env_wait_ms": 1.457873641897852, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002381563186645508, "StateBufferConnector_ms": 0.0017578601837158203, "ViewRequirementAgentConnector_ms": 0.04426741600036621}}, "episode_reward_max": -25265.065962054505, "episode_reward_min": -26151.302070778504, "episode_reward_mean": -25704.639188014367, "episode_len_mean": 360.0, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-25822.875830047342, -25599.110810399325, -25332.38893781996, -25702.585527102023, -25877.640263218895, -25670.29335235874, -25811.00160919924, -25738.87637535293, -25706.803192808555, -25685.243412325974, -25417.971821182156, -25354.848353986778, -25939.107425157636, -25574.779808877727, -25667.602066555202, -25467.080325284947, -25680.299637230575, -25940.706903617378, -25979.154482656842, -25817.84423952501, -25611.069215305495, -25447.410392182308, -25592.70170342282, -25779.69322995973, -25744.830596774704, -26108.241970624844, -25864.90503722851, -25950.90009105484, -26014.647527882316, -25659.80341859398, -25997.67723298258, -25624.324028795298, -25911.37404977576, -25351.166906271006, -25611.41301363248, -25617.64346628109, -25548.094996977878, -26045.118213784343, -25564.877830007805, -25704.500037985872, -25492.64154021694, -25265.065962054505, -25778.36316369155, -25881.928155785667, -26072.264390486347, -25607.822119923723, -25606.638575328827, -25542.64381056869, -25568.85591304861, -25382.136227292147, -25954.705362132278, -25567.57184422557, -25657.18768976953, -26100.574437346037, -25757.28550122091, -25618.053292995486, -26029.62052649127, -25627.929491083225, -25743.887105443853, -26151.302070778504, -25672.852604474392, -25767.446060770482, -25672.48546610586, -25606.265294736724, -25790.13885430144, -25867.090179034065, -26033.13106749242, -25610.889769114186, -25660.437953603592, -25709.168013415092, -25569.824594775288, -25732.30191489128, -25889.39176604255, -25729.758223910954, -25808.274508859773, -25638.239285290947, -25859.125107894786, -25560.01440077342, -25745.729717898535, -25804.867965406884, -25466.42580205111, -25600.832795789127, -25640.301030915405, -25634.036253129038, -25591.02086837972, -25533.861930354342, -25760.32686276445, -25396.99210688679, -25382.538476417383, -25924.810189384803, -25861.887425342076, -25855.252276196476, -25551.072579589287, -25775.999586885166, -25861.110744025074, -25756.456716678895, -25617.208873794578, -25597.01947128544, -25343.268552303653, -25642.9789963566], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.400976460047249, "mean_inference_ms": 0.24701247724020037, "mean_action_processing_ms": 0.058733354878234036, "mean_env_wait_ms": 1.457873641897852, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002381563186645508, "StateBufferConnector_ms": 0.0017578601837158203, "ViewRequirementAgentConnector_ms": 0.04426741600036621}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 177840, "num_agent_steps_trained": 177840, "num_env_steps_sampled": 177840, "num_env_steps_trained": 177840, "num_env_steps_sampled_this_iter": 1800, "num_env_steps_trained_this_iter": 1800, "num_env_steps_sampled_throughput_per_sec": 162.1737944793977, "num_env_steps_trained_throughput_per_sec": 162.1737944793977, "timesteps_total": 177840, "num_steps_trained_this_iter": 1800, "agent_timesteps_total": 177840, "timers": {"training_iteration_time_ms": 2223.269, "sample_time_ms": 2216.226, "load_time_ms": 0.215, "load_throughput": 1672888.81, "learn_time_ms": 6.294, "learn_throughput": 57194.405, "synch_weights_time_ms": 0.502}, "counters": {"num_env_steps_sampled": 177840, "num_env_steps_trained": 177840, "num_agent_steps_sampled": 177840, "num_agent_steps_trained": 177840}, "done": false, "episodes_total": 494, "training_iteration": 99, "trial_id": "f5e97_00000", "date": "2023-07-25_17-14-18", "timestamp": 1690294458, "time_this_iter_s": 11.101241827011108, "time_total_s": 1103.2894971370697, "pid": 71917, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[0, 0.003], [5400, 0.001], [10800, 0.00075], [16200, 0.0005], [21600, 0.00025], [27000, 0.0001], [32400, 7.5e-05], [37800, 5e-05], [43200, 2.5e-05], [48600, 1e-05], [54000, 7.5e-06], [59400, 5e-06], [64800, 2.5e-06], [70200, 1e-06], [75600, 5e-07], [81000, 1e-07]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x304530310>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1103.2894971370697, "iterations_since_restore": 99, "perf": {"cpu_util_percent": 23.1, "ram_util_percent": 79.51333333333334}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-07, "entropy_coeff": 0.1, "policy_entropy": -926.7000244140625, "policy_loss": -25500205082214.4, "vf_loss": 1078528793.6}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 2493.0, "diff_num_grad_updates_vs_sampler_policy": 2492.0}}, "num_env_steps_sampled": 179640, "num_env_steps_trained": 179640, "num_agent_steps_sampled": 179640, "num_agent_steps_trained": 179640}, "sampler_results": {"episode_reward_max": -25265.065962054505, "episode_reward_min": -26151.302070778504, "episode_reward_mean": -25707.80063175023, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-25670.29335235874, -25811.00160919924, -25738.87637535293, -25706.803192808555, -25685.243412325974, -25417.971821182156, -25354.848353986778, -25939.107425157636, -25574.779808877727, -25667.602066555202, -25467.080325284947, -25680.299637230575, -25940.706903617378, -25979.154482656842, -25817.84423952501, -25611.069215305495, -25447.410392182308, -25592.70170342282, -25779.69322995973, -25744.830596774704, -26108.241970624844, -25864.90503722851, -25950.90009105484, -26014.647527882316, -25659.80341859398, -25997.67723298258, -25624.324028795298, -25911.37404977576, -25351.166906271006, -25611.41301363248, -25617.64346628109, -25548.094996977878, -26045.118213784343, -25564.877830007805, -25704.500037985872, -25492.64154021694, -25265.065962054505, -25778.36316369155, -25881.928155785667, -26072.264390486347, -25607.822119923723, -25606.638575328827, -25542.64381056869, -25568.85591304861, -25382.136227292147, -25954.705362132278, -25567.57184422557, -25657.18768976953, -26100.574437346037, -25757.28550122091, -25618.053292995486, -26029.62052649127, -25627.929491083225, -25743.887105443853, -26151.302070778504, -25672.852604474392, -25767.446060770482, -25672.48546610586, -25606.265294736724, -25790.13885430144, -25867.090179034065, -26033.13106749242, -25610.889769114186, -25660.437953603592, -25709.168013415092, -25569.824594775288, -25732.30191489128, -25889.39176604255, -25729.758223910954, -25808.274508859773, -25638.239285290947, -25859.125107894786, -25560.01440077342, -25745.729717898535, -25804.867965406884, -25466.42580205111, -25600.832795789127, -25640.301030915405, -25634.036253129038, -25591.02086837972, -25533.861930354342, -25760.32686276445, -25396.99210688679, -25382.538476417383, -25924.810189384803, -25861.887425342076, -25855.252276196476, -25551.072579589287, -25775.999586885166, -25861.110744025074, -25756.456716678895, -25617.208873794578, -25597.01947128544, -25343.268552303653, -25642.9789963566, -25862.808243320793, -25862.541120017588, -25623.5428424464, -25695.679217461256, -25606.17431892844], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.400837954775487, "mean_inference_ms": 0.2470085960356481, "mean_action_processing_ms": 0.058732449245863065, "mean_env_wait_ms": 1.4577485652019895, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002389192581176758, "StateBufferConnector_ms": 0.0017540454864501953, "ViewRequirementAgentConnector_ms": 0.044478416442871094}}, "episode_reward_max": -25265.065962054505, "episode_reward_min": -26151.302070778504, "episode_reward_mean": -25707.80063175023, "episode_len_mean": 360.0, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-25670.29335235874, -25811.00160919924, -25738.87637535293, -25706.803192808555, -25685.243412325974, -25417.971821182156, -25354.848353986778, -25939.107425157636, -25574.779808877727, -25667.602066555202, -25467.080325284947, -25680.299637230575, -25940.706903617378, -25979.154482656842, -25817.84423952501, -25611.069215305495, -25447.410392182308, -25592.70170342282, -25779.69322995973, -25744.830596774704, -26108.241970624844, -25864.90503722851, -25950.90009105484, -26014.647527882316, -25659.80341859398, -25997.67723298258, -25624.324028795298, -25911.37404977576, -25351.166906271006, -25611.41301363248, -25617.64346628109, -25548.094996977878, -26045.118213784343, -25564.877830007805, -25704.500037985872, -25492.64154021694, -25265.065962054505, -25778.36316369155, -25881.928155785667, -26072.264390486347, -25607.822119923723, -25606.638575328827, -25542.64381056869, -25568.85591304861, -25382.136227292147, -25954.705362132278, -25567.57184422557, -25657.18768976953, -26100.574437346037, -25757.28550122091, -25618.053292995486, -26029.62052649127, -25627.929491083225, -25743.887105443853, -26151.302070778504, -25672.852604474392, -25767.446060770482, -25672.48546610586, -25606.265294736724, -25790.13885430144, -25867.090179034065, -26033.13106749242, -25610.889769114186, -25660.437953603592, -25709.168013415092, -25569.824594775288, -25732.30191489128, -25889.39176604255, -25729.758223910954, -25808.274508859773, -25638.239285290947, -25859.125107894786, -25560.01440077342, -25745.729717898535, -25804.867965406884, -25466.42580205111, -25600.832795789127, -25640.301030915405, -25634.036253129038, -25591.02086837972, -25533.861930354342, -25760.32686276445, -25396.99210688679, -25382.538476417383, -25924.810189384803, -25861.887425342076, -25855.252276196476, -25551.072579589287, -25775.999586885166, -25861.110744025074, -25756.456716678895, -25617.208873794578, -25597.01947128544, -25343.268552303653, -25642.9789963566, -25862.808243320793, -25862.541120017588, -25623.5428424464, -25695.679217461256, -25606.17431892844], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.400837954775487, "mean_inference_ms": 0.2470085960356481, "mean_action_processing_ms": 0.058732449245863065, "mean_env_wait_ms": 1.4577485652019895, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002389192581176758, "StateBufferConnector_ms": 0.0017540454864501953, "ViewRequirementAgentConnector_ms": 0.044478416442871094}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 179640, "num_agent_steps_trained": 179640, "num_env_steps_sampled": 179640, "num_env_steps_trained": 179640, "num_env_steps_sampled_this_iter": 1800, "num_env_steps_trained_this_iter": 1800, "num_env_steps_sampled_throughput_per_sec": 161.8285775430487, "num_env_steps_trained_throughput_per_sec": 161.8285775430487, "timesteps_total": 179640, "num_steps_trained_this_iter": 1800, "agent_timesteps_total": 179640, "timers": {"training_iteration_time_ms": 2222.199, "sample_time_ms": 2214.934, "load_time_ms": 0.303, "load_throughput": 1186227.858, "learn_time_ms": 6.41, "learn_throughput": 56166.401, "synch_weights_time_ms": 0.516}, "counters": {"num_env_steps_sampled": 179640, "num_env_steps_trained": 179640, "num_agent_steps_sampled": 179640, "num_agent_steps_trained": 179640}, "done": false, "episodes_total": 499, "training_iteration": 100, "trial_id": "f5e97_00000", "date": "2023-07-25_17-14-29", "timestamp": 1690294469, "time_this_iter_s": 11.125001907348633, "time_total_s": 1114.4144990444183, "pid": 71917, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[0, 0.003], [5400, 0.001], [10800, 0.00075], [16200, 0.0005], [21600, 0.00025], [27000, 0.0001], [32400, 7.5e-05], [37800, 5e-05], [43200, 2.5e-05], [48600, 1e-05], [54000, 7.5e-06], [59400, 5e-06], [64800, 2.5e-06], [70200, 1e-06], [75600, 5e-07], [81000, 1e-07]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x304530310>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1114.4144990444183, "iterations_since_restore": 100, "perf": {"cpu_util_percent": 24.30625, "ram_util_percent": 77.24375}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-07, "entropy_coeff": 0.1, "policy_entropy": -926.6997192382812, "policy_loss": -15424656991846.4, "vf_loss": 1089764595.2}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 2518.0, "diff_num_grad_updates_vs_sampler_policy": 2517.0}}, "num_env_steps_sampled": 181440, "num_env_steps_trained": 181440, "num_agent_steps_sampled": 181440, "num_agent_steps_trained": 181440}, "sampler_results": {"episode_reward_max": -25265.065962054505, "episode_reward_min": -26151.302070778504, "episode_reward_mean": -25712.18328913542, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-25417.971821182156, -25354.848353986778, -25939.107425157636, -25574.779808877727, -25667.602066555202, -25467.080325284947, -25680.299637230575, -25940.706903617378, -25979.154482656842, -25817.84423952501, -25611.069215305495, -25447.410392182308, -25592.70170342282, -25779.69322995973, -25744.830596774704, -26108.241970624844, -25864.90503722851, -25950.90009105484, -26014.647527882316, -25659.80341859398, -25997.67723298258, -25624.324028795298, -25911.37404977576, -25351.166906271006, -25611.41301363248, -25617.64346628109, -25548.094996977878, -26045.118213784343, -25564.877830007805, -25704.500037985872, -25492.64154021694, -25265.065962054505, -25778.36316369155, -25881.928155785667, -26072.264390486347, -25607.822119923723, -25606.638575328827, -25542.64381056869, -25568.85591304861, -25382.136227292147, -25954.705362132278, -25567.57184422557, -25657.18768976953, -26100.574437346037, -25757.28550122091, -25618.053292995486, -26029.62052649127, -25627.929491083225, -25743.887105443853, -26151.302070778504, -25672.852604474392, -25767.446060770482, -25672.48546610586, -25606.265294736724, -25790.13885430144, -25867.090179034065, -26033.13106749242, -25610.889769114186, -25660.437953603592, -25709.168013415092, -25569.824594775288, -25732.30191489128, -25889.39176604255, -25729.758223910954, -25808.274508859773, -25638.239285290947, -25859.125107894786, -25560.01440077342, -25745.729717898535, -25804.867965406884, -25466.42580205111, -25600.832795789127, -25640.301030915405, -25634.036253129038, -25591.02086837972, -25533.861930354342, -25760.32686276445, -25396.99210688679, -25382.538476417383, -25924.810189384803, -25861.887425342076, -25855.252276196476, -25551.072579589287, -25775.999586885166, -25861.110744025074, -25756.456716678895, -25617.208873794578, -25597.01947128544, -25343.268552303653, -25642.9789963566, -25862.808243320793, -25862.541120017588, -25623.5428424464, -25695.679217461256, -25606.17431892844, -25816.19716164555, -25863.72833337226, -25798.788931450992, -25862.58342297002, -25709.185831124872], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.400704453078184, "mean_inference_ms": 0.24700262496023476, "mean_action_processing_ms": 0.058731337582175434, "mean_env_wait_ms": 1.4576161786895534, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0023856163024902344, "StateBufferConnector_ms": 0.0017616748809814453, "ViewRequirementAgentConnector_ms": 0.04442548751831055}}, "episode_reward_max": -25265.065962054505, "episode_reward_min": -26151.302070778504, "episode_reward_mean": -25712.18328913542, "episode_len_mean": 360.0, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-25417.971821182156, -25354.848353986778, -25939.107425157636, -25574.779808877727, -25667.602066555202, -25467.080325284947, -25680.299637230575, -25940.706903617378, -25979.154482656842, -25817.84423952501, -25611.069215305495, -25447.410392182308, -25592.70170342282, -25779.69322995973, -25744.830596774704, -26108.241970624844, -25864.90503722851, -25950.90009105484, -26014.647527882316, -25659.80341859398, -25997.67723298258, -25624.324028795298, -25911.37404977576, -25351.166906271006, -25611.41301363248, -25617.64346628109, -25548.094996977878, -26045.118213784343, -25564.877830007805, -25704.500037985872, -25492.64154021694, -25265.065962054505, -25778.36316369155, -25881.928155785667, -26072.264390486347, -25607.822119923723, -25606.638575328827, -25542.64381056869, -25568.85591304861, -25382.136227292147, -25954.705362132278, -25567.57184422557, -25657.18768976953, -26100.574437346037, -25757.28550122091, -25618.053292995486, -26029.62052649127, -25627.929491083225, -25743.887105443853, -26151.302070778504, -25672.852604474392, -25767.446060770482, -25672.48546610586, -25606.265294736724, -25790.13885430144, -25867.090179034065, -26033.13106749242, -25610.889769114186, -25660.437953603592, -25709.168013415092, -25569.824594775288, -25732.30191489128, -25889.39176604255, -25729.758223910954, -25808.274508859773, -25638.239285290947, -25859.125107894786, -25560.01440077342, -25745.729717898535, -25804.867965406884, -25466.42580205111, -25600.832795789127, -25640.301030915405, -25634.036253129038, -25591.02086837972, -25533.861930354342, -25760.32686276445, -25396.99210688679, -25382.538476417383, -25924.810189384803, -25861.887425342076, -25855.252276196476, -25551.072579589287, -25775.999586885166, -25861.110744025074, -25756.456716678895, -25617.208873794578, -25597.01947128544, -25343.268552303653, -25642.9789963566, -25862.808243320793, -25862.541120017588, -25623.5428424464, -25695.679217461256, -25606.17431892844, -25816.19716164555, -25863.72833337226, -25798.788931450992, -25862.58342297002, -25709.185831124872], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.400704453078184, "mean_inference_ms": 0.24700262496023476, "mean_action_processing_ms": 0.058731337582175434, "mean_env_wait_ms": 1.4576161786895534, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0023856163024902344, "StateBufferConnector_ms": 0.0017616748809814453, "ViewRequirementAgentConnector_ms": 0.04442548751831055}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 181440, "num_agent_steps_trained": 181440, "num_env_steps_sampled": 181440, "num_env_steps_trained": 181440, "num_env_steps_sampled_this_iter": 1800, "num_env_steps_trained_this_iter": 1800, "num_env_steps_sampled_throughput_per_sec": 161.51130352778813, "num_env_steps_trained_throughput_per_sec": 161.51130352778813, "timesteps_total": 181440, "num_steps_trained_this_iter": 1800, "agent_timesteps_total": 181440, "timers": {"training_iteration_time_ms": 2226.752, "sample_time_ms": 2219.369, "load_time_ms": 0.305, "load_throughput": 1179555.847, "learn_time_ms": 6.512, "learn_throughput": 55278.928, "synch_weights_time_ms": 0.529}, "counters": {"num_env_steps_sampled": 181440, "num_env_steps_trained": 181440, "num_agent_steps_sampled": 181440, "num_agent_steps_trained": 181440}, "done": false, "episodes_total": 504, "training_iteration": 101, "trial_id": "f5e97_00000", "date": "2023-07-25_17-14-40", "timestamp": 1690294480, "time_this_iter_s": 11.146886110305786, "time_total_s": 1125.5613851547241, "pid": 71917, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[0, 0.003], [5400, 0.001], [10800, 0.00075], [16200, 0.0005], [21600, 0.00025], [27000, 0.0001], [32400, 7.5e-05], [37800, 5e-05], [43200, 2.5e-05], [48600, 1e-05], [54000, 7.5e-06], [59400, 5e-06], [64800, 2.5e-06], [70200, 1e-06], [75600, 5e-07], [81000, 1e-07]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x304530310>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1125.5613851547241, "iterations_since_restore": 101, "perf": {"cpu_util_percent": 26.2875, "ram_util_percent": 74.8}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-07, "entropy_coeff": 0.1, "policy_entropy": -926.699560546875, "policy_loss": -34724810168729.6, "vf_loss": 1122805644.8}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 2543.0, "diff_num_grad_updates_vs_sampler_policy": 2542.0}}, "num_env_steps_sampled": 183240, "num_env_steps_trained": 183240, "num_agent_steps_sampled": 183240, "num_agent_steps_trained": 183240}, "sampler_results": {"episode_reward_max": -25265.065962054505, "episode_reward_min": -26151.302070778504, "episode_reward_mean": -25723.93040584182, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-25467.080325284947, -25680.299637230575, -25940.706903617378, -25979.154482656842, -25817.84423952501, -25611.069215305495, -25447.410392182308, -25592.70170342282, -25779.69322995973, -25744.830596774704, -26108.241970624844, -25864.90503722851, -25950.90009105484, -26014.647527882316, -25659.80341859398, -25997.67723298258, -25624.324028795298, -25911.37404977576, -25351.166906271006, -25611.41301363248, -25617.64346628109, -25548.094996977878, -26045.118213784343, -25564.877830007805, -25704.500037985872, -25492.64154021694, -25265.065962054505, -25778.36316369155, -25881.928155785667, -26072.264390486347, -25607.822119923723, -25606.638575328827, -25542.64381056869, -25568.85591304861, -25382.136227292147, -25954.705362132278, -25567.57184422557, -25657.18768976953, -26100.574437346037, -25757.28550122091, -25618.053292995486, -26029.62052649127, -25627.929491083225, -25743.887105443853, -26151.302070778504, -25672.852604474392, -25767.446060770482, -25672.48546610586, -25606.265294736724, -25790.13885430144, -25867.090179034065, -26033.13106749242, -25610.889769114186, -25660.437953603592, -25709.168013415092, -25569.824594775288, -25732.30191489128, -25889.39176604255, -25729.758223910954, -25808.274508859773, -25638.239285290947, -25859.125107894786, -25560.01440077342, -25745.729717898535, -25804.867965406884, -25466.42580205111, -25600.832795789127, -25640.301030915405, -25634.036253129038, -25591.02086837972, -25533.861930354342, -25760.32686276445, -25396.99210688679, -25382.538476417383, -25924.810189384803, -25861.887425342076, -25855.252276196476, -25551.072579589287, -25775.999586885166, -25861.110744025074, -25756.456716678895, -25617.208873794578, -25597.01947128544, -25343.268552303653, -25642.9789963566, -25862.808243320793, -25862.541120017588, -25623.5428424464, -25695.679217461256, -25606.17431892844, -25816.19716164555, -25863.72833337226, -25798.788931450992, -25862.58342297002, -25709.185831124872, -25656.533499356352, -25801.86329287919, -25735.077283550734, -25905.161415354407, -26030.385655259062], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.400564438443678, "mean_inference_ms": 0.24699685567829124, "mean_action_processing_ms": 0.05873032628084661, "mean_env_wait_ms": 1.4574665629729764, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0023932456970214844, "StateBufferConnector_ms": 0.0017688274383544922, "ViewRequirementAgentConnector_ms": 0.04450225830078125}}, "episode_reward_max": -25265.065962054505, "episode_reward_min": -26151.302070778504, "episode_reward_mean": -25723.93040584182, "episode_len_mean": 360.0, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-25467.080325284947, -25680.299637230575, -25940.706903617378, -25979.154482656842, -25817.84423952501, -25611.069215305495, -25447.410392182308, -25592.70170342282, -25779.69322995973, -25744.830596774704, -26108.241970624844, -25864.90503722851, -25950.90009105484, -26014.647527882316, -25659.80341859398, -25997.67723298258, -25624.324028795298, -25911.37404977576, -25351.166906271006, -25611.41301363248, -25617.64346628109, -25548.094996977878, -26045.118213784343, -25564.877830007805, -25704.500037985872, -25492.64154021694, -25265.065962054505, -25778.36316369155, -25881.928155785667, -26072.264390486347, -25607.822119923723, -25606.638575328827, -25542.64381056869, -25568.85591304861, -25382.136227292147, -25954.705362132278, -25567.57184422557, -25657.18768976953, -26100.574437346037, -25757.28550122091, -25618.053292995486, -26029.62052649127, -25627.929491083225, -25743.887105443853, -26151.302070778504, -25672.852604474392, -25767.446060770482, -25672.48546610586, -25606.265294736724, -25790.13885430144, -25867.090179034065, -26033.13106749242, -25610.889769114186, -25660.437953603592, -25709.168013415092, -25569.824594775288, -25732.30191489128, -25889.39176604255, -25729.758223910954, -25808.274508859773, -25638.239285290947, -25859.125107894786, -25560.01440077342, -25745.729717898535, -25804.867965406884, -25466.42580205111, -25600.832795789127, -25640.301030915405, -25634.036253129038, -25591.02086837972, -25533.861930354342, -25760.32686276445, -25396.99210688679, -25382.538476417383, -25924.810189384803, -25861.887425342076, -25855.252276196476, -25551.072579589287, -25775.999586885166, -25861.110744025074, -25756.456716678895, -25617.208873794578, -25597.01947128544, -25343.268552303653, -25642.9789963566, -25862.808243320793, -25862.541120017588, -25623.5428424464, -25695.679217461256, -25606.17431892844, -25816.19716164555, -25863.72833337226, -25798.788931450992, -25862.58342297002, -25709.185831124872, -25656.533499356352, -25801.86329287919, -25735.077283550734, -25905.161415354407, -26030.385655259062], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.400564438443678, "mean_inference_ms": 0.24699685567829124, "mean_action_processing_ms": 0.05873032628084661, "mean_env_wait_ms": 1.4574665629729764, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0023932456970214844, "StateBufferConnector_ms": 0.0017688274383544922, "ViewRequirementAgentConnector_ms": 0.04450225830078125}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 183240, "num_agent_steps_trained": 183240, "num_env_steps_sampled": 183240, "num_env_steps_trained": 183240, "num_env_steps_sampled_this_iter": 1800, "num_env_steps_trained_this_iter": 1800, "num_env_steps_sampled_throughput_per_sec": 163.2694250896417, "num_env_steps_trained_throughput_per_sec": 163.2694250896417, "timesteps_total": 183240, "num_steps_trained_this_iter": 1800, "agent_timesteps_total": 183240, "timers": {"training_iteration_time_ms": 2216.936, "sample_time_ms": 2209.789, "load_time_ms": 0.215, "load_throughput": 1674372.854, "learn_time_ms": 6.386, "learn_throughput": 56369.792, "synch_weights_time_ms": 0.514}, "counters": {"num_env_steps_sampled": 183240, "num_env_steps_trained": 183240, "num_agent_steps_sampled": 183240, "num_agent_steps_trained": 183240}, "done": false, "episodes_total": 509, "training_iteration": 102, "trial_id": "f5e97_00000", "date": "2023-07-25_17-14-51", "timestamp": 1690294491, "time_this_iter_s": 11.02677035331726, "time_total_s": 1136.5881555080414, "pid": 71917, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[0, 0.003], [5400, 0.001], [10800, 0.00075], [16200, 0.0005], [21600, 0.00025], [27000, 0.0001], [32400, 7.5e-05], [37800, 5e-05], [43200, 2.5e-05], [48600, 1e-05], [54000, 7.5e-06], [59400, 5e-06], [64800, 2.5e-06], [70200, 1e-06], [75600, 5e-07], [81000, 1e-07]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x304530310>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1136.5881555080414, "iterations_since_restore": 102, "perf": {"cpu_util_percent": 20.206249999999997, "ram_util_percent": 75.60625}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-07, "entropy_coeff": 0.1, "policy_entropy": -926.69951171875, "policy_loss": -14606649576652.8, "vf_loss": 1123230848.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 2568.0, "diff_num_grad_updates_vs_sampler_policy": 2567.0}}, "num_env_steps_sampled": 185040, "num_env_steps_trained": 185040, "num_agent_steps_sampled": 185040, "num_agent_steps_trained": 185040}, "sampler_results": {"episode_reward_max": -25265.065962054505, "episode_reward_min": -26151.302070778504, "episode_reward_mean": -25721.101703512864, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-25611.069215305495, -25447.410392182308, -25592.70170342282, -25779.69322995973, -25744.830596774704, -26108.241970624844, -25864.90503722851, -25950.90009105484, -26014.647527882316, -25659.80341859398, -25997.67723298258, -25624.324028795298, -25911.37404977576, -25351.166906271006, -25611.41301363248, -25617.64346628109, -25548.094996977878, -26045.118213784343, -25564.877830007805, -25704.500037985872, -25492.64154021694, -25265.065962054505, -25778.36316369155, -25881.928155785667, -26072.264390486347, -25607.822119923723, -25606.638575328827, -25542.64381056869, -25568.85591304861, -25382.136227292147, -25954.705362132278, -25567.57184422557, -25657.18768976953, -26100.574437346037, -25757.28550122091, -25618.053292995486, -26029.62052649127, -25627.929491083225, -25743.887105443853, -26151.302070778504, -25672.852604474392, -25767.446060770482, -25672.48546610586, -25606.265294736724, -25790.13885430144, -25867.090179034065, -26033.13106749242, -25610.889769114186, -25660.437953603592, -25709.168013415092, -25569.824594775288, -25732.30191489128, -25889.39176604255, -25729.758223910954, -25808.274508859773, -25638.239285290947, -25859.125107894786, -25560.01440077342, -25745.729717898535, -25804.867965406884, -25466.42580205111, -25600.832795789127, -25640.301030915405, -25634.036253129038, -25591.02086837972, -25533.861930354342, -25760.32686276445, -25396.99210688679, -25382.538476417383, -25924.810189384803, -25861.887425342076, -25855.252276196476, -25551.072579589287, -25775.999586885166, -25861.110744025074, -25756.456716678895, -25617.208873794578, -25597.01947128544, -25343.268552303653, -25642.9789963566, -25862.808243320793, -25862.541120017588, -25623.5428424464, -25695.679217461256, -25606.17431892844, -25816.19716164555, -25863.72833337226, -25798.788931450992, -25862.58342297002, -25709.185831124872, -25656.533499356352, -25801.86329287919, -25735.077283550734, -25905.161415354407, -26030.385655259062, -25961.244413259574, -25587.178291603854, -25502.553854804308, -25517.177817737986, -26034.06097801261], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.400465464441612, "mean_inference_ms": 0.2469903362641088, "mean_action_processing_ms": 0.058729282727642274, "mean_env_wait_ms": 1.4573154228433185, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002396821975708008, "StateBufferConnector_ms": 0.0017647743225097656, "ViewRequirementAgentConnector_ms": 0.044539690017700195}}, "episode_reward_max": -25265.065962054505, "episode_reward_min": -26151.302070778504, "episode_reward_mean": -25721.101703512864, "episode_len_mean": 360.0, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-25611.069215305495, -25447.410392182308, -25592.70170342282, -25779.69322995973, -25744.830596774704, -26108.241970624844, -25864.90503722851, -25950.90009105484, -26014.647527882316, -25659.80341859398, -25997.67723298258, -25624.324028795298, -25911.37404977576, -25351.166906271006, -25611.41301363248, -25617.64346628109, -25548.094996977878, -26045.118213784343, -25564.877830007805, -25704.500037985872, -25492.64154021694, -25265.065962054505, -25778.36316369155, -25881.928155785667, -26072.264390486347, -25607.822119923723, -25606.638575328827, -25542.64381056869, -25568.85591304861, -25382.136227292147, -25954.705362132278, -25567.57184422557, -25657.18768976953, -26100.574437346037, -25757.28550122091, -25618.053292995486, -26029.62052649127, -25627.929491083225, -25743.887105443853, -26151.302070778504, -25672.852604474392, -25767.446060770482, -25672.48546610586, -25606.265294736724, -25790.13885430144, -25867.090179034065, -26033.13106749242, -25610.889769114186, -25660.437953603592, -25709.168013415092, -25569.824594775288, -25732.30191489128, -25889.39176604255, -25729.758223910954, -25808.274508859773, -25638.239285290947, -25859.125107894786, -25560.01440077342, -25745.729717898535, -25804.867965406884, -25466.42580205111, -25600.832795789127, -25640.301030915405, -25634.036253129038, -25591.02086837972, -25533.861930354342, -25760.32686276445, -25396.99210688679, -25382.538476417383, -25924.810189384803, -25861.887425342076, -25855.252276196476, -25551.072579589287, -25775.999586885166, -25861.110744025074, -25756.456716678895, -25617.208873794578, -25597.01947128544, -25343.268552303653, -25642.9789963566, -25862.808243320793, -25862.541120017588, -25623.5428424464, -25695.679217461256, -25606.17431892844, -25816.19716164555, -25863.72833337226, -25798.788931450992, -25862.58342297002, -25709.185831124872, -25656.533499356352, -25801.86329287919, -25735.077283550734, -25905.161415354407, -26030.385655259062, -25961.244413259574, -25587.178291603854, -25502.553854804308, -25517.177817737986, -26034.06097801261], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.400465464441612, "mean_inference_ms": 0.2469903362641088, "mean_action_processing_ms": 0.058729282727642274, "mean_env_wait_ms": 1.4573154228433185, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002396821975708008, "StateBufferConnector_ms": 0.0017647743225097656, "ViewRequirementAgentConnector_ms": 0.044539690017700195}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 185040, "num_agent_steps_trained": 185040, "num_env_steps_sampled": 185040, "num_env_steps_trained": 185040, "num_env_steps_sampled_this_iter": 1800, "num_env_steps_trained_this_iter": 1800, "num_env_steps_sampled_throughput_per_sec": 159.56405724411684, "num_env_steps_trained_throughput_per_sec": 159.56405724411684, "timesteps_total": 185040, "num_steps_trained_this_iter": 1800, "agent_timesteps_total": 185040, "timers": {"training_iteration_time_ms": 2230.536, "sample_time_ms": 2223.265, "load_time_ms": 0.22, "load_throughput": 1632730.796, "learn_time_ms": 6.491, "learn_throughput": 55460.649, "synch_weights_time_ms": 0.527}, "counters": {"num_env_steps_sampled": 185040, "num_env_steps_trained": 185040, "num_agent_steps_sampled": 185040, "num_agent_steps_trained": 185040}, "done": false, "episodes_total": 514, "training_iteration": 103, "trial_id": "f5e97_00000", "date": "2023-07-25_17-15-02", "timestamp": 1690294502, "time_this_iter_s": 11.282949924468994, "time_total_s": 1147.8711054325104, "pid": 71917, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[0, 0.003], [5400, 0.001], [10800, 0.00075], [16200, 0.0005], [21600, 0.00025], [27000, 0.0001], [32400, 7.5e-05], [37800, 5e-05], [43200, 2.5e-05], [48600, 1e-05], [54000, 7.5e-06], [59400, 5e-06], [64800, 2.5e-06], [70200, 1e-06], [75600, 5e-07], [81000, 1e-07]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x304530310>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1147.8711054325104, "iterations_since_restore": 103, "perf": {"cpu_util_percent": 25.768749999999997, "ram_util_percent": 77.70625000000001}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-07, "entropy_coeff": 0.1, "policy_entropy": -926.6997314453125, "policy_loss": -23557026407219.2, "vf_loss": 1112003020.8}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 2593.0, "diff_num_grad_updates_vs_sampler_policy": 2592.0}}, "num_env_steps_sampled": 186840, "num_env_steps_trained": 186840, "num_agent_steps_sampled": 186840, "num_agent_steps_trained": 186840}, "sampler_results": {"episode_reward_max": -25265.065962054505, "episode_reward_min": -26151.302070778504, "episode_reward_mean": -25728.33156291324, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-26108.241970624844, -25864.90503722851, -25950.90009105484, -26014.647527882316, -25659.80341859398, -25997.67723298258, -25624.324028795298, -25911.37404977576, -25351.166906271006, -25611.41301363248, -25617.64346628109, -25548.094996977878, -26045.118213784343, -25564.877830007805, -25704.500037985872, -25492.64154021694, -25265.065962054505, -25778.36316369155, -25881.928155785667, -26072.264390486347, -25607.822119923723, -25606.638575328827, -25542.64381056869, -25568.85591304861, -25382.136227292147, -25954.705362132278, -25567.57184422557, -25657.18768976953, -26100.574437346037, -25757.28550122091, -25618.053292995486, -26029.62052649127, -25627.929491083225, -25743.887105443853, -26151.302070778504, -25672.852604474392, -25767.446060770482, -25672.48546610586, -25606.265294736724, -25790.13885430144, -25867.090179034065, -26033.13106749242, -25610.889769114186, -25660.437953603592, -25709.168013415092, -25569.824594775288, -25732.30191489128, -25889.39176604255, -25729.758223910954, -25808.274508859773, -25638.239285290947, -25859.125107894786, -25560.01440077342, -25745.729717898535, -25804.867965406884, -25466.42580205111, -25600.832795789127, -25640.301030915405, -25634.036253129038, -25591.02086837972, -25533.861930354342, -25760.32686276445, -25396.99210688679, -25382.538476417383, -25924.810189384803, -25861.887425342076, -25855.252276196476, -25551.072579589287, -25775.999586885166, -25861.110744025074, -25756.456716678895, -25617.208873794578, -25597.01947128544, -25343.268552303653, -25642.9789963566, -25862.808243320793, -25862.541120017588, -25623.5428424464, -25695.679217461256, -25606.17431892844, -25816.19716164555, -25863.72833337226, -25798.788931450992, -25862.58342297002, -25709.185831124872, -25656.533499356352, -25801.86329287919, -25735.077283550734, -25905.161415354407, -26030.385655259062, -25961.244413259574, -25587.178291603854, -25502.553854804308, -25517.177817737986, -26034.06097801261, -25759.87498809651, -25601.91871519938, -25873.138791514357, -25784.505422226386, -25879.253160646764], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.400383263070234, "mean_inference_ms": 0.24698647658401232, "mean_action_processing_ms": 0.058728599640578666, "mean_env_wait_ms": 1.4571790564676952, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0023937225341796875, "StateBufferConnector_ms": 0.0017578601837158203, "ViewRequirementAgentConnector_ms": 0.044585466384887695}}, "episode_reward_max": -25265.065962054505, "episode_reward_min": -26151.302070778504, "episode_reward_mean": -25728.33156291324, "episode_len_mean": 360.0, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-26108.241970624844, -25864.90503722851, -25950.90009105484, -26014.647527882316, -25659.80341859398, -25997.67723298258, -25624.324028795298, -25911.37404977576, -25351.166906271006, -25611.41301363248, -25617.64346628109, -25548.094996977878, -26045.118213784343, -25564.877830007805, -25704.500037985872, -25492.64154021694, -25265.065962054505, -25778.36316369155, -25881.928155785667, -26072.264390486347, -25607.822119923723, -25606.638575328827, -25542.64381056869, -25568.85591304861, -25382.136227292147, -25954.705362132278, -25567.57184422557, -25657.18768976953, -26100.574437346037, -25757.28550122091, -25618.053292995486, -26029.62052649127, -25627.929491083225, -25743.887105443853, -26151.302070778504, -25672.852604474392, -25767.446060770482, -25672.48546610586, -25606.265294736724, -25790.13885430144, -25867.090179034065, -26033.13106749242, -25610.889769114186, -25660.437953603592, -25709.168013415092, -25569.824594775288, -25732.30191489128, -25889.39176604255, -25729.758223910954, -25808.274508859773, -25638.239285290947, -25859.125107894786, -25560.01440077342, -25745.729717898535, -25804.867965406884, -25466.42580205111, -25600.832795789127, -25640.301030915405, -25634.036253129038, -25591.02086837972, -25533.861930354342, -25760.32686276445, -25396.99210688679, -25382.538476417383, -25924.810189384803, -25861.887425342076, -25855.252276196476, -25551.072579589287, -25775.999586885166, -25861.110744025074, -25756.456716678895, -25617.208873794578, -25597.01947128544, -25343.268552303653, -25642.9789963566, -25862.808243320793, -25862.541120017588, -25623.5428424464, -25695.679217461256, -25606.17431892844, -25816.19716164555, -25863.72833337226, -25798.788931450992, -25862.58342297002, -25709.185831124872, -25656.533499356352, -25801.86329287919, -25735.077283550734, -25905.161415354407, -26030.385655259062, -25961.244413259574, -25587.178291603854, -25502.553854804308, -25517.177817737986, -26034.06097801261, -25759.87498809651, -25601.91871519938, -25873.138791514357, -25784.505422226386, -25879.253160646764], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.400383263070234, "mean_inference_ms": 0.24698647658401232, "mean_action_processing_ms": 0.058728599640578666, "mean_env_wait_ms": 1.4571790564676952, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0023937225341796875, "StateBufferConnector_ms": 0.0017578601837158203, "ViewRequirementAgentConnector_ms": 0.044585466384887695}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 186840, "num_agent_steps_trained": 186840, "num_env_steps_sampled": 186840, "num_env_steps_trained": 186840, "num_env_steps_sampled_this_iter": 1800, "num_env_steps_trained_this_iter": 1800, "num_env_steps_sampled_throughput_per_sec": 160.6864379893678, "num_env_steps_trained_throughput_per_sec": 160.6864379893678, "timesteps_total": 186840, "num_steps_trained_this_iter": 1800, "agent_timesteps_total": 186840, "timers": {"training_iteration_time_ms": 2248.258, "sample_time_ms": 2240.949, "load_time_ms": 0.223, "load_throughput": 1614228.608, "learn_time_ms": 6.529, "learn_throughput": 55142.259, "synch_weights_time_ms": 0.526}, "counters": {"num_env_steps_sampled": 186840, "num_env_steps_trained": 186840, "num_agent_steps_sampled": 186840, "num_agent_steps_trained": 186840}, "done": false, "episodes_total": 519, "training_iteration": 104, "trial_id": "f5e97_00000", "date": "2023-07-25_17-15-14", "timestamp": 1690294514, "time_this_iter_s": 11.20411205291748, "time_total_s": 1159.0752174854279, "pid": 71917, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[0, 0.003], [5400, 0.001], [10800, 0.00075], [16200, 0.0005], [21600, 0.00025], [27000, 0.0001], [32400, 7.5e-05], [37800, 5e-05], [43200, 2.5e-05], [48600, 1e-05], [54000, 7.5e-06], [59400, 5e-06], [64800, 2.5e-06], [70200, 1e-06], [75600, 5e-07], [81000, 1e-07]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x304530310>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1159.0752174854279, "iterations_since_restore": 104, "perf": {"cpu_util_percent": 25.413333333333334, "ram_util_percent": 77.86666666666666}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-07, "entropy_coeff": 0.1, "policy_entropy": -926.6998901367188, "policy_loss": -11144698739097.6, "vf_loss": 1104364915.2}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 2618.0, "diff_num_grad_updates_vs_sampler_policy": 2617.0}}, "num_env_steps_sampled": 188640, "num_env_steps_trained": 188640, "num_agent_steps_sampled": 188640, "num_agent_steps_trained": 188640}, "sampler_results": {"episode_reward_max": -25265.065962054505, "episode_reward_min": -26151.302070778504, "episode_reward_mean": -25723.797448948324, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-25997.67723298258, -25624.324028795298, -25911.37404977576, -25351.166906271006, -25611.41301363248, -25617.64346628109, -25548.094996977878, -26045.118213784343, -25564.877830007805, -25704.500037985872, -25492.64154021694, -25265.065962054505, -25778.36316369155, -25881.928155785667, -26072.264390486347, -25607.822119923723, -25606.638575328827, -25542.64381056869, -25568.85591304861, -25382.136227292147, -25954.705362132278, -25567.57184422557, -25657.18768976953, -26100.574437346037, -25757.28550122091, -25618.053292995486, -26029.62052649127, -25627.929491083225, -25743.887105443853, -26151.302070778504, -25672.852604474392, -25767.446060770482, -25672.48546610586, -25606.265294736724, -25790.13885430144, -25867.090179034065, -26033.13106749242, -25610.889769114186, -25660.437953603592, -25709.168013415092, -25569.824594775288, -25732.30191489128, -25889.39176604255, -25729.758223910954, -25808.274508859773, -25638.239285290947, -25859.125107894786, -25560.01440077342, -25745.729717898535, -25804.867965406884, -25466.42580205111, -25600.832795789127, -25640.301030915405, -25634.036253129038, -25591.02086837972, -25533.861930354342, -25760.32686276445, -25396.99210688679, -25382.538476417383, -25924.810189384803, -25861.887425342076, -25855.252276196476, -25551.072579589287, -25775.999586885166, -25861.110744025074, -25756.456716678895, -25617.208873794578, -25597.01947128544, -25343.268552303653, -25642.9789963566, -25862.808243320793, -25862.541120017588, -25623.5428424464, -25695.679217461256, -25606.17431892844, -25816.19716164555, -25863.72833337226, -25798.788931450992, -25862.58342297002, -25709.185831124872, -25656.533499356352, -25801.86329287919, -25735.077283550734, -25905.161415354407, -26030.385655259062, -25961.244413259574, -25587.178291603854, -25502.553854804308, -25517.177817737986, -26034.06097801261, -25759.87498809651, -25601.91871519938, -25873.138791514357, -25784.505422226386, -25879.253160646764, -25914.29571780409, -25489.40311961304, -25975.842909860385, -25974.699021005083, -25790.845880610497], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.400288709201548, "mean_inference_ms": 0.24698159217187335, "mean_action_processing_ms": 0.05872776600208996, "mean_env_wait_ms": 1.457037029070439, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00240325927734375, "StateBufferConnector_ms": 0.0017676353454589844, "ViewRequirementAgentConnector_ms": 0.044595956802368164}}, "episode_reward_max": -25265.065962054505, "episode_reward_min": -26151.302070778504, "episode_reward_mean": -25723.797448948324, "episode_len_mean": 360.0, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-25997.67723298258, -25624.324028795298, -25911.37404977576, -25351.166906271006, -25611.41301363248, -25617.64346628109, -25548.094996977878, -26045.118213784343, -25564.877830007805, -25704.500037985872, -25492.64154021694, -25265.065962054505, -25778.36316369155, -25881.928155785667, -26072.264390486347, -25607.822119923723, -25606.638575328827, -25542.64381056869, -25568.85591304861, -25382.136227292147, -25954.705362132278, -25567.57184422557, -25657.18768976953, -26100.574437346037, -25757.28550122091, -25618.053292995486, -26029.62052649127, -25627.929491083225, -25743.887105443853, -26151.302070778504, -25672.852604474392, -25767.446060770482, -25672.48546610586, -25606.265294736724, -25790.13885430144, -25867.090179034065, -26033.13106749242, -25610.889769114186, -25660.437953603592, -25709.168013415092, -25569.824594775288, -25732.30191489128, -25889.39176604255, -25729.758223910954, -25808.274508859773, -25638.239285290947, -25859.125107894786, -25560.01440077342, -25745.729717898535, -25804.867965406884, -25466.42580205111, -25600.832795789127, -25640.301030915405, -25634.036253129038, -25591.02086837972, -25533.861930354342, -25760.32686276445, -25396.99210688679, -25382.538476417383, -25924.810189384803, -25861.887425342076, -25855.252276196476, -25551.072579589287, -25775.999586885166, -25861.110744025074, -25756.456716678895, -25617.208873794578, -25597.01947128544, -25343.268552303653, -25642.9789963566, -25862.808243320793, -25862.541120017588, -25623.5428424464, -25695.679217461256, -25606.17431892844, -25816.19716164555, -25863.72833337226, -25798.788931450992, -25862.58342297002, -25709.185831124872, -25656.533499356352, -25801.86329287919, -25735.077283550734, -25905.161415354407, -26030.385655259062, -25961.244413259574, -25587.178291603854, -25502.553854804308, -25517.177817737986, -26034.06097801261, -25759.87498809651, -25601.91871519938, -25873.138791514357, -25784.505422226386, -25879.253160646764, -25914.29571780409, -25489.40311961304, -25975.842909860385, -25974.699021005083, -25790.845880610497], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.400288709201548, "mean_inference_ms": 0.24698159217187335, "mean_action_processing_ms": 0.05872776600208996, "mean_env_wait_ms": 1.457037029070439, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00240325927734375, "StateBufferConnector_ms": 0.0017676353454589844, "ViewRequirementAgentConnector_ms": 0.044595956802368164}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 188640, "num_agent_steps_trained": 188640, "num_env_steps_sampled": 188640, "num_env_steps_trained": 188640, "num_env_steps_sampled_this_iter": 1800, "num_env_steps_trained_this_iter": 1800, "num_env_steps_sampled_throughput_per_sec": 162.86668423672324, "num_env_steps_trained_throughput_per_sec": 162.86668423672324, "timesteps_total": 188640, "num_steps_trained_this_iter": 1800, "agent_timesteps_total": 188640, "timers": {"training_iteration_time_ms": 2225.383, "sample_time_ms": 2218.315, "load_time_ms": 0.215, "load_throughput": 1675859.534, "learn_time_ms": 6.314, "learn_throughput": 57019.891, "synch_weights_time_ms": 0.509}, "counters": {"num_env_steps_sampled": 188640, "num_env_steps_trained": 188640, "num_agent_steps_sampled": 188640, "num_agent_steps_trained": 188640}, "done": false, "episodes_total": 524, "training_iteration": 105, "trial_id": "f5e97_00000", "date": "2023-07-25_17-15-25", "timestamp": 1690294525, "time_this_iter_s": 11.054059028625488, "time_total_s": 1170.1292765140533, "pid": 71917, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[0, 0.003], [5400, 0.001], [10800, 0.00075], [16200, 0.0005], [21600, 0.00025], [27000, 0.0001], [32400, 7.5e-05], [37800, 5e-05], [43200, 2.5e-05], [48600, 1e-05], [54000, 7.5e-06], [59400, 5e-06], [64800, 2.5e-06], [70200, 1e-06], [75600, 5e-07], [81000, 1e-07]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x304530310>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1170.1292765140533, "iterations_since_restore": 105, "perf": {"cpu_util_percent": 30.4125, "ram_util_percent": 78.23125}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-07, "entropy_coeff": 0.1, "policy_entropy": -926.6998657226562, "policy_loss": -30160958378803.2, "vf_loss": 1101960761.6}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 2643.0, "diff_num_grad_updates_vs_sampler_policy": 2642.0}}, "num_env_steps_sampled": 190440, "num_env_steps_trained": 190440, "num_agent_steps_sampled": 190440, "num_agent_steps_trained": 190440}, "sampler_results": {"episode_reward_max": -25265.065962054505, "episode_reward_min": -26151.302070778504, "episode_reward_mean": -25731.52670724927, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-25617.64346628109, -25548.094996977878, -26045.118213784343, -25564.877830007805, -25704.500037985872, -25492.64154021694, -25265.065962054505, -25778.36316369155, -25881.928155785667, -26072.264390486347, -25607.822119923723, -25606.638575328827, -25542.64381056869, -25568.85591304861, -25382.136227292147, -25954.705362132278, -25567.57184422557, -25657.18768976953, -26100.574437346037, -25757.28550122091, -25618.053292995486, -26029.62052649127, -25627.929491083225, -25743.887105443853, -26151.302070778504, -25672.852604474392, -25767.446060770482, -25672.48546610586, -25606.265294736724, -25790.13885430144, -25867.090179034065, -26033.13106749242, -25610.889769114186, -25660.437953603592, -25709.168013415092, -25569.824594775288, -25732.30191489128, -25889.39176604255, -25729.758223910954, -25808.274508859773, -25638.239285290947, -25859.125107894786, -25560.01440077342, -25745.729717898535, -25804.867965406884, -25466.42580205111, -25600.832795789127, -25640.301030915405, -25634.036253129038, -25591.02086837972, -25533.861930354342, -25760.32686276445, -25396.99210688679, -25382.538476417383, -25924.810189384803, -25861.887425342076, -25855.252276196476, -25551.072579589287, -25775.999586885166, -25861.110744025074, -25756.456716678895, -25617.208873794578, -25597.01947128544, -25343.268552303653, -25642.9789963566, -25862.808243320793, -25862.541120017588, -25623.5428424464, -25695.679217461256, -25606.17431892844, -25816.19716164555, -25863.72833337226, -25798.788931450992, -25862.58342297002, -25709.185831124872, -25656.533499356352, -25801.86329287919, -25735.077283550734, -25905.161415354407, -26030.385655259062, -25961.244413259574, -25587.178291603854, -25502.553854804308, -25517.177817737986, -26034.06097801261, -25759.87498809651, -25601.91871519938, -25873.138791514357, -25784.505422226386, -25879.253160646764, -25914.29571780409, -25489.40311961304, -25975.842909860385, -25974.699021005083, -25790.845880610497, -25869.96738063129, -25810.069398333406, -25953.65395615741, -25815.451167885232, -25819.739158543565], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.400204255493048, "mean_inference_ms": 0.2469780379464455, "mean_action_processing_ms": 0.058727230598578956, "mean_env_wait_ms": 1.4568917737342368, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0024042129516601562, "StateBufferConnector_ms": 0.0017666816711425781, "ViewRequirementAgentConnector_ms": 0.044684410095214844}}, "episode_reward_max": -25265.065962054505, "episode_reward_min": -26151.302070778504, "episode_reward_mean": -25731.52670724927, "episode_len_mean": 360.0, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-25617.64346628109, -25548.094996977878, -26045.118213784343, -25564.877830007805, -25704.500037985872, -25492.64154021694, -25265.065962054505, -25778.36316369155, -25881.928155785667, -26072.264390486347, -25607.822119923723, -25606.638575328827, -25542.64381056869, -25568.85591304861, -25382.136227292147, -25954.705362132278, -25567.57184422557, -25657.18768976953, -26100.574437346037, -25757.28550122091, -25618.053292995486, -26029.62052649127, -25627.929491083225, -25743.887105443853, -26151.302070778504, -25672.852604474392, -25767.446060770482, -25672.48546610586, -25606.265294736724, -25790.13885430144, -25867.090179034065, -26033.13106749242, -25610.889769114186, -25660.437953603592, -25709.168013415092, -25569.824594775288, -25732.30191489128, -25889.39176604255, -25729.758223910954, -25808.274508859773, -25638.239285290947, -25859.125107894786, -25560.01440077342, -25745.729717898535, -25804.867965406884, -25466.42580205111, -25600.832795789127, -25640.301030915405, -25634.036253129038, -25591.02086837972, -25533.861930354342, -25760.32686276445, -25396.99210688679, -25382.538476417383, -25924.810189384803, -25861.887425342076, -25855.252276196476, -25551.072579589287, -25775.999586885166, -25861.110744025074, -25756.456716678895, -25617.208873794578, -25597.01947128544, -25343.268552303653, -25642.9789963566, -25862.808243320793, -25862.541120017588, -25623.5428424464, -25695.679217461256, -25606.17431892844, -25816.19716164555, -25863.72833337226, -25798.788931450992, -25862.58342297002, -25709.185831124872, -25656.533499356352, -25801.86329287919, -25735.077283550734, -25905.161415354407, -26030.385655259062, -25961.244413259574, -25587.178291603854, -25502.553854804308, -25517.177817737986, -26034.06097801261, -25759.87498809651, -25601.91871519938, -25873.138791514357, -25784.505422226386, -25879.253160646764, -25914.29571780409, -25489.40311961304, -25975.842909860385, -25974.699021005083, -25790.845880610497, -25869.96738063129, -25810.069398333406, -25953.65395615741, -25815.451167885232, -25819.739158543565], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.400204255493048, "mean_inference_ms": 0.2469780379464455, "mean_action_processing_ms": 0.058727230598578956, "mean_env_wait_ms": 1.4568917737342368, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0024042129516601562, "StateBufferConnector_ms": 0.0017666816711425781, "ViewRequirementAgentConnector_ms": 0.044684410095214844}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 190440, "num_agent_steps_trained": 190440, "num_env_steps_sampled": 190440, "num_env_steps_trained": 190440, "num_env_steps_sampled_this_iter": 1800, "num_env_steps_trained_this_iter": 1800, "num_env_steps_sampled_throughput_per_sec": 160.68521705883722, "num_env_steps_trained_throughput_per_sec": 160.68521705883722, "timesteps_total": 190440, "num_steps_trained_this_iter": 1800, "agent_timesteps_total": 190440, "timers": {"training_iteration_time_ms": 2225.392, "sample_time_ms": 2218.292, "load_time_ms": 0.218, "load_throughput": 1647876.722, "learn_time_ms": 6.335, "learn_throughput": 56824.191, "synch_weights_time_ms": 0.513}, "counters": {"num_env_steps_sampled": 190440, "num_env_steps_trained": 190440, "num_agent_steps_sampled": 190440, "num_agent_steps_trained": 190440}, "done": false, "episodes_total": 529, "training_iteration": 106, "trial_id": "f5e97_00000", "date": "2023-07-25_17-15-36", "timestamp": 1690294536, "time_this_iter_s": 11.20414400100708, "time_total_s": 1181.3334205150604, "pid": 71917, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[0, 0.003], [5400, 0.001], [10800, 0.00075], [16200, 0.0005], [21600, 0.00025], [27000, 0.0001], [32400, 7.5e-05], [37800, 5e-05], [43200, 2.5e-05], [48600, 1e-05], [54000, 7.5e-06], [59400, 5e-06], [64800, 2.5e-06], [70200, 1e-06], [75600, 5e-07], [81000, 1e-07]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x304530310>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1181.3334205150604, "iterations_since_restore": 106, "perf": {"cpu_util_percent": 25.5625, "ram_util_percent": 78.28125}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-07, "entropy_coeff": 0.1, "policy_entropy": -926.7000366210938, "policy_loss": -29488203431936.0, "vf_loss": 1092937888.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 2668.0, "diff_num_grad_updates_vs_sampler_policy": 2667.0}}, "num_env_steps_sampled": 192240, "num_env_steps_trained": 192240, "num_agent_steps_sampled": 192240, "num_agent_steps_trained": 192240}, "sampler_results": {"episode_reward_max": -25265.065962054505, "episode_reward_min": -26151.302070778504, "episode_reward_mean": -25741.68662451845, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-25492.64154021694, -25265.065962054505, -25778.36316369155, -25881.928155785667, -26072.264390486347, -25607.822119923723, -25606.638575328827, -25542.64381056869, -25568.85591304861, -25382.136227292147, -25954.705362132278, -25567.57184422557, -25657.18768976953, -26100.574437346037, -25757.28550122091, -25618.053292995486, -26029.62052649127, -25627.929491083225, -25743.887105443853, -26151.302070778504, -25672.852604474392, -25767.446060770482, -25672.48546610586, -25606.265294736724, -25790.13885430144, -25867.090179034065, -26033.13106749242, -25610.889769114186, -25660.437953603592, -25709.168013415092, -25569.824594775288, -25732.30191489128, -25889.39176604255, -25729.758223910954, -25808.274508859773, -25638.239285290947, -25859.125107894786, -25560.01440077342, -25745.729717898535, -25804.867965406884, -25466.42580205111, -25600.832795789127, -25640.301030915405, -25634.036253129038, -25591.02086837972, -25533.861930354342, -25760.32686276445, -25396.99210688679, -25382.538476417383, -25924.810189384803, -25861.887425342076, -25855.252276196476, -25551.072579589287, -25775.999586885166, -25861.110744025074, -25756.456716678895, -25617.208873794578, -25597.01947128544, -25343.268552303653, -25642.9789963566, -25862.808243320793, -25862.541120017588, -25623.5428424464, -25695.679217461256, -25606.17431892844, -25816.19716164555, -25863.72833337226, -25798.788931450992, -25862.58342297002, -25709.185831124872, -25656.533499356352, -25801.86329287919, -25735.077283550734, -25905.161415354407, -26030.385655259062, -25961.244413259574, -25587.178291603854, -25502.553854804308, -25517.177817737986, -26034.06097801261, -25759.87498809651, -25601.91871519938, -25873.138791514357, -25784.505422226386, -25879.253160646764, -25914.29571780409, -25489.40311961304, -25975.842909860385, -25974.699021005083, -25790.845880610497, -25869.96738063129, -25810.069398333406, -25953.65395615741, -25815.451167885232, -25819.739158543565, -26026.27184238485, -26083.733153869016, -25758.136060547233, -25967.78515157466, -25660.300063580053], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.400146164250598, "mean_inference_ms": 0.24697453653222687, "mean_action_processing_ms": 0.05872684762338236, "mean_env_wait_ms": 1.4567510908414953, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0024063587188720703, "StateBufferConnector_ms": 0.0017657279968261719, "ViewRequirementAgentConnector_ms": 0.044672489166259766}}, "episode_reward_max": -25265.065962054505, "episode_reward_min": -26151.302070778504, "episode_reward_mean": -25741.68662451845, "episode_len_mean": 360.0, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-25492.64154021694, -25265.065962054505, -25778.36316369155, -25881.928155785667, -26072.264390486347, -25607.822119923723, -25606.638575328827, -25542.64381056869, -25568.85591304861, -25382.136227292147, -25954.705362132278, -25567.57184422557, -25657.18768976953, -26100.574437346037, -25757.28550122091, -25618.053292995486, -26029.62052649127, -25627.929491083225, -25743.887105443853, -26151.302070778504, -25672.852604474392, -25767.446060770482, -25672.48546610586, -25606.265294736724, -25790.13885430144, -25867.090179034065, -26033.13106749242, -25610.889769114186, -25660.437953603592, -25709.168013415092, -25569.824594775288, -25732.30191489128, -25889.39176604255, -25729.758223910954, -25808.274508859773, -25638.239285290947, -25859.125107894786, -25560.01440077342, -25745.729717898535, -25804.867965406884, -25466.42580205111, -25600.832795789127, -25640.301030915405, -25634.036253129038, -25591.02086837972, -25533.861930354342, -25760.32686276445, -25396.99210688679, -25382.538476417383, -25924.810189384803, -25861.887425342076, -25855.252276196476, -25551.072579589287, -25775.999586885166, -25861.110744025074, -25756.456716678895, -25617.208873794578, -25597.01947128544, -25343.268552303653, -25642.9789963566, -25862.808243320793, -25862.541120017588, -25623.5428424464, -25695.679217461256, -25606.17431892844, -25816.19716164555, -25863.72833337226, -25798.788931450992, -25862.58342297002, -25709.185831124872, -25656.533499356352, -25801.86329287919, -25735.077283550734, -25905.161415354407, -26030.385655259062, -25961.244413259574, -25587.178291603854, -25502.553854804308, -25517.177817737986, -26034.06097801261, -25759.87498809651, -25601.91871519938, -25873.138791514357, -25784.505422226386, -25879.253160646764, -25914.29571780409, -25489.40311961304, -25975.842909860385, -25974.699021005083, -25790.845880610497, -25869.96738063129, -25810.069398333406, -25953.65395615741, -25815.451167885232, -25819.739158543565, -26026.27184238485, -26083.733153869016, -25758.136060547233, -25967.78515157466, -25660.300063580053], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.400146164250598, "mean_inference_ms": 0.24697453653222687, "mean_action_processing_ms": 0.05872684762338236, "mean_env_wait_ms": 1.4567510908414953, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0024063587188720703, "StateBufferConnector_ms": 0.0017657279968261719, "ViewRequirementAgentConnector_ms": 0.044672489166259766}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 192240, "num_agent_steps_trained": 192240, "num_env_steps_sampled": 192240, "num_env_steps_trained": 192240, "num_env_steps_sampled_this_iter": 1800, "num_env_steps_trained_this_iter": 1800, "num_env_steps_sampled_throughput_per_sec": 161.36325611262345, "num_env_steps_trained_throughput_per_sec": 161.36325611262345, "timesteps_total": 192240, "num_steps_trained_this_iter": 1800, "agent_timesteps_total": 192240, "timers": {"training_iteration_time_ms": 2235.688, "sample_time_ms": 2228.56, "load_time_ms": 0.221, "load_throughput": 1631848.525, "learn_time_ms": 6.351, "learn_throughput": 56683.188, "synch_weights_time_ms": 0.525}, "counters": {"num_env_steps_sampled": 192240, "num_env_steps_trained": 192240, "num_agent_steps_sampled": 192240, "num_agent_steps_trained": 192240}, "done": false, "episodes_total": 534, "training_iteration": 107, "trial_id": "f5e97_00000", "date": "2023-07-25_17-15-47", "timestamp": 1690294547, "time_this_iter_s": 11.157060861587524, "time_total_s": 1192.490481376648, "pid": 71917, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[0, 0.003], [5400, 0.001], [10800, 0.00075], [16200, 0.0005], [21600, 0.00025], [27000, 0.0001], [32400, 7.5e-05], [37800, 5e-05], [43200, 2.5e-05], [48600, 1e-05], [54000, 7.5e-06], [59400, 5e-06], [64800, 2.5e-06], [70200, 1e-06], [75600, 5e-07], [81000, 1e-07]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x304530310>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1192.490481376648, "iterations_since_restore": 107, "perf": {"cpu_util_percent": 28.200000000000003, "ram_util_percent": 78.0875}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-07, "entropy_coeff": 0.1, "policy_entropy": -926.6996948242188, "policy_loss": -18756602457292.8, "vf_loss": 1113924179.2}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 2693.0, "diff_num_grad_updates_vs_sampler_policy": 2692.0}}, "num_env_steps_sampled": 194040, "num_env_steps_trained": 194040, "num_agent_steps_sampled": 194040, "num_agent_steps_trained": 194040}, "sampler_results": {"episode_reward_max": -25343.268552303653, "episode_reward_min": -26151.302070778504, "episode_reward_mean": -25749.32960607503, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-25607.822119923723, -25606.638575328827, -25542.64381056869, -25568.85591304861, -25382.136227292147, -25954.705362132278, -25567.57184422557, -25657.18768976953, -26100.574437346037, -25757.28550122091, -25618.053292995486, -26029.62052649127, -25627.929491083225, -25743.887105443853, -26151.302070778504, -25672.852604474392, -25767.446060770482, -25672.48546610586, -25606.265294736724, -25790.13885430144, -25867.090179034065, -26033.13106749242, -25610.889769114186, -25660.437953603592, -25709.168013415092, -25569.824594775288, -25732.30191489128, -25889.39176604255, -25729.758223910954, -25808.274508859773, -25638.239285290947, -25859.125107894786, -25560.01440077342, -25745.729717898535, -25804.867965406884, -25466.42580205111, -25600.832795789127, -25640.301030915405, -25634.036253129038, -25591.02086837972, -25533.861930354342, -25760.32686276445, -25396.99210688679, -25382.538476417383, -25924.810189384803, -25861.887425342076, -25855.252276196476, -25551.072579589287, -25775.999586885166, -25861.110744025074, -25756.456716678895, -25617.208873794578, -25597.01947128544, -25343.268552303653, -25642.9789963566, -25862.808243320793, -25862.541120017588, -25623.5428424464, -25695.679217461256, -25606.17431892844, -25816.19716164555, -25863.72833337226, -25798.788931450992, -25862.58342297002, -25709.185831124872, -25656.533499356352, -25801.86329287919, -25735.077283550734, -25905.161415354407, -26030.385655259062, -25961.244413259574, -25587.178291603854, -25502.553854804308, -25517.177817737986, -26034.06097801261, -25759.87498809651, -25601.91871519938, -25873.138791514357, -25784.505422226386, -25879.253160646764, -25914.29571780409, -25489.40311961304, -25975.842909860385, -25974.699021005083, -25790.845880610497, -25869.96738063129, -25810.069398333406, -25953.65395615741, -25815.451167885232, -25819.739158543565, -26026.27184238485, -26083.733153869016, -25758.136060547233, -25967.78515157466, -25660.300063580053, -25705.08482519234, -26102.14806445665, -25797.349811932254, -25781.579667060716, -25868.398999251014], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.400136359460037, "mean_inference_ms": 0.24697644479108466, "mean_action_processing_ms": 0.05872740126540828, "mean_env_wait_ms": 1.4566855063107524, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0024116039276123047, "StateBufferConnector_ms": 0.0017724037170410156, "ViewRequirementAgentConnector_ms": 0.044586181640625}}, "episode_reward_max": -25343.268552303653, "episode_reward_min": -26151.302070778504, "episode_reward_mean": -25749.32960607503, "episode_len_mean": 360.0, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-25607.822119923723, -25606.638575328827, -25542.64381056869, -25568.85591304861, -25382.136227292147, -25954.705362132278, -25567.57184422557, -25657.18768976953, -26100.574437346037, -25757.28550122091, -25618.053292995486, -26029.62052649127, -25627.929491083225, -25743.887105443853, -26151.302070778504, -25672.852604474392, -25767.446060770482, -25672.48546610586, -25606.265294736724, -25790.13885430144, -25867.090179034065, -26033.13106749242, -25610.889769114186, -25660.437953603592, -25709.168013415092, -25569.824594775288, -25732.30191489128, -25889.39176604255, -25729.758223910954, -25808.274508859773, -25638.239285290947, -25859.125107894786, -25560.01440077342, -25745.729717898535, -25804.867965406884, -25466.42580205111, -25600.832795789127, -25640.301030915405, -25634.036253129038, -25591.02086837972, -25533.861930354342, -25760.32686276445, -25396.99210688679, -25382.538476417383, -25924.810189384803, -25861.887425342076, -25855.252276196476, -25551.072579589287, -25775.999586885166, -25861.110744025074, -25756.456716678895, -25617.208873794578, -25597.01947128544, -25343.268552303653, -25642.9789963566, -25862.808243320793, -25862.541120017588, -25623.5428424464, -25695.679217461256, -25606.17431892844, -25816.19716164555, -25863.72833337226, -25798.788931450992, -25862.58342297002, -25709.185831124872, -25656.533499356352, -25801.86329287919, -25735.077283550734, -25905.161415354407, -26030.385655259062, -25961.244413259574, -25587.178291603854, -25502.553854804308, -25517.177817737986, -26034.06097801261, -25759.87498809651, -25601.91871519938, -25873.138791514357, -25784.505422226386, -25879.253160646764, -25914.29571780409, -25489.40311961304, -25975.842909860385, -25974.699021005083, -25790.845880610497, -25869.96738063129, -25810.069398333406, -25953.65395615741, -25815.451167885232, -25819.739158543565, -26026.27184238485, -26083.733153869016, -25758.136060547233, -25967.78515157466, -25660.300063580053, -25705.08482519234, -26102.14806445665, -25797.349811932254, -25781.579667060716, -25868.398999251014], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.400136359460037, "mean_inference_ms": 0.24697644479108466, "mean_action_processing_ms": 0.05872740126540828, "mean_env_wait_ms": 1.4566855063107524, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0024116039276123047, "StateBufferConnector_ms": 0.0017724037170410156, "ViewRequirementAgentConnector_ms": 0.044586181640625}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 194040, "num_agent_steps_trained": 194040, "num_env_steps_sampled": 194040, "num_env_steps_trained": 194040, "num_env_steps_sampled_this_iter": 1800, "num_env_steps_trained_this_iter": 1800, "num_env_steps_sampled_throughput_per_sec": 155.33912376047832, "num_env_steps_trained_throughput_per_sec": 155.33912376047832, "timesteps_total": 194040, "num_steps_trained_this_iter": 1800, "agent_timesteps_total": 194040, "timers": {"training_iteration_time_ms": 2274.24, "sample_time_ms": 2266.989, "load_time_ms": 0.229, "load_throughput": 1572372.634, "learn_time_ms": 6.439, "learn_throughput": 55912.043, "synch_weights_time_ms": 0.546}, "counters": {"num_env_steps_sampled": 194040, "num_env_steps_trained": 194040, "num_agent_steps_sampled": 194040, "num_agent_steps_trained": 194040}, "done": false, "episodes_total": 539, "training_iteration": 108, "trial_id": "f5e97_00000", "date": "2023-07-25_17-15-59", "timestamp": 1690294559, "time_this_iter_s": 11.589810848236084, "time_total_s": 1204.080292224884, "pid": 71917, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[0, 0.003], [5400, 0.001], [10800, 0.00075], [16200, 0.0005], [21600, 0.00025], [27000, 0.0001], [32400, 7.5e-05], [37800, 5e-05], [43200, 2.5e-05], [48600, 1e-05], [54000, 7.5e-06], [59400, 5e-06], [64800, 2.5e-06], [70200, 1e-06], [75600, 5e-07], [81000, 1e-07]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x304530310>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1204.080292224884, "iterations_since_restore": 108, "perf": {"cpu_util_percent": 29.50625, "ram_util_percent": 77.90625}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-07, "entropy_coeff": 0.1, "policy_entropy": -926.7000122070312, "policy_loss": -26453386117120.0, "vf_loss": 1077304025.6}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 2718.0, "diff_num_grad_updates_vs_sampler_policy": 2717.0}}, "num_env_steps_sampled": 195840, "num_env_steps_trained": 195840, "num_agent_steps_sampled": 195840, "num_agent_steps_trained": 195840}, "sampler_results": {"episode_reward_max": -25343.268552303653, "episode_reward_min": -26151.302070778504, "episode_reward_mean": -25756.232971404203, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-25954.705362132278, -25567.57184422557, -25657.18768976953, -26100.574437346037, -25757.28550122091, -25618.053292995486, -26029.62052649127, -25627.929491083225, -25743.887105443853, -26151.302070778504, -25672.852604474392, -25767.446060770482, -25672.48546610586, -25606.265294736724, -25790.13885430144, -25867.090179034065, -26033.13106749242, -25610.889769114186, -25660.437953603592, -25709.168013415092, -25569.824594775288, -25732.30191489128, -25889.39176604255, -25729.758223910954, -25808.274508859773, -25638.239285290947, -25859.125107894786, -25560.01440077342, -25745.729717898535, -25804.867965406884, -25466.42580205111, -25600.832795789127, -25640.301030915405, -25634.036253129038, -25591.02086837972, -25533.861930354342, -25760.32686276445, -25396.99210688679, -25382.538476417383, -25924.810189384803, -25861.887425342076, -25855.252276196476, -25551.072579589287, -25775.999586885166, -25861.110744025074, -25756.456716678895, -25617.208873794578, -25597.01947128544, -25343.268552303653, -25642.9789963566, -25862.808243320793, -25862.541120017588, -25623.5428424464, -25695.679217461256, -25606.17431892844, -25816.19716164555, -25863.72833337226, -25798.788931450992, -25862.58342297002, -25709.185831124872, -25656.533499356352, -25801.86329287919, -25735.077283550734, -25905.161415354407, -26030.385655259062, -25961.244413259574, -25587.178291603854, -25502.553854804308, -25517.177817737986, -26034.06097801261, -25759.87498809651, -25601.91871519938, -25873.138791514357, -25784.505422226386, -25879.253160646764, -25914.29571780409, -25489.40311961304, -25975.842909860385, -25974.699021005083, -25790.845880610497, -25869.96738063129, -25810.069398333406, -25953.65395615741, -25815.451167885232, -25819.739158543565, -26026.27184238485, -26083.733153869016, -25758.136060547233, -25967.78515157466, -25660.300063580053, -25705.08482519234, -26102.14806445665, -25797.349811932254, -25781.579667060716, -25868.398999251014, -25529.3090589514, -25807.03109847257, -25902.754923447952, -25639.988495218277, -25519.349602989754], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.400164980928544, "mean_inference_ms": 0.24698469757845942, "mean_action_processing_ms": 0.05872888944308261, "mean_env_wait_ms": 1.4566232877979803, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002420663833618164, "StateBufferConnector_ms": 0.0017969608306884766, "ViewRequirementAgentConnector_ms": 0.04484057426452637}}, "episode_reward_max": -25343.268552303653, "episode_reward_min": -26151.302070778504, "episode_reward_mean": -25756.232971404203, "episode_len_mean": 360.0, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-25954.705362132278, -25567.57184422557, -25657.18768976953, -26100.574437346037, -25757.28550122091, -25618.053292995486, -26029.62052649127, -25627.929491083225, -25743.887105443853, -26151.302070778504, -25672.852604474392, -25767.446060770482, -25672.48546610586, -25606.265294736724, -25790.13885430144, -25867.090179034065, -26033.13106749242, -25610.889769114186, -25660.437953603592, -25709.168013415092, -25569.824594775288, -25732.30191489128, -25889.39176604255, -25729.758223910954, -25808.274508859773, -25638.239285290947, -25859.125107894786, -25560.01440077342, -25745.729717898535, -25804.867965406884, -25466.42580205111, -25600.832795789127, -25640.301030915405, -25634.036253129038, -25591.02086837972, -25533.861930354342, -25760.32686276445, -25396.99210688679, -25382.538476417383, -25924.810189384803, -25861.887425342076, -25855.252276196476, -25551.072579589287, -25775.999586885166, -25861.110744025074, -25756.456716678895, -25617.208873794578, -25597.01947128544, -25343.268552303653, -25642.9789963566, -25862.808243320793, -25862.541120017588, -25623.5428424464, -25695.679217461256, -25606.17431892844, -25816.19716164555, -25863.72833337226, -25798.788931450992, -25862.58342297002, -25709.185831124872, -25656.533499356352, -25801.86329287919, -25735.077283550734, -25905.161415354407, -26030.385655259062, -25961.244413259574, -25587.178291603854, -25502.553854804308, -25517.177817737986, -26034.06097801261, -25759.87498809651, -25601.91871519938, -25873.138791514357, -25784.505422226386, -25879.253160646764, -25914.29571780409, -25489.40311961304, -25975.842909860385, -25974.699021005083, -25790.845880610497, -25869.96738063129, -25810.069398333406, -25953.65395615741, -25815.451167885232, -25819.739158543565, -26026.27184238485, -26083.733153869016, -25758.136060547233, -25967.78515157466, -25660.300063580053, -25705.08482519234, -26102.14806445665, -25797.349811932254, -25781.579667060716, -25868.398999251014, -25529.3090589514, -25807.03109847257, -25902.754923447952, -25639.988495218277, -25519.349602989754], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.400164980928544, "mean_inference_ms": 0.24698469757845942, "mean_action_processing_ms": 0.05872888944308261, "mean_env_wait_ms": 1.4566232877979803, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002420663833618164, "StateBufferConnector_ms": 0.0017969608306884766, "ViewRequirementAgentConnector_ms": 0.04484057426452637}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 195840, "num_agent_steps_trained": 195840, "num_env_steps_sampled": 195840, "num_env_steps_trained": 195840, "num_env_steps_sampled_this_iter": 1800, "num_env_steps_trained_this_iter": 1800, "num_env_steps_sampled_throughput_per_sec": 158.9494048366576, "num_env_steps_trained_throughput_per_sec": 158.9494048366576, "timesteps_total": 195840, "num_steps_trained_this_iter": 1800, "agent_timesteps_total": 195840, "timers": {"training_iteration_time_ms": 2291.18, "sample_time_ms": 2283.935, "load_time_ms": 0.227, "load_throughput": 1588751.515, "learn_time_ms": 6.44, "learn_throughput": 55896.312, "synch_weights_time_ms": 0.541}, "counters": {"num_env_steps_sampled": 195840, "num_env_steps_trained": 195840, "num_agent_steps_sampled": 195840, "num_agent_steps_trained": 195840}, "done": false, "episodes_total": 544, "training_iteration": 109, "trial_id": "f5e97_00000", "date": "2023-07-25_17-16-10", "timestamp": 1690294570, "time_this_iter_s": 11.326487064361572, "time_total_s": 1215.4067792892456, "pid": 71917, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[0, 0.003], [5400, 0.001], [10800, 0.00075], [16200, 0.0005], [21600, 0.00025], [27000, 0.0001], [32400, 7.5e-05], [37800, 5e-05], [43200, 2.5e-05], [48600, 1e-05], [54000, 7.5e-06], [59400, 5e-06], [64800, 2.5e-06], [70200, 1e-06], [75600, 5e-07], [81000, 1e-07]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x304530310>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1215.4067792892456, "iterations_since_restore": 109, "perf": {"cpu_util_percent": 29.862499999999997, "ram_util_percent": 77.84375}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-07, "entropy_coeff": 0.1, "policy_entropy": -926.6996215820312, "policy_loss": -16188451178086.4, "vf_loss": 1114080294.4}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 2743.0, "diff_num_grad_updates_vs_sampler_policy": 2742.0}}, "num_env_steps_sampled": 197640, "num_env_steps_trained": 197640, "num_agent_steps_sampled": 197640, "num_agent_steps_trained": 197640}, "sampler_results": {"episode_reward_max": -25343.268552303653, "episode_reward_min": -26151.302070778504, "episode_reward_mean": -25755.73631677048, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-25618.053292995486, -26029.62052649127, -25627.929491083225, -25743.887105443853, -26151.302070778504, -25672.852604474392, -25767.446060770482, -25672.48546610586, -25606.265294736724, -25790.13885430144, -25867.090179034065, -26033.13106749242, -25610.889769114186, -25660.437953603592, -25709.168013415092, -25569.824594775288, -25732.30191489128, -25889.39176604255, -25729.758223910954, -25808.274508859773, -25638.239285290947, -25859.125107894786, -25560.01440077342, -25745.729717898535, -25804.867965406884, -25466.42580205111, -25600.832795789127, -25640.301030915405, -25634.036253129038, -25591.02086837972, -25533.861930354342, -25760.32686276445, -25396.99210688679, -25382.538476417383, -25924.810189384803, -25861.887425342076, -25855.252276196476, -25551.072579589287, -25775.999586885166, -25861.110744025074, -25756.456716678895, -25617.208873794578, -25597.01947128544, -25343.268552303653, -25642.9789963566, -25862.808243320793, -25862.541120017588, -25623.5428424464, -25695.679217461256, -25606.17431892844, -25816.19716164555, -25863.72833337226, -25798.788931450992, -25862.58342297002, -25709.185831124872, -25656.533499356352, -25801.86329287919, -25735.077283550734, -25905.161415354407, -26030.385655259062, -25961.244413259574, -25587.178291603854, -25502.553854804308, -25517.177817737986, -26034.06097801261, -25759.87498809651, -25601.91871519938, -25873.138791514357, -25784.505422226386, -25879.253160646764, -25914.29571780409, -25489.40311961304, -25975.842909860385, -25974.699021005083, -25790.845880610497, -25869.96738063129, -25810.069398333406, -25953.65395615741, -25815.451167885232, -25819.739158543565, -26026.27184238485, -26083.733153869016, -25758.136060547233, -25967.78515157466, -25660.300063580053, -25705.08482519234, -26102.14806445665, -25797.349811932254, -25781.579667060716, -25868.398999251014, -25529.3090589514, -25807.03109847257, -25902.754923447952, -25639.988495218277, -25519.349602989754, -25619.05502207858, -25891.1413734565, -25871.921132023614, -25571.612840771653, -26033.929002990495], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.400217144338489, "mean_inference_ms": 0.2469957330967628, "mean_action_processing_ms": 0.058730698176834524, "mean_env_wait_ms": 1.4565711038724742, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002412557601928711, "StateBufferConnector_ms": 0.0017902851104736328, "ViewRequirementAgentConnector_ms": 0.04477739334106445}}, "episode_reward_max": -25343.268552303653, "episode_reward_min": -26151.302070778504, "episode_reward_mean": -25755.73631677048, "episode_len_mean": 360.0, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-25618.053292995486, -26029.62052649127, -25627.929491083225, -25743.887105443853, -26151.302070778504, -25672.852604474392, -25767.446060770482, -25672.48546610586, -25606.265294736724, -25790.13885430144, -25867.090179034065, -26033.13106749242, -25610.889769114186, -25660.437953603592, -25709.168013415092, -25569.824594775288, -25732.30191489128, -25889.39176604255, -25729.758223910954, -25808.274508859773, -25638.239285290947, -25859.125107894786, -25560.01440077342, -25745.729717898535, -25804.867965406884, -25466.42580205111, -25600.832795789127, -25640.301030915405, -25634.036253129038, -25591.02086837972, -25533.861930354342, -25760.32686276445, -25396.99210688679, -25382.538476417383, -25924.810189384803, -25861.887425342076, -25855.252276196476, -25551.072579589287, -25775.999586885166, -25861.110744025074, -25756.456716678895, -25617.208873794578, -25597.01947128544, -25343.268552303653, -25642.9789963566, -25862.808243320793, -25862.541120017588, -25623.5428424464, -25695.679217461256, -25606.17431892844, -25816.19716164555, -25863.72833337226, -25798.788931450992, -25862.58342297002, -25709.185831124872, -25656.533499356352, -25801.86329287919, -25735.077283550734, -25905.161415354407, -26030.385655259062, -25961.244413259574, -25587.178291603854, -25502.553854804308, -25517.177817737986, -26034.06097801261, -25759.87498809651, -25601.91871519938, -25873.138791514357, -25784.505422226386, -25879.253160646764, -25914.29571780409, -25489.40311961304, -25975.842909860385, -25974.699021005083, -25790.845880610497, -25869.96738063129, -25810.069398333406, -25953.65395615741, -25815.451167885232, -25819.739158543565, -26026.27184238485, -26083.733153869016, -25758.136060547233, -25967.78515157466, -25660.300063580053, -25705.08482519234, -26102.14806445665, -25797.349811932254, -25781.579667060716, -25868.398999251014, -25529.3090589514, -25807.03109847257, -25902.754923447952, -25639.988495218277, -25519.349602989754, -25619.05502207858, -25891.1413734565, -25871.921132023614, -25571.612840771653, -26033.929002990495], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.400217144338489, "mean_inference_ms": 0.2469957330967628, "mean_action_processing_ms": 0.058730698176834524, "mean_env_wait_ms": 1.4565711038724742, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002412557601928711, "StateBufferConnector_ms": 0.0017902851104736328, "ViewRequirementAgentConnector_ms": 0.04477739334106445}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 197640, "num_agent_steps_trained": 197640, "num_env_steps_sampled": 197640, "num_env_steps_trained": 197640, "num_env_steps_sampled_this_iter": 1800, "num_env_steps_trained_this_iter": 1800, "num_env_steps_sampled_throughput_per_sec": 160.5641259616066, "num_env_steps_trained_throughput_per_sec": 160.5641259616066, "timesteps_total": 197640, "num_steps_trained_this_iter": 1800, "agent_timesteps_total": 197640, "timers": {"training_iteration_time_ms": 2253.473, "sample_time_ms": 2246.382, "load_time_ms": 0.215, "load_throughput": 1671407.394, "learn_time_ms": 6.299, "learn_throughput": 57148.946, "synch_weights_time_ms": 0.544}, "counters": {"num_env_steps_sampled": 197640, "num_env_steps_trained": 197640, "num_agent_steps_sampled": 197640, "num_agent_steps_trained": 197640}, "done": false, "episodes_total": 549, "training_iteration": 110, "trial_id": "f5e97_00000", "date": "2023-07-25_17-16-21", "timestamp": 1690294581, "time_this_iter_s": 11.213005065917969, "time_total_s": 1226.6197843551636, "pid": 71917, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[0, 0.003], [5400, 0.001], [10800, 0.00075], [16200, 0.0005], [21600, 0.00025], [27000, 0.0001], [32400, 7.5e-05], [37800, 5e-05], [43200, 2.5e-05], [48600, 1e-05], [54000, 7.5e-06], [59400, 5e-06], [64800, 2.5e-06], [70200, 1e-06], [75600, 5e-07], [81000, 1e-07]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x304530310>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1226.6197843551636, "iterations_since_restore": 110, "perf": {"cpu_util_percent": 24.64375, "ram_util_percent": 78.1125}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-07, "entropy_coeff": 0.1, "policy_entropy": -926.7000366210938, "policy_loss": -31187631340748.8, "vf_loss": 1099974502.4}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 2763.0, "diff_num_grad_updates_vs_sampler_policy": 2762.0}}, "num_env_steps_sampled": 199080, "num_env_steps_trained": 199080, "num_agent_steps_sampled": 199080, "num_agent_steps_trained": 199080}, "sampler_results": {"episode_reward_max": -25343.268552303653, "episode_reward_min": -26151.302070778504, "episode_reward_mean": -25753.56214527002, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-26151.302070778504, -25672.852604474392, -25767.446060770482, -25672.48546610586, -25606.265294736724, -25790.13885430144, -25867.090179034065, -26033.13106749242, -25610.889769114186, -25660.437953603592, -25709.168013415092, -25569.824594775288, -25732.30191489128, -25889.39176604255, -25729.758223910954, -25808.274508859773, -25638.239285290947, -25859.125107894786, -25560.01440077342, -25745.729717898535, -25804.867965406884, -25466.42580205111, -25600.832795789127, -25640.301030915405, -25634.036253129038, -25591.02086837972, -25533.861930354342, -25760.32686276445, -25396.99210688679, -25382.538476417383, -25924.810189384803, -25861.887425342076, -25855.252276196476, -25551.072579589287, -25775.999586885166, -25861.110744025074, -25756.456716678895, -25617.208873794578, -25597.01947128544, -25343.268552303653, -25642.9789963566, -25862.808243320793, -25862.541120017588, -25623.5428424464, -25695.679217461256, -25606.17431892844, -25816.19716164555, -25863.72833337226, -25798.788931450992, -25862.58342297002, -25709.185831124872, -25656.533499356352, -25801.86329287919, -25735.077283550734, -25905.161415354407, -26030.385655259062, -25961.244413259574, -25587.178291603854, -25502.553854804308, -25517.177817737986, -26034.06097801261, -25759.87498809651, -25601.91871519938, -25873.138791514357, -25784.505422226386, -25879.253160646764, -25914.29571780409, -25489.40311961304, -25975.842909860385, -25974.699021005083, -25790.845880610497, -25869.96738063129, -25810.069398333406, -25953.65395615741, -25815.451167885232, -25819.739158543565, -26026.27184238485, -26083.733153869016, -25758.136060547233, -25967.78515157466, -25660.300063580053, -25705.08482519234, -26102.14806445665, -25797.349811932254, -25781.579667060716, -25868.398999251014, -25529.3090589514, -25807.03109847257, -25902.754923447952, -25639.988495218277, -25519.349602989754, -25619.05502207858, -25891.1413734565, -25871.921132023614, -25571.612840771653, -26033.929002990495, -25968.70702087451, -25753.59731625539, -25345.672421099924, -25734.096507738315], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.400940494091699, "mean_inference_ms": 0.2470335366025755, "mean_action_processing_ms": 0.05873856804859053, "mean_env_wait_ms": 1.4567415305203923, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002451181411743164, "StateBufferConnector_ms": 0.0018262863159179688, "ViewRequirementAgentConnector_ms": 0.04552102088928223}}, "episode_reward_max": -25343.268552303653, "episode_reward_min": -26151.302070778504, "episode_reward_mean": -25753.56214527002, "episode_len_mean": 360.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-26151.302070778504, -25672.852604474392, -25767.446060770482, -25672.48546610586, -25606.265294736724, -25790.13885430144, -25867.090179034065, -26033.13106749242, -25610.889769114186, -25660.437953603592, -25709.168013415092, -25569.824594775288, -25732.30191489128, -25889.39176604255, -25729.758223910954, -25808.274508859773, -25638.239285290947, -25859.125107894786, -25560.01440077342, -25745.729717898535, -25804.867965406884, -25466.42580205111, -25600.832795789127, -25640.301030915405, -25634.036253129038, -25591.02086837972, -25533.861930354342, -25760.32686276445, -25396.99210688679, -25382.538476417383, -25924.810189384803, -25861.887425342076, -25855.252276196476, -25551.072579589287, -25775.999586885166, -25861.110744025074, -25756.456716678895, -25617.208873794578, -25597.01947128544, -25343.268552303653, -25642.9789963566, -25862.808243320793, -25862.541120017588, -25623.5428424464, -25695.679217461256, -25606.17431892844, -25816.19716164555, -25863.72833337226, -25798.788931450992, -25862.58342297002, -25709.185831124872, -25656.533499356352, -25801.86329287919, -25735.077283550734, -25905.161415354407, -26030.385655259062, -25961.244413259574, -25587.178291603854, -25502.553854804308, -25517.177817737986, -26034.06097801261, -25759.87498809651, -25601.91871519938, -25873.138791514357, -25784.505422226386, -25879.253160646764, -25914.29571780409, -25489.40311961304, -25975.842909860385, -25974.699021005083, -25790.845880610497, -25869.96738063129, -25810.069398333406, -25953.65395615741, -25815.451167885232, -25819.739158543565, -26026.27184238485, -26083.733153869016, -25758.136060547233, -25967.78515157466, -25660.300063580053, -25705.08482519234, -26102.14806445665, -25797.349811932254, -25781.579667060716, -25868.398999251014, -25529.3090589514, -25807.03109847257, -25902.754923447952, -25639.988495218277, -25519.349602989754, -25619.05502207858, -25891.1413734565, -25871.921132023614, -25571.612840771653, -26033.929002990495, -25968.70702087451, -25753.59731625539, -25345.672421099924, -25734.096507738315], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.400940494091699, "mean_inference_ms": 0.2470335366025755, "mean_action_processing_ms": 0.05873856804859053, "mean_env_wait_ms": 1.4567415305203923, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002451181411743164, "StateBufferConnector_ms": 0.0018262863159179688, "ViewRequirementAgentConnector_ms": 0.04552102088928223}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 199080, "num_agent_steps_trained": 199080, "num_env_steps_sampled": 199080, "num_env_steps_trained": 199080, "num_env_steps_sampled_this_iter": 1440, "num_env_steps_trained_this_iter": 1440, "num_env_steps_sampled_throughput_per_sec": 107.11205397308848, "num_env_steps_trained_throughput_per_sec": 107.11205397308848, "timesteps_total": 199080, "num_steps_trained_this_iter": 1440, "agent_timesteps_total": 199080, "timers": {"training_iteration_time_ms": 2692.398, "sample_time_ms": 2684.099, "load_time_ms": 0.263, "load_throughput": 1370314.402, "learn_time_ms": 7.392, "learn_throughput": 48704.276, "synch_weights_time_ms": 0.608}, "counters": {"num_env_steps_sampled": 199080, "num_env_steps_trained": 199080, "num_agent_steps_sampled": 199080, "num_agent_steps_trained": 199080}, "done": false, "episodes_total": 553, "training_iteration": 111, "trial_id": "f5e97_00000", "date": "2023-07-25_17-16-35", "timestamp": 1690294595, "time_this_iter_s": 13.446666955947876, "time_total_s": 1240.0664513111115, "pid": 71917, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[0, 0.003], [5400, 0.001], [10800, 0.00075], [16200, 0.0005], [21600, 0.00025], [27000, 0.0001], [32400, 7.5e-05], [37800, 5e-05], [43200, 2.5e-05], [48600, 1e-05], [54000, 7.5e-06], [59400, 5e-06], [64800, 2.5e-06], [70200, 1e-06], [75600, 5e-07], [81000, 1e-07]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x304530310>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1240.0664513111115, "iterations_since_restore": 111, "perf": {"cpu_util_percent": 31.404999999999994, "ram_util_percent": 78.49}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-07, "entropy_coeff": 0.1, "policy_entropy": -926.6997802734375, "policy_loss": -31678638320844.8, "vf_loss": 1100089510.4}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 2778.0, "diff_num_grad_updates_vs_sampler_policy": 2777.0}}, "num_env_steps_sampled": 200160, "num_env_steps_trained": 200160, "num_agent_steps_sampled": 200160, "num_agent_steps_trained": 200160}, "sampler_results": {"episode_reward_max": -25343.268552303653, "episode_reward_min": -26102.14806445665, "episode_reward_mean": -25752.892726837956, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-25672.48546610586, -25606.265294736724, -25790.13885430144, -25867.090179034065, -26033.13106749242, -25610.889769114186, -25660.437953603592, -25709.168013415092, -25569.824594775288, -25732.30191489128, -25889.39176604255, -25729.758223910954, -25808.274508859773, -25638.239285290947, -25859.125107894786, -25560.01440077342, -25745.729717898535, -25804.867965406884, -25466.42580205111, -25600.832795789127, -25640.301030915405, -25634.036253129038, -25591.02086837972, -25533.861930354342, -25760.32686276445, -25396.99210688679, -25382.538476417383, -25924.810189384803, -25861.887425342076, -25855.252276196476, -25551.072579589287, -25775.999586885166, -25861.110744025074, -25756.456716678895, -25617.208873794578, -25597.01947128544, -25343.268552303653, -25642.9789963566, -25862.808243320793, -25862.541120017588, -25623.5428424464, -25695.679217461256, -25606.17431892844, -25816.19716164555, -25863.72833337226, -25798.788931450992, -25862.58342297002, -25709.185831124872, -25656.533499356352, -25801.86329287919, -25735.077283550734, -25905.161415354407, -26030.385655259062, -25961.244413259574, -25587.178291603854, -25502.553854804308, -25517.177817737986, -26034.06097801261, -25759.87498809651, -25601.91871519938, -25873.138791514357, -25784.505422226386, -25879.253160646764, -25914.29571780409, -25489.40311961304, -25975.842909860385, -25974.699021005083, -25790.845880610497, -25869.96738063129, -25810.069398333406, -25953.65395615741, -25815.451167885232, -25819.739158543565, -26026.27184238485, -26083.733153869016, -25758.136060547233, -25967.78515157466, -25660.300063580053, -25705.08482519234, -26102.14806445665, -25797.349811932254, -25781.579667060716, -25868.398999251014, -25529.3090589514, -25807.03109847257, -25902.754923447952, -25639.988495218277, -25519.349602989754, -25619.05502207858, -25891.1413734565, -25871.921132023614, -25571.612840771653, -26033.929002990495, -25968.70702087451, -25753.59731625539, -25345.672421099924, -25734.096507738315, -25955.573889103773, -25811.43468690695, -25757.650316806128], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.402007032521508, "mean_inference_ms": 0.2470832533480442, "mean_action_processing_ms": 0.058749937200595126, "mean_env_wait_ms": 1.4570196395536938, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0024819374084472656, "StateBufferConnector_ms": 0.0018520355224609375, "ViewRequirementAgentConnector_ms": 0.0462644100189209}}, "episode_reward_max": -25343.268552303653, "episode_reward_min": -26102.14806445665, "episode_reward_mean": -25752.892726837956, "episode_len_mean": 360.0, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-25672.48546610586, -25606.265294736724, -25790.13885430144, -25867.090179034065, -26033.13106749242, -25610.889769114186, -25660.437953603592, -25709.168013415092, -25569.824594775288, -25732.30191489128, -25889.39176604255, -25729.758223910954, -25808.274508859773, -25638.239285290947, -25859.125107894786, -25560.01440077342, -25745.729717898535, -25804.867965406884, -25466.42580205111, -25600.832795789127, -25640.301030915405, -25634.036253129038, -25591.02086837972, -25533.861930354342, -25760.32686276445, -25396.99210688679, -25382.538476417383, -25924.810189384803, -25861.887425342076, -25855.252276196476, -25551.072579589287, -25775.999586885166, -25861.110744025074, -25756.456716678895, -25617.208873794578, -25597.01947128544, -25343.268552303653, -25642.9789963566, -25862.808243320793, -25862.541120017588, -25623.5428424464, -25695.679217461256, -25606.17431892844, -25816.19716164555, -25863.72833337226, -25798.788931450992, -25862.58342297002, -25709.185831124872, -25656.533499356352, -25801.86329287919, -25735.077283550734, -25905.161415354407, -26030.385655259062, -25961.244413259574, -25587.178291603854, -25502.553854804308, -25517.177817737986, -26034.06097801261, -25759.87498809651, -25601.91871519938, -25873.138791514357, -25784.505422226386, -25879.253160646764, -25914.29571780409, -25489.40311961304, -25975.842909860385, -25974.699021005083, -25790.845880610497, -25869.96738063129, -25810.069398333406, -25953.65395615741, -25815.451167885232, -25819.739158543565, -26026.27184238485, -26083.733153869016, -25758.136060547233, -25967.78515157466, -25660.300063580053, -25705.08482519234, -26102.14806445665, -25797.349811932254, -25781.579667060716, -25868.398999251014, -25529.3090589514, -25807.03109847257, -25902.754923447952, -25639.988495218277, -25519.349602989754, -25619.05502207858, -25891.1413734565, -25871.921132023614, -25571.612840771653, -26033.929002990495, -25968.70702087451, -25753.59731625539, -25345.672421099924, -25734.096507738315, -25955.573889103773, -25811.43468690695, -25757.650316806128], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.402007032521508, "mean_inference_ms": 0.2470832533480442, "mean_action_processing_ms": 0.058749937200595126, "mean_env_wait_ms": 1.4570196395536938, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0024819374084472656, "StateBufferConnector_ms": 0.0018520355224609375, "ViewRequirementAgentConnector_ms": 0.0462644100189209}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 200160, "num_agent_steps_trained": 200160, "num_env_steps_sampled": 200160, "num_env_steps_trained": 200160, "num_env_steps_sampled_this_iter": 1080, "num_env_steps_trained_this_iter": 1080, "num_env_steps_sampled_throughput_per_sec": 94.79570913886138, "num_env_steps_trained_throughput_per_sec": 94.79570913886138, "timesteps_total": 200160, "num_steps_trained_this_iter": 1080, "agent_timesteps_total": 200160, "timers": {"training_iteration_time_ms": 3156.224, "sample_time_ms": 3146.777, "load_time_ms": 0.288, "load_throughput": 1248924.268, "learn_time_ms": 8.452, "learn_throughput": 42591.616, "synch_weights_time_ms": 0.667}, "counters": {"num_env_steps_sampled": 200160, "num_env_steps_trained": 200160, "num_agent_steps_sampled": 200160, "num_agent_steps_trained": 200160}, "done": false, "episodes_total": 556, "training_iteration": 112, "trial_id": "f5e97_00000", "date": "2023-07-25_17-16-46", "timestamp": 1690294606, "time_this_iter_s": 11.39575982093811, "time_total_s": 1251.4622111320496, "pid": 71917, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[0, 0.003], [5400, 0.001], [10800, 0.00075], [16200, 0.0005], [21600, 0.00025], [27000, 0.0001], [32400, 7.5e-05], [37800, 5e-05], [43200, 2.5e-05], [48600, 1e-05], [54000, 7.5e-06], [59400, 5e-06], [64800, 2.5e-06], [70200, 1e-06], [75600, 5e-07], [81000, 1e-07]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x304530310>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1251.4622111320496, "iterations_since_restore": 112, "perf": {"cpu_util_percent": 24.099999999999998, "ram_util_percent": 78.94375}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-07, "entropy_coeff": 0.1, "policy_entropy": -926.7001220703125, "policy_loss": -23474374423347.2, "vf_loss": 1083251692.8}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 2793.0, "diff_num_grad_updates_vs_sampler_policy": 2792.0}}, "num_env_steps_sampled": 201240, "num_env_steps_trained": 201240, "num_agent_steps_sampled": 201240, "num_agent_steps_trained": 201240}, "sampler_results": {"episode_reward_max": -25343.268552303653, "episode_reward_min": -26102.14806445665, "episode_reward_mean": -25755.290829535003, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-25867.090179034065, -26033.13106749242, -25610.889769114186, -25660.437953603592, -25709.168013415092, -25569.824594775288, -25732.30191489128, -25889.39176604255, -25729.758223910954, -25808.274508859773, -25638.239285290947, -25859.125107894786, -25560.01440077342, -25745.729717898535, -25804.867965406884, -25466.42580205111, -25600.832795789127, -25640.301030915405, -25634.036253129038, -25591.02086837972, -25533.861930354342, -25760.32686276445, -25396.99210688679, -25382.538476417383, -25924.810189384803, -25861.887425342076, -25855.252276196476, -25551.072579589287, -25775.999586885166, -25861.110744025074, -25756.456716678895, -25617.208873794578, -25597.01947128544, -25343.268552303653, -25642.9789963566, -25862.808243320793, -25862.541120017588, -25623.5428424464, -25695.679217461256, -25606.17431892844, -25816.19716164555, -25863.72833337226, -25798.788931450992, -25862.58342297002, -25709.185831124872, -25656.533499356352, -25801.86329287919, -25735.077283550734, -25905.161415354407, -26030.385655259062, -25961.244413259574, -25587.178291603854, -25502.553854804308, -25517.177817737986, -26034.06097801261, -25759.87498809651, -25601.91871519938, -25873.138791514357, -25784.505422226386, -25879.253160646764, -25914.29571780409, -25489.40311961304, -25975.842909860385, -25974.699021005083, -25790.845880610497, -25869.96738063129, -25810.069398333406, -25953.65395615741, -25815.451167885232, -25819.739158543565, -26026.27184238485, -26083.733153869016, -25758.136060547233, -25967.78515157466, -25660.300063580053, -25705.08482519234, -26102.14806445665, -25797.349811932254, -25781.579667060716, -25868.398999251014, -25529.3090589514, -25807.03109847257, -25902.754923447952, -25639.988495218277, -25519.349602989754, -25619.05502207858, -25891.1413734565, -25871.921132023614, -25571.612840771653, -26033.929002990495, -25968.70702087451, -25753.59731625539, -25345.672421099924, -25734.096507738315, -25955.573889103773, -25811.43468690695, -25757.650316806128, -26102.10048345207, -25707.737809963204, -25498.861591433688], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.40356065917304, "mean_inference_ms": 0.24715671788572344, "mean_action_processing_ms": 0.05876711922774598, "mean_env_wait_ms": 1.4574693923086683, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0025262832641601562, "StateBufferConnector_ms": 0.0018892288208007812, "ViewRequirementAgentConnector_ms": 0.04725313186645508}}, "episode_reward_max": -25343.268552303653, "episode_reward_min": -26102.14806445665, "episode_reward_mean": -25755.290829535003, "episode_len_mean": 360.0, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-25867.090179034065, -26033.13106749242, -25610.889769114186, -25660.437953603592, -25709.168013415092, -25569.824594775288, -25732.30191489128, -25889.39176604255, -25729.758223910954, -25808.274508859773, -25638.239285290947, -25859.125107894786, -25560.01440077342, -25745.729717898535, -25804.867965406884, -25466.42580205111, -25600.832795789127, -25640.301030915405, -25634.036253129038, -25591.02086837972, -25533.861930354342, -25760.32686276445, -25396.99210688679, -25382.538476417383, -25924.810189384803, -25861.887425342076, -25855.252276196476, -25551.072579589287, -25775.999586885166, -25861.110744025074, -25756.456716678895, -25617.208873794578, -25597.01947128544, -25343.268552303653, -25642.9789963566, -25862.808243320793, -25862.541120017588, -25623.5428424464, -25695.679217461256, -25606.17431892844, -25816.19716164555, -25863.72833337226, -25798.788931450992, -25862.58342297002, -25709.185831124872, -25656.533499356352, -25801.86329287919, -25735.077283550734, -25905.161415354407, -26030.385655259062, -25961.244413259574, -25587.178291603854, -25502.553854804308, -25517.177817737986, -26034.06097801261, -25759.87498809651, -25601.91871519938, -25873.138791514357, -25784.505422226386, -25879.253160646764, -25914.29571780409, -25489.40311961304, -25975.842909860385, -25974.699021005083, -25790.845880610497, -25869.96738063129, -25810.069398333406, -25953.65395615741, -25815.451167885232, -25819.739158543565, -26026.27184238485, -26083.733153869016, -25758.136060547233, -25967.78515157466, -25660.300063580053, -25705.08482519234, -26102.14806445665, -25797.349811932254, -25781.579667060716, -25868.398999251014, -25529.3090589514, -25807.03109847257, -25902.754923447952, -25639.988495218277, -25519.349602989754, -25619.05502207858, -25891.1413734565, -25871.921132023614, -25571.612840771653, -26033.929002990495, -25968.70702087451, -25753.59731625539, -25345.672421099924, -25734.096507738315, -25955.573889103773, -25811.43468690695, -25757.650316806128, -26102.10048345207, -25707.737809963204, -25498.861591433688], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.40356065917304, "mean_inference_ms": 0.24715671788572344, "mean_action_processing_ms": 0.05876711922774598, "mean_env_wait_ms": 1.4574693923086683, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0025262832641601562, "StateBufferConnector_ms": 0.0018892288208007812, "ViewRequirementAgentConnector_ms": 0.04725313186645508}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 201240, "num_agent_steps_trained": 201240, "num_env_steps_sampled": 201240, "num_env_steps_trained": 201240, "num_env_steps_sampled_this_iter": 1080, "num_env_steps_trained_this_iter": 1080, "num_env_steps_sampled_throughput_per_sec": 94.88107662167401, "num_env_steps_trained_throughput_per_sec": 94.88107662167401, "timesteps_total": 201240, "num_steps_trained_this_iter": 1080, "agent_timesteps_total": 201240, "timers": {"training_iteration_time_ms": 3621.93, "sample_time_ms": 3610.65, "load_time_ms": 0.335, "load_throughput": 1073780.003, "learn_time_ms": 10.089, "learn_throughput": 35683.045, "synch_weights_time_ms": 0.802}, "counters": {"num_env_steps_sampled": 201240, "num_env_steps_trained": 201240, "num_agent_steps_sampled": 201240, "num_agent_steps_trained": 201240}, "done": false, "episodes_total": 559, "training_iteration": 113, "trial_id": "f5e97_00000", "date": "2023-07-25_17-16-58", "timestamp": 1690294618, "time_this_iter_s": 11.385616064071655, "time_total_s": 1262.8478271961212, "pid": 71917, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[0, 0.003], [5400, 0.001], [10800, 0.00075], [16200, 0.0005], [21600, 0.00025], [27000, 0.0001], [32400, 7.5e-05], [37800, 5e-05], [43200, 2.5e-05], [48600, 1e-05], [54000, 7.5e-06], [59400, 5e-06], [64800, 2.5e-06], [70200, 1e-06], [75600, 5e-07], [81000, 1e-07]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x304530310>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1262.8478271961212, "iterations_since_restore": 113, "perf": {"cpu_util_percent": 24.1875, "ram_util_percent": 79.29375}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-07, "entropy_coeff": 0.1, "policy_entropy": -926.6994873046875, "policy_loss": -13411494902169.6, "vf_loss": 1116406368.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 2808.0, "diff_num_grad_updates_vs_sampler_policy": 2807.0}}, "num_env_steps_sampled": 202320, "num_env_steps_trained": 202320, "num_agent_steps_sampled": 202320, "num_agent_steps_trained": 202320}, "sampler_results": {"episode_reward_max": -25343.268552303653, "episode_reward_min": -26102.14806445665, "episode_reward_mean": -25756.415463367626, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-25660.437953603592, -25709.168013415092, -25569.824594775288, -25732.30191489128, -25889.39176604255, -25729.758223910954, -25808.274508859773, -25638.239285290947, -25859.125107894786, -25560.01440077342, -25745.729717898535, -25804.867965406884, -25466.42580205111, -25600.832795789127, -25640.301030915405, -25634.036253129038, -25591.02086837972, -25533.861930354342, -25760.32686276445, -25396.99210688679, -25382.538476417383, -25924.810189384803, -25861.887425342076, -25855.252276196476, -25551.072579589287, -25775.999586885166, -25861.110744025074, -25756.456716678895, -25617.208873794578, -25597.01947128544, -25343.268552303653, -25642.9789963566, -25862.808243320793, -25862.541120017588, -25623.5428424464, -25695.679217461256, -25606.17431892844, -25816.19716164555, -25863.72833337226, -25798.788931450992, -25862.58342297002, -25709.185831124872, -25656.533499356352, -25801.86329287919, -25735.077283550734, -25905.161415354407, -26030.385655259062, -25961.244413259574, -25587.178291603854, -25502.553854804308, -25517.177817737986, -26034.06097801261, -25759.87498809651, -25601.91871519938, -25873.138791514357, -25784.505422226386, -25879.253160646764, -25914.29571780409, -25489.40311961304, -25975.842909860385, -25974.699021005083, -25790.845880610497, -25869.96738063129, -25810.069398333406, -25953.65395615741, -25815.451167885232, -25819.739158543565, -26026.27184238485, -26083.733153869016, -25758.136060547233, -25967.78515157466, -25660.300063580053, -25705.08482519234, -26102.14806445665, -25797.349811932254, -25781.579667060716, -25868.398999251014, -25529.3090589514, -25807.03109847257, -25902.754923447952, -25639.988495218277, -25519.349602989754, -25619.05502207858, -25891.1413734565, -25871.921132023614, -25571.612840771653, -26033.929002990495, -25968.70702087451, -25753.59731625539, -25345.672421099924, -25734.096507738315, -25955.573889103773, -25811.43468690695, -25757.650316806128, -26102.10048345207, -25707.737809963204, -25498.861591433688, -25792.569799139757, -25891.087779099707, -25939.916820663995], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.4055881020248835, "mean_inference_ms": 0.24725295441200462, "mean_action_processing_ms": 0.05878989838024747, "mean_env_wait_ms": 1.4580857017168825, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0025637149810791016, "StateBufferConnector_ms": 0.0019190311431884766, "ViewRequirementAgentConnector_ms": 0.04796171188354492}}, "episode_reward_max": -25343.268552303653, "episode_reward_min": -26102.14806445665, "episode_reward_mean": -25756.415463367626, "episode_len_mean": 360.0, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-25660.437953603592, -25709.168013415092, -25569.824594775288, -25732.30191489128, -25889.39176604255, -25729.758223910954, -25808.274508859773, -25638.239285290947, -25859.125107894786, -25560.01440077342, -25745.729717898535, -25804.867965406884, -25466.42580205111, -25600.832795789127, -25640.301030915405, -25634.036253129038, -25591.02086837972, -25533.861930354342, -25760.32686276445, -25396.99210688679, -25382.538476417383, -25924.810189384803, -25861.887425342076, -25855.252276196476, -25551.072579589287, -25775.999586885166, -25861.110744025074, -25756.456716678895, -25617.208873794578, -25597.01947128544, -25343.268552303653, -25642.9789963566, -25862.808243320793, -25862.541120017588, -25623.5428424464, -25695.679217461256, -25606.17431892844, -25816.19716164555, -25863.72833337226, -25798.788931450992, -25862.58342297002, -25709.185831124872, -25656.533499356352, -25801.86329287919, -25735.077283550734, -25905.161415354407, -26030.385655259062, -25961.244413259574, -25587.178291603854, -25502.553854804308, -25517.177817737986, -26034.06097801261, -25759.87498809651, -25601.91871519938, -25873.138791514357, -25784.505422226386, -25879.253160646764, -25914.29571780409, -25489.40311961304, -25975.842909860385, -25974.699021005083, -25790.845880610497, -25869.96738063129, -25810.069398333406, -25953.65395615741, -25815.451167885232, -25819.739158543565, -26026.27184238485, -26083.733153869016, -25758.136060547233, -25967.78515157466, -25660.300063580053, -25705.08482519234, -26102.14806445665, -25797.349811932254, -25781.579667060716, -25868.398999251014, -25529.3090589514, -25807.03109847257, -25902.754923447952, -25639.988495218277, -25519.349602989754, -25619.05502207858, -25891.1413734565, -25871.921132023614, -25571.612840771653, -26033.929002990495, -25968.70702087451, -25753.59731625539, -25345.672421099924, -25734.096507738315, -25955.573889103773, -25811.43468690695, -25757.650316806128, -26102.10048345207, -25707.737809963204, -25498.861591433688, -25792.569799139757, -25891.087779099707, -25939.916820663995], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.4055881020248835, "mean_inference_ms": 0.24725295441200462, "mean_action_processing_ms": 0.05878989838024747, "mean_env_wait_ms": 1.4580857017168825, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0025637149810791016, "StateBufferConnector_ms": 0.0019190311431884766, "ViewRequirementAgentConnector_ms": 0.04796171188354492}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 202320, "num_agent_steps_trained": 202320, "num_env_steps_sampled": 202320, "num_env_steps_trained": 202320, "num_env_steps_sampled_this_iter": 1080, "num_env_steps_trained_this_iter": 1080, "num_env_steps_sampled_throughput_per_sec": 96.04127546999732, "num_env_steps_trained_throughput_per_sec": 96.04127546999732, "timesteps_total": 202320, "num_steps_trained_this_iter": 1080, "agent_timesteps_total": 202320, "timers": {"training_iteration_time_ms": 3779.494, "sample_time_ms": 3767.824, "load_time_ms": 0.322, "load_throughput": 1117074.38, "learn_time_ms": 10.483, "learn_throughput": 34339.9, "synch_weights_time_ms": 0.809}, "counters": {"num_env_steps_sampled": 202320, "num_env_steps_trained": 202320, "num_agent_steps_sampled": 202320, "num_agent_steps_trained": 202320}, "done": false, "episodes_total": 562, "training_iteration": 114, "trial_id": "f5e97_00000", "date": "2023-07-25_17-17-09", "timestamp": 1690294629, "time_this_iter_s": 11.247955083847046, "time_total_s": 1274.0957822799683, "pid": 71917, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[0, 0.003], [5400, 0.001], [10800, 0.00075], [16200, 0.0005], [21600, 0.00025], [27000, 0.0001], [32400, 7.5e-05], [37800, 5e-05], [43200, 2.5e-05], [48600, 1e-05], [54000, 7.5e-06], [59400, 5e-06], [64800, 2.5e-06], [70200, 1e-06], [75600, 5e-07], [81000, 1e-07]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x304530310>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1274.0957822799683, "iterations_since_restore": 114, "perf": {"cpu_util_percent": 26.293750000000003, "ram_util_percent": 78.92499999999998}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-07, "entropy_coeff": 0.1, "policy_entropy": -926.6998046875, "policy_loss": -22763457452441.6, "vf_loss": 1092662144.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 2823.0, "diff_num_grad_updates_vs_sampler_policy": 2822.0}}, "num_env_steps_sampled": 203400, "num_env_steps_trained": 203400, "num_agent_steps_sampled": 203400, "num_agent_steps_trained": 203400}, "sampler_results": {"episode_reward_max": -25343.268552303653, "episode_reward_min": -26102.14806445665, "episode_reward_mean": -25759.283467803038, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-25732.30191489128, -25889.39176604255, -25729.758223910954, -25808.274508859773, -25638.239285290947, -25859.125107894786, -25560.01440077342, -25745.729717898535, -25804.867965406884, -25466.42580205111, -25600.832795789127, -25640.301030915405, -25634.036253129038, -25591.02086837972, -25533.861930354342, -25760.32686276445, -25396.99210688679, -25382.538476417383, -25924.810189384803, -25861.887425342076, -25855.252276196476, -25551.072579589287, -25775.999586885166, -25861.110744025074, -25756.456716678895, -25617.208873794578, -25597.01947128544, -25343.268552303653, -25642.9789963566, -25862.808243320793, -25862.541120017588, -25623.5428424464, -25695.679217461256, -25606.17431892844, -25816.19716164555, -25863.72833337226, -25798.788931450992, -25862.58342297002, -25709.185831124872, -25656.533499356352, -25801.86329287919, -25735.077283550734, -25905.161415354407, -26030.385655259062, -25961.244413259574, -25587.178291603854, -25502.553854804308, -25517.177817737986, -26034.06097801261, -25759.87498809651, -25601.91871519938, -25873.138791514357, -25784.505422226386, -25879.253160646764, -25914.29571780409, -25489.40311961304, -25975.842909860385, -25974.699021005083, -25790.845880610497, -25869.96738063129, -25810.069398333406, -25953.65395615741, -25815.451167885232, -25819.739158543565, -26026.27184238485, -26083.733153869016, -25758.136060547233, -25967.78515157466, -25660.300063580053, -25705.08482519234, -26102.14806445665, -25797.349811932254, -25781.579667060716, -25868.398999251014, -25529.3090589514, -25807.03109847257, -25902.754923447952, -25639.988495218277, -25519.349602989754, -25619.05502207858, -25891.1413734565, -25871.921132023614, -25571.612840771653, -26033.929002990495, -25968.70702087451, -25753.59731625539, -25345.672421099924, -25734.096507738315, -25955.573889103773, -25811.43468690695, -25757.650316806128, -26102.10048345207, -25707.737809963204, -25498.861591433688, -25792.569799139757, -25891.087779099707, -25939.916820663995, -25759.14015205737, -25762.77959591386, -25704.311257363963], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.40808905005455, "mean_inference_ms": 0.24737014397266419, "mean_action_processing_ms": 0.058817982076958576, "mean_env_wait_ms": 1.4588542038105154, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0026175975799560547, "StateBufferConnector_ms": 0.0019423961639404297, "ViewRequirementAgentConnector_ms": 0.0487213134765625}}, "episode_reward_max": -25343.268552303653, "episode_reward_min": -26102.14806445665, "episode_reward_mean": -25759.283467803038, "episode_len_mean": 360.0, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-25732.30191489128, -25889.39176604255, -25729.758223910954, -25808.274508859773, -25638.239285290947, -25859.125107894786, -25560.01440077342, -25745.729717898535, -25804.867965406884, -25466.42580205111, -25600.832795789127, -25640.301030915405, -25634.036253129038, -25591.02086837972, -25533.861930354342, -25760.32686276445, -25396.99210688679, -25382.538476417383, -25924.810189384803, -25861.887425342076, -25855.252276196476, -25551.072579589287, -25775.999586885166, -25861.110744025074, -25756.456716678895, -25617.208873794578, -25597.01947128544, -25343.268552303653, -25642.9789963566, -25862.808243320793, -25862.541120017588, -25623.5428424464, -25695.679217461256, -25606.17431892844, -25816.19716164555, -25863.72833337226, -25798.788931450992, -25862.58342297002, -25709.185831124872, -25656.533499356352, -25801.86329287919, -25735.077283550734, -25905.161415354407, -26030.385655259062, -25961.244413259574, -25587.178291603854, -25502.553854804308, -25517.177817737986, -26034.06097801261, -25759.87498809651, -25601.91871519938, -25873.138791514357, -25784.505422226386, -25879.253160646764, -25914.29571780409, -25489.40311961304, -25975.842909860385, -25974.699021005083, -25790.845880610497, -25869.96738063129, -25810.069398333406, -25953.65395615741, -25815.451167885232, -25819.739158543565, -26026.27184238485, -26083.733153869016, -25758.136060547233, -25967.78515157466, -25660.300063580053, -25705.08482519234, -26102.14806445665, -25797.349811932254, -25781.579667060716, -25868.398999251014, -25529.3090589514, -25807.03109847257, -25902.754923447952, -25639.988495218277, -25519.349602989754, -25619.05502207858, -25891.1413734565, -25871.921132023614, -25571.612840771653, -26033.929002990495, -25968.70702087451, -25753.59731625539, -25345.672421099924, -25734.096507738315, -25955.573889103773, -25811.43468690695, -25757.650316806128, -26102.10048345207, -25707.737809963204, -25498.861591433688, -25792.569799139757, -25891.087779099707, -25939.916820663995, -25759.14015205737, -25762.77959591386, -25704.311257363963], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.40808905005455, "mean_inference_ms": 0.24737014397266419, "mean_action_processing_ms": 0.058817982076958576, "mean_env_wait_ms": 1.4588542038105154, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0026175975799560547, "StateBufferConnector_ms": 0.0019423961639404297, "ViewRequirementAgentConnector_ms": 0.0487213134765625}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 203400, "num_agent_steps_trained": 203400, "num_env_steps_sampled": 203400, "num_env_steps_trained": 203400, "num_env_steps_sampled_this_iter": 1080, "num_env_steps_trained_this_iter": 1080, "num_env_steps_sampled_throughput_per_sec": 96.2295494472978, "num_env_steps_trained_throughput_per_sec": 96.2295494472978, "timesteps_total": 203400, "num_steps_trained_this_iter": 1080, "agent_timesteps_total": 203400, "timers": {"training_iteration_time_ms": 3776.569, "sample_time_ms": 3764.902, "load_time_ms": 0.326, "load_throughput": 1104490.849, "learn_time_ms": 10.468, "learn_throughput": 34391.522, "synch_weights_time_ms": 0.818}, "counters": {"num_env_steps_sampled": 203400, "num_env_steps_trained": 203400, "num_agent_steps_sampled": 203400, "num_agent_steps_trained": 203400}, "done": false, "episodes_total": 565, "training_iteration": 115, "trial_id": "f5e97_00000", "date": "2023-07-25_17-17-20", "timestamp": 1690294640, "time_this_iter_s": 11.226053237915039, "time_total_s": 1285.3218355178833, "pid": 71917, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[0, 0.003], [5400, 0.001], [10800, 0.00075], [16200, 0.0005], [21600, 0.00025], [27000, 0.0001], [32400, 7.5e-05], [37800, 5e-05], [43200, 2.5e-05], [48600, 1e-05], [54000, 7.5e-06], [59400, 5e-06], [64800, 2.5e-06], [70200, 1e-06], [75600, 5e-07], [81000, 1e-07]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x304530310>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1285.3218355178833, "iterations_since_restore": 115, "perf": {"cpu_util_percent": 25.799999999999997, "ram_util_percent": 79.43125}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-07, "entropy_coeff": 0.1, "policy_entropy": -926.6999145507813, "policy_loss": -22944307416268.8, "vf_loss": 1094189414.4}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 2838.0, "diff_num_grad_updates_vs_sampler_policy": 2837.0}}, "num_env_steps_sampled": 204480, "num_env_steps_trained": 204480, "num_agent_steps_sampled": 204480, "num_agent_steps_trained": 204480}, "sampler_results": {"episode_reward_max": -25343.268552303653, "episode_reward_min": -26102.14806445665, "episode_reward_mean": -25757.30528301239, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-25808.274508859773, -25638.239285290947, -25859.125107894786, -25560.01440077342, -25745.729717898535, -25804.867965406884, -25466.42580205111, -25600.832795789127, -25640.301030915405, -25634.036253129038, -25591.02086837972, -25533.861930354342, -25760.32686276445, -25396.99210688679, -25382.538476417383, -25924.810189384803, -25861.887425342076, -25855.252276196476, -25551.072579589287, -25775.999586885166, -25861.110744025074, -25756.456716678895, -25617.208873794578, -25597.01947128544, -25343.268552303653, -25642.9789963566, -25862.808243320793, -25862.541120017588, -25623.5428424464, -25695.679217461256, -25606.17431892844, -25816.19716164555, -25863.72833337226, -25798.788931450992, -25862.58342297002, -25709.185831124872, -25656.533499356352, -25801.86329287919, -25735.077283550734, -25905.161415354407, -26030.385655259062, -25961.244413259574, -25587.178291603854, -25502.553854804308, -25517.177817737986, -26034.06097801261, -25759.87498809651, -25601.91871519938, -25873.138791514357, -25784.505422226386, -25879.253160646764, -25914.29571780409, -25489.40311961304, -25975.842909860385, -25974.699021005083, -25790.845880610497, -25869.96738063129, -25810.069398333406, -25953.65395615741, -25815.451167885232, -25819.739158543565, -26026.27184238485, -26083.733153869016, -25758.136060547233, -25967.78515157466, -25660.300063580053, -25705.08482519234, -26102.14806445665, -25797.349811932254, -25781.579667060716, -25868.398999251014, -25529.3090589514, -25807.03109847257, -25902.754923447952, -25639.988495218277, -25519.349602989754, -25619.05502207858, -25891.1413734565, -25871.921132023614, -25571.612840771653, -26033.929002990495, -25968.70702087451, -25753.59731625539, -25345.672421099924, -25734.096507738315, -25955.573889103773, -25811.43468690695, -25757.650316806128, -26102.10048345207, -25707.737809963204, -25498.861591433688, -25792.569799139757, -25891.087779099707, -25939.916820663995, -25759.14015205737, -25762.77959591386, -25704.311257363963, -25815.26912545352, -25700.99265257654, -25637.371647749467], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.4110855381347776, "mean_inference_ms": 0.2475096517596386, "mean_action_processing_ms": 0.05885165585710845, "mean_env_wait_ms": 1.4597768946425151, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0026504993438720703, "StateBufferConnector_ms": 0.001965761184692383, "ViewRequirementAgentConnector_ms": 0.04943370819091797}}, "episode_reward_max": -25343.268552303653, "episode_reward_min": -26102.14806445665, "episode_reward_mean": -25757.30528301239, "episode_len_mean": 360.0, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-25808.274508859773, -25638.239285290947, -25859.125107894786, -25560.01440077342, -25745.729717898535, -25804.867965406884, -25466.42580205111, -25600.832795789127, -25640.301030915405, -25634.036253129038, -25591.02086837972, -25533.861930354342, -25760.32686276445, -25396.99210688679, -25382.538476417383, -25924.810189384803, -25861.887425342076, -25855.252276196476, -25551.072579589287, -25775.999586885166, -25861.110744025074, -25756.456716678895, -25617.208873794578, -25597.01947128544, -25343.268552303653, -25642.9789963566, -25862.808243320793, -25862.541120017588, -25623.5428424464, -25695.679217461256, -25606.17431892844, -25816.19716164555, -25863.72833337226, -25798.788931450992, -25862.58342297002, -25709.185831124872, -25656.533499356352, -25801.86329287919, -25735.077283550734, -25905.161415354407, -26030.385655259062, -25961.244413259574, -25587.178291603854, -25502.553854804308, -25517.177817737986, -26034.06097801261, -25759.87498809651, -25601.91871519938, -25873.138791514357, -25784.505422226386, -25879.253160646764, -25914.29571780409, -25489.40311961304, -25975.842909860385, -25974.699021005083, -25790.845880610497, -25869.96738063129, -25810.069398333406, -25953.65395615741, -25815.451167885232, -25819.739158543565, -26026.27184238485, -26083.733153869016, -25758.136060547233, -25967.78515157466, -25660.300063580053, -25705.08482519234, -26102.14806445665, -25797.349811932254, -25781.579667060716, -25868.398999251014, -25529.3090589514, -25807.03109847257, -25902.754923447952, -25639.988495218277, -25519.349602989754, -25619.05502207858, -25891.1413734565, -25871.921132023614, -25571.612840771653, -26033.929002990495, -25968.70702087451, -25753.59731625539, -25345.672421099924, -25734.096507738315, -25955.573889103773, -25811.43468690695, -25757.650316806128, -26102.10048345207, -25707.737809963204, -25498.861591433688, -25792.569799139757, -25891.087779099707, -25939.916820663995, -25759.14015205737, -25762.77959591386, -25704.311257363963, -25815.26912545352, -25700.99265257654, -25637.371647749467], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.4110855381347776, "mean_inference_ms": 0.2475096517596386, "mean_action_processing_ms": 0.05885165585710845, "mean_env_wait_ms": 1.4597768946425151, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0026504993438720703, "StateBufferConnector_ms": 0.001965761184692383, "ViewRequirementAgentConnector_ms": 0.04943370819091797}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 204480, "num_agent_steps_trained": 204480, "num_env_steps_sampled": 204480, "num_env_steps_trained": 204480, "num_env_steps_sampled_this_iter": 1080, "num_env_steps_trained_this_iter": 1080, "num_env_steps_sampled_throughput_per_sec": 94.50745425905114, "num_env_steps_trained_throughput_per_sec": 94.50745425905114, "timesteps_total": 204480, "num_steps_trained_this_iter": 1080, "agent_timesteps_total": 204480, "timers": {"training_iteration_time_ms": 3779.509, "sample_time_ms": 3768.334, "load_time_ms": 0.318, "load_throughput": 1132405.46, "learn_time_ms": 10.074, "learn_throughput": 35736.757, "synch_weights_time_ms": 0.736}, "counters": {"num_env_steps_sampled": 204480, "num_env_steps_trained": 204480, "num_agent_steps_sampled": 204480, "num_agent_steps_trained": 204480}, "done": false, "episodes_total": 568, "training_iteration": 116, "trial_id": "f5e97_00000", "date": "2023-07-25_17-17-32", "timestamp": 1690294652, "time_this_iter_s": 11.430597066879272, "time_total_s": 1296.7524325847626, "pid": 71917, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[0, 0.003], [5400, 0.001], [10800, 0.00075], [16200, 0.0005], [21600, 0.00025], [27000, 0.0001], [32400, 7.5e-05], [37800, 5e-05], [43200, 2.5e-05], [48600, 1e-05], [54000, 7.5e-06], [59400, 5e-06], [64800, 2.5e-06], [70200, 1e-06], [75600, 5e-07], [81000, 1e-07]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x304530310>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1296.7524325847626, "iterations_since_restore": 116, "perf": {"cpu_util_percent": 25.637500000000003, "ram_util_percent": 78.9125}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-07, "entropy_coeff": 0.1, "policy_entropy": -926.6998901367188, "policy_loss": -27173089584742.4, "vf_loss": 1096801068.8}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 2853.0, "diff_num_grad_updates_vs_sampler_policy": 2852.0}}, "num_env_steps_sampled": 205560, "num_env_steps_trained": 205560, "num_agent_steps_sampled": 205560, "num_agent_steps_trained": 205560}, "sampler_results": {"episode_reward_max": -25343.268552303653, "episode_reward_min": -26102.14806445665, "episode_reward_mean": -25754.854543272144, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-25560.01440077342, -25745.729717898535, -25804.867965406884, -25466.42580205111, -25600.832795789127, -25640.301030915405, -25634.036253129038, -25591.02086837972, -25533.861930354342, -25760.32686276445, -25396.99210688679, -25382.538476417383, -25924.810189384803, -25861.887425342076, -25855.252276196476, -25551.072579589287, -25775.999586885166, -25861.110744025074, -25756.456716678895, -25617.208873794578, -25597.01947128544, -25343.268552303653, -25642.9789963566, -25862.808243320793, -25862.541120017588, -25623.5428424464, -25695.679217461256, -25606.17431892844, -25816.19716164555, -25863.72833337226, -25798.788931450992, -25862.58342297002, -25709.185831124872, -25656.533499356352, -25801.86329287919, -25735.077283550734, -25905.161415354407, -26030.385655259062, -25961.244413259574, -25587.178291603854, -25502.553854804308, -25517.177817737986, -26034.06097801261, -25759.87498809651, -25601.91871519938, -25873.138791514357, -25784.505422226386, -25879.253160646764, -25914.29571780409, -25489.40311961304, -25975.842909860385, -25974.699021005083, -25790.845880610497, -25869.96738063129, -25810.069398333406, -25953.65395615741, -25815.451167885232, -25819.739158543565, -26026.27184238485, -26083.733153869016, -25758.136060547233, -25967.78515157466, -25660.300063580053, -25705.08482519234, -26102.14806445665, -25797.349811932254, -25781.579667060716, -25868.398999251014, -25529.3090589514, -25807.03109847257, -25902.754923447952, -25639.988495218277, -25519.349602989754, -25619.05502207858, -25891.1413734565, -25871.921132023614, -25571.612840771653, -26033.929002990495, -25968.70702087451, -25753.59731625539, -25345.672421099924, -25734.096507738315, -25955.573889103773, -25811.43468690695, -25757.650316806128, -26102.10048345207, -25707.737809963204, -25498.861591433688, -25792.569799139757, -25891.087779099707, -25939.916820663995, -25759.14015205737, -25762.77959591386, -25704.311257363963, -25815.26912545352, -25700.99265257654, -25637.371647749467, -25585.901797595612, -25743.78194530946, -25730.88118511566], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.414549234917266, "mean_inference_ms": 0.2476697144812551, "mean_action_processing_ms": 0.058890574699829557, "mean_env_wait_ms": 1.4608513817838238, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0026886463165283203, "StateBufferConnector_ms": 0.001993417739868164, "ViewRequirementAgentConnector_ms": 0.0500788688659668}}, "episode_reward_max": -25343.268552303653, "episode_reward_min": -26102.14806445665, "episode_reward_mean": -25754.854543272144, "episode_len_mean": 360.0, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-25560.01440077342, -25745.729717898535, -25804.867965406884, -25466.42580205111, -25600.832795789127, -25640.301030915405, -25634.036253129038, -25591.02086837972, -25533.861930354342, -25760.32686276445, -25396.99210688679, -25382.538476417383, -25924.810189384803, -25861.887425342076, -25855.252276196476, -25551.072579589287, -25775.999586885166, -25861.110744025074, -25756.456716678895, -25617.208873794578, -25597.01947128544, -25343.268552303653, -25642.9789963566, -25862.808243320793, -25862.541120017588, -25623.5428424464, -25695.679217461256, -25606.17431892844, -25816.19716164555, -25863.72833337226, -25798.788931450992, -25862.58342297002, -25709.185831124872, -25656.533499356352, -25801.86329287919, -25735.077283550734, -25905.161415354407, -26030.385655259062, -25961.244413259574, -25587.178291603854, -25502.553854804308, -25517.177817737986, -26034.06097801261, -25759.87498809651, -25601.91871519938, -25873.138791514357, -25784.505422226386, -25879.253160646764, -25914.29571780409, -25489.40311961304, -25975.842909860385, -25974.699021005083, -25790.845880610497, -25869.96738063129, -25810.069398333406, -25953.65395615741, -25815.451167885232, -25819.739158543565, -26026.27184238485, -26083.733153869016, -25758.136060547233, -25967.78515157466, -25660.300063580053, -25705.08482519234, -26102.14806445665, -25797.349811932254, -25781.579667060716, -25868.398999251014, -25529.3090589514, -25807.03109847257, -25902.754923447952, -25639.988495218277, -25519.349602989754, -25619.05502207858, -25891.1413734565, -25871.921132023614, -25571.612840771653, -26033.929002990495, -25968.70702087451, -25753.59731625539, -25345.672421099924, -25734.096507738315, -25955.573889103773, -25811.43468690695, -25757.650316806128, -26102.10048345207, -25707.737809963204, -25498.861591433688, -25792.569799139757, -25891.087779099707, -25939.916820663995, -25759.14015205737, -25762.77959591386, -25704.311257363963, -25815.26912545352, -25700.99265257654, -25637.371647749467, -25585.901797595612, -25743.78194530946, -25730.88118511566], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.414549234917266, "mean_inference_ms": 0.2476697144812551, "mean_action_processing_ms": 0.058890574699829557, "mean_env_wait_ms": 1.4608513817838238, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0026886463165283203, "StateBufferConnector_ms": 0.001993417739868164, "ViewRequirementAgentConnector_ms": 0.0500788688659668}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 205560, "num_agent_steps_trained": 205560, "num_env_steps_sampled": 205560, "num_env_steps_trained": 205560, "num_env_steps_sampled_this_iter": 1080, "num_env_steps_trained_this_iter": 1080, "num_env_steps_sampled_throughput_per_sec": 96.17539106106643, "num_env_steps_trained_throughput_per_sec": 96.17539106106643, "timesteps_total": 205560, "num_steps_trained_this_iter": 1080, "agent_timesteps_total": 205560, "timers": {"training_iteration_time_ms": 3755.727, "sample_time_ms": 3745.051, "load_time_ms": 0.304, "load_throughput": 1186134.674, "learn_time_ms": 9.625, "learn_throughput": 37400.815, "synch_weights_time_ms": 0.704}, "counters": {"num_env_steps_sampled": 205560, "num_env_steps_trained": 205560, "num_agent_steps_sampled": 205560, "num_agent_steps_trained": 205560}, "done": false, "episodes_total": 571, "training_iteration": 117, "trial_id": "f5e97_00000", "date": "2023-07-25_17-17-43", "timestamp": 1690294663, "time_this_iter_s": 11.232162952423096, "time_total_s": 1307.9845955371857, "pid": 71917, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[0, 0.003], [5400, 0.001], [10800, 0.00075], [16200, 0.0005], [21600, 0.00025], [27000, 0.0001], [32400, 7.5e-05], [37800, 5e-05], [43200, 2.5e-05], [48600, 1e-05], [54000, 7.5e-06], [59400, 5e-06], [64800, 2.5e-06], [70200, 1e-06], [75600, 5e-07], [81000, 1e-07]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x304530310>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1307.9845955371857, "iterations_since_restore": 117, "perf": {"cpu_util_percent": 26.05, "ram_util_percent": 79.56875}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-07, "entropy_coeff": 0.1, "policy_entropy": -926.700048828125, "policy_loss": -33306219616665.6, "vf_loss": 1094401452.8}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 2868.0, "diff_num_grad_updates_vs_sampler_policy": 2867.0}}, "num_env_steps_sampled": 206640, "num_env_steps_trained": 206640, "num_agent_steps_sampled": 206640, "num_agent_steps_trained": 206640}, "sampler_results": {"episode_reward_max": -25343.268552303653, "episode_reward_min": -26102.14806445665, "episode_reward_mean": -25755.231746889065, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-25466.42580205111, -25600.832795789127, -25640.301030915405, -25634.036253129038, -25591.02086837972, -25533.861930354342, -25760.32686276445, -25396.99210688679, -25382.538476417383, -25924.810189384803, -25861.887425342076, -25855.252276196476, -25551.072579589287, -25775.999586885166, -25861.110744025074, -25756.456716678895, -25617.208873794578, -25597.01947128544, -25343.268552303653, -25642.9789963566, -25862.808243320793, -25862.541120017588, -25623.5428424464, -25695.679217461256, -25606.17431892844, -25816.19716164555, -25863.72833337226, -25798.788931450992, -25862.58342297002, -25709.185831124872, -25656.533499356352, -25801.86329287919, -25735.077283550734, -25905.161415354407, -26030.385655259062, -25961.244413259574, -25587.178291603854, -25502.553854804308, -25517.177817737986, -26034.06097801261, -25759.87498809651, -25601.91871519938, -25873.138791514357, -25784.505422226386, -25879.253160646764, -25914.29571780409, -25489.40311961304, -25975.842909860385, -25974.699021005083, -25790.845880610497, -25869.96738063129, -25810.069398333406, -25953.65395615741, -25815.451167885232, -25819.739158543565, -26026.27184238485, -26083.733153869016, -25758.136060547233, -25967.78515157466, -25660.300063580053, -25705.08482519234, -26102.14806445665, -25797.349811932254, -25781.579667060716, -25868.398999251014, -25529.3090589514, -25807.03109847257, -25902.754923447952, -25639.988495218277, -25519.349602989754, -25619.05502207858, -25891.1413734565, -25871.921132023614, -25571.612840771653, -26033.929002990495, -25968.70702087451, -25753.59731625539, -25345.672421099924, -25734.096507738315, -25955.573889103773, -25811.43468690695, -25757.650316806128, -26102.10048345207, -25707.737809963204, -25498.861591433688, -25792.569799139757, -25891.087779099707, -25939.916820663995, -25759.14015205737, -25762.77959591386, -25704.311257363963, -25815.26912545352, -25700.99265257654, -25637.371647749467, -25585.901797595612, -25743.78194530946, -25730.88118511566, -25693.754176045648, -25698.066298154874, -25756.51197157061], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.418483081160396, "mean_inference_ms": 0.24785109416658568, "mean_action_processing_ms": 0.05893470453066655, "mean_env_wait_ms": 1.4620886566662568, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0027315616607666016, "StateBufferConnector_ms": 0.002022266387939453, "ViewRequirementAgentConnector_ms": 0.05083036422729492}}, "episode_reward_max": -25343.268552303653, "episode_reward_min": -26102.14806445665, "episode_reward_mean": -25755.231746889065, "episode_len_mean": 360.0, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-25466.42580205111, -25600.832795789127, -25640.301030915405, -25634.036253129038, -25591.02086837972, -25533.861930354342, -25760.32686276445, -25396.99210688679, -25382.538476417383, -25924.810189384803, -25861.887425342076, -25855.252276196476, -25551.072579589287, -25775.999586885166, -25861.110744025074, -25756.456716678895, -25617.208873794578, -25597.01947128544, -25343.268552303653, -25642.9789963566, -25862.808243320793, -25862.541120017588, -25623.5428424464, -25695.679217461256, -25606.17431892844, -25816.19716164555, -25863.72833337226, -25798.788931450992, -25862.58342297002, -25709.185831124872, -25656.533499356352, -25801.86329287919, -25735.077283550734, -25905.161415354407, -26030.385655259062, -25961.244413259574, -25587.178291603854, -25502.553854804308, -25517.177817737986, -26034.06097801261, -25759.87498809651, -25601.91871519938, -25873.138791514357, -25784.505422226386, -25879.253160646764, -25914.29571780409, -25489.40311961304, -25975.842909860385, -25974.699021005083, -25790.845880610497, -25869.96738063129, -25810.069398333406, -25953.65395615741, -25815.451167885232, -25819.739158543565, -26026.27184238485, -26083.733153869016, -25758.136060547233, -25967.78515157466, -25660.300063580053, -25705.08482519234, -26102.14806445665, -25797.349811932254, -25781.579667060716, -25868.398999251014, -25529.3090589514, -25807.03109847257, -25902.754923447952, -25639.988495218277, -25519.349602989754, -25619.05502207858, -25891.1413734565, -25871.921132023614, -25571.612840771653, -26033.929002990495, -25968.70702087451, -25753.59731625539, -25345.672421099924, -25734.096507738315, -25955.573889103773, -25811.43468690695, -25757.650316806128, -26102.10048345207, -25707.737809963204, -25498.861591433688, -25792.569799139757, -25891.087779099707, -25939.916820663995, -25759.14015205737, -25762.77959591386, -25704.311257363963, -25815.26912545352, -25700.99265257654, -25637.371647749467, -25585.901797595612, -25743.78194530946, -25730.88118511566, -25693.754176045648, -25698.066298154874, -25756.51197157061], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.418483081160396, "mean_inference_ms": 0.24785109416658568, "mean_action_processing_ms": 0.05893470453066655, "mean_env_wait_ms": 1.4620886566662568, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0027315616607666016, "StateBufferConnector_ms": 0.002022266387939453, "ViewRequirementAgentConnector_ms": 0.05083036422729492}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 206640, "num_agent_steps_trained": 206640, "num_env_steps_sampled": 206640, "num_env_steps_trained": 206640, "num_env_steps_sampled_this_iter": 1080, "num_env_steps_trained_this_iter": 1080, "num_env_steps_sampled_throughput_per_sec": 94.70324809776513, "num_env_steps_trained_throughput_per_sec": 94.70324809776513, "timesteps_total": 206640, "num_steps_trained_this_iter": 1080, "agent_timesteps_total": 206640, "timers": {"training_iteration_time_ms": 3766.163, "sample_time_ms": 3755.502, "load_time_ms": 0.298, "load_throughput": 1206993.957, "learn_time_ms": 9.613, "learn_throughput": 37447.935, "synch_weights_time_ms": 0.707}, "counters": {"num_env_steps_sampled": 206640, "num_env_steps_trained": 206640, "num_agent_steps_sampled": 206640, "num_agent_steps_trained": 206640}, "done": false, "episodes_total": 574, "training_iteration": 118, "trial_id": "f5e97_00000", "date": "2023-07-25_17-17-54", "timestamp": 1690294674, "time_this_iter_s": 11.406846046447754, "time_total_s": 1319.3914415836334, "pid": 71917, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[0, 0.003], [5400, 0.001], [10800, 0.00075], [16200, 0.0005], [21600, 0.00025], [27000, 0.0001], [32400, 7.5e-05], [37800, 5e-05], [43200, 2.5e-05], [48600, 1e-05], [54000, 7.5e-06], [59400, 5e-06], [64800, 2.5e-06], [70200, 1e-06], [75600, 5e-07], [81000, 1e-07]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x304530310>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1319.3914415836334, "iterations_since_restore": 118, "perf": {"cpu_util_percent": 23.329411764705885, "ram_util_percent": 79.91176470588235}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-07, "entropy_coeff": 0.1, "policy_entropy": -926.7001831054688, "policy_loss": -18446369611776.0, "vf_loss": 1068016499.2}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 2883.0, "diff_num_grad_updates_vs_sampler_policy": 2882.0}}, "num_env_steps_sampled": 207720, "num_env_steps_trained": 207720, "num_agent_steps_sampled": 207720, "num_agent_steps_trained": 207720}, "sampler_results": {"episode_reward_max": -25343.268552303653, "episode_reward_min": -26102.14806445665, "episode_reward_mean": -25760.951357348804, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-25634.036253129038, -25591.02086837972, -25533.861930354342, -25760.32686276445, -25396.99210688679, -25382.538476417383, -25924.810189384803, -25861.887425342076, -25855.252276196476, -25551.072579589287, -25775.999586885166, -25861.110744025074, -25756.456716678895, -25617.208873794578, -25597.01947128544, -25343.268552303653, -25642.9789963566, -25862.808243320793, -25862.541120017588, -25623.5428424464, -25695.679217461256, -25606.17431892844, -25816.19716164555, -25863.72833337226, -25798.788931450992, -25862.58342297002, -25709.185831124872, -25656.533499356352, -25801.86329287919, -25735.077283550734, -25905.161415354407, -26030.385655259062, -25961.244413259574, -25587.178291603854, -25502.553854804308, -25517.177817737986, -26034.06097801261, -25759.87498809651, -25601.91871519938, -25873.138791514357, -25784.505422226386, -25879.253160646764, -25914.29571780409, -25489.40311961304, -25975.842909860385, -25974.699021005083, -25790.845880610497, -25869.96738063129, -25810.069398333406, -25953.65395615741, -25815.451167885232, -25819.739158543565, -26026.27184238485, -26083.733153869016, -25758.136060547233, -25967.78515157466, -25660.300063580053, -25705.08482519234, -26102.14806445665, -25797.349811932254, -25781.579667060716, -25868.398999251014, -25529.3090589514, -25807.03109847257, -25902.754923447952, -25639.988495218277, -25519.349602989754, -25619.05502207858, -25891.1413734565, -25871.921132023614, -25571.612840771653, -26033.929002990495, -25968.70702087451, -25753.59731625539, -25345.672421099924, -25734.096507738315, -25955.573889103773, -25811.43468690695, -25757.650316806128, -26102.10048345207, -25707.737809963204, -25498.861591433688, -25792.569799139757, -25891.087779099707, -25939.916820663995, -25759.14015205737, -25762.77959591386, -25704.311257363963, -25815.26912545352, -25700.99265257654, -25637.371647749467, -25585.901797595612, -25743.78194530946, -25730.88118511566, -25693.754176045648, -25698.066298154874, -25756.51197157061, -25905.5706532299, -25980.36756481758, -25393.582456681695], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.422868262294493, "mean_inference_ms": 0.24805223549481947, "mean_action_processing_ms": 0.05898376066478987, "mean_env_wait_ms": 1.4634727103548468, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002756834030151367, "StateBufferConnector_ms": 0.0020482540130615234, "ViewRequirementAgentConnector_ms": 0.051444292068481445}}, "episode_reward_max": -25343.268552303653, "episode_reward_min": -26102.14806445665, "episode_reward_mean": -25760.951357348804, "episode_len_mean": 360.0, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-25634.036253129038, -25591.02086837972, -25533.861930354342, -25760.32686276445, -25396.99210688679, -25382.538476417383, -25924.810189384803, -25861.887425342076, -25855.252276196476, -25551.072579589287, -25775.999586885166, -25861.110744025074, -25756.456716678895, -25617.208873794578, -25597.01947128544, -25343.268552303653, -25642.9789963566, -25862.808243320793, -25862.541120017588, -25623.5428424464, -25695.679217461256, -25606.17431892844, -25816.19716164555, -25863.72833337226, -25798.788931450992, -25862.58342297002, -25709.185831124872, -25656.533499356352, -25801.86329287919, -25735.077283550734, -25905.161415354407, -26030.385655259062, -25961.244413259574, -25587.178291603854, -25502.553854804308, -25517.177817737986, -26034.06097801261, -25759.87498809651, -25601.91871519938, -25873.138791514357, -25784.505422226386, -25879.253160646764, -25914.29571780409, -25489.40311961304, -25975.842909860385, -25974.699021005083, -25790.845880610497, -25869.96738063129, -25810.069398333406, -25953.65395615741, -25815.451167885232, -25819.739158543565, -26026.27184238485, -26083.733153869016, -25758.136060547233, -25967.78515157466, -25660.300063580053, -25705.08482519234, -26102.14806445665, -25797.349811932254, -25781.579667060716, -25868.398999251014, -25529.3090589514, -25807.03109847257, -25902.754923447952, -25639.988495218277, -25519.349602989754, -25619.05502207858, -25891.1413734565, -25871.921132023614, -25571.612840771653, -26033.929002990495, -25968.70702087451, -25753.59731625539, -25345.672421099924, -25734.096507738315, -25955.573889103773, -25811.43468690695, -25757.650316806128, -26102.10048345207, -25707.737809963204, -25498.861591433688, -25792.569799139757, -25891.087779099707, -25939.916820663995, -25759.14015205737, -25762.77959591386, -25704.311257363963, -25815.26912545352, -25700.99265257654, -25637.371647749467, -25585.901797595612, -25743.78194530946, -25730.88118511566, -25693.754176045648, -25698.066298154874, -25756.51197157061, -25905.5706532299, -25980.36756481758, -25393.582456681695], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.422868262294493, "mean_inference_ms": 0.24805223549481947, "mean_action_processing_ms": 0.05898376066478987, "mean_env_wait_ms": 1.4634727103548468, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002756834030151367, "StateBufferConnector_ms": 0.0020482540130615234, "ViewRequirementAgentConnector_ms": 0.051444292068481445}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 207720, "num_agent_steps_trained": 207720, "num_env_steps_sampled": 207720, "num_env_steps_trained": 207720, "num_env_steps_sampled_this_iter": 1080, "num_env_steps_trained_this_iter": 1080, "num_env_steps_sampled_throughput_per_sec": 95.81888887488105, "num_env_steps_trained_throughput_per_sec": 95.81888887488105, "timesteps_total": 207720, "num_steps_trained_this_iter": 1080, "agent_timesteps_total": 207720, "timers": {"training_iteration_time_ms": 3764.792, "sample_time_ms": 3754.098, "load_time_ms": 0.297, "load_throughput": 1213298.063, "learn_time_ms": 9.661, "learn_throughput": 37263.013, "synch_weights_time_ms": 0.694}, "counters": {"num_env_steps_sampled": 207720, "num_env_steps_trained": 207720, "num_agent_steps_sampled": 207720, "num_agent_steps_trained": 207720}, "done": false, "episodes_total": 577, "training_iteration": 119, "trial_id": "f5e97_00000", "date": "2023-07-25_17-18-06", "timestamp": 1690294686, "time_this_iter_s": 11.274199962615967, "time_total_s": 1330.6656415462494, "pid": 71917, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[0, 0.003], [5400, 0.001], [10800, 0.00075], [16200, 0.0005], [21600, 0.00025], [27000, 0.0001], [32400, 7.5e-05], [37800, 5e-05], [43200, 2.5e-05], [48600, 1e-05], [54000, 7.5e-06], [59400, 5e-06], [64800, 2.5e-06], [70200, 1e-06], [75600, 5e-07], [81000, 1e-07]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x304530310>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1330.6656415462494, "iterations_since_restore": 119, "perf": {"cpu_util_percent": 25.23125, "ram_util_percent": 79.275}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-07, "entropy_coeff": 0.1, "policy_entropy": -926.699951171875, "policy_loss": -32622875345715.2, "vf_loss": 1082792000.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 2898.0, "diff_num_grad_updates_vs_sampler_policy": 2897.0}}, "num_env_steps_sampled": 208800, "num_env_steps_trained": 208800, "num_agent_steps_sampled": 208800, "num_agent_steps_trained": 208800}, "sampler_results": {"episode_reward_max": -25343.268552303653, "episode_reward_min": -26102.14806445665, "episode_reward_mean": -25764.409396284405, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-25760.32686276445, -25396.99210688679, -25382.538476417383, -25924.810189384803, -25861.887425342076, -25855.252276196476, -25551.072579589287, -25775.999586885166, -25861.110744025074, -25756.456716678895, -25617.208873794578, -25597.01947128544, -25343.268552303653, -25642.9789963566, -25862.808243320793, -25862.541120017588, -25623.5428424464, -25695.679217461256, -25606.17431892844, -25816.19716164555, -25863.72833337226, -25798.788931450992, -25862.58342297002, -25709.185831124872, -25656.533499356352, -25801.86329287919, -25735.077283550734, -25905.161415354407, -26030.385655259062, -25961.244413259574, -25587.178291603854, -25502.553854804308, -25517.177817737986, -26034.06097801261, -25759.87498809651, -25601.91871519938, -25873.138791514357, -25784.505422226386, -25879.253160646764, -25914.29571780409, -25489.40311961304, -25975.842909860385, -25974.699021005083, -25790.845880610497, -25869.96738063129, -25810.069398333406, -25953.65395615741, -25815.451167885232, -25819.739158543565, -26026.27184238485, -26083.733153869016, -25758.136060547233, -25967.78515157466, -25660.300063580053, -25705.08482519234, -26102.14806445665, -25797.349811932254, -25781.579667060716, -25868.398999251014, -25529.3090589514, -25807.03109847257, -25902.754923447952, -25639.988495218277, -25519.349602989754, -25619.05502207858, -25891.1413734565, -25871.921132023614, -25571.612840771653, -26033.929002990495, -25968.70702087451, -25753.59731625539, -25345.672421099924, -25734.096507738315, -25955.573889103773, -25811.43468690695, -25757.650316806128, -26102.10048345207, -25707.737809963204, -25498.861591433688, -25792.569799139757, -25891.087779099707, -25939.916820663995, -25759.14015205737, -25762.77959591386, -25704.311257363963, -25815.26912545352, -25700.99265257654, -25637.371647749467, -25585.901797595612, -25743.78194530946, -25730.88118511566, -25693.754176045648, -25698.066298154874, -25756.51197157061, -25905.5706532299, -25980.36756481758, -25393.582456681695, -25827.103134906156, -25646.06684443742, -25631.552966078983], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.427710921364817, "mean_inference_ms": 0.24827313456234051, "mean_action_processing_ms": 0.05903783776903354, "mean_env_wait_ms": 1.4649967801947963, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002792835235595703, "StateBufferConnector_ms": 0.002077341079711914, "ViewRequirementAgentConnector_ms": 0.052170753479003906}}, "episode_reward_max": -25343.268552303653, "episode_reward_min": -26102.14806445665, "episode_reward_mean": -25764.409396284405, "episode_len_mean": 360.0, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-25760.32686276445, -25396.99210688679, -25382.538476417383, -25924.810189384803, -25861.887425342076, -25855.252276196476, -25551.072579589287, -25775.999586885166, -25861.110744025074, -25756.456716678895, -25617.208873794578, -25597.01947128544, -25343.268552303653, -25642.9789963566, -25862.808243320793, -25862.541120017588, -25623.5428424464, -25695.679217461256, -25606.17431892844, -25816.19716164555, -25863.72833337226, -25798.788931450992, -25862.58342297002, -25709.185831124872, -25656.533499356352, -25801.86329287919, -25735.077283550734, -25905.161415354407, -26030.385655259062, -25961.244413259574, -25587.178291603854, -25502.553854804308, -25517.177817737986, -26034.06097801261, -25759.87498809651, -25601.91871519938, -25873.138791514357, -25784.505422226386, -25879.253160646764, -25914.29571780409, -25489.40311961304, -25975.842909860385, -25974.699021005083, -25790.845880610497, -25869.96738063129, -25810.069398333406, -25953.65395615741, -25815.451167885232, -25819.739158543565, -26026.27184238485, -26083.733153869016, -25758.136060547233, -25967.78515157466, -25660.300063580053, -25705.08482519234, -26102.14806445665, -25797.349811932254, -25781.579667060716, -25868.398999251014, -25529.3090589514, -25807.03109847257, -25902.754923447952, -25639.988495218277, -25519.349602989754, -25619.05502207858, -25891.1413734565, -25871.921132023614, -25571.612840771653, -26033.929002990495, -25968.70702087451, -25753.59731625539, -25345.672421099924, -25734.096507738315, -25955.573889103773, -25811.43468690695, -25757.650316806128, -26102.10048345207, -25707.737809963204, -25498.861591433688, -25792.569799139757, -25891.087779099707, -25939.916820663995, -25759.14015205737, -25762.77959591386, -25704.311257363963, -25815.26912545352, -25700.99265257654, -25637.371647749467, -25585.901797595612, -25743.78194530946, -25730.88118511566, -25693.754176045648, -25698.066298154874, -25756.51197157061, -25905.5706532299, -25980.36756481758, -25393.582456681695, -25827.103134906156, -25646.06684443742, -25631.552966078983], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.427710921364817, "mean_inference_ms": 0.24827313456234051, "mean_action_processing_ms": 0.05903783776903354, "mean_env_wait_ms": 1.4649967801947963, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002792835235595703, "StateBufferConnector_ms": 0.002077341079711914, "ViewRequirementAgentConnector_ms": 0.052170753479003906}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 208800, "num_agent_steps_trained": 208800, "num_env_steps_sampled": 208800, "num_env_steps_trained": 208800, "num_env_steps_sampled_this_iter": 1080, "num_env_steps_trained_this_iter": 1080, "num_env_steps_sampled_throughput_per_sec": 95.89767591292352, "num_env_steps_trained_throughput_per_sec": 95.89767591292352, "timesteps_total": 208800, "num_steps_trained_this_iter": 1080, "agent_timesteps_total": 208800, "timers": {"training_iteration_time_ms": 3764.024, "sample_time_ms": 3753.311, "load_time_ms": 0.297, "load_throughput": 1211740.181, "learn_time_ms": 9.668, "learn_throughput": 37235.262, "synch_weights_time_ms": 0.704}, "counters": {"num_env_steps_sampled": 208800, "num_env_steps_trained": 208800, "num_agent_steps_sampled": 208800, "num_agent_steps_trained": 208800}, "done": false, "episodes_total": 580, "training_iteration": 120, "trial_id": "f5e97_00000", "date": "2023-07-25_17-18-17", "timestamp": 1690294697, "time_this_iter_s": 11.26482605934143, "time_total_s": 1341.9304676055908, "pid": 71917, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[0, 0.003], [5400, 0.001], [10800, 0.00075], [16200, 0.0005], [21600, 0.00025], [27000, 0.0001], [32400, 7.5e-05], [37800, 5e-05], [43200, 2.5e-05], [48600, 1e-05], [54000, 7.5e-06], [59400, 5e-06], [64800, 2.5e-06], [70200, 1e-06], [75600, 5e-07], [81000, 1e-07]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x304530310>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1341.9304676055908, "iterations_since_restore": 120, "perf": {"cpu_util_percent": 23.48125, "ram_util_percent": 79.3}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-07, "entropy_coeff": 0.1, "policy_entropy": -926.6998046875, "policy_loss": -22992557237862.4, "vf_loss": 1111569024.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 2913.0, "diff_num_grad_updates_vs_sampler_policy": 2912.0}}, "num_env_steps_sampled": 209880, "num_env_steps_trained": 209880, "num_agent_steps_sampled": 209880, "num_agent_steps_trained": 209880}, "sampler_results": {"episode_reward_max": -25343.268552303653, "episode_reward_min": -26102.14806445665, "episode_reward_mean": -25771.216478130198, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-25924.810189384803, -25861.887425342076, -25855.252276196476, -25551.072579589287, -25775.999586885166, -25861.110744025074, -25756.456716678895, -25617.208873794578, -25597.01947128544, -25343.268552303653, -25642.9789963566, -25862.808243320793, -25862.541120017588, -25623.5428424464, -25695.679217461256, -25606.17431892844, -25816.19716164555, -25863.72833337226, -25798.788931450992, -25862.58342297002, -25709.185831124872, -25656.533499356352, -25801.86329287919, -25735.077283550734, -25905.161415354407, -26030.385655259062, -25961.244413259574, -25587.178291603854, -25502.553854804308, -25517.177817737986, -26034.06097801261, -25759.87498809651, -25601.91871519938, -25873.138791514357, -25784.505422226386, -25879.253160646764, -25914.29571780409, -25489.40311961304, -25975.842909860385, -25974.699021005083, -25790.845880610497, -25869.96738063129, -25810.069398333406, -25953.65395615741, -25815.451167885232, -25819.739158543565, -26026.27184238485, -26083.733153869016, -25758.136060547233, -25967.78515157466, -25660.300063580053, -25705.08482519234, -26102.14806445665, -25797.349811932254, -25781.579667060716, -25868.398999251014, -25529.3090589514, -25807.03109847257, -25902.754923447952, -25639.988495218277, -25519.349602989754, -25619.05502207858, -25891.1413734565, -25871.921132023614, -25571.612840771653, -26033.929002990495, -25968.70702087451, -25753.59731625539, -25345.672421099924, -25734.096507738315, -25955.573889103773, -25811.43468690695, -25757.650316806128, -26102.10048345207, -25707.737809963204, -25498.861591433688, -25792.569799139757, -25891.087779099707, -25939.916820663995, -25759.14015205737, -25762.77959591386, -25704.311257363963, -25815.26912545352, -25700.99265257654, -25637.371647749467, -25585.901797595612, -25743.78194530946, -25730.88118511566, -25693.754176045648, -25698.066298154874, -25756.51197157061, -25905.5706532299, -25980.36756481758, -25393.582456681695, -25827.103134906156, -25646.06684443742, -25631.552966078983, -25399.489287253382, -25958.460820273434, -25862.615523121418], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.432988460293748, "mean_inference_ms": 0.2485149827836893, "mean_action_processing_ms": 0.05909715839004379, "mean_env_wait_ms": 1.4666675708830905, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002835988998413086, "StateBufferConnector_ms": 0.0021076202392578125, "ViewRequirementAgentConnector_ms": 0.05289101600646973}}, "episode_reward_max": -25343.268552303653, "episode_reward_min": -26102.14806445665, "episode_reward_mean": -25771.216478130198, "episode_len_mean": 360.0, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-25924.810189384803, -25861.887425342076, -25855.252276196476, -25551.072579589287, -25775.999586885166, -25861.110744025074, -25756.456716678895, -25617.208873794578, -25597.01947128544, -25343.268552303653, -25642.9789963566, -25862.808243320793, -25862.541120017588, -25623.5428424464, -25695.679217461256, -25606.17431892844, -25816.19716164555, -25863.72833337226, -25798.788931450992, -25862.58342297002, -25709.185831124872, -25656.533499356352, -25801.86329287919, -25735.077283550734, -25905.161415354407, -26030.385655259062, -25961.244413259574, -25587.178291603854, -25502.553854804308, -25517.177817737986, -26034.06097801261, -25759.87498809651, -25601.91871519938, -25873.138791514357, -25784.505422226386, -25879.253160646764, -25914.29571780409, -25489.40311961304, -25975.842909860385, -25974.699021005083, -25790.845880610497, -25869.96738063129, -25810.069398333406, -25953.65395615741, -25815.451167885232, -25819.739158543565, -26026.27184238485, -26083.733153869016, -25758.136060547233, -25967.78515157466, -25660.300063580053, -25705.08482519234, -26102.14806445665, -25797.349811932254, -25781.579667060716, -25868.398999251014, -25529.3090589514, -25807.03109847257, -25902.754923447952, -25639.988495218277, -25519.349602989754, -25619.05502207858, -25891.1413734565, -25871.921132023614, -25571.612840771653, -26033.929002990495, -25968.70702087451, -25753.59731625539, -25345.672421099924, -25734.096507738315, -25955.573889103773, -25811.43468690695, -25757.650316806128, -26102.10048345207, -25707.737809963204, -25498.861591433688, -25792.569799139757, -25891.087779099707, -25939.916820663995, -25759.14015205737, -25762.77959591386, -25704.311257363963, -25815.26912545352, -25700.99265257654, -25637.371647749467, -25585.901797595612, -25743.78194530946, -25730.88118511566, -25693.754176045648, -25698.066298154874, -25756.51197157061, -25905.5706532299, -25980.36756481758, -25393.582456681695, -25827.103134906156, -25646.06684443742, -25631.552966078983, -25399.489287253382, -25958.460820273434, -25862.615523121418], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.432988460293748, "mean_inference_ms": 0.2485149827836893, "mean_action_processing_ms": 0.05909715839004379, "mean_env_wait_ms": 1.4666675708830905, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002835988998413086, "StateBufferConnector_ms": 0.0021076202392578125, "ViewRequirementAgentConnector_ms": 0.05289101600646973}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 209880, "num_agent_steps_trained": 209880, "num_env_steps_sampled": 209880, "num_env_steps_trained": 209880, "num_env_steps_sampled_this_iter": 1080, "num_env_steps_trained_this_iter": 1080, "num_env_steps_sampled_throughput_per_sec": 96.42636850947387, "num_env_steps_trained_throughput_per_sec": 96.42636850947387, "timesteps_total": 209880, "num_steps_trained_this_iter": 1080, "agent_timesteps_total": 209880, "timers": {"training_iteration_time_ms": 3765.682, "sample_time_ms": 3754.986, "load_time_ms": 0.299, "load_throughput": 1203146.964, "learn_time_ms": 9.657, "learn_throughput": 37279.02, "synch_weights_time_ms": 0.696}, "counters": {"num_env_steps_sampled": 209880, "num_env_steps_trained": 209880, "num_agent_steps_sampled": 209880, "num_agent_steps_trained": 209880}, "done": false, "episodes_total": 583, "training_iteration": 121, "trial_id": "f5e97_00000", "date": "2023-07-25_17-18-28", "timestamp": 1690294708, "time_this_iter_s": 11.203047037124634, "time_total_s": 1353.1335146427155, "pid": 71917, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[0, 0.003], [5400, 0.001], [10800, 0.00075], [16200, 0.0005], [21600, 0.00025], [27000, 0.0001], [32400, 7.5e-05], [37800, 5e-05], [43200, 2.5e-05], [48600, 1e-05], [54000, 7.5e-06], [59400, 5e-06], [64800, 2.5e-06], [70200, 1e-06], [75600, 5e-07], [81000, 1e-07]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x304530310>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1353.1335146427155, "iterations_since_restore": 121, "perf": {"cpu_util_percent": 25.0625, "ram_util_percent": 79.36875}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-07, "entropy_coeff": 0.1, "policy_entropy": -926.6999145507813, "policy_loss": -25516496859955.2, "vf_loss": 1082284550.4}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 2928.0, "diff_num_grad_updates_vs_sampler_policy": 2927.0}}, "num_env_steps_sampled": 210960, "num_env_steps_trained": 210960, "num_agent_steps_sampled": 210960, "num_agent_steps_trained": 210960}, "sampler_results": {"episode_reward_max": -25343.268552303653, "episode_reward_min": -26102.14806445665, "episode_reward_mean": -25763.879469773387, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-25551.072579589287, -25775.999586885166, -25861.110744025074, -25756.456716678895, -25617.208873794578, -25597.01947128544, -25343.268552303653, -25642.9789963566, -25862.808243320793, -25862.541120017588, -25623.5428424464, -25695.679217461256, -25606.17431892844, -25816.19716164555, -25863.72833337226, -25798.788931450992, -25862.58342297002, -25709.185831124872, -25656.533499356352, -25801.86329287919, -25735.077283550734, -25905.161415354407, -26030.385655259062, -25961.244413259574, -25587.178291603854, -25502.553854804308, -25517.177817737986, -26034.06097801261, -25759.87498809651, -25601.91871519938, -25873.138791514357, -25784.505422226386, -25879.253160646764, -25914.29571780409, -25489.40311961304, -25975.842909860385, -25974.699021005083, -25790.845880610497, -25869.96738063129, -25810.069398333406, -25953.65395615741, -25815.451167885232, -25819.739158543565, -26026.27184238485, -26083.733153869016, -25758.136060547233, -25967.78515157466, -25660.300063580053, -25705.08482519234, -26102.14806445665, -25797.349811932254, -25781.579667060716, -25868.398999251014, -25529.3090589514, -25807.03109847257, -25902.754923447952, -25639.988495218277, -25519.349602989754, -25619.05502207858, -25891.1413734565, -25871.921132023614, -25571.612840771653, -26033.929002990495, -25968.70702087451, -25753.59731625539, -25345.672421099924, -25734.096507738315, -25955.573889103773, -25811.43468690695, -25757.650316806128, -26102.10048345207, -25707.737809963204, -25498.861591433688, -25792.569799139757, -25891.087779099707, -25939.916820663995, -25759.14015205737, -25762.77959591386, -25704.311257363963, -25815.26912545352, -25700.99265257654, -25637.371647749467, -25585.901797595612, -25743.78194530946, -25730.88118511566, -25693.754176045648, -25698.066298154874, -25756.51197157061, -25905.5706532299, -25980.36756481758, -25393.582456681695, -25827.103134906156, -25646.06684443742, -25631.552966078983, -25399.489287253382, -25958.460820273434, -25862.615523121418, -25784.877557646454, -25520.706181154666, -25602.665316442188], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.43870812102303, "mean_inference_ms": 0.24877710343016823, "mean_action_processing_ms": 0.05916156035394757, "mean_env_wait_ms": 1.4684824993388197, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002866029739379883, "StateBufferConnector_ms": 0.0021288394927978516, "ViewRequirementAgentConnector_ms": 0.05351114273071289}}, "episode_reward_max": -25343.268552303653, "episode_reward_min": -26102.14806445665, "episode_reward_mean": -25763.879469773387, "episode_len_mean": 360.0, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-25551.072579589287, -25775.999586885166, -25861.110744025074, -25756.456716678895, -25617.208873794578, -25597.01947128544, -25343.268552303653, -25642.9789963566, -25862.808243320793, -25862.541120017588, -25623.5428424464, -25695.679217461256, -25606.17431892844, -25816.19716164555, -25863.72833337226, -25798.788931450992, -25862.58342297002, -25709.185831124872, -25656.533499356352, -25801.86329287919, -25735.077283550734, -25905.161415354407, -26030.385655259062, -25961.244413259574, -25587.178291603854, -25502.553854804308, -25517.177817737986, -26034.06097801261, -25759.87498809651, -25601.91871519938, -25873.138791514357, -25784.505422226386, -25879.253160646764, -25914.29571780409, -25489.40311961304, -25975.842909860385, -25974.699021005083, -25790.845880610497, -25869.96738063129, -25810.069398333406, -25953.65395615741, -25815.451167885232, -25819.739158543565, -26026.27184238485, -26083.733153869016, -25758.136060547233, -25967.78515157466, -25660.300063580053, -25705.08482519234, -26102.14806445665, -25797.349811932254, -25781.579667060716, -25868.398999251014, -25529.3090589514, -25807.03109847257, -25902.754923447952, -25639.988495218277, -25519.349602989754, -25619.05502207858, -25891.1413734565, -25871.921132023614, -25571.612840771653, -26033.929002990495, -25968.70702087451, -25753.59731625539, -25345.672421099924, -25734.096507738315, -25955.573889103773, -25811.43468690695, -25757.650316806128, -26102.10048345207, -25707.737809963204, -25498.861591433688, -25792.569799139757, -25891.087779099707, -25939.916820663995, -25759.14015205737, -25762.77959591386, -25704.311257363963, -25815.26912545352, -25700.99265257654, -25637.371647749467, -25585.901797595612, -25743.78194530946, -25730.88118511566, -25693.754176045648, -25698.066298154874, -25756.51197157061, -25905.5706532299, -25980.36756481758, -25393.582456681695, -25827.103134906156, -25646.06684443742, -25631.552966078983, -25399.489287253382, -25958.460820273434, -25862.615523121418, -25784.877557646454, -25520.706181154666, -25602.665316442188], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.43870812102303, "mean_inference_ms": 0.24877710343016823, "mean_action_processing_ms": 0.05916156035394757, "mean_env_wait_ms": 1.4684824993388197, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002866029739379883, "StateBufferConnector_ms": 0.0021288394927978516, "ViewRequirementAgentConnector_ms": 0.05351114273071289}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 210960, "num_agent_steps_trained": 210960, "num_env_steps_sampled": 210960, "num_env_steps_trained": 210960, "num_env_steps_sampled_this_iter": 1080, "num_env_steps_trained_this_iter": 1080, "num_env_steps_sampled_throughput_per_sec": 95.94381545366466, "num_env_steps_trained_throughput_per_sec": 95.94381545366466, "timesteps_total": 210960, "num_steps_trained_this_iter": 1080, "agent_timesteps_total": 210960, "timers": {"training_iteration_time_ms": 3750.347, "sample_time_ms": 3739.632, "load_time_ms": 0.299, "load_throughput": 1203818.417, "learn_time_ms": 9.674, "learn_throughput": 37214.155, "synch_weights_time_ms": 0.698}, "counters": {"num_env_steps_sampled": 210960, "num_env_steps_trained": 210960, "num_agent_steps_sampled": 210960, "num_agent_steps_trained": 210960}, "done": false, "episodes_total": 586, "training_iteration": 122, "trial_id": "f5e97_00000", "date": "2023-07-25_17-18-39", "timestamp": 1690294719, "time_this_iter_s": 11.259338855743408, "time_total_s": 1364.3928534984589, "pid": 71917, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[0, 0.003], [5400, 0.001], [10800, 0.00075], [16200, 0.0005], [21600, 0.00025], [27000, 0.0001], [32400, 7.5e-05], [37800, 5e-05], [43200, 2.5e-05], [48600, 1e-05], [54000, 7.5e-06], [59400, 5e-06], [64800, 2.5e-06], [70200, 1e-06], [75600, 5e-07], [81000, 1e-07]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x304530310>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1364.3928534984589, "iterations_since_restore": 122, "perf": {"cpu_util_percent": 25.6625, "ram_util_percent": 79.21875}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-07, "entropy_coeff": 0.1, "policy_entropy": -926.6996826171875, "policy_loss": -14815953243340.8, "vf_loss": 1124158700.8}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 2943.0, "diff_num_grad_updates_vs_sampler_policy": 2942.0}}, "num_env_steps_sampled": 212040, "num_env_steps_trained": 212040, "num_agent_steps_sampled": 212040, "num_agent_steps_trained": 212040}, "sampler_results": {"episode_reward_max": -25343.268552303653, "episode_reward_min": -26102.14806445665, "episode_reward_mean": -25767.91078508289, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-25756.456716678895, -25617.208873794578, -25597.01947128544, -25343.268552303653, -25642.9789963566, -25862.808243320793, -25862.541120017588, -25623.5428424464, -25695.679217461256, -25606.17431892844, -25816.19716164555, -25863.72833337226, -25798.788931450992, -25862.58342297002, -25709.185831124872, -25656.533499356352, -25801.86329287919, -25735.077283550734, -25905.161415354407, -26030.385655259062, -25961.244413259574, -25587.178291603854, -25502.553854804308, -25517.177817737986, -26034.06097801261, -25759.87498809651, -25601.91871519938, -25873.138791514357, -25784.505422226386, -25879.253160646764, -25914.29571780409, -25489.40311961304, -25975.842909860385, -25974.699021005083, -25790.845880610497, -25869.96738063129, -25810.069398333406, -25953.65395615741, -25815.451167885232, -25819.739158543565, -26026.27184238485, -26083.733153869016, -25758.136060547233, -25967.78515157466, -25660.300063580053, -25705.08482519234, -26102.14806445665, -25797.349811932254, -25781.579667060716, -25868.398999251014, -25529.3090589514, -25807.03109847257, -25902.754923447952, -25639.988495218277, -25519.349602989754, -25619.05502207858, -25891.1413734565, -25871.921132023614, -25571.612840771653, -26033.929002990495, -25968.70702087451, -25753.59731625539, -25345.672421099924, -25734.096507738315, -25955.573889103773, -25811.43468690695, -25757.650316806128, -26102.10048345207, -25707.737809963204, -25498.861591433688, -25792.569799139757, -25891.087779099707, -25939.916820663995, -25759.14015205737, -25762.77959591386, -25704.311257363963, -25815.26912545352, -25700.99265257654, -25637.371647749467, -25585.901797595612, -25743.78194530946, -25730.88118511566, -25693.754176045648, -25698.066298154874, -25756.51197157061, -25905.5706532299, -25980.36756481758, -25393.582456681695, -25827.103134906156, -25646.06684443742, -25631.552966078983, -25399.489287253382, -25958.460820273434, -25862.615523121418, -25784.877557646454, -25520.706181154666, -25602.665316442188, -25778.991024729174, -25844.319635697706, -25968.00378102244], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.444857600753906, "mean_inference_ms": 0.24905832786682364, "mean_action_processing_ms": 0.059230836246284044, "mean_env_wait_ms": 1.4704273113520783, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0029053688049316406, "StateBufferConnector_ms": 0.0021593570709228516, "ViewRequirementAgentConnector_ms": 0.05419468879699707}}, "episode_reward_max": -25343.268552303653, "episode_reward_min": -26102.14806445665, "episode_reward_mean": -25767.91078508289, "episode_len_mean": 360.0, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-25756.456716678895, -25617.208873794578, -25597.01947128544, -25343.268552303653, -25642.9789963566, -25862.808243320793, -25862.541120017588, -25623.5428424464, -25695.679217461256, -25606.17431892844, -25816.19716164555, -25863.72833337226, -25798.788931450992, -25862.58342297002, -25709.185831124872, -25656.533499356352, -25801.86329287919, -25735.077283550734, -25905.161415354407, -26030.385655259062, -25961.244413259574, -25587.178291603854, -25502.553854804308, -25517.177817737986, -26034.06097801261, -25759.87498809651, -25601.91871519938, -25873.138791514357, -25784.505422226386, -25879.253160646764, -25914.29571780409, -25489.40311961304, -25975.842909860385, -25974.699021005083, -25790.845880610497, -25869.96738063129, -25810.069398333406, -25953.65395615741, -25815.451167885232, -25819.739158543565, -26026.27184238485, -26083.733153869016, -25758.136060547233, -25967.78515157466, -25660.300063580053, -25705.08482519234, -26102.14806445665, -25797.349811932254, -25781.579667060716, -25868.398999251014, -25529.3090589514, -25807.03109847257, -25902.754923447952, -25639.988495218277, -25519.349602989754, -25619.05502207858, -25891.1413734565, -25871.921132023614, -25571.612840771653, -26033.929002990495, -25968.70702087451, -25753.59731625539, -25345.672421099924, -25734.096507738315, -25955.573889103773, -25811.43468690695, -25757.650316806128, -26102.10048345207, -25707.737809963204, -25498.861591433688, -25792.569799139757, -25891.087779099707, -25939.916820663995, -25759.14015205737, -25762.77959591386, -25704.311257363963, -25815.26912545352, -25700.99265257654, -25637.371647749467, -25585.901797595612, -25743.78194530946, -25730.88118511566, -25693.754176045648, -25698.066298154874, -25756.51197157061, -25905.5706532299, -25980.36756481758, -25393.582456681695, -25827.103134906156, -25646.06684443742, -25631.552966078983, -25399.489287253382, -25958.460820273434, -25862.615523121418, -25784.877557646454, -25520.706181154666, -25602.665316442188, -25778.991024729174, -25844.319635697706, -25968.00378102244], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.444857600753906, "mean_inference_ms": 0.24905832786682364, "mean_action_processing_ms": 0.059230836246284044, "mean_env_wait_ms": 1.4704273113520783, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0029053688049316406, "StateBufferConnector_ms": 0.0021593570709228516, "ViewRequirementAgentConnector_ms": 0.05419468879699707}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 212040, "num_agent_steps_trained": 212040, "num_env_steps_sampled": 212040, "num_env_steps_trained": 212040, "num_env_steps_sampled_this_iter": 1080, "num_env_steps_trained_this_iter": 1080, "num_env_steps_sampled_throughput_per_sec": 97.15485498959325, "num_env_steps_trained_throughput_per_sec": 97.15485498959325, "timesteps_total": 212040, "num_steps_trained_this_iter": 1080, "agent_timesteps_total": 212040, "timers": {"training_iteration_time_ms": 3738.172, "sample_time_ms": 3727.342, "load_time_ms": 0.301, "load_throughput": 1197232.35, "learn_time_ms": 9.759, "learn_throughput": 36888.316, "synch_weights_time_ms": 0.726}, "counters": {"num_env_steps_sampled": 212040, "num_env_steps_trained": 212040, "num_agent_steps_sampled": 212040, "num_agent_steps_trained": 212040}, "done": false, "episodes_total": 589, "training_iteration": 123, "trial_id": "f5e97_00000", "date": "2023-07-25_17-18-51", "timestamp": 1690294731, "time_this_iter_s": 11.119284868240356, "time_total_s": 1375.5121383666992, "pid": 71917, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[0, 0.003], [5400, 0.001], [10800, 0.00075], [16200, 0.0005], [21600, 0.00025], [27000, 0.0001], [32400, 7.5e-05], [37800, 5e-05], [43200, 2.5e-05], [48600, 1e-05], [54000, 7.5e-06], [59400, 5e-06], [64800, 2.5e-06], [70200, 1e-06], [75600, 5e-07], [81000, 1e-07]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x304530310>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1375.5121383666992, "iterations_since_restore": 123, "perf": {"cpu_util_percent": 24.95625, "ram_util_percent": 78.43125}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-07, "entropy_coeff": 0.1, "policy_entropy": -926.6999267578125, "policy_loss": -11659402977280.0, "vf_loss": 1105955584.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 2958.0, "diff_num_grad_updates_vs_sampler_policy": 2957.0}}, "num_env_steps_sampled": 213120, "num_env_steps_trained": 213120, "num_agent_steps_sampled": 213120, "num_agent_steps_trained": 213120}, "sampler_results": {"episode_reward_max": -25343.268552303653, "episode_reward_min": -26105.435092812302, "episode_reward_mean": -25772.455007921293, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-25343.268552303653, -25642.9789963566, -25862.808243320793, -25862.541120017588, -25623.5428424464, -25695.679217461256, -25606.17431892844, -25816.19716164555, -25863.72833337226, -25798.788931450992, -25862.58342297002, -25709.185831124872, -25656.533499356352, -25801.86329287919, -25735.077283550734, -25905.161415354407, -26030.385655259062, -25961.244413259574, -25587.178291603854, -25502.553854804308, -25517.177817737986, -26034.06097801261, -25759.87498809651, -25601.91871519938, -25873.138791514357, -25784.505422226386, -25879.253160646764, -25914.29571780409, -25489.40311961304, -25975.842909860385, -25974.699021005083, -25790.845880610497, -25869.96738063129, -25810.069398333406, -25953.65395615741, -25815.451167885232, -25819.739158543565, -26026.27184238485, -26083.733153869016, -25758.136060547233, -25967.78515157466, -25660.300063580053, -25705.08482519234, -26102.14806445665, -25797.349811932254, -25781.579667060716, -25868.398999251014, -25529.3090589514, -25807.03109847257, -25902.754923447952, -25639.988495218277, -25519.349602989754, -25619.05502207858, -25891.1413734565, -25871.921132023614, -25571.612840771653, -26033.929002990495, -25968.70702087451, -25753.59731625539, -25345.672421099924, -25734.096507738315, -25955.573889103773, -25811.43468690695, -25757.650316806128, -26102.10048345207, -25707.737809963204, -25498.861591433688, -25792.569799139757, -25891.087779099707, -25939.916820663995, -25759.14015205737, -25762.77959591386, -25704.311257363963, -25815.26912545352, -25700.99265257654, -25637.371647749467, -25585.901797595612, -25743.78194530946, -25730.88118511566, -25693.754176045648, -25698.066298154874, -25756.51197157061, -25905.5706532299, -25980.36756481758, -25393.582456681695, -25827.103134906156, -25646.06684443742, -25631.552966078983, -25399.489287253382, -25958.460820273434, -25862.615523121418, -25784.877557646454, -25520.706181154666, -25602.665316442188, -25778.991024729174, -25844.319635697706, -25968.00378102244, -25599.63654565638, -26105.435092812302, -25720.035707131035], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.451448954188761, "mean_inference_ms": 0.24935843328926072, "mean_action_processing_ms": 0.05930489194255057, "mean_env_wait_ms": 1.4725187979699774, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0029408931732177734, "StateBufferConnector_ms": 0.002180337905883789, "ViewRequirementAgentConnector_ms": 0.05486774444580078}}, "episode_reward_max": -25343.268552303653, "episode_reward_min": -26105.435092812302, "episode_reward_mean": -25772.455007921293, "episode_len_mean": 360.0, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-25343.268552303653, -25642.9789963566, -25862.808243320793, -25862.541120017588, -25623.5428424464, -25695.679217461256, -25606.17431892844, -25816.19716164555, -25863.72833337226, -25798.788931450992, -25862.58342297002, -25709.185831124872, -25656.533499356352, -25801.86329287919, -25735.077283550734, -25905.161415354407, -26030.385655259062, -25961.244413259574, -25587.178291603854, -25502.553854804308, -25517.177817737986, -26034.06097801261, -25759.87498809651, -25601.91871519938, -25873.138791514357, -25784.505422226386, -25879.253160646764, -25914.29571780409, -25489.40311961304, -25975.842909860385, -25974.699021005083, -25790.845880610497, -25869.96738063129, -25810.069398333406, -25953.65395615741, -25815.451167885232, -25819.739158543565, -26026.27184238485, -26083.733153869016, -25758.136060547233, -25967.78515157466, -25660.300063580053, -25705.08482519234, -26102.14806445665, -25797.349811932254, -25781.579667060716, -25868.398999251014, -25529.3090589514, -25807.03109847257, -25902.754923447952, -25639.988495218277, -25519.349602989754, -25619.05502207858, -25891.1413734565, -25871.921132023614, -25571.612840771653, -26033.929002990495, -25968.70702087451, -25753.59731625539, -25345.672421099924, -25734.096507738315, -25955.573889103773, -25811.43468690695, -25757.650316806128, -26102.10048345207, -25707.737809963204, -25498.861591433688, -25792.569799139757, -25891.087779099707, -25939.916820663995, -25759.14015205737, -25762.77959591386, -25704.311257363963, -25815.26912545352, -25700.99265257654, -25637.371647749467, -25585.901797595612, -25743.78194530946, -25730.88118511566, -25693.754176045648, -25698.066298154874, -25756.51197157061, -25905.5706532299, -25980.36756481758, -25393.582456681695, -25827.103134906156, -25646.06684443742, -25631.552966078983, -25399.489287253382, -25958.460820273434, -25862.615523121418, -25784.877557646454, -25520.706181154666, -25602.665316442188, -25778.991024729174, -25844.319635697706, -25968.00378102244, -25599.63654565638, -26105.435092812302, -25720.035707131035], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.451448954188761, "mean_inference_ms": 0.24935843328926072, "mean_action_processing_ms": 0.05930489194255057, "mean_env_wait_ms": 1.4725187979699774, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0029408931732177734, "StateBufferConnector_ms": 0.002180337905883789, "ViewRequirementAgentConnector_ms": 0.05486774444580078}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 213120, "num_agent_steps_trained": 213120, "num_env_steps_sampled": 213120, "num_env_steps_trained": 213120, "num_env_steps_sampled_this_iter": 1080, "num_env_steps_trained_this_iter": 1080, "num_env_steps_sampled_throughput_per_sec": 95.61541205722857, "num_env_steps_trained_throughput_per_sec": 95.61541205722857, "timesteps_total": 213120, "num_steps_trained_this_iter": 1080, "agent_timesteps_total": 213120, "timers": {"training_iteration_time_ms": 3747.094, "sample_time_ms": 3736.235, "load_time_ms": 0.299, "load_throughput": 1202667.814, "learn_time_ms": 9.794, "learn_throughput": 36757.21, "synch_weights_time_ms": 0.721}, "counters": {"num_env_steps_sampled": 213120, "num_env_steps_trained": 213120, "num_agent_steps_sampled": 213120, "num_agent_steps_trained": 213120}, "done": false, "episodes_total": 592, "training_iteration": 124, "trial_id": "f5e97_00000", "date": "2023-07-25_17-19-02", "timestamp": 1690294742, "time_this_iter_s": 11.298189163208008, "time_total_s": 1386.8103275299072, "pid": 71917, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[0, 0.003], [5400, 0.001], [10800, 0.00075], [16200, 0.0005], [21600, 0.00025], [27000, 0.0001], [32400, 7.5e-05], [37800, 5e-05], [43200, 2.5e-05], [48600, 1e-05], [54000, 7.5e-06], [59400, 5e-06], [64800, 2.5e-06], [70200, 1e-06], [75600, 5e-07], [81000, 1e-07]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x304530310>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1386.8103275299072, "iterations_since_restore": 124, "perf": {"cpu_util_percent": 23.88125, "ram_util_percent": 78.88749999999999}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-07, "entropy_coeff": 0.1, "policy_entropy": -926.6999755859375, "policy_loss": -21610753477836.8, "vf_loss": 1085909452.8}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 2973.0, "diff_num_grad_updates_vs_sampler_policy": 2972.0}}, "num_env_steps_sampled": 214200, "num_env_steps_trained": 214200, "num_agent_steps_sampled": 214200, "num_agent_steps_trained": 214200}, "sampler_results": {"episode_reward_max": -25345.672421099924, "episode_reward_min": -26105.435092812302, "episode_reward_mean": -25776.606059182763, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-25862.541120017588, -25623.5428424464, -25695.679217461256, -25606.17431892844, -25816.19716164555, -25863.72833337226, -25798.788931450992, -25862.58342297002, -25709.185831124872, -25656.533499356352, -25801.86329287919, -25735.077283550734, -25905.161415354407, -26030.385655259062, -25961.244413259574, -25587.178291603854, -25502.553854804308, -25517.177817737986, -26034.06097801261, -25759.87498809651, -25601.91871519938, -25873.138791514357, -25784.505422226386, -25879.253160646764, -25914.29571780409, -25489.40311961304, -25975.842909860385, -25974.699021005083, -25790.845880610497, -25869.96738063129, -25810.069398333406, -25953.65395615741, -25815.451167885232, -25819.739158543565, -26026.27184238485, -26083.733153869016, -25758.136060547233, -25967.78515157466, -25660.300063580053, -25705.08482519234, -26102.14806445665, -25797.349811932254, -25781.579667060716, -25868.398999251014, -25529.3090589514, -25807.03109847257, -25902.754923447952, -25639.988495218277, -25519.349602989754, -25619.05502207858, -25891.1413734565, -25871.921132023614, -25571.612840771653, -26033.929002990495, -25968.70702087451, -25753.59731625539, -25345.672421099924, -25734.096507738315, -25955.573889103773, -25811.43468690695, -25757.650316806128, -26102.10048345207, -25707.737809963204, -25498.861591433688, -25792.569799139757, -25891.087779099707, -25939.916820663995, -25759.14015205737, -25762.77959591386, -25704.311257363963, -25815.26912545352, -25700.99265257654, -25637.371647749467, -25585.901797595612, -25743.78194530946, -25730.88118511566, -25693.754176045648, -25698.066298154874, -25756.51197157061, -25905.5706532299, -25980.36756481758, -25393.582456681695, -25827.103134906156, -25646.06684443742, -25631.552966078983, -25399.489287253382, -25958.460820273434, -25862.615523121418, -25784.877557646454, -25520.706181154666, -25602.665316442188, -25778.991024729174, -25844.319635697706, -25968.00378102244, -25599.63654565638, -26105.435092812302, -25720.035707131035, -25847.888622810693, -25737.30769667045, -25678.96459864703], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.458511907244042, "mean_inference_ms": 0.24967870252788824, "mean_action_processing_ms": 0.05938391035000384, "mean_env_wait_ms": 1.4747510721668982, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0029904842376708984, "StateBufferConnector_ms": 0.002215147018432617, "ViewRequirementAgentConnector_ms": 0.05582594871520996}}, "episode_reward_max": -25345.672421099924, "episode_reward_min": -26105.435092812302, "episode_reward_mean": -25776.606059182763, "episode_len_mean": 360.0, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-25862.541120017588, -25623.5428424464, -25695.679217461256, -25606.17431892844, -25816.19716164555, -25863.72833337226, -25798.788931450992, -25862.58342297002, -25709.185831124872, -25656.533499356352, -25801.86329287919, -25735.077283550734, -25905.161415354407, -26030.385655259062, -25961.244413259574, -25587.178291603854, -25502.553854804308, -25517.177817737986, -26034.06097801261, -25759.87498809651, -25601.91871519938, -25873.138791514357, -25784.505422226386, -25879.253160646764, -25914.29571780409, -25489.40311961304, -25975.842909860385, -25974.699021005083, -25790.845880610497, -25869.96738063129, -25810.069398333406, -25953.65395615741, -25815.451167885232, -25819.739158543565, -26026.27184238485, -26083.733153869016, -25758.136060547233, -25967.78515157466, -25660.300063580053, -25705.08482519234, -26102.14806445665, -25797.349811932254, -25781.579667060716, -25868.398999251014, -25529.3090589514, -25807.03109847257, -25902.754923447952, -25639.988495218277, -25519.349602989754, -25619.05502207858, -25891.1413734565, -25871.921132023614, -25571.612840771653, -26033.929002990495, -25968.70702087451, -25753.59731625539, -25345.672421099924, -25734.096507738315, -25955.573889103773, -25811.43468690695, -25757.650316806128, -26102.10048345207, -25707.737809963204, -25498.861591433688, -25792.569799139757, -25891.087779099707, -25939.916820663995, -25759.14015205737, -25762.77959591386, -25704.311257363963, -25815.26912545352, -25700.99265257654, -25637.371647749467, -25585.901797595612, -25743.78194530946, -25730.88118511566, -25693.754176045648, -25698.066298154874, -25756.51197157061, -25905.5706532299, -25980.36756481758, -25393.582456681695, -25827.103134906156, -25646.06684443742, -25631.552966078983, -25399.489287253382, -25958.460820273434, -25862.615523121418, -25784.877557646454, -25520.706181154666, -25602.665316442188, -25778.991024729174, -25844.319635697706, -25968.00378102244, -25599.63654565638, -26105.435092812302, -25720.035707131035, -25847.888622810693, -25737.30769667045, -25678.96459864703], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.458511907244042, "mean_inference_ms": 0.24967870252788824, "mean_action_processing_ms": 0.05938391035000384, "mean_env_wait_ms": 1.4747510721668982, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0029904842376708984, "StateBufferConnector_ms": 0.002215147018432617, "ViewRequirementAgentConnector_ms": 0.05582594871520996}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 214200, "num_agent_steps_trained": 214200, "num_env_steps_sampled": 214200, "num_env_steps_trained": 214200, "num_env_steps_sampled_this_iter": 1080, "num_env_steps_trained_this_iter": 1080, "num_env_steps_sampled_throughput_per_sec": 93.27780406895111, "num_env_steps_trained_throughput_per_sec": 93.27780406895111, "timesteps_total": 214200, "num_steps_trained_this_iter": 1080, "agent_timesteps_total": 214200, "timers": {"training_iteration_time_ms": 3768.032, "sample_time_ms": 3757.169, "load_time_ms": 0.308, "load_throughput": 1167516.771, "learn_time_ms": 9.789, "learn_throughput": 36776.817, "synch_weights_time_ms": 0.721}, "counters": {"num_env_steps_sampled": 214200, "num_env_steps_trained": 214200, "num_agent_steps_sampled": 214200, "num_agent_steps_trained": 214200}, "done": false, "episodes_total": 595, "training_iteration": 125, "trial_id": "f5e97_00000", "date": "2023-07-25_17-19-14", "timestamp": 1690294754, "time_this_iter_s": 11.581082105636597, "time_total_s": 1398.3914096355438, "pid": 71917, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[0, 0.003], [5400, 0.001], [10800, 0.00075], [16200, 0.0005], [21600, 0.00025], [27000, 0.0001], [32400, 7.5e-05], [37800, 5e-05], [43200, 2.5e-05], [48600, 1e-05], [54000, 7.5e-06], [59400, 5e-06], [64800, 2.5e-06], [70200, 1e-06], [75600, 5e-07], [81000, 1e-07]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x304530310>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1398.3914096355438, "iterations_since_restore": 125, "perf": {"cpu_util_percent": 30.631249999999998, "ram_util_percent": 80.0625}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-07, "entropy_coeff": 0.1, "policy_entropy": -926.6997924804688, "policy_loss": -20020077559808.0, "vf_loss": 1100115001.6}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 2988.0, "diff_num_grad_updates_vs_sampler_policy": 2987.0}}, "num_env_steps_sampled": 215280, "num_env_steps_trained": 215280, "num_agent_steps_sampled": 215280, "num_agent_steps_trained": 215280}, "sampler_results": {"episode_reward_max": -25345.672421099924, "episode_reward_min": -26105.435092812302, "episode_reward_mean": -25779.522720452715, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-25606.17431892844, -25816.19716164555, -25863.72833337226, -25798.788931450992, -25862.58342297002, -25709.185831124872, -25656.533499356352, -25801.86329287919, -25735.077283550734, -25905.161415354407, -26030.385655259062, -25961.244413259574, -25587.178291603854, -25502.553854804308, -25517.177817737986, -26034.06097801261, -25759.87498809651, -25601.91871519938, -25873.138791514357, -25784.505422226386, -25879.253160646764, -25914.29571780409, -25489.40311961304, -25975.842909860385, -25974.699021005083, -25790.845880610497, -25869.96738063129, -25810.069398333406, -25953.65395615741, -25815.451167885232, -25819.739158543565, -26026.27184238485, -26083.733153869016, -25758.136060547233, -25967.78515157466, -25660.300063580053, -25705.08482519234, -26102.14806445665, -25797.349811932254, -25781.579667060716, -25868.398999251014, -25529.3090589514, -25807.03109847257, -25902.754923447952, -25639.988495218277, -25519.349602989754, -25619.05502207858, -25891.1413734565, -25871.921132023614, -25571.612840771653, -26033.929002990495, -25968.70702087451, -25753.59731625539, -25345.672421099924, -25734.096507738315, -25955.573889103773, -25811.43468690695, -25757.650316806128, -26102.10048345207, -25707.737809963204, -25498.861591433688, -25792.569799139757, -25891.087779099707, -25939.916820663995, -25759.14015205737, -25762.77959591386, -25704.311257363963, -25815.26912545352, -25700.99265257654, -25637.371647749467, -25585.901797595612, -25743.78194530946, -25730.88118511566, -25693.754176045648, -25698.066298154874, -25756.51197157061, -25905.5706532299, -25980.36756481758, -25393.582456681695, -25827.103134906156, -25646.06684443742, -25631.552966078983, -25399.489287253382, -25958.460820273434, -25862.615523121418, -25784.877557646454, -25520.706181154666, -25602.665316442188, -25778.991024729174, -25844.319635697706, -25968.00378102244, -25599.63654565638, -26105.435092812302, -25720.035707131035, -25847.888622810693, -25737.30769667045, -25678.96459864703, -25730.000865931677, -25944.927787284018, -25798.500653704446], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.4660145942836955, "mean_inference_ms": 0.25002586514025665, "mean_action_processing_ms": 0.05946897983370519, "mean_env_wait_ms": 1.4771222934281698, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0030257701873779297, "StateBufferConnector_ms": 0.0022504329681396484, "ViewRequirementAgentConnector_ms": 0.0565638542175293}}, "episode_reward_max": -25345.672421099924, "episode_reward_min": -26105.435092812302, "episode_reward_mean": -25779.522720452715, "episode_len_mean": 360.0, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-25606.17431892844, -25816.19716164555, -25863.72833337226, -25798.788931450992, -25862.58342297002, -25709.185831124872, -25656.533499356352, -25801.86329287919, -25735.077283550734, -25905.161415354407, -26030.385655259062, -25961.244413259574, -25587.178291603854, -25502.553854804308, -25517.177817737986, -26034.06097801261, -25759.87498809651, -25601.91871519938, -25873.138791514357, -25784.505422226386, -25879.253160646764, -25914.29571780409, -25489.40311961304, -25975.842909860385, -25974.699021005083, -25790.845880610497, -25869.96738063129, -25810.069398333406, -25953.65395615741, -25815.451167885232, -25819.739158543565, -26026.27184238485, -26083.733153869016, -25758.136060547233, -25967.78515157466, -25660.300063580053, -25705.08482519234, -26102.14806445665, -25797.349811932254, -25781.579667060716, -25868.398999251014, -25529.3090589514, -25807.03109847257, -25902.754923447952, -25639.988495218277, -25519.349602989754, -25619.05502207858, -25891.1413734565, -25871.921132023614, -25571.612840771653, -26033.929002990495, -25968.70702087451, -25753.59731625539, -25345.672421099924, -25734.096507738315, -25955.573889103773, -25811.43468690695, -25757.650316806128, -26102.10048345207, -25707.737809963204, -25498.861591433688, -25792.569799139757, -25891.087779099707, -25939.916820663995, -25759.14015205737, -25762.77959591386, -25704.311257363963, -25815.26912545352, -25700.99265257654, -25637.371647749467, -25585.901797595612, -25743.78194530946, -25730.88118511566, -25693.754176045648, -25698.066298154874, -25756.51197157061, -25905.5706532299, -25980.36756481758, -25393.582456681695, -25827.103134906156, -25646.06684443742, -25631.552966078983, -25399.489287253382, -25958.460820273434, -25862.615523121418, -25784.877557646454, -25520.706181154666, -25602.665316442188, -25778.991024729174, -25844.319635697706, -25968.00378102244, -25599.63654565638, -26105.435092812302, -25720.035707131035, -25847.888622810693, -25737.30769667045, -25678.96459864703, -25730.000865931677, -25944.927787284018, -25798.500653704446], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.4660145942836955, "mean_inference_ms": 0.25002586514025665, "mean_action_processing_ms": 0.05946897983370519, "mean_env_wait_ms": 1.4771222934281698, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0030257701873779297, "StateBufferConnector_ms": 0.0022504329681396484, "ViewRequirementAgentConnector_ms": 0.0565638542175293}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 215280, "num_agent_steps_trained": 215280, "num_env_steps_sampled": 215280, "num_env_steps_trained": 215280, "num_env_steps_sampled_this_iter": 1080, "num_env_steps_trained_this_iter": 1080, "num_env_steps_sampled_throughput_per_sec": 94.47840179572539, "num_env_steps_trained_throughput_per_sec": 94.47840179572539, "timesteps_total": 215280, "num_steps_trained_this_iter": 1080, "agent_timesteps_total": 215280, "timers": {"training_iteration_time_ms": 3784.292, "sample_time_ms": 3772.802, "load_time_ms": 0.355, "load_throughput": 1012980.974, "learn_time_ms": 10.186, "learn_throughput": 35342.859, "synch_weights_time_ms": 0.871}, "counters": {"num_env_steps_sampled": 215280, "num_env_steps_trained": 215280, "num_agent_steps_sampled": 215280, "num_agent_steps_trained": 215280}, "done": false, "episodes_total": 598, "training_iteration": 126, "trial_id": "f5e97_00000", "date": "2023-07-25_17-19-25", "timestamp": 1690294765, "time_this_iter_s": 11.434343814849854, "time_total_s": 1409.8257534503937, "pid": 71917, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[0, 0.003], [5400, 0.001], [10800, 0.00075], [16200, 0.0005], [21600, 0.00025], [27000, 0.0001], [32400, 7.5e-05], [37800, 5e-05], [43200, 2.5e-05], [48600, 1e-05], [54000, 7.5e-06], [59400, 5e-06], [64800, 2.5e-06], [70200, 1e-06], [75600, 5e-07], [81000, 1e-07]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x304530310>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1409.8257534503937, "iterations_since_restore": 126, "perf": {"cpu_util_percent": 30.1375, "ram_util_percent": 80.4625}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-07, "entropy_coeff": 0.1, "policy_entropy": -926.6998657226562, "policy_loss": -28514495653478.4, "vf_loss": 1097801177.6}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 3003.0, "diff_num_grad_updates_vs_sampler_policy": 3002.0}}, "num_env_steps_sampled": 216360, "num_env_steps_trained": 216360, "num_agent_steps_sampled": 216360, "num_agent_steps_trained": 216360}, "sampler_results": {"episode_reward_max": -25345.672421099924, "episode_reward_min": -26105.435092812302, "episode_reward_mean": -25774.915033941903, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-25798.788931450992, -25862.58342297002, -25709.185831124872, -25656.533499356352, -25801.86329287919, -25735.077283550734, -25905.161415354407, -26030.385655259062, -25961.244413259574, -25587.178291603854, -25502.553854804308, -25517.177817737986, -26034.06097801261, -25759.87498809651, -25601.91871519938, -25873.138791514357, -25784.505422226386, -25879.253160646764, -25914.29571780409, -25489.40311961304, -25975.842909860385, -25974.699021005083, -25790.845880610497, -25869.96738063129, -25810.069398333406, -25953.65395615741, -25815.451167885232, -25819.739158543565, -26026.27184238485, -26083.733153869016, -25758.136060547233, -25967.78515157466, -25660.300063580053, -25705.08482519234, -26102.14806445665, -25797.349811932254, -25781.579667060716, -25868.398999251014, -25529.3090589514, -25807.03109847257, -25902.754923447952, -25639.988495218277, -25519.349602989754, -25619.05502207858, -25891.1413734565, -25871.921132023614, -25571.612840771653, -26033.929002990495, -25968.70702087451, -25753.59731625539, -25345.672421099924, -25734.096507738315, -25955.573889103773, -25811.43468690695, -25757.650316806128, -26102.10048345207, -25707.737809963204, -25498.861591433688, -25792.569799139757, -25891.087779099707, -25939.916820663995, -25759.14015205737, -25762.77959591386, -25704.311257363963, -25815.26912545352, -25700.99265257654, -25637.371647749467, -25585.901797595612, -25743.78194530946, -25730.88118511566, -25693.754176045648, -25698.066298154874, -25756.51197157061, -25905.5706532299, -25980.36756481758, -25393.582456681695, -25827.103134906156, -25646.06684443742, -25631.552966078983, -25399.489287253382, -25958.460820273434, -25862.615523121418, -25784.877557646454, -25520.706181154666, -25602.665316442188, -25778.991024729174, -25844.319635697706, -25968.00378102244, -25599.63654565638, -26105.435092812302, -25720.035707131035, -25847.888622810693, -25737.30769667045, -25678.96459864703, -25730.000865931677, -25944.927787284018, -25798.500653704446, -25548.90054753863, -25587.786097460936, -25688.644517865163], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.47395712647624, "mean_inference_ms": 0.25039213685804085, "mean_action_processing_ms": 0.05955880094237508, "mean_env_wait_ms": 1.479633288747214, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0030515193939208984, "StateBufferConnector_ms": 0.002267122268676758, "ViewRequirementAgentConnector_ms": 0.057015419006347656}}, "episode_reward_max": -25345.672421099924, "episode_reward_min": -26105.435092812302, "episode_reward_mean": -25774.915033941903, "episode_len_mean": 360.0, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-25798.788931450992, -25862.58342297002, -25709.185831124872, -25656.533499356352, -25801.86329287919, -25735.077283550734, -25905.161415354407, -26030.385655259062, -25961.244413259574, -25587.178291603854, -25502.553854804308, -25517.177817737986, -26034.06097801261, -25759.87498809651, -25601.91871519938, -25873.138791514357, -25784.505422226386, -25879.253160646764, -25914.29571780409, -25489.40311961304, -25975.842909860385, -25974.699021005083, -25790.845880610497, -25869.96738063129, -25810.069398333406, -25953.65395615741, -25815.451167885232, -25819.739158543565, -26026.27184238485, -26083.733153869016, -25758.136060547233, -25967.78515157466, -25660.300063580053, -25705.08482519234, -26102.14806445665, -25797.349811932254, -25781.579667060716, -25868.398999251014, -25529.3090589514, -25807.03109847257, -25902.754923447952, -25639.988495218277, -25519.349602989754, -25619.05502207858, -25891.1413734565, -25871.921132023614, -25571.612840771653, -26033.929002990495, -25968.70702087451, -25753.59731625539, -25345.672421099924, -25734.096507738315, -25955.573889103773, -25811.43468690695, -25757.650316806128, -26102.10048345207, -25707.737809963204, -25498.861591433688, -25792.569799139757, -25891.087779099707, -25939.916820663995, -25759.14015205737, -25762.77959591386, -25704.311257363963, -25815.26912545352, -25700.99265257654, -25637.371647749467, -25585.901797595612, -25743.78194530946, -25730.88118511566, -25693.754176045648, -25698.066298154874, -25756.51197157061, -25905.5706532299, -25980.36756481758, -25393.582456681695, -25827.103134906156, -25646.06684443742, -25631.552966078983, -25399.489287253382, -25958.460820273434, -25862.615523121418, -25784.877557646454, -25520.706181154666, -25602.665316442188, -25778.991024729174, -25844.319635697706, -25968.00378102244, -25599.63654565638, -26105.435092812302, -25720.035707131035, -25847.888622810693, -25737.30769667045, -25678.96459864703, -25730.000865931677, -25944.927787284018, -25798.500653704446, -25548.90054753863, -25587.786097460936, -25688.644517865163], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.47395712647624, "mean_inference_ms": 0.25039213685804085, "mean_action_processing_ms": 0.05955880094237508, "mean_env_wait_ms": 1.479633288747214, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0030515193939208984, "StateBufferConnector_ms": 0.002267122268676758, "ViewRequirementAgentConnector_ms": 0.057015419006347656}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 216360, "num_agent_steps_trained": 216360, "num_env_steps_sampled": 216360, "num_env_steps_trained": 216360, "num_env_steps_sampled_this_iter": 1080, "num_env_steps_trained_this_iter": 1080, "num_env_steps_sampled_throughput_per_sec": 94.49992874717124, "num_env_steps_trained_throughput_per_sec": 94.49992874717124, "timesteps_total": 216360, "num_steps_trained_this_iter": 1080, "agent_timesteps_total": 216360, "timers": {"training_iteration_time_ms": 3801.196, "sample_time_ms": 3789.543, "load_time_ms": 0.367, "load_throughput": 980232.044, "learn_time_ms": 10.341, "learn_throughput": 34812.076, "synch_weights_time_ms": 0.867}, "counters": {"num_env_steps_sampled": 216360, "num_env_steps_trained": 216360, "num_agent_steps_sampled": 216360, "num_agent_steps_trained": 216360}, "done": false, "episodes_total": 601, "training_iteration": 127, "trial_id": "f5e97_00000", "date": "2023-07-25_17-19-36", "timestamp": 1690294776, "time_this_iter_s": 11.43155312538147, "time_total_s": 1421.2573065757751, "pid": 71917, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[0, 0.003], [5400, 0.001], [10800, 0.00075], [16200, 0.0005], [21600, 0.00025], [27000, 0.0001], [32400, 7.5e-05], [37800, 5e-05], [43200, 2.5e-05], [48600, 1e-05], [54000, 7.5e-06], [59400, 5e-06], [64800, 2.5e-06], [70200, 1e-06], [75600, 5e-07], [81000, 1e-07]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x304530310>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1421.2573065757751, "iterations_since_restore": 127, "perf": {"cpu_util_percent": 26.099999999999998, "ram_util_percent": 79.22941176470589}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-07, "entropy_coeff": 0.1, "policy_entropy": -926.6996459960938, "policy_loss": -29773050648985.6, "vf_loss": 1113395494.4}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 3018.0, "diff_num_grad_updates_vs_sampler_policy": 3017.0}}, "num_env_steps_sampled": 217440, "num_env_steps_trained": 217440, "num_agent_steps_sampled": 217440, "num_agent_steps_trained": 217440}, "sampler_results": {"episode_reward_max": -25345.672421099924, "episode_reward_min": -26105.435092812302, "episode_reward_mean": -25773.354919764344, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-25656.533499356352, -25801.86329287919, -25735.077283550734, -25905.161415354407, -26030.385655259062, -25961.244413259574, -25587.178291603854, -25502.553854804308, -25517.177817737986, -26034.06097801261, -25759.87498809651, -25601.91871519938, -25873.138791514357, -25784.505422226386, -25879.253160646764, -25914.29571780409, -25489.40311961304, -25975.842909860385, -25974.699021005083, -25790.845880610497, -25869.96738063129, -25810.069398333406, -25953.65395615741, -25815.451167885232, -25819.739158543565, -26026.27184238485, -26083.733153869016, -25758.136060547233, -25967.78515157466, -25660.300063580053, -25705.08482519234, -26102.14806445665, -25797.349811932254, -25781.579667060716, -25868.398999251014, -25529.3090589514, -25807.03109847257, -25902.754923447952, -25639.988495218277, -25519.349602989754, -25619.05502207858, -25891.1413734565, -25871.921132023614, -25571.612840771653, -26033.929002990495, -25968.70702087451, -25753.59731625539, -25345.672421099924, -25734.096507738315, -25955.573889103773, -25811.43468690695, -25757.650316806128, -26102.10048345207, -25707.737809963204, -25498.861591433688, -25792.569799139757, -25891.087779099707, -25939.916820663995, -25759.14015205737, -25762.77959591386, -25704.311257363963, -25815.26912545352, -25700.99265257654, -25637.371647749467, -25585.901797595612, -25743.78194530946, -25730.88118511566, -25693.754176045648, -25698.066298154874, -25756.51197157061, -25905.5706532299, -25980.36756481758, -25393.582456681695, -25827.103134906156, -25646.06684443742, -25631.552966078983, -25399.489287253382, -25958.460820273434, -25862.615523121418, -25784.877557646454, -25520.706181154666, -25602.665316442188, -25778.991024729174, -25844.319635697706, -25968.00378102244, -25599.63654565638, -26105.435092812302, -25720.035707131035, -25847.888622810693, -25737.30769667045, -25678.96459864703, -25730.000865931677, -25944.927787284018, -25798.500653704446, -25548.90054753863, -25587.786097460936, -25688.644517865163, -25464.608163331468, -25864.021290339366, -25885.91731411878], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.482317842299122, "mean_inference_ms": 0.25077703981307026, "mean_action_processing_ms": 0.05965328144128442, "mean_env_wait_ms": 1.4822740712974445, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003086566925048828, "StateBufferConnector_ms": 0.0022995471954345703, "ViewRequirementAgentConnector_ms": 0.05776524543762207}}, "episode_reward_max": -25345.672421099924, "episode_reward_min": -26105.435092812302, "episode_reward_mean": -25773.354919764344, "episode_len_mean": 360.0, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-25656.533499356352, -25801.86329287919, -25735.077283550734, -25905.161415354407, -26030.385655259062, -25961.244413259574, -25587.178291603854, -25502.553854804308, -25517.177817737986, -26034.06097801261, -25759.87498809651, -25601.91871519938, -25873.138791514357, -25784.505422226386, -25879.253160646764, -25914.29571780409, -25489.40311961304, -25975.842909860385, -25974.699021005083, -25790.845880610497, -25869.96738063129, -25810.069398333406, -25953.65395615741, -25815.451167885232, -25819.739158543565, -26026.27184238485, -26083.733153869016, -25758.136060547233, -25967.78515157466, -25660.300063580053, -25705.08482519234, -26102.14806445665, -25797.349811932254, -25781.579667060716, -25868.398999251014, -25529.3090589514, -25807.03109847257, -25902.754923447952, -25639.988495218277, -25519.349602989754, -25619.05502207858, -25891.1413734565, -25871.921132023614, -25571.612840771653, -26033.929002990495, -25968.70702087451, -25753.59731625539, -25345.672421099924, -25734.096507738315, -25955.573889103773, -25811.43468690695, -25757.650316806128, -26102.10048345207, -25707.737809963204, -25498.861591433688, -25792.569799139757, -25891.087779099707, -25939.916820663995, -25759.14015205737, -25762.77959591386, -25704.311257363963, -25815.26912545352, -25700.99265257654, -25637.371647749467, -25585.901797595612, -25743.78194530946, -25730.88118511566, -25693.754176045648, -25698.066298154874, -25756.51197157061, -25905.5706532299, -25980.36756481758, -25393.582456681695, -25827.103134906156, -25646.06684443742, -25631.552966078983, -25399.489287253382, -25958.460820273434, -25862.615523121418, -25784.877557646454, -25520.706181154666, -25602.665316442188, -25778.991024729174, -25844.319635697706, -25968.00378102244, -25599.63654565638, -26105.435092812302, -25720.035707131035, -25847.888622810693, -25737.30769667045, -25678.96459864703, -25730.000865931677, -25944.927787284018, -25798.500653704446, -25548.90054753863, -25587.786097460936, -25688.644517865163, -25464.608163331468, -25864.021290339366, -25885.91731411878], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.482317842299122, "mean_inference_ms": 0.25077703981307026, "mean_action_processing_ms": 0.05965328144128442, "mean_env_wait_ms": 1.4822740712974445, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003086566925048828, "StateBufferConnector_ms": 0.0022995471954345703, "ViewRequirementAgentConnector_ms": 0.05776524543762207}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 217440, "num_agent_steps_trained": 217440, "num_env_steps_sampled": 217440, "num_env_steps_trained": 217440, "num_env_steps_sampled_this_iter": 1080, "num_env_steps_trained_this_iter": 1080, "num_env_steps_sampled_throughput_per_sec": 96.06162604187676, "num_env_steps_trained_throughput_per_sec": 96.06162604187676, "timesteps_total": 217440, "num_steps_trained_this_iter": 1080, "agent_timesteps_total": 217440, "timers": {"training_iteration_time_ms": 3791.305, "sample_time_ms": 3779.723, "load_time_ms": 0.359, "load_throughput": 1002555.899, "learn_time_ms": 10.256, "learn_throughput": 35102.858, "synch_weights_time_ms": 0.89}, "counters": {"num_env_steps_sampled": 217440, "num_env_steps_trained": 217440, "num_agent_steps_sampled": 217440, "num_agent_steps_trained": 217440}, "done": false, "episodes_total": 604, "training_iteration": 128, "trial_id": "f5e97_00000", "date": "2023-07-25_17-19-48", "timestamp": 1690294788, "time_this_iter_s": 11.245447874069214, "time_total_s": 1432.5027544498444, "pid": 71917, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[0, 0.003], [5400, 0.001], [10800, 0.00075], [16200, 0.0005], [21600, 0.00025], [27000, 0.0001], [32400, 7.5e-05], [37800, 5e-05], [43200, 2.5e-05], [48600, 1e-05], [54000, 7.5e-06], [59400, 5e-06], [64800, 2.5e-06], [70200, 1e-06], [75600, 5e-07], [81000, 1e-07]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x304530310>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1432.5027544498444, "iterations_since_restore": 128, "perf": {"cpu_util_percent": 26.25, "ram_util_percent": 79.1625}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-07, "entropy_coeff": 0.1, "policy_entropy": -926.6998657226562, "policy_loss": -24223046959104.0, "vf_loss": 1085630310.4}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 3033.0, "diff_num_grad_updates_vs_sampler_policy": 3032.0}}, "num_env_steps_sampled": 218520, "num_env_steps_trained": 218520, "num_agent_steps_sampled": 218520, "num_agent_steps_trained": 218520}, "sampler_results": {"episode_reward_max": -25345.672421099924, "episode_reward_min": -26105.435092812302, "episode_reward_mean": -25773.40351276183, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-25905.161415354407, -26030.385655259062, -25961.244413259574, -25587.178291603854, -25502.553854804308, -25517.177817737986, -26034.06097801261, -25759.87498809651, -25601.91871519938, -25873.138791514357, -25784.505422226386, -25879.253160646764, -25914.29571780409, -25489.40311961304, -25975.842909860385, -25974.699021005083, -25790.845880610497, -25869.96738063129, -25810.069398333406, -25953.65395615741, -25815.451167885232, -25819.739158543565, -26026.27184238485, -26083.733153869016, -25758.136060547233, -25967.78515157466, -25660.300063580053, -25705.08482519234, -26102.14806445665, -25797.349811932254, -25781.579667060716, -25868.398999251014, -25529.3090589514, -25807.03109847257, -25902.754923447952, -25639.988495218277, -25519.349602989754, -25619.05502207858, -25891.1413734565, -25871.921132023614, -25571.612840771653, -26033.929002990495, -25968.70702087451, -25753.59731625539, -25345.672421099924, -25734.096507738315, -25955.573889103773, -25811.43468690695, -25757.650316806128, -26102.10048345207, -25707.737809963204, -25498.861591433688, -25792.569799139757, -25891.087779099707, -25939.916820663995, -25759.14015205737, -25762.77959591386, -25704.311257363963, -25815.26912545352, -25700.99265257654, -25637.371647749467, -25585.901797595612, -25743.78194530946, -25730.88118511566, -25693.754176045648, -25698.066298154874, -25756.51197157061, -25905.5706532299, -25980.36756481758, -25393.582456681695, -25827.103134906156, -25646.06684443742, -25631.552966078983, -25399.489287253382, -25958.460820273434, -25862.615523121418, -25784.877557646454, -25520.706181154666, -25602.665316442188, -25778.991024729174, -25844.319635697706, -25968.00378102244, -25599.63654565638, -26105.435092812302, -25720.035707131035, -25847.888622810693, -25737.30769667045, -25678.96459864703, -25730.000865931677, -25944.927787284018, -25798.500653704446, -25548.90054753863, -25587.786097460936, -25688.644517865163, -25464.608163331468, -25864.021290339366, -25885.91731411878, -25553.700367281243, -26042.408552654564, -25602.224455599582], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.491095028821169, "mean_inference_ms": 0.251181258552561, "mean_action_processing_ms": 0.05975252944255213, "mean_env_wait_ms": 1.4850611340088324, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0031290054321289062, "StateBufferConnector_ms": 0.002323627471923828, "ViewRequirementAgentConnector_ms": 0.05860447883605957}}, "episode_reward_max": -25345.672421099924, "episode_reward_min": -26105.435092812302, "episode_reward_mean": -25773.40351276183, "episode_len_mean": 360.0, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-25905.161415354407, -26030.385655259062, -25961.244413259574, -25587.178291603854, -25502.553854804308, -25517.177817737986, -26034.06097801261, -25759.87498809651, -25601.91871519938, -25873.138791514357, -25784.505422226386, -25879.253160646764, -25914.29571780409, -25489.40311961304, -25975.842909860385, -25974.699021005083, -25790.845880610497, -25869.96738063129, -25810.069398333406, -25953.65395615741, -25815.451167885232, -25819.739158543565, -26026.27184238485, -26083.733153869016, -25758.136060547233, -25967.78515157466, -25660.300063580053, -25705.08482519234, -26102.14806445665, -25797.349811932254, -25781.579667060716, -25868.398999251014, -25529.3090589514, -25807.03109847257, -25902.754923447952, -25639.988495218277, -25519.349602989754, -25619.05502207858, -25891.1413734565, -25871.921132023614, -25571.612840771653, -26033.929002990495, -25968.70702087451, -25753.59731625539, -25345.672421099924, -25734.096507738315, -25955.573889103773, -25811.43468690695, -25757.650316806128, -26102.10048345207, -25707.737809963204, -25498.861591433688, -25792.569799139757, -25891.087779099707, -25939.916820663995, -25759.14015205737, -25762.77959591386, -25704.311257363963, -25815.26912545352, -25700.99265257654, -25637.371647749467, -25585.901797595612, -25743.78194530946, -25730.88118511566, -25693.754176045648, -25698.066298154874, -25756.51197157061, -25905.5706532299, -25980.36756481758, -25393.582456681695, -25827.103134906156, -25646.06684443742, -25631.552966078983, -25399.489287253382, -25958.460820273434, -25862.615523121418, -25784.877557646454, -25520.706181154666, -25602.665316442188, -25778.991024729174, -25844.319635697706, -25968.00378102244, -25599.63654565638, -26105.435092812302, -25720.035707131035, -25847.888622810693, -25737.30769667045, -25678.96459864703, -25730.000865931677, -25944.927787284018, -25798.500653704446, -25548.90054753863, -25587.786097460936, -25688.644517865163, -25464.608163331468, -25864.021290339366, -25885.91731411878, -25553.700367281243, -26042.408552654564, -25602.224455599582], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.491095028821169, "mean_inference_ms": 0.251181258552561, "mean_action_processing_ms": 0.05975252944255213, "mean_env_wait_ms": 1.4850611340088324, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0031290054321289062, "StateBufferConnector_ms": 0.002323627471923828, "ViewRequirementAgentConnector_ms": 0.05860447883605957}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 218520, "num_agent_steps_trained": 218520, "num_env_steps_sampled": 218520, "num_env_steps_trained": 218520, "num_env_steps_sampled_this_iter": 1080, "num_env_steps_trained_this_iter": 1080, "num_env_steps_sampled_throughput_per_sec": 96.06042212016904, "num_env_steps_trained_throughput_per_sec": 96.06042212016904, "timesteps_total": 218520, "num_steps_trained_this_iter": 1080, "agent_timesteps_total": 218520, "timers": {"training_iteration_time_ms": 3786.893, "sample_time_ms": 3775.986, "load_time_ms": 0.309, "load_throughput": 1164994.553, "learn_time_ms": 9.82, "learn_throughput": 36658.69, "synch_weights_time_ms": 0.733}, "counters": {"num_env_steps_sampled": 218520, "num_env_steps_trained": 218520, "num_agent_steps_sampled": 218520, "num_agent_steps_trained": 218520}, "done": false, "episodes_total": 607, "training_iteration": 129, "trial_id": "f5e97_00000", "date": "2023-07-25_17-19-59", "timestamp": 1690294799, "time_this_iter_s": 11.245746850967407, "time_total_s": 1443.7485013008118, "pid": 71917, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[0, 0.003], [5400, 0.001], [10800, 0.00075], [16200, 0.0005], [21600, 0.00025], [27000, 0.0001], [32400, 7.5e-05], [37800, 5e-05], [43200, 2.5e-05], [48600, 1e-05], [54000, 7.5e-06], [59400, 5e-06], [64800, 2.5e-06], [70200, 1e-06], [75600, 5e-07], [81000, 1e-07]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x304530310>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1443.7485013008118, "iterations_since_restore": 129, "perf": {"cpu_util_percent": 26.012500000000003, "ram_util_percent": 79.56875}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-07, "entropy_coeff": 0.1, "policy_entropy": -926.6999267578125, "policy_loss": -22440258646835.2, "vf_loss": 1087619174.4}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 3048.0, "diff_num_grad_updates_vs_sampler_policy": 3047.0}}, "num_env_steps_sampled": 219600, "num_env_steps_trained": 219600, "num_agent_steps_sampled": 219600, "num_agent_steps_trained": 219600}, "sampler_results": {"episode_reward_max": -25345.672421099924, "episode_reward_min": -26105.435092812302, "episode_reward_mean": -25765.450714912662, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-25587.178291603854, -25502.553854804308, -25517.177817737986, -26034.06097801261, -25759.87498809651, -25601.91871519938, -25873.138791514357, -25784.505422226386, -25879.253160646764, -25914.29571780409, -25489.40311961304, -25975.842909860385, -25974.699021005083, -25790.845880610497, -25869.96738063129, -25810.069398333406, -25953.65395615741, -25815.451167885232, -25819.739158543565, -26026.27184238485, -26083.733153869016, -25758.136060547233, -25967.78515157466, -25660.300063580053, -25705.08482519234, -26102.14806445665, -25797.349811932254, -25781.579667060716, -25868.398999251014, -25529.3090589514, -25807.03109847257, -25902.754923447952, -25639.988495218277, -25519.349602989754, -25619.05502207858, -25891.1413734565, -25871.921132023614, -25571.612840771653, -26033.929002990495, -25968.70702087451, -25753.59731625539, -25345.672421099924, -25734.096507738315, -25955.573889103773, -25811.43468690695, -25757.650316806128, -26102.10048345207, -25707.737809963204, -25498.861591433688, -25792.569799139757, -25891.087779099707, -25939.916820663995, -25759.14015205737, -25762.77959591386, -25704.311257363963, -25815.26912545352, -25700.99265257654, -25637.371647749467, -25585.901797595612, -25743.78194530946, -25730.88118511566, -25693.754176045648, -25698.066298154874, -25756.51197157061, -25905.5706532299, -25980.36756481758, -25393.582456681695, -25827.103134906156, -25646.06684443742, -25631.552966078983, -25399.489287253382, -25958.460820273434, -25862.615523121418, -25784.877557646454, -25520.706181154666, -25602.665316442188, -25778.991024729174, -25844.319635697706, -25968.00378102244, -25599.63654565638, -26105.435092812302, -25720.035707131035, -25847.888622810693, -25737.30769667045, -25678.96459864703, -25730.000865931677, -25944.927787284018, -25798.500653704446, -25548.90054753863, -25587.786097460936, -25688.644517865163, -25464.608163331468, -25864.021290339366, -25885.91731411878, -25553.700367281243, -26042.408552654564, -25602.224455599582, -25765.828737911692, -25687.931787524136, -25647.751173520413], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.500263278250247, "mean_inference_ms": 0.25161058092730026, "mean_action_processing_ms": 0.059857281328877764, "mean_env_wait_ms": 1.4879849096212383, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0031871795654296875, "StateBufferConnector_ms": 0.0023605823516845703, "ViewRequirementAgentConnector_ms": 0.05951738357543945}}, "episode_reward_max": -25345.672421099924, "episode_reward_min": -26105.435092812302, "episode_reward_mean": -25765.450714912662, "episode_len_mean": 360.0, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-25587.178291603854, -25502.553854804308, -25517.177817737986, -26034.06097801261, -25759.87498809651, -25601.91871519938, -25873.138791514357, -25784.505422226386, -25879.253160646764, -25914.29571780409, -25489.40311961304, -25975.842909860385, -25974.699021005083, -25790.845880610497, -25869.96738063129, -25810.069398333406, -25953.65395615741, -25815.451167885232, -25819.739158543565, -26026.27184238485, -26083.733153869016, -25758.136060547233, -25967.78515157466, -25660.300063580053, -25705.08482519234, -26102.14806445665, -25797.349811932254, -25781.579667060716, -25868.398999251014, -25529.3090589514, -25807.03109847257, -25902.754923447952, -25639.988495218277, -25519.349602989754, -25619.05502207858, -25891.1413734565, -25871.921132023614, -25571.612840771653, -26033.929002990495, -25968.70702087451, -25753.59731625539, -25345.672421099924, -25734.096507738315, -25955.573889103773, -25811.43468690695, -25757.650316806128, -26102.10048345207, -25707.737809963204, -25498.861591433688, -25792.569799139757, -25891.087779099707, -25939.916820663995, -25759.14015205737, -25762.77959591386, -25704.311257363963, -25815.26912545352, -25700.99265257654, -25637.371647749467, -25585.901797595612, -25743.78194530946, -25730.88118511566, -25693.754176045648, -25698.066298154874, -25756.51197157061, -25905.5706532299, -25980.36756481758, -25393.582456681695, -25827.103134906156, -25646.06684443742, -25631.552966078983, -25399.489287253382, -25958.460820273434, -25862.615523121418, -25784.877557646454, -25520.706181154666, -25602.665316442188, -25778.991024729174, -25844.319635697706, -25968.00378102244, -25599.63654565638, -26105.435092812302, -25720.035707131035, -25847.888622810693, -25737.30769667045, -25678.96459864703, -25730.000865931677, -25944.927787284018, -25798.500653704446, -25548.90054753863, -25587.786097460936, -25688.644517865163, -25464.608163331468, -25864.021290339366, -25885.91731411878, -25553.700367281243, -26042.408552654564, -25602.224455599582, -25765.828737911692, -25687.931787524136, -25647.751173520413], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.500263278250247, "mean_inference_ms": 0.25161058092730026, "mean_action_processing_ms": 0.059857281328877764, "mean_env_wait_ms": 1.4879849096212383, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0031871795654296875, "StateBufferConnector_ms": 0.0023605823516845703, "ViewRequirementAgentConnector_ms": 0.05951738357543945}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 219600, "num_agent_steps_trained": 219600, "num_env_steps_sampled": 219600, "num_env_steps_trained": 219600, "num_env_steps_sampled_this_iter": 1080, "num_env_steps_trained_this_iter": 1080, "num_env_steps_sampled_throughput_per_sec": 95.65762192510631, "num_env_steps_trained_throughput_per_sec": 95.65762192510631, "timesteps_total": 219600, "num_steps_trained_this_iter": 1080, "agent_timesteps_total": 219600, "timers": {"training_iteration_time_ms": 3755.76, "sample_time_ms": 3744.658, "load_time_ms": 0.3, "load_throughput": 1199038.704, "learn_time_ms": 10.005, "learn_throughput": 35982.962, "synch_weights_time_ms": 0.753}, "counters": {"num_env_steps_sampled": 219600, "num_env_steps_trained": 219600, "num_agent_steps_sampled": 219600, "num_agent_steps_trained": 219600}, "done": false, "episodes_total": 610, "training_iteration": 130, "trial_id": "f5e97_00000", "date": "2023-07-25_17-20-10", "timestamp": 1690294810, "time_this_iter_s": 11.293247938156128, "time_total_s": 1455.041749238968, "pid": 71917, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[0, 0.003], [5400, 0.001], [10800, 0.00075], [16200, 0.0005], [21600, 0.00025], [27000, 0.0001], [32400, 7.5e-05], [37800, 5e-05], [43200, 2.5e-05], [48600, 1e-05], [54000, 7.5e-06], [59400, 5e-06], [64800, 2.5e-06], [70200, 1e-06], [75600, 5e-07], [81000, 1e-07]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x304530310>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1455.041749238968, "iterations_since_restore": 130, "perf": {"cpu_util_percent": 30.599999999999998, "ram_util_percent": 79.41875}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-07, "entropy_coeff": 0.1, "policy_entropy": -926.699755859375, "policy_loss": -16513485976371.2, "vf_loss": 1107418483.2}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 3063.0, "diff_num_grad_updates_vs_sampler_policy": 3062.0}}, "num_env_steps_sampled": 220680, "num_env_steps_trained": 220680, "num_agent_steps_sampled": 220680, "num_agent_steps_trained": 220680}, "sampler_results": {"episode_reward_max": -25345.672421099924, "episode_reward_min": -26105.435092812302, "episode_reward_mean": -25773.032476109805, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-26034.06097801261, -25759.87498809651, -25601.91871519938, -25873.138791514357, -25784.505422226386, -25879.253160646764, -25914.29571780409, -25489.40311961304, -25975.842909860385, -25974.699021005083, -25790.845880610497, -25869.96738063129, -25810.069398333406, -25953.65395615741, -25815.451167885232, -25819.739158543565, -26026.27184238485, -26083.733153869016, -25758.136060547233, -25967.78515157466, -25660.300063580053, -25705.08482519234, -26102.14806445665, -25797.349811932254, -25781.579667060716, -25868.398999251014, -25529.3090589514, -25807.03109847257, -25902.754923447952, -25639.988495218277, -25519.349602989754, -25619.05502207858, -25891.1413734565, -25871.921132023614, -25571.612840771653, -26033.929002990495, -25968.70702087451, -25753.59731625539, -25345.672421099924, -25734.096507738315, -25955.573889103773, -25811.43468690695, -25757.650316806128, -26102.10048345207, -25707.737809963204, -25498.861591433688, -25792.569799139757, -25891.087779099707, -25939.916820663995, -25759.14015205737, -25762.77959591386, -25704.311257363963, -25815.26912545352, -25700.99265257654, -25637.371647749467, -25585.901797595612, -25743.78194530946, -25730.88118511566, -25693.754176045648, -25698.066298154874, -25756.51197157061, -25905.5706532299, -25980.36756481758, -25393.582456681695, -25827.103134906156, -25646.06684443742, -25631.552966078983, -25399.489287253382, -25958.460820273434, -25862.615523121418, -25784.877557646454, -25520.706181154666, -25602.665316442188, -25778.991024729174, -25844.319635697706, -25968.00378102244, -25599.63654565638, -26105.435092812302, -25720.035707131035, -25847.888622810693, -25737.30769667045, -25678.96459864703, -25730.000865931677, -25944.927787284018, -25798.500653704446, -25548.90054753863, -25587.786097460936, -25688.644517865163, -25464.608163331468, -25864.021290339366, -25885.91731411878, -25553.700367281243, -26042.408552654564, -25602.224455599582, -25765.828737911692, -25687.931787524136, -25647.751173520413, -25708.912178971168, -25823.99841316268, -25832.175491726637], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.509944608021524, "mean_inference_ms": 0.2520673621615044, "mean_action_processing_ms": 0.059967964138263864, "mean_env_wait_ms": 1.4910288998394916, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0032300949096679688, "StateBufferConnector_ms": 0.0023925304412841797, "ViewRequirementAgentConnector_ms": 0.060357093811035156}}, "episode_reward_max": -25345.672421099924, "episode_reward_min": -26105.435092812302, "episode_reward_mean": -25773.032476109805, "episode_len_mean": 360.0, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-26034.06097801261, -25759.87498809651, -25601.91871519938, -25873.138791514357, -25784.505422226386, -25879.253160646764, -25914.29571780409, -25489.40311961304, -25975.842909860385, -25974.699021005083, -25790.845880610497, -25869.96738063129, -25810.069398333406, -25953.65395615741, -25815.451167885232, -25819.739158543565, -26026.27184238485, -26083.733153869016, -25758.136060547233, -25967.78515157466, -25660.300063580053, -25705.08482519234, -26102.14806445665, -25797.349811932254, -25781.579667060716, -25868.398999251014, -25529.3090589514, -25807.03109847257, -25902.754923447952, -25639.988495218277, -25519.349602989754, -25619.05502207858, -25891.1413734565, -25871.921132023614, -25571.612840771653, -26033.929002990495, -25968.70702087451, -25753.59731625539, -25345.672421099924, -25734.096507738315, -25955.573889103773, -25811.43468690695, -25757.650316806128, -26102.10048345207, -25707.737809963204, -25498.861591433688, -25792.569799139757, -25891.087779099707, -25939.916820663995, -25759.14015205737, -25762.77959591386, -25704.311257363963, -25815.26912545352, -25700.99265257654, -25637.371647749467, -25585.901797595612, -25743.78194530946, -25730.88118511566, -25693.754176045648, -25698.066298154874, -25756.51197157061, -25905.5706532299, -25980.36756481758, -25393.582456681695, -25827.103134906156, -25646.06684443742, -25631.552966078983, -25399.489287253382, -25958.460820273434, -25862.615523121418, -25784.877557646454, -25520.706181154666, -25602.665316442188, -25778.991024729174, -25844.319635697706, -25968.00378102244, -25599.63654565638, -26105.435092812302, -25720.035707131035, -25847.888622810693, -25737.30769667045, -25678.96459864703, -25730.000865931677, -25944.927787284018, -25798.500653704446, -25548.90054753863, -25587.786097460936, -25688.644517865163, -25464.608163331468, -25864.021290339366, -25885.91731411878, -25553.700367281243, -26042.408552654564, -25602.224455599582, -25765.828737911692, -25687.931787524136, -25647.751173520413, -25708.912178971168, -25823.99841316268, -25832.175491726637], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.509944608021524, "mean_inference_ms": 0.2520673621615044, "mean_action_processing_ms": 0.059967964138263864, "mean_env_wait_ms": 1.4910288998394916, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0032300949096679688, "StateBufferConnector_ms": 0.0023925304412841797, "ViewRequirementAgentConnector_ms": 0.060357093811035156}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 220680, "num_agent_steps_trained": 220680, "num_env_steps_sampled": 220680, "num_env_steps_trained": 220680, "num_env_steps_sampled_this_iter": 1080, "num_env_steps_trained_this_iter": 1080, "num_env_steps_sampled_throughput_per_sec": 88.62538481921929, "num_env_steps_trained_throughput_per_sec": 88.62538481921929, "timesteps_total": 220680, "num_steps_trained_this_iter": 1080, "agent_timesteps_total": 220680, "timers": {"training_iteration_time_ms": 3852.496, "sample_time_ms": 3840.655, "load_time_ms": 0.371, "load_throughput": 970778.861, "learn_time_ms": 10.56, "learn_throughput": 34089.947, "synch_weights_time_ms": 0.837}, "counters": {"num_env_steps_sampled": 220680, "num_env_steps_trained": 220680, "num_agent_steps_sampled": 220680, "num_agent_steps_trained": 220680}, "done": false, "episodes_total": 613, "training_iteration": 131, "trial_id": "f5e97_00000", "date": "2023-07-25_17-20-23", "timestamp": 1690294823, "time_this_iter_s": 12.189482927322388, "time_total_s": 1467.2312321662903, "pid": 71917, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[0, 0.003], [5400, 0.001], [10800, 0.00075], [16200, 0.0005], [21600, 0.00025], [27000, 0.0001], [32400, 7.5e-05], [37800, 5e-05], [43200, 2.5e-05], [48600, 1e-05], [54000, 7.5e-06], [59400, 5e-06], [64800, 2.5e-06], [70200, 1e-06], [75600, 5e-07], [81000, 1e-07]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x304530310>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1467.2312321662903, "iterations_since_restore": 131, "perf": {"cpu_util_percent": 44.652941176470584, "ram_util_percent": 80.87647058823529}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-07, "entropy_coeff": 0.1, "policy_entropy": -926.699951171875, "policy_loss": -23473917521920.0, "vf_loss": 1094065798.4}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 3078.0, "diff_num_grad_updates_vs_sampler_policy": 3077.0}}, "num_env_steps_sampled": 221760, "num_env_steps_trained": 221760, "num_agent_steps_sampled": 221760, "num_agent_steps_trained": 221760}, "sampler_results": {"episode_reward_max": -25345.672421099924, "episode_reward_min": -26105.435092812302, "episode_reward_mean": -25771.119066870604, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-25873.138791514357, -25784.505422226386, -25879.253160646764, -25914.29571780409, -25489.40311961304, -25975.842909860385, -25974.699021005083, -25790.845880610497, -25869.96738063129, -25810.069398333406, -25953.65395615741, -25815.451167885232, -25819.739158543565, -26026.27184238485, -26083.733153869016, -25758.136060547233, -25967.78515157466, -25660.300063580053, -25705.08482519234, -26102.14806445665, -25797.349811932254, -25781.579667060716, -25868.398999251014, -25529.3090589514, -25807.03109847257, -25902.754923447952, -25639.988495218277, -25519.349602989754, -25619.05502207858, -25891.1413734565, -25871.921132023614, -25571.612840771653, -26033.929002990495, -25968.70702087451, -25753.59731625539, -25345.672421099924, -25734.096507738315, -25955.573889103773, -25811.43468690695, -25757.650316806128, -26102.10048345207, -25707.737809963204, -25498.861591433688, -25792.569799139757, -25891.087779099707, -25939.916820663995, -25759.14015205737, -25762.77959591386, -25704.311257363963, -25815.26912545352, -25700.99265257654, -25637.371647749467, -25585.901797595612, -25743.78194530946, -25730.88118511566, -25693.754176045648, -25698.066298154874, -25756.51197157061, -25905.5706532299, -25980.36756481758, -25393.582456681695, -25827.103134906156, -25646.06684443742, -25631.552966078983, -25399.489287253382, -25958.460820273434, -25862.615523121418, -25784.877557646454, -25520.706181154666, -25602.665316442188, -25778.991024729174, -25844.319635697706, -25968.00378102244, -25599.63654565638, -26105.435092812302, -25720.035707131035, -25847.888622810693, -25737.30769667045, -25678.96459864703, -25730.000865931677, -25944.927787284018, -25798.500653704446, -25548.90054753863, -25587.786097460936, -25688.644517865163, -25464.608163331468, -25864.021290339366, -25885.91731411878, -25553.700367281243, -26042.408552654564, -25602.224455599582, -25765.828737911692, -25687.931787524136, -25647.751173520413, -25708.912178971168, -25823.99841316268, -25832.175491726637, -25554.266391473473, -25959.410281017565, -25690.837084897732], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.520024420021593, "mean_inference_ms": 0.2525545706589263, "mean_action_processing_ms": 0.0600854061602976, "mean_env_wait_ms": 1.4941912899771532, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0032672882080078125, "StateBufferConnector_ms": 0.0024292469024658203, "ViewRequirementAgentConnector_ms": 0.06111764907836914}}, "episode_reward_max": -25345.672421099924, "episode_reward_min": -26105.435092812302, "episode_reward_mean": -25771.119066870604, "episode_len_mean": 360.0, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-25873.138791514357, -25784.505422226386, -25879.253160646764, -25914.29571780409, -25489.40311961304, -25975.842909860385, -25974.699021005083, -25790.845880610497, -25869.96738063129, -25810.069398333406, -25953.65395615741, -25815.451167885232, -25819.739158543565, -26026.27184238485, -26083.733153869016, -25758.136060547233, -25967.78515157466, -25660.300063580053, -25705.08482519234, -26102.14806445665, -25797.349811932254, -25781.579667060716, -25868.398999251014, -25529.3090589514, -25807.03109847257, -25902.754923447952, -25639.988495218277, -25519.349602989754, -25619.05502207858, -25891.1413734565, -25871.921132023614, -25571.612840771653, -26033.929002990495, -25968.70702087451, -25753.59731625539, -25345.672421099924, -25734.096507738315, -25955.573889103773, -25811.43468690695, -25757.650316806128, -26102.10048345207, -25707.737809963204, -25498.861591433688, -25792.569799139757, -25891.087779099707, -25939.916820663995, -25759.14015205737, -25762.77959591386, -25704.311257363963, -25815.26912545352, -25700.99265257654, -25637.371647749467, -25585.901797595612, -25743.78194530946, -25730.88118511566, -25693.754176045648, -25698.066298154874, -25756.51197157061, -25905.5706532299, -25980.36756481758, -25393.582456681695, -25827.103134906156, -25646.06684443742, -25631.552966078983, -25399.489287253382, -25958.460820273434, -25862.615523121418, -25784.877557646454, -25520.706181154666, -25602.665316442188, -25778.991024729174, -25844.319635697706, -25968.00378102244, -25599.63654565638, -26105.435092812302, -25720.035707131035, -25847.888622810693, -25737.30769667045, -25678.96459864703, -25730.000865931677, -25944.927787284018, -25798.500653704446, -25548.90054753863, -25587.786097460936, -25688.644517865163, -25464.608163331468, -25864.021290339366, -25885.91731411878, -25553.700367281243, -26042.408552654564, -25602.224455599582, -25765.828737911692, -25687.931787524136, -25647.751173520413, -25708.912178971168, -25823.99841316268, -25832.175491726637, -25554.266391473473, -25959.410281017565, -25690.837084897732], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.520024420021593, "mean_inference_ms": 0.2525545706589263, "mean_action_processing_ms": 0.0600854061602976, "mean_env_wait_ms": 1.4941912899771532, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0032672882080078125, "StateBufferConnector_ms": 0.0024292469024658203, "ViewRequirementAgentConnector_ms": 0.06111764907836914}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 221760, "num_agent_steps_trained": 221760, "num_env_steps_sampled": 221760, "num_env_steps_trained": 221760, "num_env_steps_sampled_this_iter": 1080, "num_env_steps_trained_this_iter": 1080, "num_env_steps_sampled_throughput_per_sec": 95.31021673890287, "num_env_steps_trained_throughput_per_sec": 95.31021673890287, "timesteps_total": 221760, "num_steps_trained_this_iter": 1080, "agent_timesteps_total": 221760, "timers": {"training_iteration_time_ms": 3857.57, "sample_time_ms": 3845.463, "load_time_ms": 0.385, "load_throughput": 935126.921, "learn_time_ms": 10.775, "learn_throughput": 33409.139, "synch_weights_time_ms": 0.866}, "counters": {"num_env_steps_sampled": 221760, "num_env_steps_trained": 221760, "num_agent_steps_sampled": 221760, "num_agent_steps_trained": 221760}, "done": false, "episodes_total": 616, "training_iteration": 132, "trial_id": "f5e97_00000", "date": "2023-07-25_17-20-34", "timestamp": 1690294834, "time_this_iter_s": 11.334485054016113, "time_total_s": 1478.5657172203064, "pid": 71917, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[0, 0.003], [5400, 0.001], [10800, 0.00075], [16200, 0.0005], [21600, 0.00025], [27000, 0.0001], [32400, 7.5e-05], [37800, 5e-05], [43200, 2.5e-05], [48600, 1e-05], [54000, 7.5e-06], [59400, 5e-06], [64800, 2.5e-06], [70200, 1e-06], [75600, 5e-07], [81000, 1e-07]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x304530310>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1478.5657172203064, "iterations_since_restore": 132, "perf": {"cpu_util_percent": 35.6375, "ram_util_percent": 79.4375}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-07, "entropy_coeff": 0.1, "policy_entropy": -926.6999145507813, "policy_loss": -23136604160819.2, "vf_loss": 1099820672.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 3093.0, "diff_num_grad_updates_vs_sampler_policy": 3092.0}}, "num_env_steps_sampled": 222840, "num_env_steps_trained": 222840, "num_agent_steps_sampled": 222840, "num_agent_steps_trained": 222840}, "sampler_results": {"episode_reward_max": -25345.672421099924, "episode_reward_min": -26105.435092812302, "episode_reward_mean": -25764.98214341556, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-25914.29571780409, -25489.40311961304, -25975.842909860385, -25974.699021005083, -25790.845880610497, -25869.96738063129, -25810.069398333406, -25953.65395615741, -25815.451167885232, -25819.739158543565, -26026.27184238485, -26083.733153869016, -25758.136060547233, -25967.78515157466, -25660.300063580053, -25705.08482519234, -26102.14806445665, -25797.349811932254, -25781.579667060716, -25868.398999251014, -25529.3090589514, -25807.03109847257, -25902.754923447952, -25639.988495218277, -25519.349602989754, -25619.05502207858, -25891.1413734565, -25871.921132023614, -25571.612840771653, -26033.929002990495, -25968.70702087451, -25753.59731625539, -25345.672421099924, -25734.096507738315, -25955.573889103773, -25811.43468690695, -25757.650316806128, -26102.10048345207, -25707.737809963204, -25498.861591433688, -25792.569799139757, -25891.087779099707, -25939.916820663995, -25759.14015205737, -25762.77959591386, -25704.311257363963, -25815.26912545352, -25700.99265257654, -25637.371647749467, -25585.901797595612, -25743.78194530946, -25730.88118511566, -25693.754176045648, -25698.066298154874, -25756.51197157061, -25905.5706532299, -25980.36756481758, -25393.582456681695, -25827.103134906156, -25646.06684443742, -25631.552966078983, -25399.489287253382, -25958.460820273434, -25862.615523121418, -25784.877557646454, -25520.706181154666, -25602.665316442188, -25778.991024729174, -25844.319635697706, -25968.00378102244, -25599.63654565638, -26105.435092812302, -25720.035707131035, -25847.888622810693, -25737.30769667045, -25678.96459864703, -25730.000865931677, -25944.927787284018, -25798.500653704446, -25548.90054753863, -25587.786097460936, -25688.644517865163, -25464.608163331468, -25864.021290339366, -25885.91731411878, -25553.700367281243, -26042.408552654564, -25602.224455599582, -25765.828737911692, -25687.931787524136, -25647.751173520413, -25708.912178971168, -25823.99841316268, -25832.175491726637, -25554.266391473473, -25959.410281017565, -25690.837084897732, -25402.97920299653, -25762.143345042303, -25758.082480843907], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.530484968729603, "mean_inference_ms": 0.2530635609611359, "mean_action_processing_ms": 0.060207955474962, "mean_env_wait_ms": 1.4974779228610606, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0033311843872070312, "StateBufferConnector_ms": 0.0024750232696533203, "ViewRequirementAgentConnector_ms": 0.0622711181640625}}, "episode_reward_max": -25345.672421099924, "episode_reward_min": -26105.435092812302, "episode_reward_mean": -25764.98214341556, "episode_len_mean": 360.0, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-25914.29571780409, -25489.40311961304, -25975.842909860385, -25974.699021005083, -25790.845880610497, -25869.96738063129, -25810.069398333406, -25953.65395615741, -25815.451167885232, -25819.739158543565, -26026.27184238485, -26083.733153869016, -25758.136060547233, -25967.78515157466, -25660.300063580053, -25705.08482519234, -26102.14806445665, -25797.349811932254, -25781.579667060716, -25868.398999251014, -25529.3090589514, -25807.03109847257, -25902.754923447952, -25639.988495218277, -25519.349602989754, -25619.05502207858, -25891.1413734565, -25871.921132023614, -25571.612840771653, -26033.929002990495, -25968.70702087451, -25753.59731625539, -25345.672421099924, -25734.096507738315, -25955.573889103773, -25811.43468690695, -25757.650316806128, -26102.10048345207, -25707.737809963204, -25498.861591433688, -25792.569799139757, -25891.087779099707, -25939.916820663995, -25759.14015205737, -25762.77959591386, -25704.311257363963, -25815.26912545352, -25700.99265257654, -25637.371647749467, -25585.901797595612, -25743.78194530946, -25730.88118511566, -25693.754176045648, -25698.066298154874, -25756.51197157061, -25905.5706532299, -25980.36756481758, -25393.582456681695, -25827.103134906156, -25646.06684443742, -25631.552966078983, -25399.489287253382, -25958.460820273434, -25862.615523121418, -25784.877557646454, -25520.706181154666, -25602.665316442188, -25778.991024729174, -25844.319635697706, -25968.00378102244, -25599.63654565638, -26105.435092812302, -25720.035707131035, -25847.888622810693, -25737.30769667045, -25678.96459864703, -25730.000865931677, -25944.927787284018, -25798.500653704446, -25548.90054753863, -25587.786097460936, -25688.644517865163, -25464.608163331468, -25864.021290339366, -25885.91731411878, -25553.700367281243, -26042.408552654564, -25602.224455599582, -25765.828737911692, -25687.931787524136, -25647.751173520413, -25708.912178971168, -25823.99841316268, -25832.175491726637, -25554.266391473473, -25959.410281017565, -25690.837084897732, -25402.97920299653, -25762.143345042303, -25758.082480843907], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.530484968729603, "mean_inference_ms": 0.2530635609611359, "mean_action_processing_ms": 0.060207955474962, "mean_env_wait_ms": 1.4974779228610606, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0033311843872070312, "StateBufferConnector_ms": 0.0024750232696533203, "ViewRequirementAgentConnector_ms": 0.0622711181640625}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 222840, "num_agent_steps_trained": 222840, "num_env_steps_sampled": 222840, "num_env_steps_trained": 222840, "num_env_steps_sampled_this_iter": 1080, "num_env_steps_trained_this_iter": 1080, "num_env_steps_sampled_throughput_per_sec": 96.54924059987604, "num_env_steps_trained_throughput_per_sec": 96.54924059987604, "timesteps_total": 222840, "num_steps_trained_this_iter": 1080, "agent_timesteps_total": 222840, "timers": {"training_iteration_time_ms": 3839.887, "sample_time_ms": 3827.855, "load_time_ms": 0.382, "load_throughput": 943011.142, "learn_time_ms": 10.704, "learn_throughput": 33633.733, "synch_weights_time_ms": 0.865}, "counters": {"num_env_steps_sampled": 222840, "num_env_steps_trained": 222840, "num_agent_steps_sampled": 222840, "num_agent_steps_trained": 222840}, "done": false, "episodes_total": 619, "training_iteration": 133, "trial_id": "f5e97_00000", "date": "2023-07-25_17-20-45", "timestamp": 1690294845, "time_this_iter_s": 11.188863277435303, "time_total_s": 1489.7545804977417, "pid": 71917, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[0, 0.003], [5400, 0.001], [10800, 0.00075], [16200, 0.0005], [21600, 0.00025], [27000, 0.0001], [32400, 7.5e-05], [37800, 5e-05], [43200, 2.5e-05], [48600, 1e-05], [54000, 7.5e-06], [59400, 5e-06], [64800, 2.5e-06], [70200, 1e-06], [75600, 5e-07], [81000, 1e-07]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x304530310>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1489.7545804977417, "iterations_since_restore": 133, "perf": {"cpu_util_percent": 25.58125, "ram_util_percent": 78.3}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-07, "entropy_coeff": 0.1, "policy_entropy": -926.6999877929687, "policy_loss": -31560361529344.0, "vf_loss": 1097680864.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 3108.0, "diff_num_grad_updates_vs_sampler_policy": 3107.0}}, "num_env_steps_sampled": 223920, "num_env_steps_trained": 223920, "num_agent_steps_sampled": 223920, "num_agent_steps_trained": 223920}, "sampler_results": {"episode_reward_max": -25345.672421099924, "episode_reward_min": -26105.435092812302, "episode_reward_mean": -25762.226740562593, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-25974.699021005083, -25790.845880610497, -25869.96738063129, -25810.069398333406, -25953.65395615741, -25815.451167885232, -25819.739158543565, -26026.27184238485, -26083.733153869016, -25758.136060547233, -25967.78515157466, -25660.300063580053, -25705.08482519234, -26102.14806445665, -25797.349811932254, -25781.579667060716, -25868.398999251014, -25529.3090589514, -25807.03109847257, -25902.754923447952, -25639.988495218277, -25519.349602989754, -25619.05502207858, -25891.1413734565, -25871.921132023614, -25571.612840771653, -26033.929002990495, -25968.70702087451, -25753.59731625539, -25345.672421099924, -25734.096507738315, -25955.573889103773, -25811.43468690695, -25757.650316806128, -26102.10048345207, -25707.737809963204, -25498.861591433688, -25792.569799139757, -25891.087779099707, -25939.916820663995, -25759.14015205737, -25762.77959591386, -25704.311257363963, -25815.26912545352, -25700.99265257654, -25637.371647749467, -25585.901797595612, -25743.78194530946, -25730.88118511566, -25693.754176045648, -25698.066298154874, -25756.51197157061, -25905.5706532299, -25980.36756481758, -25393.582456681695, -25827.103134906156, -25646.06684443742, -25631.552966078983, -25399.489287253382, -25958.460820273434, -25862.615523121418, -25784.877557646454, -25520.706181154666, -25602.665316442188, -25778.991024729174, -25844.319635697706, -25968.00378102244, -25599.63654565638, -26105.435092812302, -25720.035707131035, -25847.888622810693, -25737.30769667045, -25678.96459864703, -25730.000865931677, -25944.927787284018, -25798.500653704446, -25548.90054753863, -25587.786097460936, -25688.644517865163, -25464.608163331468, -25864.021290339366, -25885.91731411878, -25553.700367281243, -26042.408552654564, -25602.224455599582, -25765.828737911692, -25687.931787524136, -25647.751173520413, -25708.912178971168, -25823.99841316268, -25832.175491726637, -25554.266391473473, -25959.410281017565, -25690.837084897732, -25402.97920299653, -25762.143345042303, -25758.082480843907, -25553.59971194014, -25798.768777476813, -25751.632972563755], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.541349532814456, "mean_inference_ms": 0.25359159599737224, "mean_action_processing_ms": 0.06033505418828101, "mean_env_wait_ms": 1.5009062912049784, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0033636093139648438, "StateBufferConnector_ms": 0.002503633499145508, "ViewRequirementAgentConnector_ms": 0.06300473213195801}}, "episode_reward_max": -25345.672421099924, "episode_reward_min": -26105.435092812302, "episode_reward_mean": -25762.226740562593, "episode_len_mean": 360.0, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-25974.699021005083, -25790.845880610497, -25869.96738063129, -25810.069398333406, -25953.65395615741, -25815.451167885232, -25819.739158543565, -26026.27184238485, -26083.733153869016, -25758.136060547233, -25967.78515157466, -25660.300063580053, -25705.08482519234, -26102.14806445665, -25797.349811932254, -25781.579667060716, -25868.398999251014, -25529.3090589514, -25807.03109847257, -25902.754923447952, -25639.988495218277, -25519.349602989754, -25619.05502207858, -25891.1413734565, -25871.921132023614, -25571.612840771653, -26033.929002990495, -25968.70702087451, -25753.59731625539, -25345.672421099924, -25734.096507738315, -25955.573889103773, -25811.43468690695, -25757.650316806128, -26102.10048345207, -25707.737809963204, -25498.861591433688, -25792.569799139757, -25891.087779099707, -25939.916820663995, -25759.14015205737, -25762.77959591386, -25704.311257363963, -25815.26912545352, -25700.99265257654, -25637.371647749467, -25585.901797595612, -25743.78194530946, -25730.88118511566, -25693.754176045648, -25698.066298154874, -25756.51197157061, -25905.5706532299, -25980.36756481758, -25393.582456681695, -25827.103134906156, -25646.06684443742, -25631.552966078983, -25399.489287253382, -25958.460820273434, -25862.615523121418, -25784.877557646454, -25520.706181154666, -25602.665316442188, -25778.991024729174, -25844.319635697706, -25968.00378102244, -25599.63654565638, -26105.435092812302, -25720.035707131035, -25847.888622810693, -25737.30769667045, -25678.96459864703, -25730.000865931677, -25944.927787284018, -25798.500653704446, -25548.90054753863, -25587.786097460936, -25688.644517865163, -25464.608163331468, -25864.021290339366, -25885.91731411878, -25553.700367281243, -26042.408552654564, -25602.224455599582, -25765.828737911692, -25687.931787524136, -25647.751173520413, -25708.912178971168, -25823.99841316268, -25832.175491726637, -25554.266391473473, -25959.410281017565, -25690.837084897732, -25402.97920299653, -25762.143345042303, -25758.082480843907, -25553.59971194014, -25798.768777476813, -25751.632972563755], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.541349532814456, "mean_inference_ms": 0.25359159599737224, "mean_action_processing_ms": 0.06033505418828101, "mean_env_wait_ms": 1.5009062912049784, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0033636093139648438, "StateBufferConnector_ms": 0.002503633499145508, "ViewRequirementAgentConnector_ms": 0.06300473213195801}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 223920, "num_agent_steps_trained": 223920, "num_env_steps_sampled": 223920, "num_env_steps_trained": 223920, "num_env_steps_sampled_this_iter": 1080, "num_env_steps_trained_this_iter": 1080, "num_env_steps_sampled_throughput_per_sec": 95.11984062840497, "num_env_steps_trained_throughput_per_sec": 95.11984062840497, "timesteps_total": 223920, "num_steps_trained_this_iter": 1080, "agent_timesteps_total": 223920, "timers": {"training_iteration_time_ms": 3821.341, "sample_time_ms": 3810.216, "load_time_ms": 0.317, "load_throughput": 1134617.854, "learn_time_ms": 10.006, "learn_throughput": 35977.818, "synch_weights_time_ms": 0.75}, "counters": {"num_env_steps_sampled": 223920, "num_env_steps_trained": 223920, "num_agent_steps_sampled": 223920, "num_agent_steps_trained": 223920}, "done": false, "episodes_total": 622, "training_iteration": 134, "trial_id": "f5e97_00000", "date": "2023-07-25_17-20-57", "timestamp": 1690294857, "time_this_iter_s": 11.356950998306274, "time_total_s": 1501.111531496048, "pid": 71917, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[0, 0.003], [5400, 0.001], [10800, 0.00075], [16200, 0.0005], [21600, 0.00025], [27000, 0.0001], [32400, 7.5e-05], [37800, 5e-05], [43200, 2.5e-05], [48600, 1e-05], [54000, 7.5e-06], [59400, 5e-06], [64800, 2.5e-06], [70200, 1e-06], [75600, 5e-07], [81000, 1e-07]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x304530310>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1501.111531496048, "iterations_since_restore": 134, "perf": {"cpu_util_percent": 22.19375, "ram_util_percent": 79.25}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-07, "entropy_coeff": 0.1, "policy_entropy": -926.6999633789062, "policy_loss": -22492602413875.2, "vf_loss": 1106197606.4}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 3123.0, "diff_num_grad_updates_vs_sampler_policy": 3122.0}}, "num_env_steps_sampled": 225000, "num_env_steps_trained": 225000, "num_agent_steps_sampled": 225000, "num_agent_steps_trained": 225000}, "sampler_results": {"episode_reward_max": -25345.672421099924, "episode_reward_min": -26105.435092812302, "episode_reward_mean": -25757.757101467792, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-25810.069398333406, -25953.65395615741, -25815.451167885232, -25819.739158543565, -26026.27184238485, -26083.733153869016, -25758.136060547233, -25967.78515157466, -25660.300063580053, -25705.08482519234, -26102.14806445665, -25797.349811932254, -25781.579667060716, -25868.398999251014, -25529.3090589514, -25807.03109847257, -25902.754923447952, -25639.988495218277, -25519.349602989754, -25619.05502207858, -25891.1413734565, -25871.921132023614, -25571.612840771653, -26033.929002990495, -25968.70702087451, -25753.59731625539, -25345.672421099924, -25734.096507738315, -25955.573889103773, -25811.43468690695, -25757.650316806128, -26102.10048345207, -25707.737809963204, -25498.861591433688, -25792.569799139757, -25891.087779099707, -25939.916820663995, -25759.14015205737, -25762.77959591386, -25704.311257363963, -25815.26912545352, -25700.99265257654, -25637.371647749467, -25585.901797595612, -25743.78194530946, -25730.88118511566, -25693.754176045648, -25698.066298154874, -25756.51197157061, -25905.5706532299, -25980.36756481758, -25393.582456681695, -25827.103134906156, -25646.06684443742, -25631.552966078983, -25399.489287253382, -25958.460820273434, -25862.615523121418, -25784.877557646454, -25520.706181154666, -25602.665316442188, -25778.991024729174, -25844.319635697706, -25968.00378102244, -25599.63654565638, -26105.435092812302, -25720.035707131035, -25847.888622810693, -25737.30769667045, -25678.96459864703, -25730.000865931677, -25944.927787284018, -25798.500653704446, -25548.90054753863, -25587.786097460936, -25688.644517865163, -25464.608163331468, -25864.021290339366, -25885.91731411878, -25553.700367281243, -26042.408552654564, -25602.224455599582, -25765.828737911692, -25687.931787524136, -25647.751173520413, -25708.912178971168, -25823.99841316268, -25832.175491726637, -25554.266391473473, -25959.410281017565, -25690.837084897732, -25402.97920299653, -25762.143345042303, -25758.082480843907, -25553.59971194014, -25798.768777476813, -25751.632972563755, -25762.996505865038, -25635.40099255635, -25790.150874345392], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.55260415494074, "mean_inference_ms": 0.2541366165490365, "mean_action_processing_ms": 0.06046640261501257, "mean_env_wait_ms": 1.5044573222233537, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0034112930297851562, "StateBufferConnector_ms": 0.0025343894958496094, "ViewRequirementAgentConnector_ms": 0.06363439559936523}}, "episode_reward_max": -25345.672421099924, "episode_reward_min": -26105.435092812302, "episode_reward_mean": -25757.757101467792, "episode_len_mean": 360.0, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-25810.069398333406, -25953.65395615741, -25815.451167885232, -25819.739158543565, -26026.27184238485, -26083.733153869016, -25758.136060547233, -25967.78515157466, -25660.300063580053, -25705.08482519234, -26102.14806445665, -25797.349811932254, -25781.579667060716, -25868.398999251014, -25529.3090589514, -25807.03109847257, -25902.754923447952, -25639.988495218277, -25519.349602989754, -25619.05502207858, -25891.1413734565, -25871.921132023614, -25571.612840771653, -26033.929002990495, -25968.70702087451, -25753.59731625539, -25345.672421099924, -25734.096507738315, -25955.573889103773, -25811.43468690695, -25757.650316806128, -26102.10048345207, -25707.737809963204, -25498.861591433688, -25792.569799139757, -25891.087779099707, -25939.916820663995, -25759.14015205737, -25762.77959591386, -25704.311257363963, -25815.26912545352, -25700.99265257654, -25637.371647749467, -25585.901797595612, -25743.78194530946, -25730.88118511566, -25693.754176045648, -25698.066298154874, -25756.51197157061, -25905.5706532299, -25980.36756481758, -25393.582456681695, -25827.103134906156, -25646.06684443742, -25631.552966078983, -25399.489287253382, -25958.460820273434, -25862.615523121418, -25784.877557646454, -25520.706181154666, -25602.665316442188, -25778.991024729174, -25844.319635697706, -25968.00378102244, -25599.63654565638, -26105.435092812302, -25720.035707131035, -25847.888622810693, -25737.30769667045, -25678.96459864703, -25730.000865931677, -25944.927787284018, -25798.500653704446, -25548.90054753863, -25587.786097460936, -25688.644517865163, -25464.608163331468, -25864.021290339366, -25885.91731411878, -25553.700367281243, -26042.408552654564, -25602.224455599582, -25765.828737911692, -25687.931787524136, -25647.751173520413, -25708.912178971168, -25823.99841316268, -25832.175491726637, -25554.266391473473, -25959.410281017565, -25690.837084897732, -25402.97920299653, -25762.143345042303, -25758.082480843907, -25553.59971194014, -25798.768777476813, -25751.632972563755, -25762.996505865038, -25635.40099255635, -25790.150874345392], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.55260415494074, "mean_inference_ms": 0.2541366165490365, "mean_action_processing_ms": 0.06046640261501257, "mean_env_wait_ms": 1.5044573222233537, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0034112930297851562, "StateBufferConnector_ms": 0.0025343894958496094, "ViewRequirementAgentConnector_ms": 0.06363439559936523}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 225000, "num_agent_steps_trained": 225000, "num_env_steps_sampled": 225000, "num_env_steps_trained": 225000, "num_env_steps_sampled_this_iter": 1080, "num_env_steps_trained_this_iter": 1080, "num_env_steps_sampled_throughput_per_sec": 95.77802502820683, "num_env_steps_trained_throughput_per_sec": 95.77802502820683, "timesteps_total": 225000, "num_steps_trained_this_iter": 1080, "agent_timesteps_total": 225000, "timers": {"training_iteration_time_ms": 3761.912, "sample_time_ms": 3750.919, "load_time_ms": 0.307, "load_throughput": 1174235.508, "learn_time_ms": 9.911, "learn_throughput": 36323.406, "synch_weights_time_ms": 0.725}, "counters": {"num_env_steps_sampled": 225000, "num_env_steps_trained": 225000, "num_agent_steps_sampled": 225000, "num_agent_steps_trained": 225000}, "done": false, "episodes_total": 625, "training_iteration": 135, "trial_id": "f5e97_00000", "date": "2023-07-25_17-21-08", "timestamp": 1690294868, "time_this_iter_s": 11.278834104537964, "time_total_s": 1512.390365600586, "pid": 71917, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[0, 0.003], [5400, 0.001], [10800, 0.00075], [16200, 0.0005], [21600, 0.00025], [27000, 0.0001], [32400, 7.5e-05], [37800, 5e-05], [43200, 2.5e-05], [48600, 1e-05], [54000, 7.5e-06], [59400, 5e-06], [64800, 2.5e-06], [70200, 1e-06], [75600, 5e-07], [81000, 1e-07]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x304530310>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1512.390365600586, "iterations_since_restore": 135, "perf": {"cpu_util_percent": 24.581249999999997, "ram_util_percent": 79.09375}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-07, "entropy_coeff": 0.1, "policy_entropy": -926.7000610351563, "policy_loss": -19944736341196.8, "vf_loss": 1085092211.2}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 3138.0, "diff_num_grad_updates_vs_sampler_policy": 3137.0}}, "num_env_steps_sampled": 226080, "num_env_steps_trained": 226080, "num_agent_steps_sampled": 226080, "num_agent_steps_trained": 226080}, "sampler_results": {"episode_reward_max": -25345.672421099924, "episode_reward_min": -26105.435092812302, "episode_reward_mean": -25753.928043198288, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-25819.739158543565, -26026.27184238485, -26083.733153869016, -25758.136060547233, -25967.78515157466, -25660.300063580053, -25705.08482519234, -26102.14806445665, -25797.349811932254, -25781.579667060716, -25868.398999251014, -25529.3090589514, -25807.03109847257, -25902.754923447952, -25639.988495218277, -25519.349602989754, -25619.05502207858, -25891.1413734565, -25871.921132023614, -25571.612840771653, -26033.929002990495, -25968.70702087451, -25753.59731625539, -25345.672421099924, -25734.096507738315, -25955.573889103773, -25811.43468690695, -25757.650316806128, -26102.10048345207, -25707.737809963204, -25498.861591433688, -25792.569799139757, -25891.087779099707, -25939.916820663995, -25759.14015205737, -25762.77959591386, -25704.311257363963, -25815.26912545352, -25700.99265257654, -25637.371647749467, -25585.901797595612, -25743.78194530946, -25730.88118511566, -25693.754176045648, -25698.066298154874, -25756.51197157061, -25905.5706532299, -25980.36756481758, -25393.582456681695, -25827.103134906156, -25646.06684443742, -25631.552966078983, -25399.489287253382, -25958.460820273434, -25862.615523121418, -25784.877557646454, -25520.706181154666, -25602.665316442188, -25778.991024729174, -25844.319635697706, -25968.00378102244, -25599.63654565638, -26105.435092812302, -25720.035707131035, -25847.888622810693, -25737.30769667045, -25678.96459864703, -25730.000865931677, -25944.927787284018, -25798.500653704446, -25548.90054753863, -25587.786097460936, -25688.644517865163, -25464.608163331468, -25864.021290339366, -25885.91731411878, -25553.700367281243, -26042.408552654564, -25602.224455599582, -25765.828737911692, -25687.931787524136, -25647.751173520413, -25708.912178971168, -25823.99841316268, -25832.175491726637, -25554.266391473473, -25959.410281017565, -25690.837084897732, -25402.97920299653, -25762.143345042303, -25758.082480843907, -25553.59971194014, -25798.768777476813, -25751.632972563755, -25762.996505865038, -25635.40099255635, -25790.150874345392, -25714.420763199465, -25898.81545949767, -25583.032472728108], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.564233617242556, "mean_inference_ms": 0.25469925514208613, "mean_action_processing_ms": 0.06060211833292637, "mean_env_wait_ms": 1.5081286837392034, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0034437179565429688, "StateBufferConnector_ms": 0.002557992935180664, "ViewRequirementAgentConnector_ms": 0.06422805786132812}}, "episode_reward_max": -25345.672421099924, "episode_reward_min": -26105.435092812302, "episode_reward_mean": -25753.928043198288, "episode_len_mean": 360.0, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-25819.739158543565, -26026.27184238485, -26083.733153869016, -25758.136060547233, -25967.78515157466, -25660.300063580053, -25705.08482519234, -26102.14806445665, -25797.349811932254, -25781.579667060716, -25868.398999251014, -25529.3090589514, -25807.03109847257, -25902.754923447952, -25639.988495218277, -25519.349602989754, -25619.05502207858, -25891.1413734565, -25871.921132023614, -25571.612840771653, -26033.929002990495, -25968.70702087451, -25753.59731625539, -25345.672421099924, -25734.096507738315, -25955.573889103773, -25811.43468690695, -25757.650316806128, -26102.10048345207, -25707.737809963204, -25498.861591433688, -25792.569799139757, -25891.087779099707, -25939.916820663995, -25759.14015205737, -25762.77959591386, -25704.311257363963, -25815.26912545352, -25700.99265257654, -25637.371647749467, -25585.901797595612, -25743.78194530946, -25730.88118511566, -25693.754176045648, -25698.066298154874, -25756.51197157061, -25905.5706532299, -25980.36756481758, -25393.582456681695, -25827.103134906156, -25646.06684443742, -25631.552966078983, -25399.489287253382, -25958.460820273434, -25862.615523121418, -25784.877557646454, -25520.706181154666, -25602.665316442188, -25778.991024729174, -25844.319635697706, -25968.00378102244, -25599.63654565638, -26105.435092812302, -25720.035707131035, -25847.888622810693, -25737.30769667045, -25678.96459864703, -25730.000865931677, -25944.927787284018, -25798.500653704446, -25548.90054753863, -25587.786097460936, -25688.644517865163, -25464.608163331468, -25864.021290339366, -25885.91731411878, -25553.700367281243, -26042.408552654564, -25602.224455599582, -25765.828737911692, -25687.931787524136, -25647.751173520413, -25708.912178971168, -25823.99841316268, -25832.175491726637, -25554.266391473473, -25959.410281017565, -25690.837084897732, -25402.97920299653, -25762.143345042303, -25758.082480843907, -25553.59971194014, -25798.768777476813, -25751.632972563755, -25762.996505865038, -25635.40099255635, -25790.150874345392, -25714.420763199465, -25898.81545949767, -25583.032472728108], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.564233617242556, "mean_inference_ms": 0.25469925514208613, "mean_action_processing_ms": 0.06060211833292637, "mean_env_wait_ms": 1.5081286837392034, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0034437179565429688, "StateBufferConnector_ms": 0.002557992935180664, "ViewRequirementAgentConnector_ms": 0.06422805786132812}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 226080, "num_agent_steps_trained": 226080, "num_env_steps_sampled": 226080, "num_env_steps_trained": 226080, "num_env_steps_sampled_this_iter": 1080, "num_env_steps_trained_this_iter": 1080, "num_env_steps_sampled_throughput_per_sec": 96.37433402147904, "num_env_steps_trained_throughput_per_sec": 96.37433402147904, "timesteps_total": 226080, "num_steps_trained_this_iter": 1080, "agent_timesteps_total": 226080, "timers": {"training_iteration_time_ms": 3758.812, "sample_time_ms": 3748.014, "load_time_ms": 0.299, "load_throughput": 1204202.44, "learn_time_ms": 9.746, "learn_throughput": 36939.394, "synch_weights_time_ms": 0.712}, "counters": {"num_env_steps_sampled": 226080, "num_env_steps_trained": 226080, "num_agent_steps_sampled": 226080, "num_agent_steps_trained": 226080}, "done": false, "episodes_total": 628, "training_iteration": 136, "trial_id": "f5e97_00000", "date": "2023-07-25_17-21-19", "timestamp": 1690294879, "time_this_iter_s": 11.209072828292847, "time_total_s": 1523.5994384288788, "pid": 71917, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[0, 0.003], [5400, 0.001], [10800, 0.00075], [16200, 0.0005], [21600, 0.00025], [27000, 0.0001], [32400, 7.5e-05], [37800, 5e-05], [43200, 2.5e-05], [48600, 1e-05], [54000, 7.5e-06], [59400, 5e-06], [64800, 2.5e-06], [70200, 1e-06], [75600, 5e-07], [81000, 1e-07]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x304530310>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1523.5994384288788, "iterations_since_restore": 136, "perf": {"cpu_util_percent": 24.6, "ram_util_percent": 79.0125}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-07, "entropy_coeff": 0.1, "policy_entropy": -926.6996826171875, "policy_loss": -37424053750988.8, "vf_loss": 1117248889.6}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 3153.0, "diff_num_grad_updates_vs_sampler_policy": 3152.0}}, "num_env_steps_sampled": 227160, "num_env_steps_trained": 227160, "num_agent_steps_sampled": 227160, "num_agent_steps_trained": 227160}, "sampler_results": {"episode_reward_max": -25345.672421099924, "episode_reward_min": -26105.435092812302, "episode_reward_mean": -25751.04582808117, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-25758.136060547233, -25967.78515157466, -25660.300063580053, -25705.08482519234, -26102.14806445665, -25797.349811932254, -25781.579667060716, -25868.398999251014, -25529.3090589514, -25807.03109847257, -25902.754923447952, -25639.988495218277, -25519.349602989754, -25619.05502207858, -25891.1413734565, -25871.921132023614, -25571.612840771653, -26033.929002990495, -25968.70702087451, -25753.59731625539, -25345.672421099924, -25734.096507738315, -25955.573889103773, -25811.43468690695, -25757.650316806128, -26102.10048345207, -25707.737809963204, -25498.861591433688, -25792.569799139757, -25891.087779099707, -25939.916820663995, -25759.14015205737, -25762.77959591386, -25704.311257363963, -25815.26912545352, -25700.99265257654, -25637.371647749467, -25585.901797595612, -25743.78194530946, -25730.88118511566, -25693.754176045648, -25698.066298154874, -25756.51197157061, -25905.5706532299, -25980.36756481758, -25393.582456681695, -25827.103134906156, -25646.06684443742, -25631.552966078983, -25399.489287253382, -25958.460820273434, -25862.615523121418, -25784.877557646454, -25520.706181154666, -25602.665316442188, -25778.991024729174, -25844.319635697706, -25968.00378102244, -25599.63654565638, -26105.435092812302, -25720.035707131035, -25847.888622810693, -25737.30769667045, -25678.96459864703, -25730.000865931677, -25944.927787284018, -25798.500653704446, -25548.90054753863, -25587.786097460936, -25688.644517865163, -25464.608163331468, -25864.021290339366, -25885.91731411878, -25553.700367281243, -26042.408552654564, -25602.224455599582, -25765.828737911692, -25687.931787524136, -25647.751173520413, -25708.912178971168, -25823.99841316268, -25832.175491726637, -25554.266391473473, -25959.410281017565, -25690.837084897732, -25402.97920299653, -25762.143345042303, -25758.082480843907, -25553.59971194014, -25798.768777476813, -25751.632972563755, -25762.996505865038, -25635.40099255635, -25790.150874345392, -25714.420763199465, -25898.81545949767, -25583.032472728108, -25599.747136461963, -26080.25220475557, -25961.523301868016], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.57624180563358, "mean_inference_ms": 0.2552786605534004, "mean_action_processing_ms": 0.06074206748568971, "mean_env_wait_ms": 1.5119212401438378, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0034818649291992188, "StateBufferConnector_ms": 0.0025835037231445312, "ViewRequirementAgentConnector_ms": 0.06489920616149902}}, "episode_reward_max": -25345.672421099924, "episode_reward_min": -26105.435092812302, "episode_reward_mean": -25751.04582808117, "episode_len_mean": 360.0, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-25758.136060547233, -25967.78515157466, -25660.300063580053, -25705.08482519234, -26102.14806445665, -25797.349811932254, -25781.579667060716, -25868.398999251014, -25529.3090589514, -25807.03109847257, -25902.754923447952, -25639.988495218277, -25519.349602989754, -25619.05502207858, -25891.1413734565, -25871.921132023614, -25571.612840771653, -26033.929002990495, -25968.70702087451, -25753.59731625539, -25345.672421099924, -25734.096507738315, -25955.573889103773, -25811.43468690695, -25757.650316806128, -26102.10048345207, -25707.737809963204, -25498.861591433688, -25792.569799139757, -25891.087779099707, -25939.916820663995, -25759.14015205737, -25762.77959591386, -25704.311257363963, -25815.26912545352, -25700.99265257654, -25637.371647749467, -25585.901797595612, -25743.78194530946, -25730.88118511566, -25693.754176045648, -25698.066298154874, -25756.51197157061, -25905.5706532299, -25980.36756481758, -25393.582456681695, -25827.103134906156, -25646.06684443742, -25631.552966078983, -25399.489287253382, -25958.460820273434, -25862.615523121418, -25784.877557646454, -25520.706181154666, -25602.665316442188, -25778.991024729174, -25844.319635697706, -25968.00378102244, -25599.63654565638, -26105.435092812302, -25720.035707131035, -25847.888622810693, -25737.30769667045, -25678.96459864703, -25730.000865931677, -25944.927787284018, -25798.500653704446, -25548.90054753863, -25587.786097460936, -25688.644517865163, -25464.608163331468, -25864.021290339366, -25885.91731411878, -25553.700367281243, -26042.408552654564, -25602.224455599582, -25765.828737911692, -25687.931787524136, -25647.751173520413, -25708.912178971168, -25823.99841316268, -25832.175491726637, -25554.266391473473, -25959.410281017565, -25690.837084897732, -25402.97920299653, -25762.143345042303, -25758.082480843907, -25553.59971194014, -25798.768777476813, -25751.632972563755, -25762.996505865038, -25635.40099255635, -25790.150874345392, -25714.420763199465, -25898.81545949767, -25583.032472728108, -25599.747136461963, -26080.25220475557, -25961.523301868016], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.57624180563358, "mean_inference_ms": 0.2552786605534004, "mean_action_processing_ms": 0.06074206748568971, "mean_env_wait_ms": 1.5119212401438378, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0034818649291992188, "StateBufferConnector_ms": 0.0025835037231445312, "ViewRequirementAgentConnector_ms": 0.06489920616149902}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 227160, "num_agent_steps_trained": 227160, "num_env_steps_sampled": 227160, "num_env_steps_trained": 227160, "num_env_steps_sampled_this_iter": 1080, "num_env_steps_trained_this_iter": 1080, "num_env_steps_sampled_throughput_per_sec": 96.1476388150954, "num_env_steps_trained_throughput_per_sec": 96.1476388150954, "timesteps_total": 227160, "num_steps_trained_this_iter": 1080, "agent_timesteps_total": 227160, "timers": {"training_iteration_time_ms": 3756.95, "sample_time_ms": 3746.132, "load_time_ms": 0.298, "load_throughput": 1206511.738, "learn_time_ms": 9.77, "learn_throughput": 36847.447, "synch_weights_time_ms": 0.707}, "counters": {"num_env_steps_sampled": 227160, "num_env_steps_trained": 227160, "num_agent_steps_sampled": 227160, "num_agent_steps_trained": 227160}, "done": false, "episodes_total": 631, "training_iteration": 137, "trial_id": "f5e97_00000", "date": "2023-07-25_17-21-30", "timestamp": 1690294890, "time_this_iter_s": 11.235662937164307, "time_total_s": 1534.835101366043, "pid": 71917, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[0, 0.003], [5400, 0.001], [10800, 0.00075], [16200, 0.0005], [21600, 0.00025], [27000, 0.0001], [32400, 7.5e-05], [37800, 5e-05], [43200, 2.5e-05], [48600, 1e-05], [54000, 7.5e-06], [59400, 5e-06], [64800, 2.5e-06], [70200, 1e-06], [75600, 5e-07], [81000, 1e-07]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x304530310>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1534.835101366043, "iterations_since_restore": 137, "perf": {"cpu_util_percent": 24.4, "ram_util_percent": 78.78750000000001}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-07, "entropy_coeff": 0.1, "policy_entropy": -926.7000732421875, "policy_loss": -31364969214771.2, "vf_loss": 1085418752.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 3168.0, "diff_num_grad_updates_vs_sampler_policy": 3167.0}}, "num_env_steps_sampled": 228240, "num_env_steps_trained": 228240, "num_agent_steps_sampled": 228240, "num_agent_steps_trained": 228240}, "sampler_results": {"episode_reward_max": -25345.672421099924, "episode_reward_min": -26105.435092812302, "episode_reward_mean": -25746.649192995657, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-25705.08482519234, -26102.14806445665, -25797.349811932254, -25781.579667060716, -25868.398999251014, -25529.3090589514, -25807.03109847257, -25902.754923447952, -25639.988495218277, -25519.349602989754, -25619.05502207858, -25891.1413734565, -25871.921132023614, -25571.612840771653, -26033.929002990495, -25968.70702087451, -25753.59731625539, -25345.672421099924, -25734.096507738315, -25955.573889103773, -25811.43468690695, -25757.650316806128, -26102.10048345207, -25707.737809963204, -25498.861591433688, -25792.569799139757, -25891.087779099707, -25939.916820663995, -25759.14015205737, -25762.77959591386, -25704.311257363963, -25815.26912545352, -25700.99265257654, -25637.371647749467, -25585.901797595612, -25743.78194530946, -25730.88118511566, -25693.754176045648, -25698.066298154874, -25756.51197157061, -25905.5706532299, -25980.36756481758, -25393.582456681695, -25827.103134906156, -25646.06684443742, -25631.552966078983, -25399.489287253382, -25958.460820273434, -25862.615523121418, -25784.877557646454, -25520.706181154666, -25602.665316442188, -25778.991024729174, -25844.319635697706, -25968.00378102244, -25599.63654565638, -26105.435092812302, -25720.035707131035, -25847.888622810693, -25737.30769667045, -25678.96459864703, -25730.000865931677, -25944.927787284018, -25798.500653704446, -25548.90054753863, -25587.786097460936, -25688.644517865163, -25464.608163331468, -25864.021290339366, -25885.91731411878, -25553.700367281243, -26042.408552654564, -25602.224455599582, -25765.828737911692, -25687.931787524136, -25647.751173520413, -25708.912178971168, -25823.99841316268, -25832.175491726637, -25554.266391473473, -25959.410281017565, -25690.837084897732, -25402.97920299653, -25762.143345042303, -25758.082480843907, -25553.59971194014, -25798.768777476813, -25751.632972563755, -25762.996505865038, -25635.40099255635, -25790.150874345392, -25714.420763199465, -25898.81545949767, -25583.032472728108, -25599.747136461963, -26080.25220475557, -25961.523301868016, -25680.131995975335, -25704.700582997753, -25561.725188177534], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.588606957023838, "mean_inference_ms": 0.2558746625822158, "mean_action_processing_ms": 0.06088620531810585, "mean_env_wait_ms": 1.515834126263603, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0035097599029541016, "StateBufferConnector_ms": 0.002614736557006836, "ViewRequirementAgentConnector_ms": 0.06556320190429688}}, "episode_reward_max": -25345.672421099924, "episode_reward_min": -26105.435092812302, "episode_reward_mean": -25746.649192995657, "episode_len_mean": 360.0, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-25705.08482519234, -26102.14806445665, -25797.349811932254, -25781.579667060716, -25868.398999251014, -25529.3090589514, -25807.03109847257, -25902.754923447952, -25639.988495218277, -25519.349602989754, -25619.05502207858, -25891.1413734565, -25871.921132023614, -25571.612840771653, -26033.929002990495, -25968.70702087451, -25753.59731625539, -25345.672421099924, -25734.096507738315, -25955.573889103773, -25811.43468690695, -25757.650316806128, -26102.10048345207, -25707.737809963204, -25498.861591433688, -25792.569799139757, -25891.087779099707, -25939.916820663995, -25759.14015205737, -25762.77959591386, -25704.311257363963, -25815.26912545352, -25700.99265257654, -25637.371647749467, -25585.901797595612, -25743.78194530946, -25730.88118511566, -25693.754176045648, -25698.066298154874, -25756.51197157061, -25905.5706532299, -25980.36756481758, -25393.582456681695, -25827.103134906156, -25646.06684443742, -25631.552966078983, -25399.489287253382, -25958.460820273434, -25862.615523121418, -25784.877557646454, -25520.706181154666, -25602.665316442188, -25778.991024729174, -25844.319635697706, -25968.00378102244, -25599.63654565638, -26105.435092812302, -25720.035707131035, -25847.888622810693, -25737.30769667045, -25678.96459864703, -25730.000865931677, -25944.927787284018, -25798.500653704446, -25548.90054753863, -25587.786097460936, -25688.644517865163, -25464.608163331468, -25864.021290339366, -25885.91731411878, -25553.700367281243, -26042.408552654564, -25602.224455599582, -25765.828737911692, -25687.931787524136, -25647.751173520413, -25708.912178971168, -25823.99841316268, -25832.175491726637, -25554.266391473473, -25959.410281017565, -25690.837084897732, -25402.97920299653, -25762.143345042303, -25758.082480843907, -25553.59971194014, -25798.768777476813, -25751.632972563755, -25762.996505865038, -25635.40099255635, -25790.150874345392, -25714.420763199465, -25898.81545949767, -25583.032472728108, -25599.747136461963, -26080.25220475557, -25961.523301868016, -25680.131995975335, -25704.700582997753, -25561.725188177534], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.588606957023838, "mean_inference_ms": 0.2558746625822158, "mean_action_processing_ms": 0.06088620531810585, "mean_env_wait_ms": 1.515834126263603, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0035097599029541016, "StateBufferConnector_ms": 0.002614736557006836, "ViewRequirementAgentConnector_ms": 0.06556320190429688}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 228240, "num_agent_steps_trained": 228240, "num_env_steps_sampled": 228240, "num_env_steps_trained": 228240, "num_env_steps_sampled_this_iter": 1080, "num_env_steps_trained_this_iter": 1080, "num_env_steps_sampled_throughput_per_sec": 97.30632509069608, "num_env_steps_trained_throughput_per_sec": 97.30632509069608, "timesteps_total": 228240, "num_steps_trained_this_iter": 1080, "agent_timesteps_total": 228240, "timers": {"training_iteration_time_ms": 3738.574, "sample_time_ms": 3727.79, "load_time_ms": 0.3, "load_throughput": 1199133.926, "learn_time_ms": 9.729, "learn_throughput": 37003.486, "synch_weights_time_ms": 0.712}, "counters": {"num_env_steps_sampled": 228240, "num_env_steps_trained": 228240, "num_agent_steps_sampled": 228240, "num_agent_steps_trained": 228240}, "done": false, "episodes_total": 634, "training_iteration": 138, "trial_id": "f5e97_00000", "date": "2023-07-25_17-21-41", "timestamp": 1690294901, "time_this_iter_s": 11.101693868637085, "time_total_s": 1545.9367952346802, "pid": 71917, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[0, 0.003], [5400, 0.001], [10800, 0.00075], [16200, 0.0005], [21600, 0.00025], [27000, 0.0001], [32400, 7.5e-05], [37800, 5e-05], [43200, 2.5e-05], [48600, 1e-05], [54000, 7.5e-06], [59400, 5e-06], [64800, 2.5e-06], [70200, 1e-06], [75600, 5e-07], [81000, 1e-07]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x304530310>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1545.9367952346802, "iterations_since_restore": 138, "perf": {"cpu_util_percent": 26.237500000000004, "ram_util_percent": 78.65625}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-07, "entropy_coeff": 0.1, "policy_entropy": -926.6997680664062, "policy_loss": -16007233735884.8, "vf_loss": 1119438924.8}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 3183.0, "diff_num_grad_updates_vs_sampler_policy": 3182.0}}, "num_env_steps_sampled": 229320, "num_env_steps_trained": 229320, "num_agent_steps_sampled": 229320, "num_agent_steps_trained": 229320}, "sampler_results": {"episode_reward_max": -25345.672421099924, "episode_reward_min": -26105.435092812302, "episode_reward_mean": -25745.220151904035, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-25781.579667060716, -25868.398999251014, -25529.3090589514, -25807.03109847257, -25902.754923447952, -25639.988495218277, -25519.349602989754, -25619.05502207858, -25891.1413734565, -25871.921132023614, -25571.612840771653, -26033.929002990495, -25968.70702087451, -25753.59731625539, -25345.672421099924, -25734.096507738315, -25955.573889103773, -25811.43468690695, -25757.650316806128, -26102.10048345207, -25707.737809963204, -25498.861591433688, -25792.569799139757, -25891.087779099707, -25939.916820663995, -25759.14015205737, -25762.77959591386, -25704.311257363963, -25815.26912545352, -25700.99265257654, -25637.371647749467, -25585.901797595612, -25743.78194530946, -25730.88118511566, -25693.754176045648, -25698.066298154874, -25756.51197157061, -25905.5706532299, -25980.36756481758, -25393.582456681695, -25827.103134906156, -25646.06684443742, -25631.552966078983, -25399.489287253382, -25958.460820273434, -25862.615523121418, -25784.877557646454, -25520.706181154666, -25602.665316442188, -25778.991024729174, -25844.319635697706, -25968.00378102244, -25599.63654565638, -26105.435092812302, -25720.035707131035, -25847.888622810693, -25737.30769667045, -25678.96459864703, -25730.000865931677, -25944.927787284018, -25798.500653704446, -25548.90054753863, -25587.786097460936, -25688.644517865163, -25464.608163331468, -25864.021290339366, -25885.91731411878, -25553.700367281243, -26042.408552654564, -25602.224455599582, -25765.828737911692, -25687.931787524136, -25647.751173520413, -25708.912178971168, -25823.99841316268, -25832.175491726637, -25554.266391473473, -25959.410281017565, -25690.837084897732, -25402.97920299653, -25762.143345042303, -25758.082480843907, -25553.59971194014, -25798.768777476813, -25751.632972563755, -25762.996505865038, -25635.40099255635, -25790.150874345392, -25714.420763199465, -25898.81545949767, -25583.032472728108, -25599.747136461963, -26080.25220475557, -25961.523301868016, -25680.131995975335, -25704.700582997753, -25561.725188177534, -26006.813883461164, -25473.365698160313, -25981.49901079789], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.6013171273060625, "mean_inference_ms": 0.2564850092834613, "mean_action_processing_ms": 0.06103409549818568, "mean_env_wait_ms": 1.5198178553462096, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0035462379455566406, "StateBufferConnector_ms": 0.002637624740600586, "ViewRequirementAgentConnector_ms": 0.06624007225036621}}, "episode_reward_max": -25345.672421099924, "episode_reward_min": -26105.435092812302, "episode_reward_mean": -25745.220151904035, "episode_len_mean": 360.0, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-25781.579667060716, -25868.398999251014, -25529.3090589514, -25807.03109847257, -25902.754923447952, -25639.988495218277, -25519.349602989754, -25619.05502207858, -25891.1413734565, -25871.921132023614, -25571.612840771653, -26033.929002990495, -25968.70702087451, -25753.59731625539, -25345.672421099924, -25734.096507738315, -25955.573889103773, -25811.43468690695, -25757.650316806128, -26102.10048345207, -25707.737809963204, -25498.861591433688, -25792.569799139757, -25891.087779099707, -25939.916820663995, -25759.14015205737, -25762.77959591386, -25704.311257363963, -25815.26912545352, -25700.99265257654, -25637.371647749467, -25585.901797595612, -25743.78194530946, -25730.88118511566, -25693.754176045648, -25698.066298154874, -25756.51197157061, -25905.5706532299, -25980.36756481758, -25393.582456681695, -25827.103134906156, -25646.06684443742, -25631.552966078983, -25399.489287253382, -25958.460820273434, -25862.615523121418, -25784.877557646454, -25520.706181154666, -25602.665316442188, -25778.991024729174, -25844.319635697706, -25968.00378102244, -25599.63654565638, -26105.435092812302, -25720.035707131035, -25847.888622810693, -25737.30769667045, -25678.96459864703, -25730.000865931677, -25944.927787284018, -25798.500653704446, -25548.90054753863, -25587.786097460936, -25688.644517865163, -25464.608163331468, -25864.021290339366, -25885.91731411878, -25553.700367281243, -26042.408552654564, -25602.224455599582, -25765.828737911692, -25687.931787524136, -25647.751173520413, -25708.912178971168, -25823.99841316268, -25832.175491726637, -25554.266391473473, -25959.410281017565, -25690.837084897732, -25402.97920299653, -25762.143345042303, -25758.082480843907, -25553.59971194014, -25798.768777476813, -25751.632972563755, -25762.996505865038, -25635.40099255635, -25790.150874345392, -25714.420763199465, -25898.81545949767, -25583.032472728108, -25599.747136461963, -26080.25220475557, -25961.523301868016, -25680.131995975335, -25704.700582997753, -25561.725188177534, -26006.813883461164, -25473.365698160313, -25981.49901079789], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.6013171273060625, "mean_inference_ms": 0.2564850092834613, "mean_action_processing_ms": 0.06103409549818568, "mean_env_wait_ms": 1.5198178553462096, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0035462379455566406, "StateBufferConnector_ms": 0.002637624740600586, "ViewRequirementAgentConnector_ms": 0.06624007225036621}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 229320, "num_agent_steps_trained": 229320, "num_env_steps_sampled": 229320, "num_env_steps_trained": 229320, "num_env_steps_sampled_this_iter": 1080, "num_env_steps_trained_this_iter": 1080, "num_env_steps_sampled_throughput_per_sec": 96.88449082736223, "num_env_steps_trained_throughput_per_sec": 96.88449082736223, "timesteps_total": 229320, "num_steps_trained_this_iter": 1080, "agent_timesteps_total": 229320, "timers": {"training_iteration_time_ms": 3739.569, "sample_time_ms": 3728.839, "load_time_ms": 0.299, "load_throughput": 1203818.417, "learn_time_ms": 9.668, "learn_throughput": 37237.282, "synch_weights_time_ms": 0.721}, "counters": {"num_env_steps_sampled": 229320, "num_env_steps_trained": 229320, "num_agent_steps_sampled": 229320, "num_agent_steps_trained": 229320}, "done": false, "episodes_total": 637, "training_iteration": 139, "trial_id": "f5e97_00000", "date": "2023-07-25_17-21-53", "timestamp": 1690294913, "time_this_iter_s": 11.150094985961914, "time_total_s": 1557.086890220642, "pid": 71917, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[0, 0.003], [5400, 0.001], [10800, 0.00075], [16200, 0.0005], [21600, 0.00025], [27000, 0.0001], [32400, 7.5e-05], [37800, 5e-05], [43200, 2.5e-05], [48600, 1e-05], [54000, 7.5e-06], [59400, 5e-06], [64800, 2.5e-06], [70200, 1e-06], [75600, 5e-07], [81000, 1e-07]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x304530310>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1557.086890220642, "iterations_since_restore": 139, "perf": {"cpu_util_percent": 26.4625, "ram_util_percent": 78.75}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-07, "entropy_coeff": 0.1, "policy_entropy": -926.700048828125, "policy_loss": -33797647014297.6, "vf_loss": 1098901926.4}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 3198.0, "diff_num_grad_updates_vs_sampler_policy": 3197.0}}, "num_env_steps_sampled": 230400, "num_env_steps_trained": 230400, "num_agent_steps_sampled": 230400, "num_agent_steps_trained": 230400}, "sampler_results": {"episode_reward_max": -25345.672421099924, "episode_reward_min": -26105.435092812302, "episode_reward_mean": -25744.523842862345, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-25807.03109847257, -25902.754923447952, -25639.988495218277, -25519.349602989754, -25619.05502207858, -25891.1413734565, -25871.921132023614, -25571.612840771653, -26033.929002990495, -25968.70702087451, -25753.59731625539, -25345.672421099924, -25734.096507738315, -25955.573889103773, -25811.43468690695, -25757.650316806128, -26102.10048345207, -25707.737809963204, -25498.861591433688, -25792.569799139757, -25891.087779099707, -25939.916820663995, -25759.14015205737, -25762.77959591386, -25704.311257363963, -25815.26912545352, -25700.99265257654, -25637.371647749467, -25585.901797595612, -25743.78194530946, -25730.88118511566, -25693.754176045648, -25698.066298154874, -25756.51197157061, -25905.5706532299, -25980.36756481758, -25393.582456681695, -25827.103134906156, -25646.06684443742, -25631.552966078983, -25399.489287253382, -25958.460820273434, -25862.615523121418, -25784.877557646454, -25520.706181154666, -25602.665316442188, -25778.991024729174, -25844.319635697706, -25968.00378102244, -25599.63654565638, -26105.435092812302, -25720.035707131035, -25847.888622810693, -25737.30769667045, -25678.96459864703, -25730.000865931677, -25944.927787284018, -25798.500653704446, -25548.90054753863, -25587.786097460936, -25688.644517865163, -25464.608163331468, -25864.021290339366, -25885.91731411878, -25553.700367281243, -26042.408552654564, -25602.224455599582, -25765.828737911692, -25687.931787524136, -25647.751173520413, -25708.912178971168, -25823.99841316268, -25832.175491726637, -25554.266391473473, -25959.410281017565, -25690.837084897732, -25402.97920299653, -25762.143345042303, -25758.082480843907, -25553.59971194014, -25798.768777476813, -25751.632972563755, -25762.996505865038, -25635.40099255635, -25790.150874345392, -25714.420763199465, -25898.81545949767, -25583.032472728108, -25599.747136461963, -26080.25220475557, -25961.523301868016, -25680.131995975335, -25704.700582997753, -25561.725188177534, -26006.813883461164, -25473.365698160313, -25981.49901079789, -25615.818742254272, -25774.966136668256, -25718.871942171663], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.614401320088004, "mean_inference_ms": 0.25711034876797134, "mean_action_processing_ms": 0.06118591116098166, "mean_env_wait_ms": 1.5239216310619739, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0035614967346191406, "StateBufferConnector_ms": 0.002655029296875, "ViewRequirementAgentConnector_ms": 0.06674456596374512}}, "episode_reward_max": -25345.672421099924, "episode_reward_min": -26105.435092812302, "episode_reward_mean": -25744.523842862345, "episode_len_mean": 360.0, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-25807.03109847257, -25902.754923447952, -25639.988495218277, -25519.349602989754, -25619.05502207858, -25891.1413734565, -25871.921132023614, -25571.612840771653, -26033.929002990495, -25968.70702087451, -25753.59731625539, -25345.672421099924, -25734.096507738315, -25955.573889103773, -25811.43468690695, -25757.650316806128, -26102.10048345207, -25707.737809963204, -25498.861591433688, -25792.569799139757, -25891.087779099707, -25939.916820663995, -25759.14015205737, -25762.77959591386, -25704.311257363963, -25815.26912545352, -25700.99265257654, -25637.371647749467, -25585.901797595612, -25743.78194530946, -25730.88118511566, -25693.754176045648, -25698.066298154874, -25756.51197157061, -25905.5706532299, -25980.36756481758, -25393.582456681695, -25827.103134906156, -25646.06684443742, -25631.552966078983, -25399.489287253382, -25958.460820273434, -25862.615523121418, -25784.877557646454, -25520.706181154666, -25602.665316442188, -25778.991024729174, -25844.319635697706, -25968.00378102244, -25599.63654565638, -26105.435092812302, -25720.035707131035, -25847.888622810693, -25737.30769667045, -25678.96459864703, -25730.000865931677, -25944.927787284018, -25798.500653704446, -25548.90054753863, -25587.786097460936, -25688.644517865163, -25464.608163331468, -25864.021290339366, -25885.91731411878, -25553.700367281243, -26042.408552654564, -25602.224455599582, -25765.828737911692, -25687.931787524136, -25647.751173520413, -25708.912178971168, -25823.99841316268, -25832.175491726637, -25554.266391473473, -25959.410281017565, -25690.837084897732, -25402.97920299653, -25762.143345042303, -25758.082480843907, -25553.59971194014, -25798.768777476813, -25751.632972563755, -25762.996505865038, -25635.40099255635, -25790.150874345392, -25714.420763199465, -25898.81545949767, -25583.032472728108, -25599.747136461963, -26080.25220475557, -25961.523301868016, -25680.131995975335, -25704.700582997753, -25561.725188177534, -26006.813883461164, -25473.365698160313, -25981.49901079789, -25615.818742254272, -25774.966136668256, -25718.871942171663], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.614401320088004, "mean_inference_ms": 0.25711034876797134, "mean_action_processing_ms": 0.06118591116098166, "mean_env_wait_ms": 1.5239216310619739, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0035614967346191406, "StateBufferConnector_ms": 0.002655029296875, "ViewRequirementAgentConnector_ms": 0.06674456596374512}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 230400, "num_agent_steps_trained": 230400, "num_env_steps_sampled": 230400, "num_env_steps_trained": 230400, "num_env_steps_sampled_this_iter": 1080, "num_env_steps_trained_this_iter": 1080, "num_env_steps_sampled_throughput_per_sec": 95.15961690606484, "num_env_steps_trained_throughput_per_sec": 95.15961690606484, "timesteps_total": 230400, "num_steps_trained_this_iter": 1080, "agent_timesteps_total": 230400, "timers": {"training_iteration_time_ms": 3737.441, "sample_time_ms": 3726.78, "load_time_ms": 0.297, "load_throughput": 1210477.345, "learn_time_ms": 9.614, "learn_throughput": 37445.799, "synch_weights_time_ms": 0.707}, "counters": {"num_env_steps_sampled": 230400, "num_env_steps_trained": 230400, "num_agent_steps_sampled": 230400, "num_agent_steps_trained": 230400}, "done": false, "episodes_total": 640, "training_iteration": 140, "trial_id": "f5e97_00000", "date": "2023-07-25_17-22-04", "timestamp": 1690294924, "time_this_iter_s": 11.35201907157898, "time_total_s": 1568.438909292221, "pid": 71917, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[0, 0.003], [5400, 0.001], [10800, 0.00075], [16200, 0.0005], [21600, 0.00025], [27000, 0.0001], [32400, 7.5e-05], [37800, 5e-05], [43200, 2.5e-05], [48600, 1e-05], [54000, 7.5e-06], [59400, 5e-06], [64800, 2.5e-06], [70200, 1e-06], [75600, 5e-07], [81000, 1e-07]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x304530310>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1568.438909292221, "iterations_since_restore": 140, "perf": {"cpu_util_percent": 23.887500000000003, "ram_util_percent": 78.7375}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-07, "entropy_coeff": 0.1, "policy_entropy": -926.6997436523437, "policy_loss": -27401011937280.0, "vf_loss": 1090085414.4}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 3213.0, "diff_num_grad_updates_vs_sampler_policy": 3212.0}}, "num_env_steps_sampled": 231480, "num_env_steps_trained": 231480, "num_agent_steps_sampled": 231480, "num_agent_steps_trained": 231480}, "sampler_results": {"episode_reward_max": -25345.672421099924, "episode_reward_min": -26105.435092812302, "episode_reward_mean": -25742.567611220165, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-25519.349602989754, -25619.05502207858, -25891.1413734565, -25871.921132023614, -25571.612840771653, -26033.929002990495, -25968.70702087451, -25753.59731625539, -25345.672421099924, -25734.096507738315, -25955.573889103773, -25811.43468690695, -25757.650316806128, -26102.10048345207, -25707.737809963204, -25498.861591433688, -25792.569799139757, -25891.087779099707, -25939.916820663995, -25759.14015205737, -25762.77959591386, -25704.311257363963, -25815.26912545352, -25700.99265257654, -25637.371647749467, -25585.901797595612, -25743.78194530946, -25730.88118511566, -25693.754176045648, -25698.066298154874, -25756.51197157061, -25905.5706532299, -25980.36756481758, -25393.582456681695, -25827.103134906156, -25646.06684443742, -25631.552966078983, -25399.489287253382, -25958.460820273434, -25862.615523121418, -25784.877557646454, -25520.706181154666, -25602.665316442188, -25778.991024729174, -25844.319635697706, -25968.00378102244, -25599.63654565638, -26105.435092812302, -25720.035707131035, -25847.888622810693, -25737.30769667045, -25678.96459864703, -25730.000865931677, -25944.927787284018, -25798.500653704446, -25548.90054753863, -25587.786097460936, -25688.644517865163, -25464.608163331468, -25864.021290339366, -25885.91731411878, -25553.700367281243, -26042.408552654564, -25602.224455599582, -25765.828737911692, -25687.931787524136, -25647.751173520413, -25708.912178971168, -25823.99841316268, -25832.175491726637, -25554.266391473473, -25959.410281017565, -25690.837084897732, -25402.97920299653, -25762.143345042303, -25758.082480843907, -25553.59971194014, -25798.768777476813, -25751.632972563755, -25762.996505865038, -25635.40099255635, -25790.150874345392, -25714.420763199465, -25898.81545949767, -25583.032472728108, -25599.747136461963, -26080.25220475557, -25961.523301868016, -25680.131995975335, -25704.700582997753, -25561.725188177534, -26006.813883461164, -25473.365698160313, -25981.49901079789, -25615.818742254272, -25774.966136668256, -25718.871942171663, -26023.329850619702, -25532.399431681537, -25598.4220706197], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.62785411533816, "mean_inference_ms": 0.2577497846119606, "mean_action_processing_ms": 0.06134151509598284, "mean_env_wait_ms": 1.5281331118770112, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003620147705078125, "StateBufferConnector_ms": 0.0026807785034179688, "ViewRequirementAgentConnector_ms": 0.06749820709228516}}, "episode_reward_max": -25345.672421099924, "episode_reward_min": -26105.435092812302, "episode_reward_mean": -25742.567611220165, "episode_len_mean": 360.0, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-25519.349602989754, -25619.05502207858, -25891.1413734565, -25871.921132023614, -25571.612840771653, -26033.929002990495, -25968.70702087451, -25753.59731625539, -25345.672421099924, -25734.096507738315, -25955.573889103773, -25811.43468690695, -25757.650316806128, -26102.10048345207, -25707.737809963204, -25498.861591433688, -25792.569799139757, -25891.087779099707, -25939.916820663995, -25759.14015205737, -25762.77959591386, -25704.311257363963, -25815.26912545352, -25700.99265257654, -25637.371647749467, -25585.901797595612, -25743.78194530946, -25730.88118511566, -25693.754176045648, -25698.066298154874, -25756.51197157061, -25905.5706532299, -25980.36756481758, -25393.582456681695, -25827.103134906156, -25646.06684443742, -25631.552966078983, -25399.489287253382, -25958.460820273434, -25862.615523121418, -25784.877557646454, -25520.706181154666, -25602.665316442188, -25778.991024729174, -25844.319635697706, -25968.00378102244, -25599.63654565638, -26105.435092812302, -25720.035707131035, -25847.888622810693, -25737.30769667045, -25678.96459864703, -25730.000865931677, -25944.927787284018, -25798.500653704446, -25548.90054753863, -25587.786097460936, -25688.644517865163, -25464.608163331468, -25864.021290339366, -25885.91731411878, -25553.700367281243, -26042.408552654564, -25602.224455599582, -25765.828737911692, -25687.931787524136, -25647.751173520413, -25708.912178971168, -25823.99841316268, -25832.175491726637, -25554.266391473473, -25959.410281017565, -25690.837084897732, -25402.97920299653, -25762.143345042303, -25758.082480843907, -25553.59971194014, -25798.768777476813, -25751.632972563755, -25762.996505865038, -25635.40099255635, -25790.150874345392, -25714.420763199465, -25898.81545949767, -25583.032472728108, -25599.747136461963, -26080.25220475557, -25961.523301868016, -25680.131995975335, -25704.700582997753, -25561.725188177534, -26006.813883461164, -25473.365698160313, -25981.49901079789, -25615.818742254272, -25774.966136668256, -25718.871942171663, -26023.329850619702, -25532.399431681537, -25598.4220706197], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.62785411533816, "mean_inference_ms": 0.2577497846119606, "mean_action_processing_ms": 0.06134151509598284, "mean_env_wait_ms": 1.5281331118770112, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003620147705078125, "StateBufferConnector_ms": 0.0026807785034179688, "ViewRequirementAgentConnector_ms": 0.06749820709228516}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 231480, "num_agent_steps_trained": 231480, "num_env_steps_sampled": 231480, "num_env_steps_trained": 231480, "num_env_steps_sampled_this_iter": 1080, "num_env_steps_trained_this_iter": 1080, "num_env_steps_sampled_throughput_per_sec": 95.54240564934797, "num_env_steps_trained_throughput_per_sec": 95.54240564934797, "timesteps_total": 231480, "num_steps_trained_this_iter": 1080, "agent_timesteps_total": 231480, "timers": {"training_iteration_time_ms": 3746.849, "sample_time_ms": 3736.202, "load_time_ms": 0.297, "load_throughput": 1211254.163, "learn_time_ms": 9.605, "learn_throughput": 37481.865, "synch_weights_time_ms": 0.703}, "counters": {"num_env_steps_sampled": 231480, "num_env_steps_trained": 231480, "num_agent_steps_sampled": 231480, "num_agent_steps_trained": 231480}, "done": false, "episodes_total": 643, "training_iteration": 141, "trial_id": "f5e97_00000", "date": "2023-07-25_17-22-15", "timestamp": 1690294935, "time_this_iter_s": 11.306674718856812, "time_total_s": 1579.7455840110779, "pid": 71917, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[0, 0.003], [5400, 0.001], [10800, 0.00075], [16200, 0.0005], [21600, 0.00025], [27000, 0.0001], [32400, 7.5e-05], [37800, 5e-05], [43200, 2.5e-05], [48600, 1e-05], [54000, 7.5e-06], [59400, 5e-06], [64800, 2.5e-06], [70200, 1e-06], [75600, 5e-07], [81000, 1e-07]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x304530310>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1579.7455840110779, "iterations_since_restore": 141, "perf": {"cpu_util_percent": 25.518749999999997, "ram_util_percent": 78.75625}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-07, "entropy_coeff": 0.1, "policy_entropy": -926.6998413085937, "policy_loss": -21747779046604.8, "vf_loss": 1111915244.8}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 3228.0, "diff_num_grad_updates_vs_sampler_policy": 3227.0}}, "num_env_steps_sampled": 232560, "num_env_steps_trained": 232560, "num_agent_steps_sampled": 232560, "num_agent_steps_trained": 232560}, "sampler_results": {"episode_reward_max": -25345.672421099924, "episode_reward_min": -26105.435092812302, "episode_reward_mean": -25750.582731142873, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-25871.921132023614, -25571.612840771653, -26033.929002990495, -25968.70702087451, -25753.59731625539, -25345.672421099924, -25734.096507738315, -25955.573889103773, -25811.43468690695, -25757.650316806128, -26102.10048345207, -25707.737809963204, -25498.861591433688, -25792.569799139757, -25891.087779099707, -25939.916820663995, -25759.14015205737, -25762.77959591386, -25704.311257363963, -25815.26912545352, -25700.99265257654, -25637.371647749467, -25585.901797595612, -25743.78194530946, -25730.88118511566, -25693.754176045648, -25698.066298154874, -25756.51197157061, -25905.5706532299, -25980.36756481758, -25393.582456681695, -25827.103134906156, -25646.06684443742, -25631.552966078983, -25399.489287253382, -25958.460820273434, -25862.615523121418, -25784.877557646454, -25520.706181154666, -25602.665316442188, -25778.991024729174, -25844.319635697706, -25968.00378102244, -25599.63654565638, -26105.435092812302, -25720.035707131035, -25847.888622810693, -25737.30769667045, -25678.96459864703, -25730.000865931677, -25944.927787284018, -25798.500653704446, -25548.90054753863, -25587.786097460936, -25688.644517865163, -25464.608163331468, -25864.021290339366, -25885.91731411878, -25553.700367281243, -26042.408552654564, -25602.224455599582, -25765.828737911692, -25687.931787524136, -25647.751173520413, -25708.912178971168, -25823.99841316268, -25832.175491726637, -25554.266391473473, -25959.410281017565, -25690.837084897732, -25402.97920299653, -25762.143345042303, -25758.082480843907, -25553.59971194014, -25798.768777476813, -25751.632972563755, -25762.996505865038, -25635.40099255635, -25790.150874345392, -25714.420763199465, -25898.81545949767, -25583.032472728108, -25599.747136461963, -26080.25220475557, -25961.523301868016, -25680.131995975335, -25704.700582997753, -25561.725188177534, -26006.813883461164, -25473.365698160313, -25981.49901079789, -25615.818742254272, -25774.966136668256, -25718.871942171663, -26023.329850619702, -25532.399431681537, -25598.4220706197, -26013.198021050313, -25943.011287423775, -25874.848682321674], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.6416631197940355, "mean_inference_ms": 0.2584046684796943, "mean_action_processing_ms": 0.06150110643407017, "mean_env_wait_ms": 1.5324701831357357, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0036628246307373047, "StateBufferConnector_ms": 0.0027201175689697266, "ViewRequirementAgentConnector_ms": 0.06817483901977539}}, "episode_reward_max": -25345.672421099924, "episode_reward_min": -26105.435092812302, "episode_reward_mean": -25750.582731142873, "episode_len_mean": 360.0, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-25871.921132023614, -25571.612840771653, -26033.929002990495, -25968.70702087451, -25753.59731625539, -25345.672421099924, -25734.096507738315, -25955.573889103773, -25811.43468690695, -25757.650316806128, -26102.10048345207, -25707.737809963204, -25498.861591433688, -25792.569799139757, -25891.087779099707, -25939.916820663995, -25759.14015205737, -25762.77959591386, -25704.311257363963, -25815.26912545352, -25700.99265257654, -25637.371647749467, -25585.901797595612, -25743.78194530946, -25730.88118511566, -25693.754176045648, -25698.066298154874, -25756.51197157061, -25905.5706532299, -25980.36756481758, -25393.582456681695, -25827.103134906156, -25646.06684443742, -25631.552966078983, -25399.489287253382, -25958.460820273434, -25862.615523121418, -25784.877557646454, -25520.706181154666, -25602.665316442188, -25778.991024729174, -25844.319635697706, -25968.00378102244, -25599.63654565638, -26105.435092812302, -25720.035707131035, -25847.888622810693, -25737.30769667045, -25678.96459864703, -25730.000865931677, -25944.927787284018, -25798.500653704446, -25548.90054753863, -25587.786097460936, -25688.644517865163, -25464.608163331468, -25864.021290339366, -25885.91731411878, -25553.700367281243, -26042.408552654564, -25602.224455599582, -25765.828737911692, -25687.931787524136, -25647.751173520413, -25708.912178971168, -25823.99841316268, -25832.175491726637, -25554.266391473473, -25959.410281017565, -25690.837084897732, -25402.97920299653, -25762.143345042303, -25758.082480843907, -25553.59971194014, -25798.768777476813, -25751.632972563755, -25762.996505865038, -25635.40099255635, -25790.150874345392, -25714.420763199465, -25898.81545949767, -25583.032472728108, -25599.747136461963, -26080.25220475557, -25961.523301868016, -25680.131995975335, -25704.700582997753, -25561.725188177534, -26006.813883461164, -25473.365698160313, -25981.49901079789, -25615.818742254272, -25774.966136668256, -25718.871942171663, -26023.329850619702, -25532.399431681537, -25598.4220706197, -26013.198021050313, -25943.011287423775, -25874.848682321674], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.6416631197940355, "mean_inference_ms": 0.2584046684796943, "mean_action_processing_ms": 0.06150110643407017, "mean_env_wait_ms": 1.5324701831357357, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0036628246307373047, "StateBufferConnector_ms": 0.0027201175689697266, "ViewRequirementAgentConnector_ms": 0.06817483901977539}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 232560, "num_agent_steps_trained": 232560, "num_env_steps_sampled": 232560, "num_env_steps_trained": 232560, "num_env_steps_sampled_this_iter": 1080, "num_env_steps_trained_this_iter": 1080, "num_env_steps_sampled_throughput_per_sec": 95.5406464505029, "num_env_steps_trained_throughput_per_sec": 95.5406464505029, "timesteps_total": 232560, "num_steps_trained_this_iter": 1080, "agent_timesteps_total": 232560, "timers": {"training_iteration_time_ms": 3752.846, "sample_time_ms": 3742.146, "load_time_ms": 0.297, "load_throughput": 1212518.622, "learn_time_ms": 9.652, "learn_throughput": 37296.424, "synch_weights_time_ms": 0.708}, "counters": {"num_env_steps_sampled": 232560, "num_env_steps_trained": 232560, "num_agent_steps_sampled": 232560, "num_agent_steps_trained": 232560}, "done": false, "episodes_total": 646, "training_iteration": 142, "trial_id": "f5e97_00000", "date": "2023-07-25_17-22-27", "timestamp": 1690294947, "time_this_iter_s": 11.306883096694946, "time_total_s": 1591.0524671077728, "pid": 71917, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[0, 0.003], [5400, 0.001], [10800, 0.00075], [16200, 0.0005], [21600, 0.00025], [27000, 0.0001], [32400, 7.5e-05], [37800, 5e-05], [43200, 2.5e-05], [48600, 1e-05], [54000, 7.5e-06], [59400, 5e-06], [64800, 2.5e-06], [70200, 1e-06], [75600, 5e-07], [81000, 1e-07]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x304530310>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1591.0524671077728, "iterations_since_restore": 142, "perf": {"cpu_util_percent": 23.76875, "ram_util_percent": 78.61250000000001}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-07, "entropy_coeff": 0.1, "policy_entropy": -926.7000122070312, "policy_loss": -33127398474547.2, "vf_loss": 1087865100.8}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 3243.0, "diff_num_grad_updates_vs_sampler_policy": 3242.0}}, "num_env_steps_sampled": 233640, "num_env_steps_trained": 233640, "num_agent_steps_sampled": 233640, "num_agent_steps_trained": 233640}, "sampler_results": {"episode_reward_max": -25345.672421099924, "episode_reward_min": -26105.435092812302, "episode_reward_mean": -25749.223779688735, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-25968.70702087451, -25753.59731625539, -25345.672421099924, -25734.096507738315, -25955.573889103773, -25811.43468690695, -25757.650316806128, -26102.10048345207, -25707.737809963204, -25498.861591433688, -25792.569799139757, -25891.087779099707, -25939.916820663995, -25759.14015205737, -25762.77959591386, -25704.311257363963, -25815.26912545352, -25700.99265257654, -25637.371647749467, -25585.901797595612, -25743.78194530946, -25730.88118511566, -25693.754176045648, -25698.066298154874, -25756.51197157061, -25905.5706532299, -25980.36756481758, -25393.582456681695, -25827.103134906156, -25646.06684443742, -25631.552966078983, -25399.489287253382, -25958.460820273434, -25862.615523121418, -25784.877557646454, -25520.706181154666, -25602.665316442188, -25778.991024729174, -25844.319635697706, -25968.00378102244, -25599.63654565638, -26105.435092812302, -25720.035707131035, -25847.888622810693, -25737.30769667045, -25678.96459864703, -25730.000865931677, -25944.927787284018, -25798.500653704446, -25548.90054753863, -25587.786097460936, -25688.644517865163, -25464.608163331468, -25864.021290339366, -25885.91731411878, -25553.700367281243, -26042.408552654564, -25602.224455599582, -25765.828737911692, -25687.931787524136, -25647.751173520413, -25708.912178971168, -25823.99841316268, -25832.175491726637, -25554.266391473473, -25959.410281017565, -25690.837084897732, -25402.97920299653, -25762.143345042303, -25758.082480843907, -25553.59971194014, -25798.768777476813, -25751.632972563755, -25762.996505865038, -25635.40099255635, -25790.150874345392, -25714.420763199465, -25898.81545949767, -25583.032472728108, -25599.747136461963, -26080.25220475557, -25961.523301868016, -25680.131995975335, -25704.700582997753, -25561.725188177534, -26006.813883461164, -25473.365698160313, -25981.49901079789, -25615.818742254272, -25774.966136668256, -25718.871942171663, -26023.329850619702, -25532.399431681537, -25598.4220706197, -26013.198021050313, -25943.011287423775, -25874.848682321674, -25722.833638907243, -25948.353042061724, -25670.38114940201], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.655830642049563, "mean_inference_ms": 0.2590745936348185, "mean_action_processing_ms": 0.06166457153083957, "mean_env_wait_ms": 1.5369177983650524, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0036983489990234375, "StateBufferConnector_ms": 0.0027472972869873047, "ViewRequirementAgentConnector_ms": 0.06882143020629883}}, "episode_reward_max": -25345.672421099924, "episode_reward_min": -26105.435092812302, "episode_reward_mean": -25749.223779688735, "episode_len_mean": 360.0, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-25968.70702087451, -25753.59731625539, -25345.672421099924, -25734.096507738315, -25955.573889103773, -25811.43468690695, -25757.650316806128, -26102.10048345207, -25707.737809963204, -25498.861591433688, -25792.569799139757, -25891.087779099707, -25939.916820663995, -25759.14015205737, -25762.77959591386, -25704.311257363963, -25815.26912545352, -25700.99265257654, -25637.371647749467, -25585.901797595612, -25743.78194530946, -25730.88118511566, -25693.754176045648, -25698.066298154874, -25756.51197157061, -25905.5706532299, -25980.36756481758, -25393.582456681695, -25827.103134906156, -25646.06684443742, -25631.552966078983, -25399.489287253382, -25958.460820273434, -25862.615523121418, -25784.877557646454, -25520.706181154666, -25602.665316442188, -25778.991024729174, -25844.319635697706, -25968.00378102244, -25599.63654565638, -26105.435092812302, -25720.035707131035, -25847.888622810693, -25737.30769667045, -25678.96459864703, -25730.000865931677, -25944.927787284018, -25798.500653704446, -25548.90054753863, -25587.786097460936, -25688.644517865163, -25464.608163331468, -25864.021290339366, -25885.91731411878, -25553.700367281243, -26042.408552654564, -25602.224455599582, -25765.828737911692, -25687.931787524136, -25647.751173520413, -25708.912178971168, -25823.99841316268, -25832.175491726637, -25554.266391473473, -25959.410281017565, -25690.837084897732, -25402.97920299653, -25762.143345042303, -25758.082480843907, -25553.59971194014, -25798.768777476813, -25751.632972563755, -25762.996505865038, -25635.40099255635, -25790.150874345392, -25714.420763199465, -25898.81545949767, -25583.032472728108, -25599.747136461963, -26080.25220475557, -25961.523301868016, -25680.131995975335, -25704.700582997753, -25561.725188177534, -26006.813883461164, -25473.365698160313, -25981.49901079789, -25615.818742254272, -25774.966136668256, -25718.871942171663, -26023.329850619702, -25532.399431681537, -25598.4220706197, -26013.198021050313, -25943.011287423775, -25874.848682321674, -25722.833638907243, -25948.353042061724, -25670.38114940201], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.655830642049563, "mean_inference_ms": 0.2590745936348185, "mean_action_processing_ms": 0.06166457153083957, "mean_env_wait_ms": 1.5369177983650524, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0036983489990234375, "StateBufferConnector_ms": 0.0027472972869873047, "ViewRequirementAgentConnector_ms": 0.06882143020629883}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 233640, "num_agent_steps_trained": 233640, "num_env_steps_sampled": 233640, "num_env_steps_trained": 233640, "num_env_steps_sampled_this_iter": 1080, "num_env_steps_trained_this_iter": 1080, "num_env_steps_sampled_throughput_per_sec": 96.24370793658564, "num_env_steps_trained_throughput_per_sec": 96.24370793658564, "timesteps_total": 233640, "num_steps_trained_this_iter": 1080, "agent_timesteps_total": 233640, "timers": {"training_iteration_time_ms": 3749.06, "sample_time_ms": 3738.258, "load_time_ms": 0.299, "load_throughput": 1205548.455, "learn_time_ms": 9.738, "learn_throughput": 36968.968, "synch_weights_time_ms": 0.722}, "counters": {"num_env_steps_sampled": 233640, "num_env_steps_trained": 233640, "num_agent_steps_sampled": 233640, "num_agent_steps_trained": 233640}, "done": false, "episodes_total": 649, "training_iteration": 143, "trial_id": "f5e97_00000", "date": "2023-07-25_17-22-38", "timestamp": 1690294958, "time_this_iter_s": 11.224974155426025, "time_total_s": 1602.2774412631989, "pid": 71917, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[0, 0.003], [5400, 0.001], [10800, 0.00075], [16200, 0.0005], [21600, 0.00025], [27000, 0.0001], [32400, 7.5e-05], [37800, 5e-05], [43200, 2.5e-05], [48600, 1e-05], [54000, 7.5e-06], [59400, 5e-06], [64800, 2.5e-06], [70200, 1e-06], [75600, 5e-07], [81000, 1e-07]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x304530310>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1602.2774412631989, "iterations_since_restore": 143, "perf": {"cpu_util_percent": 24.59375, "ram_util_percent": 78.3125}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-07, "entropy_coeff": 0.1, "policy_entropy": -926.6998291015625, "policy_loss": -34012387298508.8, "vf_loss": 1091893907.2}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 3258.0, "diff_num_grad_updates_vs_sampler_policy": 3257.0}}, "num_env_steps_sampled": 234720, "num_env_steps_trained": 234720, "num_agent_steps_sampled": 234720, "num_agent_steps_trained": 234720}, "sampler_results": {"episode_reward_max": -25393.582456681695, "episode_reward_min": -26105.435092812302, "episode_reward_mean": -25753.01349764423, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-25734.096507738315, -25955.573889103773, -25811.43468690695, -25757.650316806128, -26102.10048345207, -25707.737809963204, -25498.861591433688, -25792.569799139757, -25891.087779099707, -25939.916820663995, -25759.14015205737, -25762.77959591386, -25704.311257363963, -25815.26912545352, -25700.99265257654, -25637.371647749467, -25585.901797595612, -25743.78194530946, -25730.88118511566, -25693.754176045648, -25698.066298154874, -25756.51197157061, -25905.5706532299, -25980.36756481758, -25393.582456681695, -25827.103134906156, -25646.06684443742, -25631.552966078983, -25399.489287253382, -25958.460820273434, -25862.615523121418, -25784.877557646454, -25520.706181154666, -25602.665316442188, -25778.991024729174, -25844.319635697706, -25968.00378102244, -25599.63654565638, -26105.435092812302, -25720.035707131035, -25847.888622810693, -25737.30769667045, -25678.96459864703, -25730.000865931677, -25944.927787284018, -25798.500653704446, -25548.90054753863, -25587.786097460936, -25688.644517865163, -25464.608163331468, -25864.021290339366, -25885.91731411878, -25553.700367281243, -26042.408552654564, -25602.224455599582, -25765.828737911692, -25687.931787524136, -25647.751173520413, -25708.912178971168, -25823.99841316268, -25832.175491726637, -25554.266391473473, -25959.410281017565, -25690.837084897732, -25402.97920299653, -25762.143345042303, -25758.082480843907, -25553.59971194014, -25798.768777476813, -25751.632972563755, -25762.996505865038, -25635.40099255635, -25790.150874345392, -25714.420763199465, -25898.81545949767, -25583.032472728108, -25599.747136461963, -26080.25220475557, -25961.523301868016, -25680.131995975335, -25704.700582997753, -25561.725188177534, -26006.813883461164, -25473.365698160313, -25981.49901079789, -25615.818742254272, -25774.966136668256, -25718.871942171663, -26023.329850619702, -25532.399431681537, -25598.4220706197, -26013.198021050313, -25943.011287423775, -25874.848682321674, -25722.833638907243, -25948.353042061724, -25670.38114940201, -25960.801131484717, -25859.620995068624, -25626.52642722719], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.669858594046977, "mean_inference_ms": 0.25973658549448986, "mean_action_processing_ms": 0.0618269347479466, "mean_env_wait_ms": 1.541329169128472, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003713846206665039, "StateBufferConnector_ms": 0.0027534961700439453, "ViewRequirementAgentConnector_ms": 0.06910252571105957}}, "episode_reward_max": -25393.582456681695, "episode_reward_min": -26105.435092812302, "episode_reward_mean": -25753.01349764423, "episode_len_mean": 360.0, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-25734.096507738315, -25955.573889103773, -25811.43468690695, -25757.650316806128, -26102.10048345207, -25707.737809963204, -25498.861591433688, -25792.569799139757, -25891.087779099707, -25939.916820663995, -25759.14015205737, -25762.77959591386, -25704.311257363963, -25815.26912545352, -25700.99265257654, -25637.371647749467, -25585.901797595612, -25743.78194530946, -25730.88118511566, -25693.754176045648, -25698.066298154874, -25756.51197157061, -25905.5706532299, -25980.36756481758, -25393.582456681695, -25827.103134906156, -25646.06684443742, -25631.552966078983, -25399.489287253382, -25958.460820273434, -25862.615523121418, -25784.877557646454, -25520.706181154666, -25602.665316442188, -25778.991024729174, -25844.319635697706, -25968.00378102244, -25599.63654565638, -26105.435092812302, -25720.035707131035, -25847.888622810693, -25737.30769667045, -25678.96459864703, -25730.000865931677, -25944.927787284018, -25798.500653704446, -25548.90054753863, -25587.786097460936, -25688.644517865163, -25464.608163331468, -25864.021290339366, -25885.91731411878, -25553.700367281243, -26042.408552654564, -25602.224455599582, -25765.828737911692, -25687.931787524136, -25647.751173520413, -25708.912178971168, -25823.99841316268, -25832.175491726637, -25554.266391473473, -25959.410281017565, -25690.837084897732, -25402.97920299653, -25762.143345042303, -25758.082480843907, -25553.59971194014, -25798.768777476813, -25751.632972563755, -25762.996505865038, -25635.40099255635, -25790.150874345392, -25714.420763199465, -25898.81545949767, -25583.032472728108, -25599.747136461963, -26080.25220475557, -25961.523301868016, -25680.131995975335, -25704.700582997753, -25561.725188177534, -26006.813883461164, -25473.365698160313, -25981.49901079789, -25615.818742254272, -25774.966136668256, -25718.871942171663, -26023.329850619702, -25532.399431681537, -25598.4220706197, -26013.198021050313, -25943.011287423775, -25874.848682321674, -25722.833638907243, -25948.353042061724, -25670.38114940201, -25960.801131484717, -25859.620995068624, -25626.52642722719], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.669858594046977, "mean_inference_ms": 0.25973658549448986, "mean_action_processing_ms": 0.0618269347479466, "mean_env_wait_ms": 1.541329169128472, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003713846206665039, "StateBufferConnector_ms": 0.0027534961700439453, "ViewRequirementAgentConnector_ms": 0.06910252571105957}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 234720, "num_agent_steps_trained": 234720, "num_env_steps_sampled": 234720, "num_env_steps_trained": 234720, "num_env_steps_sampled_this_iter": 1080, "num_env_steps_trained_this_iter": 1080, "num_env_steps_sampled_throughput_per_sec": 95.86818863605623, "num_env_steps_trained_throughput_per_sec": 95.86818863605623, "timesteps_total": 234720, "num_steps_trained_this_iter": 1080, "agent_timesteps_total": 234720, "timers": {"training_iteration_time_ms": 3755.035, "sample_time_ms": 3744.13, "load_time_ms": 0.296, "load_throughput": 1214859.957, "learn_time_ms": 9.829, "learn_throughput": 36627.3, "synch_weights_time_ms": 0.736}, "counters": {"num_env_steps_sampled": 234720, "num_env_steps_trained": 234720, "num_agent_steps_sampled": 234720, "num_agent_steps_trained": 234720}, "done": false, "episodes_total": 652, "training_iteration": 144, "trial_id": "f5e97_00000", "date": "2023-07-25_17-22-49", "timestamp": 1690294969, "time_this_iter_s": 11.268312931060791, "time_total_s": 1613.5457541942596, "pid": 71917, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[0, 0.003], [5400, 0.001], [10800, 0.00075], [16200, 0.0005], [21600, 0.00025], [27000, 0.0001], [32400, 7.5e-05], [37800, 5e-05], [43200, 2.5e-05], [48600, 1e-05], [54000, 7.5e-06], [59400, 5e-06], [64800, 2.5e-06], [70200, 1e-06], [75600, 5e-07], [81000, 1e-07]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x304530310>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1613.5457541942596, "iterations_since_restore": 144, "perf": {"cpu_util_percent": 23.31176470588235, "ram_util_percent": 78.42941176470588}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-07, "entropy_coeff": 0.1, "policy_entropy": -926.6997924804688, "policy_loss": -26448856581734.4, "vf_loss": 1104065452.8}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 3273.0, "diff_num_grad_updates_vs_sampler_policy": 3272.0}}, "num_env_steps_sampled": 235800, "num_env_steps_trained": 235800, "num_agent_steps_sampled": 235800, "num_agent_steps_trained": 235800}, "sampler_results": {"episode_reward_max": -25393.582456681695, "episode_reward_min": -26105.435092812302, "episode_reward_mean": -25751.854033299427, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-25757.650316806128, -26102.10048345207, -25707.737809963204, -25498.861591433688, -25792.569799139757, -25891.087779099707, -25939.916820663995, -25759.14015205737, -25762.77959591386, -25704.311257363963, -25815.26912545352, -25700.99265257654, -25637.371647749467, -25585.901797595612, -25743.78194530946, -25730.88118511566, -25693.754176045648, -25698.066298154874, -25756.51197157061, -25905.5706532299, -25980.36756481758, -25393.582456681695, -25827.103134906156, -25646.06684443742, -25631.552966078983, -25399.489287253382, -25958.460820273434, -25862.615523121418, -25784.877557646454, -25520.706181154666, -25602.665316442188, -25778.991024729174, -25844.319635697706, -25968.00378102244, -25599.63654565638, -26105.435092812302, -25720.035707131035, -25847.888622810693, -25737.30769667045, -25678.96459864703, -25730.000865931677, -25944.927787284018, -25798.500653704446, -25548.90054753863, -25587.786097460936, -25688.644517865163, -25464.608163331468, -25864.021290339366, -25885.91731411878, -25553.700367281243, -26042.408552654564, -25602.224455599582, -25765.828737911692, -25687.931787524136, -25647.751173520413, -25708.912178971168, -25823.99841316268, -25832.175491726637, -25554.266391473473, -25959.410281017565, -25690.837084897732, -25402.97920299653, -25762.143345042303, -25758.082480843907, -25553.59971194014, -25798.768777476813, -25751.632972563755, -25762.996505865038, -25635.40099255635, -25790.150874345392, -25714.420763199465, -25898.81545949767, -25583.032472728108, -25599.747136461963, -26080.25220475557, -25961.523301868016, -25680.131995975335, -25704.700582997753, -25561.725188177534, -26006.813883461164, -25473.365698160313, -25981.49901079789, -25615.818742254272, -25774.966136668256, -25718.871942171663, -26023.329850619702, -25532.399431681537, -25598.4220706197, -26013.198021050313, -25943.011287423775, -25874.848682321674, -25722.833638907243, -25948.353042061724, -25670.38114940201, -25960.801131484717, -25859.620995068624, -25626.52642722719, -25860.885808580013, -25753.036526536976, -25771.236314150938], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.683890720028914, "mean_inference_ms": 0.26039992486841207, "mean_action_processing_ms": 0.061989598032015515, "mean_env_wait_ms": 1.5457658341912286, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0037178993225097656, "StateBufferConnector_ms": 0.002740621566772461, "ViewRequirementAgentConnector_ms": 0.06891608238220215}}, "episode_reward_max": -25393.582456681695, "episode_reward_min": -26105.435092812302, "episode_reward_mean": -25751.854033299427, "episode_len_mean": 360.0, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-25757.650316806128, -26102.10048345207, -25707.737809963204, -25498.861591433688, -25792.569799139757, -25891.087779099707, -25939.916820663995, -25759.14015205737, -25762.77959591386, -25704.311257363963, -25815.26912545352, -25700.99265257654, -25637.371647749467, -25585.901797595612, -25743.78194530946, -25730.88118511566, -25693.754176045648, -25698.066298154874, -25756.51197157061, -25905.5706532299, -25980.36756481758, -25393.582456681695, -25827.103134906156, -25646.06684443742, -25631.552966078983, -25399.489287253382, -25958.460820273434, -25862.615523121418, -25784.877557646454, -25520.706181154666, -25602.665316442188, -25778.991024729174, -25844.319635697706, -25968.00378102244, -25599.63654565638, -26105.435092812302, -25720.035707131035, -25847.888622810693, -25737.30769667045, -25678.96459864703, -25730.000865931677, -25944.927787284018, -25798.500653704446, -25548.90054753863, -25587.786097460936, -25688.644517865163, -25464.608163331468, -25864.021290339366, -25885.91731411878, -25553.700367281243, -26042.408552654564, -25602.224455599582, -25765.828737911692, -25687.931787524136, -25647.751173520413, -25708.912178971168, -25823.99841316268, -25832.175491726637, -25554.266391473473, -25959.410281017565, -25690.837084897732, -25402.97920299653, -25762.143345042303, -25758.082480843907, -25553.59971194014, -25798.768777476813, -25751.632972563755, -25762.996505865038, -25635.40099255635, -25790.150874345392, -25714.420763199465, -25898.81545949767, -25583.032472728108, -25599.747136461963, -26080.25220475557, -25961.523301868016, -25680.131995975335, -25704.700582997753, -25561.725188177534, -26006.813883461164, -25473.365698160313, -25981.49901079789, -25615.818742254272, -25774.966136668256, -25718.871942171663, -26023.329850619702, -25532.399431681537, -25598.4220706197, -26013.198021050313, -25943.011287423775, -25874.848682321674, -25722.833638907243, -25948.353042061724, -25670.38114940201, -25960.801131484717, -25859.620995068624, -25626.52642722719, -25860.885808580013, -25753.036526536976, -25771.236314150938], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.683890720028914, "mean_inference_ms": 0.26039992486841207, "mean_action_processing_ms": 0.061989598032015515, "mean_env_wait_ms": 1.5457658341912286, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0037178993225097656, "StateBufferConnector_ms": 0.002740621566772461, "ViewRequirementAgentConnector_ms": 0.06891608238220215}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 235800, "num_agent_steps_trained": 235800, "num_env_steps_sampled": 235800, "num_env_steps_trained": 235800, "num_env_steps_sampled_this_iter": 1080, "num_env_steps_trained_this_iter": 1080, "num_env_steps_sampled_throughput_per_sec": 95.30103902859702, "num_env_steps_trained_throughput_per_sec": 95.30103902859702, "timesteps_total": 235800, "num_steps_trained_this_iter": 1080, "agent_timesteps_total": 235800, "timers": {"training_iteration_time_ms": 3769.593, "sample_time_ms": 3758.811, "load_time_ms": 0.295, "load_throughput": 1220654.357, "learn_time_ms": 9.73, "learn_throughput": 36998.136, "synch_weights_time_ms": 0.714}, "counters": {"num_env_steps_sampled": 235800, "num_env_steps_trained": 235800, "num_agent_steps_sampled": 235800, "num_agent_steps_trained": 235800}, "done": false, "episodes_total": 655, "training_iteration": 145, "trial_id": "f5e97_00000", "date": "2023-07-25_17-23-01", "timestamp": 1690294981, "time_this_iter_s": 11.335230112075806, "time_total_s": 1624.8809843063354, "pid": 71917, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[0, 0.003], [5400, 0.001], [10800, 0.00075], [16200, 0.0005], [21600, 0.00025], [27000, 0.0001], [32400, 7.5e-05], [37800, 5e-05], [43200, 2.5e-05], [48600, 1e-05], [54000, 7.5e-06], [59400, 5e-06], [64800, 2.5e-06], [70200, 1e-06], [75600, 5e-07], [81000, 1e-07]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x304530310>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1624.8809843063354, "iterations_since_restore": 145, "perf": {"cpu_util_percent": 23.25625, "ram_util_percent": 78.4375}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-07, "entropy_coeff": 0.1, "policy_entropy": -926.7003051757813, "policy_loss": -20221011145523.2, "vf_loss": 1061786067.2}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 3288.0, "diff_num_grad_updates_vs_sampler_policy": 3287.0}}, "num_env_steps_sampled": 236880, "num_env_steps_trained": 236880, "num_agent_steps_sampled": 236880, "num_agent_steps_trained": 236880}, "sampler_results": {"episode_reward_max": -25328.253683721272, "episode_reward_min": -26105.435092812302, "episode_reward_mean": -25744.474313524737, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-25498.861591433688, -25792.569799139757, -25891.087779099707, -25939.916820663995, -25759.14015205737, -25762.77959591386, -25704.311257363963, -25815.26912545352, -25700.99265257654, -25637.371647749467, -25585.901797595612, -25743.78194530946, -25730.88118511566, -25693.754176045648, -25698.066298154874, -25756.51197157061, -25905.5706532299, -25980.36756481758, -25393.582456681695, -25827.103134906156, -25646.06684443742, -25631.552966078983, -25399.489287253382, -25958.460820273434, -25862.615523121418, -25784.877557646454, -25520.706181154666, -25602.665316442188, -25778.991024729174, -25844.319635697706, -25968.00378102244, -25599.63654565638, -26105.435092812302, -25720.035707131035, -25847.888622810693, -25737.30769667045, -25678.96459864703, -25730.000865931677, -25944.927787284018, -25798.500653704446, -25548.90054753863, -25587.786097460936, -25688.644517865163, -25464.608163331468, -25864.021290339366, -25885.91731411878, -25553.700367281243, -26042.408552654564, -25602.224455599582, -25765.828737911692, -25687.931787524136, -25647.751173520413, -25708.912178971168, -25823.99841316268, -25832.175491726637, -25554.266391473473, -25959.410281017565, -25690.837084897732, -25402.97920299653, -25762.143345042303, -25758.082480843907, -25553.59971194014, -25798.768777476813, -25751.632972563755, -25762.996505865038, -25635.40099255635, -25790.150874345392, -25714.420763199465, -25898.81545949767, -25583.032472728108, -25599.747136461963, -26080.25220475557, -25961.523301868016, -25680.131995975335, -25704.700582997753, -25561.725188177534, -26006.813883461164, -25473.365698160313, -25981.49901079789, -25615.818742254272, -25774.966136668256, -25718.871942171663, -26023.329850619702, -25532.399431681537, -25598.4220706197, -26013.198021050313, -25943.011287423775, -25874.848682321674, -25722.833638907243, -25948.353042061724, -25670.38114940201, -25960.801131484717, -25859.620995068624, -25626.52642722719, -25860.885808580013, -25753.036526536976, -25771.236314150938, -25746.199955167915, -25755.06299386396, -25328.253683721272], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.697772020897323, "mean_inference_ms": 0.261056029634888, "mean_action_processing_ms": 0.062150524026487325, "mean_env_wait_ms": 1.5501583759185475, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00370025634765625, "StateBufferConnector_ms": 0.0027310848236083984, "ViewRequirementAgentConnector_ms": 0.06864714622497559}}, "episode_reward_max": -25328.253683721272, "episode_reward_min": -26105.435092812302, "episode_reward_mean": -25744.474313524737, "episode_len_mean": 360.0, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-25498.861591433688, -25792.569799139757, -25891.087779099707, -25939.916820663995, -25759.14015205737, -25762.77959591386, -25704.311257363963, -25815.26912545352, -25700.99265257654, -25637.371647749467, -25585.901797595612, -25743.78194530946, -25730.88118511566, -25693.754176045648, -25698.066298154874, -25756.51197157061, -25905.5706532299, -25980.36756481758, -25393.582456681695, -25827.103134906156, -25646.06684443742, -25631.552966078983, -25399.489287253382, -25958.460820273434, -25862.615523121418, -25784.877557646454, -25520.706181154666, -25602.665316442188, -25778.991024729174, -25844.319635697706, -25968.00378102244, -25599.63654565638, -26105.435092812302, -25720.035707131035, -25847.888622810693, -25737.30769667045, -25678.96459864703, -25730.000865931677, -25944.927787284018, -25798.500653704446, -25548.90054753863, -25587.786097460936, -25688.644517865163, -25464.608163331468, -25864.021290339366, -25885.91731411878, -25553.700367281243, -26042.408552654564, -25602.224455599582, -25765.828737911692, -25687.931787524136, -25647.751173520413, -25708.912178971168, -25823.99841316268, -25832.175491726637, -25554.266391473473, -25959.410281017565, -25690.837084897732, -25402.97920299653, -25762.143345042303, -25758.082480843907, -25553.59971194014, -25798.768777476813, -25751.632972563755, -25762.996505865038, -25635.40099255635, -25790.150874345392, -25714.420763199465, -25898.81545949767, -25583.032472728108, -25599.747136461963, -26080.25220475557, -25961.523301868016, -25680.131995975335, -25704.700582997753, -25561.725188177534, -26006.813883461164, -25473.365698160313, -25981.49901079789, -25615.818742254272, -25774.966136668256, -25718.871942171663, -26023.329850619702, -25532.399431681537, -25598.4220706197, -26013.198021050313, -25943.011287423775, -25874.848682321674, -25722.833638907243, -25948.353042061724, -25670.38114940201, -25960.801131484717, -25859.620995068624, -25626.52642722719, -25860.885808580013, -25753.036526536976, -25771.236314150938, -25746.199955167915, -25755.06299386396, -25328.253683721272], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.697772020897323, "mean_inference_ms": 0.261056029634888, "mean_action_processing_ms": 0.062150524026487325, "mean_env_wait_ms": 1.5501583759185475, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00370025634765625, "StateBufferConnector_ms": 0.0027310848236083984, "ViewRequirementAgentConnector_ms": 0.06864714622497559}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 236880, "num_agent_steps_trained": 236880, "num_env_steps_sampled": 236880, "num_env_steps_trained": 236880, "num_env_steps_sampled_this_iter": 1080, "num_env_steps_trained_this_iter": 1080, "num_env_steps_sampled_throughput_per_sec": 95.65216616439855, "num_env_steps_trained_throughput_per_sec": 95.65216616439855, "timesteps_total": 236880, "num_steps_trained_this_iter": 1080, "agent_timesteps_total": 236880, "timers": {"training_iteration_time_ms": 3771.089, "sample_time_ms": 3760.3, "load_time_ms": 0.298, "load_throughput": 1208636.388, "learn_time_ms": 9.739, "learn_throughput": 36963.448, "synch_weights_time_ms": 0.708}, "counters": {"num_env_steps_sampled": 236880, "num_env_steps_trained": 236880, "num_agent_steps_sampled": 236880, "num_agent_steps_trained": 236880}, "done": false, "episodes_total": 658, "training_iteration": 146, "trial_id": "f5e97_00000", "date": "2023-07-25_17-23-12", "timestamp": 1690294992, "time_this_iter_s": 11.293699026107788, "time_total_s": 1636.1746833324432, "pid": 71917, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[0, 0.003], [5400, 0.001], [10800, 0.00075], [16200, 0.0005], [21600, 0.00025], [27000, 0.0001], [32400, 7.5e-05], [37800, 5e-05], [43200, 2.5e-05], [48600, 1e-05], [54000, 7.5e-06], [59400, 5e-06], [64800, 2.5e-06], [70200, 1e-06], [75600, 5e-07], [81000, 1e-07]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x304530310>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1636.1746833324432, "iterations_since_restore": 146, "perf": {"cpu_util_percent": 26.612499999999997, "ram_util_percent": 78.475}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-07, "entropy_coeff": 0.1, "policy_entropy": -926.6999145507813, "policy_loss": -21455299518054.4, "vf_loss": 1105390892.8}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 3303.0, "diff_num_grad_updates_vs_sampler_policy": 3302.0}}, "num_env_steps_sampled": 237960, "num_env_steps_trained": 237960, "num_agent_steps_sampled": 237960, "num_agent_steps_trained": 237960}, "sampler_results": {"episode_reward_max": -25328.253683721272, "episode_reward_min": -26105.435092812302, "episode_reward_mean": -25746.372047700665, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-25939.916820663995, -25759.14015205737, -25762.77959591386, -25704.311257363963, -25815.26912545352, -25700.99265257654, -25637.371647749467, -25585.901797595612, -25743.78194530946, -25730.88118511566, -25693.754176045648, -25698.066298154874, -25756.51197157061, -25905.5706532299, -25980.36756481758, -25393.582456681695, -25827.103134906156, -25646.06684443742, -25631.552966078983, -25399.489287253382, -25958.460820273434, -25862.615523121418, -25784.877557646454, -25520.706181154666, -25602.665316442188, -25778.991024729174, -25844.319635697706, -25968.00378102244, -25599.63654565638, -26105.435092812302, -25720.035707131035, -25847.888622810693, -25737.30769667045, -25678.96459864703, -25730.000865931677, -25944.927787284018, -25798.500653704446, -25548.90054753863, -25587.786097460936, -25688.644517865163, -25464.608163331468, -25864.021290339366, -25885.91731411878, -25553.700367281243, -26042.408552654564, -25602.224455599582, -25765.828737911692, -25687.931787524136, -25647.751173520413, -25708.912178971168, -25823.99841316268, -25832.175491726637, -25554.266391473473, -25959.410281017565, -25690.837084897732, -25402.97920299653, -25762.143345042303, -25758.082480843907, -25553.59971194014, -25798.768777476813, -25751.632972563755, -25762.996505865038, -25635.40099255635, -25790.150874345392, -25714.420763199465, -25898.81545949767, -25583.032472728108, -25599.747136461963, -26080.25220475557, -25961.523301868016, -25680.131995975335, -25704.700582997753, -25561.725188177534, -26006.813883461164, -25473.365698160313, -25981.49901079789, -25615.818742254272, -25774.966136668256, -25718.871942171663, -26023.329850619702, -25532.399431681537, -25598.4220706197, -26013.198021050313, -25943.011287423775, -25874.848682321674, -25722.833638907243, -25948.353042061724, -25670.38114940201, -25960.801131484717, -25859.620995068624, -25626.52642722719, -25860.885808580013, -25753.036526536976, -25771.236314150938, -25746.199955167915, -25755.06299386396, -25328.253683721272, -25585.840661300284, -25903.334880684706, -25883.117045280727], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.711523028431175, "mean_inference_ms": 0.2617057929843666, "mean_action_processing_ms": 0.062309831863375596, "mean_env_wait_ms": 1.554497274408296, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0036995410919189453, "StateBufferConnector_ms": 0.00272369384765625, "ViewRequirementAgentConnector_ms": 0.06863951683044434}}, "episode_reward_max": -25328.253683721272, "episode_reward_min": -26105.435092812302, "episode_reward_mean": -25746.372047700665, "episode_len_mean": 360.0, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-25939.916820663995, -25759.14015205737, -25762.77959591386, -25704.311257363963, -25815.26912545352, -25700.99265257654, -25637.371647749467, -25585.901797595612, -25743.78194530946, -25730.88118511566, -25693.754176045648, -25698.066298154874, -25756.51197157061, -25905.5706532299, -25980.36756481758, -25393.582456681695, -25827.103134906156, -25646.06684443742, -25631.552966078983, -25399.489287253382, -25958.460820273434, -25862.615523121418, -25784.877557646454, -25520.706181154666, -25602.665316442188, -25778.991024729174, -25844.319635697706, -25968.00378102244, -25599.63654565638, -26105.435092812302, -25720.035707131035, -25847.888622810693, -25737.30769667045, -25678.96459864703, -25730.000865931677, -25944.927787284018, -25798.500653704446, -25548.90054753863, -25587.786097460936, -25688.644517865163, -25464.608163331468, -25864.021290339366, -25885.91731411878, -25553.700367281243, -26042.408552654564, -25602.224455599582, -25765.828737911692, -25687.931787524136, -25647.751173520413, -25708.912178971168, -25823.99841316268, -25832.175491726637, -25554.266391473473, -25959.410281017565, -25690.837084897732, -25402.97920299653, -25762.143345042303, -25758.082480843907, -25553.59971194014, -25798.768777476813, -25751.632972563755, -25762.996505865038, -25635.40099255635, -25790.150874345392, -25714.420763199465, -25898.81545949767, -25583.032472728108, -25599.747136461963, -26080.25220475557, -25961.523301868016, -25680.131995975335, -25704.700582997753, -25561.725188177534, -26006.813883461164, -25473.365698160313, -25981.49901079789, -25615.818742254272, -25774.966136668256, -25718.871942171663, -26023.329850619702, -25532.399431681537, -25598.4220706197, -26013.198021050313, -25943.011287423775, -25874.848682321674, -25722.833638907243, -25948.353042061724, -25670.38114940201, -25960.801131484717, -25859.620995068624, -25626.52642722719, -25860.885808580013, -25753.036526536976, -25771.236314150938, -25746.199955167915, -25755.06299386396, -25328.253683721272, -25585.840661300284, -25903.334880684706, -25883.117045280727], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.711523028431175, "mean_inference_ms": 0.2617057929843666, "mean_action_processing_ms": 0.062309831863375596, "mean_env_wait_ms": 1.554497274408296, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0036995410919189453, "StateBufferConnector_ms": 0.00272369384765625, "ViewRequirementAgentConnector_ms": 0.06863951683044434}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 237960, "num_agent_steps_trained": 237960, "num_env_steps_sampled": 237960, "num_env_steps_trained": 237960, "num_env_steps_sampled_this_iter": 1080, "num_env_steps_trained_this_iter": 1080, "num_env_steps_sampled_throughput_per_sec": 95.97410773401357, "num_env_steps_trained_throughput_per_sec": 95.97410773401357, "timesteps_total": 237960, "num_steps_trained_this_iter": 1080, "agent_timesteps_total": 237960, "timers": {"training_iteration_time_ms": 3781.043, "sample_time_ms": 3770.389, "load_time_ms": 0.298, "load_throughput": 1207766.309, "learn_time_ms": 9.61, "learn_throughput": 37460.106, "synch_weights_time_ms": 0.702}, "counters": {"num_env_steps_sampled": 237960, "num_env_steps_trained": 237960, "num_agent_steps_sampled": 237960, "num_agent_steps_trained": 237960}, "done": false, "episodes_total": 661, "training_iteration": 147, "trial_id": "f5e97_00000", "date": "2023-07-25_17-23-23", "timestamp": 1690295003, "time_this_iter_s": 11.255876779556274, "time_total_s": 1647.4305601119995, "pid": 71917, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[0, 0.003], [5400, 0.001], [10800, 0.00075], [16200, 0.0005], [21600, 0.00025], [27000, 0.0001], [32400, 7.5e-05], [37800, 5e-05], [43200, 2.5e-05], [48600, 1e-05], [54000, 7.5e-06], [59400, 5e-06], [64800, 2.5e-06], [70200, 1e-06], [75600, 5e-07], [81000, 1e-07]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x304530310>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1647.4305601119995, "iterations_since_restore": 147, "perf": {"cpu_util_percent": 24.9, "ram_util_percent": 78.125}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-07, "entropy_coeff": 0.1, "policy_entropy": -926.6997314453125, "policy_loss": -25843855051980.8, "vf_loss": 1118683404.8}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 3318.0, "diff_num_grad_updates_vs_sampler_policy": 3317.0}}, "num_env_steps_sampled": 239040, "num_env_steps_trained": 239040, "num_agent_steps_sampled": 239040, "num_agent_steps_trained": 239040}, "sampler_results": {"episode_reward_max": -25328.253683721272, "episode_reward_min": -26105.435092812302, "episode_reward_mean": -25744.823866241844, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-25704.311257363963, -25815.26912545352, -25700.99265257654, -25637.371647749467, -25585.901797595612, -25743.78194530946, -25730.88118511566, -25693.754176045648, -25698.066298154874, -25756.51197157061, -25905.5706532299, -25980.36756481758, -25393.582456681695, -25827.103134906156, -25646.06684443742, -25631.552966078983, -25399.489287253382, -25958.460820273434, -25862.615523121418, -25784.877557646454, -25520.706181154666, -25602.665316442188, -25778.991024729174, -25844.319635697706, -25968.00378102244, -25599.63654565638, -26105.435092812302, -25720.035707131035, -25847.888622810693, -25737.30769667045, -25678.96459864703, -25730.000865931677, -25944.927787284018, -25798.500653704446, -25548.90054753863, -25587.786097460936, -25688.644517865163, -25464.608163331468, -25864.021290339366, -25885.91731411878, -25553.700367281243, -26042.408552654564, -25602.224455599582, -25765.828737911692, -25687.931787524136, -25647.751173520413, -25708.912178971168, -25823.99841316268, -25832.175491726637, -25554.266391473473, -25959.410281017565, -25690.837084897732, -25402.97920299653, -25762.143345042303, -25758.082480843907, -25553.59971194014, -25798.768777476813, -25751.632972563755, -25762.996505865038, -25635.40099255635, -25790.150874345392, -25714.420763199465, -25898.81545949767, -25583.032472728108, -25599.747136461963, -26080.25220475557, -25961.523301868016, -25680.131995975335, -25704.700582997753, -25561.725188177534, -26006.813883461164, -25473.365698160313, -25981.49901079789, -25615.818742254272, -25774.966136668256, -25718.871942171663, -26023.329850619702, -25532.399431681537, -25598.4220706197, -26013.198021050313, -25943.011287423775, -25874.848682321674, -25722.833638907243, -25948.353042061724, -25670.38114940201, -25960.801131484717, -25859.620995068624, -25626.52642722719, -25860.885808580013, -25753.036526536976, -25771.236314150938, -25746.199955167915, -25755.06299386396, -25328.253683721272, -25585.840661300284, -25903.334880684706, -25883.117045280727, -25750.56693843077, -25524.682948370977, -26031.76853595171], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.725158687316081, "mean_inference_ms": 0.2623498251538959, "mean_action_processing_ms": 0.06246763316252659, "mean_env_wait_ms": 1.558786717039426, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003681659698486328, "StateBufferConnector_ms": 0.0027310848236083984, "ViewRequirementAgentConnector_ms": 0.06860518455505371}}, "episode_reward_max": -25328.253683721272, "episode_reward_min": -26105.435092812302, "episode_reward_mean": -25744.823866241844, "episode_len_mean": 360.0, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-25704.311257363963, -25815.26912545352, -25700.99265257654, -25637.371647749467, -25585.901797595612, -25743.78194530946, -25730.88118511566, -25693.754176045648, -25698.066298154874, -25756.51197157061, -25905.5706532299, -25980.36756481758, -25393.582456681695, -25827.103134906156, -25646.06684443742, -25631.552966078983, -25399.489287253382, -25958.460820273434, -25862.615523121418, -25784.877557646454, -25520.706181154666, -25602.665316442188, -25778.991024729174, -25844.319635697706, -25968.00378102244, -25599.63654565638, -26105.435092812302, -25720.035707131035, -25847.888622810693, -25737.30769667045, -25678.96459864703, -25730.000865931677, -25944.927787284018, -25798.500653704446, -25548.90054753863, -25587.786097460936, -25688.644517865163, -25464.608163331468, -25864.021290339366, -25885.91731411878, -25553.700367281243, -26042.408552654564, -25602.224455599582, -25765.828737911692, -25687.931787524136, -25647.751173520413, -25708.912178971168, -25823.99841316268, -25832.175491726637, -25554.266391473473, -25959.410281017565, -25690.837084897732, -25402.97920299653, -25762.143345042303, -25758.082480843907, -25553.59971194014, -25798.768777476813, -25751.632972563755, -25762.996505865038, -25635.40099255635, -25790.150874345392, -25714.420763199465, -25898.81545949767, -25583.032472728108, -25599.747136461963, -26080.25220475557, -25961.523301868016, -25680.131995975335, -25704.700582997753, -25561.725188177534, -26006.813883461164, -25473.365698160313, -25981.49901079789, -25615.818742254272, -25774.966136668256, -25718.871942171663, -26023.329850619702, -25532.399431681537, -25598.4220706197, -26013.198021050313, -25943.011287423775, -25874.848682321674, -25722.833638907243, -25948.353042061724, -25670.38114940201, -25960.801131484717, -25859.620995068624, -25626.52642722719, -25860.885808580013, -25753.036526536976, -25771.236314150938, -25746.199955167915, -25755.06299386396, -25328.253683721272, -25585.840661300284, -25903.334880684706, -25883.117045280727, -25750.56693843077, -25524.682948370977, -26031.76853595171], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.725158687316081, "mean_inference_ms": 0.2623498251538959, "mean_action_processing_ms": 0.06246763316252659, "mean_env_wait_ms": 1.558786717039426, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003681659698486328, "StateBufferConnector_ms": 0.0027310848236083984, "ViewRequirementAgentConnector_ms": 0.06860518455505371}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 239040, "num_agent_steps_trained": 239040, "num_env_steps_sampled": 239040, "num_env_steps_trained": 239040, "num_env_steps_sampled_this_iter": 1080, "num_env_steps_trained_this_iter": 1080, "num_env_steps_sampled_throughput_per_sec": 95.39057758443892, "num_env_steps_trained_throughput_per_sec": 95.39057758443892, "timesteps_total": 239040, "num_steps_trained_this_iter": 1080, "agent_timesteps_total": 239040, "timers": {"training_iteration_time_ms": 3771.882, "sample_time_ms": 3761.243, "load_time_ms": 0.299, "load_throughput": 1204586.709, "learn_time_ms": 9.594, "learn_throughput": 37522.196, "synch_weights_time_ms": 0.701}, "counters": {"num_env_steps_sampled": 239040, "num_env_steps_trained": 239040, "num_agent_steps_sampled": 239040, "num_agent_steps_trained": 239040}, "done": false, "episodes_total": 664, "training_iteration": 148, "trial_id": "f5e97_00000", "date": "2023-07-25_17-23-35", "timestamp": 1690295015, "time_this_iter_s": 11.324662923812866, "time_total_s": 1658.7552230358124, "pid": 71917, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[0, 0.003], [5400, 0.001], [10800, 0.00075], [16200, 0.0005], [21600, 0.00025], [27000, 0.0001], [32400, 7.5e-05], [37800, 5e-05], [43200, 2.5e-05], [48600, 1e-05], [54000, 7.5e-06], [59400, 5e-06], [64800, 2.5e-06], [70200, 1e-06], [75600, 5e-07], [81000, 1e-07]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x304530310>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1658.7552230358124, "iterations_since_restore": 148, "perf": {"cpu_util_percent": 24.4625, "ram_util_percent": 78.025}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-07, "entropy_coeff": 0.1, "policy_entropy": -926.6998046875, "policy_loss": -14550779559936.0, "vf_loss": 1100066329.6}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 3333.0, "diff_num_grad_updates_vs_sampler_policy": 3332.0}}, "num_env_steps_sampled": 240120, "num_env_steps_trained": 240120, "num_agent_steps_sampled": 240120, "num_agent_steps_trained": 240120}, "sampler_results": {"episode_reward_max": -25328.253683721272, "episode_reward_min": -26105.435092812302, "episode_reward_mean": -25742.80764596635, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-25637.371647749467, -25585.901797595612, -25743.78194530946, -25730.88118511566, -25693.754176045648, -25698.066298154874, -25756.51197157061, -25905.5706532299, -25980.36756481758, -25393.582456681695, -25827.103134906156, -25646.06684443742, -25631.552966078983, -25399.489287253382, -25958.460820273434, -25862.615523121418, -25784.877557646454, -25520.706181154666, -25602.665316442188, -25778.991024729174, -25844.319635697706, -25968.00378102244, -25599.63654565638, -26105.435092812302, -25720.035707131035, -25847.888622810693, -25737.30769667045, -25678.96459864703, -25730.000865931677, -25944.927787284018, -25798.500653704446, -25548.90054753863, -25587.786097460936, -25688.644517865163, -25464.608163331468, -25864.021290339366, -25885.91731411878, -25553.700367281243, -26042.408552654564, -25602.224455599582, -25765.828737911692, -25687.931787524136, -25647.751173520413, -25708.912178971168, -25823.99841316268, -25832.175491726637, -25554.266391473473, -25959.410281017565, -25690.837084897732, -25402.97920299653, -25762.143345042303, -25758.082480843907, -25553.59971194014, -25798.768777476813, -25751.632972563755, -25762.996505865038, -25635.40099255635, -25790.150874345392, -25714.420763199465, -25898.81545949767, -25583.032472728108, -25599.747136461963, -26080.25220475557, -25961.523301868016, -25680.131995975335, -25704.700582997753, -25561.725188177534, -26006.813883461164, -25473.365698160313, -25981.49901079789, -25615.818742254272, -25774.966136668256, -25718.871942171663, -26023.329850619702, -25532.399431681537, -25598.4220706197, -26013.198021050313, -25943.011287423775, -25874.848682321674, -25722.833638907243, -25948.353042061724, -25670.38114940201, -25960.801131484717, -25859.620995068624, -25626.52642722719, -25860.885808580013, -25753.036526536976, -25771.236314150938, -25746.199955167915, -25755.06299386396, -25328.253683721272, -25585.840661300284, -25903.334880684706, -25883.117045280727, -25750.56693843077, -25524.682948370977, -26031.76853595171, -25633.986617613973, -25591.02746779801, -25793.936922431694], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.738654112699644, "mean_inference_ms": 0.26298668235748207, "mean_action_processing_ms": 0.06262379174097177, "mean_env_wait_ms": 1.5630374156301516, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0036628246307373047, "StateBufferConnector_ms": 0.0027344226837158203, "ViewRequirementAgentConnector_ms": 0.06853055953979492}}, "episode_reward_max": -25328.253683721272, "episode_reward_min": -26105.435092812302, "episode_reward_mean": -25742.80764596635, "episode_len_mean": 360.0, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-25637.371647749467, -25585.901797595612, -25743.78194530946, -25730.88118511566, -25693.754176045648, -25698.066298154874, -25756.51197157061, -25905.5706532299, -25980.36756481758, -25393.582456681695, -25827.103134906156, -25646.06684443742, -25631.552966078983, -25399.489287253382, -25958.460820273434, -25862.615523121418, -25784.877557646454, -25520.706181154666, -25602.665316442188, -25778.991024729174, -25844.319635697706, -25968.00378102244, -25599.63654565638, -26105.435092812302, -25720.035707131035, -25847.888622810693, -25737.30769667045, -25678.96459864703, -25730.000865931677, -25944.927787284018, -25798.500653704446, -25548.90054753863, -25587.786097460936, -25688.644517865163, -25464.608163331468, -25864.021290339366, -25885.91731411878, -25553.700367281243, -26042.408552654564, -25602.224455599582, -25765.828737911692, -25687.931787524136, -25647.751173520413, -25708.912178971168, -25823.99841316268, -25832.175491726637, -25554.266391473473, -25959.410281017565, -25690.837084897732, -25402.97920299653, -25762.143345042303, -25758.082480843907, -25553.59971194014, -25798.768777476813, -25751.632972563755, -25762.996505865038, -25635.40099255635, -25790.150874345392, -25714.420763199465, -25898.81545949767, -25583.032472728108, -25599.747136461963, -26080.25220475557, -25961.523301868016, -25680.131995975335, -25704.700582997753, -25561.725188177534, -26006.813883461164, -25473.365698160313, -25981.49901079789, -25615.818742254272, -25774.966136668256, -25718.871942171663, -26023.329850619702, -25532.399431681537, -25598.4220706197, -26013.198021050313, -25943.011287423775, -25874.848682321674, -25722.833638907243, -25948.353042061724, -25670.38114940201, -25960.801131484717, -25859.620995068624, -25626.52642722719, -25860.885808580013, -25753.036526536976, -25771.236314150938, -25746.199955167915, -25755.06299386396, -25328.253683721272, -25585.840661300284, -25903.334880684706, -25883.117045280727, -25750.56693843077, -25524.682948370977, -26031.76853595171, -25633.986617613973, -25591.02746779801, -25793.936922431694], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.738654112699644, "mean_inference_ms": 0.26298668235748207, "mean_action_processing_ms": 0.06262379174097177, "mean_env_wait_ms": 1.5630374156301516, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0036628246307373047, "StateBufferConnector_ms": 0.0027344226837158203, "ViewRequirementAgentConnector_ms": 0.06853055953979492}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 240120, "num_agent_steps_trained": 240120, "num_env_steps_sampled": 240120, "num_env_steps_trained": 240120, "num_env_steps_sampled_this_iter": 1080, "num_env_steps_trained_this_iter": 1080, "num_env_steps_sampled_throughput_per_sec": 95.32982530277177, "num_env_steps_trained_throughput_per_sec": 95.32982530277177, "timesteps_total": 240120, "num_steps_trained_this_iter": 1080, "agent_timesteps_total": 240120, "timers": {"training_iteration_time_ms": 3762.416, "sample_time_ms": 3751.725, "load_time_ms": 0.313, "load_throughput": 1149211.843, "learn_time_ms": 9.632, "learn_throughput": 37374.431, "synch_weights_time_ms": 0.701}, "counters": {"num_env_steps_sampled": 240120, "num_env_steps_trained": 240120, "num_agent_steps_sampled": 240120, "num_agent_steps_trained": 240120}, "done": false, "episodes_total": 667, "training_iteration": 149, "trial_id": "f5e97_00000", "date": "2023-07-25_17-23-46", "timestamp": 1690295026, "time_this_iter_s": 11.331923961639404, "time_total_s": 1670.0871469974518, "pid": 71917, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[0, 0.003], [5400, 0.001], [10800, 0.00075], [16200, 0.0005], [21600, 0.00025], [27000, 0.0001], [32400, 7.5e-05], [37800, 5e-05], [43200, 2.5e-05], [48600, 1e-05], [54000, 7.5e-06], [59400, 5e-06], [64800, 2.5e-06], [70200, 1e-06], [75600, 5e-07], [81000, 1e-07]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x304530310>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1670.0871469974518, "iterations_since_restore": 149, "perf": {"cpu_util_percent": 25.49375, "ram_util_percent": 78.10625}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-07, "entropy_coeff": 0.1, "policy_entropy": -926.6997192382812, "policy_loss": -32878660912742.4, "vf_loss": 1114855782.4}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 3348.0, "diff_num_grad_updates_vs_sampler_policy": 3347.0}}, "num_env_steps_sampled": 241200, "num_env_steps_trained": 241200, "num_agent_steps_sampled": 241200, "num_agent_steps_trained": 241200}, "sampler_results": {"episode_reward_max": -25328.253683721272, "episode_reward_min": -26105.435092812302, "episode_reward_mean": -25745.25931748269, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-25730.88118511566, -25693.754176045648, -25698.066298154874, -25756.51197157061, -25905.5706532299, -25980.36756481758, -25393.582456681695, -25827.103134906156, -25646.06684443742, -25631.552966078983, -25399.489287253382, -25958.460820273434, -25862.615523121418, -25784.877557646454, -25520.706181154666, -25602.665316442188, -25778.991024729174, -25844.319635697706, -25968.00378102244, -25599.63654565638, -26105.435092812302, -25720.035707131035, -25847.888622810693, -25737.30769667045, -25678.96459864703, -25730.000865931677, -25944.927787284018, -25798.500653704446, -25548.90054753863, -25587.786097460936, -25688.644517865163, -25464.608163331468, -25864.021290339366, -25885.91731411878, -25553.700367281243, -26042.408552654564, -25602.224455599582, -25765.828737911692, -25687.931787524136, -25647.751173520413, -25708.912178971168, -25823.99841316268, -25832.175491726637, -25554.266391473473, -25959.410281017565, -25690.837084897732, -25402.97920299653, -25762.143345042303, -25758.082480843907, -25553.59971194014, -25798.768777476813, -25751.632972563755, -25762.996505865038, -25635.40099255635, -25790.150874345392, -25714.420763199465, -25898.81545949767, -25583.032472728108, -25599.747136461963, -26080.25220475557, -25961.523301868016, -25680.131995975335, -25704.700582997753, -25561.725188177534, -26006.813883461164, -25473.365698160313, -25981.49901079789, -25615.818742254272, -25774.966136668256, -25718.871942171663, -26023.329850619702, -25532.399431681537, -25598.4220706197, -26013.198021050313, -25943.011287423775, -25874.848682321674, -25722.833638907243, -25948.353042061724, -25670.38114940201, -25960.801131484717, -25859.620995068624, -25626.52642722719, -25860.885808580013, -25753.036526536976, -25771.236314150938, -25746.199955167915, -25755.06299386396, -25328.253683721272, -25585.840661300284, -25903.334880684706, -25883.117045280727, -25750.56693843077, -25524.682948370977, -26031.76853595171, -25633.986617613973, -25591.02746779801, -25793.936922431694, -25463.685355827132, -25818.945219197565, -25929.59196726394], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.751994815639729, "mean_inference_ms": 0.2636177359339627, "mean_action_processing_ms": 0.06277849292791891, "mean_env_wait_ms": 1.5672681278022629, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00365447998046875, "StateBufferConnector_ms": 0.0027313232421875, "ViewRequirementAgentConnector_ms": 0.06846022605895996}}, "episode_reward_max": -25328.253683721272, "episode_reward_min": -26105.435092812302, "episode_reward_mean": -25745.25931748269, "episode_len_mean": 360.0, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-25730.88118511566, -25693.754176045648, -25698.066298154874, -25756.51197157061, -25905.5706532299, -25980.36756481758, -25393.582456681695, -25827.103134906156, -25646.06684443742, -25631.552966078983, -25399.489287253382, -25958.460820273434, -25862.615523121418, -25784.877557646454, -25520.706181154666, -25602.665316442188, -25778.991024729174, -25844.319635697706, -25968.00378102244, -25599.63654565638, -26105.435092812302, -25720.035707131035, -25847.888622810693, -25737.30769667045, -25678.96459864703, -25730.000865931677, -25944.927787284018, -25798.500653704446, -25548.90054753863, -25587.786097460936, -25688.644517865163, -25464.608163331468, -25864.021290339366, -25885.91731411878, -25553.700367281243, -26042.408552654564, -25602.224455599582, -25765.828737911692, -25687.931787524136, -25647.751173520413, -25708.912178971168, -25823.99841316268, -25832.175491726637, -25554.266391473473, -25959.410281017565, -25690.837084897732, -25402.97920299653, -25762.143345042303, -25758.082480843907, -25553.59971194014, -25798.768777476813, -25751.632972563755, -25762.996505865038, -25635.40099255635, -25790.150874345392, -25714.420763199465, -25898.81545949767, -25583.032472728108, -25599.747136461963, -26080.25220475557, -25961.523301868016, -25680.131995975335, -25704.700582997753, -25561.725188177534, -26006.813883461164, -25473.365698160313, -25981.49901079789, -25615.818742254272, -25774.966136668256, -25718.871942171663, -26023.329850619702, -25532.399431681537, -25598.4220706197, -26013.198021050313, -25943.011287423775, -25874.848682321674, -25722.833638907243, -25948.353042061724, -25670.38114940201, -25960.801131484717, -25859.620995068624, -25626.52642722719, -25860.885808580013, -25753.036526536976, -25771.236314150938, -25746.199955167915, -25755.06299386396, -25328.253683721272, -25585.840661300284, -25903.334880684706, -25883.117045280727, -25750.56693843077, -25524.682948370977, -26031.76853595171, -25633.986617613973, -25591.02746779801, -25793.936922431694, -25463.685355827132, -25818.945219197565, -25929.59196726394], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.751994815639729, "mean_inference_ms": 0.2636177359339627, "mean_action_processing_ms": 0.06277849292791891, "mean_env_wait_ms": 1.5672681278022629, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00365447998046875, "StateBufferConnector_ms": 0.0027313232421875, "ViewRequirementAgentConnector_ms": 0.06846022605895996}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 241200, "num_agent_steps_trained": 241200, "num_env_steps_sampled": 241200, "num_env_steps_trained": 241200, "num_env_steps_sampled_this_iter": 1080, "num_env_steps_trained_this_iter": 1080, "num_env_steps_sampled_throughput_per_sec": 95.74249959741361, "num_env_steps_trained_throughput_per_sec": 95.74249959741361, "timesteps_total": 241200, "num_steps_trained_this_iter": 1080, "agent_timesteps_total": 241200, "timers": {"training_iteration_time_ms": 3753.971, "sample_time_ms": 3743.126, "load_time_ms": 0.316, "load_throughput": 1139154.613, "learn_time_ms": 9.78, "learn_throughput": 36808.284, "synch_weights_time_ms": 0.704}, "counters": {"num_env_steps_sampled": 241200, "num_env_steps_trained": 241200, "num_agent_steps_sampled": 241200, "num_agent_steps_trained": 241200}, "done": false, "episodes_total": 670, "training_iteration": 150, "trial_id": "f5e97_00000", "date": "2023-07-25_17-23-57", "timestamp": 1690295037, "time_this_iter_s": 11.283046245574951, "time_total_s": 1681.3701932430267, "pid": 71917, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[0, 0.003], [5400, 0.001], [10800, 0.00075], [16200, 0.0005], [21600, 0.00025], [27000, 0.0001], [32400, 7.5e-05], [37800, 5e-05], [43200, 2.5e-05], [48600, 1e-05], [54000, 7.5e-06], [59400, 5e-06], [64800, 2.5e-06], [70200, 1e-06], [75600, 5e-07], [81000, 1e-07]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x304530310>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1681.3701932430267, "iterations_since_restore": 150, "perf": {"cpu_util_percent": 25.2375, "ram_util_percent": 77.93125}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-07, "entropy_coeff": 0.1, "policy_entropy": -926.6997192382812, "policy_loss": -23044608183500.8, "vf_loss": 1116741094.4}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 3363.0, "diff_num_grad_updates_vs_sampler_policy": 3362.0}}, "num_env_steps_sampled": 242280, "num_env_steps_trained": 242280, "num_agent_steps_sampled": 242280, "num_agent_steps_trained": 242280}, "sampler_results": {"episode_reward_max": -25328.253683721272, "episode_reward_min": -26105.435092812302, "episode_reward_mean": -25745.692862231223, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-25756.51197157061, -25905.5706532299, -25980.36756481758, -25393.582456681695, -25827.103134906156, -25646.06684443742, -25631.552966078983, -25399.489287253382, -25958.460820273434, -25862.615523121418, -25784.877557646454, -25520.706181154666, -25602.665316442188, -25778.991024729174, -25844.319635697706, -25968.00378102244, -25599.63654565638, -26105.435092812302, -25720.035707131035, -25847.888622810693, -25737.30769667045, -25678.96459864703, -25730.000865931677, -25944.927787284018, -25798.500653704446, -25548.90054753863, -25587.786097460936, -25688.644517865163, -25464.608163331468, -25864.021290339366, -25885.91731411878, -25553.700367281243, -26042.408552654564, -25602.224455599582, -25765.828737911692, -25687.931787524136, -25647.751173520413, -25708.912178971168, -25823.99841316268, -25832.175491726637, -25554.266391473473, -25959.410281017565, -25690.837084897732, -25402.97920299653, -25762.143345042303, -25758.082480843907, -25553.59971194014, -25798.768777476813, -25751.632972563755, -25762.996505865038, -25635.40099255635, -25790.150874345392, -25714.420763199465, -25898.81545949767, -25583.032472728108, -25599.747136461963, -26080.25220475557, -25961.523301868016, -25680.131995975335, -25704.700582997753, -25561.725188177534, -26006.813883461164, -25473.365698160313, -25981.49901079789, -25615.818742254272, -25774.966136668256, -25718.871942171663, -26023.329850619702, -25532.399431681537, -25598.4220706197, -26013.198021050313, -25943.011287423775, -25874.848682321674, -25722.833638907243, -25948.353042061724, -25670.38114940201, -25960.801131484717, -25859.620995068624, -25626.52642722719, -25860.885808580013, -25753.036526536976, -25771.236314150938, -25746.199955167915, -25755.06299386396, -25328.253683721272, -25585.840661300284, -25903.334880684706, -25883.117045280727, -25750.56693843077, -25524.682948370977, -26031.76853595171, -25633.986617613973, -25591.02746779801, -25793.936922431694, -25463.685355827132, -25818.945219197565, -25929.59196726394, -25527.034487603927, -25690.213584724686, -25948.808061841275], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.765208843814347, "mean_inference_ms": 0.2642426982165846, "mean_action_processing_ms": 0.06293178095991248, "mean_env_wait_ms": 1.5714449621301574, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0036716461181640625, "StateBufferConnector_ms": 0.0027387142181396484, "ViewRequirementAgentConnector_ms": 0.06875205039978027}}, "episode_reward_max": -25328.253683721272, "episode_reward_min": -26105.435092812302, "episode_reward_mean": -25745.692862231223, "episode_len_mean": 360.0, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-25756.51197157061, -25905.5706532299, -25980.36756481758, -25393.582456681695, -25827.103134906156, -25646.06684443742, -25631.552966078983, -25399.489287253382, -25958.460820273434, -25862.615523121418, -25784.877557646454, -25520.706181154666, -25602.665316442188, -25778.991024729174, -25844.319635697706, -25968.00378102244, -25599.63654565638, -26105.435092812302, -25720.035707131035, -25847.888622810693, -25737.30769667045, -25678.96459864703, -25730.000865931677, -25944.927787284018, -25798.500653704446, -25548.90054753863, -25587.786097460936, -25688.644517865163, -25464.608163331468, -25864.021290339366, -25885.91731411878, -25553.700367281243, -26042.408552654564, -25602.224455599582, -25765.828737911692, -25687.931787524136, -25647.751173520413, -25708.912178971168, -25823.99841316268, -25832.175491726637, -25554.266391473473, -25959.410281017565, -25690.837084897732, -25402.97920299653, -25762.143345042303, -25758.082480843907, -25553.59971194014, -25798.768777476813, -25751.632972563755, -25762.996505865038, -25635.40099255635, -25790.150874345392, -25714.420763199465, -25898.81545949767, -25583.032472728108, -25599.747136461963, -26080.25220475557, -25961.523301868016, -25680.131995975335, -25704.700582997753, -25561.725188177534, -26006.813883461164, -25473.365698160313, -25981.49901079789, -25615.818742254272, -25774.966136668256, -25718.871942171663, -26023.329850619702, -25532.399431681537, -25598.4220706197, -26013.198021050313, -25943.011287423775, -25874.848682321674, -25722.833638907243, -25948.353042061724, -25670.38114940201, -25960.801131484717, -25859.620995068624, -25626.52642722719, -25860.885808580013, -25753.036526536976, -25771.236314150938, -25746.199955167915, -25755.06299386396, -25328.253683721272, -25585.840661300284, -25903.334880684706, -25883.117045280727, -25750.56693843077, -25524.682948370977, -26031.76853595171, -25633.986617613973, -25591.02746779801, -25793.936922431694, -25463.685355827132, -25818.945219197565, -25929.59196726394, -25527.034487603927, -25690.213584724686, -25948.808061841275], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.765208843814347, "mean_inference_ms": 0.2642426982165846, "mean_action_processing_ms": 0.06293178095991248, "mean_env_wait_ms": 1.5714449621301574, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0036716461181640625, "StateBufferConnector_ms": 0.0027387142181396484, "ViewRequirementAgentConnector_ms": 0.06875205039978027}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 242280, "num_agent_steps_trained": 242280, "num_env_steps_sampled": 242280, "num_env_steps_trained": 242280, "num_env_steps_sampled_this_iter": 1080, "num_env_steps_trained_this_iter": 1080, "num_env_steps_sampled_throughput_per_sec": 95.86512303272043, "num_env_steps_trained_throughput_per_sec": 95.86512303272043, "timesteps_total": 242280, "num_steps_trained_this_iter": 1080, "agent_timesteps_total": 242280, "timers": {"training_iteration_time_ms": 3753.751, "sample_time_ms": 3742.921, "load_time_ms": 0.317, "load_throughput": 1137267.033, "learn_time_ms": 9.766, "learn_throughput": 36860.76, "synch_weights_time_ms": 0.703}, "counters": {"num_env_steps_sampled": 242280, "num_env_steps_trained": 242280, "num_agent_steps_sampled": 242280, "num_agent_steps_trained": 242280}, "done": false, "episodes_total": 673, "training_iteration": 151, "trial_id": "f5e97_00000", "date": "2023-07-25_17-24-09", "timestamp": 1690295049, "time_this_iter_s": 11.268692016601562, "time_total_s": 1692.6388852596283, "pid": 71917, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[0, 0.003], [5400, 0.001], [10800, 0.00075], [16200, 0.0005], [21600, 0.00025], [27000, 0.0001], [32400, 7.5e-05], [37800, 5e-05], [43200, 2.5e-05], [48600, 1e-05], [54000, 7.5e-06], [59400, 5e-06], [64800, 2.5e-06], [70200, 1e-06], [75600, 5e-07], [81000, 1e-07]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x304530310>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1692.6388852596283, "iterations_since_restore": 151, "perf": {"cpu_util_percent": 28.33125, "ram_util_percent": 78.14375000000001}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-07, "entropy_coeff": 0.1, "policy_entropy": -926.6998657226562, "policy_loss": -8528003688038.4, "vf_loss": 1088322963.2}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 3378.0, "diff_num_grad_updates_vs_sampler_policy": 3377.0}}, "num_env_steps_sampled": 243360, "num_env_steps_trained": 243360, "num_agent_steps_sampled": 243360, "num_agent_steps_trained": 243360}, "sampler_results": {"episode_reward_max": -25328.253683721272, "episode_reward_min": -26105.435092812302, "episode_reward_mean": -25738.010064088587, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-25393.582456681695, -25827.103134906156, -25646.06684443742, -25631.552966078983, -25399.489287253382, -25958.460820273434, -25862.615523121418, -25784.877557646454, -25520.706181154666, -25602.665316442188, -25778.991024729174, -25844.319635697706, -25968.00378102244, -25599.63654565638, -26105.435092812302, -25720.035707131035, -25847.888622810693, -25737.30769667045, -25678.96459864703, -25730.000865931677, -25944.927787284018, -25798.500653704446, -25548.90054753863, -25587.786097460936, -25688.644517865163, -25464.608163331468, -25864.021290339366, -25885.91731411878, -25553.700367281243, -26042.408552654564, -25602.224455599582, -25765.828737911692, -25687.931787524136, -25647.751173520413, -25708.912178971168, -25823.99841316268, -25832.175491726637, -25554.266391473473, -25959.410281017565, -25690.837084897732, -25402.97920299653, -25762.143345042303, -25758.082480843907, -25553.59971194014, -25798.768777476813, -25751.632972563755, -25762.996505865038, -25635.40099255635, -25790.150874345392, -25714.420763199465, -25898.81545949767, -25583.032472728108, -25599.747136461963, -26080.25220475557, -25961.523301868016, -25680.131995975335, -25704.700582997753, -25561.725188177534, -26006.813883461164, -25473.365698160313, -25981.49901079789, -25615.818742254272, -25774.966136668256, -25718.871942171663, -26023.329850619702, -25532.399431681537, -25598.4220706197, -26013.198021050313, -25943.011287423775, -25874.848682321674, -25722.833638907243, -25948.353042061724, -25670.38114940201, -25960.801131484717, -25859.620995068624, -25626.52642722719, -25860.885808580013, -25753.036526536976, -25771.236314150938, -25746.199955167915, -25755.06299386396, -25328.253683721272, -25585.840661300284, -25903.334880684706, -25883.117045280727, -25750.56693843077, -25524.682948370977, -26031.76853595171, -25633.986617613973, -25591.02746779801, -25793.936922431694, -25463.685355827132, -25818.945219197565, -25929.59196726394, -25527.034487603927, -25690.213584724686, -25948.808061841275, -25735.575857059477, -25531.92318411009, -25606.671334184066], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.778310971464072, "mean_inference_ms": 0.2648617333180374, "mean_action_processing_ms": 0.0630836552994427, "mean_env_wait_ms": 1.5755886999363724, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0036666393280029297, "StateBufferConnector_ms": 0.002737760543823242, "ViewRequirementAgentConnector_ms": 0.0687708854675293}}, "episode_reward_max": -25328.253683721272, "episode_reward_min": -26105.435092812302, "episode_reward_mean": -25738.010064088587, "episode_len_mean": 360.0, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-25393.582456681695, -25827.103134906156, -25646.06684443742, -25631.552966078983, -25399.489287253382, -25958.460820273434, -25862.615523121418, -25784.877557646454, -25520.706181154666, -25602.665316442188, -25778.991024729174, -25844.319635697706, -25968.00378102244, -25599.63654565638, -26105.435092812302, -25720.035707131035, -25847.888622810693, -25737.30769667045, -25678.96459864703, -25730.000865931677, -25944.927787284018, -25798.500653704446, -25548.90054753863, -25587.786097460936, -25688.644517865163, -25464.608163331468, -25864.021290339366, -25885.91731411878, -25553.700367281243, -26042.408552654564, -25602.224455599582, -25765.828737911692, -25687.931787524136, -25647.751173520413, -25708.912178971168, -25823.99841316268, -25832.175491726637, -25554.266391473473, -25959.410281017565, -25690.837084897732, -25402.97920299653, -25762.143345042303, -25758.082480843907, -25553.59971194014, -25798.768777476813, -25751.632972563755, -25762.996505865038, -25635.40099255635, -25790.150874345392, -25714.420763199465, -25898.81545949767, -25583.032472728108, -25599.747136461963, -26080.25220475557, -25961.523301868016, -25680.131995975335, -25704.700582997753, -25561.725188177534, -26006.813883461164, -25473.365698160313, -25981.49901079789, -25615.818742254272, -25774.966136668256, -25718.871942171663, -26023.329850619702, -25532.399431681537, -25598.4220706197, -26013.198021050313, -25943.011287423775, -25874.848682321674, -25722.833638907243, -25948.353042061724, -25670.38114940201, -25960.801131484717, -25859.620995068624, -25626.52642722719, -25860.885808580013, -25753.036526536976, -25771.236314150938, -25746.199955167915, -25755.06299386396, -25328.253683721272, -25585.840661300284, -25903.334880684706, -25883.117045280727, -25750.56693843077, -25524.682948370977, -26031.76853595171, -25633.986617613973, -25591.02746779801, -25793.936922431694, -25463.685355827132, -25818.945219197565, -25929.59196726394, -25527.034487603927, -25690.213584724686, -25948.808061841275, -25735.575857059477, -25531.92318411009, -25606.671334184066], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.778310971464072, "mean_inference_ms": 0.2648617333180374, "mean_action_processing_ms": 0.0630836552994427, "mean_env_wait_ms": 1.5755886999363724, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0036666393280029297, "StateBufferConnector_ms": 0.002737760543823242, "ViewRequirementAgentConnector_ms": 0.0687708854675293}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 243360, "num_agent_steps_trained": 243360, "num_env_steps_sampled": 243360, "num_env_steps_trained": 243360, "num_env_steps_sampled_this_iter": 1080, "num_env_steps_trained_this_iter": 1080, "num_env_steps_sampled_throughput_per_sec": 93.90737607433998, "num_env_steps_trained_throughput_per_sec": 93.90737607433998, "timesteps_total": 243360, "num_steps_trained_this_iter": 1080, "agent_timesteps_total": 243360, "timers": {"training_iteration_time_ms": 3779.082, "sample_time_ms": 3768.232, "load_time_ms": 0.303, "load_throughput": 1189967.247, "learn_time_ms": 9.779, "learn_throughput": 36814.746, "synch_weights_time_ms": 0.724}, "counters": {"num_env_steps_sampled": 243360, "num_env_steps_trained": 243360, "num_agent_steps_sampled": 243360, "num_agent_steps_trained": 243360}, "done": false, "episodes_total": 676, "training_iteration": 152, "trial_id": "f5e97_00000", "date": "2023-07-25_17-24-20", "timestamp": 1690295060, "time_this_iter_s": 11.503511667251587, "time_total_s": 1704.1423969268799, "pid": 71917, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[0, 0.003], [5400, 0.001], [10800, 0.00075], [16200, 0.0005], [21600, 0.00025], [27000, 0.0001], [32400, 7.5e-05], [37800, 5e-05], [43200, 2.5e-05], [48600, 1e-05], [54000, 7.5e-06], [59400, 5e-06], [64800, 2.5e-06], [70200, 1e-06], [75600, 5e-07], [81000, 1e-07]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x304530310>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1704.1423969268799, "iterations_since_restore": 152, "perf": {"cpu_util_percent": 23.54705882352941, "ram_util_percent": 77.3235294117647}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-07, "entropy_coeff": 0.1, "policy_entropy": -926.6996337890625, "policy_loss": -16292420386816.0, "vf_loss": 1113124115.2}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 3393.0, "diff_num_grad_updates_vs_sampler_policy": 3392.0}}, "num_env_steps_sampled": 244440, "num_env_steps_trained": 244440, "num_agent_steps_sampled": 244440, "num_agent_steps_trained": 244440}, "sampler_results": {"episode_reward_max": -25328.253683721272, "episode_reward_min": -26105.435092812302, "episode_reward_mean": -25742.094984253683, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-25631.552966078983, -25399.489287253382, -25958.460820273434, -25862.615523121418, -25784.877557646454, -25520.706181154666, -25602.665316442188, -25778.991024729174, -25844.319635697706, -25968.00378102244, -25599.63654565638, -26105.435092812302, -25720.035707131035, -25847.888622810693, -25737.30769667045, -25678.96459864703, -25730.000865931677, -25944.927787284018, -25798.500653704446, -25548.90054753863, -25587.786097460936, -25688.644517865163, -25464.608163331468, -25864.021290339366, -25885.91731411878, -25553.700367281243, -26042.408552654564, -25602.224455599582, -25765.828737911692, -25687.931787524136, -25647.751173520413, -25708.912178971168, -25823.99841316268, -25832.175491726637, -25554.266391473473, -25959.410281017565, -25690.837084897732, -25402.97920299653, -25762.143345042303, -25758.082480843907, -25553.59971194014, -25798.768777476813, -25751.632972563755, -25762.996505865038, -25635.40099255635, -25790.150874345392, -25714.420763199465, -25898.81545949767, -25583.032472728108, -25599.747136461963, -26080.25220475557, -25961.523301868016, -25680.131995975335, -25704.700582997753, -25561.725188177534, -26006.813883461164, -25473.365698160313, -25981.49901079789, -25615.818742254272, -25774.966136668256, -25718.871942171663, -26023.329850619702, -25532.399431681537, -25598.4220706197, -26013.198021050313, -25943.011287423775, -25874.848682321674, -25722.833638907243, -25948.353042061724, -25670.38114940201, -25960.801131484717, -25859.620995068624, -25626.52642722719, -25860.885808580013, -25753.036526536976, -25771.236314150938, -25746.199955167915, -25755.06299386396, -25328.253683721272, -25585.840661300284, -25903.334880684706, -25883.117045280727, -25750.56693843077, -25524.682948370977, -26031.76853595171, -25633.986617613973, -25591.02746779801, -25793.936922431694, -25463.685355827132, -25818.945219197565, -25929.59196726394, -25527.034487603927, -25690.213584724686, -25948.808061841275, -25735.575857059477, -25531.92318411009, -25606.671334184066, -25592.0114195276, -25796.179823003586, -25887.053210004226], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.791278425793961, "mean_inference_ms": 0.26547568930136545, "mean_action_processing_ms": 0.06323415549038378, "mean_env_wait_ms": 1.5796977482444376, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003664731979370117, "StateBufferConnector_ms": 0.0027298927307128906, "ViewRequirementAgentConnector_ms": 0.06868290901184082}}, "episode_reward_max": -25328.253683721272, "episode_reward_min": -26105.435092812302, "episode_reward_mean": -25742.094984253683, "episode_len_mean": 360.0, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-25631.552966078983, -25399.489287253382, -25958.460820273434, -25862.615523121418, -25784.877557646454, -25520.706181154666, -25602.665316442188, -25778.991024729174, -25844.319635697706, -25968.00378102244, -25599.63654565638, -26105.435092812302, -25720.035707131035, -25847.888622810693, -25737.30769667045, -25678.96459864703, -25730.000865931677, -25944.927787284018, -25798.500653704446, -25548.90054753863, -25587.786097460936, -25688.644517865163, -25464.608163331468, -25864.021290339366, -25885.91731411878, -25553.700367281243, -26042.408552654564, -25602.224455599582, -25765.828737911692, -25687.931787524136, -25647.751173520413, -25708.912178971168, -25823.99841316268, -25832.175491726637, -25554.266391473473, -25959.410281017565, -25690.837084897732, -25402.97920299653, -25762.143345042303, -25758.082480843907, -25553.59971194014, -25798.768777476813, -25751.632972563755, -25762.996505865038, -25635.40099255635, -25790.150874345392, -25714.420763199465, -25898.81545949767, -25583.032472728108, -25599.747136461963, -26080.25220475557, -25961.523301868016, -25680.131995975335, -25704.700582997753, -25561.725188177534, -26006.813883461164, -25473.365698160313, -25981.49901079789, -25615.818742254272, -25774.966136668256, -25718.871942171663, -26023.329850619702, -25532.399431681537, -25598.4220706197, -26013.198021050313, -25943.011287423775, -25874.848682321674, -25722.833638907243, -25948.353042061724, -25670.38114940201, -25960.801131484717, -25859.620995068624, -25626.52642722719, -25860.885808580013, -25753.036526536976, -25771.236314150938, -25746.199955167915, -25755.06299386396, -25328.253683721272, -25585.840661300284, -25903.334880684706, -25883.117045280727, -25750.56693843077, -25524.682948370977, -26031.76853595171, -25633.986617613973, -25591.02746779801, -25793.936922431694, -25463.685355827132, -25818.945219197565, -25929.59196726394, -25527.034487603927, -25690.213584724686, -25948.808061841275, -25735.575857059477, -25531.92318411009, -25606.671334184066, -25592.0114195276, -25796.179823003586, -25887.053210004226], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.791278425793961, "mean_inference_ms": 0.26547568930136545, "mean_action_processing_ms": 0.06323415549038378, "mean_env_wait_ms": 1.5796977482444376, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003664731979370117, "StateBufferConnector_ms": 0.0027298927307128906, "ViewRequirementAgentConnector_ms": 0.06868290901184082}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 244440, "num_agent_steps_trained": 244440, "num_env_steps_sampled": 244440, "num_env_steps_trained": 244440, "num_env_steps_sampled_this_iter": 1080, "num_env_steps_trained_this_iter": 1080, "num_env_steps_sampled_throughput_per_sec": 96.16907165332526, "num_env_steps_trained_throughput_per_sec": 96.16907165332526, "timesteps_total": 244440, "num_steps_trained_this_iter": 1080, "agent_timesteps_total": 244440, "timers": {"training_iteration_time_ms": 3773.698, "sample_time_ms": 3763.032, "load_time_ms": 0.305, "load_throughput": 1180847.298, "learn_time_ms": 9.612, "learn_throughput": 37454.438, "synch_weights_time_ms": 0.706}, "counters": {"num_env_steps_sampled": 244440, "num_env_steps_trained": 244440, "num_agent_steps_sampled": 244440, "num_agent_steps_trained": 244440}, "done": false, "episodes_total": 679, "training_iteration": 153, "trial_id": "f5e97_00000", "date": "2023-07-25_17-24-31", "timestamp": 1690295071, "time_this_iter_s": 11.23303484916687, "time_total_s": 1715.3754317760468, "pid": 71917, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[0, 0.003], [5400, 0.001], [10800, 0.00075], [16200, 0.0005], [21600, 0.00025], [27000, 0.0001], [32400, 7.5e-05], [37800, 5e-05], [43200, 2.5e-05], [48600, 1e-05], [54000, 7.5e-06], [59400, 5e-06], [64800, 2.5e-06], [70200, 1e-06], [75600, 5e-07], [81000, 1e-07]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x304530310>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1715.3754317760468, "iterations_since_restore": 153, "perf": {"cpu_util_percent": 24.6125, "ram_util_percent": 76.65625}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-07, "entropy_coeff": 0.1, "policy_entropy": -926.70009765625, "policy_loss": -16939700938342.4, "vf_loss": 1071073728.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 3408.0, "diff_num_grad_updates_vs_sampler_policy": 3407.0}}, "num_env_steps_sampled": 245520, "num_env_steps_trained": 245520, "num_agent_steps_sampled": 245520, "num_agent_steps_trained": 245520}, "sampler_results": {"episode_reward_max": -25328.253683721272, "episode_reward_min": -26105.435092812302, "episode_reward_mean": -25744.243239452415, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-25862.615523121418, -25784.877557646454, -25520.706181154666, -25602.665316442188, -25778.991024729174, -25844.319635697706, -25968.00378102244, -25599.63654565638, -26105.435092812302, -25720.035707131035, -25847.888622810693, -25737.30769667045, -25678.96459864703, -25730.000865931677, -25944.927787284018, -25798.500653704446, -25548.90054753863, -25587.786097460936, -25688.644517865163, -25464.608163331468, -25864.021290339366, -25885.91731411878, -25553.700367281243, -26042.408552654564, -25602.224455599582, -25765.828737911692, -25687.931787524136, -25647.751173520413, -25708.912178971168, -25823.99841316268, -25832.175491726637, -25554.266391473473, -25959.410281017565, -25690.837084897732, -25402.97920299653, -25762.143345042303, -25758.082480843907, -25553.59971194014, -25798.768777476813, -25751.632972563755, -25762.996505865038, -25635.40099255635, -25790.150874345392, -25714.420763199465, -25898.81545949767, -25583.032472728108, -25599.747136461963, -26080.25220475557, -25961.523301868016, -25680.131995975335, -25704.700582997753, -25561.725188177534, -26006.813883461164, -25473.365698160313, -25981.49901079789, -25615.818742254272, -25774.966136668256, -25718.871942171663, -26023.329850619702, -25532.399431681537, -25598.4220706197, -26013.198021050313, -25943.011287423775, -25874.848682321674, -25722.833638907243, -25948.353042061724, -25670.38114940201, -25960.801131484717, -25859.620995068624, -25626.52642722719, -25860.885808580013, -25753.036526536976, -25771.236314150938, -25746.199955167915, -25755.06299386396, -25328.253683721272, -25585.840661300284, -25903.334880684706, -25883.117045280727, -25750.56693843077, -25524.682948370977, -26031.76853595171, -25633.986617613973, -25591.02746779801, -25793.936922431694, -25463.685355827132, -25818.945219197565, -25929.59196726394, -25527.034487603927, -25690.213584724686, -25948.808061841275, -25735.575857059477, -25531.92318411009, -25606.671334184066, -25592.0114195276, -25796.179823003586, -25887.053210004226, -25743.554373883482, -26020.766098537446, -25440.00812105769], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.804116042938439, "mean_inference_ms": 0.2660833456474448, "mean_action_processing_ms": 0.06338308737794089, "mean_env_wait_ms": 1.5837622246939451, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003662109375, "StateBufferConnector_ms": 0.0027303695678710938, "ViewRequirementAgentConnector_ms": 0.0685884952545166}}, "episode_reward_max": -25328.253683721272, "episode_reward_min": -26105.435092812302, "episode_reward_mean": -25744.243239452415, "episode_len_mean": 360.0, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-25862.615523121418, -25784.877557646454, -25520.706181154666, -25602.665316442188, -25778.991024729174, -25844.319635697706, -25968.00378102244, -25599.63654565638, -26105.435092812302, -25720.035707131035, -25847.888622810693, -25737.30769667045, -25678.96459864703, -25730.000865931677, -25944.927787284018, -25798.500653704446, -25548.90054753863, -25587.786097460936, -25688.644517865163, -25464.608163331468, -25864.021290339366, -25885.91731411878, -25553.700367281243, -26042.408552654564, -25602.224455599582, -25765.828737911692, -25687.931787524136, -25647.751173520413, -25708.912178971168, -25823.99841316268, -25832.175491726637, -25554.266391473473, -25959.410281017565, -25690.837084897732, -25402.97920299653, -25762.143345042303, -25758.082480843907, -25553.59971194014, -25798.768777476813, -25751.632972563755, -25762.996505865038, -25635.40099255635, -25790.150874345392, -25714.420763199465, -25898.81545949767, -25583.032472728108, -25599.747136461963, -26080.25220475557, -25961.523301868016, -25680.131995975335, -25704.700582997753, -25561.725188177534, -26006.813883461164, -25473.365698160313, -25981.49901079789, -25615.818742254272, -25774.966136668256, -25718.871942171663, -26023.329850619702, -25532.399431681537, -25598.4220706197, -26013.198021050313, -25943.011287423775, -25874.848682321674, -25722.833638907243, -25948.353042061724, -25670.38114940201, -25960.801131484717, -25859.620995068624, -25626.52642722719, -25860.885808580013, -25753.036526536976, -25771.236314150938, -25746.199955167915, -25755.06299386396, -25328.253683721272, -25585.840661300284, -25903.334880684706, -25883.117045280727, -25750.56693843077, -25524.682948370977, -26031.76853595171, -25633.986617613973, -25591.02746779801, -25793.936922431694, -25463.685355827132, -25818.945219197565, -25929.59196726394, -25527.034487603927, -25690.213584724686, -25948.808061841275, -25735.575857059477, -25531.92318411009, -25606.671334184066, -25592.0114195276, -25796.179823003586, -25887.053210004226, -25743.554373883482, -26020.766098537446, -25440.00812105769], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.804116042938439, "mean_inference_ms": 0.2660833456474448, "mean_action_processing_ms": 0.06338308737794089, "mean_env_wait_ms": 1.5837622246939451, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003662109375, "StateBufferConnector_ms": 0.0027303695678710938, "ViewRequirementAgentConnector_ms": 0.0685884952545166}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 245520, "num_agent_steps_trained": 245520, "num_env_steps_sampled": 245520, "num_env_steps_trained": 245520, "num_env_steps_sampled_this_iter": 1080, "num_env_steps_trained_this_iter": 1080, "num_env_steps_sampled_throughput_per_sec": 97.25296308355718, "num_env_steps_trained_throughput_per_sec": 97.25296308355718, "timesteps_total": 245520, "num_steps_trained_this_iter": 1080, "agent_timesteps_total": 245520, "timers": {"training_iteration_time_ms": 3774.22, "sample_time_ms": 3763.571, "load_time_ms": 0.307, "load_throughput": 1173779.104, "learn_time_ms": 9.587, "learn_throughput": 37552.431, "synch_weights_time_ms": 0.712}, "counters": {"num_env_steps_sampled": 245520, "num_env_steps_trained": 245520, "num_agent_steps_sampled": 245520, "num_agent_steps_trained": 245520}, "done": false, "episodes_total": 682, "training_iteration": 154, "trial_id": "f5e97_00000", "date": "2023-07-25_17-24-42", "timestamp": 1690295082, "time_this_iter_s": 11.107797861099243, "time_total_s": 1726.483229637146, "pid": 71917, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[0, 0.003], [5400, 0.001], [10800, 0.00075], [16200, 0.0005], [21600, 0.00025], [27000, 0.0001], [32400, 7.5e-05], [37800, 5e-05], [43200, 2.5e-05], [48600, 1e-05], [54000, 7.5e-06], [59400, 5e-06], [64800, 2.5e-06], [70200, 1e-06], [75600, 5e-07], [81000, 1e-07]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x304530310>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1726.483229637146, "iterations_since_restore": 154, "perf": {"cpu_util_percent": 28.106666666666666, "ram_util_percent": 76.26666666666667}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-07, "entropy_coeff": 0.1, "policy_entropy": -926.69970703125, "policy_loss": -16618688541491.2, "vf_loss": 1099489760.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 3423.0, "diff_num_grad_updates_vs_sampler_policy": 3422.0}}, "num_env_steps_sampled": 246600, "num_env_steps_trained": 246600, "num_agent_steps_sampled": 246600, "num_agent_steps_trained": 246600}, "sampler_results": {"episode_reward_max": -25328.253683721272, "episode_reward_min": -26105.435092812302, "episode_reward_mean": -25739.987669398015, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-25602.665316442188, -25778.991024729174, -25844.319635697706, -25968.00378102244, -25599.63654565638, -26105.435092812302, -25720.035707131035, -25847.888622810693, -25737.30769667045, -25678.96459864703, -25730.000865931677, -25944.927787284018, -25798.500653704446, -25548.90054753863, -25587.786097460936, -25688.644517865163, -25464.608163331468, -25864.021290339366, -25885.91731411878, -25553.700367281243, -26042.408552654564, -25602.224455599582, -25765.828737911692, -25687.931787524136, -25647.751173520413, -25708.912178971168, -25823.99841316268, -25832.175491726637, -25554.266391473473, -25959.410281017565, -25690.837084897732, -25402.97920299653, -25762.143345042303, -25758.082480843907, -25553.59971194014, -25798.768777476813, -25751.632972563755, -25762.996505865038, -25635.40099255635, -25790.150874345392, -25714.420763199465, -25898.81545949767, -25583.032472728108, -25599.747136461963, -26080.25220475557, -25961.523301868016, -25680.131995975335, -25704.700582997753, -25561.725188177534, -26006.813883461164, -25473.365698160313, -25981.49901079789, -25615.818742254272, -25774.966136668256, -25718.871942171663, -26023.329850619702, -25532.399431681537, -25598.4220706197, -26013.198021050313, -25943.011287423775, -25874.848682321674, -25722.833638907243, -25948.353042061724, -25670.38114940201, -25960.801131484717, -25859.620995068624, -25626.52642722719, -25860.885808580013, -25753.036526536976, -25771.236314150938, -25746.199955167915, -25755.06299386396, -25328.253683721272, -25585.840661300284, -25903.334880684706, -25883.117045280727, -25750.56693843077, -25524.682948370977, -26031.76853595171, -25633.986617613973, -25591.02746779801, -25793.936922431694, -25463.685355827132, -25818.945219197565, -25929.59196726394, -25527.034487603927, -25690.213584724686, -25948.808061841275, -25735.575857059477, -25531.92318411009, -25606.671334184066, -25592.0114195276, -25796.179823003586, -25887.053210004226, -25743.554373883482, -26020.766098537446, -25440.00812105769, -25673.279537836806, -25340.41497547698, -25728.947743169487], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.816833795403134, "mean_inference_ms": 0.2666843910150813, "mean_action_processing_ms": 0.06353044282144152, "mean_env_wait_ms": 1.5877944180031829, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0036618709564208984, "StateBufferConnector_ms": 0.0027370452880859375, "ViewRequirementAgentConnector_ms": 0.06868600845336914}}, "episode_reward_max": -25328.253683721272, "episode_reward_min": -26105.435092812302, "episode_reward_mean": -25739.987669398015, "episode_len_mean": 360.0, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-25602.665316442188, -25778.991024729174, -25844.319635697706, -25968.00378102244, -25599.63654565638, -26105.435092812302, -25720.035707131035, -25847.888622810693, -25737.30769667045, -25678.96459864703, -25730.000865931677, -25944.927787284018, -25798.500653704446, -25548.90054753863, -25587.786097460936, -25688.644517865163, -25464.608163331468, -25864.021290339366, -25885.91731411878, -25553.700367281243, -26042.408552654564, -25602.224455599582, -25765.828737911692, -25687.931787524136, -25647.751173520413, -25708.912178971168, -25823.99841316268, -25832.175491726637, -25554.266391473473, -25959.410281017565, -25690.837084897732, -25402.97920299653, -25762.143345042303, -25758.082480843907, -25553.59971194014, -25798.768777476813, -25751.632972563755, -25762.996505865038, -25635.40099255635, -25790.150874345392, -25714.420763199465, -25898.81545949767, -25583.032472728108, -25599.747136461963, -26080.25220475557, -25961.523301868016, -25680.131995975335, -25704.700582997753, -25561.725188177534, -26006.813883461164, -25473.365698160313, -25981.49901079789, -25615.818742254272, -25774.966136668256, -25718.871942171663, -26023.329850619702, -25532.399431681537, -25598.4220706197, -26013.198021050313, -25943.011287423775, -25874.848682321674, -25722.833638907243, -25948.353042061724, -25670.38114940201, -25960.801131484717, -25859.620995068624, -25626.52642722719, -25860.885808580013, -25753.036526536976, -25771.236314150938, -25746.199955167915, -25755.06299386396, -25328.253683721272, -25585.840661300284, -25903.334880684706, -25883.117045280727, -25750.56693843077, -25524.682948370977, -26031.76853595171, -25633.986617613973, -25591.02746779801, -25793.936922431694, -25463.685355827132, -25818.945219197565, -25929.59196726394, -25527.034487603927, -25690.213584724686, -25948.808061841275, -25735.575857059477, -25531.92318411009, -25606.671334184066, -25592.0114195276, -25796.179823003586, -25887.053210004226, -25743.554373883482, -26020.766098537446, -25440.00812105769, -25673.279537836806, -25340.41497547698, -25728.947743169487], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.816833795403134, "mean_inference_ms": 0.2666843910150813, "mean_action_processing_ms": 0.06353044282144152, "mean_env_wait_ms": 1.5877944180031829, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0036618709564208984, "StateBufferConnector_ms": 0.0027370452880859375, "ViewRequirementAgentConnector_ms": 0.06868600845336914}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 246600, "num_agent_steps_trained": 246600, "num_env_steps_sampled": 246600, "num_env_steps_trained": 246600, "num_env_steps_sampled_this_iter": 1080, "num_env_steps_trained_this_iter": 1080, "num_env_steps_sampled_throughput_per_sec": 95.69976596504065, "num_env_steps_trained_throughput_per_sec": 95.69976596504065, "timesteps_total": 246600, "num_steps_trained_this_iter": 1080, "agent_timesteps_total": 246600, "timers": {"training_iteration_time_ms": 3756.088, "sample_time_ms": 3745.409, "load_time_ms": 0.309, "load_throughput": 1163199.63, "learn_time_ms": 9.612, "learn_throughput": 37452.487, "synch_weights_time_ms": 0.714}, "counters": {"num_env_steps_sampled": 246600, "num_env_steps_trained": 246600, "num_agent_steps_sampled": 246600, "num_agent_steps_trained": 246600}, "done": false, "episodes_total": 685, "training_iteration": 155, "trial_id": "f5e97_00000", "date": "2023-07-25_17-24-54", "timestamp": 1690295094, "time_this_iter_s": 11.288037061691284, "time_total_s": 1737.7712666988373, "pid": 71917, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[0, 0.003], [5400, 0.001], [10800, 0.00075], [16200, 0.0005], [21600, 0.00025], [27000, 0.0001], [32400, 7.5e-05], [37800, 5e-05], [43200, 2.5e-05], [48600, 1e-05], [54000, 7.5e-06], [59400, 5e-06], [64800, 2.5e-06], [70200, 1e-06], [75600, 5e-07], [81000, 1e-07]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x304530310>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1737.7712666988373, "iterations_since_restore": 155, "perf": {"cpu_util_percent": 24.66875, "ram_util_percent": 76.14999999999999}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-07, "entropy_coeff": 0.1, "policy_entropy": -926.7001342773438, "policy_loss": -17671012420812.8, "vf_loss": 1075368755.2}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 3438.0, "diff_num_grad_updates_vs_sampler_policy": 3437.0}}, "num_env_steps_sampled": 247680, "num_env_steps_trained": 247680, "num_agent_steps_sampled": 247680, "num_agent_steps_trained": 247680}, "sampler_results": {"episode_reward_max": -25328.253683721272, "episode_reward_min": -26105.435092812302, "episode_reward_mean": -25742.28389903002, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-25968.00378102244, -25599.63654565638, -26105.435092812302, -25720.035707131035, -25847.888622810693, -25737.30769667045, -25678.96459864703, -25730.000865931677, -25944.927787284018, -25798.500653704446, -25548.90054753863, -25587.786097460936, -25688.644517865163, -25464.608163331468, -25864.021290339366, -25885.91731411878, -25553.700367281243, -26042.408552654564, -25602.224455599582, -25765.828737911692, -25687.931787524136, -25647.751173520413, -25708.912178971168, -25823.99841316268, -25832.175491726637, -25554.266391473473, -25959.410281017565, -25690.837084897732, -25402.97920299653, -25762.143345042303, -25758.082480843907, -25553.59971194014, -25798.768777476813, -25751.632972563755, -25762.996505865038, -25635.40099255635, -25790.150874345392, -25714.420763199465, -25898.81545949767, -25583.032472728108, -25599.747136461963, -26080.25220475557, -25961.523301868016, -25680.131995975335, -25704.700582997753, -25561.725188177534, -26006.813883461164, -25473.365698160313, -25981.49901079789, -25615.818742254272, -25774.966136668256, -25718.871942171663, -26023.329850619702, -25532.399431681537, -25598.4220706197, -26013.198021050313, -25943.011287423775, -25874.848682321674, -25722.833638907243, -25948.353042061724, -25670.38114940201, -25960.801131484717, -25859.620995068624, -25626.52642722719, -25860.885808580013, -25753.036526536976, -25771.236314150938, -25746.199955167915, -25755.06299386396, -25328.253683721272, -25585.840661300284, -25903.334880684706, -25883.117045280727, -25750.56693843077, -25524.682948370977, -26031.76853595171, -25633.986617613973, -25591.02746779801, -25793.936922431694, -25463.685355827132, -25818.945219197565, -25929.59196726394, -25527.034487603927, -25690.213584724686, -25948.808061841275, -25735.575857059477, -25531.92318411009, -25606.671334184066, -25592.0114195276, -25796.179823003586, -25887.053210004226, -25743.554373883482, -26020.766098537446, -25440.00812105769, -25673.279537836806, -25340.41497547698, -25728.947743169487, -25878.791754771355, -26025.64082279114, -25551.166362507065], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.829466952386188, "mean_inference_ms": 0.2672808383514339, "mean_action_processing_ms": 0.0636765338146753, "mean_env_wait_ms": 1.5917851018732225, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003663301467895508, "StateBufferConnector_ms": 0.0027344226837158203, "ViewRequirementAgentConnector_ms": 0.06869935989379883}}, "episode_reward_max": -25328.253683721272, "episode_reward_min": -26105.435092812302, "episode_reward_mean": -25742.28389903002, "episode_len_mean": 360.0, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-25968.00378102244, -25599.63654565638, -26105.435092812302, -25720.035707131035, -25847.888622810693, -25737.30769667045, -25678.96459864703, -25730.000865931677, -25944.927787284018, -25798.500653704446, -25548.90054753863, -25587.786097460936, -25688.644517865163, -25464.608163331468, -25864.021290339366, -25885.91731411878, -25553.700367281243, -26042.408552654564, -25602.224455599582, -25765.828737911692, -25687.931787524136, -25647.751173520413, -25708.912178971168, -25823.99841316268, -25832.175491726637, -25554.266391473473, -25959.410281017565, -25690.837084897732, -25402.97920299653, -25762.143345042303, -25758.082480843907, -25553.59971194014, -25798.768777476813, -25751.632972563755, -25762.996505865038, -25635.40099255635, -25790.150874345392, -25714.420763199465, -25898.81545949767, -25583.032472728108, -25599.747136461963, -26080.25220475557, -25961.523301868016, -25680.131995975335, -25704.700582997753, -25561.725188177534, -26006.813883461164, -25473.365698160313, -25981.49901079789, -25615.818742254272, -25774.966136668256, -25718.871942171663, -26023.329850619702, -25532.399431681537, -25598.4220706197, -26013.198021050313, -25943.011287423775, -25874.848682321674, -25722.833638907243, -25948.353042061724, -25670.38114940201, -25960.801131484717, -25859.620995068624, -25626.52642722719, -25860.885808580013, -25753.036526536976, -25771.236314150938, -25746.199955167915, -25755.06299386396, -25328.253683721272, -25585.840661300284, -25903.334880684706, -25883.117045280727, -25750.56693843077, -25524.682948370977, -26031.76853595171, -25633.986617613973, -25591.02746779801, -25793.936922431694, -25463.685355827132, -25818.945219197565, -25929.59196726394, -25527.034487603927, -25690.213584724686, -25948.808061841275, -25735.575857059477, -25531.92318411009, -25606.671334184066, -25592.0114195276, -25796.179823003586, -25887.053210004226, -25743.554373883482, -26020.766098537446, -25440.00812105769, -25673.279537836806, -25340.41497547698, -25728.947743169487, -25878.791754771355, -26025.64082279114, -25551.166362507065], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.829466952386188, "mean_inference_ms": 0.2672808383514339, "mean_action_processing_ms": 0.0636765338146753, "mean_env_wait_ms": 1.5917851018732225, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003663301467895508, "StateBufferConnector_ms": 0.0027344226837158203, "ViewRequirementAgentConnector_ms": 0.06869935989379883}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 247680, "num_agent_steps_trained": 247680, "num_env_steps_sampled": 247680, "num_env_steps_trained": 247680, "num_env_steps_sampled_this_iter": 1080, "num_env_steps_trained_this_iter": 1080, "num_env_steps_sampled_throughput_per_sec": 94.62365127798533, "num_env_steps_trained_throughput_per_sec": 94.62365127798533, "timesteps_total": 247680, "num_steps_trained_this_iter": 1080, "agent_timesteps_total": 247680, "timers": {"training_iteration_time_ms": 3762.305, "sample_time_ms": 3751.43, "load_time_ms": 0.317, "load_throughput": 1134106.534, "learn_time_ms": 9.77, "learn_throughput": 36847.627, "synch_weights_time_ms": 0.738}, "counters": {"num_env_steps_sampled": 247680, "num_env_steps_trained": 247680, "num_agent_steps_sampled": 247680, "num_agent_steps_trained": 247680}, "done": false, "episodes_total": 688, "training_iteration": 156, "trial_id": "f5e97_00000", "date": "2023-07-25_17-25-05", "timestamp": 1690295105, "time_this_iter_s": 11.416688919067383, "time_total_s": 1749.1879556179047, "pid": 71917, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[0, 0.003], [5400, 0.001], [10800, 0.00075], [16200, 0.0005], [21600, 0.00025], [27000, 0.0001], [32400, 7.5e-05], [37800, 5e-05], [43200, 2.5e-05], [48600, 1e-05], [54000, 7.5e-06], [59400, 5e-06], [64800, 2.5e-06], [70200, 1e-06], [75600, 5e-07], [81000, 1e-07]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x304530310>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1749.1879556179047, "iterations_since_restore": 156, "perf": {"cpu_util_percent": 30.176470588235293, "ram_util_percent": 76.54705882352941}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-07, "entropy_coeff": 0.1, "policy_entropy": -926.700146484375, "policy_loss": -14370126653849.6, "vf_loss": 1078097715.2}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 3453.0, "diff_num_grad_updates_vs_sampler_policy": 3452.0}}, "num_env_steps_sampled": 248760, "num_env_steps_trained": 248760, "num_agent_steps_sampled": 248760, "num_agent_steps_trained": 248760}, "sampler_results": {"episode_reward_max": -25328.253683721272, "episode_reward_min": -26080.25220475557, "episode_reward_mean": -25733.86171652364, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-25720.035707131035, -25847.888622810693, -25737.30769667045, -25678.96459864703, -25730.000865931677, -25944.927787284018, -25798.500653704446, -25548.90054753863, -25587.786097460936, -25688.644517865163, -25464.608163331468, -25864.021290339366, -25885.91731411878, -25553.700367281243, -26042.408552654564, -25602.224455599582, -25765.828737911692, -25687.931787524136, -25647.751173520413, -25708.912178971168, -25823.99841316268, -25832.175491726637, -25554.266391473473, -25959.410281017565, -25690.837084897732, -25402.97920299653, -25762.143345042303, -25758.082480843907, -25553.59971194014, -25798.768777476813, -25751.632972563755, -25762.996505865038, -25635.40099255635, -25790.150874345392, -25714.420763199465, -25898.81545949767, -25583.032472728108, -25599.747136461963, -26080.25220475557, -25961.523301868016, -25680.131995975335, -25704.700582997753, -25561.725188177534, -26006.813883461164, -25473.365698160313, -25981.49901079789, -25615.818742254272, -25774.966136668256, -25718.871942171663, -26023.329850619702, -25532.399431681537, -25598.4220706197, -26013.198021050313, -25943.011287423775, -25874.848682321674, -25722.833638907243, -25948.353042061724, -25670.38114940201, -25960.801131484717, -25859.620995068624, -25626.52642722719, -25860.885808580013, -25753.036526536976, -25771.236314150938, -25746.199955167915, -25755.06299386396, -25328.253683721272, -25585.840661300284, -25903.334880684706, -25883.117045280727, -25750.56693843077, -25524.682948370977, -26031.76853595171, -25633.986617613973, -25591.02746779801, -25793.936922431694, -25463.685355827132, -25818.945219197565, -25929.59196726394, -25527.034487603927, -25690.213584724686, -25948.808061841275, -25735.575857059477, -25531.92318411009, -25606.671334184066, -25592.0114195276, -25796.179823003586, -25887.053210004226, -25743.554373883482, -26020.766098537446, -25440.00812105769, -25673.279537836806, -25340.41497547698, -25728.947743169487, -25878.791754771355, -26025.64082279114, -25551.166362507065, -25896.858298201812, -25426.459396664668, -25507.539473986046], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.841991867416271, "mean_inference_ms": 0.2678721662262024, "mean_action_processing_ms": 0.06382135687148571, "mean_env_wait_ms": 1.5957451257974866, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0036640167236328125, "StateBufferConnector_ms": 0.0027365684509277344, "ViewRequirementAgentConnector_ms": 0.06865954399108887}}, "episode_reward_max": -25328.253683721272, "episode_reward_min": -26080.25220475557, "episode_reward_mean": -25733.86171652364, "episode_len_mean": 360.0, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-25720.035707131035, -25847.888622810693, -25737.30769667045, -25678.96459864703, -25730.000865931677, -25944.927787284018, -25798.500653704446, -25548.90054753863, -25587.786097460936, -25688.644517865163, -25464.608163331468, -25864.021290339366, -25885.91731411878, -25553.700367281243, -26042.408552654564, -25602.224455599582, -25765.828737911692, -25687.931787524136, -25647.751173520413, -25708.912178971168, -25823.99841316268, -25832.175491726637, -25554.266391473473, -25959.410281017565, -25690.837084897732, -25402.97920299653, -25762.143345042303, -25758.082480843907, -25553.59971194014, -25798.768777476813, -25751.632972563755, -25762.996505865038, -25635.40099255635, -25790.150874345392, -25714.420763199465, -25898.81545949767, -25583.032472728108, -25599.747136461963, -26080.25220475557, -25961.523301868016, -25680.131995975335, -25704.700582997753, -25561.725188177534, -26006.813883461164, -25473.365698160313, -25981.49901079789, -25615.818742254272, -25774.966136668256, -25718.871942171663, -26023.329850619702, -25532.399431681537, -25598.4220706197, -26013.198021050313, -25943.011287423775, -25874.848682321674, -25722.833638907243, -25948.353042061724, -25670.38114940201, -25960.801131484717, -25859.620995068624, -25626.52642722719, -25860.885808580013, -25753.036526536976, -25771.236314150938, -25746.199955167915, -25755.06299386396, -25328.253683721272, -25585.840661300284, -25903.334880684706, -25883.117045280727, -25750.56693843077, -25524.682948370977, -26031.76853595171, -25633.986617613973, -25591.02746779801, -25793.936922431694, -25463.685355827132, -25818.945219197565, -25929.59196726394, -25527.034487603927, -25690.213584724686, -25948.808061841275, -25735.575857059477, -25531.92318411009, -25606.671334184066, -25592.0114195276, -25796.179823003586, -25887.053210004226, -25743.554373883482, -26020.766098537446, -25440.00812105769, -25673.279537836806, -25340.41497547698, -25728.947743169487, -25878.791754771355, -26025.64082279114, -25551.166362507065, -25896.858298201812, -25426.459396664668, -25507.539473986046], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.841991867416271, "mean_inference_ms": 0.2678721662262024, "mean_action_processing_ms": 0.06382135687148571, "mean_env_wait_ms": 1.5957451257974866, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0036640167236328125, "StateBufferConnector_ms": 0.0027365684509277344, "ViewRequirementAgentConnector_ms": 0.06865954399108887}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 248760, "num_agent_steps_trained": 248760, "num_env_steps_sampled": 248760, "num_env_steps_trained": 248760, "num_env_steps_sampled_this_iter": 1080, "num_env_steps_trained_this_iter": 1080, "num_env_steps_sampled_throughput_per_sec": 94.98244852193031, "num_env_steps_trained_throughput_per_sec": 94.98244852193031, "timesteps_total": 248760, "num_steps_trained_this_iter": 1080, "agent_timesteps_total": 248760, "timers": {"training_iteration_time_ms": 3777.587, "sample_time_ms": 3766.604, "load_time_ms": 0.314, "load_throughput": 1146680.923, "learn_time_ms": 9.874, "learn_throughput": 36461.024, "synch_weights_time_ms": 0.744}, "counters": {"num_env_steps_sampled": 248760, "num_env_steps_trained": 248760, "num_agent_steps_sampled": 248760, "num_agent_steps_trained": 248760}, "done": false, "episodes_total": 691, "training_iteration": 157, "trial_id": "f5e97_00000", "date": "2023-07-25_17-25-17", "timestamp": 1690295117, "time_this_iter_s": 11.373463153839111, "time_total_s": 1760.5614187717438, "pid": 71917, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[0, 0.003], [5400, 0.001], [10800, 0.00075], [16200, 0.0005], [21600, 0.00025], [27000, 0.0001], [32400, 7.5e-05], [37800, 5e-05], [43200, 2.5e-05], [48600, 1e-05], [54000, 7.5e-06], [59400, 5e-06], [64800, 2.5e-06], [70200, 1e-06], [75600, 5e-07], [81000, 1e-07]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x304530310>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1760.5614187717438, "iterations_since_restore": 157, "perf": {"cpu_util_percent": 23.59375, "ram_util_percent": 76.58125000000001}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-07, "entropy_coeff": 0.1, "policy_entropy": -926.6999389648438, "policy_loss": -22966009382502.4, "vf_loss": 1100132083.2}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 3468.0, "diff_num_grad_updates_vs_sampler_policy": 3467.0}}, "num_env_steps_sampled": 249840, "num_env_steps_trained": 249840, "num_agent_steps_sampled": 249840, "num_agent_steps_trained": 249840}, "sampler_results": {"episode_reward_max": -25328.253683721272, "episode_reward_min": -26080.25220475557, "episode_reward_mean": -25734.268329159124, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-25678.96459864703, -25730.000865931677, -25944.927787284018, -25798.500653704446, -25548.90054753863, -25587.786097460936, -25688.644517865163, -25464.608163331468, -25864.021290339366, -25885.91731411878, -25553.700367281243, -26042.408552654564, -25602.224455599582, -25765.828737911692, -25687.931787524136, -25647.751173520413, -25708.912178971168, -25823.99841316268, -25832.175491726637, -25554.266391473473, -25959.410281017565, -25690.837084897732, -25402.97920299653, -25762.143345042303, -25758.082480843907, -25553.59971194014, -25798.768777476813, -25751.632972563755, -25762.996505865038, -25635.40099255635, -25790.150874345392, -25714.420763199465, -25898.81545949767, -25583.032472728108, -25599.747136461963, -26080.25220475557, -25961.523301868016, -25680.131995975335, -25704.700582997753, -25561.725188177534, -26006.813883461164, -25473.365698160313, -25981.49901079789, -25615.818742254272, -25774.966136668256, -25718.871942171663, -26023.329850619702, -25532.399431681537, -25598.4220706197, -26013.198021050313, -25943.011287423775, -25874.848682321674, -25722.833638907243, -25948.353042061724, -25670.38114940201, -25960.801131484717, -25859.620995068624, -25626.52642722719, -25860.885808580013, -25753.036526536976, -25771.236314150938, -25746.199955167915, -25755.06299386396, -25328.253683721272, -25585.840661300284, -25903.334880684706, -25883.117045280727, -25750.56693843077, -25524.682948370977, -26031.76853595171, -25633.986617613973, -25591.02746779801, -25793.936922431694, -25463.685355827132, -25818.945219197565, -25929.59196726394, -25527.034487603927, -25690.213584724686, -25948.808061841275, -25735.575857059477, -25531.92318411009, -25606.671334184066, -25592.0114195276, -25796.179823003586, -25887.053210004226, -25743.554373883482, -26020.766098537446, -25440.00812105769, -25673.279537836806, -25340.41497547698, -25728.947743169487, -25878.791754771355, -26025.64082279114, -25551.166362507065, -25896.858298201812, -25426.459396664668, -25507.539473986046, -25711.700010391367, -25871.72504599535, -25762.468233774387], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.854376349336026, "mean_inference_ms": 0.26845806499463304, "mean_action_processing_ms": 0.06396481056541031, "mean_env_wait_ms": 1.5996788382557392, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0036635398864746094, "StateBufferConnector_ms": 0.002734661102294922, "ViewRequirementAgentConnector_ms": 0.06865620613098145}}, "episode_reward_max": -25328.253683721272, "episode_reward_min": -26080.25220475557, "episode_reward_mean": -25734.268329159124, "episode_len_mean": 360.0, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-25678.96459864703, -25730.000865931677, -25944.927787284018, -25798.500653704446, -25548.90054753863, -25587.786097460936, -25688.644517865163, -25464.608163331468, -25864.021290339366, -25885.91731411878, -25553.700367281243, -26042.408552654564, -25602.224455599582, -25765.828737911692, -25687.931787524136, -25647.751173520413, -25708.912178971168, -25823.99841316268, -25832.175491726637, -25554.266391473473, -25959.410281017565, -25690.837084897732, -25402.97920299653, -25762.143345042303, -25758.082480843907, -25553.59971194014, -25798.768777476813, -25751.632972563755, -25762.996505865038, -25635.40099255635, -25790.150874345392, -25714.420763199465, -25898.81545949767, -25583.032472728108, -25599.747136461963, -26080.25220475557, -25961.523301868016, -25680.131995975335, -25704.700582997753, -25561.725188177534, -26006.813883461164, -25473.365698160313, -25981.49901079789, -25615.818742254272, -25774.966136668256, -25718.871942171663, -26023.329850619702, -25532.399431681537, -25598.4220706197, -26013.198021050313, -25943.011287423775, -25874.848682321674, -25722.833638907243, -25948.353042061724, -25670.38114940201, -25960.801131484717, -25859.620995068624, -25626.52642722719, -25860.885808580013, -25753.036526536976, -25771.236314150938, -25746.199955167915, -25755.06299386396, -25328.253683721272, -25585.840661300284, -25903.334880684706, -25883.117045280727, -25750.56693843077, -25524.682948370977, -26031.76853595171, -25633.986617613973, -25591.02746779801, -25793.936922431694, -25463.685355827132, -25818.945219197565, -25929.59196726394, -25527.034487603927, -25690.213584724686, -25948.808061841275, -25735.575857059477, -25531.92318411009, -25606.671334184066, -25592.0114195276, -25796.179823003586, -25887.053210004226, -25743.554373883482, -26020.766098537446, -25440.00812105769, -25673.279537836806, -25340.41497547698, -25728.947743169487, -25878.791754771355, -26025.64082279114, -25551.166362507065, -25896.858298201812, -25426.459396664668, -25507.539473986046, -25711.700010391367, -25871.72504599535, -25762.468233774387], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.854376349336026, "mean_inference_ms": 0.26845806499463304, "mean_action_processing_ms": 0.06396481056541031, "mean_env_wait_ms": 1.5996788382557392, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0036635398864746094, "StateBufferConnector_ms": 0.002734661102294922, "ViewRequirementAgentConnector_ms": 0.06865620613098145}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 249840, "num_agent_steps_trained": 249840, "num_env_steps_sampled": 249840, "num_env_steps_trained": 249840, "num_env_steps_sampled_this_iter": 1080, "num_env_steps_trained_this_iter": 1080, "num_env_steps_sampled_throughput_per_sec": 94.66454078793838, "num_env_steps_trained_throughput_per_sec": 94.66454078793838, "timesteps_total": 249840, "num_steps_trained_this_iter": 1080, "agent_timesteps_total": 249840, "timers": {"training_iteration_time_ms": 3784.431, "sample_time_ms": 3773.257, "load_time_ms": 0.312, "load_throughput": 1153337.489, "learn_time_ms": 10.059, "learn_throughput": 35790.206, "synch_weights_time_ms": 0.752}, "counters": {"num_env_steps_sampled": 249840, "num_env_steps_trained": 249840, "num_agent_steps_sampled": 249840, "num_agent_steps_trained": 249840}, "done": false, "episodes_total": 694, "training_iteration": 158, "trial_id": "f5e97_00000", "date": "2023-07-25_17-25-28", "timestamp": 1690295128, "time_this_iter_s": 11.41153597831726, "time_total_s": 1771.972954750061, "pid": 71917, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[0, 0.003], [5400, 0.001], [10800, 0.00075], [16200, 0.0005], [21600, 0.00025], [27000, 0.0001], [32400, 7.5e-05], [37800, 5e-05], [43200, 2.5e-05], [48600, 1e-05], [54000, 7.5e-06], [59400, 5e-06], [64800, 2.5e-06], [70200, 1e-06], [75600, 5e-07], [81000, 1e-07]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x304530310>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1771.972954750061, "iterations_since_restore": 158, "perf": {"cpu_util_percent": 24.456249999999997, "ram_util_percent": 76.65}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-07, "entropy_coeff": 0.1, "policy_entropy": -926.700048828125, "policy_loss": -16136749067059.2, "vf_loss": 1107038822.4}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 3483.0, "diff_num_grad_updates_vs_sampler_policy": 3482.0}}, "num_env_steps_sampled": 250920, "num_env_steps_trained": 250920, "num_agent_steps_sampled": 250920, "num_agent_steps_trained": 250920}, "sampler_results": {"episode_reward_max": -25328.253683721272, "episode_reward_min": -26080.25220475557, "episode_reward_mean": -25735.90197999566, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-25798.500653704446, -25548.90054753863, -25587.786097460936, -25688.644517865163, -25464.608163331468, -25864.021290339366, -25885.91731411878, -25553.700367281243, -26042.408552654564, -25602.224455599582, -25765.828737911692, -25687.931787524136, -25647.751173520413, -25708.912178971168, -25823.99841316268, -25832.175491726637, -25554.266391473473, -25959.410281017565, -25690.837084897732, -25402.97920299653, -25762.143345042303, -25758.082480843907, -25553.59971194014, -25798.768777476813, -25751.632972563755, -25762.996505865038, -25635.40099255635, -25790.150874345392, -25714.420763199465, -25898.81545949767, -25583.032472728108, -25599.747136461963, -26080.25220475557, -25961.523301868016, -25680.131995975335, -25704.700582997753, -25561.725188177534, -26006.813883461164, -25473.365698160313, -25981.49901079789, -25615.818742254272, -25774.966136668256, -25718.871942171663, -26023.329850619702, -25532.399431681537, -25598.4220706197, -26013.198021050313, -25943.011287423775, -25874.848682321674, -25722.833638907243, -25948.353042061724, -25670.38114940201, -25960.801131484717, -25859.620995068624, -25626.52642722719, -25860.885808580013, -25753.036526536976, -25771.236314150938, -25746.199955167915, -25755.06299386396, -25328.253683721272, -25585.840661300284, -25903.334880684706, -25883.117045280727, -25750.56693843077, -25524.682948370977, -26031.76853595171, -25633.986617613973, -25591.02746779801, -25793.936922431694, -25463.685355827132, -25818.945219197565, -25929.59196726394, -25527.034487603927, -25690.213584724686, -25948.808061841275, -25735.575857059477, -25531.92318411009, -25606.671334184066, -25592.0114195276, -25796.179823003586, -25887.053210004226, -25743.554373883482, -26020.766098537446, -25440.00812105769, -25673.279537836806, -25340.41497547698, -25728.947743169487, -25878.791754771355, -26025.64082279114, -25551.166362507065, -25896.858298201812, -25426.459396664668, -25507.539473986046, -25711.700010391367, -25871.72504599535, -25762.468233774387, -25970.55138974913, -25738.484817348173, -25808.222128419147], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.866649505033949, "mean_inference_ms": 0.26903347714048215, "mean_action_processing_ms": 0.0641060765013278, "mean_env_wait_ms": 1.6035696630724532, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0036439895629882812, "StateBufferConnector_ms": 0.0027370452880859375, "ViewRequirementAgentConnector_ms": 0.06840968132019043}}, "episode_reward_max": -25328.253683721272, "episode_reward_min": -26080.25220475557, "episode_reward_mean": -25735.90197999566, "episode_len_mean": 360.0, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-25798.500653704446, -25548.90054753863, -25587.786097460936, -25688.644517865163, -25464.608163331468, -25864.021290339366, -25885.91731411878, -25553.700367281243, -26042.408552654564, -25602.224455599582, -25765.828737911692, -25687.931787524136, -25647.751173520413, -25708.912178971168, -25823.99841316268, -25832.175491726637, -25554.266391473473, -25959.410281017565, -25690.837084897732, -25402.97920299653, -25762.143345042303, -25758.082480843907, -25553.59971194014, -25798.768777476813, -25751.632972563755, -25762.996505865038, -25635.40099255635, -25790.150874345392, -25714.420763199465, -25898.81545949767, -25583.032472728108, -25599.747136461963, -26080.25220475557, -25961.523301868016, -25680.131995975335, -25704.700582997753, -25561.725188177534, -26006.813883461164, -25473.365698160313, -25981.49901079789, -25615.818742254272, -25774.966136668256, -25718.871942171663, -26023.329850619702, -25532.399431681537, -25598.4220706197, -26013.198021050313, -25943.011287423775, -25874.848682321674, -25722.833638907243, -25948.353042061724, -25670.38114940201, -25960.801131484717, -25859.620995068624, -25626.52642722719, -25860.885808580013, -25753.036526536976, -25771.236314150938, -25746.199955167915, -25755.06299386396, -25328.253683721272, -25585.840661300284, -25903.334880684706, -25883.117045280727, -25750.56693843077, -25524.682948370977, -26031.76853595171, -25633.986617613973, -25591.02746779801, -25793.936922431694, -25463.685355827132, -25818.945219197565, -25929.59196726394, -25527.034487603927, -25690.213584724686, -25948.808061841275, -25735.575857059477, -25531.92318411009, -25606.671334184066, -25592.0114195276, -25796.179823003586, -25887.053210004226, -25743.554373883482, -26020.766098537446, -25440.00812105769, -25673.279537836806, -25340.41497547698, -25728.947743169487, -25878.791754771355, -26025.64082279114, -25551.166362507065, -25896.858298201812, -25426.459396664668, -25507.539473986046, -25711.700010391367, -25871.72504599535, -25762.468233774387, -25970.55138974913, -25738.484817348173, -25808.222128419147], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.866649505033949, "mean_inference_ms": 0.26903347714048215, "mean_action_processing_ms": 0.0641060765013278, "mean_env_wait_ms": 1.6035696630724532, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0036439895629882812, "StateBufferConnector_ms": 0.0027370452880859375, "ViewRequirementAgentConnector_ms": 0.06840968132019043}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 250920, "num_agent_steps_trained": 250920, "num_env_steps_sampled": 250920, "num_env_steps_trained": 250920, "num_env_steps_sampled_this_iter": 1080, "num_env_steps_trained_this_iter": 1080, "num_env_steps_sampled_throughput_per_sec": 94.49754930235734, "num_env_steps_trained_throughput_per_sec": 94.49754930235734, "timesteps_total": 250920, "num_steps_trained_this_iter": 1080, "agent_timesteps_total": 250920, "timers": {"training_iteration_time_ms": 3797.702, "sample_time_ms": 3786.555, "load_time_ms": 0.313, "load_throughput": 1151051.563, "learn_time_ms": 10.035, "learn_throughput": 35872.684, "synch_weights_time_ms": 0.748}, "counters": {"num_env_steps_sampled": 250920, "num_env_steps_trained": 250920, "num_agent_steps_sampled": 250920, "num_agent_steps_trained": 250920}, "done": false, "episodes_total": 697, "training_iteration": 159, "trial_id": "f5e97_00000", "date": "2023-07-25_17-25-39", "timestamp": 1690295139, "time_this_iter_s": 11.431714057922363, "time_total_s": 1783.4046688079834, "pid": 71917, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[0, 0.003], [5400, 0.001], [10800, 0.00075], [16200, 0.0005], [21600, 0.00025], [27000, 0.0001], [32400, 7.5e-05], [37800, 5e-05], [43200, 2.5e-05], [48600, 1e-05], [54000, 7.5e-06], [59400, 5e-06], [64800, 2.5e-06], [70200, 1e-06], [75600, 5e-07], [81000, 1e-07]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x304530310>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1783.4046688079834, "iterations_since_restore": 159, "perf": {"cpu_util_percent": 25.106250000000003, "ram_util_percent": 76.51875000000001}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-07, "entropy_coeff": 0.1, "policy_entropy": -926.6998168945313, "policy_loss": -21857825744486.4, "vf_loss": 1105034624.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 3498.0, "diff_num_grad_updates_vs_sampler_policy": 3497.0}}, "num_env_steps_sampled": 252000, "num_env_steps_trained": 252000, "num_agent_steps_sampled": 252000, "num_agent_steps_trained": 252000}, "sampler_results": {"episode_reward_max": -25328.253683721272, "episode_reward_min": -26080.25220475557, "episode_reward_mean": -25737.57841013379, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-25688.644517865163, -25464.608163331468, -25864.021290339366, -25885.91731411878, -25553.700367281243, -26042.408552654564, -25602.224455599582, -25765.828737911692, -25687.931787524136, -25647.751173520413, -25708.912178971168, -25823.99841316268, -25832.175491726637, -25554.266391473473, -25959.410281017565, -25690.837084897732, -25402.97920299653, -25762.143345042303, -25758.082480843907, -25553.59971194014, -25798.768777476813, -25751.632972563755, -25762.996505865038, -25635.40099255635, -25790.150874345392, -25714.420763199465, -25898.81545949767, -25583.032472728108, -25599.747136461963, -26080.25220475557, -25961.523301868016, -25680.131995975335, -25704.700582997753, -25561.725188177534, -26006.813883461164, -25473.365698160313, -25981.49901079789, -25615.818742254272, -25774.966136668256, -25718.871942171663, -26023.329850619702, -25532.399431681537, -25598.4220706197, -26013.198021050313, -25943.011287423775, -25874.848682321674, -25722.833638907243, -25948.353042061724, -25670.38114940201, -25960.801131484717, -25859.620995068624, -25626.52642722719, -25860.885808580013, -25753.036526536976, -25771.236314150938, -25746.199955167915, -25755.06299386396, -25328.253683721272, -25585.840661300284, -25903.334880684706, -25883.117045280727, -25750.56693843077, -25524.682948370977, -26031.76853595171, -25633.986617613973, -25591.02746779801, -25793.936922431694, -25463.685355827132, -25818.945219197565, -25929.59196726394, -25527.034487603927, -25690.213584724686, -25948.808061841275, -25735.575857059477, -25531.92318411009, -25606.671334184066, -25592.0114195276, -25796.179823003586, -25887.053210004226, -25743.554373883482, -26020.766098537446, -25440.00812105769, -25673.279537836806, -25340.41497547698, -25728.947743169487, -25878.791754771355, -26025.64082279114, -25551.166362507065, -25896.858298201812, -25426.459396664668, -25507.539473986046, -25711.700010391367, -25871.72504599535, -25762.468233774387, -25970.55138974913, -25738.484817348173, -25808.222128419147, -25644.358623005388, -25578.628393425395, -25879.843296086117], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.8787737772100455, "mean_inference_ms": 0.2696004282353287, "mean_action_processing_ms": 0.06424551314643516, "mean_env_wait_ms": 1.607454259508735, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0036399364471435547, "StateBufferConnector_ms": 0.002731800079345703, "ViewRequirementAgentConnector_ms": 0.06839227676391602}}, "episode_reward_max": -25328.253683721272, "episode_reward_min": -26080.25220475557, "episode_reward_mean": -25737.57841013379, "episode_len_mean": 360.0, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-25688.644517865163, -25464.608163331468, -25864.021290339366, -25885.91731411878, -25553.700367281243, -26042.408552654564, -25602.224455599582, -25765.828737911692, -25687.931787524136, -25647.751173520413, -25708.912178971168, -25823.99841316268, -25832.175491726637, -25554.266391473473, -25959.410281017565, -25690.837084897732, -25402.97920299653, -25762.143345042303, -25758.082480843907, -25553.59971194014, -25798.768777476813, -25751.632972563755, -25762.996505865038, -25635.40099255635, -25790.150874345392, -25714.420763199465, -25898.81545949767, -25583.032472728108, -25599.747136461963, -26080.25220475557, -25961.523301868016, -25680.131995975335, -25704.700582997753, -25561.725188177534, -26006.813883461164, -25473.365698160313, -25981.49901079789, -25615.818742254272, -25774.966136668256, -25718.871942171663, -26023.329850619702, -25532.399431681537, -25598.4220706197, -26013.198021050313, -25943.011287423775, -25874.848682321674, -25722.833638907243, -25948.353042061724, -25670.38114940201, -25960.801131484717, -25859.620995068624, -25626.52642722719, -25860.885808580013, -25753.036526536976, -25771.236314150938, -25746.199955167915, -25755.06299386396, -25328.253683721272, -25585.840661300284, -25903.334880684706, -25883.117045280727, -25750.56693843077, -25524.682948370977, -26031.76853595171, -25633.986617613973, -25591.02746779801, -25793.936922431694, -25463.685355827132, -25818.945219197565, -25929.59196726394, -25527.034487603927, -25690.213584724686, -25948.808061841275, -25735.575857059477, -25531.92318411009, -25606.671334184066, -25592.0114195276, -25796.179823003586, -25887.053210004226, -25743.554373883482, -26020.766098537446, -25440.00812105769, -25673.279537836806, -25340.41497547698, -25728.947743169487, -25878.791754771355, -26025.64082279114, -25551.166362507065, -25896.858298201812, -25426.459396664668, -25507.539473986046, -25711.700010391367, -25871.72504599535, -25762.468233774387, -25970.55138974913, -25738.484817348173, -25808.222128419147, -25644.358623005388, -25578.628393425395, -25879.843296086117], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.8787737772100455, "mean_inference_ms": 0.2696004282353287, "mean_action_processing_ms": 0.06424551314643516, "mean_env_wait_ms": 1.607454259508735, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0036399364471435547, "StateBufferConnector_ms": 0.002731800079345703, "ViewRequirementAgentConnector_ms": 0.06839227676391602}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 252000, "num_agent_steps_trained": 252000, "num_env_steps_sampled": 252000, "num_env_steps_trained": 252000, "num_env_steps_sampled_this_iter": 1080, "num_env_steps_trained_this_iter": 1080, "num_env_steps_sampled_throughput_per_sec": 95.02383017342996, "num_env_steps_trained_throughput_per_sec": 95.02383017342996, "timesteps_total": 252000, "num_steps_trained_this_iter": 1080, "agent_timesteps_total": 252000, "timers": {"training_iteration_time_ms": 3802.949, "sample_time_ms": 3791.978, "load_time_ms": 0.302, "load_throughput": 1191375.604, "learn_time_ms": 9.893, "learn_throughput": 36389.234, "synch_weights_time_ms": 0.732}, "counters": {"num_env_steps_sampled": 252000, "num_env_steps_trained": 252000, "num_agent_steps_sampled": 252000, "num_agent_steps_trained": 252000}, "done": false, "episodes_total": 700, "training_iteration": 160, "trial_id": "f5e97_00000", "date": "2023-07-25_17-25-51", "timestamp": 1690295151, "time_this_iter_s": 11.36837100982666, "time_total_s": 1794.77303981781, "pid": 71917, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[0, 0.003], [5400, 0.001], [10800, 0.00075], [16200, 0.0005], [21600, 0.00025], [27000, 0.0001], [32400, 7.5e-05], [37800, 5e-05], [43200, 2.5e-05], [48600, 1e-05], [54000, 7.5e-06], [59400, 5e-06], [64800, 2.5e-06], [70200, 1e-06], [75600, 5e-07], [81000, 1e-07]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x304530310>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1794.77303981781, "iterations_since_restore": 160, "perf": {"cpu_util_percent": 26.441176470588236, "ram_util_percent": 76.18823529411765}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-07, "entropy_coeff": 0.1, "policy_entropy": -926.6998291015625, "policy_loss": -29438473954918.4, "vf_loss": 1105086835.2}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 3513.0, "diff_num_grad_updates_vs_sampler_policy": 3512.0}}, "num_env_steps_sampled": 253080, "num_env_steps_trained": 253080, "num_agent_steps_sampled": 253080, "num_agent_steps_trained": 253080}, "sampler_results": {"episode_reward_max": -25328.253683721272, "episode_reward_min": -26080.25220475557, "episode_reward_mean": -25743.169353030542, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-25885.91731411878, -25553.700367281243, -26042.408552654564, -25602.224455599582, -25765.828737911692, -25687.931787524136, -25647.751173520413, -25708.912178971168, -25823.99841316268, -25832.175491726637, -25554.266391473473, -25959.410281017565, -25690.837084897732, -25402.97920299653, -25762.143345042303, -25758.082480843907, -25553.59971194014, -25798.768777476813, -25751.632972563755, -25762.996505865038, -25635.40099255635, -25790.150874345392, -25714.420763199465, -25898.81545949767, -25583.032472728108, -25599.747136461963, -26080.25220475557, -25961.523301868016, -25680.131995975335, -25704.700582997753, -25561.725188177534, -26006.813883461164, -25473.365698160313, -25981.49901079789, -25615.818742254272, -25774.966136668256, -25718.871942171663, -26023.329850619702, -25532.399431681537, -25598.4220706197, -26013.198021050313, -25943.011287423775, -25874.848682321674, -25722.833638907243, -25948.353042061724, -25670.38114940201, -25960.801131484717, -25859.620995068624, -25626.52642722719, -25860.885808580013, -25753.036526536976, -25771.236314150938, -25746.199955167915, -25755.06299386396, -25328.253683721272, -25585.840661300284, -25903.334880684706, -25883.117045280727, -25750.56693843077, -25524.682948370977, -26031.76853595171, -25633.986617613973, -25591.02746779801, -25793.936922431694, -25463.685355827132, -25818.945219197565, -25929.59196726394, -25527.034487603927, -25690.213584724686, -25948.808061841275, -25735.575857059477, -25531.92318411009, -25606.671334184066, -25592.0114195276, -25796.179823003586, -25887.053210004226, -25743.554373883482, -26020.766098537446, -25440.00812105769, -25673.279537836806, -25340.41497547698, -25728.947743169487, -25878.791754771355, -26025.64082279114, -25551.166362507065, -25896.858298201812, -25426.459396664668, -25507.539473986046, -25711.700010391367, -25871.72504599535, -25762.468233774387, -25970.55138974913, -25738.484817348173, -25808.222128419147, -25644.358623005388, -25578.628393425395, -25879.843296086117, -25949.419554016113, -25807.105742629763, -25819.842964566073], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.890768704785653, "mean_inference_ms": 0.2701615896110996, "mean_action_processing_ms": 0.06438361326200506, "mean_env_wait_ms": 1.6113070804531473, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003640890121459961, "StateBufferConnector_ms": 0.0027322769165039062, "ViewRequirementAgentConnector_ms": 0.06838297843933105}}, "episode_reward_max": -25328.253683721272, "episode_reward_min": -26080.25220475557, "episode_reward_mean": -25743.169353030542, "episode_len_mean": 360.0, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-25885.91731411878, -25553.700367281243, -26042.408552654564, -25602.224455599582, -25765.828737911692, -25687.931787524136, -25647.751173520413, -25708.912178971168, -25823.99841316268, -25832.175491726637, -25554.266391473473, -25959.410281017565, -25690.837084897732, -25402.97920299653, -25762.143345042303, -25758.082480843907, -25553.59971194014, -25798.768777476813, -25751.632972563755, -25762.996505865038, -25635.40099255635, -25790.150874345392, -25714.420763199465, -25898.81545949767, -25583.032472728108, -25599.747136461963, -26080.25220475557, -25961.523301868016, -25680.131995975335, -25704.700582997753, -25561.725188177534, -26006.813883461164, -25473.365698160313, -25981.49901079789, -25615.818742254272, -25774.966136668256, -25718.871942171663, -26023.329850619702, -25532.399431681537, -25598.4220706197, -26013.198021050313, -25943.011287423775, -25874.848682321674, -25722.833638907243, -25948.353042061724, -25670.38114940201, -25960.801131484717, -25859.620995068624, -25626.52642722719, -25860.885808580013, -25753.036526536976, -25771.236314150938, -25746.199955167915, -25755.06299386396, -25328.253683721272, -25585.840661300284, -25903.334880684706, -25883.117045280727, -25750.56693843077, -25524.682948370977, -26031.76853595171, -25633.986617613973, -25591.02746779801, -25793.936922431694, -25463.685355827132, -25818.945219197565, -25929.59196726394, -25527.034487603927, -25690.213584724686, -25948.808061841275, -25735.575857059477, -25531.92318411009, -25606.671334184066, -25592.0114195276, -25796.179823003586, -25887.053210004226, -25743.554373883482, -26020.766098537446, -25440.00812105769, -25673.279537836806, -25340.41497547698, -25728.947743169487, -25878.791754771355, -26025.64082279114, -25551.166362507065, -25896.858298201812, -25426.459396664668, -25507.539473986046, -25711.700010391367, -25871.72504599535, -25762.468233774387, -25970.55138974913, -25738.484817348173, -25808.222128419147, -25644.358623005388, -25578.628393425395, -25879.843296086117, -25949.419554016113, -25807.105742629763, -25819.842964566073], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.890768704785653, "mean_inference_ms": 0.2701615896110996, "mean_action_processing_ms": 0.06438361326200506, "mean_env_wait_ms": 1.6113070804531473, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003640890121459961, "StateBufferConnector_ms": 0.0027322769165039062, "ViewRequirementAgentConnector_ms": 0.06838297843933105}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 253080, "num_agent_steps_trained": 253080, "num_env_steps_sampled": 253080, "num_env_steps_trained": 253080, "num_env_steps_sampled_this_iter": 1080, "num_env_steps_trained_this_iter": 1080, "num_env_steps_sampled_throughput_per_sec": 96.57554710973288, "num_env_steps_trained_throughput_per_sec": 96.57554710973288, "timesteps_total": 253080, "num_steps_trained_this_iter": 1080, "agent_timesteps_total": 253080, "timers": {"training_iteration_time_ms": 3794.685, "sample_time_ms": 3783.925, "load_time_ms": 0.305, "load_throughput": 1178451.136, "learn_time_ms": 9.707, "learn_throughput": 37087.922, "synch_weights_time_ms": 0.705}, "counters": {"num_env_steps_sampled": 253080, "num_env_steps_trained": 253080, "num_agent_steps_sampled": 253080, "num_agent_steps_trained": 253080}, "done": false, "episodes_total": 703, "training_iteration": 161, "trial_id": "f5e97_00000", "date": "2023-07-25_17-26-02", "timestamp": 1690295162, "time_this_iter_s": 11.185794115066528, "time_total_s": 1805.9588339328766, "pid": 71917, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[0, 0.003], [5400, 0.001], [10800, 0.00075], [16200, 0.0005], [21600, 0.00025], [27000, 0.0001], [32400, 7.5e-05], [37800, 5e-05], [43200, 2.5e-05], [48600, 1e-05], [54000, 7.5e-06], [59400, 5e-06], [64800, 2.5e-06], [70200, 1e-06], [75600, 5e-07], [81000, 1e-07]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x304530310>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1805.9588339328766, "iterations_since_restore": 161, "perf": {"cpu_util_percent": 23.746666666666673, "ram_util_percent": 76.67999999999999}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-07, "entropy_coeff": 0.1, "policy_entropy": -926.7000854492187, "policy_loss": -23778005748121.6, "vf_loss": 1077855539.2}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 3528.0, "diff_num_grad_updates_vs_sampler_policy": 3527.0}}, "num_env_steps_sampled": 254160, "num_env_steps_trained": 254160, "num_agent_steps_sampled": 254160, "num_agent_steps_trained": 254160}, "sampler_results": {"episode_reward_max": -25328.253683721272, "episode_reward_min": -26080.25220475557, "episode_reward_mean": -25735.934773925455, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-25602.224455599582, -25765.828737911692, -25687.931787524136, -25647.751173520413, -25708.912178971168, -25823.99841316268, -25832.175491726637, -25554.266391473473, -25959.410281017565, -25690.837084897732, -25402.97920299653, -25762.143345042303, -25758.082480843907, -25553.59971194014, -25798.768777476813, -25751.632972563755, -25762.996505865038, -25635.40099255635, -25790.150874345392, -25714.420763199465, -25898.81545949767, -25583.032472728108, -25599.747136461963, -26080.25220475557, -25961.523301868016, -25680.131995975335, -25704.700582997753, -25561.725188177534, -26006.813883461164, -25473.365698160313, -25981.49901079789, -25615.818742254272, -25774.966136668256, -25718.871942171663, -26023.329850619702, -25532.399431681537, -25598.4220706197, -26013.198021050313, -25943.011287423775, -25874.848682321674, -25722.833638907243, -25948.353042061724, -25670.38114940201, -25960.801131484717, -25859.620995068624, -25626.52642722719, -25860.885808580013, -25753.036526536976, -25771.236314150938, -25746.199955167915, -25755.06299386396, -25328.253683721272, -25585.840661300284, -25903.334880684706, -25883.117045280727, -25750.56693843077, -25524.682948370977, -26031.76853595171, -25633.986617613973, -25591.02746779801, -25793.936922431694, -25463.685355827132, -25818.945219197565, -25929.59196726394, -25527.034487603927, -25690.213584724686, -25948.808061841275, -25735.575857059477, -25531.92318411009, -25606.671334184066, -25592.0114195276, -25796.179823003586, -25887.053210004226, -25743.554373883482, -26020.766098537446, -25440.00812105769, -25673.279537836806, -25340.41497547698, -25728.947743169487, -25878.791754771355, -26025.64082279114, -25551.166362507065, -25896.858298201812, -25426.459396664668, -25507.539473986046, -25711.700010391367, -25871.72504599535, -25762.468233774387, -25970.55138974913, -25738.484817348173, -25808.222128419147, -25644.358623005388, -25578.628393425395, -25879.843296086117, -25949.419554016113, -25807.105742629763, -25819.842964566073, -25549.149932077962, -25641.233468944458, -25568.18492252227], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.902668443831231, "mean_inference_ms": 0.27071757709959365, "mean_action_processing_ms": 0.06452044844150742, "mean_env_wait_ms": 1.615127209814898, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0036368370056152344, "StateBufferConnector_ms": 0.0027246475219726562, "ViewRequirementAgentConnector_ms": 0.06816983222961426}}, "episode_reward_max": -25328.253683721272, "episode_reward_min": -26080.25220475557, "episode_reward_mean": -25735.934773925455, "episode_len_mean": 360.0, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-25602.224455599582, -25765.828737911692, -25687.931787524136, -25647.751173520413, -25708.912178971168, -25823.99841316268, -25832.175491726637, -25554.266391473473, -25959.410281017565, -25690.837084897732, -25402.97920299653, -25762.143345042303, -25758.082480843907, -25553.59971194014, -25798.768777476813, -25751.632972563755, -25762.996505865038, -25635.40099255635, -25790.150874345392, -25714.420763199465, -25898.81545949767, -25583.032472728108, -25599.747136461963, -26080.25220475557, -25961.523301868016, -25680.131995975335, -25704.700582997753, -25561.725188177534, -26006.813883461164, -25473.365698160313, -25981.49901079789, -25615.818742254272, -25774.966136668256, -25718.871942171663, -26023.329850619702, -25532.399431681537, -25598.4220706197, -26013.198021050313, -25943.011287423775, -25874.848682321674, -25722.833638907243, -25948.353042061724, -25670.38114940201, -25960.801131484717, -25859.620995068624, -25626.52642722719, -25860.885808580013, -25753.036526536976, -25771.236314150938, -25746.199955167915, -25755.06299386396, -25328.253683721272, -25585.840661300284, -25903.334880684706, -25883.117045280727, -25750.56693843077, -25524.682948370977, -26031.76853595171, -25633.986617613973, -25591.02746779801, -25793.936922431694, -25463.685355827132, -25818.945219197565, -25929.59196726394, -25527.034487603927, -25690.213584724686, -25948.808061841275, -25735.575857059477, -25531.92318411009, -25606.671334184066, -25592.0114195276, -25796.179823003586, -25887.053210004226, -25743.554373883482, -26020.766098537446, -25440.00812105769, -25673.279537836806, -25340.41497547698, -25728.947743169487, -25878.791754771355, -26025.64082279114, -25551.166362507065, -25896.858298201812, -25426.459396664668, -25507.539473986046, -25711.700010391367, -25871.72504599535, -25762.468233774387, -25970.55138974913, -25738.484817348173, -25808.222128419147, -25644.358623005388, -25578.628393425395, -25879.843296086117, -25949.419554016113, -25807.105742629763, -25819.842964566073, -25549.149932077962, -25641.233468944458, -25568.18492252227], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.902668443831231, "mean_inference_ms": 0.27071757709959365, "mean_action_processing_ms": 0.06452044844150742, "mean_env_wait_ms": 1.615127209814898, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0036368370056152344, "StateBufferConnector_ms": 0.0027246475219726562, "ViewRequirementAgentConnector_ms": 0.06816983222961426}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 254160, "num_agent_steps_trained": 254160, "num_env_steps_sampled": 254160, "num_env_steps_trained": 254160, "num_env_steps_sampled_this_iter": 1080, "num_env_steps_trained_this_iter": 1080, "num_env_steps_sampled_throughput_per_sec": 94.89631612316002, "num_env_steps_trained_throughput_per_sec": 94.89631612316002, "timesteps_total": 254160, "num_steps_trained_this_iter": 1080, "agent_timesteps_total": 254160, "timers": {"training_iteration_time_ms": 3788.326, "sample_time_ms": 3777.562, "load_time_ms": 0.308, "load_throughput": 1168781.98, "learn_time_ms": 9.713, "learn_throughput": 37062.159, "synch_weights_time_ms": 0.699}, "counters": {"num_env_steps_sampled": 254160, "num_env_steps_trained": 254160, "num_agent_steps_sampled": 254160, "num_agent_steps_trained": 254160}, "done": false, "episodes_total": 706, "training_iteration": 162, "trial_id": "f5e97_00000", "date": "2023-07-25_17-26-14", "timestamp": 1690295174, "time_this_iter_s": 11.383574962615967, "time_total_s": 1817.3424088954926, "pid": 71917, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[0, 0.003], [5400, 0.001], [10800, 0.00075], [16200, 0.0005], [21600, 0.00025], [27000, 0.0001], [32400, 7.5e-05], [37800, 5e-05], [43200, 2.5e-05], [48600, 1e-05], [54000, 7.5e-06], [59400, 5e-06], [64800, 2.5e-06], [70200, 1e-06], [75600, 5e-07], [81000, 1e-07]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x304530310>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1817.3424088954926, "iterations_since_restore": 162, "perf": {"cpu_util_percent": 23.229411764705887, "ram_util_percent": 76.9764705882353}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-07, "entropy_coeff": 0.1, "policy_entropy": -926.6999267578125, "policy_loss": -23381130870784.0, "vf_loss": 1094160153.6}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 3543.0, "diff_num_grad_updates_vs_sampler_policy": 3542.0}}, "num_env_steps_sampled": 255240, "num_env_steps_trained": 255240, "num_agent_steps_sampled": 255240, "num_agent_steps_trained": 255240}, "sampler_results": {"episode_reward_max": -25328.253683721272, "episode_reward_min": -26080.25220475557, "episode_reward_mean": -25739.08740531704, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-25647.751173520413, -25708.912178971168, -25823.99841316268, -25832.175491726637, -25554.266391473473, -25959.410281017565, -25690.837084897732, -25402.97920299653, -25762.143345042303, -25758.082480843907, -25553.59971194014, -25798.768777476813, -25751.632972563755, -25762.996505865038, -25635.40099255635, -25790.150874345392, -25714.420763199465, -25898.81545949767, -25583.032472728108, -25599.747136461963, -26080.25220475557, -25961.523301868016, -25680.131995975335, -25704.700582997753, -25561.725188177534, -26006.813883461164, -25473.365698160313, -25981.49901079789, -25615.818742254272, -25774.966136668256, -25718.871942171663, -26023.329850619702, -25532.399431681537, -25598.4220706197, -26013.198021050313, -25943.011287423775, -25874.848682321674, -25722.833638907243, -25948.353042061724, -25670.38114940201, -25960.801131484717, -25859.620995068624, -25626.52642722719, -25860.885808580013, -25753.036526536976, -25771.236314150938, -25746.199955167915, -25755.06299386396, -25328.253683721272, -25585.840661300284, -25903.334880684706, -25883.117045280727, -25750.56693843077, -25524.682948370977, -26031.76853595171, -25633.986617613973, -25591.02746779801, -25793.936922431694, -25463.685355827132, -25818.945219197565, -25929.59196726394, -25527.034487603927, -25690.213584724686, -25948.808061841275, -25735.575857059477, -25531.92318411009, -25606.671334184066, -25592.0114195276, -25796.179823003586, -25887.053210004226, -25743.554373883482, -26020.766098537446, -25440.00812105769, -25673.279537836806, -25340.41497547698, -25728.947743169487, -25878.791754771355, -26025.64082279114, -25551.166362507065, -25896.858298201812, -25426.459396664668, -25507.539473986046, -25711.700010391367, -25871.72504599535, -25762.468233774387, -25970.55138974913, -25738.484817348173, -25808.222128419147, -25644.358623005388, -25578.628393425395, -25879.843296086117, -25949.419554016113, -25807.105742629763, -25819.842964566073, -25549.149932077962, -25641.233468944458, -25568.18492252227, -25805.053352658015, -25883.35886329001, -25682.835904245807], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.914477541787818, "mean_inference_ms": 0.2712640019863977, "mean_action_processing_ms": 0.06465536178076943, "mean_env_wait_ms": 1.618901745683455, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0036232471466064453, "StateBufferConnector_ms": 0.002719402313232422, "ViewRequirementAgentConnector_ms": 0.06798577308654785}}, "episode_reward_max": -25328.253683721272, "episode_reward_min": -26080.25220475557, "episode_reward_mean": -25739.08740531704, "episode_len_mean": 360.0, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-25647.751173520413, -25708.912178971168, -25823.99841316268, -25832.175491726637, -25554.266391473473, -25959.410281017565, -25690.837084897732, -25402.97920299653, -25762.143345042303, -25758.082480843907, -25553.59971194014, -25798.768777476813, -25751.632972563755, -25762.996505865038, -25635.40099255635, -25790.150874345392, -25714.420763199465, -25898.81545949767, -25583.032472728108, -25599.747136461963, -26080.25220475557, -25961.523301868016, -25680.131995975335, -25704.700582997753, -25561.725188177534, -26006.813883461164, -25473.365698160313, -25981.49901079789, -25615.818742254272, -25774.966136668256, -25718.871942171663, -26023.329850619702, -25532.399431681537, -25598.4220706197, -26013.198021050313, -25943.011287423775, -25874.848682321674, -25722.833638907243, -25948.353042061724, -25670.38114940201, -25960.801131484717, -25859.620995068624, -25626.52642722719, -25860.885808580013, -25753.036526536976, -25771.236314150938, -25746.199955167915, -25755.06299386396, -25328.253683721272, -25585.840661300284, -25903.334880684706, -25883.117045280727, -25750.56693843077, -25524.682948370977, -26031.76853595171, -25633.986617613973, -25591.02746779801, -25793.936922431694, -25463.685355827132, -25818.945219197565, -25929.59196726394, -25527.034487603927, -25690.213584724686, -25948.808061841275, -25735.575857059477, -25531.92318411009, -25606.671334184066, -25592.0114195276, -25796.179823003586, -25887.053210004226, -25743.554373883482, -26020.766098537446, -25440.00812105769, -25673.279537836806, -25340.41497547698, -25728.947743169487, -25878.791754771355, -26025.64082279114, -25551.166362507065, -25896.858298201812, -25426.459396664668, -25507.539473986046, -25711.700010391367, -25871.72504599535, -25762.468233774387, -25970.55138974913, -25738.484817348173, -25808.222128419147, -25644.358623005388, -25578.628393425395, -25879.843296086117, -25949.419554016113, -25807.105742629763, -25819.842964566073, -25549.149932077962, -25641.233468944458, -25568.18492252227, -25805.053352658015, -25883.35886329001, -25682.835904245807], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.914477541787818, "mean_inference_ms": 0.2712640019863977, "mean_action_processing_ms": 0.06465536178076943, "mean_env_wait_ms": 1.618901745683455, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0036232471466064453, "StateBufferConnector_ms": 0.002719402313232422, "ViewRequirementAgentConnector_ms": 0.06798577308654785}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 255240, "num_agent_steps_trained": 255240, "num_env_steps_sampled": 255240, "num_env_steps_trained": 255240, "num_env_steps_sampled_this_iter": 1080, "num_env_steps_trained_this_iter": 1080, "num_env_steps_sampled_throughput_per_sec": 95.72136972526688, "num_env_steps_trained_throughput_per_sec": 95.72136972526688, "timesteps_total": 255240, "num_steps_trained_this_iter": 1080, "agent_timesteps_total": 255240, "timers": {"training_iteration_time_ms": 3788.303, "sample_time_ms": 3777.619, "load_time_ms": 0.307, "load_throughput": 1173323.055, "learn_time_ms": 9.638, "learn_throughput": 37353.074, "synch_weights_time_ms": 0.698}, "counters": {"num_env_steps_sampled": 255240, "num_env_steps_trained": 255240, "num_agent_steps_sampled": 255240, "num_agent_steps_trained": 255240}, "done": false, "episodes_total": 709, "training_iteration": 163, "trial_id": "f5e97_00000", "date": "2023-07-25_17-26-25", "timestamp": 1690295185, "time_this_iter_s": 11.285612106323242, "time_total_s": 1828.6280210018158, "pid": 71917, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[0, 0.003], [5400, 0.001], [10800, 0.00075], [16200, 0.0005], [21600, 0.00025], [27000, 0.0001], [32400, 7.5e-05], [37800, 5e-05], [43200, 2.5e-05], [48600, 1e-05], [54000, 7.5e-06], [59400, 5e-06], [64800, 2.5e-06], [70200, 1e-06], [75600, 5e-07], [81000, 1e-07]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x304530310>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1828.6280210018158, "iterations_since_restore": 163, "perf": {"cpu_util_percent": 24.50625, "ram_util_percent": 76.95625000000001}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-07, "entropy_coeff": 0.1, "policy_entropy": -926.699951171875, "policy_loss": -33757049423462.4, "vf_loss": 1094866476.8}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 3558.0, "diff_num_grad_updates_vs_sampler_policy": 3557.0}}, "num_env_steps_sampled": 256320, "num_env_steps_trained": 256320, "num_agent_steps_sampled": 256320, "num_agent_steps_trained": 256320}, "sampler_results": {"episode_reward_max": -25328.253683721272, "episode_reward_min": -26080.25220475557, "episode_reward_mean": -25738.6730003611, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-25832.175491726637, -25554.266391473473, -25959.410281017565, -25690.837084897732, -25402.97920299653, -25762.143345042303, -25758.082480843907, -25553.59971194014, -25798.768777476813, -25751.632972563755, -25762.996505865038, -25635.40099255635, -25790.150874345392, -25714.420763199465, -25898.81545949767, -25583.032472728108, -25599.747136461963, -26080.25220475557, -25961.523301868016, -25680.131995975335, -25704.700582997753, -25561.725188177534, -26006.813883461164, -25473.365698160313, -25981.49901079789, -25615.818742254272, -25774.966136668256, -25718.871942171663, -26023.329850619702, -25532.399431681537, -25598.4220706197, -26013.198021050313, -25943.011287423775, -25874.848682321674, -25722.833638907243, -25948.353042061724, -25670.38114940201, -25960.801131484717, -25859.620995068624, -25626.52642722719, -25860.885808580013, -25753.036526536976, -25771.236314150938, -25746.199955167915, -25755.06299386396, -25328.253683721272, -25585.840661300284, -25903.334880684706, -25883.117045280727, -25750.56693843077, -25524.682948370977, -26031.76853595171, -25633.986617613973, -25591.02746779801, -25793.936922431694, -25463.685355827132, -25818.945219197565, -25929.59196726394, -25527.034487603927, -25690.213584724686, -25948.808061841275, -25735.575857059477, -25531.92318411009, -25606.671334184066, -25592.0114195276, -25796.179823003586, -25887.053210004226, -25743.554373883482, -26020.766098537446, -25440.00812105769, -25673.279537836806, -25340.41497547698, -25728.947743169487, -25878.791754771355, -26025.64082279114, -25551.166362507065, -25896.858298201812, -25426.459396664668, -25507.539473986046, -25711.700010391367, -25871.72504599535, -25762.468233774387, -25970.55138974913, -25738.484817348173, -25808.222128419147, -25644.358623005388, -25578.628393425395, -25879.843296086117, -25949.419554016113, -25807.105742629763, -25819.842964566073, -25549.149932077962, -25641.233468944458, -25568.18492252227, -25805.053352658015, -25883.35886329001, -25682.835904245807, -25841.339528843495, -25579.16663414852, -25718.715107068834], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.926114431009476, "mean_inference_ms": 0.27179763069849544, "mean_action_processing_ms": 0.06478786886741023, "mean_env_wait_ms": 1.6226468939304388, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0036270618438720703, "StateBufferConnector_ms": 0.0027208328247070312, "ViewRequirementAgentConnector_ms": 0.06804108619689941}}, "episode_reward_max": -25328.253683721272, "episode_reward_min": -26080.25220475557, "episode_reward_mean": -25738.6730003611, "episode_len_mean": 360.0, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-25832.175491726637, -25554.266391473473, -25959.410281017565, -25690.837084897732, -25402.97920299653, -25762.143345042303, -25758.082480843907, -25553.59971194014, -25798.768777476813, -25751.632972563755, -25762.996505865038, -25635.40099255635, -25790.150874345392, -25714.420763199465, -25898.81545949767, -25583.032472728108, -25599.747136461963, -26080.25220475557, -25961.523301868016, -25680.131995975335, -25704.700582997753, -25561.725188177534, -26006.813883461164, -25473.365698160313, -25981.49901079789, -25615.818742254272, -25774.966136668256, -25718.871942171663, -26023.329850619702, -25532.399431681537, -25598.4220706197, -26013.198021050313, -25943.011287423775, -25874.848682321674, -25722.833638907243, -25948.353042061724, -25670.38114940201, -25960.801131484717, -25859.620995068624, -25626.52642722719, -25860.885808580013, -25753.036526536976, -25771.236314150938, -25746.199955167915, -25755.06299386396, -25328.253683721272, -25585.840661300284, -25903.334880684706, -25883.117045280727, -25750.56693843077, -25524.682948370977, -26031.76853595171, -25633.986617613973, -25591.02746779801, -25793.936922431694, -25463.685355827132, -25818.945219197565, -25929.59196726394, -25527.034487603927, -25690.213584724686, -25948.808061841275, -25735.575857059477, -25531.92318411009, -25606.671334184066, -25592.0114195276, -25796.179823003586, -25887.053210004226, -25743.554373883482, -26020.766098537446, -25440.00812105769, -25673.279537836806, -25340.41497547698, -25728.947743169487, -25878.791754771355, -26025.64082279114, -25551.166362507065, -25896.858298201812, -25426.459396664668, -25507.539473986046, -25711.700010391367, -25871.72504599535, -25762.468233774387, -25970.55138974913, -25738.484817348173, -25808.222128419147, -25644.358623005388, -25578.628393425395, -25879.843296086117, -25949.419554016113, -25807.105742629763, -25819.842964566073, -25549.149932077962, -25641.233468944458, -25568.18492252227, -25805.053352658015, -25883.35886329001, -25682.835904245807, -25841.339528843495, -25579.16663414852, -25718.715107068834], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.926114431009476, "mean_inference_ms": 0.27179763069849544, "mean_action_processing_ms": 0.06478786886741023, "mean_env_wait_ms": 1.6226468939304388, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0036270618438720703, "StateBufferConnector_ms": 0.0027208328247070312, "ViewRequirementAgentConnector_ms": 0.06804108619689941}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 256320, "num_agent_steps_trained": 256320, "num_env_steps_sampled": 256320, "num_env_steps_trained": 256320, "num_env_steps_sampled_this_iter": 1080, "num_env_steps_trained_this_iter": 1080, "num_env_steps_sampled_throughput_per_sec": 94.9269132594203, "num_env_steps_trained_throughput_per_sec": 94.9269132594203, "timesteps_total": 256320, "num_steps_trained_this_iter": 1080, "agent_timesteps_total": 256320, "timers": {"training_iteration_time_ms": 3786.943, "sample_time_ms": 3776.162, "load_time_ms": 0.313, "load_throughput": 1149036.938, "learn_time_ms": 9.715, "learn_throughput": 37056.429, "synch_weights_time_ms": 0.709}, "counters": {"num_env_steps_sampled": 256320, "num_env_steps_trained": 256320, "num_agent_steps_sampled": 256320, "num_agent_steps_trained": 256320}, "done": false, "episodes_total": 712, "training_iteration": 164, "trial_id": "f5e97_00000", "date": "2023-07-25_17-26-36", "timestamp": 1690295196, "time_this_iter_s": 11.380083799362183, "time_total_s": 1840.008104801178, "pid": 71917, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[0, 0.003], [5400, 0.001], [10800, 0.00075], [16200, 0.0005], [21600, 0.00025], [27000, 0.0001], [32400, 7.5e-05], [37800, 5e-05], [43200, 2.5e-05], [48600, 1e-05], [54000, 7.5e-06], [59400, 5e-06], [64800, 2.5e-06], [70200, 1e-06], [75600, 5e-07], [81000, 1e-07]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x304530310>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1840.008104801178, "iterations_since_restore": 164, "perf": {"cpu_util_percent": 25.475, "ram_util_percent": 76.68125}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-07, "entropy_coeff": 0.1, "policy_entropy": -926.7001953125, "policy_loss": -31539830584115.2, "vf_loss": 1070157145.6}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 3573.0, "diff_num_grad_updates_vs_sampler_policy": 3572.0}}, "num_env_steps_sampled": 257400, "num_env_steps_trained": 257400, "num_agent_steps_sampled": 257400, "num_agent_steps_trained": 257400}, "sampler_results": {"episode_reward_max": -25328.253683721272, "episode_reward_min": -26080.25220475557, "episode_reward_mean": -25730.026296506374, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-25690.837084897732, -25402.97920299653, -25762.143345042303, -25758.082480843907, -25553.59971194014, -25798.768777476813, -25751.632972563755, -25762.996505865038, -25635.40099255635, -25790.150874345392, -25714.420763199465, -25898.81545949767, -25583.032472728108, -25599.747136461963, -26080.25220475557, -25961.523301868016, -25680.131995975335, -25704.700582997753, -25561.725188177534, -26006.813883461164, -25473.365698160313, -25981.49901079789, -25615.818742254272, -25774.966136668256, -25718.871942171663, -26023.329850619702, -25532.399431681537, -25598.4220706197, -26013.198021050313, -25943.011287423775, -25874.848682321674, -25722.833638907243, -25948.353042061724, -25670.38114940201, -25960.801131484717, -25859.620995068624, -25626.52642722719, -25860.885808580013, -25753.036526536976, -25771.236314150938, -25746.199955167915, -25755.06299386396, -25328.253683721272, -25585.840661300284, -25903.334880684706, -25883.117045280727, -25750.56693843077, -25524.682948370977, -26031.76853595171, -25633.986617613973, -25591.02746779801, -25793.936922431694, -25463.685355827132, -25818.945219197565, -25929.59196726394, -25527.034487603927, -25690.213584724686, -25948.808061841275, -25735.575857059477, -25531.92318411009, -25606.671334184066, -25592.0114195276, -25796.179823003586, -25887.053210004226, -25743.554373883482, -26020.766098537446, -25440.00812105769, -25673.279537836806, -25340.41497547698, -25728.947743169487, -25878.791754771355, -26025.64082279114, -25551.166362507065, -25896.858298201812, -25426.459396664668, -25507.539473986046, -25711.700010391367, -25871.72504599535, -25762.468233774387, -25970.55138974913, -25738.484817348173, -25808.222128419147, -25644.358623005388, -25578.628393425395, -25879.843296086117, -25949.419554016113, -25807.105742629763, -25819.842964566073, -25549.149932077962, -25641.233468944458, -25568.18492252227, -25805.053352658015, -25883.35886329001, -25682.835904245807, -25841.339528843495, -25579.16663414852, -25718.715107068834, -25578.875325985005, -25487.58692978545, -25414.719522974952], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.937604592139628, "mean_inference_ms": 0.2723152615985156, "mean_action_processing_ms": 0.06491719301416345, "mean_env_wait_ms": 1.6263802353611365, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0036110877990722656, "StateBufferConnector_ms": 0.0027217864990234375, "ViewRequirementAgentConnector_ms": 0.06786704063415527}}, "episode_reward_max": -25328.253683721272, "episode_reward_min": -26080.25220475557, "episode_reward_mean": -25730.026296506374, "episode_len_mean": 360.0, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-25690.837084897732, -25402.97920299653, -25762.143345042303, -25758.082480843907, -25553.59971194014, -25798.768777476813, -25751.632972563755, -25762.996505865038, -25635.40099255635, -25790.150874345392, -25714.420763199465, -25898.81545949767, -25583.032472728108, -25599.747136461963, -26080.25220475557, -25961.523301868016, -25680.131995975335, -25704.700582997753, -25561.725188177534, -26006.813883461164, -25473.365698160313, -25981.49901079789, -25615.818742254272, -25774.966136668256, -25718.871942171663, -26023.329850619702, -25532.399431681537, -25598.4220706197, -26013.198021050313, -25943.011287423775, -25874.848682321674, -25722.833638907243, -25948.353042061724, -25670.38114940201, -25960.801131484717, -25859.620995068624, -25626.52642722719, -25860.885808580013, -25753.036526536976, -25771.236314150938, -25746.199955167915, -25755.06299386396, -25328.253683721272, -25585.840661300284, -25903.334880684706, -25883.117045280727, -25750.56693843077, -25524.682948370977, -26031.76853595171, -25633.986617613973, -25591.02746779801, -25793.936922431694, -25463.685355827132, -25818.945219197565, -25929.59196726394, -25527.034487603927, -25690.213584724686, -25948.808061841275, -25735.575857059477, -25531.92318411009, -25606.671334184066, -25592.0114195276, -25796.179823003586, -25887.053210004226, -25743.554373883482, -26020.766098537446, -25440.00812105769, -25673.279537836806, -25340.41497547698, -25728.947743169487, -25878.791754771355, -26025.64082279114, -25551.166362507065, -25896.858298201812, -25426.459396664668, -25507.539473986046, -25711.700010391367, -25871.72504599535, -25762.468233774387, -25970.55138974913, -25738.484817348173, -25808.222128419147, -25644.358623005388, -25578.628393425395, -25879.843296086117, -25949.419554016113, -25807.105742629763, -25819.842964566073, -25549.149932077962, -25641.233468944458, -25568.18492252227, -25805.053352658015, -25883.35886329001, -25682.835904245807, -25841.339528843495, -25579.16663414852, -25718.715107068834, -25578.875325985005, -25487.58692978545, -25414.719522974952], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.937604592139628, "mean_inference_ms": 0.2723152615985156, "mean_action_processing_ms": 0.06491719301416345, "mean_env_wait_ms": 1.6263802353611365, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0036110877990722656, "StateBufferConnector_ms": 0.0027217864990234375, "ViewRequirementAgentConnector_ms": 0.06786704063415527}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 257400, "num_agent_steps_trained": 257400, "num_env_steps_sampled": 257400, "num_env_steps_trained": 257400, "num_env_steps_sampled_this_iter": 1080, "num_env_steps_trained_this_iter": 1080, "num_env_steps_sampled_throughput_per_sec": 94.91305599619899, "num_env_steps_trained_throughput_per_sec": 94.91305599619899, "timesteps_total": 257400, "num_steps_trained_this_iter": 1080, "agent_timesteps_total": 257400, "timers": {"training_iteration_time_ms": 3773.936, "sample_time_ms": 3763.191, "load_time_ms": 0.314, "load_throughput": 1146593.849, "learn_time_ms": 9.661, "learn_throughput": 37261.449, "synch_weights_time_ms": 0.725}, "counters": {"num_env_steps_sampled": 257400, "num_env_steps_trained": 257400, "num_agent_steps_sampled": 257400, "num_agent_steps_trained": 257400}, "done": false, "episodes_total": 715, "training_iteration": 165, "trial_id": "f5e97_00000", "date": "2023-07-25_17-26-48", "timestamp": 1690295208, "time_this_iter_s": 11.381693124771118, "time_total_s": 1851.389797925949, "pid": 71917, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[0, 0.003], [5400, 0.001], [10800, 0.00075], [16200, 0.0005], [21600, 0.00025], [27000, 0.0001], [32400, 7.5e-05], [37800, 5e-05], [43200, 2.5e-05], [48600, 1e-05], [54000, 7.5e-06], [59400, 5e-06], [64800, 2.5e-06], [70200, 1e-06], [75600, 5e-07], [81000, 1e-07]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x304530310>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1851.389797925949, "iterations_since_restore": 165, "perf": {"cpu_util_percent": 22.9125, "ram_util_percent": 76.71875}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-07, "entropy_coeff": 0.1, "policy_entropy": -926.69970703125, "policy_loss": -27037647360819.2, "vf_loss": 1100326976.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 3588.0, "diff_num_grad_updates_vs_sampler_policy": 3587.0}}, "num_env_steps_sampled": 258480, "num_env_steps_trained": 258480, "num_agent_steps_sampled": 258480, "num_agent_steps_trained": 258480}, "sampler_results": {"episode_reward_max": -25328.253683721272, "episode_reward_min": -26080.25220475557, "episode_reward_mean": -25732.70667156181, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-25758.082480843907, -25553.59971194014, -25798.768777476813, -25751.632972563755, -25762.996505865038, -25635.40099255635, -25790.150874345392, -25714.420763199465, -25898.81545949767, -25583.032472728108, -25599.747136461963, -26080.25220475557, -25961.523301868016, -25680.131995975335, -25704.700582997753, -25561.725188177534, -26006.813883461164, -25473.365698160313, -25981.49901079789, -25615.818742254272, -25774.966136668256, -25718.871942171663, -26023.329850619702, -25532.399431681537, -25598.4220706197, -26013.198021050313, -25943.011287423775, -25874.848682321674, -25722.833638907243, -25948.353042061724, -25670.38114940201, -25960.801131484717, -25859.620995068624, -25626.52642722719, -25860.885808580013, -25753.036526536976, -25771.236314150938, -25746.199955167915, -25755.06299386396, -25328.253683721272, -25585.840661300284, -25903.334880684706, -25883.117045280727, -25750.56693843077, -25524.682948370977, -26031.76853595171, -25633.986617613973, -25591.02746779801, -25793.936922431694, -25463.685355827132, -25818.945219197565, -25929.59196726394, -25527.034487603927, -25690.213584724686, -25948.808061841275, -25735.575857059477, -25531.92318411009, -25606.671334184066, -25592.0114195276, -25796.179823003586, -25887.053210004226, -25743.554373883482, -26020.766098537446, -25440.00812105769, -25673.279537836806, -25340.41497547698, -25728.947743169487, -25878.791754771355, -26025.64082279114, -25551.166362507065, -25896.858298201812, -25426.459396664668, -25507.539473986046, -25711.700010391367, -25871.72504599535, -25762.468233774387, -25970.55138974913, -25738.484817348173, -25808.222128419147, -25644.358623005388, -25578.628393425395, -25879.843296086117, -25949.419554016113, -25807.105742629763, -25819.842964566073, -25549.149932077962, -25641.233468944458, -25568.18492252227, -25805.053352658015, -25883.35886329001, -25682.835904245807, -25841.339528843495, -25579.16663414852, -25718.715107068834, -25578.875325985005, -25487.58692978545, -25414.719522974952, -25723.553788502933, -25585.66285204171, -25814.780497934556], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.949010407937053, "mean_inference_ms": 0.2728220800342879, "mean_action_processing_ms": 0.06504427829386654, "mean_env_wait_ms": 1.6300890614618984, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003588438034057617, "StateBufferConnector_ms": 0.0027129650115966797, "ViewRequirementAgentConnector_ms": 0.06747293472290039}}, "episode_reward_max": -25328.253683721272, "episode_reward_min": -26080.25220475557, "episode_reward_mean": -25732.70667156181, "episode_len_mean": 360.0, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-25758.082480843907, -25553.59971194014, -25798.768777476813, -25751.632972563755, -25762.996505865038, -25635.40099255635, -25790.150874345392, -25714.420763199465, -25898.81545949767, -25583.032472728108, -25599.747136461963, -26080.25220475557, -25961.523301868016, -25680.131995975335, -25704.700582997753, -25561.725188177534, -26006.813883461164, -25473.365698160313, -25981.49901079789, -25615.818742254272, -25774.966136668256, -25718.871942171663, -26023.329850619702, -25532.399431681537, -25598.4220706197, -26013.198021050313, -25943.011287423775, -25874.848682321674, -25722.833638907243, -25948.353042061724, -25670.38114940201, -25960.801131484717, -25859.620995068624, -25626.52642722719, -25860.885808580013, -25753.036526536976, -25771.236314150938, -25746.199955167915, -25755.06299386396, -25328.253683721272, -25585.840661300284, -25903.334880684706, -25883.117045280727, -25750.56693843077, -25524.682948370977, -26031.76853595171, -25633.986617613973, -25591.02746779801, -25793.936922431694, -25463.685355827132, -25818.945219197565, -25929.59196726394, -25527.034487603927, -25690.213584724686, -25948.808061841275, -25735.575857059477, -25531.92318411009, -25606.671334184066, -25592.0114195276, -25796.179823003586, -25887.053210004226, -25743.554373883482, -26020.766098537446, -25440.00812105769, -25673.279537836806, -25340.41497547698, -25728.947743169487, -25878.791754771355, -26025.64082279114, -25551.166362507065, -25896.858298201812, -25426.459396664668, -25507.539473986046, -25711.700010391367, -25871.72504599535, -25762.468233774387, -25970.55138974913, -25738.484817348173, -25808.222128419147, -25644.358623005388, -25578.628393425395, -25879.843296086117, -25949.419554016113, -25807.105742629763, -25819.842964566073, -25549.149932077962, -25641.233468944458, -25568.18492252227, -25805.053352658015, -25883.35886329001, -25682.835904245807, -25841.339528843495, -25579.16663414852, -25718.715107068834, -25578.875325985005, -25487.58692978545, -25414.719522974952, -25723.553788502933, -25585.66285204171, -25814.780497934556], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.949010407937053, "mean_inference_ms": 0.2728220800342879, "mean_action_processing_ms": 0.06504427829386654, "mean_env_wait_ms": 1.6300890614618984, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003588438034057617, "StateBufferConnector_ms": 0.0027129650115966797, "ViewRequirementAgentConnector_ms": 0.06747293472290039}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 258480, "num_agent_steps_trained": 258480, "num_env_steps_sampled": 258480, "num_env_steps_trained": 258480, "num_env_steps_sampled_this_iter": 1080, "num_env_steps_trained_this_iter": 1080, "num_env_steps_sampled_throughput_per_sec": 94.7072417505244, "num_env_steps_trained_throughput_per_sec": 94.7072417505244, "timesteps_total": 258480, "num_steps_trained_this_iter": 1080, "agent_timesteps_total": 258480, "timers": {"training_iteration_time_ms": 3774.858, "sample_time_ms": 3763.986, "load_time_ms": 0.316, "load_throughput": 1137866.948, "learn_time_ms": 9.753, "learn_throughput": 36912.664, "synch_weights_time_ms": 0.757}, "counters": {"num_env_steps_sampled": 258480, "num_env_steps_trained": 258480, "num_agent_steps_sampled": 258480, "num_agent_steps_trained": 258480}, "done": false, "episodes_total": 718, "training_iteration": 166, "trial_id": "f5e97_00000", "date": "2023-07-25_17-26-59", "timestamp": 1690295219, "time_this_iter_s": 11.406381845474243, "time_total_s": 1862.7961797714233, "pid": 71917, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[0, 0.003], [5400, 0.001], [10800, 0.00075], [16200, 0.0005], [21600, 0.00025], [27000, 0.0001], [32400, 7.5e-05], [37800, 5e-05], [43200, 2.5e-05], [48600, 1e-05], [54000, 7.5e-06], [59400, 5e-06], [64800, 2.5e-06], [70200, 1e-06], [75600, 5e-07], [81000, 1e-07]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x304530310>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1862.7961797714233, "iterations_since_restore": 166, "perf": {"cpu_util_percent": 21.80625, "ram_util_percent": 76.825}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-07, "entropy_coeff": 0.1, "policy_entropy": -926.6998413085937, "policy_loss": -38082600409497.6, "vf_loss": 1105640044.8}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 3603.0, "diff_num_grad_updates_vs_sampler_policy": 3602.0}}, "num_env_steps_sampled": 259560, "num_env_steps_trained": 259560, "num_agent_steps_sampled": 259560, "num_agent_steps_trained": 259560}, "sampler_results": {"episode_reward_max": -25328.253683721272, "episode_reward_min": -26080.25220475557, "episode_reward_mean": -25732.63023207694, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-25751.632972563755, -25762.996505865038, -25635.40099255635, -25790.150874345392, -25714.420763199465, -25898.81545949767, -25583.032472728108, -25599.747136461963, -26080.25220475557, -25961.523301868016, -25680.131995975335, -25704.700582997753, -25561.725188177534, -26006.813883461164, -25473.365698160313, -25981.49901079789, -25615.818742254272, -25774.966136668256, -25718.871942171663, -26023.329850619702, -25532.399431681537, -25598.4220706197, -26013.198021050313, -25943.011287423775, -25874.848682321674, -25722.833638907243, -25948.353042061724, -25670.38114940201, -25960.801131484717, -25859.620995068624, -25626.52642722719, -25860.885808580013, -25753.036526536976, -25771.236314150938, -25746.199955167915, -25755.06299386396, -25328.253683721272, -25585.840661300284, -25903.334880684706, -25883.117045280727, -25750.56693843077, -25524.682948370977, -26031.76853595171, -25633.986617613973, -25591.02746779801, -25793.936922431694, -25463.685355827132, -25818.945219197565, -25929.59196726394, -25527.034487603927, -25690.213584724686, -25948.808061841275, -25735.575857059477, -25531.92318411009, -25606.671334184066, -25592.0114195276, -25796.179823003586, -25887.053210004226, -25743.554373883482, -26020.766098537446, -25440.00812105769, -25673.279537836806, -25340.41497547698, -25728.947743169487, -25878.791754771355, -26025.64082279114, -25551.166362507065, -25896.858298201812, -25426.459396664668, -25507.539473986046, -25711.700010391367, -25871.72504599535, -25762.468233774387, -25970.55138974913, -25738.484817348173, -25808.222128419147, -25644.358623005388, -25578.628393425395, -25879.843296086117, -25949.419554016113, -25807.105742629763, -25819.842964566073, -25549.149932077962, -25641.233468944458, -25568.18492252227, -25805.053352658015, -25883.35886329001, -25682.835904245807, -25841.339528843495, -25579.16663414852, -25718.715107068834, -25578.875325985005, -25487.58692978545, -25414.719522974952, -25723.553788502933, -25585.66285204171, -25814.780497934556, -25728.28886222714, -25546.758528639086, -25827.759630908404], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.960330026517105, "mean_inference_ms": 0.2733232040141774, "mean_action_processing_ms": 0.06517005905413992, "mean_env_wait_ms": 1.6337571949719787, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0035772323608398438, "StateBufferConnector_ms": 0.002706289291381836, "ViewRequirementAgentConnector_ms": 0.0672464370727539}}, "episode_reward_max": -25328.253683721272, "episode_reward_min": -26080.25220475557, "episode_reward_mean": -25732.63023207694, "episode_len_mean": 360.0, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-25751.632972563755, -25762.996505865038, -25635.40099255635, -25790.150874345392, -25714.420763199465, -25898.81545949767, -25583.032472728108, -25599.747136461963, -26080.25220475557, -25961.523301868016, -25680.131995975335, -25704.700582997753, -25561.725188177534, -26006.813883461164, -25473.365698160313, -25981.49901079789, -25615.818742254272, -25774.966136668256, -25718.871942171663, -26023.329850619702, -25532.399431681537, -25598.4220706197, -26013.198021050313, -25943.011287423775, -25874.848682321674, -25722.833638907243, -25948.353042061724, -25670.38114940201, -25960.801131484717, -25859.620995068624, -25626.52642722719, -25860.885808580013, -25753.036526536976, -25771.236314150938, -25746.199955167915, -25755.06299386396, -25328.253683721272, -25585.840661300284, -25903.334880684706, -25883.117045280727, -25750.56693843077, -25524.682948370977, -26031.76853595171, -25633.986617613973, -25591.02746779801, -25793.936922431694, -25463.685355827132, -25818.945219197565, -25929.59196726394, -25527.034487603927, -25690.213584724686, -25948.808061841275, -25735.575857059477, -25531.92318411009, -25606.671334184066, -25592.0114195276, -25796.179823003586, -25887.053210004226, -25743.554373883482, -26020.766098537446, -25440.00812105769, -25673.279537836806, -25340.41497547698, -25728.947743169487, -25878.791754771355, -26025.64082279114, -25551.166362507065, -25896.858298201812, -25426.459396664668, -25507.539473986046, -25711.700010391367, -25871.72504599535, -25762.468233774387, -25970.55138974913, -25738.484817348173, -25808.222128419147, -25644.358623005388, -25578.628393425395, -25879.843296086117, -25949.419554016113, -25807.105742629763, -25819.842964566073, -25549.149932077962, -25641.233468944458, -25568.18492252227, -25805.053352658015, -25883.35886329001, -25682.835904245807, -25841.339528843495, -25579.16663414852, -25718.715107068834, -25578.875325985005, -25487.58692978545, -25414.719522974952, -25723.553788502933, -25585.66285204171, -25814.780497934556, -25728.28886222714, -25546.758528639086, -25827.759630908404], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.960330026517105, "mean_inference_ms": 0.2733232040141774, "mean_action_processing_ms": 0.06517005905413992, "mean_env_wait_ms": 1.6337571949719787, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0035772323608398438, "StateBufferConnector_ms": 0.002706289291381836, "ViewRequirementAgentConnector_ms": 0.0672464370727539}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 259560, "num_agent_steps_trained": 259560, "num_env_steps_sampled": 259560, "num_env_steps_trained": 259560, "num_env_steps_sampled_this_iter": 1080, "num_env_steps_trained_this_iter": 1080, "num_env_steps_sampled_throughput_per_sec": 95.05901767800187, "num_env_steps_trained_throughput_per_sec": 95.05901767800187, "timesteps_total": 259560, "num_steps_trained_this_iter": 1080, "agent_timesteps_total": 259560, "timers": {"training_iteration_time_ms": 3784.187, "sample_time_ms": 3773.297, "load_time_ms": 0.317, "load_throughput": 1137010.12, "learn_time_ms": 9.773, "learn_throughput": 36837.559, "synch_weights_time_ms": 0.755}, "counters": {"num_env_steps_sampled": 259560, "num_env_steps_trained": 259560, "num_agent_steps_sampled": 259560, "num_agent_steps_trained": 259560}, "done": false, "episodes_total": 721, "training_iteration": 167, "trial_id": "f5e97_00000", "date": "2023-07-25_17-27-10", "timestamp": 1690295230, "time_this_iter_s": 11.364151954650879, "time_total_s": 1874.1603317260742, "pid": 71917, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[0, 0.003], [5400, 0.001], [10800, 0.00075], [16200, 0.0005], [21600, 0.00025], [27000, 0.0001], [32400, 7.5e-05], [37800, 5e-05], [43200, 2.5e-05], [48600, 1e-05], [54000, 7.5e-06], [59400, 5e-06], [64800, 2.5e-06], [70200, 1e-06], [75600, 5e-07], [81000, 1e-07]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x304530310>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1874.1603317260742, "iterations_since_restore": 167, "perf": {"cpu_util_percent": 24.8375, "ram_util_percent": 76.71875}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-07, "entropy_coeff": 0.1, "policy_entropy": -926.6999267578125, "policy_loss": -33425376767180.8, "vf_loss": 1086264134.4}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 3618.0, "diff_num_grad_updates_vs_sampler_policy": 3617.0}}, "num_env_steps_sampled": 260640, "num_env_steps_trained": 260640, "num_agent_steps_sampled": 260640, "num_agent_steps_trained": 260640}, "sampler_results": {"episode_reward_max": -25328.253683721272, "episode_reward_min": -26080.25220475557, "episode_reward_mean": -25730.42443209453, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-25790.150874345392, -25714.420763199465, -25898.81545949767, -25583.032472728108, -25599.747136461963, -26080.25220475557, -25961.523301868016, -25680.131995975335, -25704.700582997753, -25561.725188177534, -26006.813883461164, -25473.365698160313, -25981.49901079789, -25615.818742254272, -25774.966136668256, -25718.871942171663, -26023.329850619702, -25532.399431681537, -25598.4220706197, -26013.198021050313, -25943.011287423775, -25874.848682321674, -25722.833638907243, -25948.353042061724, -25670.38114940201, -25960.801131484717, -25859.620995068624, -25626.52642722719, -25860.885808580013, -25753.036526536976, -25771.236314150938, -25746.199955167915, -25755.06299386396, -25328.253683721272, -25585.840661300284, -25903.334880684706, -25883.117045280727, -25750.56693843077, -25524.682948370977, -26031.76853595171, -25633.986617613973, -25591.02746779801, -25793.936922431694, -25463.685355827132, -25818.945219197565, -25929.59196726394, -25527.034487603927, -25690.213584724686, -25948.808061841275, -25735.575857059477, -25531.92318411009, -25606.671334184066, -25592.0114195276, -25796.179823003586, -25887.053210004226, -25743.554373883482, -26020.766098537446, -25440.00812105769, -25673.279537836806, -25340.41497547698, -25728.947743169487, -25878.791754771355, -26025.64082279114, -25551.166362507065, -25896.858298201812, -25426.459396664668, -25507.539473986046, -25711.700010391367, -25871.72504599535, -25762.468233774387, -25970.55138974913, -25738.484817348173, -25808.222128419147, -25644.358623005388, -25578.628393425395, -25879.843296086117, -25949.419554016113, -25807.105742629763, -25819.842964566073, -25549.149932077962, -25641.233468944458, -25568.18492252227, -25805.053352658015, -25883.35886329001, -25682.835904245807, -25841.339528843495, -25579.16663414852, -25718.715107068834, -25578.875325985005, -25487.58692978545, -25414.719522974952, -25723.553788502933, -25585.66285204171, -25814.780497934556, -25728.28886222714, -25546.758528639086, -25827.759630908404, -25646.95840681918, -25603.08863441588, -25679.40343150969], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.971545351996542, "mean_inference_ms": 0.27381952750734867, "mean_action_processing_ms": 0.06529468063134644, "mean_env_wait_ms": 1.6373987264890706, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003573894500732422, "StateBufferConnector_ms": 0.0027017593383789062, "ViewRequirementAgentConnector_ms": 0.06724834442138672}}, "episode_reward_max": -25328.253683721272, "episode_reward_min": -26080.25220475557, "episode_reward_mean": -25730.42443209453, "episode_len_mean": 360.0, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-25790.150874345392, -25714.420763199465, -25898.81545949767, -25583.032472728108, -25599.747136461963, -26080.25220475557, -25961.523301868016, -25680.131995975335, -25704.700582997753, -25561.725188177534, -26006.813883461164, -25473.365698160313, -25981.49901079789, -25615.818742254272, -25774.966136668256, -25718.871942171663, -26023.329850619702, -25532.399431681537, -25598.4220706197, -26013.198021050313, -25943.011287423775, -25874.848682321674, -25722.833638907243, -25948.353042061724, -25670.38114940201, -25960.801131484717, -25859.620995068624, -25626.52642722719, -25860.885808580013, -25753.036526536976, -25771.236314150938, -25746.199955167915, -25755.06299386396, -25328.253683721272, -25585.840661300284, -25903.334880684706, -25883.117045280727, -25750.56693843077, -25524.682948370977, -26031.76853595171, -25633.986617613973, -25591.02746779801, -25793.936922431694, -25463.685355827132, -25818.945219197565, -25929.59196726394, -25527.034487603927, -25690.213584724686, -25948.808061841275, -25735.575857059477, -25531.92318411009, -25606.671334184066, -25592.0114195276, -25796.179823003586, -25887.053210004226, -25743.554373883482, -26020.766098537446, -25440.00812105769, -25673.279537836806, -25340.41497547698, -25728.947743169487, -25878.791754771355, -26025.64082279114, -25551.166362507065, -25896.858298201812, -25426.459396664668, -25507.539473986046, -25711.700010391367, -25871.72504599535, -25762.468233774387, -25970.55138974913, -25738.484817348173, -25808.222128419147, -25644.358623005388, -25578.628393425395, -25879.843296086117, -25949.419554016113, -25807.105742629763, -25819.842964566073, -25549.149932077962, -25641.233468944458, -25568.18492252227, -25805.053352658015, -25883.35886329001, -25682.835904245807, -25841.339528843495, -25579.16663414852, -25718.715107068834, -25578.875325985005, -25487.58692978545, -25414.719522974952, -25723.553788502933, -25585.66285204171, -25814.780497934556, -25728.28886222714, -25546.758528639086, -25827.759630908404, -25646.95840681918, -25603.08863441588, -25679.40343150969], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.971545351996542, "mean_inference_ms": 0.27381952750734867, "mean_action_processing_ms": 0.06529468063134644, "mean_env_wait_ms": 1.6373987264890706, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003573894500732422, "StateBufferConnector_ms": 0.0027017593383789062, "ViewRequirementAgentConnector_ms": 0.06724834442138672}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 260640, "num_agent_steps_trained": 260640, "num_env_steps_sampled": 260640, "num_env_steps_trained": 260640, "num_env_steps_sampled_this_iter": 1080, "num_env_steps_trained_this_iter": 1080, "num_env_steps_sampled_throughput_per_sec": 95.36733791730845, "num_env_steps_trained_throughput_per_sec": 95.36733791730845, "timesteps_total": 260640, "num_steps_trained_this_iter": 1080, "agent_timesteps_total": 260640, "timers": {"training_iteration_time_ms": 3792.51, "sample_time_ms": 3781.739, "load_time_ms": 0.312, "load_throughput": 1154395.596, "learn_time_ms": 9.668, "learn_throughput": 37236.272, "synch_weights_time_ms": 0.747}, "counters": {"num_env_steps_sampled": 260640, "num_env_steps_trained": 260640, "num_agent_steps_sampled": 260640, "num_agent_steps_trained": 260640}, "done": false, "episodes_total": 724, "training_iteration": 168, "trial_id": "f5e97_00000", "date": "2023-07-25_17-27-22", "timestamp": 1690295242, "time_this_iter_s": 11.327428102493286, "time_total_s": 1885.4877598285675, "pid": 71917, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[0, 0.003], [5400, 0.001], [10800, 0.00075], [16200, 0.0005], [21600, 0.00025], [27000, 0.0001], [32400, 7.5e-05], [37800, 5e-05], [43200, 2.5e-05], [48600, 1e-05], [54000, 7.5e-06], [59400, 5e-06], [64800, 2.5e-06], [70200, 1e-06], [75600, 5e-07], [81000, 1e-07]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x304530310>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1885.4877598285675, "iterations_since_restore": 168, "perf": {"cpu_util_percent": 23.5375, "ram_util_percent": 76.70625}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-07, "entropy_coeff": 0.1, "policy_entropy": -926.6998168945313, "policy_loss": -13733043122995.2, "vf_loss": 1100999385.6}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 3633.0, "diff_num_grad_updates_vs_sampler_policy": 3632.0}}, "num_env_steps_sampled": 261720, "num_env_steps_trained": 261720, "num_agent_steps_sampled": 261720, "num_agent_steps_trained": 261720}, "sampler_results": {"episode_reward_max": -25328.253683721272, "episode_reward_min": -26080.25220475557, "episode_reward_mean": -25728.43240399916, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-25583.032472728108, -25599.747136461963, -26080.25220475557, -25961.523301868016, -25680.131995975335, -25704.700582997753, -25561.725188177534, -26006.813883461164, -25473.365698160313, -25981.49901079789, -25615.818742254272, -25774.966136668256, -25718.871942171663, -26023.329850619702, -25532.399431681537, -25598.4220706197, -26013.198021050313, -25943.011287423775, -25874.848682321674, -25722.833638907243, -25948.353042061724, -25670.38114940201, -25960.801131484717, -25859.620995068624, -25626.52642722719, -25860.885808580013, -25753.036526536976, -25771.236314150938, -25746.199955167915, -25755.06299386396, -25328.253683721272, -25585.840661300284, -25903.334880684706, -25883.117045280727, -25750.56693843077, -25524.682948370977, -26031.76853595171, -25633.986617613973, -25591.02746779801, -25793.936922431694, -25463.685355827132, -25818.945219197565, -25929.59196726394, -25527.034487603927, -25690.213584724686, -25948.808061841275, -25735.575857059477, -25531.92318411009, -25606.671334184066, -25592.0114195276, -25796.179823003586, -25887.053210004226, -25743.554373883482, -26020.766098537446, -25440.00812105769, -25673.279537836806, -25340.41497547698, -25728.947743169487, -25878.791754771355, -26025.64082279114, -25551.166362507065, -25896.858298201812, -25426.459396664668, -25507.539473986046, -25711.700010391367, -25871.72504599535, -25762.468233774387, -25970.55138974913, -25738.484817348173, -25808.222128419147, -25644.358623005388, -25578.628393425395, -25879.843296086117, -25949.419554016113, -25807.105742629763, -25819.842964566073, -25549.149932077962, -25641.233468944458, -25568.18492252227, -25805.053352658015, -25883.35886329001, -25682.835904245807, -25841.339528843495, -25579.16663414852, -25718.715107068834, -25578.875325985005, -25487.58692978545, -25414.719522974952, -25723.553788502933, -25585.66285204171, -25814.780497934556, -25728.28886222714, -25546.758528639086, -25827.759630908404, -25646.95840681918, -25603.08863441588, -25679.40343150969, -25653.952587061678, -25729.454126294324, -25820.777574148327], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.982659251403516, "mean_inference_ms": 0.2743113207193919, "mean_action_processing_ms": 0.06541823248766829, "mean_env_wait_ms": 1.641014268231406, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0035810470581054688, "StateBufferConnector_ms": 0.0027022361755371094, "ViewRequirementAgentConnector_ms": 0.0672614574432373}}, "episode_reward_max": -25328.253683721272, "episode_reward_min": -26080.25220475557, "episode_reward_mean": -25728.43240399916, "episode_len_mean": 360.0, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-25583.032472728108, -25599.747136461963, -26080.25220475557, -25961.523301868016, -25680.131995975335, -25704.700582997753, -25561.725188177534, -26006.813883461164, -25473.365698160313, -25981.49901079789, -25615.818742254272, -25774.966136668256, -25718.871942171663, -26023.329850619702, -25532.399431681537, -25598.4220706197, -26013.198021050313, -25943.011287423775, -25874.848682321674, -25722.833638907243, -25948.353042061724, -25670.38114940201, -25960.801131484717, -25859.620995068624, -25626.52642722719, -25860.885808580013, -25753.036526536976, -25771.236314150938, -25746.199955167915, -25755.06299386396, -25328.253683721272, -25585.840661300284, -25903.334880684706, -25883.117045280727, -25750.56693843077, -25524.682948370977, -26031.76853595171, -25633.986617613973, -25591.02746779801, -25793.936922431694, -25463.685355827132, -25818.945219197565, -25929.59196726394, -25527.034487603927, -25690.213584724686, -25948.808061841275, -25735.575857059477, -25531.92318411009, -25606.671334184066, -25592.0114195276, -25796.179823003586, -25887.053210004226, -25743.554373883482, -26020.766098537446, -25440.00812105769, -25673.279537836806, -25340.41497547698, -25728.947743169487, -25878.791754771355, -26025.64082279114, -25551.166362507065, -25896.858298201812, -25426.459396664668, -25507.539473986046, -25711.700010391367, -25871.72504599535, -25762.468233774387, -25970.55138974913, -25738.484817348173, -25808.222128419147, -25644.358623005388, -25578.628393425395, -25879.843296086117, -25949.419554016113, -25807.105742629763, -25819.842964566073, -25549.149932077962, -25641.233468944458, -25568.18492252227, -25805.053352658015, -25883.35886329001, -25682.835904245807, -25841.339528843495, -25579.16663414852, -25718.715107068834, -25578.875325985005, -25487.58692978545, -25414.719522974952, -25723.553788502933, -25585.66285204171, -25814.780497934556, -25728.28886222714, -25546.758528639086, -25827.759630908404, -25646.95840681918, -25603.08863441588, -25679.40343150969, -25653.952587061678, -25729.454126294324, -25820.777574148327], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.982659251403516, "mean_inference_ms": 0.2743113207193919, "mean_action_processing_ms": 0.06541823248766829, "mean_env_wait_ms": 1.641014268231406, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0035810470581054688, "StateBufferConnector_ms": 0.0027022361755371094, "ViewRequirementAgentConnector_ms": 0.0672614574432373}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 261720, "num_agent_steps_trained": 261720, "num_env_steps_sampled": 261720, "num_env_steps_trained": 261720, "num_env_steps_sampled_this_iter": 1080, "num_env_steps_trained_this_iter": 1080, "num_env_steps_sampled_throughput_per_sec": 95.93432230742097, "num_env_steps_trained_throughput_per_sec": 95.93432230742097, "timesteps_total": 261720, "num_steps_trained_this_iter": 1080, "agent_timesteps_total": 261720, "timers": {"training_iteration_time_ms": 3787.971, "sample_time_ms": 3777.18, "load_time_ms": 0.309, "load_throughput": 1163558.172, "learn_time_ms": 9.714, "learn_throughput": 37060.158, "synch_weights_time_ms": 0.723}, "counters": {"num_env_steps_sampled": 261720, "num_env_steps_trained": 261720, "num_agent_steps_sampled": 261720, "num_agent_steps_trained": 261720}, "done": false, "episodes_total": 727, "training_iteration": 169, "trial_id": "f5e97_00000", "date": "2023-07-25_17-27-33", "timestamp": 1690295253, "time_this_iter_s": 11.260463237762451, "time_total_s": 1896.74822306633, "pid": 71917, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[0, 0.003], [5400, 0.001], [10800, 0.00075], [16200, 0.0005], [21600, 0.00025], [27000, 0.0001], [32400, 7.5e-05], [37800, 5e-05], [43200, 2.5e-05], [48600, 1e-05], [54000, 7.5e-06], [59400, 5e-06], [64800, 2.5e-06], [70200, 1e-06], [75600, 5e-07], [81000, 1e-07]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x304530310>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1896.74822306633, "iterations_since_restore": 169, "perf": {"cpu_util_percent": 24.49375, "ram_util_percent": 76.65}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-07, "entropy_coeff": 0.1, "policy_entropy": -926.6999633789062, "policy_loss": -27858586592870.4, "vf_loss": 1085339315.2}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 3648.0, "diff_num_grad_updates_vs_sampler_policy": 3647.0}}, "num_env_steps_sampled": 262800, "num_env_steps_trained": 262800, "num_agent_steps_sampled": 262800, "num_agent_steps_trained": 262800}, "sampler_results": {"episode_reward_max": -25328.253683721272, "episode_reward_min": -26031.76853595171, "episode_reward_mean": -25724.517737680635, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-25961.523301868016, -25680.131995975335, -25704.700582997753, -25561.725188177534, -26006.813883461164, -25473.365698160313, -25981.49901079789, -25615.818742254272, -25774.966136668256, -25718.871942171663, -26023.329850619702, -25532.399431681537, -25598.4220706197, -26013.198021050313, -25943.011287423775, -25874.848682321674, -25722.833638907243, -25948.353042061724, -25670.38114940201, -25960.801131484717, -25859.620995068624, -25626.52642722719, -25860.885808580013, -25753.036526536976, -25771.236314150938, -25746.199955167915, -25755.06299386396, -25328.253683721272, -25585.840661300284, -25903.334880684706, -25883.117045280727, -25750.56693843077, -25524.682948370977, -26031.76853595171, -25633.986617613973, -25591.02746779801, -25793.936922431694, -25463.685355827132, -25818.945219197565, -25929.59196726394, -25527.034487603927, -25690.213584724686, -25948.808061841275, -25735.575857059477, -25531.92318411009, -25606.671334184066, -25592.0114195276, -25796.179823003586, -25887.053210004226, -25743.554373883482, -26020.766098537446, -25440.00812105769, -25673.279537836806, -25340.41497547698, -25728.947743169487, -25878.791754771355, -26025.64082279114, -25551.166362507065, -25896.858298201812, -25426.459396664668, -25507.539473986046, -25711.700010391367, -25871.72504599535, -25762.468233774387, -25970.55138974913, -25738.484817348173, -25808.222128419147, -25644.358623005388, -25578.628393425395, -25879.843296086117, -25949.419554016113, -25807.105742629763, -25819.842964566073, -25549.149932077962, -25641.233468944458, -25568.18492252227, -25805.053352658015, -25883.35886329001, -25682.835904245807, -25841.339528843495, -25579.16663414852, -25718.715107068834, -25578.875325985005, -25487.58692978545, -25414.719522974952, -25723.553788502933, -25585.66285204171, -25814.780497934556, -25728.28886222714, -25546.758528639086, -25827.759630908404, -25646.95840681918, -25603.08863441588, -25679.40343150969, -25653.952587061678, -25729.454126294324, -25820.777574148327, -25577.758394328685, -25722.621822540772, -25571.184965224078], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.993681653694571, "mean_inference_ms": 0.27479839260396277, "mean_action_processing_ms": 0.06554060832816982, "mean_env_wait_ms": 1.6445990881256767, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003574371337890625, "StateBufferConnector_ms": 0.0027081966400146484, "ViewRequirementAgentConnector_ms": 0.06727743148803711}}, "episode_reward_max": -25328.253683721272, "episode_reward_min": -26031.76853595171, "episode_reward_mean": -25724.517737680635, "episode_len_mean": 360.0, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-25961.523301868016, -25680.131995975335, -25704.700582997753, -25561.725188177534, -26006.813883461164, -25473.365698160313, -25981.49901079789, -25615.818742254272, -25774.966136668256, -25718.871942171663, -26023.329850619702, -25532.399431681537, -25598.4220706197, -26013.198021050313, -25943.011287423775, -25874.848682321674, -25722.833638907243, -25948.353042061724, -25670.38114940201, -25960.801131484717, -25859.620995068624, -25626.52642722719, -25860.885808580013, -25753.036526536976, -25771.236314150938, -25746.199955167915, -25755.06299386396, -25328.253683721272, -25585.840661300284, -25903.334880684706, -25883.117045280727, -25750.56693843077, -25524.682948370977, -26031.76853595171, -25633.986617613973, -25591.02746779801, -25793.936922431694, -25463.685355827132, -25818.945219197565, -25929.59196726394, -25527.034487603927, -25690.213584724686, -25948.808061841275, -25735.575857059477, -25531.92318411009, -25606.671334184066, -25592.0114195276, -25796.179823003586, -25887.053210004226, -25743.554373883482, -26020.766098537446, -25440.00812105769, -25673.279537836806, -25340.41497547698, -25728.947743169487, -25878.791754771355, -26025.64082279114, -25551.166362507065, -25896.858298201812, -25426.459396664668, -25507.539473986046, -25711.700010391367, -25871.72504599535, -25762.468233774387, -25970.55138974913, -25738.484817348173, -25808.222128419147, -25644.358623005388, -25578.628393425395, -25879.843296086117, -25949.419554016113, -25807.105742629763, -25819.842964566073, -25549.149932077962, -25641.233468944458, -25568.18492252227, -25805.053352658015, -25883.35886329001, -25682.835904245807, -25841.339528843495, -25579.16663414852, -25718.715107068834, -25578.875325985005, -25487.58692978545, -25414.719522974952, -25723.553788502933, -25585.66285204171, -25814.780497934556, -25728.28886222714, -25546.758528639086, -25827.759630908404, -25646.95840681918, -25603.08863441588, -25679.40343150969, -25653.952587061678, -25729.454126294324, -25820.777574148327, -25577.758394328685, -25722.621822540772, -25571.184965224078], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.993681653694571, "mean_inference_ms": 0.27479839260396277, "mean_action_processing_ms": 0.06554060832816982, "mean_env_wait_ms": 1.6445990881256767, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003574371337890625, "StateBufferConnector_ms": 0.0027081966400146484, "ViewRequirementAgentConnector_ms": 0.06727743148803711}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 262800, "num_agent_steps_trained": 262800, "num_env_steps_sampled": 262800, "num_env_steps_trained": 262800, "num_env_steps_sampled_this_iter": 1080, "num_env_steps_trained_this_iter": 1080, "num_env_steps_sampled_throughput_per_sec": 95.76647520763946, "num_env_steps_trained_throughput_per_sec": 95.76647520763946, "timesteps_total": 262800, "num_steps_trained_this_iter": 1080, "agent_timesteps_total": 262800, "timers": {"training_iteration_time_ms": 3773.659, "sample_time_ms": 3762.895, "load_time_ms": 0.314, "load_throughput": 1147116.493, "learn_time_ms": 9.683, "learn_throughput": 37178.785, "synch_weights_time_ms": 0.724}, "counters": {"num_env_steps_sampled": 262800, "num_env_steps_trained": 262800, "num_agent_steps_sampled": 262800, "num_agent_steps_trained": 262800}, "done": false, "episodes_total": 730, "training_iteration": 170, "trial_id": "f5e97_00000", "date": "2023-07-25_17-27-44", "timestamp": 1690295264, "time_this_iter_s": 11.280259132385254, "time_total_s": 1908.0284821987152, "pid": 71917, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[0, 0.003], [5400, 0.001], [10800, 0.00075], [16200, 0.0005], [21600, 0.00025], [27000, 0.0001], [32400, 7.5e-05], [37800, 5e-05], [43200, 2.5e-05], [48600, 1e-05], [54000, 7.5e-06], [59400, 5e-06], [64800, 2.5e-06], [70200, 1e-06], [75600, 5e-07], [81000, 1e-07]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x304530310>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1908.0284821987152, "iterations_since_restore": 170, "perf": {"cpu_util_percent": 27.36875, "ram_util_percent": 76.9125}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-07, "entropy_coeff": 0.1, "policy_entropy": -926.699658203125, "policy_loss": -21817421719142.4, "vf_loss": 1106795622.4}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 3663.0, "diff_num_grad_updates_vs_sampler_policy": 3662.0}}, "num_env_steps_sampled": 263880, "num_env_steps_trained": 263880, "num_agent_steps_sampled": 263880, "num_agent_steps_trained": 263880}, "sampler_results": {"episode_reward_max": -25328.253683721272, "episode_reward_min": -26031.76853595171, "episode_reward_mean": -25723.898783408153, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-25561.725188177534, -26006.813883461164, -25473.365698160313, -25981.49901079789, -25615.818742254272, -25774.966136668256, -25718.871942171663, -26023.329850619702, -25532.399431681537, -25598.4220706197, -26013.198021050313, -25943.011287423775, -25874.848682321674, -25722.833638907243, -25948.353042061724, -25670.38114940201, -25960.801131484717, -25859.620995068624, -25626.52642722719, -25860.885808580013, -25753.036526536976, -25771.236314150938, -25746.199955167915, -25755.06299386396, -25328.253683721272, -25585.840661300284, -25903.334880684706, -25883.117045280727, -25750.56693843077, -25524.682948370977, -26031.76853595171, -25633.986617613973, -25591.02746779801, -25793.936922431694, -25463.685355827132, -25818.945219197565, -25929.59196726394, -25527.034487603927, -25690.213584724686, -25948.808061841275, -25735.575857059477, -25531.92318411009, -25606.671334184066, -25592.0114195276, -25796.179823003586, -25887.053210004226, -25743.554373883482, -26020.766098537446, -25440.00812105769, -25673.279537836806, -25340.41497547698, -25728.947743169487, -25878.791754771355, -26025.64082279114, -25551.166362507065, -25896.858298201812, -25426.459396664668, -25507.539473986046, -25711.700010391367, -25871.72504599535, -25762.468233774387, -25970.55138974913, -25738.484817348173, -25808.222128419147, -25644.358623005388, -25578.628393425395, -25879.843296086117, -25949.419554016113, -25807.105742629763, -25819.842964566073, -25549.149932077962, -25641.233468944458, -25568.18492252227, -25805.053352658015, -25883.35886329001, -25682.835904245807, -25841.339528843495, -25579.16663414852, -25718.715107068834, -25578.875325985005, -25487.58692978545, -25414.719522974952, -25723.553788502933, -25585.66285204171, -25814.780497934556, -25728.28886222714, -25546.758528639086, -25827.759630908404, -25646.95840681918, -25603.08863441588, -25679.40343150969, -25653.952587061678, -25729.454126294324, -25820.777574148327, -25577.758394328685, -25722.621822540772, -25571.184965224078, -25749.786517622135, -25608.69988687303, -25925.974049098433], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.0046356131106275, "mean_inference_ms": 0.27528214301730025, "mean_action_processing_ms": 0.06566203304191429, "mean_env_wait_ms": 1.6481536487344228, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003585338592529297, "StateBufferConnector_ms": 0.002706766128540039, "ViewRequirementAgentConnector_ms": 0.06744146347045898}}, "episode_reward_max": -25328.253683721272, "episode_reward_min": -26031.76853595171, "episode_reward_mean": -25723.898783408153, "episode_len_mean": 360.0, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-25561.725188177534, -26006.813883461164, -25473.365698160313, -25981.49901079789, -25615.818742254272, -25774.966136668256, -25718.871942171663, -26023.329850619702, -25532.399431681537, -25598.4220706197, -26013.198021050313, -25943.011287423775, -25874.848682321674, -25722.833638907243, -25948.353042061724, -25670.38114940201, -25960.801131484717, -25859.620995068624, -25626.52642722719, -25860.885808580013, -25753.036526536976, -25771.236314150938, -25746.199955167915, -25755.06299386396, -25328.253683721272, -25585.840661300284, -25903.334880684706, -25883.117045280727, -25750.56693843077, -25524.682948370977, -26031.76853595171, -25633.986617613973, -25591.02746779801, -25793.936922431694, -25463.685355827132, -25818.945219197565, -25929.59196726394, -25527.034487603927, -25690.213584724686, -25948.808061841275, -25735.575857059477, -25531.92318411009, -25606.671334184066, -25592.0114195276, -25796.179823003586, -25887.053210004226, -25743.554373883482, -26020.766098537446, -25440.00812105769, -25673.279537836806, -25340.41497547698, -25728.947743169487, -25878.791754771355, -26025.64082279114, -25551.166362507065, -25896.858298201812, -25426.459396664668, -25507.539473986046, -25711.700010391367, -25871.72504599535, -25762.468233774387, -25970.55138974913, -25738.484817348173, -25808.222128419147, -25644.358623005388, -25578.628393425395, -25879.843296086117, -25949.419554016113, -25807.105742629763, -25819.842964566073, -25549.149932077962, -25641.233468944458, -25568.18492252227, -25805.053352658015, -25883.35886329001, -25682.835904245807, -25841.339528843495, -25579.16663414852, -25718.715107068834, -25578.875325985005, -25487.58692978545, -25414.719522974952, -25723.553788502933, -25585.66285204171, -25814.780497934556, -25728.28886222714, -25546.758528639086, -25827.759630908404, -25646.95840681918, -25603.08863441588, -25679.40343150969, -25653.952587061678, -25729.454126294324, -25820.777574148327, -25577.758394328685, -25722.621822540772, -25571.184965224078, -25749.786517622135, -25608.69988687303, -25925.974049098433], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.0046356131106275, "mean_inference_ms": 0.27528214301730025, "mean_action_processing_ms": 0.06566203304191429, "mean_env_wait_ms": 1.6481536487344228, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003585338592529297, "StateBufferConnector_ms": 0.002706766128540039, "ViewRequirementAgentConnector_ms": 0.06744146347045898}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 263880, "num_agent_steps_trained": 263880, "num_env_steps_sampled": 263880, "num_env_steps_trained": 263880, "num_env_steps_sampled_this_iter": 1080, "num_env_steps_trained_this_iter": 1080, "num_env_steps_sampled_throughput_per_sec": 94.80438699073663, "num_env_steps_trained_throughput_per_sec": 94.80438699073663, "timesteps_total": 263880, "num_steps_trained_this_iter": 1080, "agent_timesteps_total": 263880, "timers": {"training_iteration_time_ms": 3779.712, "sample_time_ms": 3768.916, "load_time_ms": 0.31, "load_throughput": 1159537.275, "learn_time_ms": 9.713, "learn_throughput": 37064.798, "synch_weights_time_ms": 0.729}, "counters": {"num_env_steps_sampled": 263880, "num_env_steps_trained": 263880, "num_agent_steps_sampled": 263880, "num_agent_steps_trained": 263880}, "done": false, "episodes_total": 733, "training_iteration": 171, "trial_id": "f5e97_00000", "date": "2023-07-25_17-27-56", "timestamp": 1690295276, "time_this_iter_s": 11.39490795135498, "time_total_s": 1919.4233901500702, "pid": 71917, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[0, 0.003], [5400, 0.001], [10800, 0.00075], [16200, 0.0005], [21600, 0.00025], [27000, 0.0001], [32400, 7.5e-05], [37800, 5e-05], [43200, 2.5e-05], [48600, 1e-05], [54000, 7.5e-06], [59400, 5e-06], [64800, 2.5e-06], [70200, 1e-06], [75600, 5e-07], [81000, 1e-07]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x304530310>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1919.4233901500702, "iterations_since_restore": 171, "perf": {"cpu_util_percent": 25.23125, "ram_util_percent": 77.20625}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-07, "entropy_coeff": 0.1, "policy_entropy": -926.700146484375, "policy_loss": -25476919525376.0, "vf_loss": 1079404979.2}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 3678.0, "diff_num_grad_updates_vs_sampler_policy": 3677.0}}, "num_env_steps_sampled": 264960, "num_env_steps_trained": 264960, "num_agent_steps_sampled": 264960, "num_agent_steps_trained": 264960}, "sampler_results": {"episode_reward_max": -25328.253683721272, "episode_reward_min": -26031.76853595171, "episode_reward_mean": -25721.05989395847, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-25981.49901079789, -25615.818742254272, -25774.966136668256, -25718.871942171663, -26023.329850619702, -25532.399431681537, -25598.4220706197, -26013.198021050313, -25943.011287423775, -25874.848682321674, -25722.833638907243, -25948.353042061724, -25670.38114940201, -25960.801131484717, -25859.620995068624, -25626.52642722719, -25860.885808580013, -25753.036526536976, -25771.236314150938, -25746.199955167915, -25755.06299386396, -25328.253683721272, -25585.840661300284, -25903.334880684706, -25883.117045280727, -25750.56693843077, -25524.682948370977, -26031.76853595171, -25633.986617613973, -25591.02746779801, -25793.936922431694, -25463.685355827132, -25818.945219197565, -25929.59196726394, -25527.034487603927, -25690.213584724686, -25948.808061841275, -25735.575857059477, -25531.92318411009, -25606.671334184066, -25592.0114195276, -25796.179823003586, -25887.053210004226, -25743.554373883482, -26020.766098537446, -25440.00812105769, -25673.279537836806, -25340.41497547698, -25728.947743169487, -25878.791754771355, -26025.64082279114, -25551.166362507065, -25896.858298201812, -25426.459396664668, -25507.539473986046, -25711.700010391367, -25871.72504599535, -25762.468233774387, -25970.55138974913, -25738.484817348173, -25808.222128419147, -25644.358623005388, -25578.628393425395, -25879.843296086117, -25949.419554016113, -25807.105742629763, -25819.842964566073, -25549.149932077962, -25641.233468944458, -25568.18492252227, -25805.053352658015, -25883.35886329001, -25682.835904245807, -25841.339528843495, -25579.16663414852, -25718.715107068834, -25578.875325985005, -25487.58692978545, -25414.719522974952, -25723.553788502933, -25585.66285204171, -25814.780497934556, -25728.28886222714, -25546.758528639086, -25827.759630908404, -25646.95840681918, -25603.08863441588, -25679.40343150969, -25653.952587061678, -25729.454126294324, -25820.777574148327, -25577.758394328685, -25722.621822540772, -25571.184965224078, -25749.786517622135, -25608.69988687303, -25925.974049098433, -25539.057099478276, -25596.79683226327, -25622.161893088214], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.015520954172381, "mean_inference_ms": 0.2757625307716673, "mean_action_processing_ms": 0.06578256660043719, "mean_env_wait_ms": 1.6516937920016141, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0035789012908935547, "StateBufferConnector_ms": 0.00270843505859375, "ViewRequirementAgentConnector_ms": 0.06740069389343262}}, "episode_reward_max": -25328.253683721272, "episode_reward_min": -26031.76853595171, "episode_reward_mean": -25721.05989395847, "episode_len_mean": 360.0, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-25981.49901079789, -25615.818742254272, -25774.966136668256, -25718.871942171663, -26023.329850619702, -25532.399431681537, -25598.4220706197, -26013.198021050313, -25943.011287423775, -25874.848682321674, -25722.833638907243, -25948.353042061724, -25670.38114940201, -25960.801131484717, -25859.620995068624, -25626.52642722719, -25860.885808580013, -25753.036526536976, -25771.236314150938, -25746.199955167915, -25755.06299386396, -25328.253683721272, -25585.840661300284, -25903.334880684706, -25883.117045280727, -25750.56693843077, -25524.682948370977, -26031.76853595171, -25633.986617613973, -25591.02746779801, -25793.936922431694, -25463.685355827132, -25818.945219197565, -25929.59196726394, -25527.034487603927, -25690.213584724686, -25948.808061841275, -25735.575857059477, -25531.92318411009, -25606.671334184066, -25592.0114195276, -25796.179823003586, -25887.053210004226, -25743.554373883482, -26020.766098537446, -25440.00812105769, -25673.279537836806, -25340.41497547698, -25728.947743169487, -25878.791754771355, -26025.64082279114, -25551.166362507065, -25896.858298201812, -25426.459396664668, -25507.539473986046, -25711.700010391367, -25871.72504599535, -25762.468233774387, -25970.55138974913, -25738.484817348173, -25808.222128419147, -25644.358623005388, -25578.628393425395, -25879.843296086117, -25949.419554016113, -25807.105742629763, -25819.842964566073, -25549.149932077962, -25641.233468944458, -25568.18492252227, -25805.053352658015, -25883.35886329001, -25682.835904245807, -25841.339528843495, -25579.16663414852, -25718.715107068834, -25578.875325985005, -25487.58692978545, -25414.719522974952, -25723.553788502933, -25585.66285204171, -25814.780497934556, -25728.28886222714, -25546.758528639086, -25827.759630908404, -25646.95840681918, -25603.08863441588, -25679.40343150969, -25653.952587061678, -25729.454126294324, -25820.777574148327, -25577.758394328685, -25722.621822540772, -25571.184965224078, -25749.786517622135, -25608.69988687303, -25925.974049098433, -25539.057099478276, -25596.79683226327, -25622.161893088214], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.015520954172381, "mean_inference_ms": 0.2757625307716673, "mean_action_processing_ms": 0.06578256660043719, "mean_env_wait_ms": 1.6516937920016141, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0035789012908935547, "StateBufferConnector_ms": 0.00270843505859375, "ViewRequirementAgentConnector_ms": 0.06740069389343262}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 264960, "num_agent_steps_trained": 264960, "num_env_steps_sampled": 264960, "num_env_steps_trained": 264960, "num_env_steps_sampled_this_iter": 1080, "num_env_steps_trained_this_iter": 1080, "num_env_steps_sampled_throughput_per_sec": 93.89250117664923, "num_env_steps_trained_throughput_per_sec": 93.89250117664923, "timesteps_total": 264960, "num_steps_trained_this_iter": 1080, "agent_timesteps_total": 264960, "timers": {"training_iteration_time_ms": 3793.633, "sample_time_ms": 3782.933, "load_time_ms": 0.304, "load_throughput": 1183809.831, "learn_time_ms": 9.636, "learn_throughput": 37360.745, "synch_weights_time_ms": 0.717}, "counters": {"num_env_steps_sampled": 264960, "num_env_steps_trained": 264960, "num_agent_steps_sampled": 264960, "num_agent_steps_trained": 264960}, "done": false, "episodes_total": 736, "training_iteration": 172, "trial_id": "f5e97_00000", "date": "2023-07-25_17-28-07", "timestamp": 1690295287, "time_this_iter_s": 11.50537395477295, "time_total_s": 1930.9287641048431, "pid": 71917, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[0, 0.003], [5400, 0.001], [10800, 0.00075], [16200, 0.0005], [21600, 0.00025], [27000, 0.0001], [32400, 7.5e-05], [37800, 5e-05], [43200, 2.5e-05], [48600, 1e-05], [54000, 7.5e-06], [59400, 5e-06], [64800, 2.5e-06], [70200, 1e-06], [75600, 5e-07], [81000, 1e-07]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x304530310>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1930.9287641048431, "iterations_since_restore": 172, "perf": {"cpu_util_percent": 24.03529411764706, "ram_util_percent": 77.27058823529413}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-07, "entropy_coeff": 0.1, "policy_entropy": -926.7001342773438, "policy_loss": -27016361885696.0, "vf_loss": 1076140537.6}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 3693.0, "diff_num_grad_updates_vs_sampler_policy": 3692.0}}, "num_env_steps_sampled": 266040, "num_env_steps_trained": 266040, "num_agent_steps_sampled": 266040, "num_agent_steps_trained": 266040}, "sampler_results": {"episode_reward_max": -25328.253683721272, "episode_reward_min": -26031.76853595171, "episode_reward_mean": -25716.424928337008, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-25718.871942171663, -26023.329850619702, -25532.399431681537, -25598.4220706197, -26013.198021050313, -25943.011287423775, -25874.848682321674, -25722.833638907243, -25948.353042061724, -25670.38114940201, -25960.801131484717, -25859.620995068624, -25626.52642722719, -25860.885808580013, -25753.036526536976, -25771.236314150938, -25746.199955167915, -25755.06299386396, -25328.253683721272, -25585.840661300284, -25903.334880684706, -25883.117045280727, -25750.56693843077, -25524.682948370977, -26031.76853595171, -25633.986617613973, -25591.02746779801, -25793.936922431694, -25463.685355827132, -25818.945219197565, -25929.59196726394, -25527.034487603927, -25690.213584724686, -25948.808061841275, -25735.575857059477, -25531.92318411009, -25606.671334184066, -25592.0114195276, -25796.179823003586, -25887.053210004226, -25743.554373883482, -26020.766098537446, -25440.00812105769, -25673.279537836806, -25340.41497547698, -25728.947743169487, -25878.791754771355, -26025.64082279114, -25551.166362507065, -25896.858298201812, -25426.459396664668, -25507.539473986046, -25711.700010391367, -25871.72504599535, -25762.468233774387, -25970.55138974913, -25738.484817348173, -25808.222128419147, -25644.358623005388, -25578.628393425395, -25879.843296086117, -25949.419554016113, -25807.105742629763, -25819.842964566073, -25549.149932077962, -25641.233468944458, -25568.18492252227, -25805.053352658015, -25883.35886329001, -25682.835904245807, -25841.339528843495, -25579.16663414852, -25718.715107068834, -25578.875325985005, -25487.58692978545, -25414.719522974952, -25723.553788502933, -25585.66285204171, -25814.780497934556, -25728.28886222714, -25546.758528639086, -25827.759630908404, -25646.95840681918, -25603.08863441588, -25679.40343150969, -25653.952587061678, -25729.454126294324, -25820.777574148327, -25577.758394328685, -25722.621822540772, -25571.184965224078, -25749.786517622135, -25608.69988687303, -25925.974049098433, -25539.057099478276, -25596.79683226327, -25622.161893088214, -25876.521107760094, -25507.75601831933, -25524.510201494908], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.026309934185829, "mean_inference_ms": 0.2762389784744459, "mean_action_processing_ms": 0.06590200154726146, "mean_env_wait_ms": 1.6552104178680747, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003572702407836914, "StateBufferConnector_ms": 0.0027120113372802734, "ViewRequirementAgentConnector_ms": 0.06737804412841797}}, "episode_reward_max": -25328.253683721272, "episode_reward_min": -26031.76853595171, "episode_reward_mean": -25716.424928337008, "episode_len_mean": 360.0, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-25718.871942171663, -26023.329850619702, -25532.399431681537, -25598.4220706197, -26013.198021050313, -25943.011287423775, -25874.848682321674, -25722.833638907243, -25948.353042061724, -25670.38114940201, -25960.801131484717, -25859.620995068624, -25626.52642722719, -25860.885808580013, -25753.036526536976, -25771.236314150938, -25746.199955167915, -25755.06299386396, -25328.253683721272, -25585.840661300284, -25903.334880684706, -25883.117045280727, -25750.56693843077, -25524.682948370977, -26031.76853595171, -25633.986617613973, -25591.02746779801, -25793.936922431694, -25463.685355827132, -25818.945219197565, -25929.59196726394, -25527.034487603927, -25690.213584724686, -25948.808061841275, -25735.575857059477, -25531.92318411009, -25606.671334184066, -25592.0114195276, -25796.179823003586, -25887.053210004226, -25743.554373883482, -26020.766098537446, -25440.00812105769, -25673.279537836806, -25340.41497547698, -25728.947743169487, -25878.791754771355, -26025.64082279114, -25551.166362507065, -25896.858298201812, -25426.459396664668, -25507.539473986046, -25711.700010391367, -25871.72504599535, -25762.468233774387, -25970.55138974913, -25738.484817348173, -25808.222128419147, -25644.358623005388, -25578.628393425395, -25879.843296086117, -25949.419554016113, -25807.105742629763, -25819.842964566073, -25549.149932077962, -25641.233468944458, -25568.18492252227, -25805.053352658015, -25883.35886329001, -25682.835904245807, -25841.339528843495, -25579.16663414852, -25718.715107068834, -25578.875325985005, -25487.58692978545, -25414.719522974952, -25723.553788502933, -25585.66285204171, -25814.780497934556, -25728.28886222714, -25546.758528639086, -25827.759630908404, -25646.95840681918, -25603.08863441588, -25679.40343150969, -25653.952587061678, -25729.454126294324, -25820.777574148327, -25577.758394328685, -25722.621822540772, -25571.184965224078, -25749.786517622135, -25608.69988687303, -25925.974049098433, -25539.057099478276, -25596.79683226327, -25622.161893088214, -25876.521107760094, -25507.75601831933, -25524.510201494908], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.026309934185829, "mean_inference_ms": 0.2762389784744459, "mean_action_processing_ms": 0.06590200154726146, "mean_env_wait_ms": 1.6552104178680747, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003572702407836914, "StateBufferConnector_ms": 0.0027120113372802734, "ViewRequirementAgentConnector_ms": 0.06737804412841797}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 266040, "num_agent_steps_trained": 266040, "num_env_steps_sampled": 266040, "num_env_steps_trained": 266040, "num_env_steps_sampled_this_iter": 1080, "num_env_steps_trained_this_iter": 1080, "num_env_steps_sampled_throughput_per_sec": 95.30224203612127, "num_env_steps_trained_throughput_per_sec": 95.30224203612127, "timesteps_total": 266040, "num_steps_trained_this_iter": 1080, "agent_timesteps_total": 266040, "timers": {"training_iteration_time_ms": 3781.742, "sample_time_ms": 3771.084, "load_time_ms": 0.299, "load_throughput": 1205067.39, "learn_time_ms": 9.596, "learn_throughput": 37516.788, "synch_weights_time_ms": 0.721}, "counters": {"num_env_steps_sampled": 266040, "num_env_steps_trained": 266040, "num_agent_steps_sampled": 266040, "num_agent_steps_trained": 266040}, "done": false, "episodes_total": 739, "training_iteration": 173, "trial_id": "f5e97_00000", "date": "2023-07-25_17-28-19", "timestamp": 1690295299, "time_this_iter_s": 11.335202932357788, "time_total_s": 1942.263967037201, "pid": 71917, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[0, 0.003], [5400, 0.001], [10800, 0.00075], [16200, 0.0005], [21600, 0.00025], [27000, 0.0001], [32400, 7.5e-05], [37800, 5e-05], [43200, 2.5e-05], [48600, 1e-05], [54000, 7.5e-06], [59400, 5e-06], [64800, 2.5e-06], [70200, 1e-06], [75600, 5e-07], [81000, 1e-07]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x304530310>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1942.263967037201, "iterations_since_restore": 173, "perf": {"cpu_util_percent": 24.262500000000003, "ram_util_percent": 77.07499999999999}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-07, "entropy_coeff": 0.1, "policy_entropy": -926.6999755859375, "policy_loss": -19603247813836.8, "vf_loss": 1095480390.4}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 3708.0, "diff_num_grad_updates_vs_sampler_policy": 3707.0}}, "num_env_steps_sampled": 267120, "num_env_steps_trained": 267120, "num_agent_steps_sampled": 267120, "num_agent_steps_trained": 267120}, "sampler_results": {"episode_reward_max": -25328.253683721272, "episode_reward_min": -26031.76853595171, "episode_reward_mean": -25718.16525510885, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-25598.4220706197, -26013.198021050313, -25943.011287423775, -25874.848682321674, -25722.833638907243, -25948.353042061724, -25670.38114940201, -25960.801131484717, -25859.620995068624, -25626.52642722719, -25860.885808580013, -25753.036526536976, -25771.236314150938, -25746.199955167915, -25755.06299386396, -25328.253683721272, -25585.840661300284, -25903.334880684706, -25883.117045280727, -25750.56693843077, -25524.682948370977, -26031.76853595171, -25633.986617613973, -25591.02746779801, -25793.936922431694, -25463.685355827132, -25818.945219197565, -25929.59196726394, -25527.034487603927, -25690.213584724686, -25948.808061841275, -25735.575857059477, -25531.92318411009, -25606.671334184066, -25592.0114195276, -25796.179823003586, -25887.053210004226, -25743.554373883482, -26020.766098537446, -25440.00812105769, -25673.279537836806, -25340.41497547698, -25728.947743169487, -25878.791754771355, -26025.64082279114, -25551.166362507065, -25896.858298201812, -25426.459396664668, -25507.539473986046, -25711.700010391367, -25871.72504599535, -25762.468233774387, -25970.55138974913, -25738.484817348173, -25808.222128419147, -25644.358623005388, -25578.628393425395, -25879.843296086117, -25949.419554016113, -25807.105742629763, -25819.842964566073, -25549.149932077962, -25641.233468944458, -25568.18492252227, -25805.053352658015, -25883.35886329001, -25682.835904245807, -25841.339528843495, -25579.16663414852, -25718.715107068834, -25578.875325985005, -25487.58692978545, -25414.719522974952, -25723.553788502933, -25585.66285204171, -25814.780497934556, -25728.28886222714, -25546.758528639086, -25827.759630908404, -25646.95840681918, -25603.08863441588, -25679.40343150969, -25653.952587061678, -25729.454126294324, -25820.777574148327, -25577.758394328685, -25722.621822540772, -25571.184965224078, -25749.786517622135, -25608.69988687303, -25925.974049098433, -25539.057099478276, -25596.79683226327, -25622.161893088214, -25876.521107760094, -25507.75601831933, -25524.510201494908, -25870.264431711148, -25910.29466817855, -25668.07480176664], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.0370187663762, "mean_inference_ms": 0.27671166783110246, "mean_action_processing_ms": 0.06602042607612887, "mean_env_wait_ms": 1.6586973841440527, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003554821014404297, "StateBufferConnector_ms": 0.0027017593383789062, "ViewRequirementAgentConnector_ms": 0.06705999374389648}}, "episode_reward_max": -25328.253683721272, "episode_reward_min": -26031.76853595171, "episode_reward_mean": -25718.16525510885, "episode_len_mean": 360.0, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-25598.4220706197, -26013.198021050313, -25943.011287423775, -25874.848682321674, -25722.833638907243, -25948.353042061724, -25670.38114940201, -25960.801131484717, -25859.620995068624, -25626.52642722719, -25860.885808580013, -25753.036526536976, -25771.236314150938, -25746.199955167915, -25755.06299386396, -25328.253683721272, -25585.840661300284, -25903.334880684706, -25883.117045280727, -25750.56693843077, -25524.682948370977, -26031.76853595171, -25633.986617613973, -25591.02746779801, -25793.936922431694, -25463.685355827132, -25818.945219197565, -25929.59196726394, -25527.034487603927, -25690.213584724686, -25948.808061841275, -25735.575857059477, -25531.92318411009, -25606.671334184066, -25592.0114195276, -25796.179823003586, -25887.053210004226, -25743.554373883482, -26020.766098537446, -25440.00812105769, -25673.279537836806, -25340.41497547698, -25728.947743169487, -25878.791754771355, -26025.64082279114, -25551.166362507065, -25896.858298201812, -25426.459396664668, -25507.539473986046, -25711.700010391367, -25871.72504599535, -25762.468233774387, -25970.55138974913, -25738.484817348173, -25808.222128419147, -25644.358623005388, -25578.628393425395, -25879.843296086117, -25949.419554016113, -25807.105742629763, -25819.842964566073, -25549.149932077962, -25641.233468944458, -25568.18492252227, -25805.053352658015, -25883.35886329001, -25682.835904245807, -25841.339528843495, -25579.16663414852, -25718.715107068834, -25578.875325985005, -25487.58692978545, -25414.719522974952, -25723.553788502933, -25585.66285204171, -25814.780497934556, -25728.28886222714, -25546.758528639086, -25827.759630908404, -25646.95840681918, -25603.08863441588, -25679.40343150969, -25653.952587061678, -25729.454126294324, -25820.777574148327, -25577.758394328685, -25722.621822540772, -25571.184965224078, -25749.786517622135, -25608.69988687303, -25925.974049098433, -25539.057099478276, -25596.79683226327, -25622.161893088214, -25876.521107760094, -25507.75601831933, -25524.510201494908, -25870.264431711148, -25910.29466817855, -25668.07480176664], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.0370187663762, "mean_inference_ms": 0.27671166783110246, "mean_action_processing_ms": 0.06602042607612887, "mean_env_wait_ms": 1.6586973841440527, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003554821014404297, "StateBufferConnector_ms": 0.0027017593383789062, "ViewRequirementAgentConnector_ms": 0.06705999374389648}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 267120, "num_agent_steps_trained": 267120, "num_env_steps_sampled": 267120, "num_env_steps_trained": 267120, "num_env_steps_sampled_this_iter": 1080, "num_env_steps_trained_this_iter": 1080, "num_env_steps_sampled_throughput_per_sec": 94.29321124847019, "num_env_steps_trained_throughput_per_sec": 94.29321124847019, "timesteps_total": 267120, "num_steps_trained_this_iter": 1080, "agent_timesteps_total": 267120, "timers": {"training_iteration_time_ms": 3794.15, "sample_time_ms": 3783.5, "load_time_ms": 0.308, "load_throughput": 1169143.972, "learn_time_ms": 9.587, "learn_throughput": 37551.777, "synch_weights_time_ms": 0.712}, "counters": {"num_env_steps_sampled": 267120, "num_env_steps_trained": 267120, "num_agent_steps_sampled": 267120, "num_agent_steps_trained": 267120}, "done": false, "episodes_total": 742, "training_iteration": 174, "trial_id": "f5e97_00000", "date": "2023-07-25_17-28-30", "timestamp": 1690295310, "time_this_iter_s": 11.45653486251831, "time_total_s": 1953.7205018997192, "pid": 71917, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[0, 0.003], [5400, 0.001], [10800, 0.00075], [16200, 0.0005], [21600, 0.00025], [27000, 0.0001], [32400, 7.5e-05], [37800, 5e-05], [43200, 2.5e-05], [48600, 1e-05], [54000, 7.5e-06], [59400, 5e-06], [64800, 2.5e-06], [70200, 1e-06], [75600, 5e-07], [81000, 1e-07]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x304530310>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1953.7205018997192, "iterations_since_restore": 174, "perf": {"cpu_util_percent": 23.23125, "ram_util_percent": 76.75625}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-07, "entropy_coeff": 0.1, "policy_entropy": -926.6998657226562, "policy_loss": -25690490745651.2, "vf_loss": 1102340736.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 3723.0, "diff_num_grad_updates_vs_sampler_policy": 3722.0}}, "num_env_steps_sampled": 268200, "num_env_steps_trained": 268200, "num_agent_steps_sampled": 268200, "num_agent_steps_trained": 268200}, "sampler_results": {"episode_reward_max": -25328.253683721272, "episode_reward_min": -26031.76853595171, "episode_reward_mean": -25716.500081434097, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-25874.848682321674, -25722.833638907243, -25948.353042061724, -25670.38114940201, -25960.801131484717, -25859.620995068624, -25626.52642722719, -25860.885808580013, -25753.036526536976, -25771.236314150938, -25746.199955167915, -25755.06299386396, -25328.253683721272, -25585.840661300284, -25903.334880684706, -25883.117045280727, -25750.56693843077, -25524.682948370977, -26031.76853595171, -25633.986617613973, -25591.02746779801, -25793.936922431694, -25463.685355827132, -25818.945219197565, -25929.59196726394, -25527.034487603927, -25690.213584724686, -25948.808061841275, -25735.575857059477, -25531.92318411009, -25606.671334184066, -25592.0114195276, -25796.179823003586, -25887.053210004226, -25743.554373883482, -26020.766098537446, -25440.00812105769, -25673.279537836806, -25340.41497547698, -25728.947743169487, -25878.791754771355, -26025.64082279114, -25551.166362507065, -25896.858298201812, -25426.459396664668, -25507.539473986046, -25711.700010391367, -25871.72504599535, -25762.468233774387, -25970.55138974913, -25738.484817348173, -25808.222128419147, -25644.358623005388, -25578.628393425395, -25879.843296086117, -25949.419554016113, -25807.105742629763, -25819.842964566073, -25549.149932077962, -25641.233468944458, -25568.18492252227, -25805.053352658015, -25883.35886329001, -25682.835904245807, -25841.339528843495, -25579.16663414852, -25718.715107068834, -25578.875325985005, -25487.58692978545, -25414.719522974952, -25723.553788502933, -25585.66285204171, -25814.780497934556, -25728.28886222714, -25546.758528639086, -25827.759630908404, -25646.95840681918, -25603.08863441588, -25679.40343150969, -25653.952587061678, -25729.454126294324, -25820.777574148327, -25577.758394328685, -25722.621822540772, -25571.184965224078, -25749.786517622135, -25608.69988687303, -25925.974049098433, -25539.057099478276, -25596.79683226327, -25622.161893088214, -25876.521107760094, -25507.75601831933, -25524.510201494908, -25870.264431711148, -25910.29466817855, -25668.07480176664, -25797.259392343632, -25887.599220216056, -25703.255399059504], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.047645732827378, "mean_inference_ms": 0.2771798368889543, "mean_action_processing_ms": 0.06613772899095421, "mean_env_wait_ms": 1.6621563349421495, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003560304641723633, "StateBufferConnector_ms": 0.0027053356170654297, "ViewRequirementAgentConnector_ms": 0.06708168983459473}}, "episode_reward_max": -25328.253683721272, "episode_reward_min": -26031.76853595171, "episode_reward_mean": -25716.500081434097, "episode_len_mean": 360.0, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-25874.848682321674, -25722.833638907243, -25948.353042061724, -25670.38114940201, -25960.801131484717, -25859.620995068624, -25626.52642722719, -25860.885808580013, -25753.036526536976, -25771.236314150938, -25746.199955167915, -25755.06299386396, -25328.253683721272, -25585.840661300284, -25903.334880684706, -25883.117045280727, -25750.56693843077, -25524.682948370977, -26031.76853595171, -25633.986617613973, -25591.02746779801, -25793.936922431694, -25463.685355827132, -25818.945219197565, -25929.59196726394, -25527.034487603927, -25690.213584724686, -25948.808061841275, -25735.575857059477, -25531.92318411009, -25606.671334184066, -25592.0114195276, -25796.179823003586, -25887.053210004226, -25743.554373883482, -26020.766098537446, -25440.00812105769, -25673.279537836806, -25340.41497547698, -25728.947743169487, -25878.791754771355, -26025.64082279114, -25551.166362507065, -25896.858298201812, -25426.459396664668, -25507.539473986046, -25711.700010391367, -25871.72504599535, -25762.468233774387, -25970.55138974913, -25738.484817348173, -25808.222128419147, -25644.358623005388, -25578.628393425395, -25879.843296086117, -25949.419554016113, -25807.105742629763, -25819.842964566073, -25549.149932077962, -25641.233468944458, -25568.18492252227, -25805.053352658015, -25883.35886329001, -25682.835904245807, -25841.339528843495, -25579.16663414852, -25718.715107068834, -25578.875325985005, -25487.58692978545, -25414.719522974952, -25723.553788502933, -25585.66285204171, -25814.780497934556, -25728.28886222714, -25546.758528639086, -25827.759630908404, -25646.95840681918, -25603.08863441588, -25679.40343150969, -25653.952587061678, -25729.454126294324, -25820.777574148327, -25577.758394328685, -25722.621822540772, -25571.184965224078, -25749.786517622135, -25608.69988687303, -25925.974049098433, -25539.057099478276, -25596.79683226327, -25622.161893088214, -25876.521107760094, -25507.75601831933, -25524.510201494908, -25870.264431711148, -25910.29466817855, -25668.07480176664, -25797.259392343632, -25887.599220216056, -25703.255399059504], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.047645732827378, "mean_inference_ms": 0.2771798368889543, "mean_action_processing_ms": 0.06613772899095421, "mean_env_wait_ms": 1.6621563349421495, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003560304641723633, "StateBufferConnector_ms": 0.0027053356170654297, "ViewRequirementAgentConnector_ms": 0.06708168983459473}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 268200, "num_agent_steps_trained": 268200, "num_env_steps_sampled": 268200, "num_env_steps_trained": 268200, "num_env_steps_sampled_this_iter": 1080, "num_env_steps_trained_this_iter": 1080, "num_env_steps_sampled_throughput_per_sec": 94.63849381449879, "num_env_steps_trained_throughput_per_sec": 94.63849381449879, "timesteps_total": 268200, "num_steps_trained_this_iter": 1080, "agent_timesteps_total": 268200, "timers": {"training_iteration_time_ms": 3796.793, "sample_time_ms": 3786.128, "load_time_ms": 0.309, "load_throughput": 1166344.384, "learn_time_ms": 9.607, "learn_throughput": 37473.772, "synch_weights_time_ms": 0.706}, "counters": {"num_env_steps_sampled": 268200, "num_env_steps_trained": 268200, "num_agent_steps_sampled": 268200, "num_agent_steps_trained": 268200}, "done": false, "episodes_total": 745, "training_iteration": 175, "trial_id": "f5e97_00000", "date": "2023-07-25_17-28-42", "timestamp": 1690295322, "time_this_iter_s": 11.414681911468506, "time_total_s": 1965.1351838111877, "pid": 71917, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[0, 0.003], [5400, 0.001], [10800, 0.00075], [16200, 0.0005], [21600, 0.00025], [27000, 0.0001], [32400, 7.5e-05], [37800, 5e-05], [43200, 2.5e-05], [48600, 1e-05], [54000, 7.5e-06], [59400, 5e-06], [64800, 2.5e-06], [70200, 1e-06], [75600, 5e-07], [81000, 1e-07]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x304530310>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1965.1351838111877, "iterations_since_restore": 175, "perf": {"cpu_util_percent": 24.1, "ram_util_percent": 76.93124999999999}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-07, "entropy_coeff": 0.1, "policy_entropy": -926.69990234375, "policy_loss": -27031951495987.2, "vf_loss": 1095497740.8}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 3738.0, "diff_num_grad_updates_vs_sampler_policy": 3737.0}}, "num_env_steps_sampled": 269280, "num_env_steps_trained": 269280, "num_agent_steps_sampled": 269280, "num_agent_steps_trained": 269280}, "sampler_results": {"episode_reward_max": -25328.253683721272, "episode_reward_min": -26031.76853595171, "episode_reward_mean": -25711.10805134084, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-25670.38114940201, -25960.801131484717, -25859.620995068624, -25626.52642722719, -25860.885808580013, -25753.036526536976, -25771.236314150938, -25746.199955167915, -25755.06299386396, -25328.253683721272, -25585.840661300284, -25903.334880684706, -25883.117045280727, -25750.56693843077, -25524.682948370977, -26031.76853595171, -25633.986617613973, -25591.02746779801, -25793.936922431694, -25463.685355827132, -25818.945219197565, -25929.59196726394, -25527.034487603927, -25690.213584724686, -25948.808061841275, -25735.575857059477, -25531.92318411009, -25606.671334184066, -25592.0114195276, -25796.179823003586, -25887.053210004226, -25743.554373883482, -26020.766098537446, -25440.00812105769, -25673.279537836806, -25340.41497547698, -25728.947743169487, -25878.791754771355, -26025.64082279114, -25551.166362507065, -25896.858298201812, -25426.459396664668, -25507.539473986046, -25711.700010391367, -25871.72504599535, -25762.468233774387, -25970.55138974913, -25738.484817348173, -25808.222128419147, -25644.358623005388, -25578.628393425395, -25879.843296086117, -25949.419554016113, -25807.105742629763, -25819.842964566073, -25549.149932077962, -25641.233468944458, -25568.18492252227, -25805.053352658015, -25883.35886329001, -25682.835904245807, -25841.339528843495, -25579.16663414852, -25718.715107068834, -25578.875325985005, -25487.58692978545, -25414.719522974952, -25723.553788502933, -25585.66285204171, -25814.780497934556, -25728.28886222714, -25546.758528639086, -25827.759630908404, -25646.95840681918, -25603.08863441588, -25679.40343150969, -25653.952587061678, -25729.454126294324, -25820.777574148327, -25577.758394328685, -25722.621822540772, -25571.184965224078, -25749.786517622135, -25608.69988687303, -25925.974049098433, -25539.057099478276, -25596.79683226327, -25622.161893088214, -25876.521107760094, -25507.75601831933, -25524.510201494908, -25870.264431711148, -25910.29466817855, -25668.07480176664, -25797.259392343632, -25887.599220216056, -25703.255399059504, -25677.12392159334, -25625.12973631695, -25704.57869605525], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.058175704726236, "mean_inference_ms": 0.2776440930326589, "mean_action_processing_ms": 0.06625401124860633, "mean_env_wait_ms": 1.6655921823183542, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0035631656646728516, "StateBufferConnector_ms": 0.0026886463165283203, "ViewRequirementAgentConnector_ms": 0.0671076774597168}}, "episode_reward_max": -25328.253683721272, "episode_reward_min": -26031.76853595171, "episode_reward_mean": -25711.10805134084, "episode_len_mean": 360.0, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-25670.38114940201, -25960.801131484717, -25859.620995068624, -25626.52642722719, -25860.885808580013, -25753.036526536976, -25771.236314150938, -25746.199955167915, -25755.06299386396, -25328.253683721272, -25585.840661300284, -25903.334880684706, -25883.117045280727, -25750.56693843077, -25524.682948370977, -26031.76853595171, -25633.986617613973, -25591.02746779801, -25793.936922431694, -25463.685355827132, -25818.945219197565, -25929.59196726394, -25527.034487603927, -25690.213584724686, -25948.808061841275, -25735.575857059477, -25531.92318411009, -25606.671334184066, -25592.0114195276, -25796.179823003586, -25887.053210004226, -25743.554373883482, -26020.766098537446, -25440.00812105769, -25673.279537836806, -25340.41497547698, -25728.947743169487, -25878.791754771355, -26025.64082279114, -25551.166362507065, -25896.858298201812, -25426.459396664668, -25507.539473986046, -25711.700010391367, -25871.72504599535, -25762.468233774387, -25970.55138974913, -25738.484817348173, -25808.222128419147, -25644.358623005388, -25578.628393425395, -25879.843296086117, -25949.419554016113, -25807.105742629763, -25819.842964566073, -25549.149932077962, -25641.233468944458, -25568.18492252227, -25805.053352658015, -25883.35886329001, -25682.835904245807, -25841.339528843495, -25579.16663414852, -25718.715107068834, -25578.875325985005, -25487.58692978545, -25414.719522974952, -25723.553788502933, -25585.66285204171, -25814.780497934556, -25728.28886222714, -25546.758528639086, -25827.759630908404, -25646.95840681918, -25603.08863441588, -25679.40343150969, -25653.952587061678, -25729.454126294324, -25820.777574148327, -25577.758394328685, -25722.621822540772, -25571.184965224078, -25749.786517622135, -25608.69988687303, -25925.974049098433, -25539.057099478276, -25596.79683226327, -25622.161893088214, -25876.521107760094, -25507.75601831933, -25524.510201494908, -25870.264431711148, -25910.29466817855, -25668.07480176664, -25797.259392343632, -25887.599220216056, -25703.255399059504, -25677.12392159334, -25625.12973631695, -25704.57869605525], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.058175704726236, "mean_inference_ms": 0.2776440930326589, "mean_action_processing_ms": 0.06625401124860633, "mean_env_wait_ms": 1.6655921823183542, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0035631656646728516, "StateBufferConnector_ms": 0.0026886463165283203, "ViewRequirementAgentConnector_ms": 0.0671076774597168}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 269280, "num_agent_steps_trained": 269280, "num_env_steps_sampled": 269280, "num_env_steps_trained": 269280, "num_env_steps_sampled_this_iter": 1080, "num_env_steps_trained_this_iter": 1080, "num_env_steps_sampled_throughput_per_sec": 96.02074829842569, "num_env_steps_trained_throughput_per_sec": 96.02074829842569, "timesteps_total": 269280, "num_steps_trained_this_iter": 1080, "agent_timesteps_total": 269280, "timers": {"training_iteration_time_ms": 3797.641, "sample_time_ms": 3786.969, "load_time_ms": 0.309, "load_throughput": 1163468.516, "learn_time_ms": 9.602, "learn_throughput": 37492.103, "synch_weights_time_ms": 0.716}, "counters": {"num_env_steps_sampled": 269280, "num_env_steps_trained": 269280, "num_agent_steps_sampled": 269280, "num_agent_steps_trained": 269280}, "done": false, "episodes_total": 748, "training_iteration": 176, "trial_id": "f5e97_00000", "date": "2023-07-25_17-28-53", "timestamp": 1690295333, "time_this_iter_s": 11.250317811965942, "time_total_s": 1976.3855016231537, "pid": 71917, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[0, 0.003], [5400, 0.001], [10800, 0.00075], [16200, 0.0005], [21600, 0.00025], [27000, 0.0001], [32400, 7.5e-05], [37800, 5e-05], [43200, 2.5e-05], [48600, 1e-05], [54000, 7.5e-06], [59400, 5e-06], [64800, 2.5e-06], [70200, 1e-06], [75600, 5e-07], [81000, 1e-07]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x304530310>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1976.3855016231537, "iterations_since_restore": 176, "perf": {"cpu_util_percent": 24.13125, "ram_util_percent": 77.0}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-07, "entropy_coeff": 0.1, "policy_entropy": -926.700048828125, "policy_loss": -15519824470016.0, "vf_loss": 1093070636.8}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 3753.0, "diff_num_grad_updates_vs_sampler_policy": 3752.0}}, "num_env_steps_sampled": 270360, "num_env_steps_trained": 270360, "num_agent_steps_sampled": 270360, "num_agent_steps_trained": 270360}, "sampler_results": {"episode_reward_max": -25328.253683721272, "episode_reward_min": -26031.76853595171, "episode_reward_mean": -25707.952105467004, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-25626.52642722719, -25860.885808580013, -25753.036526536976, -25771.236314150938, -25746.199955167915, -25755.06299386396, -25328.253683721272, -25585.840661300284, -25903.334880684706, -25883.117045280727, -25750.56693843077, -25524.682948370977, -26031.76853595171, -25633.986617613973, -25591.02746779801, -25793.936922431694, -25463.685355827132, -25818.945219197565, -25929.59196726394, -25527.034487603927, -25690.213584724686, -25948.808061841275, -25735.575857059477, -25531.92318411009, -25606.671334184066, -25592.0114195276, -25796.179823003586, -25887.053210004226, -25743.554373883482, -26020.766098537446, -25440.00812105769, -25673.279537836806, -25340.41497547698, -25728.947743169487, -25878.791754771355, -26025.64082279114, -25551.166362507065, -25896.858298201812, -25426.459396664668, -25507.539473986046, -25711.700010391367, -25871.72504599535, -25762.468233774387, -25970.55138974913, -25738.484817348173, -25808.222128419147, -25644.358623005388, -25578.628393425395, -25879.843296086117, -25949.419554016113, -25807.105742629763, -25819.842964566073, -25549.149932077962, -25641.233468944458, -25568.18492252227, -25805.053352658015, -25883.35886329001, -25682.835904245807, -25841.339528843495, -25579.16663414852, -25718.715107068834, -25578.875325985005, -25487.58692978545, -25414.719522974952, -25723.553788502933, -25585.66285204171, -25814.780497934556, -25728.28886222714, -25546.758528639086, -25827.759630908404, -25646.95840681918, -25603.08863441588, -25679.40343150969, -25653.952587061678, -25729.454126294324, -25820.777574148327, -25577.758394328685, -25722.621822540772, -25571.184965224078, -25749.786517622135, -25608.69988687303, -25925.974049098433, -25539.057099478276, -25596.79683226327, -25622.161893088214, -25876.521107760094, -25507.75601831933, -25524.510201494908, -25870.264431711148, -25910.29466817855, -25668.07480176664, -25797.259392343632, -25887.599220216056, -25703.255399059504, -25677.12392159334, -25625.12973631695, -25704.57869605525, -25780.019251437523, -25616.88429238699, -25778.305144746893], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.068603770868278, "mean_inference_ms": 0.2781053961727416, "mean_action_processing_ms": 0.06636942769593904, "mean_env_wait_ms": 1.6690015488833385, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003553628921508789, "StateBufferConnector_ms": 0.002691507339477539, "ViewRequirementAgentConnector_ms": 0.06698966026306152}}, "episode_reward_max": -25328.253683721272, "episode_reward_min": -26031.76853595171, "episode_reward_mean": -25707.952105467004, "episode_len_mean": 360.0, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-25626.52642722719, -25860.885808580013, -25753.036526536976, -25771.236314150938, -25746.199955167915, -25755.06299386396, -25328.253683721272, -25585.840661300284, -25903.334880684706, -25883.117045280727, -25750.56693843077, -25524.682948370977, -26031.76853595171, -25633.986617613973, -25591.02746779801, -25793.936922431694, -25463.685355827132, -25818.945219197565, -25929.59196726394, -25527.034487603927, -25690.213584724686, -25948.808061841275, -25735.575857059477, -25531.92318411009, -25606.671334184066, -25592.0114195276, -25796.179823003586, -25887.053210004226, -25743.554373883482, -26020.766098537446, -25440.00812105769, -25673.279537836806, -25340.41497547698, -25728.947743169487, -25878.791754771355, -26025.64082279114, -25551.166362507065, -25896.858298201812, -25426.459396664668, -25507.539473986046, -25711.700010391367, -25871.72504599535, -25762.468233774387, -25970.55138974913, -25738.484817348173, -25808.222128419147, -25644.358623005388, -25578.628393425395, -25879.843296086117, -25949.419554016113, -25807.105742629763, -25819.842964566073, -25549.149932077962, -25641.233468944458, -25568.18492252227, -25805.053352658015, -25883.35886329001, -25682.835904245807, -25841.339528843495, -25579.16663414852, -25718.715107068834, -25578.875325985005, -25487.58692978545, -25414.719522974952, -25723.553788502933, -25585.66285204171, -25814.780497934556, -25728.28886222714, -25546.758528639086, -25827.759630908404, -25646.95840681918, -25603.08863441588, -25679.40343150969, -25653.952587061678, -25729.454126294324, -25820.777574148327, -25577.758394328685, -25722.621822540772, -25571.184965224078, -25749.786517622135, -25608.69988687303, -25925.974049098433, -25539.057099478276, -25596.79683226327, -25622.161893088214, -25876.521107760094, -25507.75601831933, -25524.510201494908, -25870.264431711148, -25910.29466817855, -25668.07480176664, -25797.259392343632, -25887.599220216056, -25703.255399059504, -25677.12392159334, -25625.12973631695, -25704.57869605525, -25780.019251437523, -25616.88429238699, -25778.305144746893], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.068603770868278, "mean_inference_ms": 0.2781053961727416, "mean_action_processing_ms": 0.06636942769593904, "mean_env_wait_ms": 1.6690015488833385, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003553628921508789, "StateBufferConnector_ms": 0.002691507339477539, "ViewRequirementAgentConnector_ms": 0.06698966026306152}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 270360, "num_agent_steps_trained": 270360, "num_env_steps_sampled": 270360, "num_env_steps_trained": 270360, "num_env_steps_sampled_this_iter": 1080, "num_env_steps_trained_this_iter": 1080, "num_env_steps_sampled_throughput_per_sec": 96.66994437834887, "num_env_steps_trained_throughput_per_sec": 96.66994437834887, "timesteps_total": 270360, "num_steps_trained_this_iter": 1080, "agent_timesteps_total": 270360, "timers": {"training_iteration_time_ms": 3772.774, "sample_time_ms": 3762.098, "load_time_ms": 0.306, "load_throughput": 1175698.388, "learn_time_ms": 9.614, "learn_throughput": 37446.078, "synch_weights_time_ms": 0.712}, "counters": {"num_env_steps_sampled": 270360, "num_env_steps_trained": 270360, "num_agent_steps_sampled": 270360, "num_agent_steps_trained": 270360}, "done": false, "episodes_total": 751, "training_iteration": 177, "trial_id": "f5e97_00000", "date": "2023-07-25_17-29-04", "timestamp": 1690295344, "time_this_iter_s": 11.175236701965332, "time_total_s": 1987.560738325119, "pid": 71917, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[0, 0.003], [5400, 0.001], [10800, 0.00075], [16200, 0.0005], [21600, 0.00025], [27000, 0.0001], [32400, 7.5e-05], [37800, 5e-05], [43200, 2.5e-05], [48600, 1e-05], [54000, 7.5e-06], [59400, 5e-06], [64800, 2.5e-06], [70200, 1e-06], [75600, 5e-07], [81000, 1e-07]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x304530310>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1987.560738325119, "iterations_since_restore": 177, "perf": {"cpu_util_percent": 25.325000000000003, "ram_util_percent": 76.975}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-07, "entropy_coeff": 0.1, "policy_entropy": -926.7001342773438, "policy_loss": -16188169361817.6, "vf_loss": 1090793376.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 3768.0, "diff_num_grad_updates_vs_sampler_policy": 3767.0}}, "num_env_steps_sampled": 271440, "num_env_steps_trained": 271440, "num_agent_steps_sampled": 271440, "num_agent_steps_trained": 271440}, "sampler_results": {"episode_reward_max": -25328.253683721272, "episode_reward_min": -26031.76853595171, "episode_reward_mean": -25709.665921473177, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-25771.236314150938, -25746.199955167915, -25755.06299386396, -25328.253683721272, -25585.840661300284, -25903.334880684706, -25883.117045280727, -25750.56693843077, -25524.682948370977, -26031.76853595171, -25633.986617613973, -25591.02746779801, -25793.936922431694, -25463.685355827132, -25818.945219197565, -25929.59196726394, -25527.034487603927, -25690.213584724686, -25948.808061841275, -25735.575857059477, -25531.92318411009, -25606.671334184066, -25592.0114195276, -25796.179823003586, -25887.053210004226, -25743.554373883482, -26020.766098537446, -25440.00812105769, -25673.279537836806, -25340.41497547698, -25728.947743169487, -25878.791754771355, -26025.64082279114, -25551.166362507065, -25896.858298201812, -25426.459396664668, -25507.539473986046, -25711.700010391367, -25871.72504599535, -25762.468233774387, -25970.55138974913, -25738.484817348173, -25808.222128419147, -25644.358623005388, -25578.628393425395, -25879.843296086117, -25949.419554016113, -25807.105742629763, -25819.842964566073, -25549.149932077962, -25641.233468944458, -25568.18492252227, -25805.053352658015, -25883.35886329001, -25682.835904245807, -25841.339528843495, -25579.16663414852, -25718.715107068834, -25578.875325985005, -25487.58692978545, -25414.719522974952, -25723.553788502933, -25585.66285204171, -25814.780497934556, -25728.28886222714, -25546.758528639086, -25827.759630908404, -25646.95840681918, -25603.08863441588, -25679.40343150969, -25653.952587061678, -25729.454126294324, -25820.777574148327, -25577.758394328685, -25722.621822540772, -25571.184965224078, -25749.786517622135, -25608.69988687303, -25925.974049098433, -25539.057099478276, -25596.79683226327, -25622.161893088214, -25876.521107760094, -25507.75601831933, -25524.510201494908, -25870.264431711148, -25910.29466817855, -25668.07480176664, -25797.259392343632, -25887.599220216056, -25703.255399059504, -25677.12392159334, -25625.12973631695, -25704.57869605525, -25780.019251437523, -25616.88429238699, -25778.305144746893, -25973.67069342046, -25789.92903695543, -25648.23063258596], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.078946420156416, "mean_inference_ms": 0.27856292025522933, "mean_action_processing_ms": 0.06648383964894058, "mean_env_wait_ms": 1.6723680422603349, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003545522689819336, "StateBufferConnector_ms": 0.0026950836181640625, "ViewRequirementAgentConnector_ms": 0.06699037551879883}}, "episode_reward_max": -25328.253683721272, "episode_reward_min": -26031.76853595171, "episode_reward_mean": -25709.665921473177, "episode_len_mean": 360.0, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-25771.236314150938, -25746.199955167915, -25755.06299386396, -25328.253683721272, -25585.840661300284, -25903.334880684706, -25883.117045280727, -25750.56693843077, -25524.682948370977, -26031.76853595171, -25633.986617613973, -25591.02746779801, -25793.936922431694, -25463.685355827132, -25818.945219197565, -25929.59196726394, -25527.034487603927, -25690.213584724686, -25948.808061841275, -25735.575857059477, -25531.92318411009, -25606.671334184066, -25592.0114195276, -25796.179823003586, -25887.053210004226, -25743.554373883482, -26020.766098537446, -25440.00812105769, -25673.279537836806, -25340.41497547698, -25728.947743169487, -25878.791754771355, -26025.64082279114, -25551.166362507065, -25896.858298201812, -25426.459396664668, -25507.539473986046, -25711.700010391367, -25871.72504599535, -25762.468233774387, -25970.55138974913, -25738.484817348173, -25808.222128419147, -25644.358623005388, -25578.628393425395, -25879.843296086117, -25949.419554016113, -25807.105742629763, -25819.842964566073, -25549.149932077962, -25641.233468944458, -25568.18492252227, -25805.053352658015, -25883.35886329001, -25682.835904245807, -25841.339528843495, -25579.16663414852, -25718.715107068834, -25578.875325985005, -25487.58692978545, -25414.719522974952, -25723.553788502933, -25585.66285204171, -25814.780497934556, -25728.28886222714, -25546.758528639086, -25827.759630908404, -25646.95840681918, -25603.08863441588, -25679.40343150969, -25653.952587061678, -25729.454126294324, -25820.777574148327, -25577.758394328685, -25722.621822540772, -25571.184965224078, -25749.786517622135, -25608.69988687303, -25925.974049098433, -25539.057099478276, -25596.79683226327, -25622.161893088214, -25876.521107760094, -25507.75601831933, -25524.510201494908, -25870.264431711148, -25910.29466817855, -25668.07480176664, -25797.259392343632, -25887.599220216056, -25703.255399059504, -25677.12392159334, -25625.12973631695, -25704.57869605525, -25780.019251437523, -25616.88429238699, -25778.305144746893, -25973.67069342046, -25789.92903695543, -25648.23063258596], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.078946420156416, "mean_inference_ms": 0.27856292025522933, "mean_action_processing_ms": 0.06648383964894058, "mean_env_wait_ms": 1.6723680422603349, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003545522689819336, "StateBufferConnector_ms": 0.0026950836181640625, "ViewRequirementAgentConnector_ms": 0.06699037551879883}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 271440, "num_agent_steps_trained": 271440, "num_env_steps_sampled": 271440, "num_env_steps_trained": 271440, "num_env_steps_sampled_this_iter": 1080, "num_env_steps_trained_this_iter": 1080, "num_env_steps_sampled_throughput_per_sec": 96.27272898842155, "num_env_steps_trained_throughput_per_sec": 96.27272898842155, "timesteps_total": 271440, "num_steps_trained_this_iter": 1080, "agent_timesteps_total": 271440, "timers": {"training_iteration_time_ms": 3754.098, "sample_time_ms": 3743.407, "load_time_ms": 0.303, "load_throughput": 1189311.153, "learn_time_ms": 9.619, "learn_throughput": 37424.453, "synch_weights_time_ms": 0.725}, "counters": {"num_env_steps_sampled": 271440, "num_env_steps_trained": 271440, "num_agent_steps_sampled": 271440, "num_agent_steps_trained": 271440}, "done": false, "episodes_total": 754, "training_iteration": 178, "trial_id": "f5e97_00000", "date": "2023-07-25_17-29-15", "timestamp": 1690295355, "time_this_iter_s": 11.220868825912476, "time_total_s": 1998.7816071510315, "pid": 71917, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[0, 0.003], [5400, 0.001], [10800, 0.00075], [16200, 0.0005], [21600, 0.00025], [27000, 0.0001], [32400, 7.5e-05], [37800, 5e-05], [43200, 2.5e-05], [48600, 1e-05], [54000, 7.5e-06], [59400, 5e-06], [64800, 2.5e-06], [70200, 1e-06], [75600, 5e-07], [81000, 1e-07]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x304530310>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1998.7816071510315, "iterations_since_restore": 178, "perf": {"cpu_util_percent": 25.1, "ram_util_percent": 76.85000000000001}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-07, "entropy_coeff": 0.1, "policy_entropy": -926.6997802734375, "policy_loss": -14623617529446.4, "vf_loss": 1110612601.6}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 3783.0, "diff_num_grad_updates_vs_sampler_policy": 3782.0}}, "num_env_steps_sampled": 272520, "num_env_steps_trained": 272520, "num_agent_steps_sampled": 272520, "num_agent_steps_trained": 272520}, "sampler_results": {"episode_reward_max": -25328.253683721272, "episode_reward_min": -26031.76853595171, "episode_reward_mean": -25712.116030056997, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-25328.253683721272, -25585.840661300284, -25903.334880684706, -25883.117045280727, -25750.56693843077, -25524.682948370977, -26031.76853595171, -25633.986617613973, -25591.02746779801, -25793.936922431694, -25463.685355827132, -25818.945219197565, -25929.59196726394, -25527.034487603927, -25690.213584724686, -25948.808061841275, -25735.575857059477, -25531.92318411009, -25606.671334184066, -25592.0114195276, -25796.179823003586, -25887.053210004226, -25743.554373883482, -26020.766098537446, -25440.00812105769, -25673.279537836806, -25340.41497547698, -25728.947743169487, -25878.791754771355, -26025.64082279114, -25551.166362507065, -25896.858298201812, -25426.459396664668, -25507.539473986046, -25711.700010391367, -25871.72504599535, -25762.468233774387, -25970.55138974913, -25738.484817348173, -25808.222128419147, -25644.358623005388, -25578.628393425395, -25879.843296086117, -25949.419554016113, -25807.105742629763, -25819.842964566073, -25549.149932077962, -25641.233468944458, -25568.18492252227, -25805.053352658015, -25883.35886329001, -25682.835904245807, -25841.339528843495, -25579.16663414852, -25718.715107068834, -25578.875325985005, -25487.58692978545, -25414.719522974952, -25723.553788502933, -25585.66285204171, -25814.780497934556, -25728.28886222714, -25546.758528639086, -25827.759630908404, -25646.95840681918, -25603.08863441588, -25679.40343150969, -25653.952587061678, -25729.454126294324, -25820.777574148327, -25577.758394328685, -25722.621822540772, -25571.184965224078, -25749.786517622135, -25608.69988687303, -25925.974049098433, -25539.057099478276, -25596.79683226327, -25622.161893088214, -25876.521107760094, -25507.75601831933, -25524.510201494908, -25870.264431711148, -25910.29466817855, -25668.07480176664, -25797.259392343632, -25887.599220216056, -25703.255399059504, -25677.12392159334, -25625.12973631695, -25704.57869605525, -25780.019251437523, -25616.88429238699, -25778.305144746893, -25973.67069342046, -25789.92903695543, -25648.23063258596, -25695.332373001038, -25942.65228394119, -25879.525464621925], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.089212553375692, "mean_inference_ms": 0.27901642992965814, "mean_action_processing_ms": 0.06659721025791444, "mean_env_wait_ms": 1.6757014911082269, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0035398006439208984, "StateBufferConnector_ms": 0.0026941299438476562, "ViewRequirementAgentConnector_ms": 0.06693792343139648}}, "episode_reward_max": -25328.253683721272, "episode_reward_min": -26031.76853595171, "episode_reward_mean": -25712.116030056997, "episode_len_mean": 360.0, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-25328.253683721272, -25585.840661300284, -25903.334880684706, -25883.117045280727, -25750.56693843077, -25524.682948370977, -26031.76853595171, -25633.986617613973, -25591.02746779801, -25793.936922431694, -25463.685355827132, -25818.945219197565, -25929.59196726394, -25527.034487603927, -25690.213584724686, -25948.808061841275, -25735.575857059477, -25531.92318411009, -25606.671334184066, -25592.0114195276, -25796.179823003586, -25887.053210004226, -25743.554373883482, -26020.766098537446, -25440.00812105769, -25673.279537836806, -25340.41497547698, -25728.947743169487, -25878.791754771355, -26025.64082279114, -25551.166362507065, -25896.858298201812, -25426.459396664668, -25507.539473986046, -25711.700010391367, -25871.72504599535, -25762.468233774387, -25970.55138974913, -25738.484817348173, -25808.222128419147, -25644.358623005388, -25578.628393425395, -25879.843296086117, -25949.419554016113, -25807.105742629763, -25819.842964566073, -25549.149932077962, -25641.233468944458, -25568.18492252227, -25805.053352658015, -25883.35886329001, -25682.835904245807, -25841.339528843495, -25579.16663414852, -25718.715107068834, -25578.875325985005, -25487.58692978545, -25414.719522974952, -25723.553788502933, -25585.66285204171, -25814.780497934556, -25728.28886222714, -25546.758528639086, -25827.759630908404, -25646.95840681918, -25603.08863441588, -25679.40343150969, -25653.952587061678, -25729.454126294324, -25820.777574148327, -25577.758394328685, -25722.621822540772, -25571.184965224078, -25749.786517622135, -25608.69988687303, -25925.974049098433, -25539.057099478276, -25596.79683226327, -25622.161893088214, -25876.521107760094, -25507.75601831933, -25524.510201494908, -25870.264431711148, -25910.29466817855, -25668.07480176664, -25797.259392343632, -25887.599220216056, -25703.255399059504, -25677.12392159334, -25625.12973631695, -25704.57869605525, -25780.019251437523, -25616.88429238699, -25778.305144746893, -25973.67069342046, -25789.92903695543, -25648.23063258596, -25695.332373001038, -25942.65228394119, -25879.525464621925], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.089212553375692, "mean_inference_ms": 0.27901642992965814, "mean_action_processing_ms": 0.06659721025791444, "mean_env_wait_ms": 1.6757014911082269, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0035398006439208984, "StateBufferConnector_ms": 0.0026941299438476562, "ViewRequirementAgentConnector_ms": 0.06693792343139648}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 272520, "num_agent_steps_trained": 272520, "num_env_steps_sampled": 272520, "num_env_steps_trained": 272520, "num_env_steps_sampled_this_iter": 1080, "num_env_steps_trained_this_iter": 1080, "num_env_steps_sampled_throughput_per_sec": 95.0373848259909, "num_env_steps_trained_throughput_per_sec": 95.0373848259909, "timesteps_total": 272520, "num_steps_trained_this_iter": 1080, "agent_timesteps_total": 272520, "timers": {"training_iteration_time_ms": 3763.848, "sample_time_ms": 3753.207, "load_time_ms": 0.302, "load_throughput": 1193258.606, "learn_time_ms": 9.573, "learn_throughput": 37606.583, "synch_weights_time_ms": 0.723}, "counters": {"num_env_steps_sampled": 272520, "num_env_steps_trained": 272520, "num_agent_steps_sampled": 272520, "num_agent_steps_trained": 272520}, "done": false, "episodes_total": 757, "training_iteration": 179, "trial_id": "f5e97_00000", "date": "2023-07-25_17-29-27", "timestamp": 1690295367, "time_this_iter_s": 11.366788148880005, "time_total_s": 2010.1483952999115, "pid": 71917, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[0, 0.003], [5400, 0.001], [10800, 0.00075], [16200, 0.0005], [21600, 0.00025], [27000, 0.0001], [32400, 7.5e-05], [37800, 5e-05], [43200, 2.5e-05], [48600, 1e-05], [54000, 7.5e-06], [59400, 5e-06], [64800, 2.5e-06], [70200, 1e-06], [75600, 5e-07], [81000, 1e-07]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x304530310>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 2010.1483952999115, "iterations_since_restore": 179, "perf": {"cpu_util_percent": 24.29375, "ram_util_percent": 76.98124999999999}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-07, "entropy_coeff": 0.1, "policy_entropy": -926.700048828125, "policy_loss": -19193521579622.4, "vf_loss": 1091560038.4}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 3798.0, "diff_num_grad_updates_vs_sampler_policy": 3797.0}}, "num_env_steps_sampled": 273600, "num_env_steps_trained": 273600, "num_agent_steps_sampled": 273600, "num_agent_steps_trained": 273600}, "sampler_results": {"episode_reward_max": -25340.41497547698, "episode_reward_min": -26031.76853595171, "episode_reward_mean": -25715.528594148076, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-25883.117045280727, -25750.56693843077, -25524.682948370977, -26031.76853595171, -25633.986617613973, -25591.02746779801, -25793.936922431694, -25463.685355827132, -25818.945219197565, -25929.59196726394, -25527.034487603927, -25690.213584724686, -25948.808061841275, -25735.575857059477, -25531.92318411009, -25606.671334184066, -25592.0114195276, -25796.179823003586, -25887.053210004226, -25743.554373883482, -26020.766098537446, -25440.00812105769, -25673.279537836806, -25340.41497547698, -25728.947743169487, -25878.791754771355, -26025.64082279114, -25551.166362507065, -25896.858298201812, -25426.459396664668, -25507.539473986046, -25711.700010391367, -25871.72504599535, -25762.468233774387, -25970.55138974913, -25738.484817348173, -25808.222128419147, -25644.358623005388, -25578.628393425395, -25879.843296086117, -25949.419554016113, -25807.105742629763, -25819.842964566073, -25549.149932077962, -25641.233468944458, -25568.18492252227, -25805.053352658015, -25883.35886329001, -25682.835904245807, -25841.339528843495, -25579.16663414852, -25718.715107068834, -25578.875325985005, -25487.58692978545, -25414.719522974952, -25723.553788502933, -25585.66285204171, -25814.780497934556, -25728.28886222714, -25546.758528639086, -25827.759630908404, -25646.95840681918, -25603.08863441588, -25679.40343150969, -25653.952587061678, -25729.454126294324, -25820.777574148327, -25577.758394328685, -25722.621822540772, -25571.184965224078, -25749.786517622135, -25608.69988687303, -25925.974049098433, -25539.057099478276, -25596.79683226327, -25622.161893088214, -25876.521107760094, -25507.75601831933, -25524.510201494908, -25870.264431711148, -25910.29466817855, -25668.07480176664, -25797.259392343632, -25887.599220216056, -25703.255399059504, -25677.12392159334, -25625.12973631695, -25704.57869605525, -25780.019251437523, -25616.88429238699, -25778.305144746893, -25973.67069342046, -25789.92903695543, -25648.23063258596, -25695.332373001038, -25942.65228394119, -25879.525464621925, -25791.18376139029, -25682.366610749825, -25685.13526267443], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.099406427839019, "mean_inference_ms": 0.27946498509165224, "mean_action_processing_ms": 0.06670946461278691, "mean_env_wait_ms": 1.6790034586639075, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0035371780395507812, "StateBufferConnector_ms": 0.0027036666870117188, "ViewRequirementAgentConnector_ms": 0.06698346138000488}}, "episode_reward_max": -25340.41497547698, "episode_reward_min": -26031.76853595171, "episode_reward_mean": -25715.528594148076, "episode_len_mean": 360.0, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-25883.117045280727, -25750.56693843077, -25524.682948370977, -26031.76853595171, -25633.986617613973, -25591.02746779801, -25793.936922431694, -25463.685355827132, -25818.945219197565, -25929.59196726394, -25527.034487603927, -25690.213584724686, -25948.808061841275, -25735.575857059477, -25531.92318411009, -25606.671334184066, -25592.0114195276, -25796.179823003586, -25887.053210004226, -25743.554373883482, -26020.766098537446, -25440.00812105769, -25673.279537836806, -25340.41497547698, -25728.947743169487, -25878.791754771355, -26025.64082279114, -25551.166362507065, -25896.858298201812, -25426.459396664668, -25507.539473986046, -25711.700010391367, -25871.72504599535, -25762.468233774387, -25970.55138974913, -25738.484817348173, -25808.222128419147, -25644.358623005388, -25578.628393425395, -25879.843296086117, -25949.419554016113, -25807.105742629763, -25819.842964566073, -25549.149932077962, -25641.233468944458, -25568.18492252227, -25805.053352658015, -25883.35886329001, -25682.835904245807, -25841.339528843495, -25579.16663414852, -25718.715107068834, -25578.875325985005, -25487.58692978545, -25414.719522974952, -25723.553788502933, -25585.66285204171, -25814.780497934556, -25728.28886222714, -25546.758528639086, -25827.759630908404, -25646.95840681918, -25603.08863441588, -25679.40343150969, -25653.952587061678, -25729.454126294324, -25820.777574148327, -25577.758394328685, -25722.621822540772, -25571.184965224078, -25749.786517622135, -25608.69988687303, -25925.974049098433, -25539.057099478276, -25596.79683226327, -25622.161893088214, -25876.521107760094, -25507.75601831933, -25524.510201494908, -25870.264431711148, -25910.29466817855, -25668.07480176664, -25797.259392343632, -25887.599220216056, -25703.255399059504, -25677.12392159334, -25625.12973631695, -25704.57869605525, -25780.019251437523, -25616.88429238699, -25778.305144746893, -25973.67069342046, -25789.92903695543, -25648.23063258596, -25695.332373001038, -25942.65228394119, -25879.525464621925, -25791.18376139029, -25682.366610749825, -25685.13526267443], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.099406427839019, "mean_inference_ms": 0.27946498509165224, "mean_action_processing_ms": 0.06670946461278691, "mean_env_wait_ms": 1.6790034586639075, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0035371780395507812, "StateBufferConnector_ms": 0.0027036666870117188, "ViewRequirementAgentConnector_ms": 0.06698346138000488}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 273600, "num_agent_steps_trained": 273600, "num_env_steps_sampled": 273600, "num_env_steps_trained": 273600, "num_env_steps_sampled_this_iter": 1080, "num_env_steps_trained_this_iter": 1080, "num_env_steps_sampled_throughput_per_sec": 95.16033056906775, "num_env_steps_trained_throughput_per_sec": 95.16033056906775, "timesteps_total": 273600, "num_steps_trained_this_iter": 1080, "agent_timesteps_total": 273600, "timers": {"training_iteration_time_ms": 3759.124, "sample_time_ms": 3748.445, "load_time_ms": 0.299, "load_throughput": 1204298.485, "learn_time_ms": 9.615, "learn_throughput": 37441.157, "synch_weights_time_ms": 0.722}, "counters": {"num_env_steps_sampled": 273600, "num_env_steps_trained": 273600, "num_agent_steps_sampled": 273600, "num_agent_steps_trained": 273600}, "done": false, "episodes_total": 760, "training_iteration": 180, "trial_id": "f5e97_00000", "date": "2023-07-25_17-29-38", "timestamp": 1690295378, "time_this_iter_s": 11.352144956588745, "time_total_s": 2021.5005402565002, "pid": 71917, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[0, 0.003], [5400, 0.001], [10800, 0.00075], [16200, 0.0005], [21600, 0.00025], [27000, 0.0001], [32400, 7.5e-05], [37800, 5e-05], [43200, 2.5e-05], [48600, 1e-05], [54000, 7.5e-06], [59400, 5e-06], [64800, 2.5e-06], [70200, 1e-06], [75600, 5e-07], [81000, 1e-07]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x304530310>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 2021.5005402565002, "iterations_since_restore": 180, "perf": {"cpu_util_percent": 24.237499999999997, "ram_util_percent": 76.81875}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-07, "entropy_coeff": 0.1, "policy_entropy": -926.7000732421875, "policy_loss": -25963663972761.6, "vf_loss": 1082466547.2}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 3813.0, "diff_num_grad_updates_vs_sampler_policy": 3812.0}}, "num_env_steps_sampled": 274680, "num_env_steps_trained": 274680, "num_agent_steps_sampled": 274680, "num_agent_steps_trained": 274680}, "sampler_results": {"episode_reward_max": -25340.41497547698, "episode_reward_min": -26031.76853595171, "episode_reward_mean": -25716.888546391867, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-26031.76853595171, -25633.986617613973, -25591.02746779801, -25793.936922431694, -25463.685355827132, -25818.945219197565, -25929.59196726394, -25527.034487603927, -25690.213584724686, -25948.808061841275, -25735.575857059477, -25531.92318411009, -25606.671334184066, -25592.0114195276, -25796.179823003586, -25887.053210004226, -25743.554373883482, -26020.766098537446, -25440.00812105769, -25673.279537836806, -25340.41497547698, -25728.947743169487, -25878.791754771355, -26025.64082279114, -25551.166362507065, -25896.858298201812, -25426.459396664668, -25507.539473986046, -25711.700010391367, -25871.72504599535, -25762.468233774387, -25970.55138974913, -25738.484817348173, -25808.222128419147, -25644.358623005388, -25578.628393425395, -25879.843296086117, -25949.419554016113, -25807.105742629763, -25819.842964566073, -25549.149932077962, -25641.233468944458, -25568.18492252227, -25805.053352658015, -25883.35886329001, -25682.835904245807, -25841.339528843495, -25579.16663414852, -25718.715107068834, -25578.875325985005, -25487.58692978545, -25414.719522974952, -25723.553788502933, -25585.66285204171, -25814.780497934556, -25728.28886222714, -25546.758528639086, -25827.759630908404, -25646.95840681918, -25603.08863441588, -25679.40343150969, -25653.952587061678, -25729.454126294324, -25820.777574148327, -25577.758394328685, -25722.621822540772, -25571.184965224078, -25749.786517622135, -25608.69988687303, -25925.974049098433, -25539.057099478276, -25596.79683226327, -25622.161893088214, -25876.521107760094, -25507.75601831933, -25524.510201494908, -25870.264431711148, -25910.29466817855, -25668.07480176664, -25797.259392343632, -25887.599220216056, -25703.255399059504, -25677.12392159334, -25625.12973631695, -25704.57869605525, -25780.019251437523, -25616.88429238699, -25778.305144746893, -25973.67069342046, -25789.92903695543, -25648.23063258596, -25695.332373001038, -25942.65228394119, -25879.525464621925, -25791.18376139029, -25682.366610749825, -25685.13526267443, -25882.94915352667, -25819.908971322835, -25591.504031611414], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.10950099976241, "mean_inference_ms": 0.27990923570535425, "mean_action_processing_ms": 0.06682071244004002, "mean_env_wait_ms": 1.682282057793194, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0035309791564941406, "StateBufferConnector_ms": 0.0026922225952148438, "ViewRequirementAgentConnector_ms": 0.06696534156799316}}, "episode_reward_max": -25340.41497547698, "episode_reward_min": -26031.76853595171, "episode_reward_mean": -25716.888546391867, "episode_len_mean": 360.0, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-26031.76853595171, -25633.986617613973, -25591.02746779801, -25793.936922431694, -25463.685355827132, -25818.945219197565, -25929.59196726394, -25527.034487603927, -25690.213584724686, -25948.808061841275, -25735.575857059477, -25531.92318411009, -25606.671334184066, -25592.0114195276, -25796.179823003586, -25887.053210004226, -25743.554373883482, -26020.766098537446, -25440.00812105769, -25673.279537836806, -25340.41497547698, -25728.947743169487, -25878.791754771355, -26025.64082279114, -25551.166362507065, -25896.858298201812, -25426.459396664668, -25507.539473986046, -25711.700010391367, -25871.72504599535, -25762.468233774387, -25970.55138974913, -25738.484817348173, -25808.222128419147, -25644.358623005388, -25578.628393425395, -25879.843296086117, -25949.419554016113, -25807.105742629763, -25819.842964566073, -25549.149932077962, -25641.233468944458, -25568.18492252227, -25805.053352658015, -25883.35886329001, -25682.835904245807, -25841.339528843495, -25579.16663414852, -25718.715107068834, -25578.875325985005, -25487.58692978545, -25414.719522974952, -25723.553788502933, -25585.66285204171, -25814.780497934556, -25728.28886222714, -25546.758528639086, -25827.759630908404, -25646.95840681918, -25603.08863441588, -25679.40343150969, -25653.952587061678, -25729.454126294324, -25820.777574148327, -25577.758394328685, -25722.621822540772, -25571.184965224078, -25749.786517622135, -25608.69988687303, -25925.974049098433, -25539.057099478276, -25596.79683226327, -25622.161893088214, -25876.521107760094, -25507.75601831933, -25524.510201494908, -25870.264431711148, -25910.29466817855, -25668.07480176664, -25797.259392343632, -25887.599220216056, -25703.255399059504, -25677.12392159334, -25625.12973631695, -25704.57869605525, -25780.019251437523, -25616.88429238699, -25778.305144746893, -25973.67069342046, -25789.92903695543, -25648.23063258596, -25695.332373001038, -25942.65228394119, -25879.525464621925, -25791.18376139029, -25682.366610749825, -25685.13526267443, -25882.94915352667, -25819.908971322835, -25591.504031611414], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.10950099976241, "mean_inference_ms": 0.27990923570535425, "mean_action_processing_ms": 0.06682071244004002, "mean_env_wait_ms": 1.682282057793194, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0035309791564941406, "StateBufferConnector_ms": 0.0026922225952148438, "ViewRequirementAgentConnector_ms": 0.06696534156799316}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 274680, "num_agent_steps_trained": 274680, "num_env_steps_sampled": 274680, "num_env_steps_trained": 274680, "num_env_steps_sampled_this_iter": 1080, "num_env_steps_trained_this_iter": 1080, "num_env_steps_sampled_throughput_per_sec": 96.35953648872811, "num_env_steps_trained_throughput_per_sec": 96.35953648872811, "timesteps_total": 274680, "num_steps_trained_this_iter": 1080, "agent_timesteps_total": 274680, "timers": {"training_iteration_time_ms": 3754.975, "sample_time_ms": 3744.331, "load_time_ms": 0.299, "load_throughput": 1204778.936, "learn_time_ms": 9.577, "learn_throughput": 37591.603, "synch_weights_time_ms": 0.725}, "counters": {"num_env_steps_sampled": 274680, "num_env_steps_trained": 274680, "num_agent_steps_sampled": 274680, "num_agent_steps_trained": 274680}, "done": false, "episodes_total": 763, "training_iteration": 181, "trial_id": "f5e97_00000", "date": "2023-07-25_17-29-49", "timestamp": 1690295389, "time_this_iter_s": 11.210876941680908, "time_total_s": 2032.7114171981812, "pid": 71917, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[0, 0.003], [5400, 0.001], [10800, 0.00075], [16200, 0.0005], [21600, 0.00025], [27000, 0.0001], [32400, 7.5e-05], [37800, 5e-05], [43200, 2.5e-05], [48600, 1e-05], [54000, 7.5e-06], [59400, 5e-06], [64800, 2.5e-06], [70200, 1e-06], [75600, 5e-07], [81000, 1e-07]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x304530310>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 2032.7114171981812, "iterations_since_restore": 181, "perf": {"cpu_util_percent": 26.09375, "ram_util_percent": 77.06875}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-07, "entropy_coeff": 0.1, "policy_entropy": -926.6999633789062, "policy_loss": -26535150669004.8, "vf_loss": 1104188108.8}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 3828.0, "diff_num_grad_updates_vs_sampler_policy": 3827.0}}, "num_env_steps_sampled": 275760, "num_env_steps_trained": 275760, "num_agent_steps_sampled": 275760, "num_agent_steps_trained": 275760}, "sampler_results": {"episode_reward_max": -25340.41497547698, "episode_reward_min": -26025.64082279114, "episode_reward_mean": -25720.287160432086, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-25793.936922431694, -25463.685355827132, -25818.945219197565, -25929.59196726394, -25527.034487603927, -25690.213584724686, -25948.808061841275, -25735.575857059477, -25531.92318411009, -25606.671334184066, -25592.0114195276, -25796.179823003586, -25887.053210004226, -25743.554373883482, -26020.766098537446, -25440.00812105769, -25673.279537836806, -25340.41497547698, -25728.947743169487, -25878.791754771355, -26025.64082279114, -25551.166362507065, -25896.858298201812, -25426.459396664668, -25507.539473986046, -25711.700010391367, -25871.72504599535, -25762.468233774387, -25970.55138974913, -25738.484817348173, -25808.222128419147, -25644.358623005388, -25578.628393425395, -25879.843296086117, -25949.419554016113, -25807.105742629763, -25819.842964566073, -25549.149932077962, -25641.233468944458, -25568.18492252227, -25805.053352658015, -25883.35886329001, -25682.835904245807, -25841.339528843495, -25579.16663414852, -25718.715107068834, -25578.875325985005, -25487.58692978545, -25414.719522974952, -25723.553788502933, -25585.66285204171, -25814.780497934556, -25728.28886222714, -25546.758528639086, -25827.759630908404, -25646.95840681918, -25603.08863441588, -25679.40343150969, -25653.952587061678, -25729.454126294324, -25820.777574148327, -25577.758394328685, -25722.621822540772, -25571.184965224078, -25749.786517622135, -25608.69988687303, -25925.974049098433, -25539.057099478276, -25596.79683226327, -25622.161893088214, -25876.521107760094, -25507.75601831933, -25524.510201494908, -25870.264431711148, -25910.29466817855, -25668.07480176664, -25797.259392343632, -25887.599220216056, -25703.255399059504, -25677.12392159334, -25625.12973631695, -25704.57869605525, -25780.019251437523, -25616.88429238699, -25778.305144746893, -25973.67069342046, -25789.92903695543, -25648.23063258596, -25695.332373001038, -25942.65228394119, -25879.525464621925, -25791.18376139029, -25682.366610749825, -25685.13526267443, -25882.94915352667, -25819.908971322835, -25591.504031611414, -25858.368016171105, -25982.257781431064, -25756.018227783792], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.1195102093151394, "mean_inference_ms": 0.2803503713490291, "mean_action_processing_ms": 0.06693109433918669, "mean_env_wait_ms": 1.6855337758125088, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003531217575073242, "StateBufferConnector_ms": 0.002691507339477539, "ViewRequirementAgentConnector_ms": 0.06699013710021973}}, "episode_reward_max": -25340.41497547698, "episode_reward_min": -26025.64082279114, "episode_reward_mean": -25720.287160432086, "episode_len_mean": 360.0, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-25793.936922431694, -25463.685355827132, -25818.945219197565, -25929.59196726394, -25527.034487603927, -25690.213584724686, -25948.808061841275, -25735.575857059477, -25531.92318411009, -25606.671334184066, -25592.0114195276, -25796.179823003586, -25887.053210004226, -25743.554373883482, -26020.766098537446, -25440.00812105769, -25673.279537836806, -25340.41497547698, -25728.947743169487, -25878.791754771355, -26025.64082279114, -25551.166362507065, -25896.858298201812, -25426.459396664668, -25507.539473986046, -25711.700010391367, -25871.72504599535, -25762.468233774387, -25970.55138974913, -25738.484817348173, -25808.222128419147, -25644.358623005388, -25578.628393425395, -25879.843296086117, -25949.419554016113, -25807.105742629763, -25819.842964566073, -25549.149932077962, -25641.233468944458, -25568.18492252227, -25805.053352658015, -25883.35886329001, -25682.835904245807, -25841.339528843495, -25579.16663414852, -25718.715107068834, -25578.875325985005, -25487.58692978545, -25414.719522974952, -25723.553788502933, -25585.66285204171, -25814.780497934556, -25728.28886222714, -25546.758528639086, -25827.759630908404, -25646.95840681918, -25603.08863441588, -25679.40343150969, -25653.952587061678, -25729.454126294324, -25820.777574148327, -25577.758394328685, -25722.621822540772, -25571.184965224078, -25749.786517622135, -25608.69988687303, -25925.974049098433, -25539.057099478276, -25596.79683226327, -25622.161893088214, -25876.521107760094, -25507.75601831933, -25524.510201494908, -25870.264431711148, -25910.29466817855, -25668.07480176664, -25797.259392343632, -25887.599220216056, -25703.255399059504, -25677.12392159334, -25625.12973631695, -25704.57869605525, -25780.019251437523, -25616.88429238699, -25778.305144746893, -25973.67069342046, -25789.92903695543, -25648.23063258596, -25695.332373001038, -25942.65228394119, -25879.525464621925, -25791.18376139029, -25682.366610749825, -25685.13526267443, -25882.94915352667, -25819.908971322835, -25591.504031611414, -25858.368016171105, -25982.257781431064, -25756.018227783792], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.1195102093151394, "mean_inference_ms": 0.2803503713490291, "mean_action_processing_ms": 0.06693109433918669, "mean_env_wait_ms": 1.6855337758125088, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003531217575073242, "StateBufferConnector_ms": 0.002691507339477539, "ViewRequirementAgentConnector_ms": 0.06699013710021973}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 275760, "num_agent_steps_trained": 275760, "num_env_steps_sampled": 275760, "num_env_steps_trained": 275760, "num_env_steps_sampled_this_iter": 1080, "num_env_steps_trained_this_iter": 1080, "num_env_steps_sampled_throughput_per_sec": 95.2885716442175, "num_env_steps_trained_throughput_per_sec": 95.2885716442175, "timesteps_total": 275760, "num_steps_trained_this_iter": 1080, "agent_timesteps_total": 275760, "timers": {"training_iteration_time_ms": 3747.923, "sample_time_ms": 3737.255, "load_time_ms": 0.299, "load_throughput": 1205163.573, "learn_time_ms": 9.623, "learn_throughput": 37411.472, "synch_weights_time_ms": 0.703}, "counters": {"num_env_steps_sampled": 275760, "num_env_steps_trained": 275760, "num_agent_steps_sampled": 275760, "num_agent_steps_trained": 275760}, "done": false, "episodes_total": 766, "training_iteration": 182, "trial_id": "f5e97_00000", "date": "2023-07-25_17-30-01", "timestamp": 1690295401, "time_this_iter_s": 11.336719989776611, "time_total_s": 2044.0481371879578, "pid": 71917, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[0, 0.003], [5400, 0.001], [10800, 0.00075], [16200, 0.0005], [21600, 0.00025], [27000, 0.0001], [32400, 7.5e-05], [37800, 5e-05], [43200, 2.5e-05], [48600, 1e-05], [54000, 7.5e-06], [59400, 5e-06], [64800, 2.5e-06], [70200, 1e-06], [75600, 5e-07], [81000, 1e-07]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x304530310>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 2044.0481371879578, "iterations_since_restore": 182, "perf": {"cpu_util_percent": 23.45625, "ram_util_percent": 76.95625}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-07, "entropy_coeff": 0.1, "policy_entropy": -926.7000122070312, "policy_loss": -14351302882508.8, "vf_loss": 1091356652.8}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 3843.0, "diff_num_grad_updates_vs_sampler_policy": 3842.0}}, "num_env_steps_sampled": 276840, "num_env_steps_trained": 276840, "num_agent_steps_sampled": 276840, "num_agent_steps_trained": 276840}, "sampler_results": {"episode_reward_max": -25340.41497547698, "episode_reward_min": -26087.989014943934, "episode_reward_mean": -25723.286821388538, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-25929.59196726394, -25527.034487603927, -25690.213584724686, -25948.808061841275, -25735.575857059477, -25531.92318411009, -25606.671334184066, -25592.0114195276, -25796.179823003586, -25887.053210004226, -25743.554373883482, -26020.766098537446, -25440.00812105769, -25673.279537836806, -25340.41497547698, -25728.947743169487, -25878.791754771355, -26025.64082279114, -25551.166362507065, -25896.858298201812, -25426.459396664668, -25507.539473986046, -25711.700010391367, -25871.72504599535, -25762.468233774387, -25970.55138974913, -25738.484817348173, -25808.222128419147, -25644.358623005388, -25578.628393425395, -25879.843296086117, -25949.419554016113, -25807.105742629763, -25819.842964566073, -25549.149932077962, -25641.233468944458, -25568.18492252227, -25805.053352658015, -25883.35886329001, -25682.835904245807, -25841.339528843495, -25579.16663414852, -25718.715107068834, -25578.875325985005, -25487.58692978545, -25414.719522974952, -25723.553788502933, -25585.66285204171, -25814.780497934556, -25728.28886222714, -25546.758528639086, -25827.759630908404, -25646.95840681918, -25603.08863441588, -25679.40343150969, -25653.952587061678, -25729.454126294324, -25820.777574148327, -25577.758394328685, -25722.621822540772, -25571.184965224078, -25749.786517622135, -25608.69988687303, -25925.974049098433, -25539.057099478276, -25596.79683226327, -25622.161893088214, -25876.521107760094, -25507.75601831933, -25524.510201494908, -25870.264431711148, -25910.29466817855, -25668.07480176664, -25797.259392343632, -25887.599220216056, -25703.255399059504, -25677.12392159334, -25625.12973631695, -25704.57869605525, -25780.019251437523, -25616.88429238699, -25778.305144746893, -25973.67069342046, -25789.92903695543, -25648.23063258596, -25695.332373001038, -25942.65228394119, -25879.525464621925, -25791.18376139029, -25682.366610749825, -25685.13526267443, -25882.94915352667, -25819.908971322835, -25591.504031611414, -25858.368016171105, -25982.257781431064, -25756.018227783792, -26087.989014943934, -25616.646028094816, -25671.89855006249], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.129454050190588, "mean_inference_ms": 0.28078708586633727, "mean_action_processing_ms": 0.06704041438648731, "mean_env_wait_ms": 1.6887451124663087, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003538846969604492, "StateBufferConnector_ms": 0.002692699432373047, "ViewRequirementAgentConnector_ms": 0.0670008659362793}}, "episode_reward_max": -25340.41497547698, "episode_reward_min": -26087.989014943934, "episode_reward_mean": -25723.286821388538, "episode_len_mean": 360.0, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-25929.59196726394, -25527.034487603927, -25690.213584724686, -25948.808061841275, -25735.575857059477, -25531.92318411009, -25606.671334184066, -25592.0114195276, -25796.179823003586, -25887.053210004226, -25743.554373883482, -26020.766098537446, -25440.00812105769, -25673.279537836806, -25340.41497547698, -25728.947743169487, -25878.791754771355, -26025.64082279114, -25551.166362507065, -25896.858298201812, -25426.459396664668, -25507.539473986046, -25711.700010391367, -25871.72504599535, -25762.468233774387, -25970.55138974913, -25738.484817348173, -25808.222128419147, -25644.358623005388, -25578.628393425395, -25879.843296086117, -25949.419554016113, -25807.105742629763, -25819.842964566073, -25549.149932077962, -25641.233468944458, -25568.18492252227, -25805.053352658015, -25883.35886329001, -25682.835904245807, -25841.339528843495, -25579.16663414852, -25718.715107068834, -25578.875325985005, -25487.58692978545, -25414.719522974952, -25723.553788502933, -25585.66285204171, -25814.780497934556, -25728.28886222714, -25546.758528639086, -25827.759630908404, -25646.95840681918, -25603.08863441588, -25679.40343150969, -25653.952587061678, -25729.454126294324, -25820.777574148327, -25577.758394328685, -25722.621822540772, -25571.184965224078, -25749.786517622135, -25608.69988687303, -25925.974049098433, -25539.057099478276, -25596.79683226327, -25622.161893088214, -25876.521107760094, -25507.75601831933, -25524.510201494908, -25870.264431711148, -25910.29466817855, -25668.07480176664, -25797.259392343632, -25887.599220216056, -25703.255399059504, -25677.12392159334, -25625.12973631695, -25704.57869605525, -25780.019251437523, -25616.88429238699, -25778.305144746893, -25973.67069342046, -25789.92903695543, -25648.23063258596, -25695.332373001038, -25942.65228394119, -25879.525464621925, -25791.18376139029, -25682.366610749825, -25685.13526267443, -25882.94915352667, -25819.908971322835, -25591.504031611414, -25858.368016171105, -25982.257781431064, -25756.018227783792, -26087.989014943934, -25616.646028094816, -25671.89855006249], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.129454050190588, "mean_inference_ms": 0.28078708586633727, "mean_action_processing_ms": 0.06704041438648731, "mean_env_wait_ms": 1.6887451124663087, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003538846969604492, "StateBufferConnector_ms": 0.002692699432373047, "ViewRequirementAgentConnector_ms": 0.0670008659362793}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 276840, "num_agent_steps_trained": 276840, "num_env_steps_sampled": 276840, "num_env_steps_trained": 276840, "num_env_steps_sampled_this_iter": 1080, "num_env_steps_trained_this_iter": 1080, "num_env_steps_sampled_throughput_per_sec": 95.32196967624544, "num_env_steps_trained_throughput_per_sec": 95.32196967624544, "timesteps_total": 276840, "num_steps_trained_this_iter": 1080, "agent_timesteps_total": 276840, "timers": {"training_iteration_time_ms": 3767.965, "sample_time_ms": 3757.309, "load_time_ms": 0.299, "load_throughput": 1204010.398, "learn_time_ms": 9.614, "learn_throughput": 37447.1, "synch_weights_time_ms": 0.7}, "counters": {"num_env_steps_sampled": 276840, "num_env_steps_trained": 276840, "num_agent_steps_sampled": 276840, "num_agent_steps_trained": 276840}, "done": false, "episodes_total": 769, "training_iteration": 183, "trial_id": "f5e97_00000", "date": "2023-07-25_17-30-12", "timestamp": 1690295412, "time_this_iter_s": 11.332819938659668, "time_total_s": 2055.3809571266174, "pid": 71917, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[0, 0.003], [5400, 0.001], [10800, 0.00075], [16200, 0.0005], [21600, 0.00025], [27000, 0.0001], [32400, 7.5e-05], [37800, 5e-05], [43200, 2.5e-05], [48600, 1e-05], [54000, 7.5e-06], [59400, 5e-06], [64800, 2.5e-06], [70200, 1e-06], [75600, 5e-07], [81000, 1e-07]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x304530310>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 2055.3809571266174, "iterations_since_restore": 183, "perf": {"cpu_util_percent": 23.962500000000002, "ram_util_percent": 77.11875}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-07, "entropy_coeff": 0.1, "policy_entropy": -926.6999267578125, "policy_loss": -31815719164313.6, "vf_loss": 1088635686.4}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 3858.0, "diff_num_grad_updates_vs_sampler_policy": 3857.0}}, "num_env_steps_sampled": 277920, "num_env_steps_trained": 277920, "num_agent_steps_sampled": 277920, "num_agent_steps_trained": 277920}, "sampler_results": {"episode_reward_max": -25340.41497547698, "episode_reward_min": -26087.989014943934, "episode_reward_mean": -25720.01913810859, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-25948.808061841275, -25735.575857059477, -25531.92318411009, -25606.671334184066, -25592.0114195276, -25796.179823003586, -25887.053210004226, -25743.554373883482, -26020.766098537446, -25440.00812105769, -25673.279537836806, -25340.41497547698, -25728.947743169487, -25878.791754771355, -26025.64082279114, -25551.166362507065, -25896.858298201812, -25426.459396664668, -25507.539473986046, -25711.700010391367, -25871.72504599535, -25762.468233774387, -25970.55138974913, -25738.484817348173, -25808.222128419147, -25644.358623005388, -25578.628393425395, -25879.843296086117, -25949.419554016113, -25807.105742629763, -25819.842964566073, -25549.149932077962, -25641.233468944458, -25568.18492252227, -25805.053352658015, -25883.35886329001, -25682.835904245807, -25841.339528843495, -25579.16663414852, -25718.715107068834, -25578.875325985005, -25487.58692978545, -25414.719522974952, -25723.553788502933, -25585.66285204171, -25814.780497934556, -25728.28886222714, -25546.758528639086, -25827.759630908404, -25646.95840681918, -25603.08863441588, -25679.40343150969, -25653.952587061678, -25729.454126294324, -25820.777574148327, -25577.758394328685, -25722.621822540772, -25571.184965224078, -25749.786517622135, -25608.69988687303, -25925.974049098433, -25539.057099478276, -25596.79683226327, -25622.161893088214, -25876.521107760094, -25507.75601831933, -25524.510201494908, -25870.264431711148, -25910.29466817855, -25668.07480176664, -25797.259392343632, -25887.599220216056, -25703.255399059504, -25677.12392159334, -25625.12973631695, -25704.57869605525, -25780.019251437523, -25616.88429238699, -25778.305144746893, -25973.67069342046, -25789.92903695543, -25648.23063258596, -25695.332373001038, -25942.65228394119, -25879.525464621925, -25791.18376139029, -25682.366610749825, -25685.13526267443, -25882.94915352667, -25819.908971322835, -25591.504031611414, -25858.368016171105, -25982.257781431064, -25756.018227783792, -26087.989014943934, -25616.646028094816, -25671.89855006249, -25574.665229375463, -25563.20354253552, -25682.20293968738], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.139320483642681, "mean_inference_ms": 0.2812213509437409, "mean_action_processing_ms": 0.06714898831903811, "mean_env_wait_ms": 1.691931634035828, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003522157669067383, "StateBufferConnector_ms": 0.002685546875, "ViewRequirementAgentConnector_ms": 0.06671595573425293}}, "episode_reward_max": -25340.41497547698, "episode_reward_min": -26087.989014943934, "episode_reward_mean": -25720.01913810859, "episode_len_mean": 360.0, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-25948.808061841275, -25735.575857059477, -25531.92318411009, -25606.671334184066, -25592.0114195276, -25796.179823003586, -25887.053210004226, -25743.554373883482, -26020.766098537446, -25440.00812105769, -25673.279537836806, -25340.41497547698, -25728.947743169487, -25878.791754771355, -26025.64082279114, -25551.166362507065, -25896.858298201812, -25426.459396664668, -25507.539473986046, -25711.700010391367, -25871.72504599535, -25762.468233774387, -25970.55138974913, -25738.484817348173, -25808.222128419147, -25644.358623005388, -25578.628393425395, -25879.843296086117, -25949.419554016113, -25807.105742629763, -25819.842964566073, -25549.149932077962, -25641.233468944458, -25568.18492252227, -25805.053352658015, -25883.35886329001, -25682.835904245807, -25841.339528843495, -25579.16663414852, -25718.715107068834, -25578.875325985005, -25487.58692978545, -25414.719522974952, -25723.553788502933, -25585.66285204171, -25814.780497934556, -25728.28886222714, -25546.758528639086, -25827.759630908404, -25646.95840681918, -25603.08863441588, -25679.40343150969, -25653.952587061678, -25729.454126294324, -25820.777574148327, -25577.758394328685, -25722.621822540772, -25571.184965224078, -25749.786517622135, -25608.69988687303, -25925.974049098433, -25539.057099478276, -25596.79683226327, -25622.161893088214, -25876.521107760094, -25507.75601831933, -25524.510201494908, -25870.264431711148, -25910.29466817855, -25668.07480176664, -25797.259392343632, -25887.599220216056, -25703.255399059504, -25677.12392159334, -25625.12973631695, -25704.57869605525, -25780.019251437523, -25616.88429238699, -25778.305144746893, -25973.67069342046, -25789.92903695543, -25648.23063258596, -25695.332373001038, -25942.65228394119, -25879.525464621925, -25791.18376139029, -25682.366610749825, -25685.13526267443, -25882.94915352667, -25819.908971322835, -25591.504031611414, -25858.368016171105, -25982.257781431064, -25756.018227783792, -26087.989014943934, -25616.646028094816, -25671.89855006249, -25574.665229375463, -25563.20354253552, -25682.20293968738], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.139320483642681, "mean_inference_ms": 0.2812213509437409, "mean_action_processing_ms": 0.06714898831903811, "mean_env_wait_ms": 1.691931634035828, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003522157669067383, "StateBufferConnector_ms": 0.002685546875, "ViewRequirementAgentConnector_ms": 0.06671595573425293}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 277920, "num_agent_steps_trained": 277920, "num_env_steps_sampled": 277920, "num_env_steps_trained": 277920, "num_env_steps_sampled_this_iter": 1080, "num_env_steps_trained_this_iter": 1080, "num_env_steps_sampled_throughput_per_sec": 95.2059392336258, "num_env_steps_trained_throughput_per_sec": 95.2059392336258, "timesteps_total": 277920, "num_steps_trained_this_iter": 1080, "agent_timesteps_total": 277920, "timers": {"training_iteration_time_ms": 3786.333, "sample_time_ms": 3775.657, "load_time_ms": 0.297, "load_throughput": 1213980.897, "learn_time_ms": 9.634, "learn_throughput": 37367.124, "synch_weights_time_ms": 0.703}, "counters": {"num_env_steps_sampled": 277920, "num_env_steps_trained": 277920, "num_agent_steps_sampled": 277920, "num_agent_steps_trained": 277920}, "done": false, "episodes_total": 772, "training_iteration": 184, "trial_id": "f5e97_00000", "date": "2023-07-25_17-30-23", "timestamp": 1690295423, "time_this_iter_s": 11.346654176712036, "time_total_s": 2066.7276113033295, "pid": 71917, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[0, 0.003], [5400, 0.001], [10800, 0.00075], [16200, 0.0005], [21600, 0.00025], [27000, 0.0001], [32400, 7.5e-05], [37800, 5e-05], [43200, 2.5e-05], [48600, 1e-05], [54000, 7.5e-06], [59400, 5e-06], [64800, 2.5e-06], [70200, 1e-06], [75600, 5e-07], [81000, 1e-07]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x304530310>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 2066.7276113033295, "iterations_since_restore": 184, "perf": {"cpu_util_percent": 25.856250000000003, "ram_util_percent": 76.9125}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-07, "entropy_coeff": 0.1, "policy_entropy": -926.7, "policy_loss": -9837623682662.4, "vf_loss": 1100138374.4}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 3873.0, "diff_num_grad_updates_vs_sampler_policy": 3872.0}}, "num_env_steps_sampled": 279000, "num_env_steps_trained": 279000, "num_agent_steps_sampled": 279000, "num_agent_steps_trained": 279000}, "sampler_results": {"episode_reward_max": -25340.41497547698, "episode_reward_min": -26087.989014943934, "episode_reward_mean": -25722.112988574143, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-25606.671334184066, -25592.0114195276, -25796.179823003586, -25887.053210004226, -25743.554373883482, -26020.766098537446, -25440.00812105769, -25673.279537836806, -25340.41497547698, -25728.947743169487, -25878.791754771355, -26025.64082279114, -25551.166362507065, -25896.858298201812, -25426.459396664668, -25507.539473986046, -25711.700010391367, -25871.72504599535, -25762.468233774387, -25970.55138974913, -25738.484817348173, -25808.222128419147, -25644.358623005388, -25578.628393425395, -25879.843296086117, -25949.419554016113, -25807.105742629763, -25819.842964566073, -25549.149932077962, -25641.233468944458, -25568.18492252227, -25805.053352658015, -25883.35886329001, -25682.835904245807, -25841.339528843495, -25579.16663414852, -25718.715107068834, -25578.875325985005, -25487.58692978545, -25414.719522974952, -25723.553788502933, -25585.66285204171, -25814.780497934556, -25728.28886222714, -25546.758528639086, -25827.759630908404, -25646.95840681918, -25603.08863441588, -25679.40343150969, -25653.952587061678, -25729.454126294324, -25820.777574148327, -25577.758394328685, -25722.621822540772, -25571.184965224078, -25749.786517622135, -25608.69988687303, -25925.974049098433, -25539.057099478276, -25596.79683226327, -25622.161893088214, -25876.521107760094, -25507.75601831933, -25524.510201494908, -25870.264431711148, -25910.29466817855, -25668.07480176664, -25797.259392343632, -25887.599220216056, -25703.255399059504, -25677.12392159334, -25625.12973631695, -25704.57869605525, -25780.019251437523, -25616.88429238699, -25778.305144746893, -25973.67069342046, -25789.92903695543, -25648.23063258596, -25695.332373001038, -25942.65228394119, -25879.525464621925, -25791.18376139029, -25682.366610749825, -25685.13526267443, -25882.94915352667, -25819.908971322835, -25591.504031611414, -25858.368016171105, -25982.257781431064, -25756.018227783792, -26087.989014943934, -25616.646028094816, -25671.89855006249, -25574.665229375463, -25563.20354253552, -25682.20293968738, -25920.276278298647, -25774.75753201078, -25730.65833925668], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.14908874039943, "mean_inference_ms": 0.28165244006420226, "mean_action_processing_ms": 0.06725672298962017, "mean_env_wait_ms": 1.6950897289039946, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0035173892974853516, "StateBufferConnector_ms": 0.00269317626953125, "ViewRequirementAgentConnector_ms": 0.06666851043701172}}, "episode_reward_max": -25340.41497547698, "episode_reward_min": -26087.989014943934, "episode_reward_mean": -25722.112988574143, "episode_len_mean": 360.0, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-25606.671334184066, -25592.0114195276, -25796.179823003586, -25887.053210004226, -25743.554373883482, -26020.766098537446, -25440.00812105769, -25673.279537836806, -25340.41497547698, -25728.947743169487, -25878.791754771355, -26025.64082279114, -25551.166362507065, -25896.858298201812, -25426.459396664668, -25507.539473986046, -25711.700010391367, -25871.72504599535, -25762.468233774387, -25970.55138974913, -25738.484817348173, -25808.222128419147, -25644.358623005388, -25578.628393425395, -25879.843296086117, -25949.419554016113, -25807.105742629763, -25819.842964566073, -25549.149932077962, -25641.233468944458, -25568.18492252227, -25805.053352658015, -25883.35886329001, -25682.835904245807, -25841.339528843495, -25579.16663414852, -25718.715107068834, -25578.875325985005, -25487.58692978545, -25414.719522974952, -25723.553788502933, -25585.66285204171, -25814.780497934556, -25728.28886222714, -25546.758528639086, -25827.759630908404, -25646.95840681918, -25603.08863441588, -25679.40343150969, -25653.952587061678, -25729.454126294324, -25820.777574148327, -25577.758394328685, -25722.621822540772, -25571.184965224078, -25749.786517622135, -25608.69988687303, -25925.974049098433, -25539.057099478276, -25596.79683226327, -25622.161893088214, -25876.521107760094, -25507.75601831933, -25524.510201494908, -25870.264431711148, -25910.29466817855, -25668.07480176664, -25797.259392343632, -25887.599220216056, -25703.255399059504, -25677.12392159334, -25625.12973631695, -25704.57869605525, -25780.019251437523, -25616.88429238699, -25778.305144746893, -25973.67069342046, -25789.92903695543, -25648.23063258596, -25695.332373001038, -25942.65228394119, -25879.525464621925, -25791.18376139029, -25682.366610749825, -25685.13526267443, -25882.94915352667, -25819.908971322835, -25591.504031611414, -25858.368016171105, -25982.257781431064, -25756.018227783792, -26087.989014943934, -25616.646028094816, -25671.89855006249, -25574.665229375463, -25563.20354253552, -25682.20293968738, -25920.276278298647, -25774.75753201078, -25730.65833925668], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.14908874039943, "mean_inference_ms": 0.28165244006420226, "mean_action_processing_ms": 0.06725672298962017, "mean_env_wait_ms": 1.6950897289039946, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0035173892974853516, "StateBufferConnector_ms": 0.00269317626953125, "ViewRequirementAgentConnector_ms": 0.06666851043701172}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 279000, "num_agent_steps_trained": 279000, "num_env_steps_sampled": 279000, "num_env_steps_trained": 279000, "num_env_steps_sampled_this_iter": 1080, "num_env_steps_trained_this_iter": 1080, "num_env_steps_sampled_throughput_per_sec": 95.82959379140524, "num_env_steps_trained_throughput_per_sec": 95.82959379140524, "timesteps_total": 279000, "num_steps_trained_this_iter": 1080, "agent_timesteps_total": 279000, "timers": {"training_iteration_time_ms": 3781.375, "sample_time_ms": 3770.705, "load_time_ms": 0.295, "load_throughput": 1218585.619, "learn_time_ms": 9.629, "learn_throughput": 37386.091, "synch_weights_time_ms": 0.703}, "counters": {"num_env_steps_sampled": 279000, "num_env_steps_trained": 279000, "num_agent_steps_sampled": 279000, "num_agent_steps_trained": 279000}, "done": false, "episodes_total": 775, "training_iteration": 185, "trial_id": "f5e97_00000", "date": "2023-07-25_17-30-35", "timestamp": 1690295435, "time_this_iter_s": 11.272787094116211, "time_total_s": 2078.0003983974457, "pid": 71917, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[0, 0.003], [5400, 0.001], [10800, 0.00075], [16200, 0.0005], [21600, 0.00025], [27000, 0.0001], [32400, 7.5e-05], [37800, 5e-05], [43200, 2.5e-05], [48600, 1e-05], [54000, 7.5e-06], [59400, 5e-06], [64800, 2.5e-06], [70200, 1e-06], [75600, 5e-07], [81000, 1e-07]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x304530310>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 2078.0003983974457, "iterations_since_restore": 185, "perf": {"cpu_util_percent": 24.64375, "ram_util_percent": 76.59375}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-07, "entropy_coeff": 0.1, "policy_entropy": -926.6999267578125, "policy_loss": -25782119523942.4, "vf_loss": 1095177888.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 3888.0, "diff_num_grad_updates_vs_sampler_policy": 3887.0}}, "num_env_steps_sampled": 280080, "num_env_steps_trained": 280080, "num_agent_steps_sampled": 280080, "num_agent_steps_trained": 280080}, "sampler_results": {"episode_reward_max": -25340.41497547698, "episode_reward_min": -26087.989014943934, "episode_reward_mean": -25728.250630834416, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-25887.053210004226, -25743.554373883482, -26020.766098537446, -25440.00812105769, -25673.279537836806, -25340.41497547698, -25728.947743169487, -25878.791754771355, -26025.64082279114, -25551.166362507065, -25896.858298201812, -25426.459396664668, -25507.539473986046, -25711.700010391367, -25871.72504599535, -25762.468233774387, -25970.55138974913, -25738.484817348173, -25808.222128419147, -25644.358623005388, -25578.628393425395, -25879.843296086117, -25949.419554016113, -25807.105742629763, -25819.842964566073, -25549.149932077962, -25641.233468944458, -25568.18492252227, -25805.053352658015, -25883.35886329001, -25682.835904245807, -25841.339528843495, -25579.16663414852, -25718.715107068834, -25578.875325985005, -25487.58692978545, -25414.719522974952, -25723.553788502933, -25585.66285204171, -25814.780497934556, -25728.28886222714, -25546.758528639086, -25827.759630908404, -25646.95840681918, -25603.08863441588, -25679.40343150969, -25653.952587061678, -25729.454126294324, -25820.777574148327, -25577.758394328685, -25722.621822540772, -25571.184965224078, -25749.786517622135, -25608.69988687303, -25925.974049098433, -25539.057099478276, -25596.79683226327, -25622.161893088214, -25876.521107760094, -25507.75601831933, -25524.510201494908, -25870.264431711148, -25910.29466817855, -25668.07480176664, -25797.259392343632, -25887.599220216056, -25703.255399059504, -25677.12392159334, -25625.12973631695, -25704.57869605525, -25780.019251437523, -25616.88429238699, -25778.305144746893, -25973.67069342046, -25789.92903695543, -25648.23063258596, -25695.332373001038, -25942.65228394119, -25879.525464621925, -25791.18376139029, -25682.366610749825, -25685.13526267443, -25882.94915352667, -25819.908971322835, -25591.504031611414, -25858.368016171105, -25982.257781431064, -25756.018227783792, -26087.989014943934, -25616.646028094816, -25671.89855006249, -25574.665229375463, -25563.20354253552, -25682.20293968738, -25920.276278298647, -25774.75753201078, -25730.65833925668, -25846.76267862341, -26069.937320547575, -25691.9268035718], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.158766026653707, "mean_inference_ms": 0.28207918615188377, "mean_action_processing_ms": 0.0673635041718886, "mean_env_wait_ms": 1.6982122391437833, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0035247802734375, "StateBufferConnector_ms": 0.0027031898498535156, "ViewRequirementAgentConnector_ms": 0.06683778762817383}}, "episode_reward_max": -25340.41497547698, "episode_reward_min": -26087.989014943934, "episode_reward_mean": -25728.250630834416, "episode_len_mean": 360.0, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-25887.053210004226, -25743.554373883482, -26020.766098537446, -25440.00812105769, -25673.279537836806, -25340.41497547698, -25728.947743169487, -25878.791754771355, -26025.64082279114, -25551.166362507065, -25896.858298201812, -25426.459396664668, -25507.539473986046, -25711.700010391367, -25871.72504599535, -25762.468233774387, -25970.55138974913, -25738.484817348173, -25808.222128419147, -25644.358623005388, -25578.628393425395, -25879.843296086117, -25949.419554016113, -25807.105742629763, -25819.842964566073, -25549.149932077962, -25641.233468944458, -25568.18492252227, -25805.053352658015, -25883.35886329001, -25682.835904245807, -25841.339528843495, -25579.16663414852, -25718.715107068834, -25578.875325985005, -25487.58692978545, -25414.719522974952, -25723.553788502933, -25585.66285204171, -25814.780497934556, -25728.28886222714, -25546.758528639086, -25827.759630908404, -25646.95840681918, -25603.08863441588, -25679.40343150969, -25653.952587061678, -25729.454126294324, -25820.777574148327, -25577.758394328685, -25722.621822540772, -25571.184965224078, -25749.786517622135, -25608.69988687303, -25925.974049098433, -25539.057099478276, -25596.79683226327, -25622.161893088214, -25876.521107760094, -25507.75601831933, -25524.510201494908, -25870.264431711148, -25910.29466817855, -25668.07480176664, -25797.259392343632, -25887.599220216056, -25703.255399059504, -25677.12392159334, -25625.12973631695, -25704.57869605525, -25780.019251437523, -25616.88429238699, -25778.305144746893, -25973.67069342046, -25789.92903695543, -25648.23063258596, -25695.332373001038, -25942.65228394119, -25879.525464621925, -25791.18376139029, -25682.366610749825, -25685.13526267443, -25882.94915352667, -25819.908971322835, -25591.504031611414, -25858.368016171105, -25982.257781431064, -25756.018227783792, -26087.989014943934, -25616.646028094816, -25671.89855006249, -25574.665229375463, -25563.20354253552, -25682.20293968738, -25920.276278298647, -25774.75753201078, -25730.65833925668, -25846.76267862341, -26069.937320547575, -25691.9268035718], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.158766026653707, "mean_inference_ms": 0.28207918615188377, "mean_action_processing_ms": 0.0673635041718886, "mean_env_wait_ms": 1.6982122391437833, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0035247802734375, "StateBufferConnector_ms": 0.0027031898498535156, "ViewRequirementAgentConnector_ms": 0.06683778762817383}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 280080, "num_agent_steps_trained": 280080, "num_env_steps_sampled": 280080, "num_env_steps_trained": 280080, "num_env_steps_sampled_this_iter": 1080, "num_env_steps_trained_this_iter": 1080, "num_env_steps_sampled_throughput_per_sec": 97.05530597913271, "num_env_steps_trained_throughput_per_sec": 97.05530597913271, "timesteps_total": 280080, "num_steps_trained_this_iter": 1080, "agent_timesteps_total": 280080, "timers": {"training_iteration_time_ms": 3762.569, "sample_time_ms": 3751.784, "load_time_ms": 0.298, "load_throughput": 1206415.34, "learn_time_ms": 9.731, "learn_throughput": 36996.777, "synch_weights_time_ms": 0.713}, "counters": {"num_env_steps_sampled": 280080, "num_env_steps_trained": 280080, "num_agent_steps_sampled": 280080, "num_agent_steps_trained": 280080}, "done": false, "episodes_total": 778, "training_iteration": 186, "trial_id": "f5e97_00000", "date": "2023-07-25_17-30-46", "timestamp": 1690295446, "time_this_iter_s": 11.130419969558716, "time_total_s": 2089.1308183670044, "pid": 71917, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[0, 0.003], [5400, 0.001], [10800, 0.00075], [16200, 0.0005], [21600, 0.00025], [27000, 0.0001], [32400, 7.5e-05], [37800, 5e-05], [43200, 2.5e-05], [48600, 1e-05], [54000, 7.5e-06], [59400, 5e-06], [64800, 2.5e-06], [70200, 1e-06], [75600, 5e-07], [81000, 1e-07]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x304530310>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 2089.1308183670044, "iterations_since_restore": 186, "perf": {"cpu_util_percent": 25.79375, "ram_util_percent": 75.04375}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-07, "entropy_coeff": 0.1, "policy_entropy": -926.6998168945313, "policy_loss": -12234256613376.0, "vf_loss": 1109922470.4}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 3903.0, "diff_num_grad_updates_vs_sampler_policy": 3902.0}}, "num_env_steps_sampled": 281160, "num_env_steps_trained": 281160, "num_agent_steps_sampled": 281160, "num_agent_steps_trained": 281160}, "sampler_results": {"episode_reward_max": -25340.41497547698, "episode_reward_min": -26087.989014943934, "episode_reward_mean": -25723.534512539827, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-25440.00812105769, -25673.279537836806, -25340.41497547698, -25728.947743169487, -25878.791754771355, -26025.64082279114, -25551.166362507065, -25896.858298201812, -25426.459396664668, -25507.539473986046, -25711.700010391367, -25871.72504599535, -25762.468233774387, -25970.55138974913, -25738.484817348173, -25808.222128419147, -25644.358623005388, -25578.628393425395, -25879.843296086117, -25949.419554016113, -25807.105742629763, -25819.842964566073, -25549.149932077962, -25641.233468944458, -25568.18492252227, -25805.053352658015, -25883.35886329001, -25682.835904245807, -25841.339528843495, -25579.16663414852, -25718.715107068834, -25578.875325985005, -25487.58692978545, -25414.719522974952, -25723.553788502933, -25585.66285204171, -25814.780497934556, -25728.28886222714, -25546.758528639086, -25827.759630908404, -25646.95840681918, -25603.08863441588, -25679.40343150969, -25653.952587061678, -25729.454126294324, -25820.777574148327, -25577.758394328685, -25722.621822540772, -25571.184965224078, -25749.786517622135, -25608.69988687303, -25925.974049098433, -25539.057099478276, -25596.79683226327, -25622.161893088214, -25876.521107760094, -25507.75601831933, -25524.510201494908, -25870.264431711148, -25910.29466817855, -25668.07480176664, -25797.259392343632, -25887.599220216056, -25703.255399059504, -25677.12392159334, -25625.12973631695, -25704.57869605525, -25780.019251437523, -25616.88429238699, -25778.305144746893, -25973.67069342046, -25789.92903695543, -25648.23063258596, -25695.332373001038, -25942.65228394119, -25879.525464621925, -25791.18376139029, -25682.366610749825, -25685.13526267443, -25882.94915352667, -25819.908971322835, -25591.504031611414, -25858.368016171105, -25982.257781431064, -25756.018227783792, -26087.989014943934, -25616.646028094816, -25671.89855006249, -25574.665229375463, -25563.20354253552, -25682.20293968738, -25920.276278298647, -25774.75753201078, -25730.65833925668, -25846.76267862341, -26069.937320547575, -25691.9268035718, -25597.66725120839, -25753.678386930853, -25828.416214827008], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.168384892740851, "mean_inference_ms": 0.28250332389841665, "mean_action_processing_ms": 0.06746956899470921, "mean_env_wait_ms": 1.701313222181232, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003521442413330078, "StateBufferConnector_ms": 0.002700328826904297, "ViewRequirementAgentConnector_ms": 0.06682443618774414}}, "episode_reward_max": -25340.41497547698, "episode_reward_min": -26087.989014943934, "episode_reward_mean": -25723.534512539827, "episode_len_mean": 360.0, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-25440.00812105769, -25673.279537836806, -25340.41497547698, -25728.947743169487, -25878.791754771355, -26025.64082279114, -25551.166362507065, -25896.858298201812, -25426.459396664668, -25507.539473986046, -25711.700010391367, -25871.72504599535, -25762.468233774387, -25970.55138974913, -25738.484817348173, -25808.222128419147, -25644.358623005388, -25578.628393425395, -25879.843296086117, -25949.419554016113, -25807.105742629763, -25819.842964566073, -25549.149932077962, -25641.233468944458, -25568.18492252227, -25805.053352658015, -25883.35886329001, -25682.835904245807, -25841.339528843495, -25579.16663414852, -25718.715107068834, -25578.875325985005, -25487.58692978545, -25414.719522974952, -25723.553788502933, -25585.66285204171, -25814.780497934556, -25728.28886222714, -25546.758528639086, -25827.759630908404, -25646.95840681918, -25603.08863441588, -25679.40343150969, -25653.952587061678, -25729.454126294324, -25820.777574148327, -25577.758394328685, -25722.621822540772, -25571.184965224078, -25749.786517622135, -25608.69988687303, -25925.974049098433, -25539.057099478276, -25596.79683226327, -25622.161893088214, -25876.521107760094, -25507.75601831933, -25524.510201494908, -25870.264431711148, -25910.29466817855, -25668.07480176664, -25797.259392343632, -25887.599220216056, -25703.255399059504, -25677.12392159334, -25625.12973631695, -25704.57869605525, -25780.019251437523, -25616.88429238699, -25778.305144746893, -25973.67069342046, -25789.92903695543, -25648.23063258596, -25695.332373001038, -25942.65228394119, -25879.525464621925, -25791.18376139029, -25682.366610749825, -25685.13526267443, -25882.94915352667, -25819.908971322835, -25591.504031611414, -25858.368016171105, -25982.257781431064, -25756.018227783792, -26087.989014943934, -25616.646028094816, -25671.89855006249, -25574.665229375463, -25563.20354253552, -25682.20293968738, -25920.276278298647, -25774.75753201078, -25730.65833925668, -25846.76267862341, -26069.937320547575, -25691.9268035718, -25597.66725120839, -25753.678386930853, -25828.416214827008], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.168384892740851, "mean_inference_ms": 0.28250332389841665, "mean_action_processing_ms": 0.06746956899470921, "mean_env_wait_ms": 1.701313222181232, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003521442413330078, "StateBufferConnector_ms": 0.002700328826904297, "ViewRequirementAgentConnector_ms": 0.06682443618774414}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 281160, "num_agent_steps_trained": 281160, "num_env_steps_sampled": 281160, "num_env_steps_trained": 281160, "num_env_steps_sampled_this_iter": 1080, "num_env_steps_trained_this_iter": 1080, "num_env_steps_sampled_throughput_per_sec": 94.98705930976695, "num_env_steps_trained_throughput_per_sec": 94.98705930976695, "timesteps_total": 281160, "num_steps_trained_this_iter": 1080, "agent_timesteps_total": 281160, "timers": {"training_iteration_time_ms": 3759.708, "sample_time_ms": 3748.929, "load_time_ms": 0.3, "load_throughput": 1200182.37, "learn_time_ms": 9.731, "learn_throughput": 36993.604, "synch_weights_time_ms": 0.704}, "counters": {"num_env_steps_sampled": 281160, "num_env_steps_trained": 281160, "num_agent_steps_sampled": 281160, "num_agent_steps_trained": 281160}, "done": false, "episodes_total": 781, "training_iteration": 187, "trial_id": "f5e97_00000", "date": "2023-07-25_17-30-57", "timestamp": 1690295457, "time_this_iter_s": 11.372695207595825, "time_total_s": 2100.5035135746, "pid": 71917, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[0, 0.003], [5400, 0.001], [10800, 0.00075], [16200, 0.0005], [21600, 0.00025], [27000, 0.0001], [32400, 7.5e-05], [37800, 5e-05], [43200, 2.5e-05], [48600, 1e-05], [54000, 7.5e-06], [59400, 5e-06], [64800, 2.5e-06], [70200, 1e-06], [75600, 5e-07], [81000, 1e-07]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x304530310>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 2100.5035135746, "iterations_since_restore": 187, "perf": {"cpu_util_percent": 24.493750000000002, "ram_util_percent": 75.64375000000001}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-07, "entropy_coeff": 0.1, "policy_entropy": -926.6997924804688, "policy_loss": -31700383904563.2, "vf_loss": 1093128281.6}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 3918.0, "diff_num_grad_updates_vs_sampler_policy": 3917.0}}, "num_env_steps_sampled": 282240, "num_env_steps_trained": 282240, "num_agent_steps_sampled": 282240, "num_agent_steps_trained": 282240}, "sampler_results": {"episode_reward_max": -25414.719522974952, "episode_reward_min": -26087.989014943934, "episode_reward_mean": -25727.363113527896, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-25728.947743169487, -25878.791754771355, -26025.64082279114, -25551.166362507065, -25896.858298201812, -25426.459396664668, -25507.539473986046, -25711.700010391367, -25871.72504599535, -25762.468233774387, -25970.55138974913, -25738.484817348173, -25808.222128419147, -25644.358623005388, -25578.628393425395, -25879.843296086117, -25949.419554016113, -25807.105742629763, -25819.842964566073, -25549.149932077962, -25641.233468944458, -25568.18492252227, -25805.053352658015, -25883.35886329001, -25682.835904245807, -25841.339528843495, -25579.16663414852, -25718.715107068834, -25578.875325985005, -25487.58692978545, -25414.719522974952, -25723.553788502933, -25585.66285204171, -25814.780497934556, -25728.28886222714, -25546.758528639086, -25827.759630908404, -25646.95840681918, -25603.08863441588, -25679.40343150969, -25653.952587061678, -25729.454126294324, -25820.777574148327, -25577.758394328685, -25722.621822540772, -25571.184965224078, -25749.786517622135, -25608.69988687303, -25925.974049098433, -25539.057099478276, -25596.79683226327, -25622.161893088214, -25876.521107760094, -25507.75601831933, -25524.510201494908, -25870.264431711148, -25910.29466817855, -25668.07480176664, -25797.259392343632, -25887.599220216056, -25703.255399059504, -25677.12392159334, -25625.12973631695, -25704.57869605525, -25780.019251437523, -25616.88429238699, -25778.305144746893, -25973.67069342046, -25789.92903695543, -25648.23063258596, -25695.332373001038, -25942.65228394119, -25879.525464621925, -25791.18376139029, -25682.366610749825, -25685.13526267443, -25882.94915352667, -25819.908971322835, -25591.504031611414, -25858.368016171105, -25982.257781431064, -25756.018227783792, -26087.989014943934, -25616.646028094816, -25671.89855006249, -25574.665229375463, -25563.20354253552, -25682.20293968738, -25920.276278298647, -25774.75753201078, -25730.65833925668, -25846.76267862341, -26069.937320547575, -25691.9268035718, -25597.66725120839, -25753.678386930853, -25828.416214827008, -25556.145271007263, -25653.540648596365, -25626.876813574327], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.177941309689742, "mean_inference_ms": 0.2829241517861385, "mean_action_processing_ms": 0.06757479185225111, "mean_env_wait_ms": 1.7043851321679588, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0035164356231689453, "StateBufferConnector_ms": 0.002686738967895508, "ViewRequirementAgentConnector_ms": 0.06673669815063477}}, "episode_reward_max": -25414.719522974952, "episode_reward_min": -26087.989014943934, "episode_reward_mean": -25727.363113527896, "episode_len_mean": 360.0, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-25728.947743169487, -25878.791754771355, -26025.64082279114, -25551.166362507065, -25896.858298201812, -25426.459396664668, -25507.539473986046, -25711.700010391367, -25871.72504599535, -25762.468233774387, -25970.55138974913, -25738.484817348173, -25808.222128419147, -25644.358623005388, -25578.628393425395, -25879.843296086117, -25949.419554016113, -25807.105742629763, -25819.842964566073, -25549.149932077962, -25641.233468944458, -25568.18492252227, -25805.053352658015, -25883.35886329001, -25682.835904245807, -25841.339528843495, -25579.16663414852, -25718.715107068834, -25578.875325985005, -25487.58692978545, -25414.719522974952, -25723.553788502933, -25585.66285204171, -25814.780497934556, -25728.28886222714, -25546.758528639086, -25827.759630908404, -25646.95840681918, -25603.08863441588, -25679.40343150969, -25653.952587061678, -25729.454126294324, -25820.777574148327, -25577.758394328685, -25722.621822540772, -25571.184965224078, -25749.786517622135, -25608.69988687303, -25925.974049098433, -25539.057099478276, -25596.79683226327, -25622.161893088214, -25876.521107760094, -25507.75601831933, -25524.510201494908, -25870.264431711148, -25910.29466817855, -25668.07480176664, -25797.259392343632, -25887.599220216056, -25703.255399059504, -25677.12392159334, -25625.12973631695, -25704.57869605525, -25780.019251437523, -25616.88429238699, -25778.305144746893, -25973.67069342046, -25789.92903695543, -25648.23063258596, -25695.332373001038, -25942.65228394119, -25879.525464621925, -25791.18376139029, -25682.366610749825, -25685.13526267443, -25882.94915352667, -25819.908971322835, -25591.504031611414, -25858.368016171105, -25982.257781431064, -25756.018227783792, -26087.989014943934, -25616.646028094816, -25671.89855006249, -25574.665229375463, -25563.20354253552, -25682.20293968738, -25920.276278298647, -25774.75753201078, -25730.65833925668, -25846.76267862341, -26069.937320547575, -25691.9268035718, -25597.66725120839, -25753.678386930853, -25828.416214827008, -25556.145271007263, -25653.540648596365, -25626.876813574327], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.177941309689742, "mean_inference_ms": 0.2829241517861385, "mean_action_processing_ms": 0.06757479185225111, "mean_env_wait_ms": 1.7043851321679588, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0035164356231689453, "StateBufferConnector_ms": 0.002686738967895508, "ViewRequirementAgentConnector_ms": 0.06673669815063477}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 282240, "num_agent_steps_trained": 282240, "num_env_steps_sampled": 282240, "num_env_steps_trained": 282240, "num_env_steps_sampled_this_iter": 1080, "num_env_steps_trained_this_iter": 1080, "num_env_steps_sampled_throughput_per_sec": 95.31072209568406, "num_env_steps_trained_throughput_per_sec": 95.31072209568406, "timesteps_total": 282240, "num_steps_trained_this_iter": 1080, "agent_timesteps_total": 282240, "timers": {"training_iteration_time_ms": 3757.28, "sample_time_ms": 3746.503, "load_time_ms": 0.299, "load_throughput": 1203051.103, "learn_time_ms": 9.733, "learn_throughput": 36987.442, "synch_weights_time_ms": 0.701}, "counters": {"num_env_steps_sampled": 282240, "num_env_steps_trained": 282240, "num_agent_steps_sampled": 282240, "num_agent_steps_trained": 282240}, "done": false, "episodes_total": 784, "training_iteration": 188, "trial_id": "f5e97_00000", "date": "2023-07-25_17-31-09", "timestamp": 1690295469, "time_this_iter_s": 11.33426308631897, "time_total_s": 2111.837776660919, "pid": 71917, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[0, 0.003], [5400, 0.001], [10800, 0.00075], [16200, 0.0005], [21600, 0.00025], [27000, 0.0001], [32400, 7.5e-05], [37800, 5e-05], [43200, 2.5e-05], [48600, 1e-05], [54000, 7.5e-06], [59400, 5e-06], [64800, 2.5e-06], [70200, 1e-06], [75600, 5e-07], [81000, 1e-07]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x304530310>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 2111.837776660919, "iterations_since_restore": 188, "perf": {"cpu_util_percent": 24.25294117647059, "ram_util_percent": 75.8}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-07, "entropy_coeff": 0.1, "policy_entropy": -926.6999633789062, "policy_loss": -9859226648576.0, "vf_loss": 1099917024.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 3933.0, "diff_num_grad_updates_vs_sampler_policy": 3932.0}}, "num_env_steps_sampled": 283320, "num_env_steps_trained": 283320, "num_agent_steps_sampled": 283320, "num_agent_steps_trained": 283320}, "sampler_results": {"episode_reward_max": -25414.719522974952, "episode_reward_min": -26087.989014943934, "episode_reward_mean": -25724.02425025799, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-25551.166362507065, -25896.858298201812, -25426.459396664668, -25507.539473986046, -25711.700010391367, -25871.72504599535, -25762.468233774387, -25970.55138974913, -25738.484817348173, -25808.222128419147, -25644.358623005388, -25578.628393425395, -25879.843296086117, -25949.419554016113, -25807.105742629763, -25819.842964566073, -25549.149932077962, -25641.233468944458, -25568.18492252227, -25805.053352658015, -25883.35886329001, -25682.835904245807, -25841.339528843495, -25579.16663414852, -25718.715107068834, -25578.875325985005, -25487.58692978545, -25414.719522974952, -25723.553788502933, -25585.66285204171, -25814.780497934556, -25728.28886222714, -25546.758528639086, -25827.759630908404, -25646.95840681918, -25603.08863441588, -25679.40343150969, -25653.952587061678, -25729.454126294324, -25820.777574148327, -25577.758394328685, -25722.621822540772, -25571.184965224078, -25749.786517622135, -25608.69988687303, -25925.974049098433, -25539.057099478276, -25596.79683226327, -25622.161893088214, -25876.521107760094, -25507.75601831933, -25524.510201494908, -25870.264431711148, -25910.29466817855, -25668.07480176664, -25797.259392343632, -25887.599220216056, -25703.255399059504, -25677.12392159334, -25625.12973631695, -25704.57869605525, -25780.019251437523, -25616.88429238699, -25778.305144746893, -25973.67069342046, -25789.92903695543, -25648.23063258596, -25695.332373001038, -25942.65228394119, -25879.525464621925, -25791.18376139029, -25682.366610749825, -25685.13526267443, -25882.94915352667, -25819.908971322835, -25591.504031611414, -25858.368016171105, -25982.257781431064, -25756.018227783792, -26087.989014943934, -25616.646028094816, -25671.89855006249, -25574.665229375463, -25563.20354253552, -25682.20293968738, -25920.276278298647, -25774.75753201078, -25730.65833925668, -25846.76267862341, -26069.937320547575, -25691.9268035718, -25597.66725120839, -25753.678386930853, -25828.416214827008, -25556.145271007263, -25653.540648596365, -25626.876813574327, -25815.059498911414, -25785.900387605372, -25698.53410722529], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.187413010491883, "mean_inference_ms": 0.2833411781187882, "mean_action_processing_ms": 0.06767913236512933, "mean_env_wait_ms": 1.7074318119149279, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0035147666931152344, "StateBufferConnector_ms": 0.0026836395263671875, "ViewRequirementAgentConnector_ms": 0.06665325164794922}}, "episode_reward_max": -25414.719522974952, "episode_reward_min": -26087.989014943934, "episode_reward_mean": -25724.02425025799, "episode_len_mean": 360.0, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-25551.166362507065, -25896.858298201812, -25426.459396664668, -25507.539473986046, -25711.700010391367, -25871.72504599535, -25762.468233774387, -25970.55138974913, -25738.484817348173, -25808.222128419147, -25644.358623005388, -25578.628393425395, -25879.843296086117, -25949.419554016113, -25807.105742629763, -25819.842964566073, -25549.149932077962, -25641.233468944458, -25568.18492252227, -25805.053352658015, -25883.35886329001, -25682.835904245807, -25841.339528843495, -25579.16663414852, -25718.715107068834, -25578.875325985005, -25487.58692978545, -25414.719522974952, -25723.553788502933, -25585.66285204171, -25814.780497934556, -25728.28886222714, -25546.758528639086, -25827.759630908404, -25646.95840681918, -25603.08863441588, -25679.40343150969, -25653.952587061678, -25729.454126294324, -25820.777574148327, -25577.758394328685, -25722.621822540772, -25571.184965224078, -25749.786517622135, -25608.69988687303, -25925.974049098433, -25539.057099478276, -25596.79683226327, -25622.161893088214, -25876.521107760094, -25507.75601831933, -25524.510201494908, -25870.264431711148, -25910.29466817855, -25668.07480176664, -25797.259392343632, -25887.599220216056, -25703.255399059504, -25677.12392159334, -25625.12973631695, -25704.57869605525, -25780.019251437523, -25616.88429238699, -25778.305144746893, -25973.67069342046, -25789.92903695543, -25648.23063258596, -25695.332373001038, -25942.65228394119, -25879.525464621925, -25791.18376139029, -25682.366610749825, -25685.13526267443, -25882.94915352667, -25819.908971322835, -25591.504031611414, -25858.368016171105, -25982.257781431064, -25756.018227783792, -26087.989014943934, -25616.646028094816, -25671.89855006249, -25574.665229375463, -25563.20354253552, -25682.20293968738, -25920.276278298647, -25774.75753201078, -25730.65833925668, -25846.76267862341, -26069.937320547575, -25691.9268035718, -25597.66725120839, -25753.678386930853, -25828.416214827008, -25556.145271007263, -25653.540648596365, -25626.876813574327, -25815.059498911414, -25785.900387605372, -25698.53410722529], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.187413010491883, "mean_inference_ms": 0.2833411781187882, "mean_action_processing_ms": 0.06767913236512933, "mean_env_wait_ms": 1.7074318119149279, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0035147666931152344, "StateBufferConnector_ms": 0.0026836395263671875, "ViewRequirementAgentConnector_ms": 0.06665325164794922}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 283320, "num_agent_steps_trained": 283320, "num_env_steps_sampled": 283320, "num_env_steps_trained": 283320, "num_env_steps_sampled_this_iter": 1080, "num_env_steps_trained_this_iter": 1080, "num_env_steps_sampled_throughput_per_sec": 95.52191792165688, "num_env_steps_trained_throughput_per_sec": 95.52191792165688, "timesteps_total": 283320, "num_steps_trained_this_iter": 1080, "agent_timesteps_total": 283320, "timers": {"training_iteration_time_ms": 3764.016, "sample_time_ms": 3753.26, "load_time_ms": 0.295, "load_throughput": 1222136.333, "learn_time_ms": 9.716, "learn_throughput": 37052.065, "synch_weights_time_ms": 0.702}, "counters": {"num_env_steps_sampled": 283320, "num_env_steps_trained": 283320, "num_agent_steps_sampled": 283320, "num_agent_steps_trained": 283320}, "done": false, "episodes_total": 787, "training_iteration": 189, "trial_id": "f5e97_00000", "date": "2023-07-25_17-31-20", "timestamp": 1690295480, "time_this_iter_s": 11.309231996536255, "time_total_s": 2123.1470086574554, "pid": 71917, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[0, 0.003], [5400, 0.001], [10800, 0.00075], [16200, 0.0005], [21600, 0.00025], [27000, 0.0001], [32400, 7.5e-05], [37800, 5e-05], [43200, 2.5e-05], [48600, 1e-05], [54000, 7.5e-06], [59400, 5e-06], [64800, 2.5e-06], [70200, 1e-06], [75600, 5e-07], [81000, 1e-07]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x304530310>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 2123.1470086574554, "iterations_since_restore": 189, "perf": {"cpu_util_percent": 23.700000000000003, "ram_util_percent": 75.88125}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-07, "entropy_coeff": 0.1, "policy_entropy": -926.6998168945313, "policy_loss": -15318475800576.0, "vf_loss": 1093160518.4}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 3948.0, "diff_num_grad_updates_vs_sampler_policy": 3947.0}}, "num_env_steps_sampled": 284400, "num_env_steps_trained": 284400, "num_agent_steps_sampled": 284400, "num_agent_steps_trained": 284400}, "sampler_results": {"episode_reward_max": -25414.719522974952, "episode_reward_min": -26087.989014943934, "episode_reward_mean": -25728.15390860286, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-25507.539473986046, -25711.700010391367, -25871.72504599535, -25762.468233774387, -25970.55138974913, -25738.484817348173, -25808.222128419147, -25644.358623005388, -25578.628393425395, -25879.843296086117, -25949.419554016113, -25807.105742629763, -25819.842964566073, -25549.149932077962, -25641.233468944458, -25568.18492252227, -25805.053352658015, -25883.35886329001, -25682.835904245807, -25841.339528843495, -25579.16663414852, -25718.715107068834, -25578.875325985005, -25487.58692978545, -25414.719522974952, -25723.553788502933, -25585.66285204171, -25814.780497934556, -25728.28886222714, -25546.758528639086, -25827.759630908404, -25646.95840681918, -25603.08863441588, -25679.40343150969, -25653.952587061678, -25729.454126294324, -25820.777574148327, -25577.758394328685, -25722.621822540772, -25571.184965224078, -25749.786517622135, -25608.69988687303, -25925.974049098433, -25539.057099478276, -25596.79683226327, -25622.161893088214, -25876.521107760094, -25507.75601831933, -25524.510201494908, -25870.264431711148, -25910.29466817855, -25668.07480176664, -25797.259392343632, -25887.599220216056, -25703.255399059504, -25677.12392159334, -25625.12973631695, -25704.57869605525, -25780.019251437523, -25616.88429238699, -25778.305144746893, -25973.67069342046, -25789.92903695543, -25648.23063258596, -25695.332373001038, -25942.65228394119, -25879.525464621925, -25791.18376139029, -25682.366610749825, -25685.13526267443, -25882.94915352667, -25819.908971322835, -25591.504031611414, -25858.368016171105, -25982.257781431064, -25756.018227783792, -26087.989014943934, -25616.646028094816, -25671.89855006249, -25574.665229375463, -25563.20354253552, -25682.20293968738, -25920.276278298647, -25774.75753201078, -25730.65833925668, -25846.76267862341, -26069.937320547575, -25691.9268035718, -25597.66725120839, -25753.678386930853, -25828.416214827008, -25556.145271007263, -25653.540648596365, -25626.876813574327, -25815.059498911414, -25785.900387605372, -25698.53410722529, -25928.935350527194, -25648.660592112356, -25709.853949220374], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.196803247816035, "mean_inference_ms": 0.2837546137848297, "mean_action_processing_ms": 0.06778258079167297, "mean_env_wait_ms": 1.7104566243488828, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0035202503204345703, "StateBufferConnector_ms": 0.0026903152465820312, "ViewRequirementAgentConnector_ms": 0.06681442260742188}}, "episode_reward_max": -25414.719522974952, "episode_reward_min": -26087.989014943934, "episode_reward_mean": -25728.15390860286, "episode_len_mean": 360.0, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-25507.539473986046, -25711.700010391367, -25871.72504599535, -25762.468233774387, -25970.55138974913, -25738.484817348173, -25808.222128419147, -25644.358623005388, -25578.628393425395, -25879.843296086117, -25949.419554016113, -25807.105742629763, -25819.842964566073, -25549.149932077962, -25641.233468944458, -25568.18492252227, -25805.053352658015, -25883.35886329001, -25682.835904245807, -25841.339528843495, -25579.16663414852, -25718.715107068834, -25578.875325985005, -25487.58692978545, -25414.719522974952, -25723.553788502933, -25585.66285204171, -25814.780497934556, -25728.28886222714, -25546.758528639086, -25827.759630908404, -25646.95840681918, -25603.08863441588, -25679.40343150969, -25653.952587061678, -25729.454126294324, -25820.777574148327, -25577.758394328685, -25722.621822540772, -25571.184965224078, -25749.786517622135, -25608.69988687303, -25925.974049098433, -25539.057099478276, -25596.79683226327, -25622.161893088214, -25876.521107760094, -25507.75601831933, -25524.510201494908, -25870.264431711148, -25910.29466817855, -25668.07480176664, -25797.259392343632, -25887.599220216056, -25703.255399059504, -25677.12392159334, -25625.12973631695, -25704.57869605525, -25780.019251437523, -25616.88429238699, -25778.305144746893, -25973.67069342046, -25789.92903695543, -25648.23063258596, -25695.332373001038, -25942.65228394119, -25879.525464621925, -25791.18376139029, -25682.366610749825, -25685.13526267443, -25882.94915352667, -25819.908971322835, -25591.504031611414, -25858.368016171105, -25982.257781431064, -25756.018227783792, -26087.989014943934, -25616.646028094816, -25671.89855006249, -25574.665229375463, -25563.20354253552, -25682.20293968738, -25920.276278298647, -25774.75753201078, -25730.65833925668, -25846.76267862341, -26069.937320547575, -25691.9268035718, -25597.66725120839, -25753.678386930853, -25828.416214827008, -25556.145271007263, -25653.540648596365, -25626.876813574327, -25815.059498911414, -25785.900387605372, -25698.53410722529, -25928.935350527194, -25648.660592112356, -25709.853949220374], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.196803247816035, "mean_inference_ms": 0.2837546137848297, "mean_action_processing_ms": 0.06778258079167297, "mean_env_wait_ms": 1.7104566243488828, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0035202503204345703, "StateBufferConnector_ms": 0.0026903152465820312, "ViewRequirementAgentConnector_ms": 0.06681442260742188}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 284400, "num_agent_steps_trained": 284400, "num_env_steps_sampled": 284400, "num_env_steps_trained": 284400, "num_env_steps_sampled_this_iter": 1080, "num_env_steps_trained_this_iter": 1080, "num_env_steps_sampled_throughput_per_sec": 94.95707628733825, "num_env_steps_trained_throughput_per_sec": 94.95707628733825, "timesteps_total": 284400, "num_steps_trained_this_iter": 1080, "agent_timesteps_total": 284400, "timers": {"training_iteration_time_ms": 3764.626, "sample_time_ms": 3753.9, "load_time_ms": 0.293, "load_throughput": 1230001.173, "learn_time_ms": 9.702, "learn_throughput": 37107.609, "synch_weights_time_ms": 0.69}, "counters": {"num_env_steps_sampled": 284400, "num_env_steps_trained": 284400, "num_agent_steps_sampled": 284400, "num_agent_steps_trained": 284400}, "done": false, "episodes_total": 790, "training_iteration": 190, "trial_id": "f5e97_00000", "date": "2023-07-25_17-31-31", "timestamp": 1690295491, "time_this_iter_s": 11.376446008682251, "time_total_s": 2134.5234546661377, "pid": 71917, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[0, 0.003], [5400, 0.001], [10800, 0.00075], [16200, 0.0005], [21600, 0.00025], [27000, 0.0001], [32400, 7.5e-05], [37800, 5e-05], [43200, 2.5e-05], [48600, 1e-05], [54000, 7.5e-06], [59400, 5e-06], [64800, 2.5e-06], [70200, 1e-06], [75600, 5e-07], [81000, 1e-07]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x304530310>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 2134.5234546661377, "iterations_since_restore": 190, "perf": {"cpu_util_percent": 20.962500000000002, "ram_util_percent": 75.79375}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-07, "entropy_coeff": 0.1, "policy_entropy": -926.69970703125, "policy_loss": -18417421228646.4, "vf_loss": 1100178188.8}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 3963.0, "diff_num_grad_updates_vs_sampler_policy": 3962.0}}, "num_env_steps_sampled": 285480, "num_env_steps_trained": 285480, "num_agent_steps_sampled": 285480, "num_agent_steps_trained": 285480}, "sampler_results": {"episode_reward_max": -25414.719522974952, "episode_reward_min": -26087.989014943934, "episode_reward_mean": -25730.952467364714, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-25762.468233774387, -25970.55138974913, -25738.484817348173, -25808.222128419147, -25644.358623005388, -25578.628393425395, -25879.843296086117, -25949.419554016113, -25807.105742629763, -25819.842964566073, -25549.149932077962, -25641.233468944458, -25568.18492252227, -25805.053352658015, -25883.35886329001, -25682.835904245807, -25841.339528843495, -25579.16663414852, -25718.715107068834, -25578.875325985005, -25487.58692978545, -25414.719522974952, -25723.553788502933, -25585.66285204171, -25814.780497934556, -25728.28886222714, -25546.758528639086, -25827.759630908404, -25646.95840681918, -25603.08863441588, -25679.40343150969, -25653.952587061678, -25729.454126294324, -25820.777574148327, -25577.758394328685, -25722.621822540772, -25571.184965224078, -25749.786517622135, -25608.69988687303, -25925.974049098433, -25539.057099478276, -25596.79683226327, -25622.161893088214, -25876.521107760094, -25507.75601831933, -25524.510201494908, -25870.264431711148, -25910.29466817855, -25668.07480176664, -25797.259392343632, -25887.599220216056, -25703.255399059504, -25677.12392159334, -25625.12973631695, -25704.57869605525, -25780.019251437523, -25616.88429238699, -25778.305144746893, -25973.67069342046, -25789.92903695543, -25648.23063258596, -25695.332373001038, -25942.65228394119, -25879.525464621925, -25791.18376139029, -25682.366610749825, -25685.13526267443, -25882.94915352667, -25819.908971322835, -25591.504031611414, -25858.368016171105, -25982.257781431064, -25756.018227783792, -26087.989014943934, -25616.646028094816, -25671.89855006249, -25574.665229375463, -25563.20354253552, -25682.20293968738, -25920.276278298647, -25774.75753201078, -25730.65833925668, -25846.76267862341, -26069.937320547575, -25691.9268035718, -25597.66725120839, -25753.678386930853, -25828.416214827008, -25556.145271007263, -25653.540648596365, -25626.876813574327, -25815.059498911414, -25785.900387605372, -25698.53410722529, -25928.935350527194, -25648.660592112356, -25709.853949220374, -25778.270231027287, -25804.044500571126, -25788.505674960164], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.206129770277369, "mean_inference_ms": 0.28416480550290385, "mean_action_processing_ms": 0.06788522626374427, "mean_env_wait_ms": 1.7134378033202153, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0035161972045898438, "StateBufferConnector_ms": 0.002698183059692383, "ViewRequirementAgentConnector_ms": 0.06676530838012695}}, "episode_reward_max": -25414.719522974952, "episode_reward_min": -26087.989014943934, "episode_reward_mean": -25730.952467364714, "episode_len_mean": 360.0, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-25762.468233774387, -25970.55138974913, -25738.484817348173, -25808.222128419147, -25644.358623005388, -25578.628393425395, -25879.843296086117, -25949.419554016113, -25807.105742629763, -25819.842964566073, -25549.149932077962, -25641.233468944458, -25568.18492252227, -25805.053352658015, -25883.35886329001, -25682.835904245807, -25841.339528843495, -25579.16663414852, -25718.715107068834, -25578.875325985005, -25487.58692978545, -25414.719522974952, -25723.553788502933, -25585.66285204171, -25814.780497934556, -25728.28886222714, -25546.758528639086, -25827.759630908404, -25646.95840681918, -25603.08863441588, -25679.40343150969, -25653.952587061678, -25729.454126294324, -25820.777574148327, -25577.758394328685, -25722.621822540772, -25571.184965224078, -25749.786517622135, -25608.69988687303, -25925.974049098433, -25539.057099478276, -25596.79683226327, -25622.161893088214, -25876.521107760094, -25507.75601831933, -25524.510201494908, -25870.264431711148, -25910.29466817855, -25668.07480176664, -25797.259392343632, -25887.599220216056, -25703.255399059504, -25677.12392159334, -25625.12973631695, -25704.57869605525, -25780.019251437523, -25616.88429238699, -25778.305144746893, -25973.67069342046, -25789.92903695543, -25648.23063258596, -25695.332373001038, -25942.65228394119, -25879.525464621925, -25791.18376139029, -25682.366610749825, -25685.13526267443, -25882.94915352667, -25819.908971322835, -25591.504031611414, -25858.368016171105, -25982.257781431064, -25756.018227783792, -26087.989014943934, -25616.646028094816, -25671.89855006249, -25574.665229375463, -25563.20354253552, -25682.20293968738, -25920.276278298647, -25774.75753201078, -25730.65833925668, -25846.76267862341, -26069.937320547575, -25691.9268035718, -25597.66725120839, -25753.678386930853, -25828.416214827008, -25556.145271007263, -25653.540648596365, -25626.876813574327, -25815.059498911414, -25785.900387605372, -25698.53410722529, -25928.935350527194, -25648.660592112356, -25709.853949220374, -25778.270231027287, -25804.044500571126, -25788.505674960164], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.206129770277369, "mean_inference_ms": 0.28416480550290385, "mean_action_processing_ms": 0.06788522626374427, "mean_env_wait_ms": 1.7134378033202153, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0035161972045898438, "StateBufferConnector_ms": 0.002698183059692383, "ViewRequirementAgentConnector_ms": 0.06676530838012695}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 285480, "num_agent_steps_trained": 285480, "num_env_steps_sampled": 285480, "num_env_steps_trained": 285480, "num_env_steps_sampled_this_iter": 1080, "num_env_steps_trained_this_iter": 1080, "num_env_steps_sampled_throughput_per_sec": 95.2475599565093, "num_env_steps_trained_throughput_per_sec": 95.2475599565093, "timesteps_total": 285480, "num_steps_trained_this_iter": 1080, "agent_timesteps_total": 285480, "timers": {"training_iteration_time_ms": 3775.978, "sample_time_ms": 3765.23, "load_time_ms": 0.295, "load_throughput": 1219963.998, "learn_time_ms": 9.722, "learn_throughput": 37028.803, "synch_weights_time_ms": 0.689}, "counters": {"num_env_steps_sampled": 285480, "num_env_steps_trained": 285480, "num_agent_steps_sampled": 285480, "num_agent_steps_trained": 285480}, "done": false, "episodes_total": 793, "training_iteration": 191, "trial_id": "f5e97_00000", "date": "2023-07-25_17-31-43", "timestamp": 1690295503, "time_this_iter_s": 11.341729879379272, "time_total_s": 2145.865184545517, "pid": 71917, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[0, 0.003], [5400, 0.001], [10800, 0.00075], [16200, 0.0005], [21600, 0.00025], [27000, 0.0001], [32400, 7.5e-05], [37800, 5e-05], [43200, 2.5e-05], [48600, 1e-05], [54000, 7.5e-06], [59400, 5e-06], [64800, 2.5e-06], [70200, 1e-06], [75600, 5e-07], [81000, 1e-07]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x304530310>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 2145.865184545517, "iterations_since_restore": 191, "perf": {"cpu_util_percent": 26.08125, "ram_util_percent": 76.01249999999999}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-07, "entropy_coeff": 0.1, "policy_entropy": -926.7000366210938, "policy_loss": -13436705320140.8, "vf_loss": 1078036300.8}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 3978.0, "diff_num_grad_updates_vs_sampler_policy": 3977.0}}, "num_env_steps_sampled": 286560, "num_env_steps_trained": 286560, "num_agent_steps_sampled": 286560, "num_agent_steps_trained": 286560}, "sampler_results": {"episode_reward_max": -25414.719522974952, "episode_reward_min": -26087.989014943934, "episode_reward_mean": -25725.17701829501, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-25808.222128419147, -25644.358623005388, -25578.628393425395, -25879.843296086117, -25949.419554016113, -25807.105742629763, -25819.842964566073, -25549.149932077962, -25641.233468944458, -25568.18492252227, -25805.053352658015, -25883.35886329001, -25682.835904245807, -25841.339528843495, -25579.16663414852, -25718.715107068834, -25578.875325985005, -25487.58692978545, -25414.719522974952, -25723.553788502933, -25585.66285204171, -25814.780497934556, -25728.28886222714, -25546.758528639086, -25827.759630908404, -25646.95840681918, -25603.08863441588, -25679.40343150969, -25653.952587061678, -25729.454126294324, -25820.777574148327, -25577.758394328685, -25722.621822540772, -25571.184965224078, -25749.786517622135, -25608.69988687303, -25925.974049098433, -25539.057099478276, -25596.79683226327, -25622.161893088214, -25876.521107760094, -25507.75601831933, -25524.510201494908, -25870.264431711148, -25910.29466817855, -25668.07480176664, -25797.259392343632, -25887.599220216056, -25703.255399059504, -25677.12392159334, -25625.12973631695, -25704.57869605525, -25780.019251437523, -25616.88429238699, -25778.305144746893, -25973.67069342046, -25789.92903695543, -25648.23063258596, -25695.332373001038, -25942.65228394119, -25879.525464621925, -25791.18376139029, -25682.366610749825, -25685.13526267443, -25882.94915352667, -25819.908971322835, -25591.504031611414, -25858.368016171105, -25982.257781431064, -25756.018227783792, -26087.989014943934, -25616.646028094816, -25671.89855006249, -25574.665229375463, -25563.20354253552, -25682.20293968738, -25920.276278298647, -25774.75753201078, -25730.65833925668, -25846.76267862341, -26069.937320547575, -25691.9268035718, -25597.66725120839, -25753.678386930853, -25828.416214827008, -25556.145271007263, -25653.540648596365, -25626.876813574327, -25815.059498911414, -25785.900387605372, -25698.53410722529, -25928.935350527194, -25648.660592112356, -25709.853949220374, -25778.270231027287, -25804.044500571126, -25788.505674960164, -25511.44172742615, -25745.478053700404, -25637.039752774257], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.215367004274883, "mean_inference_ms": 0.2845712892104734, "mean_action_processing_ms": 0.06798701665205069, "mean_env_wait_ms": 1.7163995052227263, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003523111343383789, "StateBufferConnector_ms": 0.0026988983154296875, "ViewRequirementAgentConnector_ms": 0.06683731079101562}}, "episode_reward_max": -25414.719522974952, "episode_reward_min": -26087.989014943934, "episode_reward_mean": -25725.17701829501, "episode_len_mean": 360.0, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-25808.222128419147, -25644.358623005388, -25578.628393425395, -25879.843296086117, -25949.419554016113, -25807.105742629763, -25819.842964566073, -25549.149932077962, -25641.233468944458, -25568.18492252227, -25805.053352658015, -25883.35886329001, -25682.835904245807, -25841.339528843495, -25579.16663414852, -25718.715107068834, -25578.875325985005, -25487.58692978545, -25414.719522974952, -25723.553788502933, -25585.66285204171, -25814.780497934556, -25728.28886222714, -25546.758528639086, -25827.759630908404, -25646.95840681918, -25603.08863441588, -25679.40343150969, -25653.952587061678, -25729.454126294324, -25820.777574148327, -25577.758394328685, -25722.621822540772, -25571.184965224078, -25749.786517622135, -25608.69988687303, -25925.974049098433, -25539.057099478276, -25596.79683226327, -25622.161893088214, -25876.521107760094, -25507.75601831933, -25524.510201494908, -25870.264431711148, -25910.29466817855, -25668.07480176664, -25797.259392343632, -25887.599220216056, -25703.255399059504, -25677.12392159334, -25625.12973631695, -25704.57869605525, -25780.019251437523, -25616.88429238699, -25778.305144746893, -25973.67069342046, -25789.92903695543, -25648.23063258596, -25695.332373001038, -25942.65228394119, -25879.525464621925, -25791.18376139029, -25682.366610749825, -25685.13526267443, -25882.94915352667, -25819.908971322835, -25591.504031611414, -25858.368016171105, -25982.257781431064, -25756.018227783792, -26087.989014943934, -25616.646028094816, -25671.89855006249, -25574.665229375463, -25563.20354253552, -25682.20293968738, -25920.276278298647, -25774.75753201078, -25730.65833925668, -25846.76267862341, -26069.937320547575, -25691.9268035718, -25597.66725120839, -25753.678386930853, -25828.416214827008, -25556.145271007263, -25653.540648596365, -25626.876813574327, -25815.059498911414, -25785.900387605372, -25698.53410722529, -25928.935350527194, -25648.660592112356, -25709.853949220374, -25778.270231027287, -25804.044500571126, -25788.505674960164, -25511.44172742615, -25745.478053700404, -25637.039752774257], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.215367004274883, "mean_inference_ms": 0.2845712892104734, "mean_action_processing_ms": 0.06798701665205069, "mean_env_wait_ms": 1.7163995052227263, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003523111343383789, "StateBufferConnector_ms": 0.0026988983154296875, "ViewRequirementAgentConnector_ms": 0.06683731079101562}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 286560, "num_agent_steps_trained": 286560, "num_env_steps_sampled": 286560, "num_env_steps_trained": 286560, "num_env_steps_sampled_this_iter": 1080, "num_env_steps_trained_this_iter": 1080, "num_env_steps_sampled_throughput_per_sec": 95.24343649825465, "num_env_steps_trained_throughput_per_sec": 95.24343649825465, "timesteps_total": 286560, "num_steps_trained_this_iter": 1080, "agent_timesteps_total": 286560, "timers": {"training_iteration_time_ms": 3787.754, "sample_time_ms": 3776.954, "load_time_ms": 0.3, "load_throughput": 1201519.408, "learn_time_ms": 9.76, "learn_throughput": 36885.793, "synch_weights_time_ms": 0.698}, "counters": {"num_env_steps_sampled": 286560, "num_env_steps_trained": 286560, "num_agent_steps_sampled": 286560, "num_agent_steps_trained": 286560}, "done": false, "episodes_total": 796, "training_iteration": 192, "trial_id": "f5e97_00000", "date": "2023-07-25_17-31-54", "timestamp": 1690295514, "time_this_iter_s": 11.342344999313354, "time_total_s": 2157.2075295448303, "pid": 71917, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[0, 0.003], [5400, 0.001], [10800, 0.00075], [16200, 0.0005], [21600, 0.00025], [27000, 0.0001], [32400, 7.5e-05], [37800, 5e-05], [43200, 2.5e-05], [48600, 1e-05], [54000, 7.5e-06], [59400, 5e-06], [64800, 2.5e-06], [70200, 1e-06], [75600, 5e-07], [81000, 1e-07]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x304530310>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 2157.2075295448303, "iterations_since_restore": 192, "perf": {"cpu_util_percent": 21.75625, "ram_util_percent": 74.98124999999999}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-07, "entropy_coeff": 0.1, "policy_entropy": -926.6996215820312, "policy_loss": -16685536359219.2, "vf_loss": 1121097120.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 3993.0, "diff_num_grad_updates_vs_sampler_policy": 3992.0}}, "num_env_steps_sampled": 287640, "num_env_steps_trained": 287640, "num_agent_steps_sampled": 287640, "num_agent_steps_trained": 287640}, "sampler_results": {"episode_reward_max": -25414.719522974952, "episode_reward_min": -26221.080968285096, "episode_reward_mean": -25733.528634645998, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-25879.843296086117, -25949.419554016113, -25807.105742629763, -25819.842964566073, -25549.149932077962, -25641.233468944458, -25568.18492252227, -25805.053352658015, -25883.35886329001, -25682.835904245807, -25841.339528843495, -25579.16663414852, -25718.715107068834, -25578.875325985005, -25487.58692978545, -25414.719522974952, -25723.553788502933, -25585.66285204171, -25814.780497934556, -25728.28886222714, -25546.758528639086, -25827.759630908404, -25646.95840681918, -25603.08863441588, -25679.40343150969, -25653.952587061678, -25729.454126294324, -25820.777574148327, -25577.758394328685, -25722.621822540772, -25571.184965224078, -25749.786517622135, -25608.69988687303, -25925.974049098433, -25539.057099478276, -25596.79683226327, -25622.161893088214, -25876.521107760094, -25507.75601831933, -25524.510201494908, -25870.264431711148, -25910.29466817855, -25668.07480176664, -25797.259392343632, -25887.599220216056, -25703.255399059504, -25677.12392159334, -25625.12973631695, -25704.57869605525, -25780.019251437523, -25616.88429238699, -25778.305144746893, -25973.67069342046, -25789.92903695543, -25648.23063258596, -25695.332373001038, -25942.65228394119, -25879.525464621925, -25791.18376139029, -25682.366610749825, -25685.13526267443, -25882.94915352667, -25819.908971322835, -25591.504031611414, -25858.368016171105, -25982.257781431064, -25756.018227783792, -26087.989014943934, -25616.646028094816, -25671.89855006249, -25574.665229375463, -25563.20354253552, -25682.20293968738, -25920.276278298647, -25774.75753201078, -25730.65833925668, -25846.76267862341, -26069.937320547575, -25691.9268035718, -25597.66725120839, -25753.678386930853, -25828.416214827008, -25556.145271007263, -25653.540648596365, -25626.876813574327, -25815.059498911414, -25785.900387605372, -25698.53410722529, -25928.935350527194, -25648.660592112356, -25709.853949220374, -25778.270231027287, -25804.044500571126, -25788.505674960164, -25511.44172742615, -25745.478053700404, -25637.039752774257, -25660.410542506863, -26221.080968285096, -25984.879269157755], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.224526204838687, "mean_inference_ms": 0.28497509417346045, "mean_action_processing_ms": 0.06808810260581567, "mean_env_wait_ms": 1.7193132051825928, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0035223960876464844, "StateBufferConnector_ms": 0.0026955604553222656, "ViewRequirementAgentConnector_ms": 0.06682419776916504}}, "episode_reward_max": -25414.719522974952, "episode_reward_min": -26221.080968285096, "episode_reward_mean": -25733.528634645998, "episode_len_mean": 360.0, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-25879.843296086117, -25949.419554016113, -25807.105742629763, -25819.842964566073, -25549.149932077962, -25641.233468944458, -25568.18492252227, -25805.053352658015, -25883.35886329001, -25682.835904245807, -25841.339528843495, -25579.16663414852, -25718.715107068834, -25578.875325985005, -25487.58692978545, -25414.719522974952, -25723.553788502933, -25585.66285204171, -25814.780497934556, -25728.28886222714, -25546.758528639086, -25827.759630908404, -25646.95840681918, -25603.08863441588, -25679.40343150969, -25653.952587061678, -25729.454126294324, -25820.777574148327, -25577.758394328685, -25722.621822540772, -25571.184965224078, -25749.786517622135, -25608.69988687303, -25925.974049098433, -25539.057099478276, -25596.79683226327, -25622.161893088214, -25876.521107760094, -25507.75601831933, -25524.510201494908, -25870.264431711148, -25910.29466817855, -25668.07480176664, -25797.259392343632, -25887.599220216056, -25703.255399059504, -25677.12392159334, -25625.12973631695, -25704.57869605525, -25780.019251437523, -25616.88429238699, -25778.305144746893, -25973.67069342046, -25789.92903695543, -25648.23063258596, -25695.332373001038, -25942.65228394119, -25879.525464621925, -25791.18376139029, -25682.366610749825, -25685.13526267443, -25882.94915352667, -25819.908971322835, -25591.504031611414, -25858.368016171105, -25982.257781431064, -25756.018227783792, -26087.989014943934, -25616.646028094816, -25671.89855006249, -25574.665229375463, -25563.20354253552, -25682.20293968738, -25920.276278298647, -25774.75753201078, -25730.65833925668, -25846.76267862341, -26069.937320547575, -25691.9268035718, -25597.66725120839, -25753.678386930853, -25828.416214827008, -25556.145271007263, -25653.540648596365, -25626.876813574327, -25815.059498911414, -25785.900387605372, -25698.53410722529, -25928.935350527194, -25648.660592112356, -25709.853949220374, -25778.270231027287, -25804.044500571126, -25788.505674960164, -25511.44172742615, -25745.478053700404, -25637.039752774257, -25660.410542506863, -26221.080968285096, -25984.879269157755], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.224526204838687, "mean_inference_ms": 0.28497509417346045, "mean_action_processing_ms": 0.06808810260581567, "mean_env_wait_ms": 1.7193132051825928, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0035223960876464844, "StateBufferConnector_ms": 0.0026955604553222656, "ViewRequirementAgentConnector_ms": 0.06682419776916504}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 287640, "num_agent_steps_trained": 287640, "num_env_steps_sampled": 287640, "num_env_steps_trained": 287640, "num_env_steps_sampled_this_iter": 1080, "num_env_steps_trained_this_iter": 1080, "num_env_steps_sampled_throughput_per_sec": 97.01509716826365, "num_env_steps_trained_throughput_per_sec": 97.01509716826365, "timesteps_total": 287640, "num_steps_trained_this_iter": 1080, "agent_timesteps_total": 287640, "timers": {"training_iteration_time_ms": 3772.869, "sample_time_ms": 3762.099, "load_time_ms": 0.302, "load_throughput": 1191469.613, "learn_time_ms": 9.724, "learn_throughput": 37021.359, "synch_weights_time_ms": 0.701}, "counters": {"num_env_steps_sampled": 287640, "num_env_steps_trained": 287640, "num_agent_steps_sampled": 287640, "num_agent_steps_trained": 287640}, "done": false, "episodes_total": 799, "training_iteration": 193, "trial_id": "f5e97_00000", "date": "2023-07-25_17-32-05", "timestamp": 1690295525, "time_this_iter_s": 11.135141849517822, "time_total_s": 2168.342671394348, "pid": 71917, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[0, 0.003], [5400, 0.001], [10800, 0.00075], [16200, 0.0005], [21600, 0.00025], [27000, 0.0001], [32400, 7.5e-05], [37800, 5e-05], [43200, 2.5e-05], [48600, 1e-05], [54000, 7.5e-06], [59400, 5e-06], [64800, 2.5e-06], [70200, 1e-06], [75600, 5e-07], [81000, 1e-07]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x304530310>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 2168.342671394348, "iterations_since_restore": 193, "perf": {"cpu_util_percent": 25.11875, "ram_util_percent": 74.69999999999999}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-07, "entropy_coeff": 0.1, "policy_entropy": -926.699755859375, "policy_loss": -14484847776563.2, "vf_loss": 1108516960.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 4008.0, "diff_num_grad_updates_vs_sampler_policy": 4007.0}}, "num_env_steps_sampled": 288720, "num_env_steps_trained": 288720, "num_agent_steps_sampled": 288720, "num_agent_steps_trained": 288720}, "sampler_results": {"episode_reward_max": -25414.719522974952, "episode_reward_min": -26221.080968285096, "episode_reward_mean": -25730.41011331247, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-25819.842964566073, -25549.149932077962, -25641.233468944458, -25568.18492252227, -25805.053352658015, -25883.35886329001, -25682.835904245807, -25841.339528843495, -25579.16663414852, -25718.715107068834, -25578.875325985005, -25487.58692978545, -25414.719522974952, -25723.553788502933, -25585.66285204171, -25814.780497934556, -25728.28886222714, -25546.758528639086, -25827.759630908404, -25646.95840681918, -25603.08863441588, -25679.40343150969, -25653.952587061678, -25729.454126294324, -25820.777574148327, -25577.758394328685, -25722.621822540772, -25571.184965224078, -25749.786517622135, -25608.69988687303, -25925.974049098433, -25539.057099478276, -25596.79683226327, -25622.161893088214, -25876.521107760094, -25507.75601831933, -25524.510201494908, -25870.264431711148, -25910.29466817855, -25668.07480176664, -25797.259392343632, -25887.599220216056, -25703.255399059504, -25677.12392159334, -25625.12973631695, -25704.57869605525, -25780.019251437523, -25616.88429238699, -25778.305144746893, -25973.67069342046, -25789.92903695543, -25648.23063258596, -25695.332373001038, -25942.65228394119, -25879.525464621925, -25791.18376139029, -25682.366610749825, -25685.13526267443, -25882.94915352667, -25819.908971322835, -25591.504031611414, -25858.368016171105, -25982.257781431064, -25756.018227783792, -26087.989014943934, -25616.646028094816, -25671.89855006249, -25574.665229375463, -25563.20354253552, -25682.20293968738, -25920.276278298647, -25774.75753201078, -25730.65833925668, -25846.76267862341, -26069.937320547575, -25691.9268035718, -25597.66725120839, -25753.678386930853, -25828.416214827008, -25556.145271007263, -25653.540648596365, -25626.876813574327, -25815.059498911414, -25785.900387605372, -25698.53410722529, -25928.935350527194, -25648.660592112356, -25709.853949220374, -25778.270231027287, -25804.044500571126, -25788.505674960164, -25511.44172742615, -25745.478053700404, -25637.039752774257, -25660.410542506863, -26221.080968285096, -25984.879269157755, -25893.435676587505, -25537.43144166211, -25893.649341129778], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.233620402750401, "mean_inference_ms": 0.2853754865728112, "mean_action_processing_ms": 0.06818833104816341, "mean_env_wait_ms": 1.7221896930018983, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0035202503204345703, "StateBufferConnector_ms": 0.0026917457580566406, "ViewRequirementAgentConnector_ms": 0.06676149368286133}}, "episode_reward_max": -25414.719522974952, "episode_reward_min": -26221.080968285096, "episode_reward_mean": -25730.41011331247, "episode_len_mean": 360.0, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-25819.842964566073, -25549.149932077962, -25641.233468944458, -25568.18492252227, -25805.053352658015, -25883.35886329001, -25682.835904245807, -25841.339528843495, -25579.16663414852, -25718.715107068834, -25578.875325985005, -25487.58692978545, -25414.719522974952, -25723.553788502933, -25585.66285204171, -25814.780497934556, -25728.28886222714, -25546.758528639086, -25827.759630908404, -25646.95840681918, -25603.08863441588, -25679.40343150969, -25653.952587061678, -25729.454126294324, -25820.777574148327, -25577.758394328685, -25722.621822540772, -25571.184965224078, -25749.786517622135, -25608.69988687303, -25925.974049098433, -25539.057099478276, -25596.79683226327, -25622.161893088214, -25876.521107760094, -25507.75601831933, -25524.510201494908, -25870.264431711148, -25910.29466817855, -25668.07480176664, -25797.259392343632, -25887.599220216056, -25703.255399059504, -25677.12392159334, -25625.12973631695, -25704.57869605525, -25780.019251437523, -25616.88429238699, -25778.305144746893, -25973.67069342046, -25789.92903695543, -25648.23063258596, -25695.332373001038, -25942.65228394119, -25879.525464621925, -25791.18376139029, -25682.366610749825, -25685.13526267443, -25882.94915352667, -25819.908971322835, -25591.504031611414, -25858.368016171105, -25982.257781431064, -25756.018227783792, -26087.989014943934, -25616.646028094816, -25671.89855006249, -25574.665229375463, -25563.20354253552, -25682.20293968738, -25920.276278298647, -25774.75753201078, -25730.65833925668, -25846.76267862341, -26069.937320547575, -25691.9268035718, -25597.66725120839, -25753.678386930853, -25828.416214827008, -25556.145271007263, -25653.540648596365, -25626.876813574327, -25815.059498911414, -25785.900387605372, -25698.53410722529, -25928.935350527194, -25648.660592112356, -25709.853949220374, -25778.270231027287, -25804.044500571126, -25788.505674960164, -25511.44172742615, -25745.478053700404, -25637.039752774257, -25660.410542506863, -26221.080968285096, -25984.879269157755, -25893.435676587505, -25537.43144166211, -25893.649341129778], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.233620402750401, "mean_inference_ms": 0.2853754865728112, "mean_action_processing_ms": 0.06818833104816341, "mean_env_wait_ms": 1.7221896930018983, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0035202503204345703, "StateBufferConnector_ms": 0.0026917457580566406, "ViewRequirementAgentConnector_ms": 0.06676149368286133}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 288720, "num_agent_steps_trained": 288720, "num_env_steps_sampled": 288720, "num_env_steps_trained": 288720, "num_env_steps_sampled_this_iter": 1080, "num_env_steps_trained_this_iter": 1080, "num_env_steps_sampled_throughput_per_sec": 96.6215293925602, "num_env_steps_trained_throughput_per_sec": 96.6215293925602, "timesteps_total": 288720, "num_steps_trained_this_iter": 1080, "agent_timesteps_total": 288720, "timers": {"training_iteration_time_ms": 3754.979, "sample_time_ms": 3744.121, "load_time_ms": 0.302, "load_throughput": 1191845.797, "learn_time_ms": 9.796, "learn_throughput": 36748.891, "synch_weights_time_ms": 0.716}, "counters": {"num_env_steps_sampled": 288720, "num_env_steps_trained": 288720, "num_agent_steps_sampled": 288720, "num_agent_steps_trained": 288720}, "done": false, "episodes_total": 802, "training_iteration": 194, "trial_id": "f5e97_00000", "date": "2023-07-25_17-32-17", "timestamp": 1690295537, "time_this_iter_s": 11.180445909500122, "time_total_s": 2179.5231173038483, "pid": 71917, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[0, 0.003], [5400, 0.001], [10800, 0.00075], [16200, 0.0005], [21600, 0.00025], [27000, 0.0001], [32400, 7.5e-05], [37800, 5e-05], [43200, 2.5e-05], [48600, 1e-05], [54000, 7.5e-06], [59400, 5e-06], [64800, 2.5e-06], [70200, 1e-06], [75600, 5e-07], [81000, 1e-07]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x304530310>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 2179.5231173038483, "iterations_since_restore": 194, "perf": {"cpu_util_percent": 23.21875, "ram_util_percent": 74.88125}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-07, "entropy_coeff": 0.1, "policy_entropy": -926.699755859375, "policy_loss": -18101778685952.0, "vf_loss": 1119370214.4}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 4023.0, "diff_num_grad_updates_vs_sampler_policy": 4022.0}}, "num_env_steps_sampled": 289800, "num_env_steps_trained": 289800, "num_agent_steps_sampled": 289800, "num_agent_steps_trained": 289800}, "sampler_results": {"episode_reward_max": -25414.719522974952, "episode_reward_min": -26221.080968285096, "episode_reward_mean": -25732.876820101086, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-25568.18492252227, -25805.053352658015, -25883.35886329001, -25682.835904245807, -25841.339528843495, -25579.16663414852, -25718.715107068834, -25578.875325985005, -25487.58692978545, -25414.719522974952, -25723.553788502933, -25585.66285204171, -25814.780497934556, -25728.28886222714, -25546.758528639086, -25827.759630908404, -25646.95840681918, -25603.08863441588, -25679.40343150969, -25653.952587061678, -25729.454126294324, -25820.777574148327, -25577.758394328685, -25722.621822540772, -25571.184965224078, -25749.786517622135, -25608.69988687303, -25925.974049098433, -25539.057099478276, -25596.79683226327, -25622.161893088214, -25876.521107760094, -25507.75601831933, -25524.510201494908, -25870.264431711148, -25910.29466817855, -25668.07480176664, -25797.259392343632, -25887.599220216056, -25703.255399059504, -25677.12392159334, -25625.12973631695, -25704.57869605525, -25780.019251437523, -25616.88429238699, -25778.305144746893, -25973.67069342046, -25789.92903695543, -25648.23063258596, -25695.332373001038, -25942.65228394119, -25879.525464621925, -25791.18376139029, -25682.366610749825, -25685.13526267443, -25882.94915352667, -25819.908971322835, -25591.504031611414, -25858.368016171105, -25982.257781431064, -25756.018227783792, -26087.989014943934, -25616.646028094816, -25671.89855006249, -25574.665229375463, -25563.20354253552, -25682.20293968738, -25920.276278298647, -25774.75753201078, -25730.65833925668, -25846.76267862341, -26069.937320547575, -25691.9268035718, -25597.66725120839, -25753.678386930853, -25828.416214827008, -25556.145271007263, -25653.540648596365, -25626.876813574327, -25815.059498911414, -25785.900387605372, -25698.53410722529, -25928.935350527194, -25648.660592112356, -25709.853949220374, -25778.270231027287, -25804.044500571126, -25788.505674960164, -25511.44172742615, -25745.478053700404, -25637.039752774257, -25660.410542506863, -26221.080968285096, -25984.879269157755, -25893.435676587505, -25537.43144166211, -25893.649341129778, -25690.228753314994, -25611.200227393896, -25955.468063740438], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.242644143404853, "mean_inference_ms": 0.2857736395021421, "mean_action_processing_ms": 0.06828784982234262, "mean_env_wait_ms": 1.7250406334649453, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0035135746002197266, "StateBufferConnector_ms": 0.00269317626953125, "ViewRequirementAgentConnector_ms": 0.06674623489379883}}, "episode_reward_max": -25414.719522974952, "episode_reward_min": -26221.080968285096, "episode_reward_mean": -25732.876820101086, "episode_len_mean": 360.0, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-25568.18492252227, -25805.053352658015, -25883.35886329001, -25682.835904245807, -25841.339528843495, -25579.16663414852, -25718.715107068834, -25578.875325985005, -25487.58692978545, -25414.719522974952, -25723.553788502933, -25585.66285204171, -25814.780497934556, -25728.28886222714, -25546.758528639086, -25827.759630908404, -25646.95840681918, -25603.08863441588, -25679.40343150969, -25653.952587061678, -25729.454126294324, -25820.777574148327, -25577.758394328685, -25722.621822540772, -25571.184965224078, -25749.786517622135, -25608.69988687303, -25925.974049098433, -25539.057099478276, -25596.79683226327, -25622.161893088214, -25876.521107760094, -25507.75601831933, -25524.510201494908, -25870.264431711148, -25910.29466817855, -25668.07480176664, -25797.259392343632, -25887.599220216056, -25703.255399059504, -25677.12392159334, -25625.12973631695, -25704.57869605525, -25780.019251437523, -25616.88429238699, -25778.305144746893, -25973.67069342046, -25789.92903695543, -25648.23063258596, -25695.332373001038, -25942.65228394119, -25879.525464621925, -25791.18376139029, -25682.366610749825, -25685.13526267443, -25882.94915352667, -25819.908971322835, -25591.504031611414, -25858.368016171105, -25982.257781431064, -25756.018227783792, -26087.989014943934, -25616.646028094816, -25671.89855006249, -25574.665229375463, -25563.20354253552, -25682.20293968738, -25920.276278298647, -25774.75753201078, -25730.65833925668, -25846.76267862341, -26069.937320547575, -25691.9268035718, -25597.66725120839, -25753.678386930853, -25828.416214827008, -25556.145271007263, -25653.540648596365, -25626.876813574327, -25815.059498911414, -25785.900387605372, -25698.53410722529, -25928.935350527194, -25648.660592112356, -25709.853949220374, -25778.270231027287, -25804.044500571126, -25788.505674960164, -25511.44172742615, -25745.478053700404, -25637.039752774257, -25660.410542506863, -26221.080968285096, -25984.879269157755, -25893.435676587505, -25537.43144166211, -25893.649341129778, -25690.228753314994, -25611.200227393896, -25955.468063740438], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.242644143404853, "mean_inference_ms": 0.2857736395021421, "mean_action_processing_ms": 0.06828784982234262, "mean_env_wait_ms": 1.7250406334649453, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0035135746002197266, "StateBufferConnector_ms": 0.00269317626953125, "ViewRequirementAgentConnector_ms": 0.06674623489379883}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 289800, "num_agent_steps_trained": 289800, "num_env_steps_sampled": 289800, "num_env_steps_trained": 289800, "num_env_steps_sampled_this_iter": 1080, "num_env_steps_trained_this_iter": 1080, "num_env_steps_sampled_throughput_per_sec": 95.17338829342833, "num_env_steps_trained_throughput_per_sec": 95.17338829342833, "timesteps_total": 289800, "num_steps_trained_this_iter": 1080, "agent_timesteps_total": 289800, "timers": {"training_iteration_time_ms": 3755.389, "sample_time_ms": 3743.085, "load_time_ms": 0.304, "load_throughput": 1184274.071, "learn_time_ms": 10.101, "learn_throughput": 35641.015, "synch_weights_time_ms": 1.854}, "counters": {"num_env_steps_sampled": 289800, "num_env_steps_trained": 289800, "num_agent_steps_sampled": 289800, "num_agent_steps_trained": 289800}, "done": false, "episodes_total": 805, "training_iteration": 195, "trial_id": "f5e97_00000", "date": "2023-07-25_17-32-28", "timestamp": 1690295548, "time_this_iter_s": 11.3506019115448, "time_total_s": 2190.873719215393, "pid": 71917, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[0, 0.003], [5400, 0.001], [10800, 0.00075], [16200, 0.0005], [21600, 0.00025], [27000, 0.0001], [32400, 7.5e-05], [37800, 5e-05], [43200, 2.5e-05], [48600, 1e-05], [54000, 7.5e-06], [59400, 5e-06], [64800, 2.5e-06], [70200, 1e-06], [75600, 5e-07], [81000, 1e-07]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x304530310>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 2190.873719215393, "iterations_since_restore": 195, "perf": {"cpu_util_percent": 25.41875, "ram_util_percent": 74.7}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-07, "entropy_coeff": 0.1, "policy_entropy": -926.6996215820312, "policy_loss": -14643089956864.0, "vf_loss": 1124183321.6}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 4038.0, "diff_num_grad_updates_vs_sampler_policy": 4037.0}}, "num_env_steps_sampled": 290880, "num_env_steps_trained": 290880, "num_agent_steps_sampled": 290880, "num_agent_steps_trained": 290880}, "sampler_results": {"episode_reward_max": -25414.719522974952, "episode_reward_min": -26221.080968285096, "episode_reward_mean": -25729.86205622585, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-25682.835904245807, -25841.339528843495, -25579.16663414852, -25718.715107068834, -25578.875325985005, -25487.58692978545, -25414.719522974952, -25723.553788502933, -25585.66285204171, -25814.780497934556, -25728.28886222714, -25546.758528639086, -25827.759630908404, -25646.95840681918, -25603.08863441588, -25679.40343150969, -25653.952587061678, -25729.454126294324, -25820.777574148327, -25577.758394328685, -25722.621822540772, -25571.184965224078, -25749.786517622135, -25608.69988687303, -25925.974049098433, -25539.057099478276, -25596.79683226327, -25622.161893088214, -25876.521107760094, -25507.75601831933, -25524.510201494908, -25870.264431711148, -25910.29466817855, -25668.07480176664, -25797.259392343632, -25887.599220216056, -25703.255399059504, -25677.12392159334, -25625.12973631695, -25704.57869605525, -25780.019251437523, -25616.88429238699, -25778.305144746893, -25973.67069342046, -25789.92903695543, -25648.23063258596, -25695.332373001038, -25942.65228394119, -25879.525464621925, -25791.18376139029, -25682.366610749825, -25685.13526267443, -25882.94915352667, -25819.908971322835, -25591.504031611414, -25858.368016171105, -25982.257781431064, -25756.018227783792, -26087.989014943934, -25616.646028094816, -25671.89855006249, -25574.665229375463, -25563.20354253552, -25682.20293968738, -25920.276278298647, -25774.75753201078, -25730.65833925668, -25846.76267862341, -26069.937320547575, -25691.9268035718, -25597.66725120839, -25753.678386930853, -25828.416214827008, -25556.145271007263, -25653.540648596365, -25626.876813574327, -25815.059498911414, -25785.900387605372, -25698.53410722529, -25928.935350527194, -25648.660592112356, -25709.853949220374, -25778.270231027287, -25804.044500571126, -25788.505674960164, -25511.44172742615, -25745.478053700404, -25637.039752774257, -25660.410542506863, -26221.080968285096, -25984.879269157755, -25893.435676587505, -25537.43144166211, -25893.649341129778, -25690.228753314994, -25611.200227393896, -25955.468063740438, -25463.58364467552, -25499.687162698836, -25991.849943571677], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.251593258340602, "mean_inference_ms": 0.2861704954709129, "mean_action_processing_ms": 0.06838692411567361, "mean_env_wait_ms": 1.7278667294174306, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0035119056701660156, "StateBufferConnector_ms": 0.002694845199584961, "ViewRequirementAgentConnector_ms": 0.06671857833862305}}, "episode_reward_max": -25414.719522974952, "episode_reward_min": -26221.080968285096, "episode_reward_mean": -25729.86205622585, "episode_len_mean": 360.0, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-25682.835904245807, -25841.339528843495, -25579.16663414852, -25718.715107068834, -25578.875325985005, -25487.58692978545, -25414.719522974952, -25723.553788502933, -25585.66285204171, -25814.780497934556, -25728.28886222714, -25546.758528639086, -25827.759630908404, -25646.95840681918, -25603.08863441588, -25679.40343150969, -25653.952587061678, -25729.454126294324, -25820.777574148327, -25577.758394328685, -25722.621822540772, -25571.184965224078, -25749.786517622135, -25608.69988687303, -25925.974049098433, -25539.057099478276, -25596.79683226327, -25622.161893088214, -25876.521107760094, -25507.75601831933, -25524.510201494908, -25870.264431711148, -25910.29466817855, -25668.07480176664, -25797.259392343632, -25887.599220216056, -25703.255399059504, -25677.12392159334, -25625.12973631695, -25704.57869605525, -25780.019251437523, -25616.88429238699, -25778.305144746893, -25973.67069342046, -25789.92903695543, -25648.23063258596, -25695.332373001038, -25942.65228394119, -25879.525464621925, -25791.18376139029, -25682.366610749825, -25685.13526267443, -25882.94915352667, -25819.908971322835, -25591.504031611414, -25858.368016171105, -25982.257781431064, -25756.018227783792, -26087.989014943934, -25616.646028094816, -25671.89855006249, -25574.665229375463, -25563.20354253552, -25682.20293968738, -25920.276278298647, -25774.75753201078, -25730.65833925668, -25846.76267862341, -26069.937320547575, -25691.9268035718, -25597.66725120839, -25753.678386930853, -25828.416214827008, -25556.145271007263, -25653.540648596365, -25626.876813574327, -25815.059498911414, -25785.900387605372, -25698.53410722529, -25928.935350527194, -25648.660592112356, -25709.853949220374, -25778.270231027287, -25804.044500571126, -25788.505674960164, -25511.44172742615, -25745.478053700404, -25637.039752774257, -25660.410542506863, -26221.080968285096, -25984.879269157755, -25893.435676587505, -25537.43144166211, -25893.649341129778, -25690.228753314994, -25611.200227393896, -25955.468063740438, -25463.58364467552, -25499.687162698836, -25991.849943571677], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.251593258340602, "mean_inference_ms": 0.2861704954709129, "mean_action_processing_ms": 0.06838692411567361, "mean_env_wait_ms": 1.7278667294174306, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0035119056701660156, "StateBufferConnector_ms": 0.002694845199584961, "ViewRequirementAgentConnector_ms": 0.06671857833862305}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 290880, "num_agent_steps_trained": 290880, "num_env_steps_sampled": 290880, "num_env_steps_trained": 290880, "num_env_steps_sampled_this_iter": 1080, "num_env_steps_trained_this_iter": 1080, "num_env_steps_sampled_throughput_per_sec": 95.69198266991853, "num_env_steps_trained_throughput_per_sec": 95.69198266991853, "timesteps_total": 290880, "num_steps_trained_this_iter": 1080, "agent_timesteps_total": 290880, "timers": {"training_iteration_time_ms": 3750.55, "sample_time_ms": 3738.199, "load_time_ms": 0.299, "load_throughput": 1204010.398, "learn_time_ms": 10.15, "learn_throughput": 35468.885, "synch_weights_time_ms": 1.857}, "counters": {"num_env_steps_sampled": 290880, "num_env_steps_trained": 290880, "num_agent_steps_sampled": 290880, "num_agent_steps_trained": 290880}, "done": false, "episodes_total": 808, "training_iteration": 196, "trial_id": "f5e97_00000", "date": "2023-07-25_17-32-39", "timestamp": 1690295559, "time_this_iter_s": 11.28895902633667, "time_total_s": 2202.1626782417297, "pid": 71917, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[0, 0.003], [5400, 0.001], [10800, 0.00075], [16200, 0.0005], [21600, 0.00025], [27000, 0.0001], [32400, 7.5e-05], [37800, 5e-05], [43200, 2.5e-05], [48600, 1e-05], [54000, 7.5e-06], [59400, 5e-06], [64800, 2.5e-06], [70200, 1e-06], [75600, 5e-07], [81000, 1e-07]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x304530310>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 2202.1626782417297, "iterations_since_restore": 196, "perf": {"cpu_util_percent": 26.731250000000003, "ram_util_percent": 74.51875}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-07, "entropy_coeff": 0.1, "policy_entropy": -926.699658203125, "policy_loss": -24212872735129.6, "vf_loss": 1124347020.8}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 4053.0, "diff_num_grad_updates_vs_sampler_policy": 4052.0}}, "num_env_steps_sampled": 291960, "num_env_steps_trained": 291960, "num_agent_steps_sampled": 291960, "num_agent_steps_trained": 291960}, "sampler_results": {"episode_reward_max": -25414.719522974952, "episode_reward_min": -26221.080968285096, "episode_reward_mean": -25741.68010377778, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-25718.715107068834, -25578.875325985005, -25487.58692978545, -25414.719522974952, -25723.553788502933, -25585.66285204171, -25814.780497934556, -25728.28886222714, -25546.758528639086, -25827.759630908404, -25646.95840681918, -25603.08863441588, -25679.40343150969, -25653.952587061678, -25729.454126294324, -25820.777574148327, -25577.758394328685, -25722.621822540772, -25571.184965224078, -25749.786517622135, -25608.69988687303, -25925.974049098433, -25539.057099478276, -25596.79683226327, -25622.161893088214, -25876.521107760094, -25507.75601831933, -25524.510201494908, -25870.264431711148, -25910.29466817855, -25668.07480176664, -25797.259392343632, -25887.599220216056, -25703.255399059504, -25677.12392159334, -25625.12973631695, -25704.57869605525, -25780.019251437523, -25616.88429238699, -25778.305144746893, -25973.67069342046, -25789.92903695543, -25648.23063258596, -25695.332373001038, -25942.65228394119, -25879.525464621925, -25791.18376139029, -25682.366610749825, -25685.13526267443, -25882.94915352667, -25819.908971322835, -25591.504031611414, -25858.368016171105, -25982.257781431064, -25756.018227783792, -26087.989014943934, -25616.646028094816, -25671.89855006249, -25574.665229375463, -25563.20354253552, -25682.20293968738, -25920.276278298647, -25774.75753201078, -25730.65833925668, -25846.76267862341, -26069.937320547575, -25691.9268035718, -25597.66725120839, -25753.678386930853, -25828.416214827008, -25556.145271007263, -25653.540648596365, -25626.876813574327, -25815.059498911414, -25785.900387605372, -25698.53410722529, -25928.935350527194, -25648.660592112356, -25709.853949220374, -25778.270231027287, -25804.044500571126, -25788.505674960164, -25511.44172742615, -25745.478053700404, -25637.039752774257, -25660.410542506863, -26221.080968285096, -25984.879269157755, -25893.435676587505, -25537.43144166211, -25893.649341129778, -25690.228753314994, -25611.200227393896, -25955.468063740438, -25463.58364467552, -25499.687162698836, -25991.849943571677, -26137.11117551645, -26151.304917348447, -25996.730729566603], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.260463474979911, "mean_inference_ms": 0.2865635540294399, "mean_action_processing_ms": 0.06848511325203688, "mean_env_wait_ms": 1.730666793653857, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003510713577270508, "StateBufferConnector_ms": 0.002701997756958008, "ViewRequirementAgentConnector_ms": 0.06692171096801758}}, "episode_reward_max": -25414.719522974952, "episode_reward_min": -26221.080968285096, "episode_reward_mean": -25741.68010377778, "episode_len_mean": 360.0, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-25718.715107068834, -25578.875325985005, -25487.58692978545, -25414.719522974952, -25723.553788502933, -25585.66285204171, -25814.780497934556, -25728.28886222714, -25546.758528639086, -25827.759630908404, -25646.95840681918, -25603.08863441588, -25679.40343150969, -25653.952587061678, -25729.454126294324, -25820.777574148327, -25577.758394328685, -25722.621822540772, -25571.184965224078, -25749.786517622135, -25608.69988687303, -25925.974049098433, -25539.057099478276, -25596.79683226327, -25622.161893088214, -25876.521107760094, -25507.75601831933, -25524.510201494908, -25870.264431711148, -25910.29466817855, -25668.07480176664, -25797.259392343632, -25887.599220216056, -25703.255399059504, -25677.12392159334, -25625.12973631695, -25704.57869605525, -25780.019251437523, -25616.88429238699, -25778.305144746893, -25973.67069342046, -25789.92903695543, -25648.23063258596, -25695.332373001038, -25942.65228394119, -25879.525464621925, -25791.18376139029, -25682.366610749825, -25685.13526267443, -25882.94915352667, -25819.908971322835, -25591.504031611414, -25858.368016171105, -25982.257781431064, -25756.018227783792, -26087.989014943934, -25616.646028094816, -25671.89855006249, -25574.665229375463, -25563.20354253552, -25682.20293968738, -25920.276278298647, -25774.75753201078, -25730.65833925668, -25846.76267862341, -26069.937320547575, -25691.9268035718, -25597.66725120839, -25753.678386930853, -25828.416214827008, -25556.145271007263, -25653.540648596365, -25626.876813574327, -25815.059498911414, -25785.900387605372, -25698.53410722529, -25928.935350527194, -25648.660592112356, -25709.853949220374, -25778.270231027287, -25804.044500571126, -25788.505674960164, -25511.44172742615, -25745.478053700404, -25637.039752774257, -25660.410542506863, -26221.080968285096, -25984.879269157755, -25893.435676587505, -25537.43144166211, -25893.649341129778, -25690.228753314994, -25611.200227393896, -25955.468063740438, -25463.58364467552, -25499.687162698836, -25991.849943571677, -26137.11117551645, -26151.304917348447, -25996.730729566603], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.260463474979911, "mean_inference_ms": 0.2865635540294399, "mean_action_processing_ms": 0.06848511325203688, "mean_env_wait_ms": 1.730666793653857, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003510713577270508, "StateBufferConnector_ms": 0.002701997756958008, "ViewRequirementAgentConnector_ms": 0.06692171096801758}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 291960, "num_agent_steps_trained": 291960, "num_env_steps_sampled": 291960, "num_env_steps_trained": 291960, "num_env_steps_sampled_this_iter": 1080, "num_env_steps_trained_this_iter": 1080, "num_env_steps_sampled_throughput_per_sec": 96.19781685654125, "num_env_steps_trained_throughput_per_sec": 96.19781685654125, "timesteps_total": 291960, "num_steps_trained_this_iter": 1080, "agent_timesteps_total": 291960, "timers": {"training_iteration_time_ms": 3742.747, "sample_time_ms": 3730.402, "load_time_ms": 0.299, "load_throughput": 1204778.936, "learn_time_ms": 10.138, "learn_throughput": 35508.421, "synch_weights_time_ms": 1.863}, "counters": {"num_env_steps_sampled": 291960, "num_env_steps_trained": 291960, "num_agent_steps_sampled": 291960, "num_agent_steps_trained": 291960}, "done": false, "episodes_total": 811, "training_iteration": 197, "trial_id": "f5e97_00000", "date": "2023-07-25_17-32-50", "timestamp": 1690295570, "time_this_iter_s": 11.230064153671265, "time_total_s": 2213.392742395401, "pid": 71917, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[0, 0.003], [5400, 0.001], [10800, 0.00075], [16200, 0.0005], [21600, 0.00025], [27000, 0.0001], [32400, 7.5e-05], [37800, 5e-05], [43200, 2.5e-05], [48600, 1e-05], [54000, 7.5e-06], [59400, 5e-06], [64800, 2.5e-06], [70200, 1e-06], [75600, 5e-07], [81000, 1e-07]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x304530310>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 2213.392742395401, "iterations_since_restore": 197, "perf": {"cpu_util_percent": 23.45, "ram_util_percent": 74.55}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-07, "entropy_coeff": 0.1, "policy_entropy": -926.6997314453125, "policy_loss": -21680627979059.2, "vf_loss": 1107745030.4}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 4068.0, "diff_num_grad_updates_vs_sampler_policy": 4067.0}}, "num_env_steps_sampled": 293040, "num_env_steps_trained": 293040, "num_agent_steps_sampled": 293040, "num_agent_steps_trained": 293040}, "sampler_results": {"episode_reward_max": -25414.719522974952, "episode_reward_min": -26221.080968285096, "episode_reward_mean": -25749.302397319752, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-25414.719522974952, -25723.553788502933, -25585.66285204171, -25814.780497934556, -25728.28886222714, -25546.758528639086, -25827.759630908404, -25646.95840681918, -25603.08863441588, -25679.40343150969, -25653.952587061678, -25729.454126294324, -25820.777574148327, -25577.758394328685, -25722.621822540772, -25571.184965224078, -25749.786517622135, -25608.69988687303, -25925.974049098433, -25539.057099478276, -25596.79683226327, -25622.161893088214, -25876.521107760094, -25507.75601831933, -25524.510201494908, -25870.264431711148, -25910.29466817855, -25668.07480176664, -25797.259392343632, -25887.599220216056, -25703.255399059504, -25677.12392159334, -25625.12973631695, -25704.57869605525, -25780.019251437523, -25616.88429238699, -25778.305144746893, -25973.67069342046, -25789.92903695543, -25648.23063258596, -25695.332373001038, -25942.65228394119, -25879.525464621925, -25791.18376139029, -25682.366610749825, -25685.13526267443, -25882.94915352667, -25819.908971322835, -25591.504031611414, -25858.368016171105, -25982.257781431064, -25756.018227783792, -26087.989014943934, -25616.646028094816, -25671.89855006249, -25574.665229375463, -25563.20354253552, -25682.20293968738, -25920.276278298647, -25774.75753201078, -25730.65833925668, -25846.76267862341, -26069.937320547575, -25691.9268035718, -25597.66725120839, -25753.678386930853, -25828.416214827008, -25556.145271007263, -25653.540648596365, -25626.876813574327, -25815.059498911414, -25785.900387605372, -25698.53410722529, -25928.935350527194, -25648.660592112356, -25709.853949220374, -25778.270231027287, -25804.044500571126, -25788.505674960164, -25511.44172742615, -25745.478053700404, -25637.039752774257, -25660.410542506863, -26221.080968285096, -25984.879269157755, -25893.435676587505, -25537.43144166211, -25893.649341129778, -25690.228753314994, -25611.200227393896, -25955.468063740438, -25463.58364467552, -25499.687162698836, -25991.849943571677, -26137.11117551645, -26151.304917348447, -25996.730729566603, -25914.53315627779, -25786.585052919683, -25846.28850783948], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.2692599447561825, "mean_inference_ms": 0.2869539355913988, "mean_action_processing_ms": 0.06858266365294968, "mean_env_wait_ms": 1.7334409971828952, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0035135746002197266, "StateBufferConnector_ms": 0.0026984214782714844, "ViewRequirementAgentConnector_ms": 0.06690049171447754}}, "episode_reward_max": -25414.719522974952, "episode_reward_min": -26221.080968285096, "episode_reward_mean": -25749.302397319752, "episode_len_mean": 360.0, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-25414.719522974952, -25723.553788502933, -25585.66285204171, -25814.780497934556, -25728.28886222714, -25546.758528639086, -25827.759630908404, -25646.95840681918, -25603.08863441588, -25679.40343150969, -25653.952587061678, -25729.454126294324, -25820.777574148327, -25577.758394328685, -25722.621822540772, -25571.184965224078, -25749.786517622135, -25608.69988687303, -25925.974049098433, -25539.057099478276, -25596.79683226327, -25622.161893088214, -25876.521107760094, -25507.75601831933, -25524.510201494908, -25870.264431711148, -25910.29466817855, -25668.07480176664, -25797.259392343632, -25887.599220216056, -25703.255399059504, -25677.12392159334, -25625.12973631695, -25704.57869605525, -25780.019251437523, -25616.88429238699, -25778.305144746893, -25973.67069342046, -25789.92903695543, -25648.23063258596, -25695.332373001038, -25942.65228394119, -25879.525464621925, -25791.18376139029, -25682.366610749825, -25685.13526267443, -25882.94915352667, -25819.908971322835, -25591.504031611414, -25858.368016171105, -25982.257781431064, -25756.018227783792, -26087.989014943934, -25616.646028094816, -25671.89855006249, -25574.665229375463, -25563.20354253552, -25682.20293968738, -25920.276278298647, -25774.75753201078, -25730.65833925668, -25846.76267862341, -26069.937320547575, -25691.9268035718, -25597.66725120839, -25753.678386930853, -25828.416214827008, -25556.145271007263, -25653.540648596365, -25626.876813574327, -25815.059498911414, -25785.900387605372, -25698.53410722529, -25928.935350527194, -25648.660592112356, -25709.853949220374, -25778.270231027287, -25804.044500571126, -25788.505674960164, -25511.44172742615, -25745.478053700404, -25637.039752774257, -25660.410542506863, -26221.080968285096, -25984.879269157755, -25893.435676587505, -25537.43144166211, -25893.649341129778, -25690.228753314994, -25611.200227393896, -25955.468063740438, -25463.58364467552, -25499.687162698836, -25991.849943571677, -26137.11117551645, -26151.304917348447, -25996.730729566603, -25914.53315627779, -25786.585052919683, -25846.28850783948], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.2692599447561825, "mean_inference_ms": 0.2869539355913988, "mean_action_processing_ms": 0.06858266365294968, "mean_env_wait_ms": 1.7334409971828952, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0035135746002197266, "StateBufferConnector_ms": 0.0026984214782714844, "ViewRequirementAgentConnector_ms": 0.06690049171447754}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 293040, "num_agent_steps_trained": 293040, "num_env_steps_sampled": 293040, "num_env_steps_trained": 293040, "num_env_steps_sampled_this_iter": 1080, "num_env_steps_trained_this_iter": 1080, "num_env_steps_sampled_throughput_per_sec": 95.44022773432926, "num_env_steps_trained_throughput_per_sec": 95.44022773432926, "timesteps_total": 293040, "num_steps_trained_this_iter": 1080, "agent_timesteps_total": 293040, "timers": {"training_iteration_time_ms": 3737.956, "sample_time_ms": 3727.149, "load_time_ms": 0.298, "load_throughput": 1206897.482, "learn_time_ms": 9.764, "learn_throughput": 36868.861, "synch_weights_time_ms": 0.701}, "counters": {"num_env_steps_sampled": 293040, "num_env_steps_trained": 293040, "num_agent_steps_sampled": 293040, "num_agent_steps_trained": 293040}, "done": false, "episodes_total": 814, "training_iteration": 198, "trial_id": "f5e97_00000", "date": "2023-07-25_17-33-02", "timestamp": 1690295582, "time_this_iter_s": 11.318958044052124, "time_total_s": 2224.711700439453, "pid": 71917, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[0, 0.003], [5400, 0.001], [10800, 0.00075], [16200, 0.0005], [21600, 0.00025], [27000, 0.0001], [32400, 7.5e-05], [37800, 5e-05], [43200, 2.5e-05], [48600, 1e-05], [54000, 7.5e-06], [59400, 5e-06], [64800, 2.5e-06], [70200, 1e-06], [75600, 5e-07], [81000, 1e-07]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x304530310>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 2224.711700439453, "iterations_since_restore": 198, "perf": {"cpu_util_percent": 23.46875, "ram_util_percent": 74.49375}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-07, "entropy_coeff": 0.1, "policy_entropy": -926.699658203125, "policy_loss": -37349380202496.0, "vf_loss": 1121163468.8}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 4083.0, "diff_num_grad_updates_vs_sampler_policy": 4082.0}}, "num_env_steps_sampled": 294120, "num_env_steps_trained": 294120, "num_agent_steps_sampled": 294120, "num_agent_steps_trained": 294120}, "sampler_results": {"episode_reward_max": -25463.58364467552, "episode_reward_min": -26221.080968285096, "episode_reward_mean": -25756.565326447842, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-25814.780497934556, -25728.28886222714, -25546.758528639086, -25827.759630908404, -25646.95840681918, -25603.08863441588, -25679.40343150969, -25653.952587061678, -25729.454126294324, -25820.777574148327, -25577.758394328685, -25722.621822540772, -25571.184965224078, -25749.786517622135, -25608.69988687303, -25925.974049098433, -25539.057099478276, -25596.79683226327, -25622.161893088214, -25876.521107760094, -25507.75601831933, -25524.510201494908, -25870.264431711148, -25910.29466817855, -25668.07480176664, -25797.259392343632, -25887.599220216056, -25703.255399059504, -25677.12392159334, -25625.12973631695, -25704.57869605525, -25780.019251437523, -25616.88429238699, -25778.305144746893, -25973.67069342046, -25789.92903695543, -25648.23063258596, -25695.332373001038, -25942.65228394119, -25879.525464621925, -25791.18376139029, -25682.366610749825, -25685.13526267443, -25882.94915352667, -25819.908971322835, -25591.504031611414, -25858.368016171105, -25982.257781431064, -25756.018227783792, -26087.989014943934, -25616.646028094816, -25671.89855006249, -25574.665229375463, -25563.20354253552, -25682.20293968738, -25920.276278298647, -25774.75753201078, -25730.65833925668, -25846.76267862341, -26069.937320547575, -25691.9268035718, -25597.66725120839, -25753.678386930853, -25828.416214827008, -25556.145271007263, -25653.540648596365, -25626.876813574327, -25815.059498911414, -25785.900387605372, -25698.53410722529, -25928.935350527194, -25648.660592112356, -25709.853949220374, -25778.270231027287, -25804.044500571126, -25788.505674960164, -25511.44172742615, -25745.478053700404, -25637.039752774257, -25660.410542506863, -26221.080968285096, -25984.879269157755, -25893.435676587505, -25537.43144166211, -25893.649341129778, -25690.228753314994, -25611.200227393896, -25955.468063740438, -25463.58364467552, -25499.687162698836, -25991.849943571677, -26137.11117551645, -26151.304917348447, -25996.730729566603, -25914.53315627779, -25786.585052919683, -25846.28850783948, -25783.832028025026, -25627.677232823353, -26038.719815479228], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.277988304801622, "mean_inference_ms": 0.2873402439301979, "mean_action_processing_ms": 0.06867929106930969, "mean_env_wait_ms": 1.7361795485158151, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0035190582275390625, "StateBufferConnector_ms": 0.002688884735107422, "ViewRequirementAgentConnector_ms": 0.06693673133850098}}, "episode_reward_max": -25463.58364467552, "episode_reward_min": -26221.080968285096, "episode_reward_mean": -25756.565326447842, "episode_len_mean": 360.0, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-25814.780497934556, -25728.28886222714, -25546.758528639086, -25827.759630908404, -25646.95840681918, -25603.08863441588, -25679.40343150969, -25653.952587061678, -25729.454126294324, -25820.777574148327, -25577.758394328685, -25722.621822540772, -25571.184965224078, -25749.786517622135, -25608.69988687303, -25925.974049098433, -25539.057099478276, -25596.79683226327, -25622.161893088214, -25876.521107760094, -25507.75601831933, -25524.510201494908, -25870.264431711148, -25910.29466817855, -25668.07480176664, -25797.259392343632, -25887.599220216056, -25703.255399059504, -25677.12392159334, -25625.12973631695, -25704.57869605525, -25780.019251437523, -25616.88429238699, -25778.305144746893, -25973.67069342046, -25789.92903695543, -25648.23063258596, -25695.332373001038, -25942.65228394119, -25879.525464621925, -25791.18376139029, -25682.366610749825, -25685.13526267443, -25882.94915352667, -25819.908971322835, -25591.504031611414, -25858.368016171105, -25982.257781431064, -25756.018227783792, -26087.989014943934, -25616.646028094816, -25671.89855006249, -25574.665229375463, -25563.20354253552, -25682.20293968738, -25920.276278298647, -25774.75753201078, -25730.65833925668, -25846.76267862341, -26069.937320547575, -25691.9268035718, -25597.66725120839, -25753.678386930853, -25828.416214827008, -25556.145271007263, -25653.540648596365, -25626.876813574327, -25815.059498911414, -25785.900387605372, -25698.53410722529, -25928.935350527194, -25648.660592112356, -25709.853949220374, -25778.270231027287, -25804.044500571126, -25788.505674960164, -25511.44172742615, -25745.478053700404, -25637.039752774257, -25660.410542506863, -26221.080968285096, -25984.879269157755, -25893.435676587505, -25537.43144166211, -25893.649341129778, -25690.228753314994, -25611.200227393896, -25955.468063740438, -25463.58364467552, -25499.687162698836, -25991.849943571677, -26137.11117551645, -26151.304917348447, -25996.730729566603, -25914.53315627779, -25786.585052919683, -25846.28850783948, -25783.832028025026, -25627.677232823353, -26038.719815479228], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.277988304801622, "mean_inference_ms": 0.2873402439301979, "mean_action_processing_ms": 0.06867929106930969, "mean_env_wait_ms": 1.7361795485158151, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0035190582275390625, "StateBufferConnector_ms": 0.002688884735107422, "ViewRequirementAgentConnector_ms": 0.06693673133850098}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 294120, "num_agent_steps_trained": 294120, "num_env_steps_sampled": 294120, "num_env_steps_trained": 294120, "num_env_steps_sampled_this_iter": 1080, "num_env_steps_trained_this_iter": 1080, "num_env_steps_sampled_throughput_per_sec": 95.86343916461168, "num_env_steps_trained_throughput_per_sec": 95.86343916461168, "timesteps_total": 294120, "num_steps_trained_this_iter": 1080, "agent_timesteps_total": 294120, "timers": {"training_iteration_time_ms": 3744.851, "sample_time_ms": 3734.109, "load_time_ms": 0.297, "load_throughput": 1211642.947, "learn_time_ms": 9.706, "learn_throughput": 37092.295, "synch_weights_time_ms": 0.697}, "counters": {"num_env_steps_sampled": 294120, "num_env_steps_trained": 294120, "num_agent_steps_sampled": 294120, "num_agent_steps_trained": 294120}, "done": false, "episodes_total": 817, "training_iteration": 199, "trial_id": "f5e97_00000", "date": "2023-07-25_17-33-13", "timestamp": 1690295593, "time_this_iter_s": 11.268931150436401, "time_total_s": 2235.9806315898895, "pid": 71917, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[0, 0.003], [5400, 0.001], [10800, 0.00075], [16200, 0.0005], [21600, 0.00025], [27000, 0.0001], [32400, 7.5e-05], [37800, 5e-05], [43200, 2.5e-05], [48600, 1e-05], [54000, 7.5e-06], [59400, 5e-06], [64800, 2.5e-06], [70200, 1e-06], [75600, 5e-07], [81000, 1e-07]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x304530310>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 2235.9806315898895, "iterations_since_restore": 199, "perf": {"cpu_util_percent": 22.26875, "ram_util_percent": 74.51875000000001}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-07, "entropy_coeff": 0.1, "policy_entropy": -926.6995727539063, "policy_loss": -17951018601676.8, "vf_loss": 1117747616.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 4098.0, "diff_num_grad_updates_vs_sampler_policy": 4097.0}}, "num_env_steps_sampled": 295200, "num_env_steps_trained": 295200, "num_agent_steps_sampled": 295200, "num_agent_steps_trained": 295200}, "sampler_results": {"episode_reward_max": -25463.58364467552, "episode_reward_min": -26221.080968285096, "episode_reward_mean": -25760.627367116213, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-25827.759630908404, -25646.95840681918, -25603.08863441588, -25679.40343150969, -25653.952587061678, -25729.454126294324, -25820.777574148327, -25577.758394328685, -25722.621822540772, -25571.184965224078, -25749.786517622135, -25608.69988687303, -25925.974049098433, -25539.057099478276, -25596.79683226327, -25622.161893088214, -25876.521107760094, -25507.75601831933, -25524.510201494908, -25870.264431711148, -25910.29466817855, -25668.07480176664, -25797.259392343632, -25887.599220216056, -25703.255399059504, -25677.12392159334, -25625.12973631695, -25704.57869605525, -25780.019251437523, -25616.88429238699, -25778.305144746893, -25973.67069342046, -25789.92903695543, -25648.23063258596, -25695.332373001038, -25942.65228394119, -25879.525464621925, -25791.18376139029, -25682.366610749825, -25685.13526267443, -25882.94915352667, -25819.908971322835, -25591.504031611414, -25858.368016171105, -25982.257781431064, -25756.018227783792, -26087.989014943934, -25616.646028094816, -25671.89855006249, -25574.665229375463, -25563.20354253552, -25682.20293968738, -25920.276278298647, -25774.75753201078, -25730.65833925668, -25846.76267862341, -26069.937320547575, -25691.9268035718, -25597.66725120839, -25753.678386930853, -25828.416214827008, -25556.145271007263, -25653.540648596365, -25626.876813574327, -25815.059498911414, -25785.900387605372, -25698.53410722529, -25928.935350527194, -25648.660592112356, -25709.853949220374, -25778.270231027287, -25804.044500571126, -25788.505674960164, -25511.44172742615, -25745.478053700404, -25637.039752774257, -25660.410542506863, -26221.080968285096, -25984.879269157755, -25893.435676587505, -25537.43144166211, -25893.649341129778, -25690.228753314994, -25611.200227393896, -25955.468063740438, -25463.58364467552, -25499.687162698836, -25991.849943571677, -26137.11117551645, -26151.304917348447, -25996.730729566603, -25914.53315627779, -25786.585052919683, -25846.28850783948, -25783.832028025026, -25627.677232823353, -26038.719815479228, -25635.922737428984, -25868.508312975722, -25991.60090523408], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.286632091506176, "mean_inference_ms": 0.28772270925842225, "mean_action_processing_ms": 0.06877503502227057, "mean_env_wait_ms": 1.7389022849574227, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003521442413330078, "StateBufferConnector_ms": 0.002692699432373047, "ViewRequirementAgentConnector_ms": 0.06695055961608887}}, "episode_reward_max": -25463.58364467552, "episode_reward_min": -26221.080968285096, "episode_reward_mean": -25760.627367116213, "episode_len_mean": 360.0, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-25827.759630908404, -25646.95840681918, -25603.08863441588, -25679.40343150969, -25653.952587061678, -25729.454126294324, -25820.777574148327, -25577.758394328685, -25722.621822540772, -25571.184965224078, -25749.786517622135, -25608.69988687303, -25925.974049098433, -25539.057099478276, -25596.79683226327, -25622.161893088214, -25876.521107760094, -25507.75601831933, -25524.510201494908, -25870.264431711148, -25910.29466817855, -25668.07480176664, -25797.259392343632, -25887.599220216056, -25703.255399059504, -25677.12392159334, -25625.12973631695, -25704.57869605525, -25780.019251437523, -25616.88429238699, -25778.305144746893, -25973.67069342046, -25789.92903695543, -25648.23063258596, -25695.332373001038, -25942.65228394119, -25879.525464621925, -25791.18376139029, -25682.366610749825, -25685.13526267443, -25882.94915352667, -25819.908971322835, -25591.504031611414, -25858.368016171105, -25982.257781431064, -25756.018227783792, -26087.989014943934, -25616.646028094816, -25671.89855006249, -25574.665229375463, -25563.20354253552, -25682.20293968738, -25920.276278298647, -25774.75753201078, -25730.65833925668, -25846.76267862341, -26069.937320547575, -25691.9268035718, -25597.66725120839, -25753.678386930853, -25828.416214827008, -25556.145271007263, -25653.540648596365, -25626.876813574327, -25815.059498911414, -25785.900387605372, -25698.53410722529, -25928.935350527194, -25648.660592112356, -25709.853949220374, -25778.270231027287, -25804.044500571126, -25788.505674960164, -25511.44172742615, -25745.478053700404, -25637.039752774257, -25660.410542506863, -26221.080968285096, -25984.879269157755, -25893.435676587505, -25537.43144166211, -25893.649341129778, -25690.228753314994, -25611.200227393896, -25955.468063740438, -25463.58364467552, -25499.687162698836, -25991.849943571677, -26137.11117551645, -26151.304917348447, -25996.730729566603, -25914.53315627779, -25786.585052919683, -25846.28850783948, -25783.832028025026, -25627.677232823353, -26038.719815479228, -25635.922737428984, -25868.508312975722, -25991.60090523408], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.286632091506176, "mean_inference_ms": 0.28772270925842225, "mean_action_processing_ms": 0.06877503502227057, "mean_env_wait_ms": 1.7389022849574227, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003521442413330078, "StateBufferConnector_ms": 0.002692699432373047, "ViewRequirementAgentConnector_ms": 0.06695055961608887}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 295200, "num_agent_steps_trained": 295200, "num_env_steps_sampled": 295200, "num_env_steps_trained": 295200, "num_env_steps_sampled_this_iter": 1080, "num_env_steps_trained_this_iter": 1080, "num_env_steps_sampled_throughput_per_sec": 95.84797468987064, "num_env_steps_trained_throughput_per_sec": 95.84797468987064, "timesteps_total": 295200, "num_steps_trained_this_iter": 1080, "agent_timesteps_total": 295200, "timers": {"training_iteration_time_ms": 3762.955, "sample_time_ms": 3752.198, "load_time_ms": 0.297, "load_throughput": 1212518.622, "learn_time_ms": 9.715, "learn_throughput": 37056.156, "synch_weights_time_ms": 0.702}, "counters": {"num_env_steps_sampled": 295200, "num_env_steps_trained": 295200, "num_agent_steps_sampled": 295200, "num_agent_steps_trained": 295200}, "done": false, "episodes_total": 820, "training_iteration": 200, "trial_id": "f5e97_00000", "date": "2023-07-25_17-33-24", "timestamp": 1690295604, "time_this_iter_s": 11.270691871643066, "time_total_s": 2247.2513234615326, "pid": 71917, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[0, 0.003], [5400, 0.001], [10800, 0.00075], [16200, 0.0005], [21600, 0.00025], [27000, 0.0001], [32400, 7.5e-05], [37800, 5e-05], [43200, 2.5e-05], [48600, 1e-05], [54000, 7.5e-06], [59400, 5e-06], [64800, 2.5e-06], [70200, 1e-06], [75600, 5e-07], [81000, 1e-07]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x304530310>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 2247.2513234615326, "iterations_since_restore": 200, "perf": {"cpu_util_percent": 23.53125, "ram_util_percent": 74.6375}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-07, "entropy_coeff": 0.1, "policy_entropy": -926.6997192382812, "policy_loss": -12648635877376.0, "vf_loss": 1101660659.2}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 4113.0, "diff_num_grad_updates_vs_sampler_policy": 4112.0}}, "num_env_steps_sampled": 296280, "num_env_steps_trained": 296280, "num_agent_steps_sampled": 296280, "num_agent_steps_trained": 296280}, "sampler_results": {"episode_reward_max": -25463.58364467552, "episode_reward_min": -26221.080968285096, "episode_reward_mean": -25762.335456963894, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-25679.40343150969, -25653.952587061678, -25729.454126294324, -25820.777574148327, -25577.758394328685, -25722.621822540772, -25571.184965224078, -25749.786517622135, -25608.69988687303, -25925.974049098433, -25539.057099478276, -25596.79683226327, -25622.161893088214, -25876.521107760094, -25507.75601831933, -25524.510201494908, -25870.264431711148, -25910.29466817855, -25668.07480176664, -25797.259392343632, -25887.599220216056, -25703.255399059504, -25677.12392159334, -25625.12973631695, -25704.57869605525, -25780.019251437523, -25616.88429238699, -25778.305144746893, -25973.67069342046, -25789.92903695543, -25648.23063258596, -25695.332373001038, -25942.65228394119, -25879.525464621925, -25791.18376139029, -25682.366610749825, -25685.13526267443, -25882.94915352667, -25819.908971322835, -25591.504031611414, -25858.368016171105, -25982.257781431064, -25756.018227783792, -26087.989014943934, -25616.646028094816, -25671.89855006249, -25574.665229375463, -25563.20354253552, -25682.20293968738, -25920.276278298647, -25774.75753201078, -25730.65833925668, -25846.76267862341, -26069.937320547575, -25691.9268035718, -25597.66725120839, -25753.678386930853, -25828.416214827008, -25556.145271007263, -25653.540648596365, -25626.876813574327, -25815.059498911414, -25785.900387605372, -25698.53410722529, -25928.935350527194, -25648.660592112356, -25709.853949220374, -25778.270231027287, -25804.044500571126, -25788.505674960164, -25511.44172742615, -25745.478053700404, -25637.039752774257, -25660.410542506863, -26221.080968285096, -25984.879269157755, -25893.435676587505, -25537.43144166211, -25893.649341129778, -25690.228753314994, -25611.200227393896, -25955.468063740438, -25463.58364467552, -25499.687162698836, -25991.849943571677, -26137.11117551645, -26151.304917348447, -25996.730729566603, -25914.53315627779, -25786.585052919683, -25846.28850783948, -25783.832028025026, -25627.677232823353, -26038.719815479228, -25635.922737428984, -25868.508312975722, -25991.60090523408, -25657.920462761886, -25756.19734831615, -25834.497845832582], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.295187567760661, "mean_inference_ms": 0.28810236426433206, "mean_action_processing_ms": 0.0688701360474938, "mean_env_wait_ms": 1.7416065245473595, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0035219192504882812, "StateBufferConnector_ms": 0.0026960372924804688, "ViewRequirementAgentConnector_ms": 0.06697916984558105}}, "episode_reward_max": -25463.58364467552, "episode_reward_min": -26221.080968285096, "episode_reward_mean": -25762.335456963894, "episode_len_mean": 360.0, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-25679.40343150969, -25653.952587061678, -25729.454126294324, -25820.777574148327, -25577.758394328685, -25722.621822540772, -25571.184965224078, -25749.786517622135, -25608.69988687303, -25925.974049098433, -25539.057099478276, -25596.79683226327, -25622.161893088214, -25876.521107760094, -25507.75601831933, -25524.510201494908, -25870.264431711148, -25910.29466817855, -25668.07480176664, -25797.259392343632, -25887.599220216056, -25703.255399059504, -25677.12392159334, -25625.12973631695, -25704.57869605525, -25780.019251437523, -25616.88429238699, -25778.305144746893, -25973.67069342046, -25789.92903695543, -25648.23063258596, -25695.332373001038, -25942.65228394119, -25879.525464621925, -25791.18376139029, -25682.366610749825, -25685.13526267443, -25882.94915352667, -25819.908971322835, -25591.504031611414, -25858.368016171105, -25982.257781431064, -25756.018227783792, -26087.989014943934, -25616.646028094816, -25671.89855006249, -25574.665229375463, -25563.20354253552, -25682.20293968738, -25920.276278298647, -25774.75753201078, -25730.65833925668, -25846.76267862341, -26069.937320547575, -25691.9268035718, -25597.66725120839, -25753.678386930853, -25828.416214827008, -25556.145271007263, -25653.540648596365, -25626.876813574327, -25815.059498911414, -25785.900387605372, -25698.53410722529, -25928.935350527194, -25648.660592112356, -25709.853949220374, -25778.270231027287, -25804.044500571126, -25788.505674960164, -25511.44172742615, -25745.478053700404, -25637.039752774257, -25660.410542506863, -26221.080968285096, -25984.879269157755, -25893.435676587505, -25537.43144166211, -25893.649341129778, -25690.228753314994, -25611.200227393896, -25955.468063740438, -25463.58364467552, -25499.687162698836, -25991.849943571677, -26137.11117551645, -26151.304917348447, -25996.730729566603, -25914.53315627779, -25786.585052919683, -25846.28850783948, -25783.832028025026, -25627.677232823353, -26038.719815479228, -25635.922737428984, -25868.508312975722, -25991.60090523408, -25657.920462761886, -25756.19734831615, -25834.497845832582], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.295187567760661, "mean_inference_ms": 0.28810236426433206, "mean_action_processing_ms": 0.0688701360474938, "mean_env_wait_ms": 1.7416065245473595, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0035219192504882812, "StateBufferConnector_ms": 0.0026960372924804688, "ViewRequirementAgentConnector_ms": 0.06697916984558105}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 296280, "num_agent_steps_trained": 296280, "num_env_steps_sampled": 296280, "num_env_steps_trained": 296280, "num_env_steps_sampled_this_iter": 1080, "num_env_steps_trained_this_iter": 1080, "num_env_steps_sampled_throughput_per_sec": 96.72517148260268, "num_env_steps_trained_throughput_per_sec": 96.72517148260268, "timesteps_total": 296280, "num_steps_trained_this_iter": 1080, "agent_timesteps_total": 296280, "timers": {"training_iteration_time_ms": 3756.932, "sample_time_ms": 3745.959, "load_time_ms": 0.305, "load_throughput": 1180478.024, "learn_time_ms": 9.92, "learn_throughput": 36291.365, "synch_weights_time_ms": 0.705}, "counters": {"num_env_steps_sampled": 296280, "num_env_steps_trained": 296280, "num_agent_steps_sampled": 296280, "num_agent_steps_trained": 296280}, "done": false, "episodes_total": 823, "training_iteration": 201, "trial_id": "f5e97_00000", "date": "2023-07-25_17-33-36", "timestamp": 1690295616, "time_this_iter_s": 11.168517112731934, "time_total_s": 2258.4198405742645, "pid": 71917, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[0, 0.003], [5400, 0.001], [10800, 0.00075], [16200, 0.0005], [21600, 0.00025], [27000, 0.0001], [32400, 7.5e-05], [37800, 5e-05], [43200, 2.5e-05], [48600, 1e-05], [54000, 7.5e-06], [59400, 5e-06], [64800, 2.5e-06], [70200, 1e-06], [75600, 5e-07], [81000, 1e-07]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x304530310>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 2258.4198405742645, "iterations_since_restore": 201, "perf": {"cpu_util_percent": 25.24375, "ram_util_percent": 74.5875}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-07, "entropy_coeff": 0.1, "policy_entropy": -926.6996826171875, "policy_loss": -11809128977203.2, "vf_loss": 1109563724.8}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 4128.0, "diff_num_grad_updates_vs_sampler_policy": 4127.0}}, "num_env_steps_sampled": 297360, "num_env_steps_trained": 297360, "num_agent_steps_sampled": 297360, "num_agent_steps_trained": 297360}, "sampler_results": {"episode_reward_max": -25463.58364467552, "episode_reward_min": -26221.080968285096, "episode_reward_mean": -25762.52578380525, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-25820.777574148327, -25577.758394328685, -25722.621822540772, -25571.184965224078, -25749.786517622135, -25608.69988687303, -25925.974049098433, -25539.057099478276, -25596.79683226327, -25622.161893088214, -25876.521107760094, -25507.75601831933, -25524.510201494908, -25870.264431711148, -25910.29466817855, -25668.07480176664, -25797.259392343632, -25887.599220216056, -25703.255399059504, -25677.12392159334, -25625.12973631695, -25704.57869605525, -25780.019251437523, -25616.88429238699, -25778.305144746893, -25973.67069342046, -25789.92903695543, -25648.23063258596, -25695.332373001038, -25942.65228394119, -25879.525464621925, -25791.18376139029, -25682.366610749825, -25685.13526267443, -25882.94915352667, -25819.908971322835, -25591.504031611414, -25858.368016171105, -25982.257781431064, -25756.018227783792, -26087.989014943934, -25616.646028094816, -25671.89855006249, -25574.665229375463, -25563.20354253552, -25682.20293968738, -25920.276278298647, -25774.75753201078, -25730.65833925668, -25846.76267862341, -26069.937320547575, -25691.9268035718, -25597.66725120839, -25753.678386930853, -25828.416214827008, -25556.145271007263, -25653.540648596365, -25626.876813574327, -25815.059498911414, -25785.900387605372, -25698.53410722529, -25928.935350527194, -25648.660592112356, -25709.853949220374, -25778.270231027287, -25804.044500571126, -25788.505674960164, -25511.44172742615, -25745.478053700404, -25637.039752774257, -25660.410542506863, -26221.080968285096, -25984.879269157755, -25893.435676587505, -25537.43144166211, -25893.649341129778, -25690.228753314994, -25611.200227393896, -25955.468063740438, -25463.58364467552, -25499.687162698836, -25991.849943571677, -26137.11117551645, -26151.304917348447, -25996.730729566603, -25914.53315627779, -25786.585052919683, -25846.28850783948, -25783.832028025026, -25627.677232823353, -26038.719815479228, -25635.922737428984, -25868.508312975722, -25991.60090523408, -25657.920462761886, -25756.19734831615, -25834.497845832582, -25624.406599402155, -25623.049176246823, -25834.387053352883], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.30366939573453, "mean_inference_ms": 0.2884787034314766, "mean_action_processing_ms": 0.06896444443264899, "mean_env_wait_ms": 1.7442844546308414, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0035202503204345703, "StateBufferConnector_ms": 0.0026967525482177734, "ViewRequirementAgentConnector_ms": 0.0670011043548584}}, "episode_reward_max": -25463.58364467552, "episode_reward_min": -26221.080968285096, "episode_reward_mean": -25762.52578380525, "episode_len_mean": 360.0, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-25820.777574148327, -25577.758394328685, -25722.621822540772, -25571.184965224078, -25749.786517622135, -25608.69988687303, -25925.974049098433, -25539.057099478276, -25596.79683226327, -25622.161893088214, -25876.521107760094, -25507.75601831933, -25524.510201494908, -25870.264431711148, -25910.29466817855, -25668.07480176664, -25797.259392343632, -25887.599220216056, -25703.255399059504, -25677.12392159334, -25625.12973631695, -25704.57869605525, -25780.019251437523, -25616.88429238699, -25778.305144746893, -25973.67069342046, -25789.92903695543, -25648.23063258596, -25695.332373001038, -25942.65228394119, -25879.525464621925, -25791.18376139029, -25682.366610749825, -25685.13526267443, -25882.94915352667, -25819.908971322835, -25591.504031611414, -25858.368016171105, -25982.257781431064, -25756.018227783792, -26087.989014943934, -25616.646028094816, -25671.89855006249, -25574.665229375463, -25563.20354253552, -25682.20293968738, -25920.276278298647, -25774.75753201078, -25730.65833925668, -25846.76267862341, -26069.937320547575, -25691.9268035718, -25597.66725120839, -25753.678386930853, -25828.416214827008, -25556.145271007263, -25653.540648596365, -25626.876813574327, -25815.059498911414, -25785.900387605372, -25698.53410722529, -25928.935350527194, -25648.660592112356, -25709.853949220374, -25778.270231027287, -25804.044500571126, -25788.505674960164, -25511.44172742615, -25745.478053700404, -25637.039752774257, -25660.410542506863, -26221.080968285096, -25984.879269157755, -25893.435676587505, -25537.43144166211, -25893.649341129778, -25690.228753314994, -25611.200227393896, -25955.468063740438, -25463.58364467552, -25499.687162698836, -25991.849943571677, -26137.11117551645, -26151.304917348447, -25996.730729566603, -25914.53315627779, -25786.585052919683, -25846.28850783948, -25783.832028025026, -25627.677232823353, -26038.719815479228, -25635.922737428984, -25868.508312975722, -25991.60090523408, -25657.920462761886, -25756.19734831615, -25834.497845832582, -25624.406599402155, -25623.049176246823, -25834.387053352883], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.30366939573453, "mean_inference_ms": 0.2884787034314766, "mean_action_processing_ms": 0.06896444443264899, "mean_env_wait_ms": 1.7442844546308414, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0035202503204345703, "StateBufferConnector_ms": 0.0026967525482177734, "ViewRequirementAgentConnector_ms": 0.0670011043548584}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 297360, "num_agent_steps_trained": 297360, "num_env_steps_sampled": 297360, "num_env_steps_trained": 297360, "num_env_steps_sampled_this_iter": 1080, "num_env_steps_trained_this_iter": 1080, "num_env_steps_sampled_throughput_per_sec": 96.89387658322784, "num_env_steps_trained_throughput_per_sec": 96.89387658322784, "timesteps_total": 297360, "num_steps_trained_this_iter": 1080, "agent_timesteps_total": 297360, "timers": {"training_iteration_time_ms": 3744.981, "sample_time_ms": 3734.001, "load_time_ms": 0.308, "load_throughput": 1169234.505, "learn_time_ms": 9.915, "learn_throughput": 36309.43, "synch_weights_time_ms": 0.713}, "counters": {"num_env_steps_sampled": 297360, "num_env_steps_trained": 297360, "num_agent_steps_sampled": 297360, "num_agent_steps_trained": 297360}, "done": false, "episodes_total": 826, "training_iteration": 202, "trial_id": "f5e97_00000", "date": "2023-07-25_17-33-47", "timestamp": 1690295627, "time_this_iter_s": 11.149011850357056, "time_total_s": 2269.5688524246216, "pid": 71917, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[0, 0.003], [5400, 0.001], [10800, 0.00075], [16200, 0.0005], [21600, 0.00025], [27000, 0.0001], [32400, 7.5e-05], [37800, 5e-05], [43200, 2.5e-05], [48600, 1e-05], [54000, 7.5e-06], [59400, 5e-06], [64800, 2.5e-06], [70200, 1e-06], [75600, 5e-07], [81000, 1e-07]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x304530310>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 2269.5688524246216, "iterations_since_restore": 202, "perf": {"cpu_util_percent": 26.78125, "ram_util_percent": 74.675}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-07, "entropy_coeff": 0.1, "policy_entropy": -926.6999755859375, "policy_loss": -31756345280102.4, "vf_loss": 1093763763.2}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 4143.0, "diff_num_grad_updates_vs_sampler_policy": 4142.0}}, "num_env_steps_sampled": 298440, "num_env_steps_trained": 298440, "num_agent_steps_sampled": 298440, "num_agent_steps_trained": 298440}, "sampler_results": {"episode_reward_max": -25463.58364467552, "episode_reward_min": -26221.080968285096, "episode_reward_mean": -25763.84871341889, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-25571.184965224078, -25749.786517622135, -25608.69988687303, -25925.974049098433, -25539.057099478276, -25596.79683226327, -25622.161893088214, -25876.521107760094, -25507.75601831933, -25524.510201494908, -25870.264431711148, -25910.29466817855, -25668.07480176664, -25797.259392343632, -25887.599220216056, -25703.255399059504, -25677.12392159334, -25625.12973631695, -25704.57869605525, -25780.019251437523, -25616.88429238699, -25778.305144746893, -25973.67069342046, -25789.92903695543, -25648.23063258596, -25695.332373001038, -25942.65228394119, -25879.525464621925, -25791.18376139029, -25682.366610749825, -25685.13526267443, -25882.94915352667, -25819.908971322835, -25591.504031611414, -25858.368016171105, -25982.257781431064, -25756.018227783792, -26087.989014943934, -25616.646028094816, -25671.89855006249, -25574.665229375463, -25563.20354253552, -25682.20293968738, -25920.276278298647, -25774.75753201078, -25730.65833925668, -25846.76267862341, -26069.937320547575, -25691.9268035718, -25597.66725120839, -25753.678386930853, -25828.416214827008, -25556.145271007263, -25653.540648596365, -25626.876813574327, -25815.059498911414, -25785.900387605372, -25698.53410722529, -25928.935350527194, -25648.660592112356, -25709.853949220374, -25778.270231027287, -25804.044500571126, -25788.505674960164, -25511.44172742615, -25745.478053700404, -25637.039752774257, -25660.410542506863, -26221.080968285096, -25984.879269157755, -25893.435676587505, -25537.43144166211, -25893.649341129778, -25690.228753314994, -25611.200227393896, -25955.468063740438, -25463.58364467552, -25499.687162698836, -25991.849943571677, -26137.11117551645, -26151.304917348447, -25996.730729566603, -25914.53315627779, -25786.585052919683, -25846.28850783948, -25783.832028025026, -25627.677232823353, -26038.719815479228, -25635.922737428984, -25868.508312975722, -25991.60090523408, -25657.920462761886, -25756.19734831615, -25834.497845832582, -25624.406599402155, -25623.049176246823, -25834.387053352883, -25867.29379257149, -25643.505537482684, -25742.651422327574], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.31209445847477, "mean_inference_ms": 0.2888522873666651, "mean_action_processing_ms": 0.06905802384696667, "mean_env_wait_ms": 1.746934131883105, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003530263900756836, "StateBufferConnector_ms": 0.002699136734008789, "ViewRequirementAgentConnector_ms": 0.0670928955078125}}, "episode_reward_max": -25463.58364467552, "episode_reward_min": -26221.080968285096, "episode_reward_mean": -25763.84871341889, "episode_len_mean": 360.0, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-25571.184965224078, -25749.786517622135, -25608.69988687303, -25925.974049098433, -25539.057099478276, -25596.79683226327, -25622.161893088214, -25876.521107760094, -25507.75601831933, -25524.510201494908, -25870.264431711148, -25910.29466817855, -25668.07480176664, -25797.259392343632, -25887.599220216056, -25703.255399059504, -25677.12392159334, -25625.12973631695, -25704.57869605525, -25780.019251437523, -25616.88429238699, -25778.305144746893, -25973.67069342046, -25789.92903695543, -25648.23063258596, -25695.332373001038, -25942.65228394119, -25879.525464621925, -25791.18376139029, -25682.366610749825, -25685.13526267443, -25882.94915352667, -25819.908971322835, -25591.504031611414, -25858.368016171105, -25982.257781431064, -25756.018227783792, -26087.989014943934, -25616.646028094816, -25671.89855006249, -25574.665229375463, -25563.20354253552, -25682.20293968738, -25920.276278298647, -25774.75753201078, -25730.65833925668, -25846.76267862341, -26069.937320547575, -25691.9268035718, -25597.66725120839, -25753.678386930853, -25828.416214827008, -25556.145271007263, -25653.540648596365, -25626.876813574327, -25815.059498911414, -25785.900387605372, -25698.53410722529, -25928.935350527194, -25648.660592112356, -25709.853949220374, -25778.270231027287, -25804.044500571126, -25788.505674960164, -25511.44172742615, -25745.478053700404, -25637.039752774257, -25660.410542506863, -26221.080968285096, -25984.879269157755, -25893.435676587505, -25537.43144166211, -25893.649341129778, -25690.228753314994, -25611.200227393896, -25955.468063740438, -25463.58364467552, -25499.687162698836, -25991.849943571677, -26137.11117551645, -26151.304917348447, -25996.730729566603, -25914.53315627779, -25786.585052919683, -25846.28850783948, -25783.832028025026, -25627.677232823353, -26038.719815479228, -25635.922737428984, -25868.508312975722, -25991.60090523408, -25657.920462761886, -25756.19734831615, -25834.497845832582, -25624.406599402155, -25623.049176246823, -25834.387053352883, -25867.29379257149, -25643.505537482684, -25742.651422327574], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.31209445847477, "mean_inference_ms": 0.2888522873666651, "mean_action_processing_ms": 0.06905802384696667, "mean_env_wait_ms": 1.746934131883105, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003530263900756836, "StateBufferConnector_ms": 0.002699136734008789, "ViewRequirementAgentConnector_ms": 0.0670928955078125}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 298440, "num_agent_steps_trained": 298440, "num_env_steps_sampled": 298440, "num_env_steps_trained": 298440, "num_env_steps_sampled_this_iter": 1080, "num_env_steps_trained_this_iter": 1080, "num_env_steps_sampled_throughput_per_sec": 95.72647734674344, "num_env_steps_trained_throughput_per_sec": 95.72647734674344, "timesteps_total": 298440, "num_steps_trained_this_iter": 1080, "agent_timesteps_total": 298440, "timers": {"training_iteration_time_ms": 3744.041, "sample_time_ms": 3733.005, "load_time_ms": 0.32, "load_throughput": 1126071.624, "learn_time_ms": 9.957, "learn_throughput": 36157.187, "synch_weights_time_ms": 0.711}, "counters": {"num_env_steps_sampled": 298440, "num_env_steps_trained": 298440, "num_agent_steps_sampled": 298440, "num_agent_steps_trained": 298440}, "done": false, "episodes_total": 829, "training_iteration": 203, "trial_id": "f5e97_00000", "date": "2023-07-25_17-33-58", "timestamp": 1690295638, "time_this_iter_s": 11.284933090209961, "time_total_s": 2280.8537855148315, "pid": 71917, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[0, 0.003], [5400, 0.001], [10800, 0.00075], [16200, 0.0005], [21600, 0.00025], [27000, 0.0001], [32400, 7.5e-05], [37800, 5e-05], [43200, 2.5e-05], [48600, 1e-05], [54000, 7.5e-06], [59400, 5e-06], [64800, 2.5e-06], [70200, 1e-06], [75600, 5e-07], [81000, 1e-07]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x304530310>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 2280.8537855148315, "iterations_since_restore": 203, "perf": {"cpu_util_percent": 24.98125, "ram_util_percent": 74.75}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-07, "entropy_coeff": 0.1, "policy_entropy": -926.699755859375, "policy_loss": -25000093863116.8, "vf_loss": 1104807891.2}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 4158.0, "diff_num_grad_updates_vs_sampler_policy": 4157.0}}, "num_env_steps_sampled": 299520, "num_env_steps_trained": 299520, "num_agent_steps_sampled": 299520, "num_agent_steps_trained": 299520}, "sampler_results": {"episode_reward_max": -25463.58364467552, "episode_reward_min": -26221.080968285096, "episode_reward_mean": -25768.26902804823, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-25925.974049098433, -25539.057099478276, -25596.79683226327, -25622.161893088214, -25876.521107760094, -25507.75601831933, -25524.510201494908, -25870.264431711148, -25910.29466817855, -25668.07480176664, -25797.259392343632, -25887.599220216056, -25703.255399059504, -25677.12392159334, -25625.12973631695, -25704.57869605525, -25780.019251437523, -25616.88429238699, -25778.305144746893, -25973.67069342046, -25789.92903695543, -25648.23063258596, -25695.332373001038, -25942.65228394119, -25879.525464621925, -25791.18376139029, -25682.366610749825, -25685.13526267443, -25882.94915352667, -25819.908971322835, -25591.504031611414, -25858.368016171105, -25982.257781431064, -25756.018227783792, -26087.989014943934, -25616.646028094816, -25671.89855006249, -25574.665229375463, -25563.20354253552, -25682.20293968738, -25920.276278298647, -25774.75753201078, -25730.65833925668, -25846.76267862341, -26069.937320547575, -25691.9268035718, -25597.66725120839, -25753.678386930853, -25828.416214827008, -25556.145271007263, -25653.540648596365, -25626.876813574327, -25815.059498911414, -25785.900387605372, -25698.53410722529, -25928.935350527194, -25648.660592112356, -25709.853949220374, -25778.270231027287, -25804.044500571126, -25788.505674960164, -25511.44172742615, -25745.478053700404, -25637.039752774257, -25660.410542506863, -26221.080968285096, -25984.879269157755, -25893.435676587505, -25537.43144166211, -25893.649341129778, -25690.228753314994, -25611.200227393896, -25955.468063740438, -25463.58364467552, -25499.687162698836, -25991.849943571677, -26137.11117551645, -26151.304917348447, -25996.730729566603, -25914.53315627779, -25786.585052919683, -25846.28850783948, -25783.832028025026, -25627.677232823353, -26038.719815479228, -25635.922737428984, -25868.508312975722, -25991.60090523408, -25657.920462761886, -25756.19734831615, -25834.497845832582, -25624.406599402155, -25623.049176246823, -25834.387053352883, -25867.29379257149, -25643.505537482684, -25742.651422327574, -25655.41416648919, -25868.80945227319, -25847.479213891227], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.320451275519414, "mean_inference_ms": 0.289222869573439, "mean_action_processing_ms": 0.06915090061849048, "mean_env_wait_ms": 1.749566330072768, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003525257110595703, "StateBufferConnector_ms": 0.0026962757110595703, "ViewRequirementAgentConnector_ms": 0.06698727607727051}}, "episode_reward_max": -25463.58364467552, "episode_reward_min": -26221.080968285096, "episode_reward_mean": -25768.26902804823, "episode_len_mean": 360.0, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-25925.974049098433, -25539.057099478276, -25596.79683226327, -25622.161893088214, -25876.521107760094, -25507.75601831933, -25524.510201494908, -25870.264431711148, -25910.29466817855, -25668.07480176664, -25797.259392343632, -25887.599220216056, -25703.255399059504, -25677.12392159334, -25625.12973631695, -25704.57869605525, -25780.019251437523, -25616.88429238699, -25778.305144746893, -25973.67069342046, -25789.92903695543, -25648.23063258596, -25695.332373001038, -25942.65228394119, -25879.525464621925, -25791.18376139029, -25682.366610749825, -25685.13526267443, -25882.94915352667, -25819.908971322835, -25591.504031611414, -25858.368016171105, -25982.257781431064, -25756.018227783792, -26087.989014943934, -25616.646028094816, -25671.89855006249, -25574.665229375463, -25563.20354253552, -25682.20293968738, -25920.276278298647, -25774.75753201078, -25730.65833925668, -25846.76267862341, -26069.937320547575, -25691.9268035718, -25597.66725120839, -25753.678386930853, -25828.416214827008, -25556.145271007263, -25653.540648596365, -25626.876813574327, -25815.059498911414, -25785.900387605372, -25698.53410722529, -25928.935350527194, -25648.660592112356, -25709.853949220374, -25778.270231027287, -25804.044500571126, -25788.505674960164, -25511.44172742615, -25745.478053700404, -25637.039752774257, -25660.410542506863, -26221.080968285096, -25984.879269157755, -25893.435676587505, -25537.43144166211, -25893.649341129778, -25690.228753314994, -25611.200227393896, -25955.468063740438, -25463.58364467552, -25499.687162698836, -25991.849943571677, -26137.11117551645, -26151.304917348447, -25996.730729566603, -25914.53315627779, -25786.585052919683, -25846.28850783948, -25783.832028025026, -25627.677232823353, -26038.719815479228, -25635.922737428984, -25868.508312975722, -25991.60090523408, -25657.920462761886, -25756.19734831615, -25834.497845832582, -25624.406599402155, -25623.049176246823, -25834.387053352883, -25867.29379257149, -25643.505537482684, -25742.651422327574, -25655.41416648919, -25868.80945227319, -25847.479213891227], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.320451275519414, "mean_inference_ms": 0.289222869573439, "mean_action_processing_ms": 0.06915090061849048, "mean_env_wait_ms": 1.749566330072768, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003525257110595703, "StateBufferConnector_ms": 0.0026962757110595703, "ViewRequirementAgentConnector_ms": 0.06698727607727051}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 299520, "num_agent_steps_trained": 299520, "num_env_steps_sampled": 299520, "num_env_steps_trained": 299520, "num_env_steps_sampled_this_iter": 1080, "num_env_steps_trained_this_iter": 1080, "num_env_steps_sampled_throughput_per_sec": 95.09130078171445, "num_env_steps_trained_throughput_per_sec": 95.09130078171445, "timesteps_total": 299520, "num_steps_trained_this_iter": 1080, "agent_timesteps_total": 299520, "timers": {"training_iteration_time_ms": 3748.452, "sample_time_ms": 3737.444, "load_time_ms": 0.32, "load_throughput": 1125232.461, "learn_time_ms": 9.912, "learn_throughput": 36320.348, "synch_weights_time_ms": 0.725}, "counters": {"num_env_steps_sampled": 299520, "num_env_steps_trained": 299520, "num_agent_steps_sampled": 299520, "num_agent_steps_trained": 299520}, "done": false, "episodes_total": 832, "training_iteration": 204, "trial_id": "f5e97_00000", "date": "2023-07-25_17-34-09", "timestamp": 1690295649, "time_this_iter_s": 11.360345840454102, "time_total_s": 2292.2141313552856, "pid": 71917, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[0, 0.003], [5400, 0.001], [10800, 0.00075], [16200, 0.0005], [21600, 0.00025], [27000, 0.0001], [32400, 7.5e-05], [37800, 5e-05], [43200, 2.5e-05], [48600, 1e-05], [54000, 7.5e-06], [59400, 5e-06], [64800, 2.5e-06], [70200, 1e-06], [75600, 5e-07], [81000, 1e-07]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x304530310>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 2292.2141313552856, "iterations_since_restore": 204, "perf": {"cpu_util_percent": 23.1875, "ram_util_percent": 74.75}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-07, "entropy_coeff": 0.1, "policy_entropy": -926.6999877929687, "policy_loss": -25700178093670.4, "vf_loss": 1099029184.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 4173.0, "diff_num_grad_updates_vs_sampler_policy": 4172.0}}, "num_env_steps_sampled": 300600, "num_env_steps_trained": 300600, "num_agent_steps_sampled": 300600, "num_agent_steps_trained": 300600}, "sampler_results": {"episode_reward_max": -25463.58364467552, "episode_reward_min": -26221.080968285096, "episode_reward_mean": -25769.90292118869, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-25622.161893088214, -25876.521107760094, -25507.75601831933, -25524.510201494908, -25870.264431711148, -25910.29466817855, -25668.07480176664, -25797.259392343632, -25887.599220216056, -25703.255399059504, -25677.12392159334, -25625.12973631695, -25704.57869605525, -25780.019251437523, -25616.88429238699, -25778.305144746893, -25973.67069342046, -25789.92903695543, -25648.23063258596, -25695.332373001038, -25942.65228394119, -25879.525464621925, -25791.18376139029, -25682.366610749825, -25685.13526267443, -25882.94915352667, -25819.908971322835, -25591.504031611414, -25858.368016171105, -25982.257781431064, -25756.018227783792, -26087.989014943934, -25616.646028094816, -25671.89855006249, -25574.665229375463, -25563.20354253552, -25682.20293968738, -25920.276278298647, -25774.75753201078, -25730.65833925668, -25846.76267862341, -26069.937320547575, -25691.9268035718, -25597.66725120839, -25753.678386930853, -25828.416214827008, -25556.145271007263, -25653.540648596365, -25626.876813574327, -25815.059498911414, -25785.900387605372, -25698.53410722529, -25928.935350527194, -25648.660592112356, -25709.853949220374, -25778.270231027287, -25804.044500571126, -25788.505674960164, -25511.44172742615, -25745.478053700404, -25637.039752774257, -25660.410542506863, -26221.080968285096, -25984.879269157755, -25893.435676587505, -25537.43144166211, -25893.649341129778, -25690.228753314994, -25611.200227393896, -25955.468063740438, -25463.58364467552, -25499.687162698836, -25991.849943571677, -26137.11117551645, -26151.304917348447, -25996.730729566603, -25914.53315627779, -25786.585052919683, -25846.28850783948, -25783.832028025026, -25627.677232823353, -26038.719815479228, -25635.922737428984, -25868.508312975722, -25991.60090523408, -25657.920462761886, -25756.19734831615, -25834.497845832582, -25624.406599402155, -25623.049176246823, -25834.387053352883, -25867.29379257149, -25643.505537482684, -25742.651422327574, -25655.41416648919, -25868.80945227319, -25847.479213891227, -25701.472246302383, -25777.462466382396, -25746.282582200427], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.32873542750798, "mean_inference_ms": 0.2895896801308796, "mean_action_processing_ms": 0.06924289488841823, "mean_env_wait_ms": 1.7521677172144938, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003522634506225586, "StateBufferConnector_ms": 0.0027074813842773438, "ViewRequirementAgentConnector_ms": 0.06704044342041016}}, "episode_reward_max": -25463.58364467552, "episode_reward_min": -26221.080968285096, "episode_reward_mean": -25769.90292118869, "episode_len_mean": 360.0, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-25622.161893088214, -25876.521107760094, -25507.75601831933, -25524.510201494908, -25870.264431711148, -25910.29466817855, -25668.07480176664, -25797.259392343632, -25887.599220216056, -25703.255399059504, -25677.12392159334, -25625.12973631695, -25704.57869605525, -25780.019251437523, -25616.88429238699, -25778.305144746893, -25973.67069342046, -25789.92903695543, -25648.23063258596, -25695.332373001038, -25942.65228394119, -25879.525464621925, -25791.18376139029, -25682.366610749825, -25685.13526267443, -25882.94915352667, -25819.908971322835, -25591.504031611414, -25858.368016171105, -25982.257781431064, -25756.018227783792, -26087.989014943934, -25616.646028094816, -25671.89855006249, -25574.665229375463, -25563.20354253552, -25682.20293968738, -25920.276278298647, -25774.75753201078, -25730.65833925668, -25846.76267862341, -26069.937320547575, -25691.9268035718, -25597.66725120839, -25753.678386930853, -25828.416214827008, -25556.145271007263, -25653.540648596365, -25626.876813574327, -25815.059498911414, -25785.900387605372, -25698.53410722529, -25928.935350527194, -25648.660592112356, -25709.853949220374, -25778.270231027287, -25804.044500571126, -25788.505674960164, -25511.44172742615, -25745.478053700404, -25637.039752774257, -25660.410542506863, -26221.080968285096, -25984.879269157755, -25893.435676587505, -25537.43144166211, -25893.649341129778, -25690.228753314994, -25611.200227393896, -25955.468063740438, -25463.58364467552, -25499.687162698836, -25991.849943571677, -26137.11117551645, -26151.304917348447, -25996.730729566603, -25914.53315627779, -25786.585052919683, -25846.28850783948, -25783.832028025026, -25627.677232823353, -26038.719815479228, -25635.922737428984, -25868.508312975722, -25991.60090523408, -25657.920462761886, -25756.19734831615, -25834.497845832582, -25624.406599402155, -25623.049176246823, -25834.387053352883, -25867.29379257149, -25643.505537482684, -25742.651422327574, -25655.41416648919, -25868.80945227319, -25847.479213891227, -25701.472246302383, -25777.462466382396, -25746.282582200427], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.32873542750798, "mean_inference_ms": 0.2895896801308796, "mean_action_processing_ms": 0.06924289488841823, "mean_env_wait_ms": 1.7521677172144938, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003522634506225586, "StateBufferConnector_ms": 0.0027074813842773438, "ViewRequirementAgentConnector_ms": 0.06704044342041016}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 300600, "num_agent_steps_trained": 300600, "num_env_steps_sampled": 300600, "num_env_steps_trained": 300600, "num_env_steps_sampled_this_iter": 1080, "num_env_steps_trained_this_iter": 1080, "num_env_steps_sampled_throughput_per_sec": 95.70276843153904, "num_env_steps_trained_throughput_per_sec": 95.70276843153904, "timesteps_total": 300600, "num_steps_trained_this_iter": 1080, "agent_timesteps_total": 300600, "timers": {"training_iteration_time_ms": 3755.21, "sample_time_ms": 3744.354, "load_time_ms": 0.309, "load_throughput": 1164545.303, "learn_time_ms": 9.767, "learn_throughput": 36857.161, "synch_weights_time_ms": 0.73}, "counters": {"num_env_steps_sampled": 300600, "num_env_steps_trained": 300600, "num_agent_steps_sampled": 300600, "num_agent_steps_trained": 300600}, "done": false, "episodes_total": 835, "training_iteration": 205, "trial_id": "f5e97_00000", "date": "2023-07-25_17-34-21", "timestamp": 1690295661, "time_this_iter_s": 11.287744045257568, "time_total_s": 2303.501875400543, "pid": 71917, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[0, 0.003], [5400, 0.001], [10800, 0.00075], [16200, 0.0005], [21600, 0.00025], [27000, 0.0001], [32400, 7.5e-05], [37800, 5e-05], [43200, 2.5e-05], [48600, 1e-05], [54000, 7.5e-06], [59400, 5e-06], [64800, 2.5e-06], [70200, 1e-06], [75600, 5e-07], [81000, 1e-07]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x304530310>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 2303.501875400543, "iterations_since_restore": 205, "perf": {"cpu_util_percent": 23.147058823529413, "ram_util_percent": 74.48823529411764}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-07, "entropy_coeff": 0.1, "policy_entropy": -926.699951171875, "policy_loss": -29816884967424.0, "vf_loss": 1101651500.8}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 4188.0, "diff_num_grad_updates_vs_sampler_policy": 4187.0}}, "num_env_steps_sampled": 301680, "num_env_steps_trained": 301680, "num_agent_steps_sampled": 301680, "num_agent_steps_trained": 301680}, "sampler_results": {"episode_reward_max": -25463.58364467552, "episode_reward_min": -26221.080968285096, "episode_reward_mean": -25774.910297690025, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-25524.510201494908, -25870.264431711148, -25910.29466817855, -25668.07480176664, -25797.259392343632, -25887.599220216056, -25703.255399059504, -25677.12392159334, -25625.12973631695, -25704.57869605525, -25780.019251437523, -25616.88429238699, -25778.305144746893, -25973.67069342046, -25789.92903695543, -25648.23063258596, -25695.332373001038, -25942.65228394119, -25879.525464621925, -25791.18376139029, -25682.366610749825, -25685.13526267443, -25882.94915352667, -25819.908971322835, -25591.504031611414, -25858.368016171105, -25982.257781431064, -25756.018227783792, -26087.989014943934, -25616.646028094816, -25671.89855006249, -25574.665229375463, -25563.20354253552, -25682.20293968738, -25920.276278298647, -25774.75753201078, -25730.65833925668, -25846.76267862341, -26069.937320547575, -25691.9268035718, -25597.66725120839, -25753.678386930853, -25828.416214827008, -25556.145271007263, -25653.540648596365, -25626.876813574327, -25815.059498911414, -25785.900387605372, -25698.53410722529, -25928.935350527194, -25648.660592112356, -25709.853949220374, -25778.270231027287, -25804.044500571126, -25788.505674960164, -25511.44172742615, -25745.478053700404, -25637.039752774257, -25660.410542506863, -26221.080968285096, -25984.879269157755, -25893.435676587505, -25537.43144166211, -25893.649341129778, -25690.228753314994, -25611.200227393896, -25955.468063740438, -25463.58364467552, -25499.687162698836, -25991.849943571677, -26137.11117551645, -26151.304917348447, -25996.730729566603, -25914.53315627779, -25786.585052919683, -25846.28850783948, -25783.832028025026, -25627.677232823353, -26038.719815479228, -25635.922737428984, -25868.508312975722, -25991.60090523408, -25657.920462761886, -25756.19734831615, -25834.497845832582, -25624.406599402155, -25623.049176246823, -25834.387053352883, -25867.29379257149, -25643.505537482684, -25742.651422327574, -25655.41416648919, -25868.80945227319, -25847.479213891227, -25701.472246302383, -25777.462466382396, -25746.282582200427, -25736.64438715656, -26000.001128408145, -25770.531153735996], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.3369486542762, "mean_inference_ms": 0.2899538447737094, "mean_action_processing_ms": 0.06933427774364617, "mean_env_wait_ms": 1.7547426941629154, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003526449203491211, "StateBufferConnector_ms": 0.002708911895751953, "ViewRequirementAgentConnector_ms": 0.06707978248596191}}, "episode_reward_max": -25463.58364467552, "episode_reward_min": -26221.080968285096, "episode_reward_mean": -25774.910297690025, "episode_len_mean": 360.0, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-25524.510201494908, -25870.264431711148, -25910.29466817855, -25668.07480176664, -25797.259392343632, -25887.599220216056, -25703.255399059504, -25677.12392159334, -25625.12973631695, -25704.57869605525, -25780.019251437523, -25616.88429238699, -25778.305144746893, -25973.67069342046, -25789.92903695543, -25648.23063258596, -25695.332373001038, -25942.65228394119, -25879.525464621925, -25791.18376139029, -25682.366610749825, -25685.13526267443, -25882.94915352667, -25819.908971322835, -25591.504031611414, -25858.368016171105, -25982.257781431064, -25756.018227783792, -26087.989014943934, -25616.646028094816, -25671.89855006249, -25574.665229375463, -25563.20354253552, -25682.20293968738, -25920.276278298647, -25774.75753201078, -25730.65833925668, -25846.76267862341, -26069.937320547575, -25691.9268035718, -25597.66725120839, -25753.678386930853, -25828.416214827008, -25556.145271007263, -25653.540648596365, -25626.876813574327, -25815.059498911414, -25785.900387605372, -25698.53410722529, -25928.935350527194, -25648.660592112356, -25709.853949220374, -25778.270231027287, -25804.044500571126, -25788.505674960164, -25511.44172742615, -25745.478053700404, -25637.039752774257, -25660.410542506863, -26221.080968285096, -25984.879269157755, -25893.435676587505, -25537.43144166211, -25893.649341129778, -25690.228753314994, -25611.200227393896, -25955.468063740438, -25463.58364467552, -25499.687162698836, -25991.849943571677, -26137.11117551645, -26151.304917348447, -25996.730729566603, -25914.53315627779, -25786.585052919683, -25846.28850783948, -25783.832028025026, -25627.677232823353, -26038.719815479228, -25635.922737428984, -25868.508312975722, -25991.60090523408, -25657.920462761886, -25756.19734831615, -25834.497845832582, -25624.406599402155, -25623.049176246823, -25834.387053352883, -25867.29379257149, -25643.505537482684, -25742.651422327574, -25655.41416648919, -25868.80945227319, -25847.479213891227, -25701.472246302383, -25777.462466382396, -25746.282582200427, -25736.64438715656, -26000.001128408145, -25770.531153735996], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.3369486542762, "mean_inference_ms": 0.2899538447737094, "mean_action_processing_ms": 0.06933427774364617, "mean_env_wait_ms": 1.7547426941629154, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003526449203491211, "StateBufferConnector_ms": 0.002708911895751953, "ViewRequirementAgentConnector_ms": 0.06707978248596191}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 301680, "num_agent_steps_trained": 301680, "num_env_steps_sampled": 301680, "num_env_steps_trained": 301680, "num_env_steps_sampled_this_iter": 1080, "num_env_steps_trained_this_iter": 1080, "num_env_steps_sampled_throughput_per_sec": 95.89740387085367, "num_env_steps_trained_throughput_per_sec": 95.89740387085367, "timesteps_total": 301680, "num_steps_trained_this_iter": 1080, "agent_timesteps_total": 301680, "timers": {"training_iteration_time_ms": 3749.668, "sample_time_ms": 3738.809, "load_time_ms": 0.309, "load_throughput": 1165984.124, "learn_time_ms": 9.779, "learn_throughput": 36813.31, "synch_weights_time_ms": 0.723}, "counters": {"num_env_steps_sampled": 301680, "num_env_steps_trained": 301680, "num_agent_steps_sampled": 301680, "num_agent_steps_trained": 301680}, "done": false, "episodes_total": 838, "training_iteration": 206, "trial_id": "f5e97_00000", "date": "2023-07-25_17-34-32", "timestamp": 1690295672, "time_this_iter_s": 11.26487398147583, "time_total_s": 2314.766749382019, "pid": 71917, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[0, 0.003], [5400, 0.001], [10800, 0.00075], [16200, 0.0005], [21600, 0.00025], [27000, 0.0001], [32400, 7.5e-05], [37800, 5e-05], [43200, 2.5e-05], [48600, 1e-05], [54000, 7.5e-06], [59400, 5e-06], [64800, 2.5e-06], [70200, 1e-06], [75600, 5e-07], [81000, 1e-07]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x304530310>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 2314.766749382019, "iterations_since_restore": 206, "perf": {"cpu_util_percent": 28.8625, "ram_util_percent": 74.2875}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-07, "entropy_coeff": 0.1, "policy_entropy": -926.7001342773438, "policy_loss": -15858565251072.0, "vf_loss": 1087475027.2}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 4203.0, "diff_num_grad_updates_vs_sampler_policy": 4202.0}}, "num_env_steps_sampled": 302760, "num_env_steps_trained": 302760, "num_agent_steps_sampled": 302760, "num_agent_steps_trained": 302760}, "sampler_results": {"episode_reward_max": -25463.58364467552, "episode_reward_min": -26221.080968285096, "episode_reward_mean": -25772.19121820357, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-25668.07480176664, -25797.259392343632, -25887.599220216056, -25703.255399059504, -25677.12392159334, -25625.12973631695, -25704.57869605525, -25780.019251437523, -25616.88429238699, -25778.305144746893, -25973.67069342046, -25789.92903695543, -25648.23063258596, -25695.332373001038, -25942.65228394119, -25879.525464621925, -25791.18376139029, -25682.366610749825, -25685.13526267443, -25882.94915352667, -25819.908971322835, -25591.504031611414, -25858.368016171105, -25982.257781431064, -25756.018227783792, -26087.989014943934, -25616.646028094816, -25671.89855006249, -25574.665229375463, -25563.20354253552, -25682.20293968738, -25920.276278298647, -25774.75753201078, -25730.65833925668, -25846.76267862341, -26069.937320547575, -25691.9268035718, -25597.66725120839, -25753.678386930853, -25828.416214827008, -25556.145271007263, -25653.540648596365, -25626.876813574327, -25815.059498911414, -25785.900387605372, -25698.53410722529, -25928.935350527194, -25648.660592112356, -25709.853949220374, -25778.270231027287, -25804.044500571126, -25788.505674960164, -25511.44172742615, -25745.478053700404, -25637.039752774257, -25660.410542506863, -26221.080968285096, -25984.879269157755, -25893.435676587505, -25537.43144166211, -25893.649341129778, -25690.228753314994, -25611.200227393896, -25955.468063740438, -25463.58364467552, -25499.687162698836, -25991.849943571677, -26137.11117551645, -26151.304917348447, -25996.730729566603, -25914.53315627779, -25786.585052919683, -25846.28850783948, -25783.832028025026, -25627.677232823353, -26038.719815479228, -25635.922737428984, -25868.508312975722, -25991.60090523408, -25657.920462761886, -25756.19734831615, -25834.497845832582, -25624.406599402155, -25623.049176246823, -25834.387053352883, -25867.29379257149, -25643.505537482684, -25742.651422327574, -25655.41416648919, -25868.80945227319, -25847.479213891227, -25701.472246302383, -25777.462466382396, -25746.282582200427, -25736.64438715656, -26000.001128408145, -25770.531153735996, -25562.446197956648, -25885.57919387728, -25585.13596090559], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.3450961244789195, "mean_inference_ms": 0.2903152560326333, "mean_action_processing_ms": 0.06942503459279864, "mean_env_wait_ms": 1.7572939241644343, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003530263900756836, "StateBufferConnector_ms": 0.0027065277099609375, "ViewRequirementAgentConnector_ms": 0.06716322898864746}}, "episode_reward_max": -25463.58364467552, "episode_reward_min": -26221.080968285096, "episode_reward_mean": -25772.19121820357, "episode_len_mean": 360.0, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-25668.07480176664, -25797.259392343632, -25887.599220216056, -25703.255399059504, -25677.12392159334, -25625.12973631695, -25704.57869605525, -25780.019251437523, -25616.88429238699, -25778.305144746893, -25973.67069342046, -25789.92903695543, -25648.23063258596, -25695.332373001038, -25942.65228394119, -25879.525464621925, -25791.18376139029, -25682.366610749825, -25685.13526267443, -25882.94915352667, -25819.908971322835, -25591.504031611414, -25858.368016171105, -25982.257781431064, -25756.018227783792, -26087.989014943934, -25616.646028094816, -25671.89855006249, -25574.665229375463, -25563.20354253552, -25682.20293968738, -25920.276278298647, -25774.75753201078, -25730.65833925668, -25846.76267862341, -26069.937320547575, -25691.9268035718, -25597.66725120839, -25753.678386930853, -25828.416214827008, -25556.145271007263, -25653.540648596365, -25626.876813574327, -25815.059498911414, -25785.900387605372, -25698.53410722529, -25928.935350527194, -25648.660592112356, -25709.853949220374, -25778.270231027287, -25804.044500571126, -25788.505674960164, -25511.44172742615, -25745.478053700404, -25637.039752774257, -25660.410542506863, -26221.080968285096, -25984.879269157755, -25893.435676587505, -25537.43144166211, -25893.649341129778, -25690.228753314994, -25611.200227393896, -25955.468063740438, -25463.58364467552, -25499.687162698836, -25991.849943571677, -26137.11117551645, -26151.304917348447, -25996.730729566603, -25914.53315627779, -25786.585052919683, -25846.28850783948, -25783.832028025026, -25627.677232823353, -26038.719815479228, -25635.922737428984, -25868.508312975722, -25991.60090523408, -25657.920462761886, -25756.19734831615, -25834.497845832582, -25624.406599402155, -25623.049176246823, -25834.387053352883, -25867.29379257149, -25643.505537482684, -25742.651422327574, -25655.41416648919, -25868.80945227319, -25847.479213891227, -25701.472246302383, -25777.462466382396, -25746.282582200427, -25736.64438715656, -26000.001128408145, -25770.531153735996, -25562.446197956648, -25885.57919387728, -25585.13596090559], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.3450961244789195, "mean_inference_ms": 0.2903152560326333, "mean_action_processing_ms": 0.06942503459279864, "mean_env_wait_ms": 1.7572939241644343, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003530263900756836, "StateBufferConnector_ms": 0.0027065277099609375, "ViewRequirementAgentConnector_ms": 0.06716322898864746}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 302760, "num_agent_steps_trained": 302760, "num_env_steps_sampled": 302760, "num_env_steps_trained": 302760, "num_env_steps_sampled_this_iter": 1080, "num_env_steps_trained_this_iter": 1080, "num_env_steps_sampled_throughput_per_sec": 95.10905405524572, "num_env_steps_trained_throughput_per_sec": 95.10905405524572, "timesteps_total": 302760, "num_steps_trained_this_iter": 1080, "agent_timesteps_total": 302760, "timers": {"training_iteration_time_ms": 3760.095, "sample_time_ms": 3749.324, "load_time_ms": 0.307, "load_throughput": 1173870.357, "learn_time_ms": 9.711, "learn_throughput": 37070.167, "synch_weights_time_ms": 0.709}, "counters": {"num_env_steps_sampled": 302760, "num_env_steps_trained": 302760, "num_agent_steps_sampled": 302760, "num_agent_steps_trained": 302760}, "done": false, "episodes_total": 841, "training_iteration": 207, "trial_id": "f5e97_00000", "date": "2023-07-25_17-34-43", "timestamp": 1690295683, "time_this_iter_s": 11.3580961227417, "time_total_s": 2326.1248455047607, "pid": 71917, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[0, 0.003], [5400, 0.001], [10800, 0.00075], [16200, 0.0005], [21600, 0.00025], [27000, 0.0001], [32400, 7.5e-05], [37800, 5e-05], [43200, 2.5e-05], [48600, 1e-05], [54000, 7.5e-06], [59400, 5e-06], [64800, 2.5e-06], [70200, 1e-06], [75600, 5e-07], [81000, 1e-07]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x304530310>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 2326.1248455047607, "iterations_since_restore": 207, "perf": {"cpu_util_percent": 24.268749999999997, "ram_util_percent": 74.36250000000001}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-07, "entropy_coeff": 0.1, "policy_entropy": -926.7002685546875, "policy_loss": -20961248379699.2, "vf_loss": 1073190476.8}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 4218.0, "diff_num_grad_updates_vs_sampler_policy": 4217.0}}, "num_env_steps_sampled": 303840, "num_env_steps_trained": 303840, "num_agent_steps_sampled": 303840, "num_agent_steps_trained": 303840}, "sampler_results": {"episode_reward_max": -25456.717753643752, "episode_reward_min": -26221.080968285096, "episode_reward_mean": -25766.455487093343, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-25703.255399059504, -25677.12392159334, -25625.12973631695, -25704.57869605525, -25780.019251437523, -25616.88429238699, -25778.305144746893, -25973.67069342046, -25789.92903695543, -25648.23063258596, -25695.332373001038, -25942.65228394119, -25879.525464621925, -25791.18376139029, -25682.366610749825, -25685.13526267443, -25882.94915352667, -25819.908971322835, -25591.504031611414, -25858.368016171105, -25982.257781431064, -25756.018227783792, -26087.989014943934, -25616.646028094816, -25671.89855006249, -25574.665229375463, -25563.20354253552, -25682.20293968738, -25920.276278298647, -25774.75753201078, -25730.65833925668, -25846.76267862341, -26069.937320547575, -25691.9268035718, -25597.66725120839, -25753.678386930853, -25828.416214827008, -25556.145271007263, -25653.540648596365, -25626.876813574327, -25815.059498911414, -25785.900387605372, -25698.53410722529, -25928.935350527194, -25648.660592112356, -25709.853949220374, -25778.270231027287, -25804.044500571126, -25788.505674960164, -25511.44172742615, -25745.478053700404, -25637.039752774257, -25660.410542506863, -26221.080968285096, -25984.879269157755, -25893.435676587505, -25537.43144166211, -25893.649341129778, -25690.228753314994, -25611.200227393896, -25955.468063740438, -25463.58364467552, -25499.687162698836, -25991.849943571677, -26137.11117551645, -26151.304917348447, -25996.730729566603, -25914.53315627779, -25786.585052919683, -25846.28850783948, -25783.832028025026, -25627.677232823353, -26038.719815479228, -25635.922737428984, -25868.508312975722, -25991.60090523408, -25657.920462761886, -25756.19734831615, -25834.497845832582, -25624.406599402155, -25623.049176246823, -25834.387053352883, -25867.29379257149, -25643.505537482684, -25742.651422327574, -25655.41416648919, -25868.80945227319, -25847.479213891227, -25701.472246302383, -25777.462466382396, -25746.282582200427, -25736.64438715656, -26000.001128408145, -25770.531153735996, -25562.446197956648, -25885.57919387728, -25585.13596090559, -25665.96732020764, -25656.675229452405, -25456.717753643752], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.353170089625955, "mean_inference_ms": 0.2906738488652373, "mean_action_processing_ms": 0.06951513784191377, "mean_env_wait_ms": 1.7598197874562502, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0035288333892822266, "StateBufferConnector_ms": 0.0027093887329101562, "ViewRequirementAgentConnector_ms": 0.06720280647277832}}, "episode_reward_max": -25456.717753643752, "episode_reward_min": -26221.080968285096, "episode_reward_mean": -25766.455487093343, "episode_len_mean": 360.0, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-25703.255399059504, -25677.12392159334, -25625.12973631695, -25704.57869605525, -25780.019251437523, -25616.88429238699, -25778.305144746893, -25973.67069342046, -25789.92903695543, -25648.23063258596, -25695.332373001038, -25942.65228394119, -25879.525464621925, -25791.18376139029, -25682.366610749825, -25685.13526267443, -25882.94915352667, -25819.908971322835, -25591.504031611414, -25858.368016171105, -25982.257781431064, -25756.018227783792, -26087.989014943934, -25616.646028094816, -25671.89855006249, -25574.665229375463, -25563.20354253552, -25682.20293968738, -25920.276278298647, -25774.75753201078, -25730.65833925668, -25846.76267862341, -26069.937320547575, -25691.9268035718, -25597.66725120839, -25753.678386930853, -25828.416214827008, -25556.145271007263, -25653.540648596365, -25626.876813574327, -25815.059498911414, -25785.900387605372, -25698.53410722529, -25928.935350527194, -25648.660592112356, -25709.853949220374, -25778.270231027287, -25804.044500571126, -25788.505674960164, -25511.44172742615, -25745.478053700404, -25637.039752774257, -25660.410542506863, -26221.080968285096, -25984.879269157755, -25893.435676587505, -25537.43144166211, -25893.649341129778, -25690.228753314994, -25611.200227393896, -25955.468063740438, -25463.58364467552, -25499.687162698836, -25991.849943571677, -26137.11117551645, -26151.304917348447, -25996.730729566603, -25914.53315627779, -25786.585052919683, -25846.28850783948, -25783.832028025026, -25627.677232823353, -26038.719815479228, -25635.922737428984, -25868.508312975722, -25991.60090523408, -25657.920462761886, -25756.19734831615, -25834.497845832582, -25624.406599402155, -25623.049176246823, -25834.387053352883, -25867.29379257149, -25643.505537482684, -25742.651422327574, -25655.41416648919, -25868.80945227319, -25847.479213891227, -25701.472246302383, -25777.462466382396, -25746.282582200427, -25736.64438715656, -26000.001128408145, -25770.531153735996, -25562.446197956648, -25885.57919387728, -25585.13596090559, -25665.96732020764, -25656.675229452405, -25456.717753643752], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.353170089625955, "mean_inference_ms": 0.2906738488652373, "mean_action_processing_ms": 0.06951513784191377, "mean_env_wait_ms": 1.7598197874562502, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0035288333892822266, "StateBufferConnector_ms": 0.0027093887329101562, "ViewRequirementAgentConnector_ms": 0.06720280647277832}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 303840, "num_agent_steps_trained": 303840, "num_env_steps_sampled": 303840, "num_env_steps_trained": 303840, "num_env_steps_sampled_this_iter": 1080, "num_env_steps_trained_this_iter": 1080, "num_env_steps_sampled_throughput_per_sec": 95.88503976705887, "num_env_steps_trained_throughput_per_sec": 95.88503976705887, "timesteps_total": 303840, "num_steps_trained_this_iter": 1080, "agent_timesteps_total": 303840, "timers": {"training_iteration_time_ms": 3766.198, "sample_time_ms": 3755.405, "load_time_ms": 0.305, "load_throughput": 1179555.847, "learn_time_ms": 9.733, "learn_throughput": 36985.902, "synch_weights_time_ms": 0.711}, "counters": {"num_env_steps_sampled": 303840, "num_env_steps_trained": 303840, "num_agent_steps_sampled": 303840, "num_agent_steps_trained": 303840}, "done": false, "episodes_total": 844, "training_iteration": 208, "trial_id": "f5e97_00000", "date": "2023-07-25_17-34-55", "timestamp": 1690295695, "time_this_iter_s": 11.266355991363525, "time_total_s": 2337.3912014961243, "pid": 71917, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[0, 0.003], [5400, 0.001], [10800, 0.00075], [16200, 0.0005], [21600, 0.00025], [27000, 0.0001], [32400, 7.5e-05], [37800, 5e-05], [43200, 2.5e-05], [48600, 1e-05], [54000, 7.5e-06], [59400, 5e-06], [64800, 2.5e-06], [70200, 1e-06], [75600, 5e-07], [81000, 1e-07]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x304530310>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 2337.3912014961243, "iterations_since_restore": 208, "perf": {"cpu_util_percent": 23.525, "ram_util_percent": 74.275}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-07, "entropy_coeff": 0.1, "policy_entropy": -926.6996704101563, "policy_loss": -27120290761932.8, "vf_loss": 1114839654.4}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 4233.0, "diff_num_grad_updates_vs_sampler_policy": 4232.0}}, "num_env_steps_sampled": 304920, "num_env_steps_trained": 304920, "num_agent_steps_sampled": 304920, "num_agent_steps_trained": 304920}, "sampler_results": {"episode_reward_max": -25456.717753643752, "episode_reward_min": -26221.080968285096, "episode_reward_mean": -25767.383958478036, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-25704.57869605525, -25780.019251437523, -25616.88429238699, -25778.305144746893, -25973.67069342046, -25789.92903695543, -25648.23063258596, -25695.332373001038, -25942.65228394119, -25879.525464621925, -25791.18376139029, -25682.366610749825, -25685.13526267443, -25882.94915352667, -25819.908971322835, -25591.504031611414, -25858.368016171105, -25982.257781431064, -25756.018227783792, -26087.989014943934, -25616.646028094816, -25671.89855006249, -25574.665229375463, -25563.20354253552, -25682.20293968738, -25920.276278298647, -25774.75753201078, -25730.65833925668, -25846.76267862341, -26069.937320547575, -25691.9268035718, -25597.66725120839, -25753.678386930853, -25828.416214827008, -25556.145271007263, -25653.540648596365, -25626.876813574327, -25815.059498911414, -25785.900387605372, -25698.53410722529, -25928.935350527194, -25648.660592112356, -25709.853949220374, -25778.270231027287, -25804.044500571126, -25788.505674960164, -25511.44172742615, -25745.478053700404, -25637.039752774257, -25660.410542506863, -26221.080968285096, -25984.879269157755, -25893.435676587505, -25537.43144166211, -25893.649341129778, -25690.228753314994, -25611.200227393896, -25955.468063740438, -25463.58364467552, -25499.687162698836, -25991.849943571677, -26137.11117551645, -26151.304917348447, -25996.730729566603, -25914.53315627779, -25786.585052919683, -25846.28850783948, -25783.832028025026, -25627.677232823353, -26038.719815479228, -25635.922737428984, -25868.508312975722, -25991.60090523408, -25657.920462761886, -25756.19734831615, -25834.497845832582, -25624.406599402155, -25623.049176246823, -25834.387053352883, -25867.29379257149, -25643.505537482684, -25742.651422327574, -25655.41416648919, -25868.80945227319, -25847.479213891227, -25701.472246302383, -25777.462466382396, -25746.282582200427, -25736.64438715656, -26000.001128408145, -25770.531153735996, -25562.446197956648, -25885.57919387728, -25585.13596090559, -25665.96732020764, -25656.675229452405, -25456.717753643752, -25562.242933916827, -25671.411627128025, -25864.70163439365], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.361180970767804, "mean_inference_ms": 0.29103028099604705, "mean_action_processing_ms": 0.06960466504647103, "mean_env_wait_ms": 1.7623224657675685, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003523588180541992, "StateBufferConnector_ms": 0.0027065277099609375, "ViewRequirementAgentConnector_ms": 0.06719803810119629}}, "episode_reward_max": -25456.717753643752, "episode_reward_min": -26221.080968285096, "episode_reward_mean": -25767.383958478036, "episode_len_mean": 360.0, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-25704.57869605525, -25780.019251437523, -25616.88429238699, -25778.305144746893, -25973.67069342046, -25789.92903695543, -25648.23063258596, -25695.332373001038, -25942.65228394119, -25879.525464621925, -25791.18376139029, -25682.366610749825, -25685.13526267443, -25882.94915352667, -25819.908971322835, -25591.504031611414, -25858.368016171105, -25982.257781431064, -25756.018227783792, -26087.989014943934, -25616.646028094816, -25671.89855006249, -25574.665229375463, -25563.20354253552, -25682.20293968738, -25920.276278298647, -25774.75753201078, -25730.65833925668, -25846.76267862341, -26069.937320547575, -25691.9268035718, -25597.66725120839, -25753.678386930853, -25828.416214827008, -25556.145271007263, -25653.540648596365, -25626.876813574327, -25815.059498911414, -25785.900387605372, -25698.53410722529, -25928.935350527194, -25648.660592112356, -25709.853949220374, -25778.270231027287, -25804.044500571126, -25788.505674960164, -25511.44172742615, -25745.478053700404, -25637.039752774257, -25660.410542506863, -26221.080968285096, -25984.879269157755, -25893.435676587505, -25537.43144166211, -25893.649341129778, -25690.228753314994, -25611.200227393896, -25955.468063740438, -25463.58364467552, -25499.687162698836, -25991.849943571677, -26137.11117551645, -26151.304917348447, -25996.730729566603, -25914.53315627779, -25786.585052919683, -25846.28850783948, -25783.832028025026, -25627.677232823353, -26038.719815479228, -25635.922737428984, -25868.508312975722, -25991.60090523408, -25657.920462761886, -25756.19734831615, -25834.497845832582, -25624.406599402155, -25623.049176246823, -25834.387053352883, -25867.29379257149, -25643.505537482684, -25742.651422327574, -25655.41416648919, -25868.80945227319, -25847.479213891227, -25701.472246302383, -25777.462466382396, -25746.282582200427, -25736.64438715656, -26000.001128408145, -25770.531153735996, -25562.446197956648, -25885.57919387728, -25585.13596090559, -25665.96732020764, -25656.675229452405, -25456.717753643752, -25562.242933916827, -25671.411627128025, -25864.70163439365], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.361180970767804, "mean_inference_ms": 0.29103028099604705, "mean_action_processing_ms": 0.06960466504647103, "mean_env_wait_ms": 1.7623224657675685, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003523588180541992, "StateBufferConnector_ms": 0.0027065277099609375, "ViewRequirementAgentConnector_ms": 0.06719803810119629}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 304920, "num_agent_steps_trained": 304920, "num_env_steps_sampled": 304920, "num_env_steps_trained": 304920, "num_env_steps_sampled_this_iter": 1080, "num_env_steps_trained_this_iter": 1080, "num_env_steps_sampled_throughput_per_sec": 96.0002298996391, "num_env_steps_trained_throughput_per_sec": 96.0002298996391, "timesteps_total": 304920, "num_steps_trained_this_iter": 1080, "agent_timesteps_total": 304920, "timers": {"training_iteration_time_ms": 3777.103, "sample_time_ms": 3766.22, "load_time_ms": 0.305, "load_throughput": 1180293.473, "learn_time_ms": 9.83, "learn_throughput": 36624.19, "synch_weights_time_ms": 0.705}, "counters": {"num_env_steps_sampled": 304920, "num_env_steps_trained": 304920, "num_agent_steps_sampled": 304920, "num_agent_steps_trained": 304920}, "done": false, "episodes_total": 847, "training_iteration": 209, "trial_id": "f5e97_00000", "date": "2023-07-25_17-35-06", "timestamp": 1690295706, "time_this_iter_s": 11.25277304649353, "time_total_s": 2348.643974542618, "pid": 71917, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[0, 0.003], [5400, 0.001], [10800, 0.00075], [16200, 0.0005], [21600, 0.00025], [27000, 0.0001], [32400, 7.5e-05], [37800, 5e-05], [43200, 2.5e-05], [48600, 1e-05], [54000, 7.5e-06], [59400, 5e-06], [64800, 2.5e-06], [70200, 1e-06], [75600, 5e-07], [81000, 1e-07]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x304530310>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 2348.643974542618, "iterations_since_restore": 209, "perf": {"cpu_util_percent": 25.24375, "ram_util_percent": 74.49375}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-07, "entropy_coeff": 0.1, "policy_entropy": -926.6997314453125, "policy_loss": -25360379923660.8, "vf_loss": 1112051731.2}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 4248.0, "diff_num_grad_updates_vs_sampler_policy": 4247.0}}, "num_env_steps_sampled": 306000, "num_env_steps_trained": 306000, "num_agent_steps_sampled": 306000, "num_agent_steps_trained": 306000}, "sampler_results": {"episode_reward_max": -25456.717753643752, "episode_reward_min": -26221.080968285096, "episode_reward_mean": -25765.33782880456, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-25778.305144746893, -25973.67069342046, -25789.92903695543, -25648.23063258596, -25695.332373001038, -25942.65228394119, -25879.525464621925, -25791.18376139029, -25682.366610749825, -25685.13526267443, -25882.94915352667, -25819.908971322835, -25591.504031611414, -25858.368016171105, -25982.257781431064, -25756.018227783792, -26087.989014943934, -25616.646028094816, -25671.89855006249, -25574.665229375463, -25563.20354253552, -25682.20293968738, -25920.276278298647, -25774.75753201078, -25730.65833925668, -25846.76267862341, -26069.937320547575, -25691.9268035718, -25597.66725120839, -25753.678386930853, -25828.416214827008, -25556.145271007263, -25653.540648596365, -25626.876813574327, -25815.059498911414, -25785.900387605372, -25698.53410722529, -25928.935350527194, -25648.660592112356, -25709.853949220374, -25778.270231027287, -25804.044500571126, -25788.505674960164, -25511.44172742615, -25745.478053700404, -25637.039752774257, -25660.410542506863, -26221.080968285096, -25984.879269157755, -25893.435676587505, -25537.43144166211, -25893.649341129778, -25690.228753314994, -25611.200227393896, -25955.468063740438, -25463.58364467552, -25499.687162698836, -25991.849943571677, -26137.11117551645, -26151.304917348447, -25996.730729566603, -25914.53315627779, -25786.585052919683, -25846.28850783948, -25783.832028025026, -25627.677232823353, -26038.719815479228, -25635.922737428984, -25868.508312975722, -25991.60090523408, -25657.920462761886, -25756.19734831615, -25834.497845832582, -25624.406599402155, -25623.049176246823, -25834.387053352883, -25867.29379257149, -25643.505537482684, -25742.651422327574, -25655.41416648919, -25868.80945227319, -25847.479213891227, -25701.472246302383, -25777.462466382396, -25746.282582200427, -25736.64438715656, -26000.001128408145, -25770.531153735996, -25562.446197956648, -25885.57919387728, -25585.13596090559, -25665.96732020764, -25656.675229452405, -25456.717753643752, -25562.242933916827, -25671.411627128025, -25864.70163439365, -25462.346071828535, -25554.082619155375, -25880.440581548897], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.369133783326172, "mean_inference_ms": 0.29138331957723507, "mean_action_processing_ms": 0.0696934222669518, "mean_env_wait_ms": 1.764804745433431, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003522634506225586, "StateBufferConnector_ms": 0.0027015209197998047, "ViewRequirementAgentConnector_ms": 0.06718659400939941}}, "episode_reward_max": -25456.717753643752, "episode_reward_min": -26221.080968285096, "episode_reward_mean": -25765.33782880456, "episode_len_mean": 360.0, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-25778.305144746893, -25973.67069342046, -25789.92903695543, -25648.23063258596, -25695.332373001038, -25942.65228394119, -25879.525464621925, -25791.18376139029, -25682.366610749825, -25685.13526267443, -25882.94915352667, -25819.908971322835, -25591.504031611414, -25858.368016171105, -25982.257781431064, -25756.018227783792, -26087.989014943934, -25616.646028094816, -25671.89855006249, -25574.665229375463, -25563.20354253552, -25682.20293968738, -25920.276278298647, -25774.75753201078, -25730.65833925668, -25846.76267862341, -26069.937320547575, -25691.9268035718, -25597.66725120839, -25753.678386930853, -25828.416214827008, -25556.145271007263, -25653.540648596365, -25626.876813574327, -25815.059498911414, -25785.900387605372, -25698.53410722529, -25928.935350527194, -25648.660592112356, -25709.853949220374, -25778.270231027287, -25804.044500571126, -25788.505674960164, -25511.44172742615, -25745.478053700404, -25637.039752774257, -25660.410542506863, -26221.080968285096, -25984.879269157755, -25893.435676587505, -25537.43144166211, -25893.649341129778, -25690.228753314994, -25611.200227393896, -25955.468063740438, -25463.58364467552, -25499.687162698836, -25991.849943571677, -26137.11117551645, -26151.304917348447, -25996.730729566603, -25914.53315627779, -25786.585052919683, -25846.28850783948, -25783.832028025026, -25627.677232823353, -26038.719815479228, -25635.922737428984, -25868.508312975722, -25991.60090523408, -25657.920462761886, -25756.19734831615, -25834.497845832582, -25624.406599402155, -25623.049176246823, -25834.387053352883, -25867.29379257149, -25643.505537482684, -25742.651422327574, -25655.41416648919, -25868.80945227319, -25847.479213891227, -25701.472246302383, -25777.462466382396, -25746.282582200427, -25736.64438715656, -26000.001128408145, -25770.531153735996, -25562.446197956648, -25885.57919387728, -25585.13596090559, -25665.96732020764, -25656.675229452405, -25456.717753643752, -25562.242933916827, -25671.411627128025, -25864.70163439365, -25462.346071828535, -25554.082619155375, -25880.440581548897], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.369133783326172, "mean_inference_ms": 0.29138331957723507, "mean_action_processing_ms": 0.0696934222669518, "mean_env_wait_ms": 1.764804745433431, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003522634506225586, "StateBufferConnector_ms": 0.0027015209197998047, "ViewRequirementAgentConnector_ms": 0.06718659400939941}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 306000, "num_agent_steps_trained": 306000, "num_env_steps_sampled": 306000, "num_env_steps_trained": 306000, "num_env_steps_sampled_this_iter": 1080, "num_env_steps_trained_this_iter": 1080, "num_env_steps_sampled_throughput_per_sec": 96.56465636977256, "num_env_steps_trained_throughput_per_sec": 96.56465636977256, "timesteps_total": 306000, "num_steps_trained_this_iter": 1080, "agent_timesteps_total": 306000, "timers": {"training_iteration_time_ms": 3755.926, "sample_time_ms": 3745.061, "load_time_ms": 0.294, "load_throughput": 1222730.132, "learn_time_ms": 9.818, "learn_throughput": 36666.078, "synch_weights_time_ms": 0.709}, "counters": {"num_env_steps_sampled": 306000, "num_env_steps_trained": 306000, "num_agent_steps_sampled": 306000, "num_agent_steps_trained": 306000}, "done": false, "episodes_total": 850, "training_iteration": 210, "trial_id": "f5e97_00000", "date": "2023-07-25_17-35-17", "timestamp": 1690295717, "time_this_iter_s": 11.187084913253784, "time_total_s": 2359.8310594558716, "pid": 71917, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[0, 0.003], [5400, 0.001], [10800, 0.00075], [16200, 0.0005], [21600, 0.00025], [27000, 0.0001], [32400, 7.5e-05], [37800, 5e-05], [43200, 2.5e-05], [48600, 1e-05], [54000, 7.5e-06], [59400, 5e-06], [64800, 2.5e-06], [70200, 1e-06], [75600, 5e-07], [81000, 1e-07]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x304530310>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 2359.8310594558716, "iterations_since_restore": 210, "perf": {"cpu_util_percent": 23.48125, "ram_util_percent": 74.3875}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-07, "entropy_coeff": 0.1, "policy_entropy": -926.699755859375, "policy_loss": -18846839183769.6, "vf_loss": 1099723142.4}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 4263.0, "diff_num_grad_updates_vs_sampler_policy": 4262.0}}, "num_env_steps_sampled": 307080, "num_env_steps_trained": 307080, "num_agent_steps_sampled": 307080, "num_agent_steps_trained": 307080}, "sampler_results": {"episode_reward_max": -25456.717753643752, "episode_reward_min": -26221.080968285096, "episode_reward_mean": -25760.960161052815, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-25648.23063258596, -25695.332373001038, -25942.65228394119, -25879.525464621925, -25791.18376139029, -25682.366610749825, -25685.13526267443, -25882.94915352667, -25819.908971322835, -25591.504031611414, -25858.368016171105, -25982.257781431064, -25756.018227783792, -26087.989014943934, -25616.646028094816, -25671.89855006249, -25574.665229375463, -25563.20354253552, -25682.20293968738, -25920.276278298647, -25774.75753201078, -25730.65833925668, -25846.76267862341, -26069.937320547575, -25691.9268035718, -25597.66725120839, -25753.678386930853, -25828.416214827008, -25556.145271007263, -25653.540648596365, -25626.876813574327, -25815.059498911414, -25785.900387605372, -25698.53410722529, -25928.935350527194, -25648.660592112356, -25709.853949220374, -25778.270231027287, -25804.044500571126, -25788.505674960164, -25511.44172742615, -25745.478053700404, -25637.039752774257, -25660.410542506863, -26221.080968285096, -25984.879269157755, -25893.435676587505, -25537.43144166211, -25893.649341129778, -25690.228753314994, -25611.200227393896, -25955.468063740438, -25463.58364467552, -25499.687162698836, -25991.849943571677, -26137.11117551645, -26151.304917348447, -25996.730729566603, -25914.53315627779, -25786.585052919683, -25846.28850783948, -25783.832028025026, -25627.677232823353, -26038.719815479228, -25635.922737428984, -25868.508312975722, -25991.60090523408, -25657.920462761886, -25756.19734831615, -25834.497845832582, -25624.406599402155, -25623.049176246823, -25834.387053352883, -25867.29379257149, -25643.505537482684, -25742.651422327574, -25655.41416648919, -25868.80945227319, -25847.479213891227, -25701.472246302383, -25777.462466382396, -25746.282582200427, -25736.64438715656, -26000.001128408145, -25770.531153735996, -25562.446197956648, -25885.57919387728, -25585.13596090559, -25665.96732020764, -25656.675229452405, -25456.717753643752, -25562.242933916827, -25671.411627128025, -25864.70163439365, -25462.346071828535, -25554.082619155375, -25880.440581548897, -25614.01025244211, -25723.019301323944, -25767.108546182273], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.377007566688256, "mean_inference_ms": 0.291733253138961, "mean_action_processing_ms": 0.06978146755339107, "mean_env_wait_ms": 1.767254984643543, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0035276412963867188, "StateBufferConnector_ms": 0.002697467803955078, "ViewRequirementAgentConnector_ms": 0.06716656684875488}}, "episode_reward_max": -25456.717753643752, "episode_reward_min": -26221.080968285096, "episode_reward_mean": -25760.960161052815, "episode_len_mean": 360.0, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-25648.23063258596, -25695.332373001038, -25942.65228394119, -25879.525464621925, -25791.18376139029, -25682.366610749825, -25685.13526267443, -25882.94915352667, -25819.908971322835, -25591.504031611414, -25858.368016171105, -25982.257781431064, -25756.018227783792, -26087.989014943934, -25616.646028094816, -25671.89855006249, -25574.665229375463, -25563.20354253552, -25682.20293968738, -25920.276278298647, -25774.75753201078, -25730.65833925668, -25846.76267862341, -26069.937320547575, -25691.9268035718, -25597.66725120839, -25753.678386930853, -25828.416214827008, -25556.145271007263, -25653.540648596365, -25626.876813574327, -25815.059498911414, -25785.900387605372, -25698.53410722529, -25928.935350527194, -25648.660592112356, -25709.853949220374, -25778.270231027287, -25804.044500571126, -25788.505674960164, -25511.44172742615, -25745.478053700404, -25637.039752774257, -25660.410542506863, -26221.080968285096, -25984.879269157755, -25893.435676587505, -25537.43144166211, -25893.649341129778, -25690.228753314994, -25611.200227393896, -25955.468063740438, -25463.58364467552, -25499.687162698836, -25991.849943571677, -26137.11117551645, -26151.304917348447, -25996.730729566603, -25914.53315627779, -25786.585052919683, -25846.28850783948, -25783.832028025026, -25627.677232823353, -26038.719815479228, -25635.922737428984, -25868.508312975722, -25991.60090523408, -25657.920462761886, -25756.19734831615, -25834.497845832582, -25624.406599402155, -25623.049176246823, -25834.387053352883, -25867.29379257149, -25643.505537482684, -25742.651422327574, -25655.41416648919, -25868.80945227319, -25847.479213891227, -25701.472246302383, -25777.462466382396, -25746.282582200427, -25736.64438715656, -26000.001128408145, -25770.531153735996, -25562.446197956648, -25885.57919387728, -25585.13596090559, -25665.96732020764, -25656.675229452405, -25456.717753643752, -25562.242933916827, -25671.411627128025, -25864.70163439365, -25462.346071828535, -25554.082619155375, -25880.440581548897, -25614.01025244211, -25723.019301323944, -25767.108546182273], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.377007566688256, "mean_inference_ms": 0.291733253138961, "mean_action_processing_ms": 0.06978146755339107, "mean_env_wait_ms": 1.767254984643543, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0035276412963867188, "StateBufferConnector_ms": 0.002697467803955078, "ViewRequirementAgentConnector_ms": 0.06716656684875488}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 307080, "num_agent_steps_trained": 307080, "num_env_steps_sampled": 307080, "num_env_steps_trained": 307080, "num_env_steps_sampled_this_iter": 1080, "num_env_steps_trained_this_iter": 1080, "num_env_steps_sampled_throughput_per_sec": 99.53709788357708, "num_env_steps_trained_throughput_per_sec": 99.53709788357708, "timesteps_total": 307080, "num_steps_trained_this_iter": 1080, "agent_timesteps_total": 307080, "timers": {"training_iteration_time_ms": 3716.066, "sample_time_ms": 3705.21, "load_time_ms": 0.295, "load_throughput": 1221444.297, "learn_time_ms": 9.811, "learn_throughput": 36695.216, "synch_weights_time_ms": 0.706}, "counters": {"num_env_steps_sampled": 307080, "num_env_steps_trained": 307080, "num_agent_steps_sampled": 307080, "num_agent_steps_trained": 307080}, "done": false, "episodes_total": 853, "training_iteration": 211, "trial_id": "f5e97_00000", "date": "2023-07-25_17-35-28", "timestamp": 1690295728, "time_this_iter_s": 10.853050947189331, "time_total_s": 2370.684110403061, "pid": 71917, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[0, 0.003], [5400, 0.001], [10800, 0.00075], [16200, 0.0005], [21600, 0.00025], [27000, 0.0001], [32400, 7.5e-05], [37800, 5e-05], [43200, 2.5e-05], [48600, 1e-05], [54000, 7.5e-06], [59400, 5e-06], [64800, 2.5e-06], [70200, 1e-06], [75600, 5e-07], [81000, 1e-07]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x304530310>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 2370.684110403061, "iterations_since_restore": 211, "perf": {"cpu_util_percent": 35.82, "ram_util_percent": 74.67333333333333}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-07, "entropy_coeff": 0.1, "policy_entropy": -926.6996948242188, "policy_loss": -21014956474368.0, "vf_loss": 1108309990.4}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 4278.0, "diff_num_grad_updates_vs_sampler_policy": 4277.0}}, "num_env_steps_sampled": 308160, "num_env_steps_trained": 308160, "num_agent_steps_sampled": 308160, "num_agent_steps_trained": 308160}, "sampler_results": {"episode_reward_max": -25456.717753643752, "episode_reward_min": -26221.080968285096, "episode_reward_mean": -25762.377905668793, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-25879.525464621925, -25791.18376139029, -25682.366610749825, -25685.13526267443, -25882.94915352667, -25819.908971322835, -25591.504031611414, -25858.368016171105, -25982.257781431064, -25756.018227783792, -26087.989014943934, -25616.646028094816, -25671.89855006249, -25574.665229375463, -25563.20354253552, -25682.20293968738, -25920.276278298647, -25774.75753201078, -25730.65833925668, -25846.76267862341, -26069.937320547575, -25691.9268035718, -25597.66725120839, -25753.678386930853, -25828.416214827008, -25556.145271007263, -25653.540648596365, -25626.876813574327, -25815.059498911414, -25785.900387605372, -25698.53410722529, -25928.935350527194, -25648.660592112356, -25709.853949220374, -25778.270231027287, -25804.044500571126, -25788.505674960164, -25511.44172742615, -25745.478053700404, -25637.039752774257, -25660.410542506863, -26221.080968285096, -25984.879269157755, -25893.435676587505, -25537.43144166211, -25893.649341129778, -25690.228753314994, -25611.200227393896, -25955.468063740438, -25463.58364467552, -25499.687162698836, -25991.849943571677, -26137.11117551645, -26151.304917348447, -25996.730729566603, -25914.53315627779, -25786.585052919683, -25846.28850783948, -25783.832028025026, -25627.677232823353, -26038.719815479228, -25635.922737428984, -25868.508312975722, -25991.60090523408, -25657.920462761886, -25756.19734831615, -25834.497845832582, -25624.406599402155, -25623.049176246823, -25834.387053352883, -25867.29379257149, -25643.505537482684, -25742.651422327574, -25655.41416648919, -25868.80945227319, -25847.479213891227, -25701.472246302383, -25777.462466382396, -25746.282582200427, -25736.64438715656, -26000.001128408145, -25770.531153735996, -25562.446197956648, -25885.57919387728, -25585.13596090559, -25665.96732020764, -25656.675229452405, -25456.717753643752, -25562.242933916827, -25671.411627128025, -25864.70163439365, -25462.346071828535, -25554.082619155375, -25880.440581548897, -25614.01025244211, -25723.019301323944, -25767.108546182273, -25693.931776022073, -25934.307805282882, -25799.75016982112], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.384832215780119, "mean_inference_ms": 0.29208145910724514, "mean_action_processing_ms": 0.06986899169770328, "mean_env_wait_ms": 1.769670507224902, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003535032272338867, "StateBufferConnector_ms": 0.0026950836181640625, "ViewRequirementAgentConnector_ms": 0.06717276573181152}}, "episode_reward_max": -25456.717753643752, "episode_reward_min": -26221.080968285096, "episode_reward_mean": -25762.377905668793, "episode_len_mean": 360.0, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-25879.525464621925, -25791.18376139029, -25682.366610749825, -25685.13526267443, -25882.94915352667, -25819.908971322835, -25591.504031611414, -25858.368016171105, -25982.257781431064, -25756.018227783792, -26087.989014943934, -25616.646028094816, -25671.89855006249, -25574.665229375463, -25563.20354253552, -25682.20293968738, -25920.276278298647, -25774.75753201078, -25730.65833925668, -25846.76267862341, -26069.937320547575, -25691.9268035718, -25597.66725120839, -25753.678386930853, -25828.416214827008, -25556.145271007263, -25653.540648596365, -25626.876813574327, -25815.059498911414, -25785.900387605372, -25698.53410722529, -25928.935350527194, -25648.660592112356, -25709.853949220374, -25778.270231027287, -25804.044500571126, -25788.505674960164, -25511.44172742615, -25745.478053700404, -25637.039752774257, -25660.410542506863, -26221.080968285096, -25984.879269157755, -25893.435676587505, -25537.43144166211, -25893.649341129778, -25690.228753314994, -25611.200227393896, -25955.468063740438, -25463.58364467552, -25499.687162698836, -25991.849943571677, -26137.11117551645, -26151.304917348447, -25996.730729566603, -25914.53315627779, -25786.585052919683, -25846.28850783948, -25783.832028025026, -25627.677232823353, -26038.719815479228, -25635.922737428984, -25868.508312975722, -25991.60090523408, -25657.920462761886, -25756.19734831615, -25834.497845832582, -25624.406599402155, -25623.049176246823, -25834.387053352883, -25867.29379257149, -25643.505537482684, -25742.651422327574, -25655.41416648919, -25868.80945227319, -25847.479213891227, -25701.472246302383, -25777.462466382396, -25746.282582200427, -25736.64438715656, -26000.001128408145, -25770.531153735996, -25562.446197956648, -25885.57919387728, -25585.13596090559, -25665.96732020764, -25656.675229452405, -25456.717753643752, -25562.242933916827, -25671.411627128025, -25864.70163439365, -25462.346071828535, -25554.082619155375, -25880.440581548897, -25614.01025244211, -25723.019301323944, -25767.108546182273, -25693.931776022073, -25934.307805282882, -25799.75016982112], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.384832215780119, "mean_inference_ms": 0.29208145910724514, "mean_action_processing_ms": 0.06986899169770328, "mean_env_wait_ms": 1.769670507224902, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003535032272338867, "StateBufferConnector_ms": 0.0026950836181640625, "ViewRequirementAgentConnector_ms": 0.06717276573181152}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 308160, "num_agent_steps_trained": 308160, "num_env_steps_sampled": 308160, "num_env_steps_trained": 308160, "num_env_steps_sampled_this_iter": 1080, "num_env_steps_trained_this_iter": 1080, "num_env_steps_sampled_throughput_per_sec": 95.87004310677341, "num_env_steps_trained_throughput_per_sec": 95.87004310677341, "timesteps_total": 308160, "num_steps_trained_this_iter": 1080, "agent_timesteps_total": 308160, "timers": {"training_iteration_time_ms": 3703.367, "sample_time_ms": 3692.354, "load_time_ms": 0.296, "load_throughput": 1214273.776, "learn_time_ms": 9.955, "learn_throughput": 36162.123, "synch_weights_time_ms": 0.718}, "counters": {"num_env_steps_sampled": 308160, "num_env_steps_trained": 308160, "num_agent_steps_sampled": 308160, "num_agent_steps_trained": 308160}, "done": false, "episodes_total": 856, "training_iteration": 212, "trial_id": "f5e97_00000", "date": "2023-07-25_17-35-39", "timestamp": 1690295739, "time_this_iter_s": 11.268079042434692, "time_total_s": 2381.9521894454956, "pid": 71917, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[0, 0.003], [5400, 0.001], [10800, 0.00075], [16200, 0.0005], [21600, 0.00025], [27000, 0.0001], [32400, 7.5e-05], [37800, 5e-05], [43200, 2.5e-05], [48600, 1e-05], [54000, 7.5e-06], [59400, 5e-06], [64800, 2.5e-06], [70200, 1e-06], [75600, 5e-07], [81000, 1e-07]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x304530310>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 2381.9521894454956, "iterations_since_restore": 212, "perf": {"cpu_util_percent": 25.6, "ram_util_percent": 74.60625}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-07, "entropy_coeff": 0.1, "policy_entropy": -926.6999267578125, "policy_loss": -17590361548390.4, "vf_loss": 1092516160.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 4293.0, "diff_num_grad_updates_vs_sampler_policy": 4292.0}}, "num_env_steps_sampled": 309240, "num_env_steps_trained": 309240, "num_agent_steps_sampled": 309240, "num_agent_steps_trained": 309240}, "sampler_results": {"episode_reward_max": -25456.717753643752, "episode_reward_min": -26221.080968285096, "episode_reward_mean": -25760.934250274513, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-25685.13526267443, -25882.94915352667, -25819.908971322835, -25591.504031611414, -25858.368016171105, -25982.257781431064, -25756.018227783792, -26087.989014943934, -25616.646028094816, -25671.89855006249, -25574.665229375463, -25563.20354253552, -25682.20293968738, -25920.276278298647, -25774.75753201078, -25730.65833925668, -25846.76267862341, -26069.937320547575, -25691.9268035718, -25597.66725120839, -25753.678386930853, -25828.416214827008, -25556.145271007263, -25653.540648596365, -25626.876813574327, -25815.059498911414, -25785.900387605372, -25698.53410722529, -25928.935350527194, -25648.660592112356, -25709.853949220374, -25778.270231027287, -25804.044500571126, -25788.505674960164, -25511.44172742615, -25745.478053700404, -25637.039752774257, -25660.410542506863, -26221.080968285096, -25984.879269157755, -25893.435676587505, -25537.43144166211, -25893.649341129778, -25690.228753314994, -25611.200227393896, -25955.468063740438, -25463.58364467552, -25499.687162698836, -25991.849943571677, -26137.11117551645, -26151.304917348447, -25996.730729566603, -25914.53315627779, -25786.585052919683, -25846.28850783948, -25783.832028025026, -25627.677232823353, -26038.719815479228, -25635.922737428984, -25868.508312975722, -25991.60090523408, -25657.920462761886, -25756.19734831615, -25834.497845832582, -25624.406599402155, -25623.049176246823, -25834.387053352883, -25867.29379257149, -25643.505537482684, -25742.651422327574, -25655.41416648919, -25868.80945227319, -25847.479213891227, -25701.472246302383, -25777.462466382396, -25746.282582200427, -25736.64438715656, -26000.001128408145, -25770.531153735996, -25562.446197956648, -25885.57919387728, -25585.13596090559, -25665.96732020764, -25656.675229452405, -25456.717753643752, -25562.242933916827, -25671.411627128025, -25864.70163439365, -25462.346071828535, -25554.082619155375, -25880.440581548897, -25614.01025244211, -25723.019301323944, -25767.108546182273, -25693.931776022073, -25934.307805282882, -25799.75016982112, -25767.052116667943, -25703.318308026996, -25738.33987263904], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.39259520472027, "mean_inference_ms": 0.29243750586161027, "mean_action_processing_ms": 0.06995577310421743, "mean_env_wait_ms": 1.7720602094126272, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0035331249237060547, "StateBufferConnector_ms": 0.0026891231536865234, "ViewRequirementAgentConnector_ms": 0.06713056564331055}}, "episode_reward_max": -25456.717753643752, "episode_reward_min": -26221.080968285096, "episode_reward_mean": -25760.934250274513, "episode_len_mean": 360.0, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-25685.13526267443, -25882.94915352667, -25819.908971322835, -25591.504031611414, -25858.368016171105, -25982.257781431064, -25756.018227783792, -26087.989014943934, -25616.646028094816, -25671.89855006249, -25574.665229375463, -25563.20354253552, -25682.20293968738, -25920.276278298647, -25774.75753201078, -25730.65833925668, -25846.76267862341, -26069.937320547575, -25691.9268035718, -25597.66725120839, -25753.678386930853, -25828.416214827008, -25556.145271007263, -25653.540648596365, -25626.876813574327, -25815.059498911414, -25785.900387605372, -25698.53410722529, -25928.935350527194, -25648.660592112356, -25709.853949220374, -25778.270231027287, -25804.044500571126, -25788.505674960164, -25511.44172742615, -25745.478053700404, -25637.039752774257, -25660.410542506863, -26221.080968285096, -25984.879269157755, -25893.435676587505, -25537.43144166211, -25893.649341129778, -25690.228753314994, -25611.200227393896, -25955.468063740438, -25463.58364467552, -25499.687162698836, -25991.849943571677, -26137.11117551645, -26151.304917348447, -25996.730729566603, -25914.53315627779, -25786.585052919683, -25846.28850783948, -25783.832028025026, -25627.677232823353, -26038.719815479228, -25635.922737428984, -25868.508312975722, -25991.60090523408, -25657.920462761886, -25756.19734831615, -25834.497845832582, -25624.406599402155, -25623.049176246823, -25834.387053352883, -25867.29379257149, -25643.505537482684, -25742.651422327574, -25655.41416648919, -25868.80945227319, -25847.479213891227, -25701.472246302383, -25777.462466382396, -25746.282582200427, -25736.64438715656, -26000.001128408145, -25770.531153735996, -25562.446197956648, -25885.57919387728, -25585.13596090559, -25665.96732020764, -25656.675229452405, -25456.717753643752, -25562.242933916827, -25671.411627128025, -25864.70163439365, -25462.346071828535, -25554.082619155375, -25880.440581548897, -25614.01025244211, -25723.019301323944, -25767.108546182273, -25693.931776022073, -25934.307805282882, -25799.75016982112, -25767.052116667943, -25703.318308026996, -25738.33987263904], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.39259520472027, "mean_inference_ms": 0.29243750586161027, "mean_action_processing_ms": 0.06995577310421743, "mean_env_wait_ms": 1.7720602094126272, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0035331249237060547, "StateBufferConnector_ms": 0.0026891231536865234, "ViewRequirementAgentConnector_ms": 0.06713056564331055}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 309240, "num_agent_steps_trained": 309240, "num_env_steps_sampled": 309240, "num_env_steps_trained": 309240, "num_env_steps_sampled_this_iter": 1080, "num_env_steps_trained_this_iter": 1080, "num_env_steps_sampled_throughput_per_sec": 95.10463907620196, "num_env_steps_trained_throughput_per_sec": 95.10463907620196, "timesteps_total": 309240, "num_steps_trained_this_iter": 1080, "agent_timesteps_total": 309240, "timers": {"training_iteration_time_ms": 3707.723, "sample_time_ms": 3696.732, "load_time_ms": 0.296, "load_throughput": 1217701.161, "learn_time_ms": 9.926, "learn_throughput": 36268.091, "synch_weights_time_ms": 0.726}, "counters": {"num_env_steps_sampled": 309240, "num_env_steps_trained": 309240, "num_agent_steps_sampled": 309240, "num_agent_steps_trained": 309240}, "done": false, "episodes_total": 859, "training_iteration": 213, "trial_id": "f5e97_00000", "date": "2023-07-25_17-35-51", "timestamp": 1690295751, "time_this_iter_s": 11.359418869018555, "time_total_s": 2393.311608314514, "pid": 71917, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[0, 0.003], [5400, 0.001], [10800, 0.00075], [16200, 0.0005], [21600, 0.00025], [27000, 0.0001], [32400, 7.5e-05], [37800, 5e-05], [43200, 2.5e-05], [48600, 1e-05], [54000, 7.5e-06], [59400, 5e-06], [64800, 2.5e-06], [70200, 1e-06], [75600, 5e-07], [81000, 1e-07]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x304530310>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 2393.311608314514, "iterations_since_restore": 213, "perf": {"cpu_util_percent": 25.11875, "ram_util_percent": 74.75}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-07, "entropy_coeff": 0.1, "policy_entropy": -926.7, "policy_loss": -18499199333171.2, "vf_loss": 1084721862.4}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 4308.0, "diff_num_grad_updates_vs_sampler_policy": 4307.0}}, "num_env_steps_sampled": 310320, "num_env_steps_trained": 310320, "num_agent_steps_sampled": 310320, "num_agent_steps_trained": 310320}, "sampler_results": {"episode_reward_max": -25456.717753643752, "episode_reward_min": -26221.080968285096, "episode_reward_mean": -25760.692584652188, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-25591.504031611414, -25858.368016171105, -25982.257781431064, -25756.018227783792, -26087.989014943934, -25616.646028094816, -25671.89855006249, -25574.665229375463, -25563.20354253552, -25682.20293968738, -25920.276278298647, -25774.75753201078, -25730.65833925668, -25846.76267862341, -26069.937320547575, -25691.9268035718, -25597.66725120839, -25753.678386930853, -25828.416214827008, -25556.145271007263, -25653.540648596365, -25626.876813574327, -25815.059498911414, -25785.900387605372, -25698.53410722529, -25928.935350527194, -25648.660592112356, -25709.853949220374, -25778.270231027287, -25804.044500571126, -25788.505674960164, -25511.44172742615, -25745.478053700404, -25637.039752774257, -25660.410542506863, -26221.080968285096, -25984.879269157755, -25893.435676587505, -25537.43144166211, -25893.649341129778, -25690.228753314994, -25611.200227393896, -25955.468063740438, -25463.58364467552, -25499.687162698836, -25991.849943571677, -26137.11117551645, -26151.304917348447, -25996.730729566603, -25914.53315627779, -25786.585052919683, -25846.28850783948, -25783.832028025026, -25627.677232823353, -26038.719815479228, -25635.922737428984, -25868.508312975722, -25991.60090523408, -25657.920462761886, -25756.19734831615, -25834.497845832582, -25624.406599402155, -25623.049176246823, -25834.387053352883, -25867.29379257149, -25643.505537482684, -25742.651422327574, -25655.41416648919, -25868.80945227319, -25847.479213891227, -25701.472246302383, -25777.462466382396, -25746.282582200427, -25736.64438715656, -26000.001128408145, -25770.531153735996, -25562.446197956648, -25885.57919387728, -25585.13596090559, -25665.96732020764, -25656.675229452405, -25456.717753643752, -25562.242933916827, -25671.411627128025, -25864.70163439365, -25462.346071828535, -25554.082619155375, -25880.440581548897, -25614.01025244211, -25723.019301323944, -25767.108546182273, -25693.931776022073, -25934.307805282882, -25799.75016982112, -25767.052116667943, -25703.318308026996, -25738.33987263904, -25839.263566717633, -26058.03842804496, -25466.52483052838], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.40030981816588, "mean_inference_ms": 0.2927906400286064, "mean_action_processing_ms": 0.07004189118810165, "mean_env_wait_ms": 1.7744333057226487, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0035309791564941406, "StateBufferConnector_ms": 0.0026884078979492188, "ViewRequirementAgentConnector_ms": 0.06693720817565918}}, "episode_reward_max": -25456.717753643752, "episode_reward_min": -26221.080968285096, "episode_reward_mean": -25760.692584652188, "episode_len_mean": 360.0, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-25591.504031611414, -25858.368016171105, -25982.257781431064, -25756.018227783792, -26087.989014943934, -25616.646028094816, -25671.89855006249, -25574.665229375463, -25563.20354253552, -25682.20293968738, -25920.276278298647, -25774.75753201078, -25730.65833925668, -25846.76267862341, -26069.937320547575, -25691.9268035718, -25597.66725120839, -25753.678386930853, -25828.416214827008, -25556.145271007263, -25653.540648596365, -25626.876813574327, -25815.059498911414, -25785.900387605372, -25698.53410722529, -25928.935350527194, -25648.660592112356, -25709.853949220374, -25778.270231027287, -25804.044500571126, -25788.505674960164, -25511.44172742615, -25745.478053700404, -25637.039752774257, -25660.410542506863, -26221.080968285096, -25984.879269157755, -25893.435676587505, -25537.43144166211, -25893.649341129778, -25690.228753314994, -25611.200227393896, -25955.468063740438, -25463.58364467552, -25499.687162698836, -25991.849943571677, -26137.11117551645, -26151.304917348447, -25996.730729566603, -25914.53315627779, -25786.585052919683, -25846.28850783948, -25783.832028025026, -25627.677232823353, -26038.719815479228, -25635.922737428984, -25868.508312975722, -25991.60090523408, -25657.920462761886, -25756.19734831615, -25834.497845832582, -25624.406599402155, -25623.049176246823, -25834.387053352883, -25867.29379257149, -25643.505537482684, -25742.651422327574, -25655.41416648919, -25868.80945227319, -25847.479213891227, -25701.472246302383, -25777.462466382396, -25746.282582200427, -25736.64438715656, -26000.001128408145, -25770.531153735996, -25562.446197956648, -25885.57919387728, -25585.13596090559, -25665.96732020764, -25656.675229452405, -25456.717753643752, -25562.242933916827, -25671.411627128025, -25864.70163439365, -25462.346071828535, -25554.082619155375, -25880.440581548897, -25614.01025244211, -25723.019301323944, -25767.108546182273, -25693.931776022073, -25934.307805282882, -25799.75016982112, -25767.052116667943, -25703.318308026996, -25738.33987263904, -25839.263566717633, -26058.03842804496, -25466.52483052838], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.40030981816588, "mean_inference_ms": 0.2927906400286064, "mean_action_processing_ms": 0.07004189118810165, "mean_env_wait_ms": 1.7744333057226487, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0035309791564941406, "StateBufferConnector_ms": 0.0026884078979492188, "ViewRequirementAgentConnector_ms": 0.06693720817565918}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 310320, "num_agent_steps_trained": 310320, "num_env_steps_sampled": 310320, "num_env_steps_trained": 310320, "num_env_steps_sampled_this_iter": 1080, "num_env_steps_trained_this_iter": 1080, "num_env_steps_sampled_throughput_per_sec": 95.09652505032359, "num_env_steps_trained_throughput_per_sec": 95.09652505032359, "timesteps_total": 310320, "num_steps_trained_this_iter": 1080, "agent_timesteps_total": 310320, "timers": {"training_iteration_time_ms": 3752.627, "sample_time_ms": 3741.66, "load_time_ms": 0.296, "load_throughput": 1218094.095, "learn_time_ms": 9.918, "learn_throughput": 36298.607, "synch_weights_time_ms": 0.711}, "counters": {"num_env_steps_sampled": 310320, "num_env_steps_trained": 310320, "num_agent_steps_sampled": 310320, "num_agent_steps_trained": 310320}, "done": false, "episodes_total": 862, "training_iteration": 214, "trial_id": "f5e97_00000", "date": "2023-07-25_17-36-02", "timestamp": 1690295762, "time_this_iter_s": 11.359742879867554, "time_total_s": 2404.6713511943817, "pid": 71917, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[0, 0.003], [5400, 0.001], [10800, 0.00075], [16200, 0.0005], [21600, 0.00025], [27000, 0.0001], [32400, 7.5e-05], [37800, 5e-05], [43200, 2.5e-05], [48600, 1e-05], [54000, 7.5e-06], [59400, 5e-06], [64800, 2.5e-06], [70200, 1e-06], [75600, 5e-07], [81000, 1e-07]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x304530310>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 2404.6713511943817, "iterations_since_restore": 214, "perf": {"cpu_util_percent": 22.974999999999998, "ram_util_percent": 74.74375}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-07, "entropy_coeff": 0.1, "policy_entropy": -926.699853515625, "policy_loss": -13511982875443.2, "vf_loss": 1089616192.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 4323.0, "diff_num_grad_updates_vs_sampler_policy": 4322.0}}, "num_env_steps_sampled": 311400, "num_env_steps_trained": 311400, "num_agent_steps_sampled": 311400, "num_agent_steps_trained": 311400}, "sampler_results": {"episode_reward_max": -25456.717753643752, "episode_reward_min": -26221.080968285096, "episode_reward_mean": -25755.88322114063, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-25756.018227783792, -26087.989014943934, -25616.646028094816, -25671.89855006249, -25574.665229375463, -25563.20354253552, -25682.20293968738, -25920.276278298647, -25774.75753201078, -25730.65833925668, -25846.76267862341, -26069.937320547575, -25691.9268035718, -25597.66725120839, -25753.678386930853, -25828.416214827008, -25556.145271007263, -25653.540648596365, -25626.876813574327, -25815.059498911414, -25785.900387605372, -25698.53410722529, -25928.935350527194, -25648.660592112356, -25709.853949220374, -25778.270231027287, -25804.044500571126, -25788.505674960164, -25511.44172742615, -25745.478053700404, -25637.039752774257, -25660.410542506863, -26221.080968285096, -25984.879269157755, -25893.435676587505, -25537.43144166211, -25893.649341129778, -25690.228753314994, -25611.200227393896, -25955.468063740438, -25463.58364467552, -25499.687162698836, -25991.849943571677, -26137.11117551645, -26151.304917348447, -25996.730729566603, -25914.53315627779, -25786.585052919683, -25846.28850783948, -25783.832028025026, -25627.677232823353, -26038.719815479228, -25635.922737428984, -25868.508312975722, -25991.60090523408, -25657.920462761886, -25756.19734831615, -25834.497845832582, -25624.406599402155, -25623.049176246823, -25834.387053352883, -25867.29379257149, -25643.505537482684, -25742.651422327574, -25655.41416648919, -25868.80945227319, -25847.479213891227, -25701.472246302383, -25777.462466382396, -25746.282582200427, -25736.64438715656, -26000.001128408145, -25770.531153735996, -25562.446197956648, -25885.57919387728, -25585.13596090559, -25665.96732020764, -25656.675229452405, -25456.717753643752, -25562.242933916827, -25671.411627128025, -25864.70163439365, -25462.346071828535, -25554.082619155375, -25880.440581548897, -25614.01025244211, -25723.019301323944, -25767.108546182273, -25693.931776022073, -25934.307805282882, -25799.75016982112, -25767.052116667943, -25703.318308026996, -25738.33987263904, -25839.263566717633, -26058.03842804496, -25466.52483052838, -25723.79005705918, -25568.652334018734, -25658.751086979817], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.407974591928423, "mean_inference_ms": 0.29314171669692013, "mean_action_processing_ms": 0.0701274587118256, "mean_env_wait_ms": 1.7767919706478708, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003535747528076172, "StateBufferConnector_ms": 0.002689838409423828, "ViewRequirementAgentConnector_ms": 0.06700754165649414}}, "episode_reward_max": -25456.717753643752, "episode_reward_min": -26221.080968285096, "episode_reward_mean": -25755.88322114063, "episode_len_mean": 360.0, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-25756.018227783792, -26087.989014943934, -25616.646028094816, -25671.89855006249, -25574.665229375463, -25563.20354253552, -25682.20293968738, -25920.276278298647, -25774.75753201078, -25730.65833925668, -25846.76267862341, -26069.937320547575, -25691.9268035718, -25597.66725120839, -25753.678386930853, -25828.416214827008, -25556.145271007263, -25653.540648596365, -25626.876813574327, -25815.059498911414, -25785.900387605372, -25698.53410722529, -25928.935350527194, -25648.660592112356, -25709.853949220374, -25778.270231027287, -25804.044500571126, -25788.505674960164, -25511.44172742615, -25745.478053700404, -25637.039752774257, -25660.410542506863, -26221.080968285096, -25984.879269157755, -25893.435676587505, -25537.43144166211, -25893.649341129778, -25690.228753314994, -25611.200227393896, -25955.468063740438, -25463.58364467552, -25499.687162698836, -25991.849943571677, -26137.11117551645, -26151.304917348447, -25996.730729566603, -25914.53315627779, -25786.585052919683, -25846.28850783948, -25783.832028025026, -25627.677232823353, -26038.719815479228, -25635.922737428984, -25868.508312975722, -25991.60090523408, -25657.920462761886, -25756.19734831615, -25834.497845832582, -25624.406599402155, -25623.049176246823, -25834.387053352883, -25867.29379257149, -25643.505537482684, -25742.651422327574, -25655.41416648919, -25868.80945227319, -25847.479213891227, -25701.472246302383, -25777.462466382396, -25746.282582200427, -25736.64438715656, -26000.001128408145, -25770.531153735996, -25562.446197956648, -25885.57919387728, -25585.13596090559, -25665.96732020764, -25656.675229452405, -25456.717753643752, -25562.242933916827, -25671.411627128025, -25864.70163439365, -25462.346071828535, -25554.082619155375, -25880.440581548897, -25614.01025244211, -25723.019301323944, -25767.108546182273, -25693.931776022073, -25934.307805282882, -25799.75016982112, -25767.052116667943, -25703.318308026996, -25738.33987263904, -25839.263566717633, -26058.03842804496, -25466.52483052838, -25723.79005705918, -25568.652334018734, -25658.751086979817], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.407974591928423, "mean_inference_ms": 0.29314171669692013, "mean_action_processing_ms": 0.0701274587118256, "mean_env_wait_ms": 1.7767919706478708, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003535747528076172, "StateBufferConnector_ms": 0.002689838409423828, "ViewRequirementAgentConnector_ms": 0.06700754165649414}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 311400, "num_agent_steps_trained": 311400, "num_env_steps_sampled": 311400, "num_env_steps_trained": 311400, "num_env_steps_sampled_this_iter": 1080, "num_env_steps_trained_this_iter": 1080, "num_env_steps_sampled_throughput_per_sec": 94.67667918266, "num_env_steps_trained_throughput_per_sec": 94.67667918266, "timesteps_total": 311400, "num_steps_trained_this_iter": 1080, "agent_timesteps_total": 311400, "timers": {"training_iteration_time_ms": 3780.254, "sample_time_ms": 3769.529, "load_time_ms": 0.296, "load_throughput": 1217995.838, "learn_time_ms": 9.685, "learn_throughput": 37171.646, "synch_weights_time_ms": 0.701}, "counters": {"num_env_steps_sampled": 311400, "num_env_steps_trained": 311400, "num_agent_steps_sampled": 311400, "num_agent_steps_trained": 311400}, "done": false, "episodes_total": 865, "training_iteration": 215, "trial_id": "f5e97_00000", "date": "2023-07-25_17-36-14", "timestamp": 1690295774, "time_this_iter_s": 11.410050868988037, "time_total_s": 2416.0814020633698, "pid": 71917, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[0, 0.003], [5400, 0.001], [10800, 0.00075], [16200, 0.0005], [21600, 0.00025], [27000, 0.0001], [32400, 7.5e-05], [37800, 5e-05], [43200, 2.5e-05], [48600, 1e-05], [54000, 7.5e-06], [59400, 5e-06], [64800, 2.5e-06], [70200, 1e-06], [75600, 5e-07], [81000, 1e-07]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x304530310>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 2416.0814020633698, "iterations_since_restore": 215, "perf": {"cpu_util_percent": 26.13125, "ram_util_percent": 74.88125}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-07, "entropy_coeff": 0.1, "policy_entropy": -926.6998657226562, "policy_loss": -28050112777420.8, "vf_loss": 1099524352.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 4338.0, "diff_num_grad_updates_vs_sampler_policy": 4337.0}}, "num_env_steps_sampled": 312480, "num_env_steps_trained": 312480, "num_agent_steps_sampled": 312480, "num_agent_steps_trained": 312480}, "sampler_results": {"episode_reward_max": -25456.717753643752, "episode_reward_min": -26221.080968285096, "episode_reward_mean": -25752.81552285118, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-25671.89855006249, -25574.665229375463, -25563.20354253552, -25682.20293968738, -25920.276278298647, -25774.75753201078, -25730.65833925668, -25846.76267862341, -26069.937320547575, -25691.9268035718, -25597.66725120839, -25753.678386930853, -25828.416214827008, -25556.145271007263, -25653.540648596365, -25626.876813574327, -25815.059498911414, -25785.900387605372, -25698.53410722529, -25928.935350527194, -25648.660592112356, -25709.853949220374, -25778.270231027287, -25804.044500571126, -25788.505674960164, -25511.44172742615, -25745.478053700404, -25637.039752774257, -25660.410542506863, -26221.080968285096, -25984.879269157755, -25893.435676587505, -25537.43144166211, -25893.649341129778, -25690.228753314994, -25611.200227393896, -25955.468063740438, -25463.58364467552, -25499.687162698836, -25991.849943571677, -26137.11117551645, -26151.304917348447, -25996.730729566603, -25914.53315627779, -25786.585052919683, -25846.28850783948, -25783.832028025026, -25627.677232823353, -26038.719815479228, -25635.922737428984, -25868.508312975722, -25991.60090523408, -25657.920462761886, -25756.19734831615, -25834.497845832582, -25624.406599402155, -25623.049176246823, -25834.387053352883, -25867.29379257149, -25643.505537482684, -25742.651422327574, -25655.41416648919, -25868.80945227319, -25847.479213891227, -25701.472246302383, -25777.462466382396, -25746.282582200427, -25736.64438715656, -26000.001128408145, -25770.531153735996, -25562.446197956648, -25885.57919387728, -25585.13596090559, -25665.96732020764, -25656.675229452405, -25456.717753643752, -25562.242933916827, -25671.411627128025, -25864.70163439365, -25462.346071828535, -25554.082619155375, -25880.440581548897, -25614.01025244211, -25723.019301323944, -25767.108546182273, -25693.931776022073, -25934.307805282882, -25799.75016982112, -25767.052116667943, -25703.318308026996, -25738.33987263904, -25839.263566717633, -26058.03842804496, -25466.52483052838, -25723.79005705918, -25568.652334018734, -25658.751086979817, -25796.293306878513, -25637.135134172895, -25720.455000826445], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.4155883486332845, "mean_inference_ms": 0.2934902114883242, "mean_action_processing_ms": 0.07021240558265164, "mean_env_wait_ms": 1.7791243272612707, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0035376548767089844, "StateBufferConnector_ms": 0.002693653106689453, "ViewRequirementAgentConnector_ms": 0.06708192825317383}}, "episode_reward_max": -25456.717753643752, "episode_reward_min": -26221.080968285096, "episode_reward_mean": -25752.81552285118, "episode_len_mean": 360.0, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-25671.89855006249, -25574.665229375463, -25563.20354253552, -25682.20293968738, -25920.276278298647, -25774.75753201078, -25730.65833925668, -25846.76267862341, -26069.937320547575, -25691.9268035718, -25597.66725120839, -25753.678386930853, -25828.416214827008, -25556.145271007263, -25653.540648596365, -25626.876813574327, -25815.059498911414, -25785.900387605372, -25698.53410722529, -25928.935350527194, -25648.660592112356, -25709.853949220374, -25778.270231027287, -25804.044500571126, -25788.505674960164, -25511.44172742615, -25745.478053700404, -25637.039752774257, -25660.410542506863, -26221.080968285096, -25984.879269157755, -25893.435676587505, -25537.43144166211, -25893.649341129778, -25690.228753314994, -25611.200227393896, -25955.468063740438, -25463.58364467552, -25499.687162698836, -25991.849943571677, -26137.11117551645, -26151.304917348447, -25996.730729566603, -25914.53315627779, -25786.585052919683, -25846.28850783948, -25783.832028025026, -25627.677232823353, -26038.719815479228, -25635.922737428984, -25868.508312975722, -25991.60090523408, -25657.920462761886, -25756.19734831615, -25834.497845832582, -25624.406599402155, -25623.049176246823, -25834.387053352883, -25867.29379257149, -25643.505537482684, -25742.651422327574, -25655.41416648919, -25868.80945227319, -25847.479213891227, -25701.472246302383, -25777.462466382396, -25746.282582200427, -25736.64438715656, -26000.001128408145, -25770.531153735996, -25562.446197956648, -25885.57919387728, -25585.13596090559, -25665.96732020764, -25656.675229452405, -25456.717753643752, -25562.242933916827, -25671.411627128025, -25864.70163439365, -25462.346071828535, -25554.082619155375, -25880.440581548897, -25614.01025244211, -25723.019301323944, -25767.108546182273, -25693.931776022073, -25934.307805282882, -25799.75016982112, -25767.052116667943, -25703.318308026996, -25738.33987263904, -25839.263566717633, -26058.03842804496, -25466.52483052838, -25723.79005705918, -25568.652334018734, -25658.751086979817, -25796.293306878513, -25637.135134172895, -25720.455000826445], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.4155883486332845, "mean_inference_ms": 0.2934902114883242, "mean_action_processing_ms": 0.07021240558265164, "mean_env_wait_ms": 1.7791243272612707, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0035376548767089844, "StateBufferConnector_ms": 0.002693653106689453, "ViewRequirementAgentConnector_ms": 0.06708192825317383}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 312480, "num_agent_steps_trained": 312480, "num_env_steps_sampled": 312480, "num_env_steps_trained": 312480, "num_env_steps_sampled_this_iter": 1080, "num_env_steps_trained_this_iter": 1080, "num_env_steps_sampled_throughput_per_sec": 95.56409969876049, "num_env_steps_trained_throughput_per_sec": 95.56409969876049, "timesteps_total": 312480, "num_steps_trained_this_iter": 1080, "agent_timesteps_total": 312480, "timers": {"training_iteration_time_ms": 3788.763, "sample_time_ms": 3778.078, "load_time_ms": 0.297, "load_throughput": 1213298.063, "learn_time_ms": 9.643, "learn_throughput": 37333.125, "synch_weights_time_ms": 0.702}, "counters": {"num_env_steps_sampled": 312480, "num_env_steps_trained": 312480, "num_agent_steps_sampled": 312480, "num_agent_steps_trained": 312480}, "done": false, "episodes_total": 868, "training_iteration": 216, "trial_id": "f5e97_00000", "date": "2023-07-25_17-36-25", "timestamp": 1690295785, "time_this_iter_s": 11.304144859313965, "time_total_s": 2427.3855469226837, "pid": 71917, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[0, 0.003], [5400, 0.001], [10800, 0.00075], [16200, 0.0005], [21600, 0.00025], [27000, 0.0001], [32400, 7.5e-05], [37800, 5e-05], [43200, 2.5e-05], [48600, 1e-05], [54000, 7.5e-06], [59400, 5e-06], [64800, 2.5e-06], [70200, 1e-06], [75600, 5e-07], [81000, 1e-07]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x304530310>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 2427.3855469226837, "iterations_since_restore": 216, "perf": {"cpu_util_percent": 24.499999999999996, "ram_util_percent": 74.8875}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-07, "entropy_coeff": 0.1, "policy_entropy": -926.7001831054688, "policy_loss": -26233369762201.6, "vf_loss": 1075763155.2}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 4353.0, "diff_num_grad_updates_vs_sampler_policy": 4352.0}}, "num_env_steps_sampled": 313560, "num_env_steps_trained": 313560, "num_agent_steps_sampled": 313560, "num_agent_steps_trained": 313560}, "sampler_results": {"episode_reward_max": -25456.717753643752, "episode_reward_min": -26221.080968285096, "episode_reward_mean": -25754.697738088402, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-25682.20293968738, -25920.276278298647, -25774.75753201078, -25730.65833925668, -25846.76267862341, -26069.937320547575, -25691.9268035718, -25597.66725120839, -25753.678386930853, -25828.416214827008, -25556.145271007263, -25653.540648596365, -25626.876813574327, -25815.059498911414, -25785.900387605372, -25698.53410722529, -25928.935350527194, -25648.660592112356, -25709.853949220374, -25778.270231027287, -25804.044500571126, -25788.505674960164, -25511.44172742615, -25745.478053700404, -25637.039752774257, -25660.410542506863, -26221.080968285096, -25984.879269157755, -25893.435676587505, -25537.43144166211, -25893.649341129778, -25690.228753314994, -25611.200227393896, -25955.468063740438, -25463.58364467552, -25499.687162698836, -25991.849943571677, -26137.11117551645, -26151.304917348447, -25996.730729566603, -25914.53315627779, -25786.585052919683, -25846.28850783948, -25783.832028025026, -25627.677232823353, -26038.719815479228, -25635.922737428984, -25868.508312975722, -25991.60090523408, -25657.920462761886, -25756.19734831615, -25834.497845832582, -25624.406599402155, -25623.049176246823, -25834.387053352883, -25867.29379257149, -25643.505537482684, -25742.651422327574, -25655.41416648919, -25868.80945227319, -25847.479213891227, -25701.472246302383, -25777.462466382396, -25746.282582200427, -25736.64438715656, -26000.001128408145, -25770.531153735996, -25562.446197956648, -25885.57919387728, -25585.13596090559, -25665.96732020764, -25656.675229452405, -25456.717753643752, -25562.242933916827, -25671.411627128025, -25864.70163439365, -25462.346071828535, -25554.082619155375, -25880.440581548897, -25614.01025244211, -25723.019301323944, -25767.108546182273, -25693.931776022073, -25934.307805282882, -25799.75016982112, -25767.052116667943, -25703.318308026996, -25738.33987263904, -25839.263566717633, -26058.03842804496, -25466.52483052838, -25723.79005705918, -25568.652334018734, -25658.751086979817, -25796.293306878513, -25637.135134172895, -25720.455000826445, -25745.1061000994, -25758.48543409182, -25494.397311504414], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.423139039762301, "mean_inference_ms": 0.2938359410773817, "mean_action_processing_ms": 0.07029666887211326, "mean_env_wait_ms": 1.7814356384982917, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0035398006439208984, "StateBufferConnector_ms": 0.0026967525482177734, "ViewRequirementAgentConnector_ms": 0.06717658042907715}}, "episode_reward_max": -25456.717753643752, "episode_reward_min": -26221.080968285096, "episode_reward_mean": -25754.697738088402, "episode_len_mean": 360.0, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-25682.20293968738, -25920.276278298647, -25774.75753201078, -25730.65833925668, -25846.76267862341, -26069.937320547575, -25691.9268035718, -25597.66725120839, -25753.678386930853, -25828.416214827008, -25556.145271007263, -25653.540648596365, -25626.876813574327, -25815.059498911414, -25785.900387605372, -25698.53410722529, -25928.935350527194, -25648.660592112356, -25709.853949220374, -25778.270231027287, -25804.044500571126, -25788.505674960164, -25511.44172742615, -25745.478053700404, -25637.039752774257, -25660.410542506863, -26221.080968285096, -25984.879269157755, -25893.435676587505, -25537.43144166211, -25893.649341129778, -25690.228753314994, -25611.200227393896, -25955.468063740438, -25463.58364467552, -25499.687162698836, -25991.849943571677, -26137.11117551645, -26151.304917348447, -25996.730729566603, -25914.53315627779, -25786.585052919683, -25846.28850783948, -25783.832028025026, -25627.677232823353, -26038.719815479228, -25635.922737428984, -25868.508312975722, -25991.60090523408, -25657.920462761886, -25756.19734831615, -25834.497845832582, -25624.406599402155, -25623.049176246823, -25834.387053352883, -25867.29379257149, -25643.505537482684, -25742.651422327574, -25655.41416648919, -25868.80945227319, -25847.479213891227, -25701.472246302383, -25777.462466382396, -25746.282582200427, -25736.64438715656, -26000.001128408145, -25770.531153735996, -25562.446197956648, -25885.57919387728, -25585.13596090559, -25665.96732020764, -25656.675229452405, -25456.717753643752, -25562.242933916827, -25671.411627128025, -25864.70163439365, -25462.346071828535, -25554.082619155375, -25880.440581548897, -25614.01025244211, -25723.019301323944, -25767.108546182273, -25693.931776022073, -25934.307805282882, -25799.75016982112, -25767.052116667943, -25703.318308026996, -25738.33987263904, -25839.263566717633, -26058.03842804496, -25466.52483052838, -25723.79005705918, -25568.652334018734, -25658.751086979817, -25796.293306878513, -25637.135134172895, -25720.455000826445, -25745.1061000994, -25758.48543409182, -25494.397311504414], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.423139039762301, "mean_inference_ms": 0.2938359410773817, "mean_action_processing_ms": 0.07029666887211326, "mean_env_wait_ms": 1.7814356384982917, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0035398006439208984, "StateBufferConnector_ms": 0.0026967525482177734, "ViewRequirementAgentConnector_ms": 0.06717658042907715}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 313560, "num_agent_steps_trained": 313560, "num_env_steps_sampled": 313560, "num_env_steps_trained": 313560, "num_env_steps_sampled_this_iter": 1080, "num_env_steps_trained_this_iter": 1080, "num_env_steps_sampled_throughput_per_sec": 96.18540172243884, "num_env_steps_trained_throughput_per_sec": 96.18540172243884, "timesteps_total": 313560, "num_steps_trained_this_iter": 1080, "agent_timesteps_total": 313560, "timers": {"training_iteration_time_ms": 3780.843, "sample_time_ms": 3770.057, "load_time_ms": 0.297, "load_throughput": 1211157.006, "learn_time_ms": 9.731, "learn_throughput": 36993.785, "synch_weights_time_ms": 0.714}, "counters": {"num_env_steps_sampled": 313560, "num_env_steps_trained": 313560, "num_agent_steps_sampled": 313560, "num_agent_steps_trained": 313560}, "done": false, "episodes_total": 871, "training_iteration": 217, "trial_id": "f5e97_00000", "date": "2023-07-25_17-36-36", "timestamp": 1690295796, "time_this_iter_s": 11.231185913085938, "time_total_s": 2438.6167328357697, "pid": 71917, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[0, 0.003], [5400, 0.001], [10800, 0.00075], [16200, 0.0005], [21600, 0.00025], [27000, 0.0001], [32400, 7.5e-05], [37800, 5e-05], [43200, 2.5e-05], [48600, 1e-05], [54000, 7.5e-06], [59400, 5e-06], [64800, 2.5e-06], [70200, 1e-06], [75600, 5e-07], [81000, 1e-07]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x304530310>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 2438.6167328357697, "iterations_since_restore": 217, "perf": {"cpu_util_percent": 24.68125, "ram_util_percent": 74.55625}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-07, "entropy_coeff": 0.1, "policy_entropy": -926.6993286132813, "policy_loss": -25148450491596.8, "vf_loss": 1140454784.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 4368.0, "diff_num_grad_updates_vs_sampler_policy": 4367.0}}, "num_env_steps_sampled": 314640, "num_env_steps_trained": 314640, "num_agent_steps_sampled": 314640, "num_agent_steps_trained": 314640}, "sampler_results": {"episode_reward_max": -25456.717753643752, "episode_reward_min": -26292.74912149601, "episode_reward_mean": -25760.062929045664, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-25730.65833925668, -25846.76267862341, -26069.937320547575, -25691.9268035718, -25597.66725120839, -25753.678386930853, -25828.416214827008, -25556.145271007263, -25653.540648596365, -25626.876813574327, -25815.059498911414, -25785.900387605372, -25698.53410722529, -25928.935350527194, -25648.660592112356, -25709.853949220374, -25778.270231027287, -25804.044500571126, -25788.505674960164, -25511.44172742615, -25745.478053700404, -25637.039752774257, -25660.410542506863, -26221.080968285096, -25984.879269157755, -25893.435676587505, -25537.43144166211, -25893.649341129778, -25690.228753314994, -25611.200227393896, -25955.468063740438, -25463.58364467552, -25499.687162698836, -25991.849943571677, -26137.11117551645, -26151.304917348447, -25996.730729566603, -25914.53315627779, -25786.585052919683, -25846.28850783948, -25783.832028025026, -25627.677232823353, -26038.719815479228, -25635.922737428984, -25868.508312975722, -25991.60090523408, -25657.920462761886, -25756.19734831615, -25834.497845832582, -25624.406599402155, -25623.049176246823, -25834.387053352883, -25867.29379257149, -25643.505537482684, -25742.651422327574, -25655.41416648919, -25868.80945227319, -25847.479213891227, -25701.472246302383, -25777.462466382396, -25746.282582200427, -25736.64438715656, -26000.001128408145, -25770.531153735996, -25562.446197956648, -25885.57919387728, -25585.13596090559, -25665.96732020764, -25656.675229452405, -25456.717753643752, -25562.242933916827, -25671.411627128025, -25864.70163439365, -25462.346071828535, -25554.082619155375, -25880.440581548897, -25614.01025244211, -25723.019301323944, -25767.108546182273, -25693.931776022073, -25934.307805282882, -25799.75016982112, -25767.052116667943, -25703.318308026996, -25738.33987263904, -25839.263566717633, -26058.03842804496, -25466.52483052838, -25723.79005705918, -25568.652334018734, -25658.751086979817, -25796.293306878513, -25637.135134172895, -25720.455000826445, -25745.1061000994, -25758.48543409182, -25494.397311504414, -25789.560259672373, -25831.446464554898, -26292.74912149601], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.4306447984992845, "mean_inference_ms": 0.29417882606231777, "mean_action_processing_ms": 0.07038026730301143, "mean_env_wait_ms": 1.7837198489574226, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003538846969604492, "StateBufferConnector_ms": 0.0026998519897460938, "ViewRequirementAgentConnector_ms": 0.0672140121459961}}, "episode_reward_max": -25456.717753643752, "episode_reward_min": -26292.74912149601, "episode_reward_mean": -25760.062929045664, "episode_len_mean": 360.0, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-25730.65833925668, -25846.76267862341, -26069.937320547575, -25691.9268035718, -25597.66725120839, -25753.678386930853, -25828.416214827008, -25556.145271007263, -25653.540648596365, -25626.876813574327, -25815.059498911414, -25785.900387605372, -25698.53410722529, -25928.935350527194, -25648.660592112356, -25709.853949220374, -25778.270231027287, -25804.044500571126, -25788.505674960164, -25511.44172742615, -25745.478053700404, -25637.039752774257, -25660.410542506863, -26221.080968285096, -25984.879269157755, -25893.435676587505, -25537.43144166211, -25893.649341129778, -25690.228753314994, -25611.200227393896, -25955.468063740438, -25463.58364467552, -25499.687162698836, -25991.849943571677, -26137.11117551645, -26151.304917348447, -25996.730729566603, -25914.53315627779, -25786.585052919683, -25846.28850783948, -25783.832028025026, -25627.677232823353, -26038.719815479228, -25635.922737428984, -25868.508312975722, -25991.60090523408, -25657.920462761886, -25756.19734831615, -25834.497845832582, -25624.406599402155, -25623.049176246823, -25834.387053352883, -25867.29379257149, -25643.505537482684, -25742.651422327574, -25655.41416648919, -25868.80945227319, -25847.479213891227, -25701.472246302383, -25777.462466382396, -25746.282582200427, -25736.64438715656, -26000.001128408145, -25770.531153735996, -25562.446197956648, -25885.57919387728, -25585.13596090559, -25665.96732020764, -25656.675229452405, -25456.717753643752, -25562.242933916827, -25671.411627128025, -25864.70163439365, -25462.346071828535, -25554.082619155375, -25880.440581548897, -25614.01025244211, -25723.019301323944, -25767.108546182273, -25693.931776022073, -25934.307805282882, -25799.75016982112, -25767.052116667943, -25703.318308026996, -25738.33987263904, -25839.263566717633, -26058.03842804496, -25466.52483052838, -25723.79005705918, -25568.652334018734, -25658.751086979817, -25796.293306878513, -25637.135134172895, -25720.455000826445, -25745.1061000994, -25758.48543409182, -25494.397311504414, -25789.560259672373, -25831.446464554898, -26292.74912149601], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.4306447984992845, "mean_inference_ms": 0.29417882606231777, "mean_action_processing_ms": 0.07038026730301143, "mean_env_wait_ms": 1.7837198489574226, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003538846969604492, "StateBufferConnector_ms": 0.0026998519897460938, "ViewRequirementAgentConnector_ms": 0.0672140121459961}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 314640, "num_agent_steps_trained": 314640, "num_env_steps_sampled": 314640, "num_env_steps_trained": 314640, "num_env_steps_sampled_this_iter": 1080, "num_env_steps_trained_this_iter": 1080, "num_env_steps_sampled_throughput_per_sec": 95.6374522469695, "num_env_steps_trained_throughput_per_sec": 95.6374522469695, "timesteps_total": 314640, "num_steps_trained_this_iter": 1080, "agent_timesteps_total": 314640, "timers": {"training_iteration_time_ms": 3773.337, "sample_time_ms": 3762.628, "load_time_ms": 0.295, "load_throughput": 1218585.619, "learn_time_ms": 9.654, "learn_throughput": 37291.358, "synch_weights_time_ms": 0.716}, "counters": {"num_env_steps_sampled": 314640, "num_env_steps_trained": 314640, "num_agent_steps_sampled": 314640, "num_agent_steps_trained": 314640}, "done": false, "episodes_total": 874, "training_iteration": 218, "trial_id": "f5e97_00000", "date": "2023-07-25_17-36-48", "timestamp": 1690295808, "time_this_iter_s": 11.295597076416016, "time_total_s": 2449.9123299121857, "pid": 71917, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[0, 0.003], [5400, 0.001], [10800, 0.00075], [16200, 0.0005], [21600, 0.00025], [27000, 0.0001], [32400, 7.5e-05], [37800, 5e-05], [43200, 2.5e-05], [48600, 1e-05], [54000, 7.5e-06], [59400, 5e-06], [64800, 2.5e-06], [70200, 1e-06], [75600, 5e-07], [81000, 1e-07]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x304530310>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 2449.9123299121857, "iterations_since_restore": 218, "perf": {"cpu_util_percent": 22.200000000000003, "ram_util_percent": 74.64375}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-07, "entropy_coeff": 0.1, "policy_entropy": -926.7001342773438, "policy_loss": -19440072044544.0, "vf_loss": 1087259699.2}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 4383.0, "diff_num_grad_updates_vs_sampler_policy": 4382.0}}, "num_env_steps_sampled": 315720, "num_env_steps_trained": 315720, "num_agent_steps_sampled": 315720, "num_agent_steps_trained": 315720}, "sampler_results": {"episode_reward_max": -25456.717753643752, "episode_reward_min": -26292.74912149601, "episode_reward_mean": -25755.530752356997, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-25691.9268035718, -25597.66725120839, -25753.678386930853, -25828.416214827008, -25556.145271007263, -25653.540648596365, -25626.876813574327, -25815.059498911414, -25785.900387605372, -25698.53410722529, -25928.935350527194, -25648.660592112356, -25709.853949220374, -25778.270231027287, -25804.044500571126, -25788.505674960164, -25511.44172742615, -25745.478053700404, -25637.039752774257, -25660.410542506863, -26221.080968285096, -25984.879269157755, -25893.435676587505, -25537.43144166211, -25893.649341129778, -25690.228753314994, -25611.200227393896, -25955.468063740438, -25463.58364467552, -25499.687162698836, -25991.849943571677, -26137.11117551645, -26151.304917348447, -25996.730729566603, -25914.53315627779, -25786.585052919683, -25846.28850783948, -25783.832028025026, -25627.677232823353, -26038.719815479228, -25635.922737428984, -25868.508312975722, -25991.60090523408, -25657.920462761886, -25756.19734831615, -25834.497845832582, -25624.406599402155, -25623.049176246823, -25834.387053352883, -25867.29379257149, -25643.505537482684, -25742.651422327574, -25655.41416648919, -25868.80945227319, -25847.479213891227, -25701.472246302383, -25777.462466382396, -25746.282582200427, -25736.64438715656, -26000.001128408145, -25770.531153735996, -25562.446197956648, -25885.57919387728, -25585.13596090559, -25665.96732020764, -25656.675229452405, -25456.717753643752, -25562.242933916827, -25671.411627128025, -25864.70163439365, -25462.346071828535, -25554.082619155375, -25880.440581548897, -25614.01025244211, -25723.019301323944, -25767.108546182273, -25693.931776022073, -25934.307805282882, -25799.75016982112, -25767.052116667943, -25703.318308026996, -25738.33987263904, -25839.263566717633, -26058.03842804496, -25466.52483052838, -25723.79005705918, -25568.652334018734, -25658.751086979817, -25796.293306878513, -25637.135134172895, -25720.455000826445, -25745.1061000994, -25758.48543409182, -25494.397311504414, -25789.560259672373, -25831.446464554898, -26292.74912149601, -26025.814025900996, -25600.615904250113, -25567.710739410242], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.438111153437457, "mean_inference_ms": 0.2945191224453637, "mean_action_processing_ms": 0.07046323453872827, "mean_env_wait_ms": 1.7859885192465648, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003536701202392578, "StateBufferConnector_ms": 0.0026984214782714844, "ViewRequirementAgentConnector_ms": 0.06714248657226562}}, "episode_reward_max": -25456.717753643752, "episode_reward_min": -26292.74912149601, "episode_reward_mean": -25755.530752356997, "episode_len_mean": 360.0, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-25691.9268035718, -25597.66725120839, -25753.678386930853, -25828.416214827008, -25556.145271007263, -25653.540648596365, -25626.876813574327, -25815.059498911414, -25785.900387605372, -25698.53410722529, -25928.935350527194, -25648.660592112356, -25709.853949220374, -25778.270231027287, -25804.044500571126, -25788.505674960164, -25511.44172742615, -25745.478053700404, -25637.039752774257, -25660.410542506863, -26221.080968285096, -25984.879269157755, -25893.435676587505, -25537.43144166211, -25893.649341129778, -25690.228753314994, -25611.200227393896, -25955.468063740438, -25463.58364467552, -25499.687162698836, -25991.849943571677, -26137.11117551645, -26151.304917348447, -25996.730729566603, -25914.53315627779, -25786.585052919683, -25846.28850783948, -25783.832028025026, -25627.677232823353, -26038.719815479228, -25635.922737428984, -25868.508312975722, -25991.60090523408, -25657.920462761886, -25756.19734831615, -25834.497845832582, -25624.406599402155, -25623.049176246823, -25834.387053352883, -25867.29379257149, -25643.505537482684, -25742.651422327574, -25655.41416648919, -25868.80945227319, -25847.479213891227, -25701.472246302383, -25777.462466382396, -25746.282582200427, -25736.64438715656, -26000.001128408145, -25770.531153735996, -25562.446197956648, -25885.57919387728, -25585.13596090559, -25665.96732020764, -25656.675229452405, -25456.717753643752, -25562.242933916827, -25671.411627128025, -25864.70163439365, -25462.346071828535, -25554.082619155375, -25880.440581548897, -25614.01025244211, -25723.019301323944, -25767.108546182273, -25693.931776022073, -25934.307805282882, -25799.75016982112, -25767.052116667943, -25703.318308026996, -25738.33987263904, -25839.263566717633, -26058.03842804496, -25466.52483052838, -25723.79005705918, -25568.652334018734, -25658.751086979817, -25796.293306878513, -25637.135134172895, -25720.455000826445, -25745.1061000994, -25758.48543409182, -25494.397311504414, -25789.560259672373, -25831.446464554898, -26292.74912149601, -26025.814025900996, -25600.615904250113, -25567.710739410242], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.438111153437457, "mean_inference_ms": 0.2945191224453637, "mean_action_processing_ms": 0.07046323453872827, "mean_env_wait_ms": 1.7859885192465648, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003536701202392578, "StateBufferConnector_ms": 0.0026984214782714844, "ViewRequirementAgentConnector_ms": 0.06714248657226562}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 315720, "num_agent_steps_trained": 315720, "num_env_steps_sampled": 315720, "num_env_steps_trained": 315720, "num_env_steps_sampled_this_iter": 1080, "num_env_steps_trained_this_iter": 1080, "num_env_steps_sampled_throughput_per_sec": 95.30672751689511, "num_env_steps_trained_throughput_per_sec": 95.30672751689511, "timesteps_total": 315720, "num_steps_trained_this_iter": 1080, "agent_timesteps_total": 315720, "timers": {"training_iteration_time_ms": 3774.039, "sample_time_ms": 3763.335, "load_time_ms": 0.293, "load_throughput": 1227800.813, "learn_time_ms": 9.665, "learn_throughput": 37247.294, "synch_weights_time_ms": 0.703}, "counters": {"num_env_steps_sampled": 315720, "num_env_steps_trained": 315720, "num_agent_steps_sampled": 315720, "num_agent_steps_trained": 315720}, "done": false, "episodes_total": 877, "training_iteration": 219, "trial_id": "f5e97_00000", "date": "2023-07-25_17-36-59", "timestamp": 1690295819, "time_this_iter_s": 11.334534883499146, "time_total_s": 2461.246864795685, "pid": 71917, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[0, 0.003], [5400, 0.001], [10800, 0.00075], [16200, 0.0005], [21600, 0.00025], [27000, 0.0001], [32400, 7.5e-05], [37800, 5e-05], [43200, 2.5e-05], [48600, 1e-05], [54000, 7.5e-06], [59400, 5e-06], [64800, 2.5e-06], [70200, 1e-06], [75600, 5e-07], [81000, 1e-07]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x304530310>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 2461.246864795685, "iterations_since_restore": 219, "perf": {"cpu_util_percent": 25.2375, "ram_util_percent": 74.76249999999999}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-07, "entropy_coeff": 0.1, "policy_entropy": -926.6998291015625, "policy_loss": -31878773641216.0, "vf_loss": 1110976704.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 4398.0, "diff_num_grad_updates_vs_sampler_policy": 4397.0}}, "num_env_steps_sampled": 316800, "num_env_steps_trained": 316800, "num_agent_steps_sampled": 316800, "num_agent_steps_trained": 316800}, "sampler_results": {"episode_reward_max": -25446.56237118809, "episode_reward_min": -26292.74912149601, "episode_reward_mean": -25757.799998664832, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-25828.416214827008, -25556.145271007263, -25653.540648596365, -25626.876813574327, -25815.059498911414, -25785.900387605372, -25698.53410722529, -25928.935350527194, -25648.660592112356, -25709.853949220374, -25778.270231027287, -25804.044500571126, -25788.505674960164, -25511.44172742615, -25745.478053700404, -25637.039752774257, -25660.410542506863, -26221.080968285096, -25984.879269157755, -25893.435676587505, -25537.43144166211, -25893.649341129778, -25690.228753314994, -25611.200227393896, -25955.468063740438, -25463.58364467552, -25499.687162698836, -25991.849943571677, -26137.11117551645, -26151.304917348447, -25996.730729566603, -25914.53315627779, -25786.585052919683, -25846.28850783948, -25783.832028025026, -25627.677232823353, -26038.719815479228, -25635.922737428984, -25868.508312975722, -25991.60090523408, -25657.920462761886, -25756.19734831615, -25834.497845832582, -25624.406599402155, -25623.049176246823, -25834.387053352883, -25867.29379257149, -25643.505537482684, -25742.651422327574, -25655.41416648919, -25868.80945227319, -25847.479213891227, -25701.472246302383, -25777.462466382396, -25746.282582200427, -25736.64438715656, -26000.001128408145, -25770.531153735996, -25562.446197956648, -25885.57919387728, -25585.13596090559, -25665.96732020764, -25656.675229452405, -25456.717753643752, -25562.242933916827, -25671.411627128025, -25864.70163439365, -25462.346071828535, -25554.082619155375, -25880.440581548897, -25614.01025244211, -25723.019301323944, -25767.108546182273, -25693.931776022073, -25934.307805282882, -25799.75016982112, -25767.052116667943, -25703.318308026996, -25738.33987263904, -25839.263566717633, -26058.03842804496, -25466.52483052838, -25723.79005705918, -25568.652334018734, -25658.751086979817, -25796.293306878513, -25637.135134172895, -25720.455000826445, -25745.1061000994, -25758.48543409182, -25494.397311504414, -25789.560259672373, -25831.446464554898, -26292.74912149601, -26025.814025900996, -25600.615904250113, -25567.710739410242, -25446.56237118809, -25880.78798693058, -25942.846714375417], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.445529614588333, "mean_inference_ms": 0.29485744021776905, "mean_action_processing_ms": 0.07054566021591156, "mean_env_wait_ms": 1.7882344250228492, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0035359859466552734, "StateBufferConnector_ms": 0.0026960372924804688, "ViewRequirementAgentConnector_ms": 0.0670623779296875}}, "episode_reward_max": -25446.56237118809, "episode_reward_min": -26292.74912149601, "episode_reward_mean": -25757.799998664832, "episode_len_mean": 360.0, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-25828.416214827008, -25556.145271007263, -25653.540648596365, -25626.876813574327, -25815.059498911414, -25785.900387605372, -25698.53410722529, -25928.935350527194, -25648.660592112356, -25709.853949220374, -25778.270231027287, -25804.044500571126, -25788.505674960164, -25511.44172742615, -25745.478053700404, -25637.039752774257, -25660.410542506863, -26221.080968285096, -25984.879269157755, -25893.435676587505, -25537.43144166211, -25893.649341129778, -25690.228753314994, -25611.200227393896, -25955.468063740438, -25463.58364467552, -25499.687162698836, -25991.849943571677, -26137.11117551645, -26151.304917348447, -25996.730729566603, -25914.53315627779, -25786.585052919683, -25846.28850783948, -25783.832028025026, -25627.677232823353, -26038.719815479228, -25635.922737428984, -25868.508312975722, -25991.60090523408, -25657.920462761886, -25756.19734831615, -25834.497845832582, -25624.406599402155, -25623.049176246823, -25834.387053352883, -25867.29379257149, -25643.505537482684, -25742.651422327574, -25655.41416648919, -25868.80945227319, -25847.479213891227, -25701.472246302383, -25777.462466382396, -25746.282582200427, -25736.64438715656, -26000.001128408145, -25770.531153735996, -25562.446197956648, -25885.57919387728, -25585.13596090559, -25665.96732020764, -25656.675229452405, -25456.717753643752, -25562.242933916827, -25671.411627128025, -25864.70163439365, -25462.346071828535, -25554.082619155375, -25880.440581548897, -25614.01025244211, -25723.019301323944, -25767.108546182273, -25693.931776022073, -25934.307805282882, -25799.75016982112, -25767.052116667943, -25703.318308026996, -25738.33987263904, -25839.263566717633, -26058.03842804496, -25466.52483052838, -25723.79005705918, -25568.652334018734, -25658.751086979817, -25796.293306878513, -25637.135134172895, -25720.455000826445, -25745.1061000994, -25758.48543409182, -25494.397311504414, -25789.560259672373, -25831.446464554898, -26292.74912149601, -26025.814025900996, -25600.615904250113, -25567.710739410242, -25446.56237118809, -25880.78798693058, -25942.846714375417], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.445529614588333, "mean_inference_ms": 0.29485744021776905, "mean_action_processing_ms": 0.07054566021591156, "mean_env_wait_ms": 1.7882344250228492, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0035359859466552734, "StateBufferConnector_ms": 0.0026960372924804688, "ViewRequirementAgentConnector_ms": 0.0670623779296875}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 316800, "num_agent_steps_trained": 316800, "num_env_steps_sampled": 316800, "num_env_steps_trained": 316800, "num_env_steps_sampled_this_iter": 1080, "num_env_steps_trained_this_iter": 1080, "num_env_steps_sampled_throughput_per_sec": 95.60316494639227, "num_env_steps_trained_throughput_per_sec": 95.60316494639227, "timesteps_total": 316800, "num_steps_trained_this_iter": 1080, "agent_timesteps_total": 316800, "timers": {"training_iteration_time_ms": 3774.753, "sample_time_ms": 3764.022, "load_time_ms": 0.294, "load_throughput": 1226105.92, "learn_time_ms": 9.701, "learn_throughput": 37108.339, "synch_weights_time_ms": 0.693}, "counters": {"num_env_steps_sampled": 316800, "num_env_steps_trained": 316800, "num_agent_steps_sampled": 316800, "num_agent_steps_trained": 316800}, "done": false, "episodes_total": 880, "training_iteration": 220, "trial_id": "f5e97_00000", "date": "2023-07-25_17-37-10", "timestamp": 1690295830, "time_this_iter_s": 11.299439191818237, "time_total_s": 2472.546303987503, "pid": 71917, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[0, 0.003], [5400, 0.001], [10800, 0.00075], [16200, 0.0005], [21600, 0.00025], [27000, 0.0001], [32400, 7.5e-05], [37800, 5e-05], [43200, 2.5e-05], [48600, 1e-05], [54000, 7.5e-06], [59400, 5e-06], [64800, 2.5e-06], [70200, 1e-06], [75600, 5e-07], [81000, 1e-07]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x304530310>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 2472.546303987503, "iterations_since_restore": 220, "perf": {"cpu_util_percent": 25.35625, "ram_util_percent": 74.86874999999999}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-07, "entropy_coeff": 0.1, "policy_entropy": -926.7000244140625, "policy_loss": -12128133785190.4, "vf_loss": 1086922067.2}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 4413.0, "diff_num_grad_updates_vs_sampler_policy": 4412.0}}, "num_env_steps_sampled": 317880, "num_env_steps_trained": 317880, "num_agent_steps_sampled": 317880, "num_agent_steps_trained": 317880}, "sampler_results": {"episode_reward_max": -25446.56237118809, "episode_reward_min": -26292.74912149601, "episode_reward_mean": -25755.767275169248, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-25626.876813574327, -25815.059498911414, -25785.900387605372, -25698.53410722529, -25928.935350527194, -25648.660592112356, -25709.853949220374, -25778.270231027287, -25804.044500571126, -25788.505674960164, -25511.44172742615, -25745.478053700404, -25637.039752774257, -25660.410542506863, -26221.080968285096, -25984.879269157755, -25893.435676587505, -25537.43144166211, -25893.649341129778, -25690.228753314994, -25611.200227393896, -25955.468063740438, -25463.58364467552, -25499.687162698836, -25991.849943571677, -26137.11117551645, -26151.304917348447, -25996.730729566603, -25914.53315627779, -25786.585052919683, -25846.28850783948, -25783.832028025026, -25627.677232823353, -26038.719815479228, -25635.922737428984, -25868.508312975722, -25991.60090523408, -25657.920462761886, -25756.19734831615, -25834.497845832582, -25624.406599402155, -25623.049176246823, -25834.387053352883, -25867.29379257149, -25643.505537482684, -25742.651422327574, -25655.41416648919, -25868.80945227319, -25847.479213891227, -25701.472246302383, -25777.462466382396, -25746.282582200427, -25736.64438715656, -26000.001128408145, -25770.531153735996, -25562.446197956648, -25885.57919387728, -25585.13596090559, -25665.96732020764, -25656.675229452405, -25456.717753643752, -25562.242933916827, -25671.411627128025, -25864.70163439365, -25462.346071828535, -25554.082619155375, -25880.440581548897, -25614.01025244211, -25723.019301323944, -25767.108546182273, -25693.931776022073, -25934.307805282882, -25799.75016982112, -25767.052116667943, -25703.318308026996, -25738.33987263904, -25839.263566717633, -26058.03842804496, -25466.52483052838, -25723.79005705918, -25568.652334018734, -25658.751086979817, -25796.293306878513, -25637.135134172895, -25720.455000826445, -25745.1061000994, -25758.48543409182, -25494.397311504414, -25789.560259672373, -25831.446464554898, -26292.74912149601, -26025.814025900996, -25600.615904250113, -25567.710739410242, -25446.56237118809, -25880.78798693058, -25942.846714375417, -25594.024268471265, -25579.20574384092, -25661.59977255986], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.452894222654102, "mean_inference_ms": 0.29519330957199214, "mean_action_processing_ms": 0.07062749005436084, "mean_env_wait_ms": 1.7904616076791107, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0035452842712402344, "StateBufferConnector_ms": 0.002695798873901367, "ViewRequirementAgentConnector_ms": 0.06710577011108398}}, "episode_reward_max": -25446.56237118809, "episode_reward_min": -26292.74912149601, "episode_reward_mean": -25755.767275169248, "episode_len_mean": 360.0, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-25626.876813574327, -25815.059498911414, -25785.900387605372, -25698.53410722529, -25928.935350527194, -25648.660592112356, -25709.853949220374, -25778.270231027287, -25804.044500571126, -25788.505674960164, -25511.44172742615, -25745.478053700404, -25637.039752774257, -25660.410542506863, -26221.080968285096, -25984.879269157755, -25893.435676587505, -25537.43144166211, -25893.649341129778, -25690.228753314994, -25611.200227393896, -25955.468063740438, -25463.58364467552, -25499.687162698836, -25991.849943571677, -26137.11117551645, -26151.304917348447, -25996.730729566603, -25914.53315627779, -25786.585052919683, -25846.28850783948, -25783.832028025026, -25627.677232823353, -26038.719815479228, -25635.922737428984, -25868.508312975722, -25991.60090523408, -25657.920462761886, -25756.19734831615, -25834.497845832582, -25624.406599402155, -25623.049176246823, -25834.387053352883, -25867.29379257149, -25643.505537482684, -25742.651422327574, -25655.41416648919, -25868.80945227319, -25847.479213891227, -25701.472246302383, -25777.462466382396, -25746.282582200427, -25736.64438715656, -26000.001128408145, -25770.531153735996, -25562.446197956648, -25885.57919387728, -25585.13596090559, -25665.96732020764, -25656.675229452405, -25456.717753643752, -25562.242933916827, -25671.411627128025, -25864.70163439365, -25462.346071828535, -25554.082619155375, -25880.440581548897, -25614.01025244211, -25723.019301323944, -25767.108546182273, -25693.931776022073, -25934.307805282882, -25799.75016982112, -25767.052116667943, -25703.318308026996, -25738.33987263904, -25839.263566717633, -26058.03842804496, -25466.52483052838, -25723.79005705918, -25568.652334018734, -25658.751086979817, -25796.293306878513, -25637.135134172895, -25720.455000826445, -25745.1061000994, -25758.48543409182, -25494.397311504414, -25789.560259672373, -25831.446464554898, -26292.74912149601, -26025.814025900996, -25600.615904250113, -25567.710739410242, -25446.56237118809, -25880.78798693058, -25942.846714375417, -25594.024268471265, -25579.20574384092, -25661.59977255986], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.452894222654102, "mean_inference_ms": 0.29519330957199214, "mean_action_processing_ms": 0.07062749005436084, "mean_env_wait_ms": 1.7904616076791107, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0035452842712402344, "StateBufferConnector_ms": 0.002695798873901367, "ViewRequirementAgentConnector_ms": 0.06710577011108398}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 317880, "num_agent_steps_trained": 317880, "num_env_steps_sampled": 317880, "num_env_steps_trained": 317880, "num_env_steps_sampled_this_iter": 1080, "num_env_steps_trained_this_iter": 1080, "num_env_steps_sampled_throughput_per_sec": 95.37601833100022, "num_env_steps_trained_throughput_per_sec": 95.37601833100022, "timesteps_total": 317880, "num_steps_trained_this_iter": 1080, "agent_timesteps_total": 317880, "timers": {"training_iteration_time_ms": 3772.473, "sample_time_ms": 3761.647, "load_time_ms": 0.295, "load_throughput": 1221246.716, "learn_time_ms": 9.782, "learn_throughput": 36800.838, "synch_weights_time_ms": 0.706}, "counters": {"num_env_steps_sampled": 317880, "num_env_steps_trained": 317880, "num_agent_steps_sampled": 317880, "num_agent_steps_trained": 317880}, "done": false, "episodes_total": 883, "training_iteration": 221, "trial_id": "f5e97_00000", "date": "2023-07-25_17-37-22", "timestamp": 1690295842, "time_this_iter_s": 11.326396942138672, "time_total_s": 2483.8727009296417, "pid": 71917, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[0, 0.003], [5400, 0.001], [10800, 0.00075], [16200, 0.0005], [21600, 0.00025], [27000, 0.0001], [32400, 7.5e-05], [37800, 5e-05], [43200, 2.5e-05], [48600, 1e-05], [54000, 7.5e-06], [59400, 5e-06], [64800, 2.5e-06], [70200, 1e-06], [75600, 5e-07], [81000, 1e-07]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x304530310>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 2483.8727009296417, "iterations_since_restore": 221, "perf": {"cpu_util_percent": 24.18125, "ram_util_percent": 74.8}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-07, "entropy_coeff": 0.1, "policy_entropy": -926.6997680664062, "policy_loss": -24133174244147.2, "vf_loss": 1112215584.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 4428.0, "diff_num_grad_updates_vs_sampler_policy": 4427.0}}, "num_env_steps_sampled": 318960, "num_env_steps_trained": 318960, "num_agent_steps_sampled": 318960, "num_agent_steps_trained": 318960}, "sampler_results": {"episode_reward_max": -25446.56237118809, "episode_reward_min": -26292.74912149601, "episode_reward_mean": -25756.981061178707, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-25698.53410722529, -25928.935350527194, -25648.660592112356, -25709.853949220374, -25778.270231027287, -25804.044500571126, -25788.505674960164, -25511.44172742615, -25745.478053700404, -25637.039752774257, -25660.410542506863, -26221.080968285096, -25984.879269157755, -25893.435676587505, -25537.43144166211, -25893.649341129778, -25690.228753314994, -25611.200227393896, -25955.468063740438, -25463.58364467552, -25499.687162698836, -25991.849943571677, -26137.11117551645, -26151.304917348447, -25996.730729566603, -25914.53315627779, -25786.585052919683, -25846.28850783948, -25783.832028025026, -25627.677232823353, -26038.719815479228, -25635.922737428984, -25868.508312975722, -25991.60090523408, -25657.920462761886, -25756.19734831615, -25834.497845832582, -25624.406599402155, -25623.049176246823, -25834.387053352883, -25867.29379257149, -25643.505537482684, -25742.651422327574, -25655.41416648919, -25868.80945227319, -25847.479213891227, -25701.472246302383, -25777.462466382396, -25746.282582200427, -25736.64438715656, -26000.001128408145, -25770.531153735996, -25562.446197956648, -25885.57919387728, -25585.13596090559, -25665.96732020764, -25656.675229452405, -25456.717753643752, -25562.242933916827, -25671.411627128025, -25864.70163439365, -25462.346071828535, -25554.082619155375, -25880.440581548897, -25614.01025244211, -25723.019301323944, -25767.108546182273, -25693.931776022073, -25934.307805282882, -25799.75016982112, -25767.052116667943, -25703.318308026996, -25738.33987263904, -25839.263566717633, -26058.03842804496, -25466.52483052838, -25723.79005705918, -25568.652334018734, -25658.751086979817, -25796.293306878513, -25637.135134172895, -25720.455000826445, -25745.1061000994, -25758.48543409182, -25494.397311504414, -25789.560259672373, -25831.446464554898, -26292.74912149601, -26025.814025900996, -25600.615904250113, -25567.710739410242, -25446.56237118809, -25880.78798693058, -25942.846714375417, -25594.024268471265, -25579.20574384092, -25661.59977255986, -25598.831299808346, -25899.70477172812, -25850.679229500052], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.460194394892941, "mean_inference_ms": 0.2955272974903816, "mean_action_processing_ms": 0.07070884192366368, "mean_env_wait_ms": 1.7926772132342617, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003548145294189453, "StateBufferConnector_ms": 0.0027065277099609375, "ViewRequirementAgentConnector_ms": 0.0672459602355957}}, "episode_reward_max": -25446.56237118809, "episode_reward_min": -26292.74912149601, "episode_reward_mean": -25756.981061178707, "episode_len_mean": 360.0, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-25698.53410722529, -25928.935350527194, -25648.660592112356, -25709.853949220374, -25778.270231027287, -25804.044500571126, -25788.505674960164, -25511.44172742615, -25745.478053700404, -25637.039752774257, -25660.410542506863, -26221.080968285096, -25984.879269157755, -25893.435676587505, -25537.43144166211, -25893.649341129778, -25690.228753314994, -25611.200227393896, -25955.468063740438, -25463.58364467552, -25499.687162698836, -25991.849943571677, -26137.11117551645, -26151.304917348447, -25996.730729566603, -25914.53315627779, -25786.585052919683, -25846.28850783948, -25783.832028025026, -25627.677232823353, -26038.719815479228, -25635.922737428984, -25868.508312975722, -25991.60090523408, -25657.920462761886, -25756.19734831615, -25834.497845832582, -25624.406599402155, -25623.049176246823, -25834.387053352883, -25867.29379257149, -25643.505537482684, -25742.651422327574, -25655.41416648919, -25868.80945227319, -25847.479213891227, -25701.472246302383, -25777.462466382396, -25746.282582200427, -25736.64438715656, -26000.001128408145, -25770.531153735996, -25562.446197956648, -25885.57919387728, -25585.13596090559, -25665.96732020764, -25656.675229452405, -25456.717753643752, -25562.242933916827, -25671.411627128025, -25864.70163439365, -25462.346071828535, -25554.082619155375, -25880.440581548897, -25614.01025244211, -25723.019301323944, -25767.108546182273, -25693.931776022073, -25934.307805282882, -25799.75016982112, -25767.052116667943, -25703.318308026996, -25738.33987263904, -25839.263566717633, -26058.03842804496, -25466.52483052838, -25723.79005705918, -25568.652334018734, -25658.751086979817, -25796.293306878513, -25637.135134172895, -25720.455000826445, -25745.1061000994, -25758.48543409182, -25494.397311504414, -25789.560259672373, -25831.446464554898, -26292.74912149601, -26025.814025900996, -25600.615904250113, -25567.710739410242, -25446.56237118809, -25880.78798693058, -25942.846714375417, -25594.024268471265, -25579.20574384092, -25661.59977255986, -25598.831299808346, -25899.70477172812, -25850.679229500052], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.460194394892941, "mean_inference_ms": 0.2955272974903816, "mean_action_processing_ms": 0.07070884192366368, "mean_env_wait_ms": 1.7926772132342617, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003548145294189453, "StateBufferConnector_ms": 0.0027065277099609375, "ViewRequirementAgentConnector_ms": 0.0672459602355957}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 318960, "num_agent_steps_trained": 318960, "num_env_steps_sampled": 318960, "num_env_steps_trained": 318960, "num_env_steps_sampled_this_iter": 1080, "num_env_steps_trained_this_iter": 1080, "num_env_steps_sampled_throughput_per_sec": 95.98415788816594, "num_env_steps_trained_throughput_per_sec": 95.98415788816594, "timesteps_total": 318960, "num_steps_trained_this_iter": 1080, "agent_timesteps_total": 318960, "timers": {"training_iteration_time_ms": 3749.51, "sample_time_ms": 3738.703, "load_time_ms": 0.303, "load_throughput": 1188842.957, "learn_time_ms": 9.754, "learn_throughput": 36908.153, "synch_weights_time_ms": 0.706}, "counters": {"num_env_steps_sampled": 318960, "num_env_steps_trained": 318960, "num_agent_steps_sampled": 318960, "num_agent_steps_trained": 318960}, "done": false, "episodes_total": 886, "training_iteration": 222, "trial_id": "f5e97_00000", "date": "2023-07-25_17-37-33", "timestamp": 1690295853, "time_this_iter_s": 11.25487208366394, "time_total_s": 2495.1275730133057, "pid": 71917, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[0, 0.003], [5400, 0.001], [10800, 0.00075], [16200, 0.0005], [21600, 0.00025], [27000, 0.0001], [32400, 7.5e-05], [37800, 5e-05], [43200, 2.5e-05], [48600, 1e-05], [54000, 7.5e-06], [59400, 5e-06], [64800, 2.5e-06], [70200, 1e-06], [75600, 5e-07], [81000, 1e-07]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x304530310>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 2495.1275730133057, "iterations_since_restore": 222, "perf": {"cpu_util_percent": 21.71875, "ram_util_percent": 74.88125}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-07, "entropy_coeff": 0.1, "policy_entropy": -926.6999633789062, "policy_loss": -17406232979046.4, "vf_loss": 1076516768.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 4443.0, "diff_num_grad_updates_vs_sampler_policy": 4442.0}}, "num_env_steps_sampled": 320040, "num_env_steps_trained": 320040, "num_agent_steps_sampled": 320040, "num_agent_steps_trained": 320040}, "sampler_results": {"episode_reward_max": -25446.56237118809, "episode_reward_min": -26292.74912149601, "episode_reward_mean": -25753.170932362253, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-25709.853949220374, -25778.270231027287, -25804.044500571126, -25788.505674960164, -25511.44172742615, -25745.478053700404, -25637.039752774257, -25660.410542506863, -26221.080968285096, -25984.879269157755, -25893.435676587505, -25537.43144166211, -25893.649341129778, -25690.228753314994, -25611.200227393896, -25955.468063740438, -25463.58364467552, -25499.687162698836, -25991.849943571677, -26137.11117551645, -26151.304917348447, -25996.730729566603, -25914.53315627779, -25786.585052919683, -25846.28850783948, -25783.832028025026, -25627.677232823353, -26038.719815479228, -25635.922737428984, -25868.508312975722, -25991.60090523408, -25657.920462761886, -25756.19734831615, -25834.497845832582, -25624.406599402155, -25623.049176246823, -25834.387053352883, -25867.29379257149, -25643.505537482684, -25742.651422327574, -25655.41416648919, -25868.80945227319, -25847.479213891227, -25701.472246302383, -25777.462466382396, -25746.282582200427, -25736.64438715656, -26000.001128408145, -25770.531153735996, -25562.446197956648, -25885.57919387728, -25585.13596090559, -25665.96732020764, -25656.675229452405, -25456.717753643752, -25562.242933916827, -25671.411627128025, -25864.70163439365, -25462.346071828535, -25554.082619155375, -25880.440581548897, -25614.01025244211, -25723.019301323944, -25767.108546182273, -25693.931776022073, -25934.307805282882, -25799.75016982112, -25767.052116667943, -25703.318308026996, -25738.33987263904, -25839.263566717633, -26058.03842804496, -25466.52483052838, -25723.79005705918, -25568.652334018734, -25658.751086979817, -25796.293306878513, -25637.135134172895, -25720.455000826445, -25745.1061000994, -25758.48543409182, -25494.397311504414, -25789.560259672373, -25831.446464554898, -26292.74912149601, -26025.814025900996, -25600.615904250113, -25567.710739410242, -25446.56237118809, -25880.78798693058, -25942.846714375417, -25594.024268471265, -25579.20574384092, -25661.59977255986, -25598.831299808346, -25899.70477172812, -25850.679229500052, -25544.127208032158, -25874.947030441388, -25476.042929746214], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.467444764417567, "mean_inference_ms": 0.29585894550798814, "mean_action_processing_ms": 0.07078964636886104, "mean_env_wait_ms": 1.794871727506574, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0035400390625, "StateBufferConnector_ms": 0.002712726593017578, "ViewRequirementAgentConnector_ms": 0.06716156005859375}}, "episode_reward_max": -25446.56237118809, "episode_reward_min": -26292.74912149601, "episode_reward_mean": -25753.170932362253, "episode_len_mean": 360.0, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-25709.853949220374, -25778.270231027287, -25804.044500571126, -25788.505674960164, -25511.44172742615, -25745.478053700404, -25637.039752774257, -25660.410542506863, -26221.080968285096, -25984.879269157755, -25893.435676587505, -25537.43144166211, -25893.649341129778, -25690.228753314994, -25611.200227393896, -25955.468063740438, -25463.58364467552, -25499.687162698836, -25991.849943571677, -26137.11117551645, -26151.304917348447, -25996.730729566603, -25914.53315627779, -25786.585052919683, -25846.28850783948, -25783.832028025026, -25627.677232823353, -26038.719815479228, -25635.922737428984, -25868.508312975722, -25991.60090523408, -25657.920462761886, -25756.19734831615, -25834.497845832582, -25624.406599402155, -25623.049176246823, -25834.387053352883, -25867.29379257149, -25643.505537482684, -25742.651422327574, -25655.41416648919, -25868.80945227319, -25847.479213891227, -25701.472246302383, -25777.462466382396, -25746.282582200427, -25736.64438715656, -26000.001128408145, -25770.531153735996, -25562.446197956648, -25885.57919387728, -25585.13596090559, -25665.96732020764, -25656.675229452405, -25456.717753643752, -25562.242933916827, -25671.411627128025, -25864.70163439365, -25462.346071828535, -25554.082619155375, -25880.440581548897, -25614.01025244211, -25723.019301323944, -25767.108546182273, -25693.931776022073, -25934.307805282882, -25799.75016982112, -25767.052116667943, -25703.318308026996, -25738.33987263904, -25839.263566717633, -26058.03842804496, -25466.52483052838, -25723.79005705918, -25568.652334018734, -25658.751086979817, -25796.293306878513, -25637.135134172895, -25720.455000826445, -25745.1061000994, -25758.48543409182, -25494.397311504414, -25789.560259672373, -25831.446464554898, -26292.74912149601, -26025.814025900996, -25600.615904250113, -25567.710739410242, -25446.56237118809, -25880.78798693058, -25942.846714375417, -25594.024268471265, -25579.20574384092, -25661.59977255986, -25598.831299808346, -25899.70477172812, -25850.679229500052, -25544.127208032158, -25874.947030441388, -25476.042929746214], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.467444764417567, "mean_inference_ms": 0.29585894550798814, "mean_action_processing_ms": 0.07078964636886104, "mean_env_wait_ms": 1.794871727506574, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0035400390625, "StateBufferConnector_ms": 0.002712726593017578, "ViewRequirementAgentConnector_ms": 0.06716156005859375}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 320040, "num_agent_steps_trained": 320040, "num_env_steps_sampled": 320040, "num_env_steps_trained": 320040, "num_env_steps_sampled_this_iter": 1080, "num_env_steps_trained_this_iter": 1080, "num_env_steps_sampled_throughput_per_sec": 95.27821370714493, "num_env_steps_trained_throughput_per_sec": 95.27821370714493, "timesteps_total": 320040, "num_steps_trained_this_iter": 1080, "agent_timesteps_total": 320040, "timers": {"training_iteration_time_ms": 3754.11, "sample_time_ms": 3743.209, "load_time_ms": 0.307, "load_throughput": 1174144.199, "learn_time_ms": 9.814, "learn_throughput": 36681.666, "synch_weights_time_ms": 0.73}, "counters": {"num_env_steps_sampled": 320040, "num_env_steps_trained": 320040, "num_agent_steps_sampled": 320040, "num_agent_steps_trained": 320040}, "done": false, "episodes_total": 889, "training_iteration": 223, "trial_id": "f5e97_00000", "date": "2023-07-25_17-37-44", "timestamp": 1690295864, "time_this_iter_s": 11.337999105453491, "time_total_s": 2506.465572118759, "pid": 71917, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[0, 0.003], [5400, 0.001], [10800, 0.00075], [16200, 0.0005], [21600, 0.00025], [27000, 0.0001], [32400, 7.5e-05], [37800, 5e-05], [43200, 2.5e-05], [48600, 1e-05], [54000, 7.5e-06], [59400, 5e-06], [64800, 2.5e-06], [70200, 1e-06], [75600, 5e-07], [81000, 1e-07]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x304530310>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 2506.465572118759, "iterations_since_restore": 223, "perf": {"cpu_util_percent": 24.2625, "ram_util_percent": 74.70625}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-07, "entropy_coeff": 0.1, "policy_entropy": -926.6999145507813, "policy_loss": -29031518030233.6, "vf_loss": 1102599827.2}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 4458.0, "diff_num_grad_updates_vs_sampler_policy": 4457.0}}, "num_env_steps_sampled": 321120, "num_env_steps_trained": 321120, "num_agent_steps_sampled": 321120, "num_agent_steps_trained": 321120}, "sampler_results": {"episode_reward_max": -25434.221900294273, "episode_reward_min": -26292.74912149601, "episode_reward_mean": -25751.023266095417, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-25788.505674960164, -25511.44172742615, -25745.478053700404, -25637.039752774257, -25660.410542506863, -26221.080968285096, -25984.879269157755, -25893.435676587505, -25537.43144166211, -25893.649341129778, -25690.228753314994, -25611.200227393896, -25955.468063740438, -25463.58364467552, -25499.687162698836, -25991.849943571677, -26137.11117551645, -26151.304917348447, -25996.730729566603, -25914.53315627779, -25786.585052919683, -25846.28850783948, -25783.832028025026, -25627.677232823353, -26038.719815479228, -25635.922737428984, -25868.508312975722, -25991.60090523408, -25657.920462761886, -25756.19734831615, -25834.497845832582, -25624.406599402155, -25623.049176246823, -25834.387053352883, -25867.29379257149, -25643.505537482684, -25742.651422327574, -25655.41416648919, -25868.80945227319, -25847.479213891227, -25701.472246302383, -25777.462466382396, -25746.282582200427, -25736.64438715656, -26000.001128408145, -25770.531153735996, -25562.446197956648, -25885.57919387728, -25585.13596090559, -25665.96732020764, -25656.675229452405, -25456.717753643752, -25562.242933916827, -25671.411627128025, -25864.70163439365, -25462.346071828535, -25554.082619155375, -25880.440581548897, -25614.01025244211, -25723.019301323944, -25767.108546182273, -25693.931776022073, -25934.307805282882, -25799.75016982112, -25767.052116667943, -25703.318308026996, -25738.33987263904, -25839.263566717633, -26058.03842804496, -25466.52483052838, -25723.79005705918, -25568.652334018734, -25658.751086979817, -25796.293306878513, -25637.135134172895, -25720.455000826445, -25745.1061000994, -25758.48543409182, -25494.397311504414, -25789.560259672373, -25831.446464554898, -26292.74912149601, -26025.814025900996, -25600.615904250113, -25567.710739410242, -25446.56237118809, -25880.78798693058, -25942.846714375417, -25594.024268471265, -25579.20574384092, -25661.59977255986, -25598.831299808346, -25899.70477172812, -25850.679229500052, -25544.127208032158, -25874.947030441388, -25476.042929746214, -25434.221900294273, -25831.365619237313, -25811.81453460429], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.4746403548582645, "mean_inference_ms": 0.29618735301324756, "mean_action_processing_ms": 0.0708697122727494, "mean_env_wait_ms": 1.7970562418981404, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003541707992553711, "StateBufferConnector_ms": 0.0027086734771728516, "ViewRequirementAgentConnector_ms": 0.06714725494384766}}, "episode_reward_max": -25434.221900294273, "episode_reward_min": -26292.74912149601, "episode_reward_mean": -25751.023266095417, "episode_len_mean": 360.0, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-25788.505674960164, -25511.44172742615, -25745.478053700404, -25637.039752774257, -25660.410542506863, -26221.080968285096, -25984.879269157755, -25893.435676587505, -25537.43144166211, -25893.649341129778, -25690.228753314994, -25611.200227393896, -25955.468063740438, -25463.58364467552, -25499.687162698836, -25991.849943571677, -26137.11117551645, -26151.304917348447, -25996.730729566603, -25914.53315627779, -25786.585052919683, -25846.28850783948, -25783.832028025026, -25627.677232823353, -26038.719815479228, -25635.922737428984, -25868.508312975722, -25991.60090523408, -25657.920462761886, -25756.19734831615, -25834.497845832582, -25624.406599402155, -25623.049176246823, -25834.387053352883, -25867.29379257149, -25643.505537482684, -25742.651422327574, -25655.41416648919, -25868.80945227319, -25847.479213891227, -25701.472246302383, -25777.462466382396, -25746.282582200427, -25736.64438715656, -26000.001128408145, -25770.531153735996, -25562.446197956648, -25885.57919387728, -25585.13596090559, -25665.96732020764, -25656.675229452405, -25456.717753643752, -25562.242933916827, -25671.411627128025, -25864.70163439365, -25462.346071828535, -25554.082619155375, -25880.440581548897, -25614.01025244211, -25723.019301323944, -25767.108546182273, -25693.931776022073, -25934.307805282882, -25799.75016982112, -25767.052116667943, -25703.318308026996, -25738.33987263904, -25839.263566717633, -26058.03842804496, -25466.52483052838, -25723.79005705918, -25568.652334018734, -25658.751086979817, -25796.293306878513, -25637.135134172895, -25720.455000826445, -25745.1061000994, -25758.48543409182, -25494.397311504414, -25789.560259672373, -25831.446464554898, -26292.74912149601, -26025.814025900996, -25600.615904250113, -25567.710739410242, -25446.56237118809, -25880.78798693058, -25942.846714375417, -25594.024268471265, -25579.20574384092, -25661.59977255986, -25598.831299808346, -25899.70477172812, -25850.679229500052, -25544.127208032158, -25874.947030441388, -25476.042929746214, -25434.221900294273, -25831.365619237313, -25811.81453460429], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.4746403548582645, "mean_inference_ms": 0.29618735301324756, "mean_action_processing_ms": 0.0708697122727494, "mean_env_wait_ms": 1.7970562418981404, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003541707992553711, "StateBufferConnector_ms": 0.0027086734771728516, "ViewRequirementAgentConnector_ms": 0.06714725494384766}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 321120, "num_agent_steps_trained": 321120, "num_env_steps_sampled": 321120, "num_env_steps_trained": 321120, "num_env_steps_sampled_this_iter": 1080, "num_env_steps_trained_this_iter": 1080, "num_env_steps_sampled_throughput_per_sec": 94.91419155481817, "num_env_steps_trained_throughput_per_sec": 94.91419155481817, "timesteps_total": 321120, "num_steps_trained_this_iter": 1080, "agent_timesteps_total": 321120, "timers": {"training_iteration_time_ms": 3770.032, "sample_time_ms": 3759.141, "load_time_ms": 0.306, "load_throughput": 1174600.887, "learn_time_ms": 9.801, "learn_throughput": 36732.62, "synch_weights_time_ms": 0.733}, "counters": {"num_env_steps_sampled": 321120, "num_env_steps_trained": 321120, "num_agent_steps_sampled": 321120, "num_agent_steps_trained": 321120}, "done": false, "episodes_total": 892, "training_iteration": 224, "trial_id": "f5e97_00000", "date": "2023-07-25_17-37-56", "timestamp": 1690295876, "time_this_iter_s": 11.381525039672852, "time_total_s": 2517.847097158432, "pid": 71917, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[0, 0.003], [5400, 0.001], [10800, 0.00075], [16200, 0.0005], [21600, 0.00025], [27000, 0.0001], [32400, 7.5e-05], [37800, 5e-05], [43200, 2.5e-05], [48600, 1e-05], [54000, 7.5e-06], [59400, 5e-06], [64800, 2.5e-06], [70200, 1e-06], [75600, 5e-07], [81000, 1e-07]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x304530310>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 2517.847097158432, "iterations_since_restore": 224, "perf": {"cpu_util_percent": 22.97058823529412, "ram_util_percent": 74.85882352941178}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-07, "entropy_coeff": 0.1, "policy_entropy": -926.7000610351563, "policy_loss": -23116045929676.8, "vf_loss": 1084559820.8}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 4473.0, "diff_num_grad_updates_vs_sampler_policy": 4472.0}}, "num_env_steps_sampled": 322200, "num_env_steps_trained": 322200, "num_agent_steps_sampled": 322200, "num_agent_steps_trained": 322200}, "sampler_results": {"episode_reward_max": -25434.221900294273, "episode_reward_min": -26292.74912149601, "episode_reward_mean": -25752.822653719537, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-25637.039752774257, -25660.410542506863, -26221.080968285096, -25984.879269157755, -25893.435676587505, -25537.43144166211, -25893.649341129778, -25690.228753314994, -25611.200227393896, -25955.468063740438, -25463.58364467552, -25499.687162698836, -25991.849943571677, -26137.11117551645, -26151.304917348447, -25996.730729566603, -25914.53315627779, -25786.585052919683, -25846.28850783948, -25783.832028025026, -25627.677232823353, -26038.719815479228, -25635.922737428984, -25868.508312975722, -25991.60090523408, -25657.920462761886, -25756.19734831615, -25834.497845832582, -25624.406599402155, -25623.049176246823, -25834.387053352883, -25867.29379257149, -25643.505537482684, -25742.651422327574, -25655.41416648919, -25868.80945227319, -25847.479213891227, -25701.472246302383, -25777.462466382396, -25746.282582200427, -25736.64438715656, -26000.001128408145, -25770.531153735996, -25562.446197956648, -25885.57919387728, -25585.13596090559, -25665.96732020764, -25656.675229452405, -25456.717753643752, -25562.242933916827, -25671.411627128025, -25864.70163439365, -25462.346071828535, -25554.082619155375, -25880.440581548897, -25614.01025244211, -25723.019301323944, -25767.108546182273, -25693.931776022073, -25934.307805282882, -25799.75016982112, -25767.052116667943, -25703.318308026996, -25738.33987263904, -25839.263566717633, -26058.03842804496, -25466.52483052838, -25723.79005705918, -25568.652334018734, -25658.751086979817, -25796.293306878513, -25637.135134172895, -25720.455000826445, -25745.1061000994, -25758.48543409182, -25494.397311504414, -25789.560259672373, -25831.446464554898, -26292.74912149601, -26025.814025900996, -25600.615904250113, -25567.710739410242, -25446.56237118809, -25880.78798693058, -25942.846714375417, -25594.024268471265, -25579.20574384092, -25661.59977255986, -25598.831299808346, -25899.70477172812, -25850.679229500052, -25544.127208032158, -25874.947030441388, -25476.042929746214, -25434.221900294273, -25831.365619237313, -25811.81453460429, -25673.72611278101, -25990.10945101598, -25561.52865470146], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.481773882827721, "mean_inference_ms": 0.2965135753564629, "mean_action_processing_ms": 0.07094917919691848, "mean_env_wait_ms": 1.7992306506761515, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0035605430603027344, "StateBufferConnector_ms": 0.0027146339416503906, "ViewRequirementAgentConnector_ms": 0.06741070747375488}}, "episode_reward_max": -25434.221900294273, "episode_reward_min": -26292.74912149601, "episode_reward_mean": -25752.822653719537, "episode_len_mean": 360.0, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-25637.039752774257, -25660.410542506863, -26221.080968285096, -25984.879269157755, -25893.435676587505, -25537.43144166211, -25893.649341129778, -25690.228753314994, -25611.200227393896, -25955.468063740438, -25463.58364467552, -25499.687162698836, -25991.849943571677, -26137.11117551645, -26151.304917348447, -25996.730729566603, -25914.53315627779, -25786.585052919683, -25846.28850783948, -25783.832028025026, -25627.677232823353, -26038.719815479228, -25635.922737428984, -25868.508312975722, -25991.60090523408, -25657.920462761886, -25756.19734831615, -25834.497845832582, -25624.406599402155, -25623.049176246823, -25834.387053352883, -25867.29379257149, -25643.505537482684, -25742.651422327574, -25655.41416648919, -25868.80945227319, -25847.479213891227, -25701.472246302383, -25777.462466382396, -25746.282582200427, -25736.64438715656, -26000.001128408145, -25770.531153735996, -25562.446197956648, -25885.57919387728, -25585.13596090559, -25665.96732020764, -25656.675229452405, -25456.717753643752, -25562.242933916827, -25671.411627128025, -25864.70163439365, -25462.346071828535, -25554.082619155375, -25880.440581548897, -25614.01025244211, -25723.019301323944, -25767.108546182273, -25693.931776022073, -25934.307805282882, -25799.75016982112, -25767.052116667943, -25703.318308026996, -25738.33987263904, -25839.263566717633, -26058.03842804496, -25466.52483052838, -25723.79005705918, -25568.652334018734, -25658.751086979817, -25796.293306878513, -25637.135134172895, -25720.455000826445, -25745.1061000994, -25758.48543409182, -25494.397311504414, -25789.560259672373, -25831.446464554898, -26292.74912149601, -26025.814025900996, -25600.615904250113, -25567.710739410242, -25446.56237118809, -25880.78798693058, -25942.846714375417, -25594.024268471265, -25579.20574384092, -25661.59977255986, -25598.831299808346, -25899.70477172812, -25850.679229500052, -25544.127208032158, -25874.947030441388, -25476.042929746214, -25434.221900294273, -25831.365619237313, -25811.81453460429, -25673.72611278101, -25990.10945101598, -25561.52865470146], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.481773882827721, "mean_inference_ms": 0.2965135753564629, "mean_action_processing_ms": 0.07094917919691848, "mean_env_wait_ms": 1.7992306506761515, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0035605430603027344, "StateBufferConnector_ms": 0.0027146339416503906, "ViewRequirementAgentConnector_ms": 0.06741070747375488}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 322200, "num_agent_steps_trained": 322200, "num_env_steps_sampled": 322200, "num_env_steps_trained": 322200, "num_env_steps_sampled_this_iter": 1080, "num_env_steps_trained_this_iter": 1080, "num_env_steps_sampled_throughput_per_sec": 95.65085533943275, "num_env_steps_trained_throughput_per_sec": 95.65085533943275, "timesteps_total": 322200, "num_steps_trained_this_iter": 1080, "agent_timesteps_total": 322200, "timers": {"training_iteration_time_ms": 3780.928, "sample_time_ms": 3770.119, "load_time_ms": 0.299, "load_throughput": 1203146.964, "learn_time_ms": 9.725, "learn_throughput": 37017.638, "synch_weights_time_ms": 0.735}, "counters": {"num_env_steps_sampled": 322200, "num_env_steps_trained": 322200, "num_agent_steps_sampled": 322200, "num_agent_steps_trained": 322200}, "done": false, "episodes_total": 895, "training_iteration": 225, "trial_id": "f5e97_00000", "date": "2023-07-25_17-38-07", "timestamp": 1690295887, "time_this_iter_s": 11.293812036514282, "time_total_s": 2529.1409091949463, "pid": 71917, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[0, 0.003], [5400, 0.001], [10800, 0.00075], [16200, 0.0005], [21600, 0.00025], [27000, 0.0001], [32400, 7.5e-05], [37800, 5e-05], [43200, 2.5e-05], [48600, 1e-05], [54000, 7.5e-06], [59400, 5e-06], [64800, 2.5e-06], [70200, 1e-06], [75600, 5e-07], [81000, 1e-07]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x304530310>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 2529.1409091949463, "iterations_since_restore": 225, "perf": {"cpu_util_percent": 24.71875, "ram_util_percent": 74.84375}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-07, "entropy_coeff": 0.1, "policy_entropy": -926.6998168945313, "policy_loss": -30040203400192.0, "vf_loss": 1115795238.4}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 4488.0, "diff_num_grad_updates_vs_sampler_policy": 4487.0}}, "num_env_steps_sampled": 323280, "num_env_steps_trained": 323280, "num_agent_steps_sampled": 323280, "num_agent_steps_trained": 323280}, "sampler_results": {"episode_reward_max": -25434.221900294273, "episode_reward_min": -26292.74912149601, "episode_reward_mean": -25751.616862321636, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-25984.879269157755, -25893.435676587505, -25537.43144166211, -25893.649341129778, -25690.228753314994, -25611.200227393896, -25955.468063740438, -25463.58364467552, -25499.687162698836, -25991.849943571677, -26137.11117551645, -26151.304917348447, -25996.730729566603, -25914.53315627779, -25786.585052919683, -25846.28850783948, -25783.832028025026, -25627.677232823353, -26038.719815479228, -25635.922737428984, -25868.508312975722, -25991.60090523408, -25657.920462761886, -25756.19734831615, -25834.497845832582, -25624.406599402155, -25623.049176246823, -25834.387053352883, -25867.29379257149, -25643.505537482684, -25742.651422327574, -25655.41416648919, -25868.80945227319, -25847.479213891227, -25701.472246302383, -25777.462466382396, -25746.282582200427, -25736.64438715656, -26000.001128408145, -25770.531153735996, -25562.446197956648, -25885.57919387728, -25585.13596090559, -25665.96732020764, -25656.675229452405, -25456.717753643752, -25562.242933916827, -25671.411627128025, -25864.70163439365, -25462.346071828535, -25554.082619155375, -25880.440581548897, -25614.01025244211, -25723.019301323944, -25767.108546182273, -25693.931776022073, -25934.307805282882, -25799.75016982112, -25767.052116667943, -25703.318308026996, -25738.33987263904, -25839.263566717633, -26058.03842804496, -25466.52483052838, -25723.79005705918, -25568.652334018734, -25658.751086979817, -25796.293306878513, -25637.135134172895, -25720.455000826445, -25745.1061000994, -25758.48543409182, -25494.397311504414, -25789.560259672373, -25831.446464554898, -26292.74912149601, -26025.814025900996, -25600.615904250113, -25567.710739410242, -25446.56237118809, -25880.78798693058, -25942.846714375417, -25594.024268471265, -25579.20574384092, -25661.59977255986, -25598.831299808346, -25899.70477172812, -25850.679229500052, -25544.127208032158, -25874.947030441388, -25476.042929746214, -25434.221900294273, -25831.365619237313, -25811.81453460429, -25673.72611278101, -25990.10945101598, -25561.52865470146, -25688.503926052967, -25778.21999850185, -25931.228199220746], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.488863373218562, "mean_inference_ms": 0.29683707842876855, "mean_action_processing_ms": 0.07102798905563394, "mean_env_wait_ms": 1.801388534139409, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0035653114318847656, "StateBufferConnector_ms": 0.002713441848754883, "ViewRequirementAgentConnector_ms": 0.06747961044311523}}, "episode_reward_max": -25434.221900294273, "episode_reward_min": -26292.74912149601, "episode_reward_mean": -25751.616862321636, "episode_len_mean": 360.0, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-25984.879269157755, -25893.435676587505, -25537.43144166211, -25893.649341129778, -25690.228753314994, -25611.200227393896, -25955.468063740438, -25463.58364467552, -25499.687162698836, -25991.849943571677, -26137.11117551645, -26151.304917348447, -25996.730729566603, -25914.53315627779, -25786.585052919683, -25846.28850783948, -25783.832028025026, -25627.677232823353, -26038.719815479228, -25635.922737428984, -25868.508312975722, -25991.60090523408, -25657.920462761886, -25756.19734831615, -25834.497845832582, -25624.406599402155, -25623.049176246823, -25834.387053352883, -25867.29379257149, -25643.505537482684, -25742.651422327574, -25655.41416648919, -25868.80945227319, -25847.479213891227, -25701.472246302383, -25777.462466382396, -25746.282582200427, -25736.64438715656, -26000.001128408145, -25770.531153735996, -25562.446197956648, -25885.57919387728, -25585.13596090559, -25665.96732020764, -25656.675229452405, -25456.717753643752, -25562.242933916827, -25671.411627128025, -25864.70163439365, -25462.346071828535, -25554.082619155375, -25880.440581548897, -25614.01025244211, -25723.019301323944, -25767.108546182273, -25693.931776022073, -25934.307805282882, -25799.75016982112, -25767.052116667943, -25703.318308026996, -25738.33987263904, -25839.263566717633, -26058.03842804496, -25466.52483052838, -25723.79005705918, -25568.652334018734, -25658.751086979817, -25796.293306878513, -25637.135134172895, -25720.455000826445, -25745.1061000994, -25758.48543409182, -25494.397311504414, -25789.560259672373, -25831.446464554898, -26292.74912149601, -26025.814025900996, -25600.615904250113, -25567.710739410242, -25446.56237118809, -25880.78798693058, -25942.846714375417, -25594.024268471265, -25579.20574384092, -25661.59977255986, -25598.831299808346, -25899.70477172812, -25850.679229500052, -25544.127208032158, -25874.947030441388, -25476.042929746214, -25434.221900294273, -25831.365619237313, -25811.81453460429, -25673.72611278101, -25990.10945101598, -25561.52865470146, -25688.503926052967, -25778.21999850185, -25931.228199220746], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.488863373218562, "mean_inference_ms": 0.29683707842876855, "mean_action_processing_ms": 0.07102798905563394, "mean_env_wait_ms": 1.801388534139409, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0035653114318847656, "StateBufferConnector_ms": 0.002713441848754883, "ViewRequirementAgentConnector_ms": 0.06747961044311523}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 323280, "num_agent_steps_trained": 323280, "num_env_steps_sampled": 323280, "num_env_steps_trained": 323280, "num_env_steps_sampled_this_iter": 1080, "num_env_steps_trained_this_iter": 1080, "num_env_steps_sampled_throughput_per_sec": 96.03559669041348, "num_env_steps_trained_throughput_per_sec": 96.03559669041348, "timesteps_total": 323280, "num_steps_trained_this_iter": 1080, "agent_timesteps_total": 323280, "timers": {"training_iteration_time_ms": 3772.689, "sample_time_ms": 3761.976, "load_time_ms": 0.295, "load_throughput": 1218585.619, "learn_time_ms": 9.659, "learn_throughput": 37270.647, "synch_weights_time_ms": 0.714}, "counters": {"num_env_steps_sampled": 323280, "num_env_steps_trained": 323280, "num_agent_steps_sampled": 323280, "num_agent_steps_trained": 323280}, "done": false, "episodes_total": 898, "training_iteration": 226, "trial_id": "f5e97_00000", "date": "2023-07-25_17-38-18", "timestamp": 1690295898, "time_this_iter_s": 11.248861074447632, "time_total_s": 2540.389770269394, "pid": 71917, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[0, 0.003], [5400, 0.001], [10800, 0.00075], [16200, 0.0005], [21600, 0.00025], [27000, 0.0001], [32400, 7.5e-05], [37800, 5e-05], [43200, 2.5e-05], [48600, 1e-05], [54000, 7.5e-06], [59400, 5e-06], [64800, 2.5e-06], [70200, 1e-06], [75600, 5e-07], [81000, 1e-07]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x304530310>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 2540.389770269394, "iterations_since_restore": 226, "perf": {"cpu_util_percent": 25.45, "ram_util_percent": 74.86875}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-07, "entropy_coeff": 0.1, "policy_entropy": -926.6996459960938, "policy_loss": -9701058420736.0, "vf_loss": 1118197337.6}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 4503.0, "diff_num_grad_updates_vs_sampler_policy": 4502.0}}, "num_env_steps_sampled": 324360, "num_env_steps_trained": 324360, "num_agent_steps_sampled": 324360, "num_agent_steps_trained": 324360}, "sampler_results": {"episode_reward_max": -25434.221900294273, "episode_reward_min": -26292.74912149601, "episode_reward_mean": -25750.525741989677, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-25893.649341129778, -25690.228753314994, -25611.200227393896, -25955.468063740438, -25463.58364467552, -25499.687162698836, -25991.849943571677, -26137.11117551645, -26151.304917348447, -25996.730729566603, -25914.53315627779, -25786.585052919683, -25846.28850783948, -25783.832028025026, -25627.677232823353, -26038.719815479228, -25635.922737428984, -25868.508312975722, -25991.60090523408, -25657.920462761886, -25756.19734831615, -25834.497845832582, -25624.406599402155, -25623.049176246823, -25834.387053352883, -25867.29379257149, -25643.505537482684, -25742.651422327574, -25655.41416648919, -25868.80945227319, -25847.479213891227, -25701.472246302383, -25777.462466382396, -25746.282582200427, -25736.64438715656, -26000.001128408145, -25770.531153735996, -25562.446197956648, -25885.57919387728, -25585.13596090559, -25665.96732020764, -25656.675229452405, -25456.717753643752, -25562.242933916827, -25671.411627128025, -25864.70163439365, -25462.346071828535, -25554.082619155375, -25880.440581548897, -25614.01025244211, -25723.019301323944, -25767.108546182273, -25693.931776022073, -25934.307805282882, -25799.75016982112, -25767.052116667943, -25703.318308026996, -25738.33987263904, -25839.263566717633, -26058.03842804496, -25466.52483052838, -25723.79005705918, -25568.652334018734, -25658.751086979817, -25796.293306878513, -25637.135134172895, -25720.455000826445, -25745.1061000994, -25758.48543409182, -25494.397311504414, -25789.560259672373, -25831.446464554898, -26292.74912149601, -26025.814025900996, -25600.615904250113, -25567.710739410242, -25446.56237118809, -25880.78798693058, -25942.846714375417, -25594.024268471265, -25579.20574384092, -25661.59977255986, -25598.831299808346, -25899.70477172812, -25850.679229500052, -25544.127208032158, -25874.947030441388, -25476.042929746214, -25434.221900294273, -25831.365619237313, -25811.81453460429, -25673.72611278101, -25990.10945101598, -25561.52865470146, -25688.503926052967, -25778.21999850185, -25931.228199220746, -25487.820385521598, -25892.52578831003, -25926.288180379986], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.495911445572435, "mean_inference_ms": 0.29715788061361176, "mean_action_processing_ms": 0.07110616944111135, "mean_env_wait_ms": 1.8035337398451652, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003562450408935547, "StateBufferConnector_ms": 0.002711057662963867, "ViewRequirementAgentConnector_ms": 0.06742715835571289}}, "episode_reward_max": -25434.221900294273, "episode_reward_min": -26292.74912149601, "episode_reward_mean": -25750.525741989677, "episode_len_mean": 360.0, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-25893.649341129778, -25690.228753314994, -25611.200227393896, -25955.468063740438, -25463.58364467552, -25499.687162698836, -25991.849943571677, -26137.11117551645, -26151.304917348447, -25996.730729566603, -25914.53315627779, -25786.585052919683, -25846.28850783948, -25783.832028025026, -25627.677232823353, -26038.719815479228, -25635.922737428984, -25868.508312975722, -25991.60090523408, -25657.920462761886, -25756.19734831615, -25834.497845832582, -25624.406599402155, -25623.049176246823, -25834.387053352883, -25867.29379257149, -25643.505537482684, -25742.651422327574, -25655.41416648919, -25868.80945227319, -25847.479213891227, -25701.472246302383, -25777.462466382396, -25746.282582200427, -25736.64438715656, -26000.001128408145, -25770.531153735996, -25562.446197956648, -25885.57919387728, -25585.13596090559, -25665.96732020764, -25656.675229452405, -25456.717753643752, -25562.242933916827, -25671.411627128025, -25864.70163439365, -25462.346071828535, -25554.082619155375, -25880.440581548897, -25614.01025244211, -25723.019301323944, -25767.108546182273, -25693.931776022073, -25934.307805282882, -25799.75016982112, -25767.052116667943, -25703.318308026996, -25738.33987263904, -25839.263566717633, -26058.03842804496, -25466.52483052838, -25723.79005705918, -25568.652334018734, -25658.751086979817, -25796.293306878513, -25637.135134172895, -25720.455000826445, -25745.1061000994, -25758.48543409182, -25494.397311504414, -25789.560259672373, -25831.446464554898, -26292.74912149601, -26025.814025900996, -25600.615904250113, -25567.710739410242, -25446.56237118809, -25880.78798693058, -25942.846714375417, -25594.024268471265, -25579.20574384092, -25661.59977255986, -25598.831299808346, -25899.70477172812, -25850.679229500052, -25544.127208032158, -25874.947030441388, -25476.042929746214, -25434.221900294273, -25831.365619237313, -25811.81453460429, -25673.72611278101, -25990.10945101598, -25561.52865470146, -25688.503926052967, -25778.21999850185, -25931.228199220746, -25487.820385521598, -25892.52578831003, -25926.288180379986], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.495911445572435, "mean_inference_ms": 0.29715788061361176, "mean_action_processing_ms": 0.07110616944111135, "mean_env_wait_ms": 1.8035337398451652, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003562450408935547, "StateBufferConnector_ms": 0.002711057662963867, "ViewRequirementAgentConnector_ms": 0.06742715835571289}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 324360, "num_agent_steps_trained": 324360, "num_env_steps_sampled": 324360, "num_env_steps_trained": 324360, "num_env_steps_sampled_this_iter": 1080, "num_env_steps_trained_this_iter": 1080, "num_env_steps_sampled_throughput_per_sec": 95.87365283483122, "num_env_steps_trained_throughput_per_sec": 95.87365283483122, "timesteps_total": 324360, "num_steps_trained_this_iter": 1080, "agent_timesteps_total": 324360, "timers": {"training_iteration_time_ms": 3768.842, "sample_time_ms": 3758.15, "load_time_ms": 0.295, "load_throughput": 1222235.26, "learn_time_ms": 9.655, "learn_throughput": 37284.82, "synch_weights_time_ms": 0.699}, "counters": {"num_env_steps_sampled": 324360, "num_env_steps_trained": 324360, "num_agent_steps_sampled": 324360, "num_agent_steps_trained": 324360}, "done": false, "episodes_total": 901, "training_iteration": 227, "trial_id": "f5e97_00000", "date": "2023-07-25_17-38-30", "timestamp": 1690295910, "time_this_iter_s": 11.267597675323486, "time_total_s": 2551.6573679447174, "pid": 71917, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[0, 0.003], [5400, 0.001], [10800, 0.00075], [16200, 0.0005], [21600, 0.00025], [27000, 0.0001], [32400, 7.5e-05], [37800, 5e-05], [43200, 2.5e-05], [48600, 1e-05], [54000, 7.5e-06], [59400, 5e-06], [64800, 2.5e-06], [70200, 1e-06], [75600, 5e-07], [81000, 1e-07]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x304530310>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 2551.6573679447174, "iterations_since_restore": 227, "perf": {"cpu_util_percent": 24.613333333333333, "ram_util_percent": 74.49333333333334}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-07, "entropy_coeff": 0.1, "policy_entropy": -926.6996337890625, "policy_loss": -31958083422617.6, "vf_loss": 1119077011.2}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 4518.0, "diff_num_grad_updates_vs_sampler_policy": 4517.0}}, "num_env_steps_sampled": 325440, "num_env_steps_trained": 325440, "num_agent_steps_sampled": 325440, "num_agent_steps_trained": 325440}, "sampler_results": {"episode_reward_max": -25434.221900294273, "episode_reward_min": -26292.74912149601, "episode_reward_mean": -25752.583163316172, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-25955.468063740438, -25463.58364467552, -25499.687162698836, -25991.849943571677, -26137.11117551645, -26151.304917348447, -25996.730729566603, -25914.53315627779, -25786.585052919683, -25846.28850783948, -25783.832028025026, -25627.677232823353, -26038.719815479228, -25635.922737428984, -25868.508312975722, -25991.60090523408, -25657.920462761886, -25756.19734831615, -25834.497845832582, -25624.406599402155, -25623.049176246823, -25834.387053352883, -25867.29379257149, -25643.505537482684, -25742.651422327574, -25655.41416648919, -25868.80945227319, -25847.479213891227, -25701.472246302383, -25777.462466382396, -25746.282582200427, -25736.64438715656, -26000.001128408145, -25770.531153735996, -25562.446197956648, -25885.57919387728, -25585.13596090559, -25665.96732020764, -25656.675229452405, -25456.717753643752, -25562.242933916827, -25671.411627128025, -25864.70163439365, -25462.346071828535, -25554.082619155375, -25880.440581548897, -25614.01025244211, -25723.019301323944, -25767.108546182273, -25693.931776022073, -25934.307805282882, -25799.75016982112, -25767.052116667943, -25703.318308026996, -25738.33987263904, -25839.263566717633, -26058.03842804496, -25466.52483052838, -25723.79005705918, -25568.652334018734, -25658.751086979817, -25796.293306878513, -25637.135134172895, -25720.455000826445, -25745.1061000994, -25758.48543409182, -25494.397311504414, -25789.560259672373, -25831.446464554898, -26292.74912149601, -26025.814025900996, -25600.615904250113, -25567.710739410242, -25446.56237118809, -25880.78798693058, -25942.846714375417, -25594.024268471265, -25579.20574384092, -25661.59977255986, -25598.831299808346, -25899.70477172812, -25850.679229500052, -25544.127208032158, -25874.947030441388, -25476.042929746214, -25434.221900294273, -25831.365619237313, -25811.81453460429, -25673.72611278101, -25990.10945101598, -25561.52865470146, -25688.503926052967, -25778.21999850185, -25931.228199220746, -25487.820385521598, -25892.52578831003, -25926.288180379986, -25576.830954405363, -25858.329583932533, -25965.659916149998], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.502909915825876, "mean_inference_ms": 0.29747664444507793, "mean_action_processing_ms": 0.07118385661765574, "mean_env_wait_ms": 1.8056637218479008, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0035631656646728516, "StateBufferConnector_ms": 0.002713918685913086, "ViewRequirementAgentConnector_ms": 0.0675048828125}}, "episode_reward_max": -25434.221900294273, "episode_reward_min": -26292.74912149601, "episode_reward_mean": -25752.583163316172, "episode_len_mean": 360.0, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-25955.468063740438, -25463.58364467552, -25499.687162698836, -25991.849943571677, -26137.11117551645, -26151.304917348447, -25996.730729566603, -25914.53315627779, -25786.585052919683, -25846.28850783948, -25783.832028025026, -25627.677232823353, -26038.719815479228, -25635.922737428984, -25868.508312975722, -25991.60090523408, -25657.920462761886, -25756.19734831615, -25834.497845832582, -25624.406599402155, -25623.049176246823, -25834.387053352883, -25867.29379257149, -25643.505537482684, -25742.651422327574, -25655.41416648919, -25868.80945227319, -25847.479213891227, -25701.472246302383, -25777.462466382396, -25746.282582200427, -25736.64438715656, -26000.001128408145, -25770.531153735996, -25562.446197956648, -25885.57919387728, -25585.13596090559, -25665.96732020764, -25656.675229452405, -25456.717753643752, -25562.242933916827, -25671.411627128025, -25864.70163439365, -25462.346071828535, -25554.082619155375, -25880.440581548897, -25614.01025244211, -25723.019301323944, -25767.108546182273, -25693.931776022073, -25934.307805282882, -25799.75016982112, -25767.052116667943, -25703.318308026996, -25738.33987263904, -25839.263566717633, -26058.03842804496, -25466.52483052838, -25723.79005705918, -25568.652334018734, -25658.751086979817, -25796.293306878513, -25637.135134172895, -25720.455000826445, -25745.1061000994, -25758.48543409182, -25494.397311504414, -25789.560259672373, -25831.446464554898, -26292.74912149601, -26025.814025900996, -25600.615904250113, -25567.710739410242, -25446.56237118809, -25880.78798693058, -25942.846714375417, -25594.024268471265, -25579.20574384092, -25661.59977255986, -25598.831299808346, -25899.70477172812, -25850.679229500052, -25544.127208032158, -25874.947030441388, -25476.042929746214, -25434.221900294273, -25831.365619237313, -25811.81453460429, -25673.72611278101, -25990.10945101598, -25561.52865470146, -25688.503926052967, -25778.21999850185, -25931.228199220746, -25487.820385521598, -25892.52578831003, -25926.288180379986, -25576.830954405363, -25858.329583932533, -25965.659916149998], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.502909915825876, "mean_inference_ms": 0.29747664444507793, "mean_action_processing_ms": 0.07118385661765574, "mean_env_wait_ms": 1.8056637218479008, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0035631656646728516, "StateBufferConnector_ms": 0.002713918685913086, "ViewRequirementAgentConnector_ms": 0.0675048828125}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 325440, "num_agent_steps_trained": 325440, "num_env_steps_sampled": 325440, "num_env_steps_trained": 325440, "num_env_steps_sampled_this_iter": 1080, "num_env_steps_trained_this_iter": 1080, "num_env_steps_sampled_throughput_per_sec": 95.80457547095288, "num_env_steps_trained_throughput_per_sec": 95.80457547095288, "timesteps_total": 325440, "num_steps_trained_this_iter": 1080, "agent_timesteps_total": 325440, "timers": {"training_iteration_time_ms": 3769.068, "sample_time_ms": 3758.408, "load_time_ms": 0.295, "load_throughput": 1221345.499, "learn_time_ms": 9.634, "learn_throughput": 37368.234, "synch_weights_time_ms": 0.689}, "counters": {"num_env_steps_sampled": 325440, "num_env_steps_trained": 325440, "num_agent_steps_sampled": 325440, "num_agent_steps_trained": 325440}, "done": false, "episodes_total": 904, "training_iteration": 228, "trial_id": "f5e97_00000", "date": "2023-07-25_17-38-41", "timestamp": 1690295921, "time_this_iter_s": 11.275814294815063, "time_total_s": 2562.9331822395325, "pid": 71917, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[0, 0.003], [5400, 0.001], [10800, 0.00075], [16200, 0.0005], [21600, 0.00025], [27000, 0.0001], [32400, 7.5e-05], [37800, 5e-05], [43200, 2.5e-05], [48600, 1e-05], [54000, 7.5e-06], [59400, 5e-06], [64800, 2.5e-06], [70200, 1e-06], [75600, 5e-07], [81000, 1e-07]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x304530310>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 2562.9331822395325, "iterations_since_restore": 228, "perf": {"cpu_util_percent": 25.45, "ram_util_percent": 74.525}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-07, "entropy_coeff": 0.1, "policy_entropy": -926.6998413085937, "policy_loss": -27705837393510.4, "vf_loss": 1097492262.4}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 4533.0, "diff_num_grad_updates_vs_sampler_policy": 4532.0}}, "num_env_steps_sampled": 326520, "num_env_steps_trained": 326520, "num_agent_steps_sampled": 326520, "num_agent_steps_trained": 326520}, "sampler_results": {"episode_reward_max": -25434.221900294273, "episode_reward_min": -26292.74912149601, "episode_reward_mean": -25752.91658766701, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-25991.849943571677, -26137.11117551645, -26151.304917348447, -25996.730729566603, -25914.53315627779, -25786.585052919683, -25846.28850783948, -25783.832028025026, -25627.677232823353, -26038.719815479228, -25635.922737428984, -25868.508312975722, -25991.60090523408, -25657.920462761886, -25756.19734831615, -25834.497845832582, -25624.406599402155, -25623.049176246823, -25834.387053352883, -25867.29379257149, -25643.505537482684, -25742.651422327574, -25655.41416648919, -25868.80945227319, -25847.479213891227, -25701.472246302383, -25777.462466382396, -25746.282582200427, -25736.64438715656, -26000.001128408145, -25770.531153735996, -25562.446197956648, -25885.57919387728, -25585.13596090559, -25665.96732020764, -25656.675229452405, -25456.717753643752, -25562.242933916827, -25671.411627128025, -25864.70163439365, -25462.346071828535, -25554.082619155375, -25880.440581548897, -25614.01025244211, -25723.019301323944, -25767.108546182273, -25693.931776022073, -25934.307805282882, -25799.75016982112, -25767.052116667943, -25703.318308026996, -25738.33987263904, -25839.263566717633, -26058.03842804496, -25466.52483052838, -25723.79005705918, -25568.652334018734, -25658.751086979817, -25796.293306878513, -25637.135134172895, -25720.455000826445, -25745.1061000994, -25758.48543409182, -25494.397311504414, -25789.560259672373, -25831.446464554898, -26292.74912149601, -26025.814025900996, -25600.615904250113, -25567.710739410242, -25446.56237118809, -25880.78798693058, -25942.846714375417, -25594.024268471265, -25579.20574384092, -25661.59977255986, -25598.831299808346, -25899.70477172812, -25850.679229500052, -25544.127208032158, -25874.947030441388, -25476.042929746214, -25434.221900294273, -25831.365619237313, -25811.81453460429, -25673.72611278101, -25990.10945101598, -25561.52865470146, -25688.503926052967, -25778.21999850185, -25931.228199220746, -25487.820385521598, -25892.52578831003, -25926.288180379986, -25576.830954405363, -25858.329583932533, -25965.659916149998, -25643.231739001527, -25581.040627284485, -25727.808939913433], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.5098750367676885, "mean_inference_ms": 0.2977913039457103, "mean_action_processing_ms": 0.07126069850050576, "mean_env_wait_ms": 1.807782220532813, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00356292724609375, "StateBufferConnector_ms": 0.002710103988647461, "ViewRequirementAgentConnector_ms": 0.06746745109558105}}, "episode_reward_max": -25434.221900294273, "episode_reward_min": -26292.74912149601, "episode_reward_mean": -25752.91658766701, "episode_len_mean": 360.0, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-25991.849943571677, -26137.11117551645, -26151.304917348447, -25996.730729566603, -25914.53315627779, -25786.585052919683, -25846.28850783948, -25783.832028025026, -25627.677232823353, -26038.719815479228, -25635.922737428984, -25868.508312975722, -25991.60090523408, -25657.920462761886, -25756.19734831615, -25834.497845832582, -25624.406599402155, -25623.049176246823, -25834.387053352883, -25867.29379257149, -25643.505537482684, -25742.651422327574, -25655.41416648919, -25868.80945227319, -25847.479213891227, -25701.472246302383, -25777.462466382396, -25746.282582200427, -25736.64438715656, -26000.001128408145, -25770.531153735996, -25562.446197956648, -25885.57919387728, -25585.13596090559, -25665.96732020764, -25656.675229452405, -25456.717753643752, -25562.242933916827, -25671.411627128025, -25864.70163439365, -25462.346071828535, -25554.082619155375, -25880.440581548897, -25614.01025244211, -25723.019301323944, -25767.108546182273, -25693.931776022073, -25934.307805282882, -25799.75016982112, -25767.052116667943, -25703.318308026996, -25738.33987263904, -25839.263566717633, -26058.03842804496, -25466.52483052838, -25723.79005705918, -25568.652334018734, -25658.751086979817, -25796.293306878513, -25637.135134172895, -25720.455000826445, -25745.1061000994, -25758.48543409182, -25494.397311504414, -25789.560259672373, -25831.446464554898, -26292.74912149601, -26025.814025900996, -25600.615904250113, -25567.710739410242, -25446.56237118809, -25880.78798693058, -25942.846714375417, -25594.024268471265, -25579.20574384092, -25661.59977255986, -25598.831299808346, -25899.70477172812, -25850.679229500052, -25544.127208032158, -25874.947030441388, -25476.042929746214, -25434.221900294273, -25831.365619237313, -25811.81453460429, -25673.72611278101, -25990.10945101598, -25561.52865470146, -25688.503926052967, -25778.21999850185, -25931.228199220746, -25487.820385521598, -25892.52578831003, -25926.288180379986, -25576.830954405363, -25858.329583932533, -25965.659916149998, -25643.231739001527, -25581.040627284485, -25727.808939913433], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.5098750367676885, "mean_inference_ms": 0.2977913039457103, "mean_action_processing_ms": 0.07126069850050576, "mean_env_wait_ms": 1.807782220532813, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00356292724609375, "StateBufferConnector_ms": 0.002710103988647461, "ViewRequirementAgentConnector_ms": 0.06746745109558105}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 326520, "num_agent_steps_trained": 326520, "num_env_steps_sampled": 326520, "num_env_steps_trained": 326520, "num_env_steps_sampled_this_iter": 1080, "num_env_steps_trained_this_iter": 1080, "num_env_steps_sampled_throughput_per_sec": 94.03347035209116, "num_env_steps_trained_throughput_per_sec": 94.03347035209116, "timesteps_total": 326520, "num_steps_trained_this_iter": 1080, "agent_timesteps_total": 326520, "timers": {"training_iteration_time_ms": 3781.783, "sample_time_ms": 3771.092, "load_time_ms": 0.295, "load_throughput": 1221938.529, "learn_time_ms": 9.66, "learn_throughput": 37268.623, "synch_weights_time_ms": 0.693}, "counters": {"num_env_steps_sampled": 326520, "num_env_steps_trained": 326520, "num_agent_steps_sampled": 326520, "num_agent_steps_trained": 326520}, "done": false, "episodes_total": 907, "training_iteration": 229, "trial_id": "f5e97_00000", "date": "2023-07-25_17-38-52", "timestamp": 1690295932, "time_this_iter_s": 11.488075017929077, "time_total_s": 2574.4212572574615, "pid": 71917, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[0, 0.003], [5400, 0.001], [10800, 0.00075], [16200, 0.0005], [21600, 0.00025], [27000, 0.0001], [32400, 7.5e-05], [37800, 5e-05], [43200, 2.5e-05], [48600, 1e-05], [54000, 7.5e-06], [59400, 5e-06], [64800, 2.5e-06], [70200, 1e-06], [75600, 5e-07], [81000, 1e-07]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x304530310>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 2574.4212572574615, "iterations_since_restore": 229, "perf": {"cpu_util_percent": 23.311764705882354, "ram_util_percent": 74.5294117647059}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-07, "entropy_coeff": 0.1, "policy_entropy": -926.6996826171875, "policy_loss": -26768217639321.6, "vf_loss": 1113040710.4}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 4548.0, "diff_num_grad_updates_vs_sampler_policy": 4547.0}}, "num_env_steps_sampled": 327600, "num_env_steps_trained": 327600, "num_agent_steps_sampled": 327600, "num_agent_steps_trained": 327600}, "sampler_results": {"episode_reward_max": -25434.221900294273, "episode_reward_min": -26292.74912149601, "episode_reward_mean": -25745.516850234922, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-25996.730729566603, -25914.53315627779, -25786.585052919683, -25846.28850783948, -25783.832028025026, -25627.677232823353, -26038.719815479228, -25635.922737428984, -25868.508312975722, -25991.60090523408, -25657.920462761886, -25756.19734831615, -25834.497845832582, -25624.406599402155, -25623.049176246823, -25834.387053352883, -25867.29379257149, -25643.505537482684, -25742.651422327574, -25655.41416648919, -25868.80945227319, -25847.479213891227, -25701.472246302383, -25777.462466382396, -25746.282582200427, -25736.64438715656, -26000.001128408145, -25770.531153735996, -25562.446197956648, -25885.57919387728, -25585.13596090559, -25665.96732020764, -25656.675229452405, -25456.717753643752, -25562.242933916827, -25671.411627128025, -25864.70163439365, -25462.346071828535, -25554.082619155375, -25880.440581548897, -25614.01025244211, -25723.019301323944, -25767.108546182273, -25693.931776022073, -25934.307805282882, -25799.75016982112, -25767.052116667943, -25703.318308026996, -25738.33987263904, -25839.263566717633, -26058.03842804496, -25466.52483052838, -25723.79005705918, -25568.652334018734, -25658.751086979817, -25796.293306878513, -25637.135134172895, -25720.455000826445, -25745.1061000994, -25758.48543409182, -25494.397311504414, -25789.560259672373, -25831.446464554898, -26292.74912149601, -26025.814025900996, -25600.615904250113, -25567.710739410242, -25446.56237118809, -25880.78798693058, -25942.846714375417, -25594.024268471265, -25579.20574384092, -25661.59977255986, -25598.831299808346, -25899.70477172812, -25850.679229500052, -25544.127208032158, -25874.947030441388, -25476.042929746214, -25434.221900294273, -25831.365619237313, -25811.81453460429, -25673.72611278101, -25990.10945101598, -25561.52865470146, -25688.503926052967, -25778.21999850185, -25931.228199220746, -25487.820385521598, -25892.52578831003, -25926.288180379986, -25576.830954405363, -25858.329583932533, -25965.659916149998, -25643.231739001527, -25581.040627284485, -25727.808939913433, -26050.094496583788, -25627.41920535082, -25862.778591292834], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.5167894244652675, "mean_inference_ms": 0.2981034154923437, "mean_action_processing_ms": 0.07133693129437607, "mean_env_wait_ms": 1.8098931028491227, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0035715103149414062, "StateBufferConnector_ms": 0.002711057662963867, "ViewRequirementAgentConnector_ms": 0.06745386123657227}}, "episode_reward_max": -25434.221900294273, "episode_reward_min": -26292.74912149601, "episode_reward_mean": -25745.516850234922, "episode_len_mean": 360.0, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-25996.730729566603, -25914.53315627779, -25786.585052919683, -25846.28850783948, -25783.832028025026, -25627.677232823353, -26038.719815479228, -25635.922737428984, -25868.508312975722, -25991.60090523408, -25657.920462761886, -25756.19734831615, -25834.497845832582, -25624.406599402155, -25623.049176246823, -25834.387053352883, -25867.29379257149, -25643.505537482684, -25742.651422327574, -25655.41416648919, -25868.80945227319, -25847.479213891227, -25701.472246302383, -25777.462466382396, -25746.282582200427, -25736.64438715656, -26000.001128408145, -25770.531153735996, -25562.446197956648, -25885.57919387728, -25585.13596090559, -25665.96732020764, -25656.675229452405, -25456.717753643752, -25562.242933916827, -25671.411627128025, -25864.70163439365, -25462.346071828535, -25554.082619155375, -25880.440581548897, -25614.01025244211, -25723.019301323944, -25767.108546182273, -25693.931776022073, -25934.307805282882, -25799.75016982112, -25767.052116667943, -25703.318308026996, -25738.33987263904, -25839.263566717633, -26058.03842804496, -25466.52483052838, -25723.79005705918, -25568.652334018734, -25658.751086979817, -25796.293306878513, -25637.135134172895, -25720.455000826445, -25745.1061000994, -25758.48543409182, -25494.397311504414, -25789.560259672373, -25831.446464554898, -26292.74912149601, -26025.814025900996, -25600.615904250113, -25567.710739410242, -25446.56237118809, -25880.78798693058, -25942.846714375417, -25594.024268471265, -25579.20574384092, -25661.59977255986, -25598.831299808346, -25899.70477172812, -25850.679229500052, -25544.127208032158, -25874.947030441388, -25476.042929746214, -25434.221900294273, -25831.365619237313, -25811.81453460429, -25673.72611278101, -25990.10945101598, -25561.52865470146, -25688.503926052967, -25778.21999850185, -25931.228199220746, -25487.820385521598, -25892.52578831003, -25926.288180379986, -25576.830954405363, -25858.329583932533, -25965.659916149998, -25643.231739001527, -25581.040627284485, -25727.808939913433, -26050.094496583788, -25627.41920535082, -25862.778591292834], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.5167894244652675, "mean_inference_ms": 0.2981034154923437, "mean_action_processing_ms": 0.07133693129437607, "mean_env_wait_ms": 1.8098931028491227, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0035715103149414062, "StateBufferConnector_ms": 0.002711057662963867, "ViewRequirementAgentConnector_ms": 0.06745386123657227}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 327600, "num_agent_steps_trained": 327600, "num_env_steps_sampled": 327600, "num_env_steps_trained": 327600, "num_env_steps_sampled_this_iter": 1080, "num_env_steps_trained_this_iter": 1080, "num_env_steps_sampled_throughput_per_sec": 95.63130629624037, "num_env_steps_trained_throughput_per_sec": 95.63130629624037, "timesteps_total": 327600, "num_steps_trained_this_iter": 1080, "agent_timesteps_total": 327600, "timers": {"training_iteration_time_ms": 3762.877, "sample_time_ms": 3752.161, "load_time_ms": 0.294, "load_throughput": 1224217.156, "learn_time_ms": 9.683, "learn_throughput": 37177.778, "synch_weights_time_ms": 0.695}, "counters": {"num_env_steps_sampled": 327600, "num_env_steps_trained": 327600, "num_agent_steps_sampled": 327600, "num_agent_steps_trained": 327600}, "done": false, "episodes_total": 910, "training_iteration": 230, "trial_id": "f5e97_00000", "date": "2023-07-25_17-39-04", "timestamp": 1690295944, "time_this_iter_s": 11.296247005462646, "time_total_s": 2585.717504262924, "pid": 71917, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[0, 0.003], [5400, 0.001], [10800, 0.00075], [16200, 0.0005], [21600, 0.00025], [27000, 0.0001], [32400, 7.5e-05], [37800, 5e-05], [43200, 2.5e-05], [48600, 1e-05], [54000, 7.5e-06], [59400, 5e-06], [64800, 2.5e-06], [70200, 1e-06], [75600, 5e-07], [81000, 1e-07]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x304530310>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 2585.717504262924, "iterations_since_restore": 230, "perf": {"cpu_util_percent": 23.4625, "ram_util_percent": 74.56875}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-07, "entropy_coeff": 0.1, "policy_entropy": -926.7, "policy_loss": -14322280833843.2, "vf_loss": 1077543116.8}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 4563.0, "diff_num_grad_updates_vs_sampler_policy": 4562.0}}, "num_env_steps_sampled": 328680, "num_env_steps_trained": 328680, "num_agent_steps_sampled": 328680, "num_agent_steps_trained": 328680}, "sampler_results": {"episode_reward_max": -25434.221900294273, "episode_reward_min": -26292.74912149601, "episode_reward_mean": -25737.60738350687, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-25846.28850783948, -25783.832028025026, -25627.677232823353, -26038.719815479228, -25635.922737428984, -25868.508312975722, -25991.60090523408, -25657.920462761886, -25756.19734831615, -25834.497845832582, -25624.406599402155, -25623.049176246823, -25834.387053352883, -25867.29379257149, -25643.505537482684, -25742.651422327574, -25655.41416648919, -25868.80945227319, -25847.479213891227, -25701.472246302383, -25777.462466382396, -25746.282582200427, -25736.64438715656, -26000.001128408145, -25770.531153735996, -25562.446197956648, -25885.57919387728, -25585.13596090559, -25665.96732020764, -25656.675229452405, -25456.717753643752, -25562.242933916827, -25671.411627128025, -25864.70163439365, -25462.346071828535, -25554.082619155375, -25880.440581548897, -25614.01025244211, -25723.019301323944, -25767.108546182273, -25693.931776022073, -25934.307805282882, -25799.75016982112, -25767.052116667943, -25703.318308026996, -25738.33987263904, -25839.263566717633, -26058.03842804496, -25466.52483052838, -25723.79005705918, -25568.652334018734, -25658.751086979817, -25796.293306878513, -25637.135134172895, -25720.455000826445, -25745.1061000994, -25758.48543409182, -25494.397311504414, -25789.560259672373, -25831.446464554898, -26292.74912149601, -26025.814025900996, -25600.615904250113, -25567.710739410242, -25446.56237118809, -25880.78798693058, -25942.846714375417, -25594.024268471265, -25579.20574384092, -25661.59977255986, -25598.831299808346, -25899.70477172812, -25850.679229500052, -25544.127208032158, -25874.947030441388, -25476.042929746214, -25434.221900294273, -25831.365619237313, -25811.81453460429, -25673.72611278101, -25990.10945101598, -25561.52865470146, -25688.503926052967, -25778.21999850185, -25931.228199220746, -25487.820385521598, -25892.52578831003, -25926.288180379986, -25576.830954405363, -25858.329583932533, -25965.659916149998, -25643.231739001527, -25581.040627284485, -25727.808939913433, -26050.094496583788, -25627.41920535082, -25862.778591292834, -25535.63315259287, -25817.24449785403, -25554.02461551194], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.52367099462249, "mean_inference_ms": 0.2984137857060798, "mean_action_processing_ms": 0.07141265516500149, "mean_env_wait_ms": 1.811981855896702, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003572702407836914, "StateBufferConnector_ms": 0.0027081966400146484, "ViewRequirementAgentConnector_ms": 0.0672757625579834}}, "episode_reward_max": -25434.221900294273, "episode_reward_min": -26292.74912149601, "episode_reward_mean": -25737.60738350687, "episode_len_mean": 360.0, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-25846.28850783948, -25783.832028025026, -25627.677232823353, -26038.719815479228, -25635.922737428984, -25868.508312975722, -25991.60090523408, -25657.920462761886, -25756.19734831615, -25834.497845832582, -25624.406599402155, -25623.049176246823, -25834.387053352883, -25867.29379257149, -25643.505537482684, -25742.651422327574, -25655.41416648919, -25868.80945227319, -25847.479213891227, -25701.472246302383, -25777.462466382396, -25746.282582200427, -25736.64438715656, -26000.001128408145, -25770.531153735996, -25562.446197956648, -25885.57919387728, -25585.13596090559, -25665.96732020764, -25656.675229452405, -25456.717753643752, -25562.242933916827, -25671.411627128025, -25864.70163439365, -25462.346071828535, -25554.082619155375, -25880.440581548897, -25614.01025244211, -25723.019301323944, -25767.108546182273, -25693.931776022073, -25934.307805282882, -25799.75016982112, -25767.052116667943, -25703.318308026996, -25738.33987263904, -25839.263566717633, -26058.03842804496, -25466.52483052838, -25723.79005705918, -25568.652334018734, -25658.751086979817, -25796.293306878513, -25637.135134172895, -25720.455000826445, -25745.1061000994, -25758.48543409182, -25494.397311504414, -25789.560259672373, -25831.446464554898, -26292.74912149601, -26025.814025900996, -25600.615904250113, -25567.710739410242, -25446.56237118809, -25880.78798693058, -25942.846714375417, -25594.024268471265, -25579.20574384092, -25661.59977255986, -25598.831299808346, -25899.70477172812, -25850.679229500052, -25544.127208032158, -25874.947030441388, -25476.042929746214, -25434.221900294273, -25831.365619237313, -25811.81453460429, -25673.72611278101, -25990.10945101598, -25561.52865470146, -25688.503926052967, -25778.21999850185, -25931.228199220746, -25487.820385521598, -25892.52578831003, -25926.288180379986, -25576.830954405363, -25858.329583932533, -25965.659916149998, -25643.231739001527, -25581.040627284485, -25727.808939913433, -26050.094496583788, -25627.41920535082, -25862.778591292834, -25535.63315259287, -25817.24449785403, -25554.02461551194], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.52367099462249, "mean_inference_ms": 0.2984137857060798, "mean_action_processing_ms": 0.07141265516500149, "mean_env_wait_ms": 1.811981855896702, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003572702407836914, "StateBufferConnector_ms": 0.0027081966400146484, "ViewRequirementAgentConnector_ms": 0.0672757625579834}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 328680, "num_agent_steps_trained": 328680, "num_env_steps_sampled": 328680, "num_env_steps_trained": 328680, "num_env_steps_sampled_this_iter": 1080, "num_env_steps_trained_this_iter": 1080, "num_env_steps_sampled_throughput_per_sec": 94.91358101467021, "num_env_steps_trained_throughput_per_sec": 94.91358101467021, "timesteps_total": 328680, "num_steps_trained_this_iter": 1080, "agent_timesteps_total": 328680, "timers": {"training_iteration_time_ms": 3778.067, "sample_time_ms": 3767.273, "load_time_ms": 0.295, "load_throughput": 1219471.362, "learn_time_ms": 9.75, "learn_throughput": 36923.135, "synch_weights_time_ms": 0.706}, "counters": {"num_env_steps_sampled": 328680, "num_env_steps_trained": 328680, "num_agent_steps_sampled": 328680, "num_agent_steps_trained": 328680}, "done": false, "episodes_total": 913, "training_iteration": 231, "trial_id": "f5e97_00000", "date": "2023-07-25_17-39-15", "timestamp": 1690295955, "time_this_iter_s": 11.381616830825806, "time_total_s": 2597.09912109375, "pid": 71917, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[0, 0.003], [5400, 0.001], [10800, 0.00075], [16200, 0.0005], [21600, 0.00025], [27000, 0.0001], [32400, 7.5e-05], [37800, 5e-05], [43200, 2.5e-05], [48600, 1e-05], [54000, 7.5e-06], [59400, 5e-06], [64800, 2.5e-06], [70200, 1e-06], [75600, 5e-07], [81000, 1e-07]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x304530310>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 2597.09912109375, "iterations_since_restore": 231, "perf": {"cpu_util_percent": 24.61875, "ram_util_percent": 74.79374999999999}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-07, "entropy_coeff": 0.1, "policy_entropy": -926.6994750976562, "policy_loss": -16492006257459.2, "vf_loss": 1118764204.8}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 4578.0, "diff_num_grad_updates_vs_sampler_policy": 4577.0}}, "num_env_steps_sampled": 329760, "num_env_steps_trained": 329760, "num_agent_steps_sampled": 329760, "num_agent_steps_trained": 329760}, "sampler_results": {"episode_reward_max": -25434.221900294273, "episode_reward_min": -26292.74912149601, "episode_reward_mean": -25736.52012900747, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-26038.719815479228, -25635.922737428984, -25868.508312975722, -25991.60090523408, -25657.920462761886, -25756.19734831615, -25834.497845832582, -25624.406599402155, -25623.049176246823, -25834.387053352883, -25867.29379257149, -25643.505537482684, -25742.651422327574, -25655.41416648919, -25868.80945227319, -25847.479213891227, -25701.472246302383, -25777.462466382396, -25746.282582200427, -25736.64438715656, -26000.001128408145, -25770.531153735996, -25562.446197956648, -25885.57919387728, -25585.13596090559, -25665.96732020764, -25656.675229452405, -25456.717753643752, -25562.242933916827, -25671.411627128025, -25864.70163439365, -25462.346071828535, -25554.082619155375, -25880.440581548897, -25614.01025244211, -25723.019301323944, -25767.108546182273, -25693.931776022073, -25934.307805282882, -25799.75016982112, -25767.052116667943, -25703.318308026996, -25738.33987263904, -25839.263566717633, -26058.03842804496, -25466.52483052838, -25723.79005705918, -25568.652334018734, -25658.751086979817, -25796.293306878513, -25637.135134172895, -25720.455000826445, -25745.1061000994, -25758.48543409182, -25494.397311504414, -25789.560259672373, -25831.446464554898, -26292.74912149601, -26025.814025900996, -25600.615904250113, -25567.710739410242, -25446.56237118809, -25880.78798693058, -25942.846714375417, -25594.024268471265, -25579.20574384092, -25661.59977255986, -25598.831299808346, -25899.70477172812, -25850.679229500052, -25544.127208032158, -25874.947030441388, -25476.042929746214, -25434.221900294273, -25831.365619237313, -25811.81453460429, -25673.72611278101, -25990.10945101598, -25561.52865470146, -25688.503926052967, -25778.21999850185, -25931.228199220746, -25487.820385521598, -25892.52578831003, -25926.288180379986, -25576.830954405363, -25858.329583932533, -25965.659916149998, -25643.231739001527, -25581.040627284485, -25727.808939913433, -26050.094496583788, -25627.41920535082, -25862.778591292834, -25535.63315259287, -25817.24449785403, -25554.02461551194, -25667.1435888165, -25572.30506324793, -25909.623666683325], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.530509944031337, "mean_inference_ms": 0.2987217722339066, "mean_action_processing_ms": 0.07148780295928502, "mean_env_wait_ms": 1.814066502340208, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003566265106201172, "StateBufferConnector_ms": 0.00270843505859375, "ViewRequirementAgentConnector_ms": 0.06722426414489746}}, "episode_reward_max": -25434.221900294273, "episode_reward_min": -26292.74912149601, "episode_reward_mean": -25736.52012900747, "episode_len_mean": 360.0, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-26038.719815479228, -25635.922737428984, -25868.508312975722, -25991.60090523408, -25657.920462761886, -25756.19734831615, -25834.497845832582, -25624.406599402155, -25623.049176246823, -25834.387053352883, -25867.29379257149, -25643.505537482684, -25742.651422327574, -25655.41416648919, -25868.80945227319, -25847.479213891227, -25701.472246302383, -25777.462466382396, -25746.282582200427, -25736.64438715656, -26000.001128408145, -25770.531153735996, -25562.446197956648, -25885.57919387728, -25585.13596090559, -25665.96732020764, -25656.675229452405, -25456.717753643752, -25562.242933916827, -25671.411627128025, -25864.70163439365, -25462.346071828535, -25554.082619155375, -25880.440581548897, -25614.01025244211, -25723.019301323944, -25767.108546182273, -25693.931776022073, -25934.307805282882, -25799.75016982112, -25767.052116667943, -25703.318308026996, -25738.33987263904, -25839.263566717633, -26058.03842804496, -25466.52483052838, -25723.79005705918, -25568.652334018734, -25658.751086979817, -25796.293306878513, -25637.135134172895, -25720.455000826445, -25745.1061000994, -25758.48543409182, -25494.397311504414, -25789.560259672373, -25831.446464554898, -26292.74912149601, -26025.814025900996, -25600.615904250113, -25567.710739410242, -25446.56237118809, -25880.78798693058, -25942.846714375417, -25594.024268471265, -25579.20574384092, -25661.59977255986, -25598.831299808346, -25899.70477172812, -25850.679229500052, -25544.127208032158, -25874.947030441388, -25476.042929746214, -25434.221900294273, -25831.365619237313, -25811.81453460429, -25673.72611278101, -25990.10945101598, -25561.52865470146, -25688.503926052967, -25778.21999850185, -25931.228199220746, -25487.820385521598, -25892.52578831003, -25926.288180379986, -25576.830954405363, -25858.329583932533, -25965.659916149998, -25643.231739001527, -25581.040627284485, -25727.808939913433, -26050.094496583788, -25627.41920535082, -25862.778591292834, -25535.63315259287, -25817.24449785403, -25554.02461551194, -25667.1435888165, -25572.30506324793, -25909.623666683325], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.530509944031337, "mean_inference_ms": 0.2987217722339066, "mean_action_processing_ms": 0.07148780295928502, "mean_env_wait_ms": 1.814066502340208, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003566265106201172, "StateBufferConnector_ms": 0.00270843505859375, "ViewRequirementAgentConnector_ms": 0.06722426414489746}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 329760, "num_agent_steps_trained": 329760, "num_env_steps_sampled": 329760, "num_env_steps_trained": 329760, "num_env_steps_sampled_this_iter": 1080, "num_env_steps_trained_this_iter": 1080, "num_env_steps_sampled_throughput_per_sec": 94.32876319813951, "num_env_steps_trained_throughput_per_sec": 94.32876319813951, "timesteps_total": 329760, "num_steps_trained_this_iter": 1080, "agent_timesteps_total": 329760, "timers": {"training_iteration_time_ms": 3793.633, "sample_time_ms": 3782.894, "load_time_ms": 0.294, "load_throughput": 1224316.419, "learn_time_ms": 9.697, "learn_throughput": 37123.575, "synch_weights_time_ms": 0.704}, "counters": {"num_env_steps_sampled": 329760, "num_env_steps_trained": 329760, "num_agent_steps_sampled": 329760, "num_agent_steps_trained": 329760}, "done": false, "episodes_total": 916, "training_iteration": 232, "trial_id": "f5e97_00000", "date": "2023-07-25_17-39-27", "timestamp": 1690295967, "time_this_iter_s": 11.452064037322998, "time_total_s": 2608.551185131073, "pid": 71917, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[0, 0.003], [5400, 0.001], [10800, 0.00075], [16200, 0.0005], [21600, 0.00025], [27000, 0.0001], [32400, 7.5e-05], [37800, 5e-05], [43200, 2.5e-05], [48600, 1e-05], [54000, 7.5e-06], [59400, 5e-06], [64800, 2.5e-06], [70200, 1e-06], [75600, 5e-07], [81000, 1e-07]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x304530310>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 2608.551185131073, "iterations_since_restore": 232, "perf": {"cpu_util_percent": 23.143749999999997, "ram_util_percent": 74.6375}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-07, "entropy_coeff": 0.1, "policy_entropy": -926.6998291015625, "policy_loss": -23327254151168.0, "vf_loss": 1098339238.4}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 4593.0, "diff_num_grad_updates_vs_sampler_policy": 4592.0}}, "num_env_steps_sampled": 330840, "num_env_steps_trained": 330840, "num_agent_steps_sampled": 330840, "num_agent_steps_trained": 330840}, "sampler_results": {"episode_reward_max": -25432.266347912846, "episode_reward_min": -26292.74912149601, "episode_reward_mean": -25731.80247509835, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-25991.60090523408, -25657.920462761886, -25756.19734831615, -25834.497845832582, -25624.406599402155, -25623.049176246823, -25834.387053352883, -25867.29379257149, -25643.505537482684, -25742.651422327574, -25655.41416648919, -25868.80945227319, -25847.479213891227, -25701.472246302383, -25777.462466382396, -25746.282582200427, -25736.64438715656, -26000.001128408145, -25770.531153735996, -25562.446197956648, -25885.57919387728, -25585.13596090559, -25665.96732020764, -25656.675229452405, -25456.717753643752, -25562.242933916827, -25671.411627128025, -25864.70163439365, -25462.346071828535, -25554.082619155375, -25880.440581548897, -25614.01025244211, -25723.019301323944, -25767.108546182273, -25693.931776022073, -25934.307805282882, -25799.75016982112, -25767.052116667943, -25703.318308026996, -25738.33987263904, -25839.263566717633, -26058.03842804496, -25466.52483052838, -25723.79005705918, -25568.652334018734, -25658.751086979817, -25796.293306878513, -25637.135134172895, -25720.455000826445, -25745.1061000994, -25758.48543409182, -25494.397311504414, -25789.560259672373, -25831.446464554898, -26292.74912149601, -26025.814025900996, -25600.615904250113, -25567.710739410242, -25446.56237118809, -25880.78798693058, -25942.846714375417, -25594.024268471265, -25579.20574384092, -25661.59977255986, -25598.831299808346, -25899.70477172812, -25850.679229500052, -25544.127208032158, -25874.947030441388, -25476.042929746214, -25434.221900294273, -25831.365619237313, -25811.81453460429, -25673.72611278101, -25990.10945101598, -25561.52865470146, -25688.503926052967, -25778.21999850185, -25931.228199220746, -25487.820385521598, -25892.52578831003, -25926.288180379986, -25576.830954405363, -25858.329583932533, -25965.659916149998, -25643.231739001527, -25581.040627284485, -25727.808939913433, -26050.094496583788, -25627.41920535082, -25862.778591292834, -25535.63315259287, -25817.24449785403, -25554.02461551194, -25667.1435888165, -25572.30506324793, -25909.623666683325, -25906.30253132032, -25432.266347912846, -25732.81659573895], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.5372937846880985, "mean_inference_ms": 0.29902800786190764, "mean_action_processing_ms": 0.07156250231713857, "mean_env_wait_ms": 1.8161494397054831, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0035598278045654297, "StateBufferConnector_ms": 0.002701997756958008, "ViewRequirementAgentConnector_ms": 0.06722450256347656}}, "episode_reward_max": -25432.266347912846, "episode_reward_min": -26292.74912149601, "episode_reward_mean": -25731.80247509835, "episode_len_mean": 360.0, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-25991.60090523408, -25657.920462761886, -25756.19734831615, -25834.497845832582, -25624.406599402155, -25623.049176246823, -25834.387053352883, -25867.29379257149, -25643.505537482684, -25742.651422327574, -25655.41416648919, -25868.80945227319, -25847.479213891227, -25701.472246302383, -25777.462466382396, -25746.282582200427, -25736.64438715656, -26000.001128408145, -25770.531153735996, -25562.446197956648, -25885.57919387728, -25585.13596090559, -25665.96732020764, -25656.675229452405, -25456.717753643752, -25562.242933916827, -25671.411627128025, -25864.70163439365, -25462.346071828535, -25554.082619155375, -25880.440581548897, -25614.01025244211, -25723.019301323944, -25767.108546182273, -25693.931776022073, -25934.307805282882, -25799.75016982112, -25767.052116667943, -25703.318308026996, -25738.33987263904, -25839.263566717633, -26058.03842804496, -25466.52483052838, -25723.79005705918, -25568.652334018734, -25658.751086979817, -25796.293306878513, -25637.135134172895, -25720.455000826445, -25745.1061000994, -25758.48543409182, -25494.397311504414, -25789.560259672373, -25831.446464554898, -26292.74912149601, -26025.814025900996, -25600.615904250113, -25567.710739410242, -25446.56237118809, -25880.78798693058, -25942.846714375417, -25594.024268471265, -25579.20574384092, -25661.59977255986, -25598.831299808346, -25899.70477172812, -25850.679229500052, -25544.127208032158, -25874.947030441388, -25476.042929746214, -25434.221900294273, -25831.365619237313, -25811.81453460429, -25673.72611278101, -25990.10945101598, -25561.52865470146, -25688.503926052967, -25778.21999850185, -25931.228199220746, -25487.820385521598, -25892.52578831003, -25926.288180379986, -25576.830954405363, -25858.329583932533, -25965.659916149998, -25643.231739001527, -25581.040627284485, -25727.808939913433, -26050.094496583788, -25627.41920535082, -25862.778591292834, -25535.63315259287, -25817.24449785403, -25554.02461551194, -25667.1435888165, -25572.30506324793, -25909.623666683325, -25906.30253132032, -25432.266347912846, -25732.81659573895], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.5372937846880985, "mean_inference_ms": 0.29902800786190764, "mean_action_processing_ms": 0.07156250231713857, "mean_env_wait_ms": 1.8161494397054831, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0035598278045654297, "StateBufferConnector_ms": 0.002701997756958008, "ViewRequirementAgentConnector_ms": 0.06722450256347656}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 330840, "num_agent_steps_trained": 330840, "num_env_steps_sampled": 330840, "num_env_steps_trained": 330840, "num_env_steps_sampled_this_iter": 1080, "num_env_steps_trained_this_iter": 1080, "num_env_steps_sampled_throughput_per_sec": 95.36886385289343, "num_env_steps_trained_throughput_per_sec": 95.36886385289343, "timesteps_total": 330840, "num_steps_trained_this_iter": 1080, "agent_timesteps_total": 330840, "timers": {"training_iteration_time_ms": 3796.294, "sample_time_ms": 3785.578, "load_time_ms": 0.295, "load_throughput": 1218979.123, "learn_time_ms": 9.671, "learn_throughput": 37223.879, "synch_weights_time_ms": 0.706}, "counters": {"num_env_steps_sampled": 330840, "num_env_steps_trained": 330840, "num_agent_steps_sampled": 330840, "num_agent_steps_trained": 330840}, "done": false, "episodes_total": 919, "training_iteration": 233, "trial_id": "f5e97_00000", "date": "2023-07-25_17-39-38", "timestamp": 1690295978, "time_this_iter_s": 11.327223062515259, "time_total_s": 2619.8784081935883, "pid": 71917, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[0, 0.003], [5400, 0.001], [10800, 0.00075], [16200, 0.0005], [21600, 0.00025], [27000, 0.0001], [32400, 7.5e-05], [37800, 5e-05], [43200, 2.5e-05], [48600, 1e-05], [54000, 7.5e-06], [59400, 5e-06], [64800, 2.5e-06], [70200, 1e-06], [75600, 5e-07], [81000, 1e-07]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x304530310>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 2619.8784081935883, "iterations_since_restore": 233, "perf": {"cpu_util_percent": 24.5375, "ram_util_percent": 74.6625}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-07, "entropy_coeff": 0.1, "policy_entropy": -926.699951171875, "policy_loss": -9339657747660.8, "vf_loss": 1107763296.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 4608.0, "diff_num_grad_updates_vs_sampler_policy": 4607.0}}, "num_env_steps_sampled": 331920, "num_env_steps_trained": 331920, "num_agent_steps_sampled": 331920, "num_agent_steps_trained": 331920}, "sampler_results": {"episode_reward_max": -25432.266347912846, "episode_reward_min": -26292.74912149601, "episode_reward_mean": -25732.951595586364, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-25834.497845832582, -25624.406599402155, -25623.049176246823, -25834.387053352883, -25867.29379257149, -25643.505537482684, -25742.651422327574, -25655.41416648919, -25868.80945227319, -25847.479213891227, -25701.472246302383, -25777.462466382396, -25746.282582200427, -25736.64438715656, -26000.001128408145, -25770.531153735996, -25562.446197956648, -25885.57919387728, -25585.13596090559, -25665.96732020764, -25656.675229452405, -25456.717753643752, -25562.242933916827, -25671.411627128025, -25864.70163439365, -25462.346071828535, -25554.082619155375, -25880.440581548897, -25614.01025244211, -25723.019301323944, -25767.108546182273, -25693.931776022073, -25934.307805282882, -25799.75016982112, -25767.052116667943, -25703.318308026996, -25738.33987263904, -25839.263566717633, -26058.03842804496, -25466.52483052838, -25723.79005705918, -25568.652334018734, -25658.751086979817, -25796.293306878513, -25637.135134172895, -25720.455000826445, -25745.1061000994, -25758.48543409182, -25494.397311504414, -25789.560259672373, -25831.446464554898, -26292.74912149601, -26025.814025900996, -25600.615904250113, -25567.710739410242, -25446.56237118809, -25880.78798693058, -25942.846714375417, -25594.024268471265, -25579.20574384092, -25661.59977255986, -25598.831299808346, -25899.70477172812, -25850.679229500052, -25544.127208032158, -25874.947030441388, -25476.042929746214, -25434.221900294273, -25831.365619237313, -25811.81453460429, -25673.72611278101, -25990.10945101598, -25561.52865470146, -25688.503926052967, -25778.21999850185, -25931.228199220746, -25487.820385521598, -25892.52578831003, -25926.288180379986, -25576.830954405363, -25858.329583932533, -25965.659916149998, -25643.231739001527, -25581.040627284485, -25727.808939913433, -26050.094496583788, -25627.41920535082, -25862.778591292834, -25535.63315259287, -25817.24449785403, -25554.02461551194, -25667.1435888165, -25572.30506324793, -25909.623666683325, -25906.30253132032, -25432.266347912846, -25732.81659573895, -25859.820025494166, -25874.874443001965, -25785.936296617514], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.544026000869118, "mean_inference_ms": 0.2993319209059373, "mean_action_processing_ms": 0.07163660317770297, "mean_env_wait_ms": 1.8182100942809734, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0035572052001953125, "StateBufferConnector_ms": 0.0027036666870117188, "ViewRequirementAgentConnector_ms": 0.06722068786621094}}, "episode_reward_max": -25432.266347912846, "episode_reward_min": -26292.74912149601, "episode_reward_mean": -25732.951595586364, "episode_len_mean": 360.0, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-25834.497845832582, -25624.406599402155, -25623.049176246823, -25834.387053352883, -25867.29379257149, -25643.505537482684, -25742.651422327574, -25655.41416648919, -25868.80945227319, -25847.479213891227, -25701.472246302383, -25777.462466382396, -25746.282582200427, -25736.64438715656, -26000.001128408145, -25770.531153735996, -25562.446197956648, -25885.57919387728, -25585.13596090559, -25665.96732020764, -25656.675229452405, -25456.717753643752, -25562.242933916827, -25671.411627128025, -25864.70163439365, -25462.346071828535, -25554.082619155375, -25880.440581548897, -25614.01025244211, -25723.019301323944, -25767.108546182273, -25693.931776022073, -25934.307805282882, -25799.75016982112, -25767.052116667943, -25703.318308026996, -25738.33987263904, -25839.263566717633, -26058.03842804496, -25466.52483052838, -25723.79005705918, -25568.652334018734, -25658.751086979817, -25796.293306878513, -25637.135134172895, -25720.455000826445, -25745.1061000994, -25758.48543409182, -25494.397311504414, -25789.560259672373, -25831.446464554898, -26292.74912149601, -26025.814025900996, -25600.615904250113, -25567.710739410242, -25446.56237118809, -25880.78798693058, -25942.846714375417, -25594.024268471265, -25579.20574384092, -25661.59977255986, -25598.831299808346, -25899.70477172812, -25850.679229500052, -25544.127208032158, -25874.947030441388, -25476.042929746214, -25434.221900294273, -25831.365619237313, -25811.81453460429, -25673.72611278101, -25990.10945101598, -25561.52865470146, -25688.503926052967, -25778.21999850185, -25931.228199220746, -25487.820385521598, -25892.52578831003, -25926.288180379986, -25576.830954405363, -25858.329583932533, -25965.659916149998, -25643.231739001527, -25581.040627284485, -25727.808939913433, -26050.094496583788, -25627.41920535082, -25862.778591292834, -25535.63315259287, -25817.24449785403, -25554.02461551194, -25667.1435888165, -25572.30506324793, -25909.623666683325, -25906.30253132032, -25432.266347912846, -25732.81659573895, -25859.820025494166, -25874.874443001965, -25785.936296617514], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.544026000869118, "mean_inference_ms": 0.2993319209059373, "mean_action_processing_ms": 0.07163660317770297, "mean_env_wait_ms": 1.8182100942809734, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0035572052001953125, "StateBufferConnector_ms": 0.0027036666870117188, "ViewRequirementAgentConnector_ms": 0.06722068786621094}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 331920, "num_agent_steps_trained": 331920, "num_env_steps_sampled": 331920, "num_env_steps_trained": 331920, "num_env_steps_sampled_this_iter": 1080, "num_env_steps_trained_this_iter": 1080, "num_env_steps_sampled_throughput_per_sec": 97.80790506071159, "num_env_steps_trained_throughput_per_sec": 97.80790506071159, "timesteps_total": 331920, "num_steps_trained_this_iter": 1080, "agent_timesteps_total": 331920, "timers": {"training_iteration_time_ms": 3771.002, "sample_time_ms": 3760.3, "load_time_ms": 0.294, "load_throughput": 1222730.132, "learn_time_ms": 9.653, "learn_throughput": 37293.568, "synch_weights_time_ms": 0.712}, "counters": {"num_env_steps_sampled": 331920, "num_env_steps_trained": 331920, "num_agent_steps_sampled": 331920, "num_agent_steps_trained": 331920}, "done": false, "episodes_total": 922, "training_iteration": 234, "trial_id": "f5e97_00000", "date": "2023-07-25_17-39-49", "timestamp": 1690295989, "time_this_iter_s": 11.044898986816406, "time_total_s": 2630.9233071804047, "pid": 71917, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[0, 0.003], [5400, 0.001], [10800, 0.00075], [16200, 0.0005], [21600, 0.00025], [27000, 0.0001], [32400, 7.5e-05], [37800, 5e-05], [43200, 2.5e-05], [48600, 1e-05], [54000, 7.5e-06], [59400, 5e-06], [64800, 2.5e-06], [70200, 1e-06], [75600, 5e-07], [81000, 1e-07]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x304530310>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 2630.9233071804047, "iterations_since_restore": 234, "perf": {"cpu_util_percent": 26.81875, "ram_util_percent": 74.51250000000002}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-07, "entropy_coeff": 0.1, "policy_entropy": -926.7, "policy_loss": -23190834675712.0, "vf_loss": 1089450291.2}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 4623.0, "diff_num_grad_updates_vs_sampler_policy": 4622.0}}, "num_env_steps_sampled": 333000, "num_env_steps_trained": 333000, "num_agent_steps_sampled": 333000, "num_agent_steps_trained": 333000}, "sampler_results": {"episode_reward_max": -25432.266347912846, "episode_reward_min": -26292.74912149601, "episode_reward_mean": -25735.943195221746, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-25834.387053352883, -25867.29379257149, -25643.505537482684, -25742.651422327574, -25655.41416648919, -25868.80945227319, -25847.479213891227, -25701.472246302383, -25777.462466382396, -25746.282582200427, -25736.64438715656, -26000.001128408145, -25770.531153735996, -25562.446197956648, -25885.57919387728, -25585.13596090559, -25665.96732020764, -25656.675229452405, -25456.717753643752, -25562.242933916827, -25671.411627128025, -25864.70163439365, -25462.346071828535, -25554.082619155375, -25880.440581548897, -25614.01025244211, -25723.019301323944, -25767.108546182273, -25693.931776022073, -25934.307805282882, -25799.75016982112, -25767.052116667943, -25703.318308026996, -25738.33987263904, -25839.263566717633, -26058.03842804496, -25466.52483052838, -25723.79005705918, -25568.652334018734, -25658.751086979817, -25796.293306878513, -25637.135134172895, -25720.455000826445, -25745.1061000994, -25758.48543409182, -25494.397311504414, -25789.560259672373, -25831.446464554898, -26292.74912149601, -26025.814025900996, -25600.615904250113, -25567.710739410242, -25446.56237118809, -25880.78798693058, -25942.846714375417, -25594.024268471265, -25579.20574384092, -25661.59977255986, -25598.831299808346, -25899.70477172812, -25850.679229500052, -25544.127208032158, -25874.947030441388, -25476.042929746214, -25434.221900294273, -25831.365619237313, -25811.81453460429, -25673.72611278101, -25990.10945101598, -25561.52865470146, -25688.503926052967, -25778.21999850185, -25931.228199220746, -25487.820385521598, -25892.52578831003, -25926.288180379986, -25576.830954405363, -25858.329583932533, -25965.659916149998, -25643.231739001527, -25581.040627284485, -25727.808939913433, -26050.094496583788, -25627.41920535082, -25862.778591292834, -25535.63315259287, -25817.24449785403, -25554.02461551194, -25667.1435888165, -25572.30506324793, -25909.623666683325, -25906.30253132032, -25432.266347912846, -25732.81659573895, -25859.820025494166, -25874.874443001965, -25785.936296617514, -25857.281454639342, -25890.057598573258, -25633.77453180659], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.550703373895714, "mean_inference_ms": 0.29963321613211247, "mean_action_processing_ms": 0.07171007943897185, "mean_env_wait_ms": 1.820257993924248, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003557920455932617, "StateBufferConnector_ms": 0.002695322036743164, "ViewRequirementAgentConnector_ms": 0.06716299057006836}}, "episode_reward_max": -25432.266347912846, "episode_reward_min": -26292.74912149601, "episode_reward_mean": -25735.943195221746, "episode_len_mean": 360.0, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-25834.387053352883, -25867.29379257149, -25643.505537482684, -25742.651422327574, -25655.41416648919, -25868.80945227319, -25847.479213891227, -25701.472246302383, -25777.462466382396, -25746.282582200427, -25736.64438715656, -26000.001128408145, -25770.531153735996, -25562.446197956648, -25885.57919387728, -25585.13596090559, -25665.96732020764, -25656.675229452405, -25456.717753643752, -25562.242933916827, -25671.411627128025, -25864.70163439365, -25462.346071828535, -25554.082619155375, -25880.440581548897, -25614.01025244211, -25723.019301323944, -25767.108546182273, -25693.931776022073, -25934.307805282882, -25799.75016982112, -25767.052116667943, -25703.318308026996, -25738.33987263904, -25839.263566717633, -26058.03842804496, -25466.52483052838, -25723.79005705918, -25568.652334018734, -25658.751086979817, -25796.293306878513, -25637.135134172895, -25720.455000826445, -25745.1061000994, -25758.48543409182, -25494.397311504414, -25789.560259672373, -25831.446464554898, -26292.74912149601, -26025.814025900996, -25600.615904250113, -25567.710739410242, -25446.56237118809, -25880.78798693058, -25942.846714375417, -25594.024268471265, -25579.20574384092, -25661.59977255986, -25598.831299808346, -25899.70477172812, -25850.679229500052, -25544.127208032158, -25874.947030441388, -25476.042929746214, -25434.221900294273, -25831.365619237313, -25811.81453460429, -25673.72611278101, -25990.10945101598, -25561.52865470146, -25688.503926052967, -25778.21999850185, -25931.228199220746, -25487.820385521598, -25892.52578831003, -25926.288180379986, -25576.830954405363, -25858.329583932533, -25965.659916149998, -25643.231739001527, -25581.040627284485, -25727.808939913433, -26050.094496583788, -25627.41920535082, -25862.778591292834, -25535.63315259287, -25817.24449785403, -25554.02461551194, -25667.1435888165, -25572.30506324793, -25909.623666683325, -25906.30253132032, -25432.266347912846, -25732.81659573895, -25859.820025494166, -25874.874443001965, -25785.936296617514, -25857.281454639342, -25890.057598573258, -25633.77453180659], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.550703373895714, "mean_inference_ms": 0.29963321613211247, "mean_action_processing_ms": 0.07171007943897185, "mean_env_wait_ms": 1.820257993924248, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003557920455932617, "StateBufferConnector_ms": 0.002695322036743164, "ViewRequirementAgentConnector_ms": 0.06716299057006836}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 333000, "num_agent_steps_trained": 333000, "num_env_steps_sampled": 333000, "num_env_steps_trained": 333000, "num_env_steps_sampled_this_iter": 1080, "num_env_steps_trained_this_iter": 1080, "num_env_steps_sampled_throughput_per_sec": 97.75564767097895, "num_env_steps_trained_throughput_per_sec": 97.75564767097895, "timesteps_total": 333000, "num_steps_trained_this_iter": 1080, "agent_timesteps_total": 333000, "timers": {"training_iteration_time_ms": 3731.18, "sample_time_ms": 3720.459, "load_time_ms": 0.295, "load_throughput": 1219175.971, "learn_time_ms": 9.69, "learn_throughput": 37152.348, "synch_weights_time_ms": 0.693}, "counters": {"num_env_steps_sampled": 333000, "num_env_steps_trained": 333000, "num_agent_steps_sampled": 333000, "num_agent_steps_trained": 333000}, "done": false, "episodes_total": 925, "training_iteration": 235, "trial_id": "f5e97_00000", "date": "2023-07-25_17-40-00", "timestamp": 1690296000, "time_this_iter_s": 11.050655364990234, "time_total_s": 2641.973962545395, "pid": 71917, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[0, 0.003], [5400, 0.001], [10800, 0.00075], [16200, 0.0005], [21600, 0.00025], [27000, 0.0001], [32400, 7.5e-05], [37800, 5e-05], [43200, 2.5e-05], [48600, 1e-05], [54000, 7.5e-06], [59400, 5e-06], [64800, 2.5e-06], [70200, 1e-06], [75600, 5e-07], [81000, 1e-07]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x304530310>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 2641.973962545395, "iterations_since_restore": 235, "perf": {"cpu_util_percent": 26.8125, "ram_util_percent": 74.58125000000001}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-07, "entropy_coeff": 0.1, "policy_entropy": -926.6997802734375, "policy_loss": -24589322761011.2, "vf_loss": 1104734976.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 4638.0, "diff_num_grad_updates_vs_sampler_policy": 4637.0}}, "num_env_steps_sampled": 334080, "num_env_steps_trained": 334080, "num_agent_steps_sampled": 334080, "num_agent_steps_trained": 334080}, "sampler_results": {"episode_reward_max": -25432.266347912846, "episode_reward_min": -26292.74912149601, "episode_reward_mean": -25736.289880518845, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-25742.651422327574, -25655.41416648919, -25868.80945227319, -25847.479213891227, -25701.472246302383, -25777.462466382396, -25746.282582200427, -25736.64438715656, -26000.001128408145, -25770.531153735996, -25562.446197956648, -25885.57919387728, -25585.13596090559, -25665.96732020764, -25656.675229452405, -25456.717753643752, -25562.242933916827, -25671.411627128025, -25864.70163439365, -25462.346071828535, -25554.082619155375, -25880.440581548897, -25614.01025244211, -25723.019301323944, -25767.108546182273, -25693.931776022073, -25934.307805282882, -25799.75016982112, -25767.052116667943, -25703.318308026996, -25738.33987263904, -25839.263566717633, -26058.03842804496, -25466.52483052838, -25723.79005705918, -25568.652334018734, -25658.751086979817, -25796.293306878513, -25637.135134172895, -25720.455000826445, -25745.1061000994, -25758.48543409182, -25494.397311504414, -25789.560259672373, -25831.446464554898, -26292.74912149601, -26025.814025900996, -25600.615904250113, -25567.710739410242, -25446.56237118809, -25880.78798693058, -25942.846714375417, -25594.024268471265, -25579.20574384092, -25661.59977255986, -25598.831299808346, -25899.70477172812, -25850.679229500052, -25544.127208032158, -25874.947030441388, -25476.042929746214, -25434.221900294273, -25831.365619237313, -25811.81453460429, -25673.72611278101, -25990.10945101598, -25561.52865470146, -25688.503926052967, -25778.21999850185, -25931.228199220746, -25487.820385521598, -25892.52578831003, -25926.288180379986, -25576.830954405363, -25858.329583932533, -25965.659916149998, -25643.231739001527, -25581.040627284485, -25727.808939913433, -26050.094496583788, -25627.41920535082, -25862.778591292834, -25535.63315259287, -25817.24449785403, -25554.02461551194, -25667.1435888165, -25572.30506324793, -25909.623666683325, -25906.30253132032, -25432.266347912846, -25732.81659573895, -25859.820025494166, -25874.874443001965, -25785.936296617514, -25857.281454639342, -25890.057598573258, -25633.77453180659, -25797.035561210163, -25799.212728336177, -25783.60662357148], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.557322591398742, "mean_inference_ms": 0.2999327378302115, "mean_action_processing_ms": 0.07178309433133441, "mean_env_wait_ms": 1.822291229113159, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0035583972930908203, "StateBufferConnector_ms": 0.002689838409423828, "ViewRequirementAgentConnector_ms": 0.06715655326843262}}, "episode_reward_max": -25432.266347912846, "episode_reward_min": -26292.74912149601, "episode_reward_mean": -25736.289880518845, "episode_len_mean": 360.0, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-25742.651422327574, -25655.41416648919, -25868.80945227319, -25847.479213891227, -25701.472246302383, -25777.462466382396, -25746.282582200427, -25736.64438715656, -26000.001128408145, -25770.531153735996, -25562.446197956648, -25885.57919387728, -25585.13596090559, -25665.96732020764, -25656.675229452405, -25456.717753643752, -25562.242933916827, -25671.411627128025, -25864.70163439365, -25462.346071828535, -25554.082619155375, -25880.440581548897, -25614.01025244211, -25723.019301323944, -25767.108546182273, -25693.931776022073, -25934.307805282882, -25799.75016982112, -25767.052116667943, -25703.318308026996, -25738.33987263904, -25839.263566717633, -26058.03842804496, -25466.52483052838, -25723.79005705918, -25568.652334018734, -25658.751086979817, -25796.293306878513, -25637.135134172895, -25720.455000826445, -25745.1061000994, -25758.48543409182, -25494.397311504414, -25789.560259672373, -25831.446464554898, -26292.74912149601, -26025.814025900996, -25600.615904250113, -25567.710739410242, -25446.56237118809, -25880.78798693058, -25942.846714375417, -25594.024268471265, -25579.20574384092, -25661.59977255986, -25598.831299808346, -25899.70477172812, -25850.679229500052, -25544.127208032158, -25874.947030441388, -25476.042929746214, -25434.221900294273, -25831.365619237313, -25811.81453460429, -25673.72611278101, -25990.10945101598, -25561.52865470146, -25688.503926052967, -25778.21999850185, -25931.228199220746, -25487.820385521598, -25892.52578831003, -25926.288180379986, -25576.830954405363, -25858.329583932533, -25965.659916149998, -25643.231739001527, -25581.040627284485, -25727.808939913433, -26050.094496583788, -25627.41920535082, -25862.778591292834, -25535.63315259287, -25817.24449785403, -25554.02461551194, -25667.1435888165, -25572.30506324793, -25909.623666683325, -25906.30253132032, -25432.266347912846, -25732.81659573895, -25859.820025494166, -25874.874443001965, -25785.936296617514, -25857.281454639342, -25890.057598573258, -25633.77453180659, -25797.035561210163, -25799.212728336177, -25783.60662357148], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.557322591398742, "mean_inference_ms": 0.2999327378302115, "mean_action_processing_ms": 0.07178309433133441, "mean_env_wait_ms": 1.822291229113159, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0035583972930908203, "StateBufferConnector_ms": 0.002689838409423828, "ViewRequirementAgentConnector_ms": 0.06715655326843262}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 334080, "num_agent_steps_trained": 334080, "num_env_steps_sampled": 334080, "num_env_steps_trained": 334080, "num_env_steps_sampled_this_iter": 1080, "num_env_steps_trained_this_iter": 1080, "num_env_steps_sampled_throughput_per_sec": 97.41314118030273, "num_env_steps_trained_throughput_per_sec": 97.41314118030273, "timesteps_total": 334080, "num_steps_trained_this_iter": 1080, "agent_timesteps_total": 334080, "timers": {"training_iteration_time_ms": 3701.675, "sample_time_ms": 3690.996, "load_time_ms": 0.296, "load_throughput": 1216229.915, "learn_time_ms": 9.652, "learn_throughput": 37299.372, "synch_weights_time_ms": 0.689}, "counters": {"num_env_steps_sampled": 334080, "num_env_steps_trained": 334080, "num_agent_steps_sampled": 334080, "num_agent_steps_trained": 334080}, "done": false, "episodes_total": 928, "training_iteration": 236, "trial_id": "f5e97_00000", "date": "2023-07-25_17-40-11", "timestamp": 1690296011, "time_this_iter_s": 11.08959412574768, "time_total_s": 2653.0635566711426, "pid": 71917, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[0, 0.003], [5400, 0.001], [10800, 0.00075], [16200, 0.0005], [21600, 0.00025], [27000, 0.0001], [32400, 7.5e-05], [37800, 5e-05], [43200, 2.5e-05], [48600, 1e-05], [54000, 7.5e-06], [59400, 5e-06], [64800, 2.5e-06], [70200, 1e-06], [75600, 5e-07], [81000, 1e-07]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x304530310>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 2653.0635566711426, "iterations_since_restore": 236, "perf": {"cpu_util_percent": 26.886666666666667, "ram_util_percent": 74.68000000000002}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-07, "entropy_coeff": 0.1, "policy_entropy": -926.6995483398438, "policy_loss": -27543706256998.4, "vf_loss": 1132120723.2}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 4653.0, "diff_num_grad_updates_vs_sampler_policy": 4652.0}}, "num_env_steps_sampled": 335160, "num_env_steps_trained": 335160, "num_agent_steps_sampled": 335160, "num_agent_steps_trained": 335160}, "sampler_results": {"episode_reward_max": -25432.266347912846, "episode_reward_min": -26292.74912149601, "episode_reward_mean": -25737.76404006257, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-25847.479213891227, -25701.472246302383, -25777.462466382396, -25746.282582200427, -25736.64438715656, -26000.001128408145, -25770.531153735996, -25562.446197956648, -25885.57919387728, -25585.13596090559, -25665.96732020764, -25656.675229452405, -25456.717753643752, -25562.242933916827, -25671.411627128025, -25864.70163439365, -25462.346071828535, -25554.082619155375, -25880.440581548897, -25614.01025244211, -25723.019301323944, -25767.108546182273, -25693.931776022073, -25934.307805282882, -25799.75016982112, -25767.052116667943, -25703.318308026996, -25738.33987263904, -25839.263566717633, -26058.03842804496, -25466.52483052838, -25723.79005705918, -25568.652334018734, -25658.751086979817, -25796.293306878513, -25637.135134172895, -25720.455000826445, -25745.1061000994, -25758.48543409182, -25494.397311504414, -25789.560259672373, -25831.446464554898, -26292.74912149601, -26025.814025900996, -25600.615904250113, -25567.710739410242, -25446.56237118809, -25880.78798693058, -25942.846714375417, -25594.024268471265, -25579.20574384092, -25661.59977255986, -25598.831299808346, -25899.70477172812, -25850.679229500052, -25544.127208032158, -25874.947030441388, -25476.042929746214, -25434.221900294273, -25831.365619237313, -25811.81453460429, -25673.72611278101, -25990.10945101598, -25561.52865470146, -25688.503926052967, -25778.21999850185, -25931.228199220746, -25487.820385521598, -25892.52578831003, -25926.288180379986, -25576.830954405363, -25858.329583932533, -25965.659916149998, -25643.231739001527, -25581.040627284485, -25727.808939913433, -26050.094496583788, -25627.41920535082, -25862.778591292834, -25535.63315259287, -25817.24449785403, -25554.02461551194, -25667.1435888165, -25572.30506324793, -25909.623666683325, -25906.30253132032, -25432.266347912846, -25732.81659573895, -25859.820025494166, -25874.874443001965, -25785.936296617514, -25857.281454639342, -25890.057598573258, -25633.77453180659, -25797.035561210163, -25799.212728336177, -25783.60662357148, -25755.748960656238, -25540.680275374503, -26117.861759431467], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.563886081997482, "mean_inference_ms": 0.3002293163577594, "mean_action_processing_ms": 0.07185542241719124, "mean_env_wait_ms": 1.824307265695949, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0035500526428222656, "StateBufferConnector_ms": 0.002690553665161133, "ViewRequirementAgentConnector_ms": 0.06708240509033203}}, "episode_reward_max": -25432.266347912846, "episode_reward_min": -26292.74912149601, "episode_reward_mean": -25737.76404006257, "episode_len_mean": 360.0, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-25847.479213891227, -25701.472246302383, -25777.462466382396, -25746.282582200427, -25736.64438715656, -26000.001128408145, -25770.531153735996, -25562.446197956648, -25885.57919387728, -25585.13596090559, -25665.96732020764, -25656.675229452405, -25456.717753643752, -25562.242933916827, -25671.411627128025, -25864.70163439365, -25462.346071828535, -25554.082619155375, -25880.440581548897, -25614.01025244211, -25723.019301323944, -25767.108546182273, -25693.931776022073, -25934.307805282882, -25799.75016982112, -25767.052116667943, -25703.318308026996, -25738.33987263904, -25839.263566717633, -26058.03842804496, -25466.52483052838, -25723.79005705918, -25568.652334018734, -25658.751086979817, -25796.293306878513, -25637.135134172895, -25720.455000826445, -25745.1061000994, -25758.48543409182, -25494.397311504414, -25789.560259672373, -25831.446464554898, -26292.74912149601, -26025.814025900996, -25600.615904250113, -25567.710739410242, -25446.56237118809, -25880.78798693058, -25942.846714375417, -25594.024268471265, -25579.20574384092, -25661.59977255986, -25598.831299808346, -25899.70477172812, -25850.679229500052, -25544.127208032158, -25874.947030441388, -25476.042929746214, -25434.221900294273, -25831.365619237313, -25811.81453460429, -25673.72611278101, -25990.10945101598, -25561.52865470146, -25688.503926052967, -25778.21999850185, -25931.228199220746, -25487.820385521598, -25892.52578831003, -25926.288180379986, -25576.830954405363, -25858.329583932533, -25965.659916149998, -25643.231739001527, -25581.040627284485, -25727.808939913433, -26050.094496583788, -25627.41920535082, -25862.778591292834, -25535.63315259287, -25817.24449785403, -25554.02461551194, -25667.1435888165, -25572.30506324793, -25909.623666683325, -25906.30253132032, -25432.266347912846, -25732.81659573895, -25859.820025494166, -25874.874443001965, -25785.936296617514, -25857.281454639342, -25890.057598573258, -25633.77453180659, -25797.035561210163, -25799.212728336177, -25783.60662357148, -25755.748960656238, -25540.680275374503, -26117.861759431467], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.563886081997482, "mean_inference_ms": 0.3002293163577594, "mean_action_processing_ms": 0.07185542241719124, "mean_env_wait_ms": 1.824307265695949, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0035500526428222656, "StateBufferConnector_ms": 0.002690553665161133, "ViewRequirementAgentConnector_ms": 0.06708240509033203}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 335160, "num_agent_steps_trained": 335160, "num_env_steps_sampled": 335160, "num_env_steps_trained": 335160, "num_env_steps_sampled_this_iter": 1080, "num_env_steps_trained_this_iter": 1080, "num_env_steps_sampled_throughput_per_sec": 96.70122339042256, "num_env_steps_trained_throughput_per_sec": 96.70122339042256, "timesteps_total": 335160, "num_steps_trained_this_iter": 1080, "agent_timesteps_total": 335160, "timers": {"training_iteration_time_ms": 3700.98, "sample_time_ms": 3690.289, "load_time_ms": 0.297, "load_throughput": 1213103.109, "learn_time_ms": 9.657, "learn_throughput": 37277.272, "synch_weights_time_ms": 0.694}, "counters": {"num_env_steps_sampled": 335160, "num_env_steps_trained": 335160, "num_agent_steps_sampled": 335160, "num_agent_steps_trained": 335160}, "done": false, "episodes_total": 931, "training_iteration": 237, "trial_id": "f5e97_00000", "date": "2023-07-25_17-40-22", "timestamp": 1690296022, "time_this_iter_s": 11.171381950378418, "time_total_s": 2664.234938621521, "pid": 71917, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[0, 0.003], [5400, 0.001], [10800, 0.00075], [16200, 0.0005], [21600, 0.00025], [27000, 0.0001], [32400, 7.5e-05], [37800, 5e-05], [43200, 2.5e-05], [48600, 1e-05], [54000, 7.5e-06], [59400, 5e-06], [64800, 2.5e-06], [70200, 1e-06], [75600, 5e-07], [81000, 1e-07]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x304530310>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 2664.234938621521, "iterations_since_restore": 237, "perf": {"cpu_util_percent": 24.712500000000002, "ram_util_percent": 74.425}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-07, "entropy_coeff": 0.1, "policy_entropy": -926.6999145507813, "policy_loss": -36349912218009.6, "vf_loss": 1085705715.2}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 4668.0, "diff_num_grad_updates_vs_sampler_policy": 4667.0}}, "num_env_steps_sampled": 336240, "num_env_steps_trained": 336240, "num_agent_steps_sampled": 336240, "num_agent_steps_trained": 336240}, "sampler_results": {"episode_reward_max": -25432.266347912846, "episode_reward_min": -26292.74912149601, "episode_reward_mean": -25739.226132925156, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-25746.282582200427, -25736.64438715656, -26000.001128408145, -25770.531153735996, -25562.446197956648, -25885.57919387728, -25585.13596090559, -25665.96732020764, -25656.675229452405, -25456.717753643752, -25562.242933916827, -25671.411627128025, -25864.70163439365, -25462.346071828535, -25554.082619155375, -25880.440581548897, -25614.01025244211, -25723.019301323944, -25767.108546182273, -25693.931776022073, -25934.307805282882, -25799.75016982112, -25767.052116667943, -25703.318308026996, -25738.33987263904, -25839.263566717633, -26058.03842804496, -25466.52483052838, -25723.79005705918, -25568.652334018734, -25658.751086979817, -25796.293306878513, -25637.135134172895, -25720.455000826445, -25745.1061000994, -25758.48543409182, -25494.397311504414, -25789.560259672373, -25831.446464554898, -26292.74912149601, -26025.814025900996, -25600.615904250113, -25567.710739410242, -25446.56237118809, -25880.78798693058, -25942.846714375417, -25594.024268471265, -25579.20574384092, -25661.59977255986, -25598.831299808346, -25899.70477172812, -25850.679229500052, -25544.127208032158, -25874.947030441388, -25476.042929746214, -25434.221900294273, -25831.365619237313, -25811.81453460429, -25673.72611278101, -25990.10945101598, -25561.52865470146, -25688.503926052967, -25778.21999850185, -25931.228199220746, -25487.820385521598, -25892.52578831003, -25926.288180379986, -25576.830954405363, -25858.329583932533, -25965.659916149998, -25643.231739001527, -25581.040627284485, -25727.808939913433, -26050.094496583788, -25627.41920535082, -25862.778591292834, -25535.63315259287, -25817.24449785403, -25554.02461551194, -25667.1435888165, -25572.30506324793, -25909.623666683325, -25906.30253132032, -25432.266347912846, -25732.81659573895, -25859.820025494166, -25874.874443001965, -25785.936296617514, -25857.281454639342, -25890.057598573258, -25633.77453180659, -25797.035561210163, -25799.212728336177, -25783.60662357148, -25755.748960656238, -25540.680275374503, -26117.861759431467, -25775.986904825855, -26110.922735090542, -25585.71357291799], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.570397100777853, "mean_inference_ms": 0.3005236404086812, "mean_action_processing_ms": 0.07192724306957206, "mean_env_wait_ms": 1.826316673896222, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0035524368286132812, "StateBufferConnector_ms": 0.002688169479370117, "ViewRequirementAgentConnector_ms": 0.06712889671325684}}, "episode_reward_max": -25432.266347912846, "episode_reward_min": -26292.74912149601, "episode_reward_mean": -25739.226132925156, "episode_len_mean": 360.0, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-25746.282582200427, -25736.64438715656, -26000.001128408145, -25770.531153735996, -25562.446197956648, -25885.57919387728, -25585.13596090559, -25665.96732020764, -25656.675229452405, -25456.717753643752, -25562.242933916827, -25671.411627128025, -25864.70163439365, -25462.346071828535, -25554.082619155375, -25880.440581548897, -25614.01025244211, -25723.019301323944, -25767.108546182273, -25693.931776022073, -25934.307805282882, -25799.75016982112, -25767.052116667943, -25703.318308026996, -25738.33987263904, -25839.263566717633, -26058.03842804496, -25466.52483052838, -25723.79005705918, -25568.652334018734, -25658.751086979817, -25796.293306878513, -25637.135134172895, -25720.455000826445, -25745.1061000994, -25758.48543409182, -25494.397311504414, -25789.560259672373, -25831.446464554898, -26292.74912149601, -26025.814025900996, -25600.615904250113, -25567.710739410242, -25446.56237118809, -25880.78798693058, -25942.846714375417, -25594.024268471265, -25579.20574384092, -25661.59977255986, -25598.831299808346, -25899.70477172812, -25850.679229500052, -25544.127208032158, -25874.947030441388, -25476.042929746214, -25434.221900294273, -25831.365619237313, -25811.81453460429, -25673.72611278101, -25990.10945101598, -25561.52865470146, -25688.503926052967, -25778.21999850185, -25931.228199220746, -25487.820385521598, -25892.52578831003, -25926.288180379986, -25576.830954405363, -25858.329583932533, -25965.659916149998, -25643.231739001527, -25581.040627284485, -25727.808939913433, -26050.094496583788, -25627.41920535082, -25862.778591292834, -25535.63315259287, -25817.24449785403, -25554.02461551194, -25667.1435888165, -25572.30506324793, -25909.623666683325, -25906.30253132032, -25432.266347912846, -25732.81659573895, -25859.820025494166, -25874.874443001965, -25785.936296617514, -25857.281454639342, -25890.057598573258, -25633.77453180659, -25797.035561210163, -25799.212728336177, -25783.60662357148, -25755.748960656238, -25540.680275374503, -26117.861759431467, -25775.986904825855, -26110.922735090542, -25585.71357291799], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.570397100777853, "mean_inference_ms": 0.3005236404086812, "mean_action_processing_ms": 0.07192724306957206, "mean_env_wait_ms": 1.826316673896222, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0035524368286132812, "StateBufferConnector_ms": 0.002688169479370117, "ViewRequirementAgentConnector_ms": 0.06712889671325684}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 336240, "num_agent_steps_trained": 336240, "num_env_steps_sampled": 336240, "num_env_steps_trained": 336240, "num_env_steps_sampled_this_iter": 1080, "num_env_steps_trained_this_iter": 1080, "num_env_steps_sampled_throughput_per_sec": 95.56756746721284, "num_env_steps_trained_throughput_per_sec": 95.56756746721284, "timesteps_total": 336240, "num_steps_trained_this_iter": 1080, "agent_timesteps_total": 336240, "timers": {"training_iteration_time_ms": 3715.969, "sample_time_ms": 3705.318, "load_time_ms": 0.297, "load_throughput": 1210574.393, "learn_time_ms": 9.62, "learn_throughput": 37421.856, "synch_weights_time_ms": 0.691}, "counters": {"num_env_steps_sampled": 336240, "num_env_steps_trained": 336240, "num_agent_steps_sampled": 336240, "num_agent_steps_trained": 336240}, "done": false, "episodes_total": 934, "training_iteration": 238, "trial_id": "f5e97_00000", "date": "2023-07-25_17-40-34", "timestamp": 1690296034, "time_this_iter_s": 11.303815126419067, "time_total_s": 2675.53875374794, "pid": 71917, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[0, 0.003], [5400, 0.001], [10800, 0.00075], [16200, 0.0005], [21600, 0.00025], [27000, 0.0001], [32400, 7.5e-05], [37800, 5e-05], [43200, 2.5e-05], [48600, 1e-05], [54000, 7.5e-06], [59400, 5e-06], [64800, 2.5e-06], [70200, 1e-06], [75600, 5e-07], [81000, 1e-07]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x304530310>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 2675.53875374794, "iterations_since_restore": 238, "perf": {"cpu_util_percent": 24.225, "ram_util_percent": 74.45625000000001}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-07, "entropy_coeff": 0.1, "policy_entropy": -926.699951171875, "policy_loss": -26864018503270.4, "vf_loss": 1098569049.6}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 4683.0, "diff_num_grad_updates_vs_sampler_policy": 4682.0}}, "num_env_steps_sampled": 337320, "num_env_steps_trained": 337320, "num_agent_steps_sampled": 337320, "num_agent_steps_trained": 337320}, "sampler_results": {"episode_reward_max": -25432.266347912846, "episode_reward_min": -26292.74912149601, "episode_reward_mean": -25732.586039614518, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-25770.531153735996, -25562.446197956648, -25885.57919387728, -25585.13596090559, -25665.96732020764, -25656.675229452405, -25456.717753643752, -25562.242933916827, -25671.411627128025, -25864.70163439365, -25462.346071828535, -25554.082619155375, -25880.440581548897, -25614.01025244211, -25723.019301323944, -25767.108546182273, -25693.931776022073, -25934.307805282882, -25799.75016982112, -25767.052116667943, -25703.318308026996, -25738.33987263904, -25839.263566717633, -26058.03842804496, -25466.52483052838, -25723.79005705918, -25568.652334018734, -25658.751086979817, -25796.293306878513, -25637.135134172895, -25720.455000826445, -25745.1061000994, -25758.48543409182, -25494.397311504414, -25789.560259672373, -25831.446464554898, -26292.74912149601, -26025.814025900996, -25600.615904250113, -25567.710739410242, -25446.56237118809, -25880.78798693058, -25942.846714375417, -25594.024268471265, -25579.20574384092, -25661.59977255986, -25598.831299808346, -25899.70477172812, -25850.679229500052, -25544.127208032158, -25874.947030441388, -25476.042929746214, -25434.221900294273, -25831.365619237313, -25811.81453460429, -25673.72611278101, -25990.10945101598, -25561.52865470146, -25688.503926052967, -25778.21999850185, -25931.228199220746, -25487.820385521598, -25892.52578831003, -25926.288180379986, -25576.830954405363, -25858.329583932533, -25965.659916149998, -25643.231739001527, -25581.040627284485, -25727.808939913433, -26050.094496583788, -25627.41920535082, -25862.778591292834, -25535.63315259287, -25817.24449785403, -25554.02461551194, -25667.1435888165, -25572.30506324793, -25909.623666683325, -25906.30253132032, -25432.266347912846, -25732.81659573895, -25859.820025494166, -25874.874443001965, -25785.936296617514, -25857.281454639342, -25890.057598573258, -25633.77453180659, -25797.035561210163, -25799.212728336177, -25783.60662357148, -25755.748960656238, -25540.680275374503, -26117.861759431467, -25775.986904825855, -26110.922735090542, -25585.71357291799, -25532.626951785183, -25534.667293328057, -25751.624521587855], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.576868760379771, "mean_inference_ms": 0.30081609163420203, "mean_action_processing_ms": 0.07199854623461478, "mean_env_wait_ms": 1.8283229505365675, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0035626888275146484, "StateBufferConnector_ms": 0.0026884078979492188, "ViewRequirementAgentConnector_ms": 0.06722235679626465}}, "episode_reward_max": -25432.266347912846, "episode_reward_min": -26292.74912149601, "episode_reward_mean": -25732.586039614518, "episode_len_mean": 360.0, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-25770.531153735996, -25562.446197956648, -25885.57919387728, -25585.13596090559, -25665.96732020764, -25656.675229452405, -25456.717753643752, -25562.242933916827, -25671.411627128025, -25864.70163439365, -25462.346071828535, -25554.082619155375, -25880.440581548897, -25614.01025244211, -25723.019301323944, -25767.108546182273, -25693.931776022073, -25934.307805282882, -25799.75016982112, -25767.052116667943, -25703.318308026996, -25738.33987263904, -25839.263566717633, -26058.03842804496, -25466.52483052838, -25723.79005705918, -25568.652334018734, -25658.751086979817, -25796.293306878513, -25637.135134172895, -25720.455000826445, -25745.1061000994, -25758.48543409182, -25494.397311504414, -25789.560259672373, -25831.446464554898, -26292.74912149601, -26025.814025900996, -25600.615904250113, -25567.710739410242, -25446.56237118809, -25880.78798693058, -25942.846714375417, -25594.024268471265, -25579.20574384092, -25661.59977255986, -25598.831299808346, -25899.70477172812, -25850.679229500052, -25544.127208032158, -25874.947030441388, -25476.042929746214, -25434.221900294273, -25831.365619237313, -25811.81453460429, -25673.72611278101, -25990.10945101598, -25561.52865470146, -25688.503926052967, -25778.21999850185, -25931.228199220746, -25487.820385521598, -25892.52578831003, -25926.288180379986, -25576.830954405363, -25858.329583932533, -25965.659916149998, -25643.231739001527, -25581.040627284485, -25727.808939913433, -26050.094496583788, -25627.41920535082, -25862.778591292834, -25535.63315259287, -25817.24449785403, -25554.02461551194, -25667.1435888165, -25572.30506324793, -25909.623666683325, -25906.30253132032, -25432.266347912846, -25732.81659573895, -25859.820025494166, -25874.874443001965, -25785.936296617514, -25857.281454639342, -25890.057598573258, -25633.77453180659, -25797.035561210163, -25799.212728336177, -25783.60662357148, -25755.748960656238, -25540.680275374503, -26117.861759431467, -25775.986904825855, -26110.922735090542, -25585.71357291799, -25532.626951785183, -25534.667293328057, -25751.624521587855], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.576868760379771, "mean_inference_ms": 0.30081609163420203, "mean_action_processing_ms": 0.07199854623461478, "mean_env_wait_ms": 1.8283229505365675, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0035626888275146484, "StateBufferConnector_ms": 0.0026884078979492188, "ViewRequirementAgentConnector_ms": 0.06722235679626465}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 337320, "num_agent_steps_trained": 337320, "num_env_steps_sampled": 337320, "num_env_steps_trained": 337320, "num_env_steps_sampled_this_iter": 1080, "num_env_steps_trained_this_iter": 1080, "num_env_steps_sampled_throughput_per_sec": 94.3887532847292, "num_env_steps_trained_throughput_per_sec": 94.3887532847292, "timesteps_total": 337320, "num_steps_trained_this_iter": 1080, "agent_timesteps_total": 337320, "timers": {"training_iteration_time_ms": 3755.287, "sample_time_ms": 3744.571, "load_time_ms": 0.298, "load_throughput": 1206608.151, "learn_time_ms": 9.67, "learn_throughput": 37229.478, "synch_weights_time_ms": 0.704}, "counters": {"num_env_steps_sampled": 337320, "num_env_steps_trained": 337320, "num_agent_steps_sampled": 337320, "num_agent_steps_trained": 337320}, "done": false, "episodes_total": 937, "training_iteration": 239, "trial_id": "f5e97_00000", "date": "2023-07-25_17-40-45", "timestamp": 1690296045, "time_this_iter_s": 11.444946050643921, "time_total_s": 2686.983699798584, "pid": 71917, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[0, 0.003], [5400, 0.001], [10800, 0.00075], [16200, 0.0005], [21600, 0.00025], [27000, 0.0001], [32400, 7.5e-05], [37800, 5e-05], [43200, 2.5e-05], [48600, 1e-05], [54000, 7.5e-06], [59400, 5e-06], [64800, 2.5e-06], [70200, 1e-06], [75600, 5e-07], [81000, 1e-07]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x304530310>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 2686.983699798584, "iterations_since_restore": 239, "perf": {"cpu_util_percent": 23.6875, "ram_util_percent": 74.46875}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-07, "entropy_coeff": 0.1, "policy_entropy": -926.6997436523437, "policy_loss": -25630381781811.2, "vf_loss": 1108450803.2}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 4698.0, "diff_num_grad_updates_vs_sampler_policy": 4697.0}}, "num_env_steps_sampled": 338400, "num_env_steps_trained": 338400, "num_agent_steps_sampled": 338400, "num_agent_steps_trained": 338400}, "sampler_results": {"episode_reward_max": -25432.266347912846, "episode_reward_min": -26292.74912149601, "episode_reward_mean": -25730.489851419978, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-25585.13596090559, -25665.96732020764, -25656.675229452405, -25456.717753643752, -25562.242933916827, -25671.411627128025, -25864.70163439365, -25462.346071828535, -25554.082619155375, -25880.440581548897, -25614.01025244211, -25723.019301323944, -25767.108546182273, -25693.931776022073, -25934.307805282882, -25799.75016982112, -25767.052116667943, -25703.318308026996, -25738.33987263904, -25839.263566717633, -26058.03842804496, -25466.52483052838, -25723.79005705918, -25568.652334018734, -25658.751086979817, -25796.293306878513, -25637.135134172895, -25720.455000826445, -25745.1061000994, -25758.48543409182, -25494.397311504414, -25789.560259672373, -25831.446464554898, -26292.74912149601, -26025.814025900996, -25600.615904250113, -25567.710739410242, -25446.56237118809, -25880.78798693058, -25942.846714375417, -25594.024268471265, -25579.20574384092, -25661.59977255986, -25598.831299808346, -25899.70477172812, -25850.679229500052, -25544.127208032158, -25874.947030441388, -25476.042929746214, -25434.221900294273, -25831.365619237313, -25811.81453460429, -25673.72611278101, -25990.10945101598, -25561.52865470146, -25688.503926052967, -25778.21999850185, -25931.228199220746, -25487.820385521598, -25892.52578831003, -25926.288180379986, -25576.830954405363, -25858.329583932533, -25965.659916149998, -25643.231739001527, -25581.040627284485, -25727.808939913433, -26050.094496583788, -25627.41920535082, -25862.778591292834, -25535.63315259287, -25817.24449785403, -25554.02461551194, -25667.1435888165, -25572.30506324793, -25909.623666683325, -25906.30253132032, -25432.266347912846, -25732.81659573895, -25859.820025494166, -25874.874443001965, -25785.936296617514, -25857.281454639342, -25890.057598573258, -25633.77453180659, -25797.035561210163, -25799.212728336177, -25783.60662357148, -25755.748960656238, -25540.680275374503, -26117.861759431467, -25775.986904825855, -26110.922735090542, -25585.71357291799, -25532.626951785183, -25534.667293328057, -25751.624521587855, -25663.435791423737, -25523.25496939973, -25822.24696529293], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.583306909810364, "mean_inference_ms": 0.3011059956241706, "mean_action_processing_ms": 0.07206924389859294, "mean_env_wait_ms": 1.8303284300120501, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003559112548828125, "StateBufferConnector_ms": 0.0026865005493164062, "ViewRequirementAgentConnector_ms": 0.06714701652526855}}, "episode_reward_max": -25432.266347912846, "episode_reward_min": -26292.74912149601, "episode_reward_mean": -25730.489851419978, "episode_len_mean": 360.0, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-25585.13596090559, -25665.96732020764, -25656.675229452405, -25456.717753643752, -25562.242933916827, -25671.411627128025, -25864.70163439365, -25462.346071828535, -25554.082619155375, -25880.440581548897, -25614.01025244211, -25723.019301323944, -25767.108546182273, -25693.931776022073, -25934.307805282882, -25799.75016982112, -25767.052116667943, -25703.318308026996, -25738.33987263904, -25839.263566717633, -26058.03842804496, -25466.52483052838, -25723.79005705918, -25568.652334018734, -25658.751086979817, -25796.293306878513, -25637.135134172895, -25720.455000826445, -25745.1061000994, -25758.48543409182, -25494.397311504414, -25789.560259672373, -25831.446464554898, -26292.74912149601, -26025.814025900996, -25600.615904250113, -25567.710739410242, -25446.56237118809, -25880.78798693058, -25942.846714375417, -25594.024268471265, -25579.20574384092, -25661.59977255986, -25598.831299808346, -25899.70477172812, -25850.679229500052, -25544.127208032158, -25874.947030441388, -25476.042929746214, -25434.221900294273, -25831.365619237313, -25811.81453460429, -25673.72611278101, -25990.10945101598, -25561.52865470146, -25688.503926052967, -25778.21999850185, -25931.228199220746, -25487.820385521598, -25892.52578831003, -25926.288180379986, -25576.830954405363, -25858.329583932533, -25965.659916149998, -25643.231739001527, -25581.040627284485, -25727.808939913433, -26050.094496583788, -25627.41920535082, -25862.778591292834, -25535.63315259287, -25817.24449785403, -25554.02461551194, -25667.1435888165, -25572.30506324793, -25909.623666683325, -25906.30253132032, -25432.266347912846, -25732.81659573895, -25859.820025494166, -25874.874443001965, -25785.936296617514, -25857.281454639342, -25890.057598573258, -25633.77453180659, -25797.035561210163, -25799.212728336177, -25783.60662357148, -25755.748960656238, -25540.680275374503, -26117.861759431467, -25775.986904825855, -26110.922735090542, -25585.71357291799, -25532.626951785183, -25534.667293328057, -25751.624521587855, -25663.435791423737, -25523.25496939973, -25822.24696529293], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.583306909810364, "mean_inference_ms": 0.3011059956241706, "mean_action_processing_ms": 0.07206924389859294, "mean_env_wait_ms": 1.8303284300120501, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003559112548828125, "StateBufferConnector_ms": 0.0026865005493164062, "ViewRequirementAgentConnector_ms": 0.06714701652526855}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 338400, "num_agent_steps_trained": 338400, "num_env_steps_sampled": 338400, "num_env_steps_trained": 338400, "num_env_steps_sampled_this_iter": 1080, "num_env_steps_trained_this_iter": 1080, "num_env_steps_sampled_throughput_per_sec": 93.26014794972332, "num_env_steps_trained_throughput_per_sec": 93.26014794972332, "timesteps_total": 338400, "num_steps_trained_this_iter": 1080, "agent_timesteps_total": 338400, "timers": {"training_iteration_time_ms": 3798.886, "sample_time_ms": 3788.07, "load_time_ms": 0.297, "load_throughput": 1210477.345, "learn_time_ms": 9.767, "learn_throughput": 36859.141, "synch_weights_time_ms": 0.708}, "counters": {"num_env_steps_sampled": 338400, "num_env_steps_trained": 338400, "num_agent_steps_sampled": 338400, "num_agent_steps_trained": 338400}, "done": true, "episodes_total": 940, "training_iteration": 240, "trial_id": "f5e97_00000", "date": "2023-07-25_17-40-57", "timestamp": 1690296057, "time_this_iter_s": 11.583345890045166, "time_total_s": 2698.567045688629, "pid": 71917, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[0, 0.003], [5400, 0.001], [10800, 0.00075], [16200, 0.0005], [21600, 0.00025], [27000, 0.0001], [32400, 7.5e-05], [37800, 5e-05], [43200, 2.5e-05], [48600, 1e-05], [54000, 7.5e-06], [59400, 5e-06], [64800, 2.5e-06], [70200, 1e-06], [75600, 5e-07], [81000, 1e-07]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x304530310>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 2698.567045688629, "iterations_since_restore": 240, "perf": {"cpu_util_percent": 22.905882352941177, "ram_util_percent": 74.44705882352942}}
