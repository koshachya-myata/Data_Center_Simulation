{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 0.0026, "entropy_coeff": 0.10000000000000002, "policy_entropy": 87.3997786839803, "policy_loss": -1012070398.0833334, "vf_loss": 2488672021.3333335}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 120.0, "num_grad_updates_lifetime": 11.0, "diff_num_grad_updates_vs_sampler_policy": 10.0}}, "num_env_steps_sampled": 1440, "num_env_steps_trained": 1440, "num_agent_steps_sampled": 1440, "num_agent_steps_trained": 1440}, "sampler_results": {"episode_reward_max": -8444.236095312468, "episode_reward_min": -29874.66400259338, "episode_reward_mean": -18040.95065197065, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-8913.826131798241, -8444.236095312468, -24931.07637817849, -29874.66400259338], "episode_lengths": [360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.472005541005291, "mean_inference_ms": 0.26292423669204873, "mean_action_processing_ms": 0.06150570617294577, "mean_env_wait_ms": 3.0884507792762053, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002473592758178711, "StateBufferConnector_ms": 0.0019311904907226562, "ViewRequirementAgentConnector_ms": 0.0466465950012207}}, "episode_reward_max": -8444.236095312468, "episode_reward_min": -29874.66400259338, "episode_reward_mean": -18040.95065197065, "episode_len_mean": 360.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-8913.826131798241, -8444.236095312468, -24931.07637817849, -29874.66400259338], "episode_lengths": [360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.472005541005291, "mean_inference_ms": 0.26292423669204873, "mean_action_processing_ms": 0.06150570617294577, "mean_env_wait_ms": 3.0884507792762053, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002473592758178711, "StateBufferConnector_ms": 0.0019311904907226562, "ViewRequirementAgentConnector_ms": 0.0466465950012207}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1440, "num_agent_steps_trained": 1440, "num_env_steps_sampled": 1440, "num_env_steps_trained": 1440, "num_env_steps_sampled_this_iter": 1440, "num_env_steps_trained_this_iter": 1440, "num_env_steps_sampled_throughput_per_sec": 126.0395535379277, "num_env_steps_trained_throughput_per_sec": 126.0395535379277, "timesteps_total": 1440, "num_steps_trained_this_iter": 1440, "agent_timesteps_total": 1440, "timers": {"training_iteration_time_ms": 2856.233, "sample_time_ms": 2847.912, "load_time_ms": 0.292, "load_throughput": 1232108.886, "learn_time_ms": 7.361, "learn_throughput": 48906.037, "synch_weights_time_ms": 0.624}, "counters": {"num_env_steps_sampled": 1440, "num_env_steps_trained": 1440, "num_agent_steps_sampled": 1440, "num_agent_steps_trained": 1440}, "done": false, "episodes_total": 4, "training_iteration": 1, "trial_id": "4935e_00000", "date": "2023-07-25_15-46-49", "timestamp": 1690289209, "time_this_iter_s": 11.427093029022217, "time_total_s": 11.427093029022217, "pid": 67353, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[0, 0.003], [5400, 0.001], [10800, 0.00075], [16200, 0.0005], [21600, 0.00025], [27000, 0.0001], [32400, 7.5e-05], [37800, 5e-05], [43200, 2.5e-05], [48600, 1e-05], [54000, 7.5e-06], [59400, 5e-06], [64800, 2.5e-06], [70200, 1e-06], [75600, 5e-07], [81000, 1e-07]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x177531310>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 11.427093029022217, "iterations_since_restore": 1, "perf": {"cpu_util_percent": 40.44705882352941, "ram_util_percent": 80.78235294117647}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 0.0019333333333333331, "entropy_coeff": 0.10000000000000002, "policy_entropy": -1060.513936360677, "policy_loss": -6261965865353216.0, "vf_loss": 2468476693.3333335}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 120.0, "num_grad_updates_lifetime": 26.0, "diff_num_grad_updates_vs_sampler_policy": 25.0}}, "num_env_steps_sampled": 3240, "num_env_steps_trained": 3240, "num_agent_steps_sampled": 3240, "num_agent_steps_trained": 3240}, "sampler_results": {"episode_reward_max": -8444.236095312468, "episode_reward_min": -30134.70637972163, "episode_reward_mean": -24629.0782780262, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-8913.826131798241, -8444.236095312468, -24931.07637817849, -29874.66400259338, -30134.70637972163, -29762.082259138468, -29984.42375117467, -29884.054884107227, -29732.63462021125], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.458037782884695, "mean_inference_ms": 0.2587331929824594, "mean_action_processing_ms": 0.06070617418156835, "mean_env_wait_ms": 2.581712494084098, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0024822023179796007, "StateBufferConnector_ms": 0.001838472154405382, "ViewRequirementAgentConnector_ms": 0.045458475748697914}}, "episode_reward_max": -8444.236095312468, "episode_reward_min": -30134.70637972163, "episode_reward_mean": -24629.0782780262, "episode_len_mean": 360.0, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-8913.826131798241, -8444.236095312468, -24931.07637817849, -29874.66400259338, -30134.70637972163, -29762.082259138468, -29984.42375117467, -29884.054884107227, -29732.63462021125], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.458037782884695, "mean_inference_ms": 0.2587331929824594, "mean_action_processing_ms": 0.06070617418156835, "mean_env_wait_ms": 2.581712494084098, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0024822023179796007, "StateBufferConnector_ms": 0.001838472154405382, "ViewRequirementAgentConnector_ms": 0.045458475748697914}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 3240, "num_agent_steps_trained": 3240, "num_env_steps_sampled": 3240, "num_env_steps_trained": 3240, "num_env_steps_sampled_this_iter": 1800, "num_env_steps_trained_this_iter": 1800, "num_env_steps_sampled_throughput_per_sec": 160.86437560426037, "num_env_steps_trained_throughput_per_sec": 160.86437560426037, "timesteps_total": 3240, "num_steps_trained_this_iter": 1800, "agent_timesteps_total": 3240, "timers": {"training_iteration_time_ms": 2512.715, "sample_time_ms": 2505.938, "load_time_ms": 0.254, "load_throughput": 1417792.901, "learn_time_ms": 5.921, "learn_throughput": 60802.245, "synch_weights_time_ms": 0.565}, "counters": {"num_env_steps_sampled": 3240, "num_env_steps_trained": 3240, "num_agent_steps_sampled": 3240, "num_agent_steps_trained": 3240}, "done": false, "episodes_total": 9, "training_iteration": 2, "trial_id": "4935e_00000", "date": "2023-07-25_15-47-00", "timestamp": 1690289220, "time_this_iter_s": 11.191492080688477, "time_total_s": 22.618585109710693, "pid": 67353, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[0, 0.003], [5400, 0.001], [10800, 0.00075], [16200, 0.0005], [21600, 0.00025], [27000, 0.0001], [32400, 7.5e-05], [37800, 5e-05], [43200, 2.5e-05], [48600, 1e-05], [54000, 7.5e-06], [59400, 5e-06], [64800, 2.5e-06], [70200, 1e-06], [75600, 5e-07], [81000, 1e-07]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x177531310>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 22.618585109710693, "iterations_since_restore": 2, "perf": {"cpu_util_percent": 25.1875, "ram_util_percent": 79.95625000000001}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 0.0012666666666666666, "entropy_coeff": 0.10000000000000002, "policy_entropy": -1698.5247802734375, "policy_loss": -2.6228926848035918e+19, "vf_loss": 2530581952.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 120.0, "num_grad_updates_lifetime": 41.0, "diff_num_grad_updates_vs_sampler_policy": 40.0}}, "num_env_steps_sampled": 5040, "num_env_steps_trained": 5040, "num_agent_steps_sampled": 5040, "num_agent_steps_trained": 5040}, "sampler_results": {"episode_reward_max": -8444.236095312468, "episode_reward_min": -30134.70637972163, "episode_reward_mean": -26477.093902537716, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-8913.826131798241, -8444.236095312468, -24931.07637817849, -29874.66400259338, -30134.70637972163, -29762.082259138468, -29984.42375117467, -29884.054884107227, -29732.63462021125, -29734.74741394928, -29599.58056175506, -29832.797365967963, -29766.292425560343, -30084.192366059553], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.4503336622259395, "mean_inference_ms": 0.25695870587452335, "mean_action_processing_ms": 0.06035901944562013, "mean_env_wait_ms": 2.3468358674508054, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0025442668369838168, "StateBufferConnector_ms": 0.0017711094447544643, "ViewRequirementAgentConnector_ms": 0.04493849618094308}}, "episode_reward_max": -8444.236095312468, "episode_reward_min": -30134.70637972163, "episode_reward_mean": -26477.093902537716, "episode_len_mean": 360.0, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-8913.826131798241, -8444.236095312468, -24931.07637817849, -29874.66400259338, -30134.70637972163, -29762.082259138468, -29984.42375117467, -29884.054884107227, -29732.63462021125, -29734.74741394928, -29599.58056175506, -29832.797365967963, -29766.292425560343, -30084.192366059553], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.4503336622259395, "mean_inference_ms": 0.25695870587452335, "mean_action_processing_ms": 0.06035901944562013, "mean_env_wait_ms": 2.3468358674508054, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0025442668369838168, "StateBufferConnector_ms": 0.0017711094447544643, "ViewRequirementAgentConnector_ms": 0.04493849618094308}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 5040, "num_agent_steps_trained": 5040, "num_env_steps_sampled": 5040, "num_env_steps_trained": 5040, "num_env_steps_sampled_this_iter": 1800, "num_env_steps_trained_this_iter": 1800, "num_env_steps_sampled_throughput_per_sec": 160.4497742661738, "num_env_steps_trained_throughput_per_sec": 160.4497742661738, "timesteps_total": 5040, "num_steps_trained_this_iter": 1800, "agent_timesteps_total": 5040, "timers": {"training_iteration_time_ms": 2240.792, "sample_time_ms": 2235.317, "load_time_ms": 0.227, "load_throughput": 1587582.21, "learn_time_ms": 4.7, "learn_throughput": 76589.64, "synch_weights_time_ms": 0.516}, "counters": {"num_env_steps_sampled": 5040, "num_env_steps_trained": 5040, "num_agent_steps_sampled": 5040, "num_agent_steps_trained": 5040}, "done": false, "episodes_total": 14, "training_iteration": 3, "trial_id": "4935e_00000", "date": "2023-07-25_15-47-12", "timestamp": 1690289232, "time_this_iter_s": 11.220398902893066, "time_total_s": 33.83898401260376, "pid": 67353, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[0, 0.003], [5400, 0.001], [10800, 0.00075], [16200, 0.0005], [21600, 0.00025], [27000, 0.0001], [32400, 7.5e-05], [37800, 5e-05], [43200, 2.5e-05], [48600, 1e-05], [54000, 7.5e-06], [59400, 5e-06], [64800, 2.5e-06], [70200, 1e-06], [75600, 5e-07], [81000, 1e-07]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x177531310>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 33.83898401260376, "iterations_since_restore": 3, "perf": {"cpu_util_percent": 25.08125, "ram_util_percent": 79.5}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 0.00095, "entropy_coeff": 0.10000000000000002, "policy_entropy": -1825.8349202473958, "policy_loss": -6.523891976427799e+18, "vf_loss": 2479541205.3333335}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 120.0, "num_grad_updates_lifetime": 56.0, "diff_num_grad_updates_vs_sampler_policy": 55.0}}, "num_env_steps_sampled": 6840, "num_env_steps_trained": 6840, "num_agent_steps_sampled": 6840, "num_agent_steps_trained": 6840}, "sampler_results": {"episode_reward_max": -8444.236095312468, "episode_reward_min": -30134.70637972163, "episode_reward_mean": -27355.39289694945, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-8913.826131798241, -8444.236095312468, -24931.07637817849, -29874.66400259338, -30134.70637972163, -29762.082259138468, -29984.42375117467, -29884.054884107227, -29732.63462021125, -29734.74741394928, -29599.58056175506, -29832.797365967963, -29766.292425560343, -30084.192366059553, -29681.35111266077, -29821.739926135935, -29806.54303736546, -29871.84153731382, -29891.674793035487], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.444791986625331, "mean_inference_ms": 0.25574692935749027, "mean_action_processing_ms": 0.06012447443074269, "mean_env_wait_ms": 2.2036651070124234, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0025121789229543587, "StateBufferConnector_ms": 0.0017417104620682565, "ViewRequirementAgentConnector_ms": 0.045270668832879314}}, "episode_reward_max": -8444.236095312468, "episode_reward_min": -30134.70637972163, "episode_reward_mean": -27355.39289694945, "episode_len_mean": 360.0, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-8913.826131798241, -8444.236095312468, -24931.07637817849, -29874.66400259338, -30134.70637972163, -29762.082259138468, -29984.42375117467, -29884.054884107227, -29732.63462021125, -29734.74741394928, -29599.58056175506, -29832.797365967963, -29766.292425560343, -30084.192366059553, -29681.35111266077, -29821.739926135935, -29806.54303736546, -29871.84153731382, -29891.674793035487], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.444791986625331, "mean_inference_ms": 0.25574692935749027, "mean_action_processing_ms": 0.06012447443074269, "mean_env_wait_ms": 2.2036651070124234, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0025121789229543587, "StateBufferConnector_ms": 0.0017417104620682565, "ViewRequirementAgentConnector_ms": 0.045270668832879314}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 6840, "num_agent_steps_trained": 6840, "num_env_steps_sampled": 6840, "num_env_steps_trained": 6840, "num_env_steps_sampled_this_iter": 1800, "num_env_steps_trained_this_iter": 1800, "num_env_steps_sampled_throughput_per_sec": 160.93584835387597, "num_env_steps_trained_throughput_per_sec": 160.93584835387597, "timesteps_total": 6840, "num_steps_trained_this_iter": 1800, "agent_timesteps_total": 6840, "timers": {"training_iteration_time_ms": 2240.295, "sample_time_ms": 2234.92, "load_time_ms": 0.221, "load_throughput": 1629207.423, "learn_time_ms": 4.609, "learn_throughput": 78111.877, "synch_weights_time_ms": 0.514}, "counters": {"num_env_steps_sampled": 6840, "num_env_steps_trained": 6840, "num_agent_steps_sampled": 6840, "num_agent_steps_trained": 6840}, "done": false, "episodes_total": 19, "training_iteration": 4, "trial_id": "4935e_00000", "date": "2023-07-25_15-47-23", "timestamp": 1690289243, "time_this_iter_s": 11.186527967453003, "time_total_s": 45.02551198005676, "pid": 67353, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[0, 0.003], [5400, 0.001], [10800, 0.00075], [16200, 0.0005], [21600, 0.00025], [27000, 0.0001], [32400, 7.5e-05], [37800, 5e-05], [43200, 2.5e-05], [48600, 1e-05], [54000, 7.5e-06], [59400, 5e-06], [64800, 2.5e-06], [70200, 1e-06], [75600, 5e-07], [81000, 1e-07]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x177531310>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 45.02551198005676, "iterations_since_restore": 4, "perf": {"cpu_util_percent": 24.63125, "ram_util_percent": 78.7375}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 0.0008666666666666666, "entropy_coeff": 0.10000000000000002, "policy_entropy": -1851.2878011067708, "policy_loss": -2.0681866861528568e+18, "vf_loss": 2467238037.3333335}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 120.0, "num_grad_updates_lifetime": 71.0, "diff_num_grad_updates_vs_sampler_policy": 70.0}}, "num_env_steps_sampled": 8640, "num_env_steps_trained": 8640, "num_agent_steps_sampled": 8640, "num_agent_steps_trained": 8640}, "sampler_results": {"episode_reward_max": -8444.236095312468, "episode_reward_min": -30134.70637972163, "episode_reward_mean": -27885.048045108153, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-8913.826131798241, -8444.236095312468, -24931.07637817849, -29874.66400259338, -30134.70637972163, -29762.082259138468, -29984.42375117467, -29884.054884107227, -29732.63462021125, -29734.74741394928, -29599.58056175506, -29832.797365967963, -29766.292425560343, -30084.192366059553, -29681.35111266077, -29821.739926135935, -29806.54303736546, -29871.84153731382, -29891.674793035487, -29892.823880389962, -29875.158047759254, -29994.204920873275, -29981.235816298202, -29745.265375235438], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.44060026166727, "mean_inference_ms": 0.2549252526302396, "mean_action_processing_ms": 0.05996343648868463, "mean_env_wait_ms": 2.105189267141061, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0025033950805664062, "StateBufferConnector_ms": 0.0017454226811726887, "ViewRequirementAgentConnector_ms": 0.044883290926615395}}, "episode_reward_max": -8444.236095312468, "episode_reward_min": -30134.70637972163, "episode_reward_mean": -27885.048045108153, "episode_len_mean": 360.0, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-8913.826131798241, -8444.236095312468, -24931.07637817849, -29874.66400259338, -30134.70637972163, -29762.082259138468, -29984.42375117467, -29884.054884107227, -29732.63462021125, -29734.74741394928, -29599.58056175506, -29832.797365967963, -29766.292425560343, -30084.192366059553, -29681.35111266077, -29821.739926135935, -29806.54303736546, -29871.84153731382, -29891.674793035487, -29892.823880389962, -29875.158047759254, -29994.204920873275, -29981.235816298202, -29745.265375235438], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.44060026166727, "mean_inference_ms": 0.2549252526302396, "mean_action_processing_ms": 0.05996343648868463, "mean_env_wait_ms": 2.105189267141061, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0025033950805664062, "StateBufferConnector_ms": 0.0017454226811726887, "ViewRequirementAgentConnector_ms": 0.044883290926615395}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 8640, "num_agent_steps_trained": 8640, "num_env_steps_sampled": 8640, "num_env_steps_trained": 8640, "num_env_steps_sampled_this_iter": 1800, "num_env_steps_trained_this_iter": 1800, "num_env_steps_sampled_throughput_per_sec": 161.06558242646108, "num_env_steps_trained_throughput_per_sec": 161.06558242646108, "timesteps_total": 8640, "num_steps_trained_this_iter": 1800, "agent_timesteps_total": 8640, "timers": {"training_iteration_time_ms": 2236.006, "sample_time_ms": 2230.624, "load_time_ms": 0.217, "load_throughput": 1662207.662, "learn_time_ms": 4.618, "learn_throughput": 77961.846, "synch_weights_time_ms": 0.516}, "counters": {"num_env_steps_sampled": 8640, "num_env_steps_trained": 8640, "num_agent_steps_sampled": 8640, "num_agent_steps_trained": 8640}, "done": false, "episodes_total": 24, "training_iteration": 5, "trial_id": "4935e_00000", "date": "2023-07-25_15-47-34", "timestamp": 1690289254, "time_this_iter_s": 11.17766284942627, "time_total_s": 56.20317482948303, "pid": 67353, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[0, 0.003], [5400, 0.001], [10800, 0.00075], [16200, 0.0005], [21600, 0.00025], [27000, 0.0001], [32400, 7.5e-05], [37800, 5e-05], [43200, 2.5e-05], [48600, 1e-05], [54000, 7.5e-06], [59400, 5e-06], [64800, 2.5e-06], [70200, 1e-06], [75600, 5e-07], [81000, 1e-07]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x177531310>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 56.20317482948303, "iterations_since_restore": 5, "perf": {"cpu_util_percent": 22.993333333333336, "ram_util_percent": 78.96000000000001}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 0.0007833333333333334, "entropy_coeff": 0.10000000000000002, "policy_entropy": -1856.6233723958333, "policy_loss": -2.0177892256284884e+18, "vf_loss": 2484654720.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 120.0, "num_grad_updates_lifetime": 86.0, "diff_num_grad_updates_vs_sampler_policy": 85.0}}, "num_env_steps_sampled": 10440, "num_env_steps_trained": 10440, "num_agent_steps_sampled": 10440, "num_agent_steps_trained": 10440}, "sampler_results": {"episode_reward_max": -8444.236095312468, "episode_reward_min": -30134.70637972163, "episode_reward_mean": -28231.573823066665, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-8913.826131798241, -8444.236095312468, -24931.07637817849, -29874.66400259338, -30134.70637972163, -29762.082259138468, -29984.42375117467, -29884.054884107227, -29732.63462021125, -29734.74741394928, -29599.58056175506, -29832.797365967963, -29766.292425560343, -30084.192366059553, -29681.35111266077, -29821.739926135935, -29806.54303736546, -29871.84153731382, -29891.674793035487, -29892.823880389962, -29875.158047759254, -29994.204920873275, -29981.235816298202, -29745.265375235438, -29826.982526647404, -29962.08693607791, -29971.522223064138, -29866.98890678254, -29846.907193765634], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.437904424779176, "mean_inference_ms": 0.2542721200038547, "mean_action_processing_ms": 0.059835319375014656, "mean_env_wait_ms": 2.032318031879202, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002545323865167026, "StateBufferConnector_ms": 0.0017560761550377156, "ViewRequirementAgentConnector_ms": 0.045036447459253774}}, "episode_reward_max": -8444.236095312468, "episode_reward_min": -30134.70637972163, "episode_reward_mean": -28231.573823066665, "episode_len_mean": 360.0, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-8913.826131798241, -8444.236095312468, -24931.07637817849, -29874.66400259338, -30134.70637972163, -29762.082259138468, -29984.42375117467, -29884.054884107227, -29732.63462021125, -29734.74741394928, -29599.58056175506, -29832.797365967963, -29766.292425560343, -30084.192366059553, -29681.35111266077, -29821.739926135935, -29806.54303736546, -29871.84153731382, -29891.674793035487, -29892.823880389962, -29875.158047759254, -29994.204920873275, -29981.235816298202, -29745.265375235438, -29826.982526647404, -29962.08693607791, -29971.522223064138, -29866.98890678254, -29846.907193765634], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.437904424779176, "mean_inference_ms": 0.2542721200038547, "mean_action_processing_ms": 0.059835319375014656, "mean_env_wait_ms": 2.032318031879202, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002545323865167026, "StateBufferConnector_ms": 0.0017560761550377156, "ViewRequirementAgentConnector_ms": 0.045036447459253774}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 10440, "num_agent_steps_trained": 10440, "num_env_steps_sampled": 10440, "num_env_steps_trained": 10440, "num_env_steps_sampled_this_iter": 1800, "num_env_steps_trained_this_iter": 1800, "num_env_steps_sampled_throughput_per_sec": 160.82857566594527, "num_env_steps_trained_throughput_per_sec": 160.82857566594527, "timesteps_total": 10440, "num_steps_trained_this_iter": 1800, "agent_timesteps_total": 10440, "timers": {"training_iteration_time_ms": 2236.752, "sample_time_ms": 2231.263, "load_time_ms": 0.216, "load_throughput": 1665507.876, "learn_time_ms": 4.717, "learn_throughput": 76320.204, "synch_weights_time_ms": 0.523}, "counters": {"num_env_steps_sampled": 10440, "num_env_steps_trained": 10440, "num_agent_steps_sampled": 10440, "num_agent_steps_trained": 10440}, "done": false, "episodes_total": 29, "training_iteration": 6, "trial_id": "4935e_00000", "date": "2023-07-25_15-47-45", "timestamp": 1690289265, "time_this_iter_s": 11.193979978561401, "time_total_s": 67.39715480804443, "pid": 67353, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[0, 0.003], [5400, 0.001], [10800, 0.00075], [16200, 0.0005], [21600, 0.00025], [27000, 0.0001], [32400, 7.5e-05], [37800, 5e-05], [43200, 2.5e-05], [48600, 1e-05], [54000, 7.5e-06], [59400, 5e-06], [64800, 2.5e-06], [70200, 1e-06], [75600, 5e-07], [81000, 1e-07]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x177531310>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 67.39715480804443, "iterations_since_restore": 6, "perf": {"cpu_util_percent": 25.025, "ram_util_percent": 78.825}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 0.0007, "entropy_coeff": 0.10000000000000002, "policy_entropy": -1857.7109781901042, "policy_loss": -2.7782283908112454e+19, "vf_loss": 2445759232.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 120.0, "num_grad_updates_lifetime": 101.0, "diff_num_grad_updates_vs_sampler_policy": 100.0}}, "num_env_steps_sampled": 12240, "num_env_steps_trained": 12240, "num_agent_steps_sampled": 12240, "num_agent_steps_trained": 12240}, "sampler_results": {"episode_reward_max": -8444.236095312468, "episode_reward_min": -30134.70637972163, "episode_reward_mean": -28470.614626887742, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-8913.826131798241, -8444.236095312468, -24931.07637817849, -29874.66400259338, -30134.70637972163, -29762.082259138468, -29984.42375117467, -29884.054884107227, -29732.63462021125, -29734.74741394928, -29599.58056175506, -29832.797365967963, -29766.292425560343, -30084.192366059553, -29681.35111266077, -29821.739926135935, -29806.54303736546, -29871.84153731382, -29891.674793035487, -29892.823880389962, -29875.158047759254, -29994.204920873275, -29981.235816298202, -29745.265375235438, -29826.982526647404, -29962.08693607791, -29971.522223064138, -29866.98890678254, -29846.907193765634, -29951.164493724882, -29817.127153326233, -29832.47065890343, -30013.566140807965, -29670.92799848734], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.437036211885779, "mean_inference_ms": 0.25375951257838797, "mean_action_processing_ms": 0.05973705935807812, "mean_env_wait_ms": 1.9759860378149714, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0024956815383013558, "StateBufferConnector_ms": 0.0017600900986615348, "ViewRequirementAgentConnector_ms": 0.044950316934024584}}, "episode_reward_max": -8444.236095312468, "episode_reward_min": -30134.70637972163, "episode_reward_mean": -28470.614626887742, "episode_len_mean": 360.0, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-8913.826131798241, -8444.236095312468, -24931.07637817849, -29874.66400259338, -30134.70637972163, -29762.082259138468, -29984.42375117467, -29884.054884107227, -29732.63462021125, -29734.74741394928, -29599.58056175506, -29832.797365967963, -29766.292425560343, -30084.192366059553, -29681.35111266077, -29821.739926135935, -29806.54303736546, -29871.84153731382, -29891.674793035487, -29892.823880389962, -29875.158047759254, -29994.204920873275, -29981.235816298202, -29745.265375235438, -29826.982526647404, -29962.08693607791, -29971.522223064138, -29866.98890678254, -29846.907193765634, -29951.164493724882, -29817.127153326233, -29832.47065890343, -30013.566140807965, -29670.92799848734], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.437036211885779, "mean_inference_ms": 0.25375951257838797, "mean_action_processing_ms": 0.05973705935807812, "mean_env_wait_ms": 1.9759860378149714, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0024956815383013558, "StateBufferConnector_ms": 0.0017600900986615348, "ViewRequirementAgentConnector_ms": 0.044950316934024584}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 12240, "num_agent_steps_trained": 12240, "num_env_steps_sampled": 12240, "num_env_steps_trained": 12240, "num_env_steps_sampled_this_iter": 1800, "num_env_steps_trained_this_iter": 1800, "num_env_steps_sampled_throughput_per_sec": 159.45295708863196, "num_env_steps_trained_throughput_per_sec": 159.45295708863196, "timesteps_total": 12240, "num_steps_trained_this_iter": 1800, "agent_timesteps_total": 12240, "timers": {"training_iteration_time_ms": 2248.054, "sample_time_ms": 2242.588, "load_time_ms": 0.212, "load_throughput": 1700585.021, "learn_time_ms": 4.691, "learn_throughput": 76745.351, "synch_weights_time_ms": 0.531}, "counters": {"num_env_steps_sampled": 12240, "num_env_steps_trained": 12240, "num_agent_steps_sampled": 12240, "num_agent_steps_trained": 12240}, "done": false, "episodes_total": 34, "training_iteration": 7, "trial_id": "4935e_00000", "date": "2023-07-25_15-47-57", "timestamp": 1690289277, "time_this_iter_s": 11.290503978729248, "time_total_s": 78.68765878677368, "pid": 67353, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[0, 0.003], [5400, 0.001], [10800, 0.00075], [16200, 0.0005], [21600, 0.00025], [27000, 0.0001], [32400, 7.5e-05], [37800, 5e-05], [43200, 2.5e-05], [48600, 1e-05], [54000, 7.5e-06], [59400, 5e-06], [64800, 2.5e-06], [70200, 1e-06], [75600, 5e-07], [81000, 1e-07]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x177531310>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 78.68765878677368, "iterations_since_restore": 7, "perf": {"cpu_util_percent": 28.60625, "ram_util_percent": 79.075}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 0.0006166666666666666, "entropy_coeff": 0.10000000000000002, "policy_entropy": -1857.9293212890625, "policy_loss": -9.35762040908261e+18, "vf_loss": 2466093376.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 120.0, "num_grad_updates_lifetime": 116.0, "diff_num_grad_updates_vs_sampler_policy": 115.0}}, "num_env_steps_sampled": 14040, "num_env_steps_trained": 14040, "num_agent_steps_sampled": 14040, "num_agent_steps_trained": 14040}, "sampler_results": {"episode_reward_max": -8444.236095312468, "episode_reward_min": -30134.70637972163, "episode_reward_mean": -28656.44175721637, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-8913.826131798241, -8444.236095312468, -24931.07637817849, -29874.66400259338, -30134.70637972163, -29762.082259138468, -29984.42375117467, -29884.054884107227, -29732.63462021125, -29734.74741394928, -29599.58056175506, -29832.797365967963, -29766.292425560343, -30084.192366059553, -29681.35111266077, -29821.739926135935, -29806.54303736546, -29871.84153731382, -29891.674793035487, -29892.823880389962, -29875.158047759254, -29994.204920873275, -29981.235816298202, -29745.265375235438, -29826.982526647404, -29962.08693607791, -29971.522223064138, -29866.98890678254, -29846.907193765634, -29951.164493724882, -29817.127153326233, -29832.47065890343, -30013.566140807965, -29670.92799848734, -30105.278329191522, -29856.88333937987, -29919.502939343452, -29953.62872535819, -29765.037883982135], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.437210566302154, "mean_inference_ms": 0.25331134346253803, "mean_action_processing_ms": 0.059655227584607874, "mean_env_wait_ms": 1.9307068811067876, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002466103969476162, "StateBufferConnector_ms": 0.0017630748259715545, "ViewRequirementAgentConnector_ms": 0.04506844740647536}}, "episode_reward_max": -8444.236095312468, "episode_reward_min": -30134.70637972163, "episode_reward_mean": -28656.44175721637, "episode_len_mean": 360.0, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-8913.826131798241, -8444.236095312468, -24931.07637817849, -29874.66400259338, -30134.70637972163, -29762.082259138468, -29984.42375117467, -29884.054884107227, -29732.63462021125, -29734.74741394928, -29599.58056175506, -29832.797365967963, -29766.292425560343, -30084.192366059553, -29681.35111266077, -29821.739926135935, -29806.54303736546, -29871.84153731382, -29891.674793035487, -29892.823880389962, -29875.158047759254, -29994.204920873275, -29981.235816298202, -29745.265375235438, -29826.982526647404, -29962.08693607791, -29971.522223064138, -29866.98890678254, -29846.907193765634, -29951.164493724882, -29817.127153326233, -29832.47065890343, -30013.566140807965, -29670.92799848734, -30105.278329191522, -29856.88333937987, -29919.502939343452, -29953.62872535819, -29765.037883982135], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.437210566302154, "mean_inference_ms": 0.25331134346253803, "mean_action_processing_ms": 0.059655227584607874, "mean_env_wait_ms": 1.9307068811067876, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002466103969476162, "StateBufferConnector_ms": 0.0017630748259715545, "ViewRequirementAgentConnector_ms": 0.04506844740647536}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 14040, "num_agent_steps_trained": 14040, "num_env_steps_sampled": 14040, "num_env_steps_trained": 14040, "num_env_steps_sampled_this_iter": 1800, "num_env_steps_trained_this_iter": 1800, "num_env_steps_sampled_throughput_per_sec": 159.6298122018179, "num_env_steps_trained_throughput_per_sec": 159.6298122018179, "timesteps_total": 14040, "num_steps_trained_this_iter": 1800, "agent_timesteps_total": 14040, "timers": {"training_iteration_time_ms": 2256.458, "sample_time_ms": 2251.066, "load_time_ms": 0.213, "load_throughput": 1694097.88, "learn_time_ms": 4.626, "learn_throughput": 77819.609, "synch_weights_time_ms": 0.521}, "counters": {"num_env_steps_sampled": 14040, "num_env_steps_trained": 14040, "num_agent_steps_sampled": 14040, "num_agent_steps_trained": 14040}, "done": false, "episodes_total": 39, "training_iteration": 8, "trial_id": "4935e_00000", "date": "2023-07-25_15-48-08", "timestamp": 1690289288, "time_this_iter_s": 11.277965068817139, "time_total_s": 89.96562385559082, "pid": 67353, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[0, 0.003], [5400, 0.001], [10800, 0.00075], [16200, 0.0005], [21600, 0.00025], [27000, 0.0001], [32400, 7.5e-05], [37800, 5e-05], [43200, 2.5e-05], [48600, 1e-05], [54000, 7.5e-06], [59400, 5e-06], [64800, 2.5e-06], [70200, 1e-06], [75600, 5e-07], [81000, 1e-07]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x177531310>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 89.96562385559082, "iterations_since_restore": 8, "perf": {"cpu_util_percent": 37.01764705882353, "ram_util_percent": 79.15882352941176}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 0.0005333333333333334, "entropy_coeff": 0.10000000000000002, "policy_entropy": -1857.9710286458333, "policy_loss": -3.1878494731211464e+18, "vf_loss": 2523399381.3333335}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 120.0, "num_grad_updates_lifetime": 131.0, "diff_num_grad_updates_vs_sampler_policy": 130.0}}, "num_env_steps_sampled": 15840, "num_env_steps_trained": 15840, "num_agent_steps_sampled": 15840, "num_agent_steps_trained": 15840}, "sampler_results": {"episode_reward_max": -8444.236095312468, "episode_reward_min": -30145.7689349501, "episode_reward_mean": -28800.549281952346, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-8913.826131798241, -8444.236095312468, -24931.07637817849, -29874.66400259338, -30134.70637972163, -29762.082259138468, -29984.42375117467, -29884.054884107227, -29732.63462021125, -29734.74741394928, -29599.58056175506, -29832.797365967963, -29766.292425560343, -30084.192366059553, -29681.35111266077, -29821.739926135935, -29806.54303736546, -29871.84153731382, -29891.674793035487, -29892.823880389962, -29875.158047759254, -29994.204920873275, -29981.235816298202, -29745.265375235438, -29826.982526647404, -29962.08693607791, -29971.522223064138, -29866.98890678254, -29846.907193765634, -29951.164493724882, -29817.127153326233, -29832.47065890343, -30013.566140807965, -29670.92799848734, -30105.278329191522, -29856.88333937987, -29919.502939343452, -29953.62872535819, -29765.037883982135, -29902.414857735148, -30145.7689349501, -29804.63900864462, -29751.998564301775, -30018.118508833555], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.437277477324404, "mean_inference_ms": 0.2529661847834243, "mean_action_processing_ms": 0.05959111863074609, "mean_env_wait_ms": 1.8935097854947047, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0025640834461558948, "StateBufferConnector_ms": 0.0017567114396528764, "ViewRequirementAgentConnector_ms": 0.04500692540949041}}, "episode_reward_max": -8444.236095312468, "episode_reward_min": -30145.7689349501, "episode_reward_mean": -28800.549281952346, "episode_len_mean": 360.0, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-8913.826131798241, -8444.236095312468, -24931.07637817849, -29874.66400259338, -30134.70637972163, -29762.082259138468, -29984.42375117467, -29884.054884107227, -29732.63462021125, -29734.74741394928, -29599.58056175506, -29832.797365967963, -29766.292425560343, -30084.192366059553, -29681.35111266077, -29821.739926135935, -29806.54303736546, -29871.84153731382, -29891.674793035487, -29892.823880389962, -29875.158047759254, -29994.204920873275, -29981.235816298202, -29745.265375235438, -29826.982526647404, -29962.08693607791, -29971.522223064138, -29866.98890678254, -29846.907193765634, -29951.164493724882, -29817.127153326233, -29832.47065890343, -30013.566140807965, -29670.92799848734, -30105.278329191522, -29856.88333937987, -29919.502939343452, -29953.62872535819, -29765.037883982135, -29902.414857735148, -30145.7689349501, -29804.63900864462, -29751.998564301775, -30018.118508833555], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.437277477324404, "mean_inference_ms": 0.2529661847834243, "mean_action_processing_ms": 0.05959111863074609, "mean_env_wait_ms": 1.8935097854947047, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0025640834461558948, "StateBufferConnector_ms": 0.0017567114396528764, "ViewRequirementAgentConnector_ms": 0.04500692540949041}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 15840, "num_agent_steps_trained": 15840, "num_env_steps_sampled": 15840, "num_env_steps_trained": 15840, "num_env_steps_sampled_this_iter": 1800, "num_env_steps_trained_this_iter": 1800, "num_env_steps_sampled_throughput_per_sec": 160.50944981598624, "num_env_steps_trained_throughput_per_sec": 160.50944981598624, "timesteps_total": 15840, "num_steps_trained_this_iter": 1800, "agent_timesteps_total": 15840, "timers": {"training_iteration_time_ms": 2249.026, "sample_time_ms": 2243.495, "load_time_ms": 0.217, "load_throughput": 1661658.897, "learn_time_ms": 4.706, "learn_throughput": 76505.431, "synch_weights_time_ms": 0.574}, "counters": {"num_env_steps_sampled": 15840, "num_env_steps_trained": 15840, "num_agent_steps_sampled": 15840, "num_agent_steps_trained": 15840}, "done": false, "episodes_total": 44, "training_iteration": 9, "trial_id": "4935e_00000", "date": "2023-07-25_15-48-19", "timestamp": 1690289299, "time_this_iter_s": 11.216220140457153, "time_total_s": 101.18184399604797, "pid": 67353, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[0, 0.003], [5400, 0.001], [10800, 0.00075], [16200, 0.0005], [21600, 0.00025], [27000, 0.0001], [32400, 7.5e-05], [37800, 5e-05], [43200, 2.5e-05], [48600, 1e-05], [54000, 7.5e-06], [59400, 5e-06], [64800, 2.5e-06], [70200, 1e-06], [75600, 5e-07], [81000, 1e-07]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x177531310>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 101.18184399604797, "iterations_since_restore": 9, "perf": {"cpu_util_percent": 27.720000000000002, "ram_util_percent": 79.48000000000002}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 0.00045000000000000004, "entropy_coeff": 0.10000000000000002, "policy_entropy": -1857.9805094401042, "policy_loss": -3.4215198565961457e+18, "vf_loss": 2507214976.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 120.0, "num_grad_updates_lifetime": 146.0, "diff_num_grad_updates_vs_sampler_policy": 145.0}}, "num_env_steps_sampled": 17640, "num_env_steps_trained": 17640, "num_agent_steps_sampled": 17640, "num_agent_steps_trained": 17640}, "sampler_results": {"episode_reward_max": -8444.236095312468, "episode_reward_min": -30145.7689349501, "episode_reward_mean": -28906.712497968456, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-8913.826131798241, -8444.236095312468, -24931.07637817849, -29874.66400259338, -30134.70637972163, -29762.082259138468, -29984.42375117467, -29884.054884107227, -29732.63462021125, -29734.74741394928, -29599.58056175506, -29832.797365967963, -29766.292425560343, -30084.192366059553, -29681.35111266077, -29821.739926135935, -29806.54303736546, -29871.84153731382, -29891.674793035487, -29892.823880389962, -29875.158047759254, -29994.204920873275, -29981.235816298202, -29745.265375235438, -29826.982526647404, -29962.08693607791, -29971.522223064138, -29866.98890678254, -29846.907193765634, -29951.164493724882, -29817.127153326233, -29832.47065890343, -30013.566140807965, -29670.92799848734, -30105.278329191522, -29856.88333937987, -29919.502939343452, -29953.62872535819, -29765.037883982135, -29902.414857735148, -30145.7689349501, -29804.63900864462, -29751.998564301775, -30018.118508833555, -29713.869352751786, -29887.37659015742, -29734.729943288814, -29826.223158529236, -30042.544949823463], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.436931419905333, "mean_inference_ms": 0.252670916872565, "mean_action_processing_ms": 0.05953581572598367, "mean_env_wait_ms": 1.8625801100456176, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002558863892847178, "StateBufferConnector_ms": 0.0017623512112364477, "ViewRequirementAgentConnector_ms": 0.044996884404396524}}, "episode_reward_max": -8444.236095312468, "episode_reward_min": -30145.7689349501, "episode_reward_mean": -28906.712497968456, "episode_len_mean": 360.0, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-8913.826131798241, -8444.236095312468, -24931.07637817849, -29874.66400259338, -30134.70637972163, -29762.082259138468, -29984.42375117467, -29884.054884107227, -29732.63462021125, -29734.74741394928, -29599.58056175506, -29832.797365967963, -29766.292425560343, -30084.192366059553, -29681.35111266077, -29821.739926135935, -29806.54303736546, -29871.84153731382, -29891.674793035487, -29892.823880389962, -29875.158047759254, -29994.204920873275, -29981.235816298202, -29745.265375235438, -29826.982526647404, -29962.08693607791, -29971.522223064138, -29866.98890678254, -29846.907193765634, -29951.164493724882, -29817.127153326233, -29832.47065890343, -30013.566140807965, -29670.92799848734, -30105.278329191522, -29856.88333937987, -29919.502939343452, -29953.62872535819, -29765.037883982135, -29902.414857735148, -30145.7689349501, -29804.63900864462, -29751.998564301775, -30018.118508833555, -29713.869352751786, -29887.37659015742, -29734.729943288814, -29826.223158529236, -30042.544949823463], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.436931419905333, "mean_inference_ms": 0.252670916872565, "mean_action_processing_ms": 0.05953581572598367, "mean_env_wait_ms": 1.8625801100456176, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002558863892847178, "StateBufferConnector_ms": 0.0017623512112364477, "ViewRequirementAgentConnector_ms": 0.044996884404396524}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 17640, "num_agent_steps_trained": 17640, "num_env_steps_sampled": 17640, "num_env_steps_trained": 17640, "num_env_steps_sampled_this_iter": 1800, "num_env_steps_trained_this_iter": 1800, "num_env_steps_sampled_throughput_per_sec": 160.83676777488472, "num_env_steps_trained_throughput_per_sec": 160.83676777488472, "timesteps_total": 17640, "num_steps_trained_this_iter": 1800, "agent_timesteps_total": 17640, "timers": {"training_iteration_time_ms": 2240.566, "sample_time_ms": 2235.056, "load_time_ms": 0.217, "load_throughput": 1655283.315, "learn_time_ms": 4.687, "learn_throughput": 76807.813, "synch_weights_time_ms": 0.572}, "counters": {"num_env_steps_sampled": 17640, "num_env_steps_trained": 17640, "num_agent_steps_sampled": 17640, "num_agent_steps_trained": 17640}, "done": false, "episodes_total": 49, "training_iteration": 10, "trial_id": "4935e_00000", "date": "2023-07-25_15-48-30", "timestamp": 1690289310, "time_this_iter_s": 11.193476915359497, "time_total_s": 112.37532091140747, "pid": 67353, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[0, 0.003], [5400, 0.001], [10800, 0.00075], [16200, 0.0005], [21600, 0.00025], [27000, 0.0001], [32400, 7.5e-05], [37800, 5e-05], [43200, 2.5e-05], [48600, 1e-05], [54000, 7.5e-06], [59400, 5e-06], [64800, 2.5e-06], [70200, 1e-06], [75600, 5e-07], [81000, 1e-07]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x177531310>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 112.37532091140747, "iterations_since_restore": 10, "perf": {"cpu_util_percent": 23.46875, "ram_util_percent": 79.28125}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 0.00036666666666666667, "entropy_coeff": 0.10000000000000002, "policy_entropy": -1857.9839680989583, "policy_loss": -1.4116973856518075e+17, "vf_loss": 2480138368.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 120.0, "num_grad_updates_lifetime": 161.0, "diff_num_grad_updates_vs_sampler_policy": 160.0}}, "num_env_steps_sampled": 19440, "num_env_steps_trained": 19440, "num_agent_steps_sampled": 19440, "num_agent_steps_trained": 19440}, "sampler_results": {"episode_reward_max": -8444.236095312468, "episode_reward_min": -30145.7689349501, "episode_reward_mean": -28997.591453463934, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-8913.826131798241, -8444.236095312468, -24931.07637817849, -29874.66400259338, -30134.70637972163, -29762.082259138468, -29984.42375117467, -29884.054884107227, -29732.63462021125, -29734.74741394928, -29599.58056175506, -29832.797365967963, -29766.292425560343, -30084.192366059553, -29681.35111266077, -29821.739926135935, -29806.54303736546, -29871.84153731382, -29891.674793035487, -29892.823880389962, -29875.158047759254, -29994.204920873275, -29981.235816298202, -29745.265375235438, -29826.982526647404, -29962.08693607791, -29971.522223064138, -29866.98890678254, -29846.907193765634, -29951.164493724882, -29817.127153326233, -29832.47065890343, -30013.566140807965, -29670.92799848734, -30105.278329191522, -29856.88333937987, -29919.502939343452, -29953.62872535819, -29765.037883982135, -29902.414857735148, -30145.7689349501, -29804.63900864462, -29751.998564301775, -30018.118508833555, -29713.869352751786, -29887.37659015742, -29734.729943288814, -29826.223158529236, -30042.544949823463, -30039.39342858763, -29770.50066907107, -29719.259510635333, -30009.326254365078, -29902.54622393914], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.436484689753585, "mean_inference_ms": 0.25242579903400636, "mean_action_processing_ms": 0.05948875880040951, "mean_env_wait_ms": 1.8362564346823385, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002551961828161169, "StateBufferConnector_ms": 0.0017642974853515625, "ViewRequirementAgentConnector_ms": 0.04513925976223416}}, "episode_reward_max": -8444.236095312468, "episode_reward_min": -30145.7689349501, "episode_reward_mean": -28997.591453463934, "episode_len_mean": 360.0, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-8913.826131798241, -8444.236095312468, -24931.07637817849, -29874.66400259338, -30134.70637972163, -29762.082259138468, -29984.42375117467, -29884.054884107227, -29732.63462021125, -29734.74741394928, -29599.58056175506, -29832.797365967963, -29766.292425560343, -30084.192366059553, -29681.35111266077, -29821.739926135935, -29806.54303736546, -29871.84153731382, -29891.674793035487, -29892.823880389962, -29875.158047759254, -29994.204920873275, -29981.235816298202, -29745.265375235438, -29826.982526647404, -29962.08693607791, -29971.522223064138, -29866.98890678254, -29846.907193765634, -29951.164493724882, -29817.127153326233, -29832.47065890343, -30013.566140807965, -29670.92799848734, -30105.278329191522, -29856.88333937987, -29919.502939343452, -29953.62872535819, -29765.037883982135, -29902.414857735148, -30145.7689349501, -29804.63900864462, -29751.998564301775, -30018.118508833555, -29713.869352751786, -29887.37659015742, -29734.729943288814, -29826.223158529236, -30042.544949823463, -30039.39342858763, -29770.50066907107, -29719.259510635333, -30009.326254365078, -29902.54622393914], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.436484689753585, "mean_inference_ms": 0.25242579903400636, "mean_action_processing_ms": 0.05948875880040951, "mean_env_wait_ms": 1.8362564346823385, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002551961828161169, "StateBufferConnector_ms": 0.0017642974853515625, "ViewRequirementAgentConnector_ms": 0.04513925976223416}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 19440, "num_agent_steps_trained": 19440, "num_env_steps_sampled": 19440, "num_env_steps_trained": 19440, "num_env_steps_sampled_this_iter": 1800, "num_env_steps_trained_this_iter": 1800, "num_env_steps_sampled_throughput_per_sec": 160.84633828400143, "num_env_steps_trained_throughput_per_sec": 160.84633828400143, "timesteps_total": 19440, "num_steps_trained_this_iter": 1800, "agent_timesteps_total": 19440, "timers": {"training_iteration_time_ms": 2238.218, "sample_time_ms": 2232.823, "load_time_ms": 0.214, "load_throughput": 1681645.439, "learn_time_ms": 4.624, "learn_throughput": 77857.328, "synch_weights_time_ms": 0.525}, "counters": {"num_env_steps_sampled": 19440, "num_env_steps_trained": 19440, "num_agent_steps_sampled": 19440, "num_agent_steps_trained": 19440}, "done": false, "episodes_total": 54, "training_iteration": 11, "trial_id": "4935e_00000", "date": "2023-07-25_15-48-41", "timestamp": 1690289321, "time_this_iter_s": 11.192745208740234, "time_total_s": 123.5680661201477, "pid": 67353, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[0, 0.003], [5400, 0.001], [10800, 0.00075], [16200, 0.0005], [21600, 0.00025], [27000, 0.0001], [32400, 7.5e-05], [37800, 5e-05], [43200, 2.5e-05], [48600, 1e-05], [54000, 7.5e-06], [59400, 5e-06], [64800, 2.5e-06], [70200, 1e-06], [75600, 5e-07], [81000, 1e-07]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x177531310>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 123.5680661201477, "iterations_since_restore": 11, "perf": {"cpu_util_percent": 26.0, "ram_util_percent": 79.3875}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 0.00028333333333333335, "entropy_coeff": 0.10000000000000002, "policy_entropy": -1858.34375, "policy_loss": -2.8611888066305336e+18, "vf_loss": 2452687402.6666665}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 120.0, "num_grad_updates_lifetime": 176.0, "diff_num_grad_updates_vs_sampler_policy": 175.0}}, "num_env_steps_sampled": 21240, "num_env_steps_trained": 21240, "num_agent_steps_sampled": 21240, "num_agent_steps_trained": 21240}, "sampler_results": {"episode_reward_max": -8444.236095312468, "episode_reward_min": -30145.7689349501, "episode_reward_mean": -29068.060919715168, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-8913.826131798241, -8444.236095312468, -24931.07637817849, -29874.66400259338, -30134.70637972163, -29762.082259138468, -29984.42375117467, -29884.054884107227, -29732.63462021125, -29734.74741394928, -29599.58056175506, -29832.797365967963, -29766.292425560343, -30084.192366059553, -29681.35111266077, -29821.739926135935, -29806.54303736546, -29871.84153731382, -29891.674793035487, -29892.823880389962, -29875.158047759254, -29994.204920873275, -29981.235816298202, -29745.265375235438, -29826.982526647404, -29962.08693607791, -29971.522223064138, -29866.98890678254, -29846.907193765634, -29951.164493724882, -29817.127153326233, -29832.47065890343, -30013.566140807965, -29670.92799848734, -30105.278329191522, -29856.88333937987, -29919.502939343452, -29953.62872535819, -29765.037883982135, -29902.414857735148, -30145.7689349501, -29804.63900864462, -29751.998564301775, -30018.118508833555, -29713.869352751786, -29887.37659015742, -29734.729943288814, -29826.223158529236, -30042.544949823463, -30039.39342858763, -29770.50066907107, -29719.259510635333, -30009.326254365078, -29902.54622393914, -30032.460224054972, -30002.91322499981, -29649.34458979476, -29795.43580966862, -29665.501927624326], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.43588404102918, "mean_inference_ms": 0.2522217820770292, "mean_action_processing_ms": 0.059449647694796694, "mean_env_wait_ms": 1.8134589074112686, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0025155180591647907, "StateBufferConnector_ms": 0.0017562154996193062, "ViewRequirementAgentConnector_ms": 0.045032420400845805}}, "episode_reward_max": -8444.236095312468, "episode_reward_min": -30145.7689349501, "episode_reward_mean": -29068.060919715168, "episode_len_mean": 360.0, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-8913.826131798241, -8444.236095312468, -24931.07637817849, -29874.66400259338, -30134.70637972163, -29762.082259138468, -29984.42375117467, -29884.054884107227, -29732.63462021125, -29734.74741394928, -29599.58056175506, -29832.797365967963, -29766.292425560343, -30084.192366059553, -29681.35111266077, -29821.739926135935, -29806.54303736546, -29871.84153731382, -29891.674793035487, -29892.823880389962, -29875.158047759254, -29994.204920873275, -29981.235816298202, -29745.265375235438, -29826.982526647404, -29962.08693607791, -29971.522223064138, -29866.98890678254, -29846.907193765634, -29951.164493724882, -29817.127153326233, -29832.47065890343, -30013.566140807965, -29670.92799848734, -30105.278329191522, -29856.88333937987, -29919.502939343452, -29953.62872535819, -29765.037883982135, -29902.414857735148, -30145.7689349501, -29804.63900864462, -29751.998564301775, -30018.118508833555, -29713.869352751786, -29887.37659015742, -29734.729943288814, -29826.223158529236, -30042.544949823463, -30039.39342858763, -29770.50066907107, -29719.259510635333, -30009.326254365078, -29902.54622393914, -30032.460224054972, -30002.91322499981, -29649.34458979476, -29795.43580966862, -29665.501927624326], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.43588404102918, "mean_inference_ms": 0.2522217820770292, "mean_action_processing_ms": 0.059449647694796694, "mean_env_wait_ms": 1.8134589074112686, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0025155180591647907, "StateBufferConnector_ms": 0.0017562154996193062, "ViewRequirementAgentConnector_ms": 0.045032420400845805}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 21240, "num_agent_steps_trained": 21240, "num_env_steps_sampled": 21240, "num_env_steps_trained": 21240, "num_env_steps_sampled_this_iter": 1800, "num_env_steps_trained_this_iter": 1800, "num_env_steps_sampled_throughput_per_sec": 161.47675889850683, "num_env_steps_trained_throughput_per_sec": 161.47675889850683, "timesteps_total": 21240, "num_steps_trained_this_iter": 1800, "agent_timesteps_total": 21240, "timers": {"training_iteration_time_ms": 2233.782, "sample_time_ms": 2228.196, "load_time_ms": 0.217, "load_throughput": 1657281.791, "learn_time_ms": 4.786, "learn_throughput": 75221.035, "synch_weights_time_ms": 0.549}, "counters": {"num_env_steps_sampled": 21240, "num_env_steps_trained": 21240, "num_agent_steps_sampled": 21240, "num_agent_steps_trained": 21240}, "done": false, "episodes_total": 59, "training_iteration": 12, "trial_id": "4935e_00000", "date": "2023-07-25_15-48-53", "timestamp": 1690289333, "time_this_iter_s": 11.149209022521973, "time_total_s": 134.71727514266968, "pid": 67353, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[0, 0.003], [5400, 0.001], [10800, 0.00075], [16200, 0.0005], [21600, 0.00025], [27000, 0.0001], [32400, 7.5e-05], [37800, 5e-05], [43200, 2.5e-05], [48600, 1e-05], [54000, 7.5e-06], [59400, 5e-06], [64800, 2.5e-06], [70200, 1e-06], [75600, 5e-07], [81000, 1e-07]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x177531310>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 134.71727514266968, "iterations_since_restore": 12, "perf": {"cpu_util_percent": 22.7625, "ram_util_percent": 79.20625}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 0.00022, "entropy_coeff": 0.10000000000000002, "policy_entropy": -1858.4232991536458, "policy_loss": -1.5550843486671e+18, "vf_loss": 2493984704.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 120.0, "num_grad_updates_lifetime": 191.0, "diff_num_grad_updates_vs_sampler_policy": 190.0}}, "num_env_steps_sampled": 23040, "num_env_steps_trained": 23040, "num_agent_steps_sampled": 23040, "num_agent_steps_trained": 23040}, "sampler_results": {"episode_reward_max": -8444.236095312468, "episode_reward_min": -30145.7689349501, "episode_reward_mean": -29134.5437436543, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-8913.826131798241, -8444.236095312468, -24931.07637817849, -29874.66400259338, -30134.70637972163, -29762.082259138468, -29984.42375117467, -29884.054884107227, -29732.63462021125, -29734.74741394928, -29599.58056175506, -29832.797365967963, -29766.292425560343, -30084.192366059553, -29681.35111266077, -29821.739926135935, -29806.54303736546, -29871.84153731382, -29891.674793035487, -29892.823880389962, -29875.158047759254, -29994.204920873275, -29981.235816298202, -29745.265375235438, -29826.982526647404, -29962.08693607791, -29971.522223064138, -29866.98890678254, -29846.907193765634, -29951.164493724882, -29817.127153326233, -29832.47065890343, -30013.566140807965, -29670.92799848734, -30105.278329191522, -29856.88333937987, -29919.502939343452, -29953.62872535819, -29765.037883982135, -29902.414857735148, -30145.7689349501, -29804.63900864462, -29751.998564301775, -30018.118508833555, -29713.869352751786, -29887.37659015742, -29734.729943288814, -29826.223158529236, -30042.544949823463, -30039.39342858763, -29770.50066907107, -29719.259510635333, -30009.326254365078, -29902.54622393914, -30032.460224054972, -30002.91322499981, -29649.34458979476, -29795.43580966862, -29665.501927624326, -29790.23442502846, -29913.554637842444, -30071.141023532444, -29897.82976172966, -29922.445482547326], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.435381000436557, "mean_inference_ms": 0.2520608774055446, "mean_action_processing_ms": 0.059418622794919995, "mean_env_wait_ms": 1.7935548702325126, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002555176615715027, "StateBufferConnector_ms": 0.0017650425434112549, "ViewRequirementAgentConnector_ms": 0.04505030810832977}}, "episode_reward_max": -8444.236095312468, "episode_reward_min": -30145.7689349501, "episode_reward_mean": -29134.5437436543, "episode_len_mean": 360.0, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-8913.826131798241, -8444.236095312468, -24931.07637817849, -29874.66400259338, -30134.70637972163, -29762.082259138468, -29984.42375117467, -29884.054884107227, -29732.63462021125, -29734.74741394928, -29599.58056175506, -29832.797365967963, -29766.292425560343, -30084.192366059553, -29681.35111266077, -29821.739926135935, -29806.54303736546, -29871.84153731382, -29891.674793035487, -29892.823880389962, -29875.158047759254, -29994.204920873275, -29981.235816298202, -29745.265375235438, -29826.982526647404, -29962.08693607791, -29971.522223064138, -29866.98890678254, -29846.907193765634, -29951.164493724882, -29817.127153326233, -29832.47065890343, -30013.566140807965, -29670.92799848734, -30105.278329191522, -29856.88333937987, -29919.502939343452, -29953.62872535819, -29765.037883982135, -29902.414857735148, -30145.7689349501, -29804.63900864462, -29751.998564301775, -30018.118508833555, -29713.869352751786, -29887.37659015742, -29734.729943288814, -29826.223158529236, -30042.544949823463, -30039.39342858763, -29770.50066907107, -29719.259510635333, -30009.326254365078, -29902.54622393914, -30032.460224054972, -30002.91322499981, -29649.34458979476, -29795.43580966862, -29665.501927624326, -29790.23442502846, -29913.554637842444, -30071.141023532444, -29897.82976172966, -29922.445482547326], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.435381000436557, "mean_inference_ms": 0.2520608774055446, "mean_action_processing_ms": 0.059418622794919995, "mean_env_wait_ms": 1.7935548702325126, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002555176615715027, "StateBufferConnector_ms": 0.0017650425434112549, "ViewRequirementAgentConnector_ms": 0.04505030810832977}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 23040, "num_agent_steps_trained": 23040, "num_env_steps_sampled": 23040, "num_env_steps_trained": 23040, "num_env_steps_sampled_this_iter": 1800, "num_env_steps_trained_this_iter": 1800, "num_env_steps_sampled_throughput_per_sec": 160.4208564295751, "num_env_steps_trained_throughput_per_sec": 160.4208564295751, "timesteps_total": 23040, "num_steps_trained_this_iter": 1800, "agent_timesteps_total": 23040, "timers": {"training_iteration_time_ms": 2236.75, "sample_time_ms": 2231.206, "load_time_ms": 0.22, "load_throughput": 1637689.197, "learn_time_ms": 4.768, "learn_throughput": 75510.686, "synch_weights_time_ms": 0.523}, "counters": {"num_env_steps_sampled": 23040, "num_env_steps_trained": 23040, "num_agent_steps_sampled": 23040, "num_agent_steps_trained": 23040}, "done": false, "episodes_total": 64, "training_iteration": 13, "trial_id": "4935e_00000", "date": "2023-07-25_15-49-04", "timestamp": 1690289344, "time_this_iter_s": 11.222533226013184, "time_total_s": 145.93980836868286, "pid": 67353, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[0, 0.003], [5400, 0.001], [10800, 0.00075], [16200, 0.0005], [21600, 0.00025], [27000, 0.0001], [32400, 7.5e-05], [37800, 5e-05], [43200, 2.5e-05], [48600, 1e-05], [54000, 7.5e-06], [59400, 5e-06], [64800, 2.5e-06], [70200, 1e-06], [75600, 5e-07], [81000, 1e-07]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x177531310>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 145.93980836868286, "iterations_since_restore": 13, "perf": {"cpu_util_percent": 25.0375, "ram_util_percent": 79.175}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 0.00017, "entropy_coeff": 0.10000000000000002, "policy_entropy": -1858.625732421875, "policy_loss": -1.2799970455909827e+18, "vf_loss": 2493201408.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 120.0, "num_grad_updates_lifetime": 206.0, "diff_num_grad_updates_vs_sampler_policy": 205.0}}, "num_env_steps_sampled": 24840, "num_env_steps_trained": 24840, "num_agent_steps_sampled": 24840, "num_agent_steps_trained": 24840}, "sampler_results": {"episode_reward_max": -8444.236095312468, "episode_reward_min": -30145.7689349501, "episode_reward_mean": -29179.27496740079, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-8913.826131798241, -8444.236095312468, -24931.07637817849, -29874.66400259338, -30134.70637972163, -29762.082259138468, -29984.42375117467, -29884.054884107227, -29732.63462021125, -29734.74741394928, -29599.58056175506, -29832.797365967963, -29766.292425560343, -30084.192366059553, -29681.35111266077, -29821.739926135935, -29806.54303736546, -29871.84153731382, -29891.674793035487, -29892.823880389962, -29875.158047759254, -29994.204920873275, -29981.235816298202, -29745.265375235438, -29826.982526647404, -29962.08693607791, -29971.522223064138, -29866.98890678254, -29846.907193765634, -29951.164493724882, -29817.127153326233, -29832.47065890343, -30013.566140807965, -29670.92799848734, -30105.278329191522, -29856.88333937987, -29919.502939343452, -29953.62872535819, -29765.037883982135, -29902.414857735148, -30145.7689349501, -29804.63900864462, -29751.998564301775, -30018.118508833555, -29713.869352751786, -29887.37659015742, -29734.729943288814, -29826.223158529236, -30042.544949823463, -30039.39342858763, -29770.50066907107, -29719.259510635333, -30009.326254365078, -29902.54622393914, -30032.460224054972, -30002.91322499981, -29649.34458979476, -29795.43580966862, -29665.501927624326, -29790.23442502846, -29913.554637842444, -30071.141023532444, -29897.82976172966, -29922.445482547326, -29557.448431599172, -29601.797781076402, -29871.040267777982, -29773.356675876406, -29955.530000449162], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.43483711042257, "mean_inference_ms": 0.25190920549472046, "mean_action_processing_ms": 0.05938980493154561, "mean_env_wait_ms": 1.7760593685622226, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0025704287100529327, "StateBufferConnector_ms": 0.0017577323360719543, "ViewRequirementAgentConnector_ms": 0.04505074542501698}}, "episode_reward_max": -8444.236095312468, "episode_reward_min": -30145.7689349501, "episode_reward_mean": -29179.27496740079, "episode_len_mean": 360.0, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-8913.826131798241, -8444.236095312468, -24931.07637817849, -29874.66400259338, -30134.70637972163, -29762.082259138468, -29984.42375117467, -29884.054884107227, -29732.63462021125, -29734.74741394928, -29599.58056175506, -29832.797365967963, -29766.292425560343, -30084.192366059553, -29681.35111266077, -29821.739926135935, -29806.54303736546, -29871.84153731382, -29891.674793035487, -29892.823880389962, -29875.158047759254, -29994.204920873275, -29981.235816298202, -29745.265375235438, -29826.982526647404, -29962.08693607791, -29971.522223064138, -29866.98890678254, -29846.907193765634, -29951.164493724882, -29817.127153326233, -29832.47065890343, -30013.566140807965, -29670.92799848734, -30105.278329191522, -29856.88333937987, -29919.502939343452, -29953.62872535819, -29765.037883982135, -29902.414857735148, -30145.7689349501, -29804.63900864462, -29751.998564301775, -30018.118508833555, -29713.869352751786, -29887.37659015742, -29734.729943288814, -29826.223158529236, -30042.544949823463, -30039.39342858763, -29770.50066907107, -29719.259510635333, -30009.326254365078, -29902.54622393914, -30032.460224054972, -30002.91322499981, -29649.34458979476, -29795.43580966862, -29665.501927624326, -29790.23442502846, -29913.554637842444, -30071.141023532444, -29897.82976172966, -29922.445482547326, -29557.448431599172, -29601.797781076402, -29871.040267777982, -29773.356675876406, -29955.530000449162], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.43483711042257, "mean_inference_ms": 0.25190920549472046, "mean_action_processing_ms": 0.05938980493154561, "mean_env_wait_ms": 1.7760593685622226, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0025704287100529327, "StateBufferConnector_ms": 0.0017577323360719543, "ViewRequirementAgentConnector_ms": 0.04505074542501698}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 24840, "num_agent_steps_trained": 24840, "num_env_steps_sampled": 24840, "num_env_steps_trained": 24840, "num_env_steps_sampled_this_iter": 1800, "num_env_steps_trained_this_iter": 1800, "num_env_steps_sampled_throughput_per_sec": 160.79679160683352, "num_env_steps_trained_throughput_per_sec": 160.79679160683352, "timesteps_total": 24840, "num_steps_trained_this_iter": 1800, "agent_timesteps_total": 24840, "timers": {"training_iteration_time_ms": 2241.465, "sample_time_ms": 2235.761, "load_time_ms": 0.228, "load_throughput": 1577300.157, "learn_time_ms": 4.922, "learn_throughput": 73145.479, "synch_weights_time_ms": 0.52}, "counters": {"num_env_steps_sampled": 24840, "num_env_steps_trained": 24840, "num_agent_steps_sampled": 24840, "num_agent_steps_trained": 24840}, "done": false, "episodes_total": 69, "training_iteration": 14, "trial_id": "4935e_00000", "date": "2023-07-25_15-49-15", "timestamp": 1690289355, "time_this_iter_s": 11.19625210762024, "time_total_s": 157.1360604763031, "pid": 67353, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[0, 0.003], [5400, 0.001], [10800, 0.00075], [16200, 0.0005], [21600, 0.00025], [27000, 0.0001], [32400, 7.5e-05], [37800, 5e-05], [43200, 2.5e-05], [48600, 1e-05], [54000, 7.5e-06], [59400, 5e-06], [64800, 2.5e-06], [70200, 1e-06], [75600, 5e-07], [81000, 1e-07]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x177531310>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 157.1360604763031, "iterations_since_restore": 14, "perf": {"cpu_util_percent": 23.956249999999997, "ram_util_percent": 79.1375}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 0.00011999999999999999, "entropy_coeff": 0.10000000000000002, "policy_entropy": -1858.8626708984375, "policy_loss": -8797998445117440.0, "vf_loss": 2467216960.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 120.0, "num_grad_updates_lifetime": 221.0, "diff_num_grad_updates_vs_sampler_policy": 220.0}}, "num_env_steps_sampled": 26640, "num_env_steps_trained": 26640, "num_agent_steps_sampled": 26640, "num_agent_steps_trained": 26640}, "sampler_results": {"episode_reward_max": -8444.236095312468, "episode_reward_min": -30145.7689349501, "episode_reward_mean": -29228.43713342256, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-8913.826131798241, -8444.236095312468, -24931.07637817849, -29874.66400259338, -30134.70637972163, -29762.082259138468, -29984.42375117467, -29884.054884107227, -29732.63462021125, -29734.74741394928, -29599.58056175506, -29832.797365967963, -29766.292425560343, -30084.192366059553, -29681.35111266077, -29821.739926135935, -29806.54303736546, -29871.84153731382, -29891.674793035487, -29892.823880389962, -29875.158047759254, -29994.204920873275, -29981.235816298202, -29745.265375235438, -29826.982526647404, -29962.08693607791, -29971.522223064138, -29866.98890678254, -29846.907193765634, -29951.164493724882, -29817.127153326233, -29832.47065890343, -30013.566140807965, -29670.92799848734, -30105.278329191522, -29856.88333937987, -29919.502939343452, -29953.62872535819, -29765.037883982135, -29902.414857735148, -30145.7689349501, -29804.63900864462, -29751.998564301775, -30018.118508833555, -29713.869352751786, -29887.37659015742, -29734.729943288814, -29826.223158529236, -30042.544949823463, -30039.39342858763, -29770.50066907107, -29719.259510635333, -30009.326254365078, -29902.54622393914, -30032.460224054972, -30002.91322499981, -29649.34458979476, -29795.43580966862, -29665.501927624326, -29790.23442502846, -29913.554637842444, -30071.141023532444, -29897.82976172966, -29922.445482547326, -29557.448431599172, -29601.797781076402, -29871.040267777982, -29773.356675876406, -29955.530000449162, -29984.44880312825, -29881.368547199767, -30025.403528519793, -29878.75064985404, -29764.403593913165], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.434089234027477, "mean_inference_ms": 0.25176257908408367, "mean_action_processing_ms": 0.05936308718941567, "mean_env_wait_ms": 1.7604749219804519, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0025427019273912585, "StateBufferConnector_ms": 0.0017488324964368665, "ViewRequirementAgentConnector_ms": 0.04498249775654561}}, "episode_reward_max": -8444.236095312468, "episode_reward_min": -30145.7689349501, "episode_reward_mean": -29228.43713342256, "episode_len_mean": 360.0, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-8913.826131798241, -8444.236095312468, -24931.07637817849, -29874.66400259338, -30134.70637972163, -29762.082259138468, -29984.42375117467, -29884.054884107227, -29732.63462021125, -29734.74741394928, -29599.58056175506, -29832.797365967963, -29766.292425560343, -30084.192366059553, -29681.35111266077, -29821.739926135935, -29806.54303736546, -29871.84153731382, -29891.674793035487, -29892.823880389962, -29875.158047759254, -29994.204920873275, -29981.235816298202, -29745.265375235438, -29826.982526647404, -29962.08693607791, -29971.522223064138, -29866.98890678254, -29846.907193765634, -29951.164493724882, -29817.127153326233, -29832.47065890343, -30013.566140807965, -29670.92799848734, -30105.278329191522, -29856.88333937987, -29919.502939343452, -29953.62872535819, -29765.037883982135, -29902.414857735148, -30145.7689349501, -29804.63900864462, -29751.998564301775, -30018.118508833555, -29713.869352751786, -29887.37659015742, -29734.729943288814, -29826.223158529236, -30042.544949823463, -30039.39342858763, -29770.50066907107, -29719.259510635333, -30009.326254365078, -29902.54622393914, -30032.460224054972, -30002.91322499981, -29649.34458979476, -29795.43580966862, -29665.501927624326, -29790.23442502846, -29913.554637842444, -30071.141023532444, -29897.82976172966, -29922.445482547326, -29557.448431599172, -29601.797781076402, -29871.040267777982, -29773.356675876406, -29955.530000449162, -29984.44880312825, -29881.368547199767, -30025.403528519793, -29878.75064985404, -29764.403593913165], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.434089234027477, "mean_inference_ms": 0.25176257908408367, "mean_action_processing_ms": 0.05936308718941567, "mean_env_wait_ms": 1.7604749219804519, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0025427019273912585, "StateBufferConnector_ms": 0.0017488324964368665, "ViewRequirementAgentConnector_ms": 0.04498249775654561}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 26640, "num_agent_steps_trained": 26640, "num_env_steps_sampled": 26640, "num_env_steps_trained": 26640, "num_env_steps_sampled_this_iter": 1800, "num_env_steps_trained_this_iter": 1800, "num_env_steps_sampled_throughput_per_sec": 162.34722641334605, "num_env_steps_trained_throughput_per_sec": 162.34722641334605, "timesteps_total": 26640, "num_steps_trained_this_iter": 1800, "agent_timesteps_total": 26640, "timers": {"training_iteration_time_ms": 2228.151, "sample_time_ms": 2222.433, "load_time_ms": 0.228, "load_throughput": 1578124.415, "learn_time_ms": 4.924, "learn_throughput": 73108.647, "synch_weights_time_ms": 0.53}, "counters": {"num_env_steps_sampled": 26640, "num_env_steps_trained": 26640, "num_agent_steps_sampled": 26640, "num_agent_steps_trained": 26640}, "done": false, "episodes_total": 74, "training_iteration": 15, "trial_id": "4935e_00000", "date": "2023-07-25_15-49-26", "timestamp": 1690289366, "time_this_iter_s": 11.08932614326477, "time_total_s": 168.22538661956787, "pid": 67353, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[0, 0.003], [5400, 0.001], [10800, 0.00075], [16200, 0.0005], [21600, 0.00025], [27000, 0.0001], [32400, 7.5e-05], [37800, 5e-05], [43200, 2.5e-05], [48600, 1e-05], [54000, 7.5e-06], [59400, 5e-06], [64800, 2.5e-06], [70200, 1e-06], [75600, 5e-07], [81000, 1e-07]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x177531310>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 168.22538661956787, "iterations_since_restore": 15, "perf": {"cpu_util_percent": 24.28125, "ram_util_percent": 78.74375}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 9.499999999999999e-05, "entropy_coeff": 0.10000000000000002, "policy_entropy": -1859.0048014322917, "policy_loss": -2.147758411374483e+17, "vf_loss": 2508106965.3333335}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 120.0, "num_grad_updates_lifetime": 236.0, "diff_num_grad_updates_vs_sampler_policy": 235.0}}, "num_env_steps_sampled": 28440, "num_env_steps_trained": 28440, "num_agent_steps_sampled": 28440, "num_agent_steps_trained": 28440}, "sampler_results": {"episode_reward_max": -8444.236095312468, "episode_reward_min": -30145.7689349501, "episode_reward_mean": -29263.90813533633, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-8913.826131798241, -8444.236095312468, -24931.07637817849, -29874.66400259338, -30134.70637972163, -29762.082259138468, -29984.42375117467, -29884.054884107227, -29732.63462021125, -29734.74741394928, -29599.58056175506, -29832.797365967963, -29766.292425560343, -30084.192366059553, -29681.35111266077, -29821.739926135935, -29806.54303736546, -29871.84153731382, -29891.674793035487, -29892.823880389962, -29875.158047759254, -29994.204920873275, -29981.235816298202, -29745.265375235438, -29826.982526647404, -29962.08693607791, -29971.522223064138, -29866.98890678254, -29846.907193765634, -29951.164493724882, -29817.127153326233, -29832.47065890343, -30013.566140807965, -29670.92799848734, -30105.278329191522, -29856.88333937987, -29919.502939343452, -29953.62872535819, -29765.037883982135, -29902.414857735148, -30145.7689349501, -29804.63900864462, -29751.998564301775, -30018.118508833555, -29713.869352751786, -29887.37659015742, -29734.729943288814, -29826.223158529236, -30042.544949823463, -30039.39342858763, -29770.50066907107, -29719.259510635333, -30009.326254365078, -29902.54622393914, -30032.460224054972, -30002.91322499981, -29649.34458979476, -29795.43580966862, -29665.501927624326, -29790.23442502846, -29913.554637842444, -30071.141023532444, -29897.82976172966, -29922.445482547326, -29557.448431599172, -29601.797781076402, -29871.040267777982, -29773.356675876406, -29955.530000449162, -29984.44880312825, -29881.368547199767, -30025.403528519793, -29878.75064985404, -29764.403593913165, -29670.755210090556, -29568.779574730706, -29786.3891216829, -30057.63277585619, -29860.83813594021], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.433254002054448, "mean_inference_ms": 0.25164003650875627, "mean_action_processing_ms": 0.0593404084522703, "mean_env_wait_ms": 1.7466517313114827, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0025190884553933446, "StateBufferConnector_ms": 0.001747396927845629, "ViewRequirementAgentConnector_ms": 0.0449763068669959}}, "episode_reward_max": -8444.236095312468, "episode_reward_min": -30145.7689349501, "episode_reward_mean": -29263.90813533633, "episode_len_mean": 360.0, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-8913.826131798241, -8444.236095312468, -24931.07637817849, -29874.66400259338, -30134.70637972163, -29762.082259138468, -29984.42375117467, -29884.054884107227, -29732.63462021125, -29734.74741394928, -29599.58056175506, -29832.797365967963, -29766.292425560343, -30084.192366059553, -29681.35111266077, -29821.739926135935, -29806.54303736546, -29871.84153731382, -29891.674793035487, -29892.823880389962, -29875.158047759254, -29994.204920873275, -29981.235816298202, -29745.265375235438, -29826.982526647404, -29962.08693607791, -29971.522223064138, -29866.98890678254, -29846.907193765634, -29951.164493724882, -29817.127153326233, -29832.47065890343, -30013.566140807965, -29670.92799848734, -30105.278329191522, -29856.88333937987, -29919.502939343452, -29953.62872535819, -29765.037883982135, -29902.414857735148, -30145.7689349501, -29804.63900864462, -29751.998564301775, -30018.118508833555, -29713.869352751786, -29887.37659015742, -29734.729943288814, -29826.223158529236, -30042.544949823463, -30039.39342858763, -29770.50066907107, -29719.259510635333, -30009.326254365078, -29902.54622393914, -30032.460224054972, -30002.91322499981, -29649.34458979476, -29795.43580966862, -29665.501927624326, -29790.23442502846, -29913.554637842444, -30071.141023532444, -29897.82976172966, -29922.445482547326, -29557.448431599172, -29601.797781076402, -29871.040267777982, -29773.356675876406, -29955.530000449162, -29984.44880312825, -29881.368547199767, -30025.403528519793, -29878.75064985404, -29764.403593913165, -29670.755210090556, -29568.779574730706, -29786.3891216829, -30057.63277585619, -29860.83813594021], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.433254002054448, "mean_inference_ms": 0.25164003650875627, "mean_action_processing_ms": 0.0593404084522703, "mean_env_wait_ms": 1.7466517313114827, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0025190884553933446, "StateBufferConnector_ms": 0.001747396927845629, "ViewRequirementAgentConnector_ms": 0.0449763068669959}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 28440, "num_agent_steps_trained": 28440, "num_env_steps_sampled": 28440, "num_env_steps_trained": 28440, "num_env_steps_sampled_this_iter": 1800, "num_env_steps_trained_this_iter": 1800, "num_env_steps_sampled_throughput_per_sec": 160.89105343971764, "num_env_steps_trained_throughput_per_sec": 160.89105343971764, "timesteps_total": 28440, "num_steps_trained_this_iter": 1800, "agent_timesteps_total": 28440, "timers": {"training_iteration_time_ms": 2227.495, "sample_time_ms": 2222.177, "load_time_ms": 0.217, "load_throughput": 1657827.668, "learn_time_ms": 4.566, "learn_throughput": 78837.419, "synch_weights_time_ms": 0.502}, "counters": {"num_env_steps_sampled": 28440, "num_env_steps_trained": 28440, "num_agent_steps_sampled": 28440, "num_agent_steps_trained": 28440}, "done": false, "episodes_total": 79, "training_iteration": 16, "trial_id": "4935e_00000", "date": "2023-07-25_15-49-37", "timestamp": 1690289377, "time_this_iter_s": 11.189655780792236, "time_total_s": 179.4150424003601, "pid": 67353, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[0, 0.003], [5400, 0.001], [10800, 0.00075], [16200, 0.0005], [21600, 0.00025], [27000, 0.0001], [32400, 7.5e-05], [37800, 5e-05], [43200, 2.5e-05], [48600, 1e-05], [54000, 7.5e-06], [59400, 5e-06], [64800, 2.5e-06], [70200, 1e-06], [75600, 5e-07], [81000, 1e-07]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x177531310>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 179.4150424003601, "iterations_since_restore": 16, "perf": {"cpu_util_percent": 27.8, "ram_util_percent": 79.06875}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 8.666666666666668e-05, "entropy_coeff": 0.10000000000000002, "policy_entropy": -1859.2406819661458, "policy_loss": -4.1282748262241894e+17, "vf_loss": 2525629077.3333335}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 120.0, "num_grad_updates_lifetime": 251.0, "diff_num_grad_updates_vs_sampler_policy": 250.0}}, "num_env_steps_sampled": 30240, "num_env_steps_trained": 30240, "num_agent_steps_sampled": 30240, "num_agent_steps_trained": 30240}, "sampler_results": {"episode_reward_max": -8444.236095312468, "episode_reward_min": -30145.7689349501, "episode_reward_mean": -29302.461516932573, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-8913.826131798241, -8444.236095312468, -24931.07637817849, -29874.66400259338, -30134.70637972163, -29762.082259138468, -29984.42375117467, -29884.054884107227, -29732.63462021125, -29734.74741394928, -29599.58056175506, -29832.797365967963, -29766.292425560343, -30084.192366059553, -29681.35111266077, -29821.739926135935, -29806.54303736546, -29871.84153731382, -29891.674793035487, -29892.823880389962, -29875.158047759254, -29994.204920873275, -29981.235816298202, -29745.265375235438, -29826.982526647404, -29962.08693607791, -29971.522223064138, -29866.98890678254, -29846.907193765634, -29951.164493724882, -29817.127153326233, -29832.47065890343, -30013.566140807965, -29670.92799848734, -30105.278329191522, -29856.88333937987, -29919.502939343452, -29953.62872535819, -29765.037883982135, -29902.414857735148, -30145.7689349501, -29804.63900864462, -29751.998564301775, -30018.118508833555, -29713.869352751786, -29887.37659015742, -29734.729943288814, -29826.223158529236, -30042.544949823463, -30039.39342858763, -29770.50066907107, -29719.259510635333, -30009.326254365078, -29902.54622393914, -30032.460224054972, -30002.91322499981, -29649.34458979476, -29795.43580966862, -29665.501927624326, -29790.23442502846, -29913.554637842444, -30071.141023532444, -29897.82976172966, -29922.445482547326, -29557.448431599172, -29601.797781076402, -29871.040267777982, -29773.356675876406, -29955.530000449162, -29984.44880312825, -29881.368547199767, -30025.403528519793, -29878.75064985404, -29764.403593913165, -29670.755210090556, -29568.779574730706, -29786.3891216829, -30057.63277585619, -29860.83813594021, -29741.915640969215, -29777.885634214686, -29976.21027442633, -29953.744760234193, -30108.26842092144], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.432432185125076, "mean_inference_ms": 0.2515250683345008, "mean_action_processing_ms": 0.05931914370855962, "mean_env_wait_ms": 1.7341170707560998, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0025263854435511996, "StateBufferConnector_ms": 0.001749254408336821, "ViewRequirementAgentConnector_ms": 0.04501427922930036}}, "episode_reward_max": -8444.236095312468, "episode_reward_min": -30145.7689349501, "episode_reward_mean": -29302.461516932573, "episode_len_mean": 360.0, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-8913.826131798241, -8444.236095312468, -24931.07637817849, -29874.66400259338, -30134.70637972163, -29762.082259138468, -29984.42375117467, -29884.054884107227, -29732.63462021125, -29734.74741394928, -29599.58056175506, -29832.797365967963, -29766.292425560343, -30084.192366059553, -29681.35111266077, -29821.739926135935, -29806.54303736546, -29871.84153731382, -29891.674793035487, -29892.823880389962, -29875.158047759254, -29994.204920873275, -29981.235816298202, -29745.265375235438, -29826.982526647404, -29962.08693607791, -29971.522223064138, -29866.98890678254, -29846.907193765634, -29951.164493724882, -29817.127153326233, -29832.47065890343, -30013.566140807965, -29670.92799848734, -30105.278329191522, -29856.88333937987, -29919.502939343452, -29953.62872535819, -29765.037883982135, -29902.414857735148, -30145.7689349501, -29804.63900864462, -29751.998564301775, -30018.118508833555, -29713.869352751786, -29887.37659015742, -29734.729943288814, -29826.223158529236, -30042.544949823463, -30039.39342858763, -29770.50066907107, -29719.259510635333, -30009.326254365078, -29902.54622393914, -30032.460224054972, -30002.91322499981, -29649.34458979476, -29795.43580966862, -29665.501927624326, -29790.23442502846, -29913.554637842444, -30071.141023532444, -29897.82976172966, -29922.445482547326, -29557.448431599172, -29601.797781076402, -29871.040267777982, -29773.356675876406, -29955.530000449162, -29984.44880312825, -29881.368547199767, -30025.403528519793, -29878.75064985404, -29764.403593913165, -29670.755210090556, -29568.779574730706, -29786.3891216829, -30057.63277585619, -29860.83813594021, -29741.915640969215, -29777.885634214686, -29976.21027442633, -29953.744760234193, -30108.26842092144], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.432432185125076, "mean_inference_ms": 0.2515250683345008, "mean_action_processing_ms": 0.05931914370855962, "mean_env_wait_ms": 1.7341170707560998, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0025263854435511996, "StateBufferConnector_ms": 0.001749254408336821, "ViewRequirementAgentConnector_ms": 0.04501427922930036}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 30240, "num_agent_steps_trained": 30240, "num_env_steps_sampled": 30240, "num_env_steps_trained": 30240, "num_env_steps_sampled_this_iter": 1800, "num_env_steps_trained_this_iter": 1800, "num_env_steps_sampled_throughput_per_sec": 161.84299511916632, "num_env_steps_trained_throughput_per_sec": 161.84299511916632, "timesteps_total": 30240, "num_steps_trained_this_iter": 1800, "agent_timesteps_total": 30240, "timers": {"training_iteration_time_ms": 2230.949, "sample_time_ms": 2225.655, "load_time_ms": 0.215, "load_throughput": 1676417.72, "learn_time_ms": 4.545, "learn_throughput": 79211.709, "synch_weights_time_ms": 0.504}, "counters": {"num_env_steps_sampled": 30240, "num_env_steps_trained": 30240, "num_agent_steps_sampled": 30240, "num_agent_steps_trained": 30240}, "done": false, "episodes_total": 84, "training_iteration": 17, "trial_id": "4935e_00000", "date": "2023-07-25_15-49-49", "timestamp": 1690289389, "time_this_iter_s": 11.12408995628357, "time_total_s": 190.53913235664368, "pid": 67353, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[0, 0.003], [5400, 0.001], [10800, 0.00075], [16200, 0.0005], [21600, 0.00025], [27000, 0.0001], [32400, 7.5e-05], [37800, 5e-05], [43200, 2.5e-05], [48600, 1e-05], [54000, 7.5e-06], [59400, 5e-06], [64800, 2.5e-06], [70200, 1e-06], [75600, 5e-07], [81000, 1e-07]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x177531310>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 190.53913235664368, "iterations_since_restore": 17, "perf": {"cpu_util_percent": 26.987499999999997, "ram_util_percent": 79.2}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 7.833333333333333e-05, "entropy_coeff": 0.10000000000000002, "policy_entropy": -1859.3832194010417, "policy_loss": -1.3611445455579682e+17, "vf_loss": 2458177984.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 120.0, "num_grad_updates_lifetime": 266.0, "diff_num_grad_updates_vs_sampler_policy": 265.0}}, "num_env_steps_sampled": 32040, "num_env_steps_trained": 32040, "num_agent_steps_sampled": 32040, "num_agent_steps_trained": 32040}, "sampler_results": {"episode_reward_max": -8444.236095312468, "episode_reward_min": -30145.7689349501, "episode_reward_mean": -29329.531075655243, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-8913.826131798241, -8444.236095312468, -24931.07637817849, -29874.66400259338, -30134.70637972163, -29762.082259138468, -29984.42375117467, -29884.054884107227, -29732.63462021125, -29734.74741394928, -29599.58056175506, -29832.797365967963, -29766.292425560343, -30084.192366059553, -29681.35111266077, -29821.739926135935, -29806.54303736546, -29871.84153731382, -29891.674793035487, -29892.823880389962, -29875.158047759254, -29994.204920873275, -29981.235816298202, -29745.265375235438, -29826.982526647404, -29962.08693607791, -29971.522223064138, -29866.98890678254, -29846.907193765634, -29951.164493724882, -29817.127153326233, -29832.47065890343, -30013.566140807965, -29670.92799848734, -30105.278329191522, -29856.88333937987, -29919.502939343452, -29953.62872535819, -29765.037883982135, -29902.414857735148, -30145.7689349501, -29804.63900864462, -29751.998564301775, -30018.118508833555, -29713.869352751786, -29887.37659015742, -29734.729943288814, -29826.223158529236, -30042.544949823463, -30039.39342858763, -29770.50066907107, -29719.259510635333, -30009.326254365078, -29902.54622393914, -30032.460224054972, -30002.91322499981, -29649.34458979476, -29795.43580966862, -29665.501927624326, -29790.23442502846, -29913.554637842444, -30071.141023532444, -29897.82976172966, -29922.445482547326, -29557.448431599172, -29601.797781076402, -29871.040267777982, -29773.356675876406, -29955.530000449162, -29984.44880312825, -29881.368547199767, -30025.403528519793, -29878.75064985404, -29764.403593913165, -29670.755210090556, -29568.779574730706, -29786.3891216829, -30057.63277585619, -29860.83813594021, -29741.915640969215, -29777.885634214686, -29976.21027442633, -29953.744760234193, -30108.26842092144, -29790.5915650707, -29783.214302088596, -29608.115626567964, -29991.074675852167, -29748.50214140118], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.431663930452259, "mean_inference_ms": 0.2514246873247461, "mean_action_processing_ms": 0.05930042379115151, "mean_env_wait_ms": 1.7227948173613366, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0025288442547401683, "StateBufferConnector_ms": 0.0017447418041443557, "ViewRequirementAgentConnector_ms": 0.044931186718887156}}, "episode_reward_max": -8444.236095312468, "episode_reward_min": -30145.7689349501, "episode_reward_mean": -29329.531075655243, "episode_len_mean": 360.0, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-8913.826131798241, -8444.236095312468, -24931.07637817849, -29874.66400259338, -30134.70637972163, -29762.082259138468, -29984.42375117467, -29884.054884107227, -29732.63462021125, -29734.74741394928, -29599.58056175506, -29832.797365967963, -29766.292425560343, -30084.192366059553, -29681.35111266077, -29821.739926135935, -29806.54303736546, -29871.84153731382, -29891.674793035487, -29892.823880389962, -29875.158047759254, -29994.204920873275, -29981.235816298202, -29745.265375235438, -29826.982526647404, -29962.08693607791, -29971.522223064138, -29866.98890678254, -29846.907193765634, -29951.164493724882, -29817.127153326233, -29832.47065890343, -30013.566140807965, -29670.92799848734, -30105.278329191522, -29856.88333937987, -29919.502939343452, -29953.62872535819, -29765.037883982135, -29902.414857735148, -30145.7689349501, -29804.63900864462, -29751.998564301775, -30018.118508833555, -29713.869352751786, -29887.37659015742, -29734.729943288814, -29826.223158529236, -30042.544949823463, -30039.39342858763, -29770.50066907107, -29719.259510635333, -30009.326254365078, -29902.54622393914, -30032.460224054972, -30002.91322499981, -29649.34458979476, -29795.43580966862, -29665.501927624326, -29790.23442502846, -29913.554637842444, -30071.141023532444, -29897.82976172966, -29922.445482547326, -29557.448431599172, -29601.797781076402, -29871.040267777982, -29773.356675876406, -29955.530000449162, -29984.44880312825, -29881.368547199767, -30025.403528519793, -29878.75064985404, -29764.403593913165, -29670.755210090556, -29568.779574730706, -29786.3891216829, -30057.63277585619, -29860.83813594021, -29741.915640969215, -29777.885634214686, -29976.21027442633, -29953.744760234193, -30108.26842092144, -29790.5915650707, -29783.214302088596, -29608.115626567964, -29991.074675852167, -29748.50214140118], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.431663930452259, "mean_inference_ms": 0.2514246873247461, "mean_action_processing_ms": 0.05930042379115151, "mean_env_wait_ms": 1.7227948173613366, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0025288442547401683, "StateBufferConnector_ms": 0.0017447418041443557, "ViewRequirementAgentConnector_ms": 0.044931186718887156}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 32040, "num_agent_steps_trained": 32040, "num_env_steps_sampled": 32040, "num_env_steps_trained": 32040, "num_env_steps_sampled_this_iter": 1800, "num_env_steps_trained_this_iter": 1800, "num_env_steps_sampled_throughput_per_sec": 160.63971728505703, "num_env_steps_trained_throughput_per_sec": 160.63971728505703, "timesteps_total": 32040, "num_steps_trained_this_iter": 1800, "agent_timesteps_total": 32040, "timers": {"training_iteration_time_ms": 2232.699, "sample_time_ms": 2227.345, "load_time_ms": 0.214, "load_throughput": 1679214.235, "learn_time_ms": 4.578, "learn_throughput": 78644.019, "synch_weights_time_ms": 0.53}, "counters": {"num_env_steps_sampled": 32040, "num_env_steps_trained": 32040, "num_agent_steps_sampled": 32040, "num_agent_steps_trained": 32040}, "done": false, "episodes_total": 89, "training_iteration": 18, "trial_id": "4935e_00000", "date": "2023-07-25_15-50-00", "timestamp": 1690289400, "time_this_iter_s": 11.207677125930786, "time_total_s": 201.74680948257446, "pid": 67353, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[0, 0.003], [5400, 0.001], [10800, 0.00075], [16200, 0.0005], [21600, 0.00025], [27000, 0.0001], [32400, 7.5e-05], [37800, 5e-05], [43200, 2.5e-05], [48600, 1e-05], [54000, 7.5e-06], [59400, 5e-06], [64800, 2.5e-06], [70200, 1e-06], [75600, 5e-07], [81000, 1e-07]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x177531310>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 201.74680948257446, "iterations_since_restore": 18, "perf": {"cpu_util_percent": 27.5875, "ram_util_percent": 79.35625}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 7e-05, "entropy_coeff": 0.10000000000000002, "policy_entropy": -1859.4490152994792, "policy_loss": -3.2610038800157357e+17, "vf_loss": 2521296384.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 120.0, "num_grad_updates_lifetime": 281.0, "diff_num_grad_updates_vs_sampler_policy": 280.0}}, "num_env_steps_sampled": 33840, "num_env_steps_trained": 33840, "num_agent_steps_sampled": 33840, "num_agent_steps_trained": 33840}, "sampler_results": {"episode_reward_max": -8444.236095312468, "episode_reward_min": -30145.7689349501, "episode_reward_mean": -29360.898646009606, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-8913.826131798241, -8444.236095312468, -24931.07637817849, -29874.66400259338, -30134.70637972163, -29762.082259138468, -29984.42375117467, -29884.054884107227, -29732.63462021125, -29734.74741394928, -29599.58056175506, -29832.797365967963, -29766.292425560343, -30084.192366059553, -29681.35111266077, -29821.739926135935, -29806.54303736546, -29871.84153731382, -29891.674793035487, -29892.823880389962, -29875.158047759254, -29994.204920873275, -29981.235816298202, -29745.265375235438, -29826.982526647404, -29962.08693607791, -29971.522223064138, -29866.98890678254, -29846.907193765634, -29951.164493724882, -29817.127153326233, -29832.47065890343, -30013.566140807965, -29670.92799848734, -30105.278329191522, -29856.88333937987, -29919.502939343452, -29953.62872535819, -29765.037883982135, -29902.414857735148, -30145.7689349501, -29804.63900864462, -29751.998564301775, -30018.118508833555, -29713.869352751786, -29887.37659015742, -29734.729943288814, -29826.223158529236, -30042.544949823463, -30039.39342858763, -29770.50066907107, -29719.259510635333, -30009.326254365078, -29902.54622393914, -30032.460224054972, -30002.91322499981, -29649.34458979476, -29795.43580966862, -29665.501927624326, -29790.23442502846, -29913.554637842444, -30071.141023532444, -29897.82976172966, -29922.445482547326, -29557.448431599172, -29601.797781076402, -29871.040267777982, -29773.356675876406, -29955.530000449162, -29984.44880312825, -29881.368547199767, -30025.403528519793, -29878.75064985404, -29764.403593913165, -29670.755210090556, -29568.779574730706, -29786.3891216829, -30057.63277585619, -29860.83813594021, -29741.915640969215, -29777.885634214686, -29976.21027442633, -29953.744760234193, -30108.26842092144, -29790.5915650707, -29783.214302088596, -29608.115626567964, -29991.074675852167, -29748.50214140118, -29968.645502783616, -29845.28743018343, -29833.87470671902, -29850.51406418121, -30097.885287719044], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.430967811385675, "mean_inference_ms": 0.2513277592862107, "mean_action_processing_ms": 0.05928242314047861, "mean_env_wait_ms": 1.712396205110885, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0025112578209410324, "StateBufferConnector_ms": 0.0017498401885337018, "ViewRequirementAgentConnector_ms": 0.044936829424918966}}, "episode_reward_max": -8444.236095312468, "episode_reward_min": -30145.7689349501, "episode_reward_mean": -29360.898646009606, "episode_len_mean": 360.0, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-8913.826131798241, -8444.236095312468, -24931.07637817849, -29874.66400259338, -30134.70637972163, -29762.082259138468, -29984.42375117467, -29884.054884107227, -29732.63462021125, -29734.74741394928, -29599.58056175506, -29832.797365967963, -29766.292425560343, -30084.192366059553, -29681.35111266077, -29821.739926135935, -29806.54303736546, -29871.84153731382, -29891.674793035487, -29892.823880389962, -29875.158047759254, -29994.204920873275, -29981.235816298202, -29745.265375235438, -29826.982526647404, -29962.08693607791, -29971.522223064138, -29866.98890678254, -29846.907193765634, -29951.164493724882, -29817.127153326233, -29832.47065890343, -30013.566140807965, -29670.92799848734, -30105.278329191522, -29856.88333937987, -29919.502939343452, -29953.62872535819, -29765.037883982135, -29902.414857735148, -30145.7689349501, -29804.63900864462, -29751.998564301775, -30018.118508833555, -29713.869352751786, -29887.37659015742, -29734.729943288814, -29826.223158529236, -30042.544949823463, -30039.39342858763, -29770.50066907107, -29719.259510635333, -30009.326254365078, -29902.54622393914, -30032.460224054972, -30002.91322499981, -29649.34458979476, -29795.43580966862, -29665.501927624326, -29790.23442502846, -29913.554637842444, -30071.141023532444, -29897.82976172966, -29922.445482547326, -29557.448431599172, -29601.797781076402, -29871.040267777982, -29773.356675876406, -29955.530000449162, -29984.44880312825, -29881.368547199767, -30025.403528519793, -29878.75064985404, -29764.403593913165, -29670.755210090556, -29568.779574730706, -29786.3891216829, -30057.63277585619, -29860.83813594021, -29741.915640969215, -29777.885634214686, -29976.21027442633, -29953.744760234193, -30108.26842092144, -29790.5915650707, -29783.214302088596, -29608.115626567964, -29991.074675852167, -29748.50214140118, -29968.645502783616, -29845.28743018343, -29833.87470671902, -29850.51406418121, -30097.885287719044], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.430967811385675, "mean_inference_ms": 0.2513277592862107, "mean_action_processing_ms": 0.05928242314047861, "mean_env_wait_ms": 1.712396205110885, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0025112578209410324, "StateBufferConnector_ms": 0.0017498401885337018, "ViewRequirementAgentConnector_ms": 0.044936829424918966}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 33840, "num_agent_steps_trained": 33840, "num_env_steps_sampled": 33840, "num_env_steps_trained": 33840, "num_env_steps_sampled_this_iter": 1800, "num_env_steps_trained_this_iter": 1800, "num_env_steps_sampled_throughput_per_sec": 161.5708447782289, "num_env_steps_trained_throughput_per_sec": 161.5708447782289, "timesteps_total": 33840, "num_steps_trained_this_iter": 1800, "agent_timesteps_total": 33840, "timers": {"training_iteration_time_ms": 2234.572, "sample_time_ms": 2229.156, "load_time_ms": 0.216, "load_throughput": 1665140.538, "learn_time_ms": 4.62, "learn_throughput": 77927.646, "synch_weights_time_ms": 0.546}, "counters": {"num_env_steps_sampled": 33840, "num_env_steps_trained": 33840, "num_agent_steps_sampled": 33840, "num_agent_steps_trained": 33840}, "done": false, "episodes_total": 94, "training_iteration": 19, "trial_id": "4935e_00000", "date": "2023-07-25_15-50-11", "timestamp": 1690289411, "time_this_iter_s": 11.142713785171509, "time_total_s": 212.88952326774597, "pid": 67353, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[0, 0.003], [5400, 0.001], [10800, 0.00075], [16200, 0.0005], [21600, 0.00025], [27000, 0.0001], [32400, 7.5e-05], [37800, 5e-05], [43200, 2.5e-05], [48600, 1e-05], [54000, 7.5e-06], [59400, 5e-06], [64800, 2.5e-06], [70200, 1e-06], [75600, 5e-07], [81000, 1e-07]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x177531310>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 212.88952326774597, "iterations_since_restore": 19, "perf": {"cpu_util_percent": 28.486666666666665, "ram_util_percent": 79.28000000000002}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 6.166666666666667e-05, "entropy_coeff": 0.10000000000000002, "policy_entropy": -1859.4760335286458, "policy_loss": -6.238861793209207e+16, "vf_loss": 2479061077.3333335}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 120.0, "num_grad_updates_lifetime": 296.0, "diff_num_grad_updates_vs_sampler_policy": 295.0}}, "num_env_steps_sampled": 35640, "num_env_steps_trained": 35640, "num_agent_steps_sampled": 35640, "num_agent_steps_trained": 35640}, "sampler_results": {"episode_reward_max": -8444.236095312468, "episode_reward_min": -30145.7689349501, "episode_reward_mean": -29387.009191800757, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-8913.826131798241, -8444.236095312468, -24931.07637817849, -29874.66400259338, -30134.70637972163, -29762.082259138468, -29984.42375117467, -29884.054884107227, -29732.63462021125, -29734.74741394928, -29599.58056175506, -29832.797365967963, -29766.292425560343, -30084.192366059553, -29681.35111266077, -29821.739926135935, -29806.54303736546, -29871.84153731382, -29891.674793035487, -29892.823880389962, -29875.158047759254, -29994.204920873275, -29981.235816298202, -29745.265375235438, -29826.982526647404, -29962.08693607791, -29971.522223064138, -29866.98890678254, -29846.907193765634, -29951.164493724882, -29817.127153326233, -29832.47065890343, -30013.566140807965, -29670.92799848734, -30105.278329191522, -29856.88333937987, -29919.502939343452, -29953.62872535819, -29765.037883982135, -29902.414857735148, -30145.7689349501, -29804.63900864462, -29751.998564301775, -30018.118508833555, -29713.869352751786, -29887.37659015742, -29734.729943288814, -29826.223158529236, -30042.544949823463, -30039.39342858763, -29770.50066907107, -29719.259510635333, -30009.326254365078, -29902.54622393914, -30032.460224054972, -30002.91322499981, -29649.34458979476, -29795.43580966862, -29665.501927624326, -29790.23442502846, -29913.554637842444, -30071.141023532444, -29897.82976172966, -29922.445482547326, -29557.448431599172, -29601.797781076402, -29871.040267777982, -29773.356675876406, -29955.530000449162, -29984.44880312825, -29881.368547199767, -30025.403528519793, -29878.75064985404, -29764.403593913165, -29670.755210090556, -29568.779574730706, -29786.3891216829, -30057.63277585619, -29860.83813594021, -29741.915640969215, -29777.885634214686, -29976.21027442633, -29953.744760234193, -30108.26842092144, -29790.5915650707, -29783.214302088596, -29608.115626567964, -29991.074675852167, -29748.50214140118, -29968.645502783616, -29845.28743018343, -29833.87470671902, -29850.51406418121, -30097.885287719044, -29901.15529115687, -29759.689998074, -29891.947840988094, -30032.599978584898, -29804.044154568222], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.430246969417387, "mean_inference_ms": 0.25124393988243215, "mean_action_processing_ms": 0.05926675654044394, "mean_env_wait_ms": 1.7028612323813217, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002516158903488005, "StateBufferConnector_ms": 0.0017537011040581597, "ViewRequirementAgentConnector_ms": 0.0450208933666499}}, "episode_reward_max": -8444.236095312468, "episode_reward_min": -30145.7689349501, "episode_reward_mean": -29387.009191800757, "episode_len_mean": 360.0, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-8913.826131798241, -8444.236095312468, -24931.07637817849, -29874.66400259338, -30134.70637972163, -29762.082259138468, -29984.42375117467, -29884.054884107227, -29732.63462021125, -29734.74741394928, -29599.58056175506, -29832.797365967963, -29766.292425560343, -30084.192366059553, -29681.35111266077, -29821.739926135935, -29806.54303736546, -29871.84153731382, -29891.674793035487, -29892.823880389962, -29875.158047759254, -29994.204920873275, -29981.235816298202, -29745.265375235438, -29826.982526647404, -29962.08693607791, -29971.522223064138, -29866.98890678254, -29846.907193765634, -29951.164493724882, -29817.127153326233, -29832.47065890343, -30013.566140807965, -29670.92799848734, -30105.278329191522, -29856.88333937987, -29919.502939343452, -29953.62872535819, -29765.037883982135, -29902.414857735148, -30145.7689349501, -29804.63900864462, -29751.998564301775, -30018.118508833555, -29713.869352751786, -29887.37659015742, -29734.729943288814, -29826.223158529236, -30042.544949823463, -30039.39342858763, -29770.50066907107, -29719.259510635333, -30009.326254365078, -29902.54622393914, -30032.460224054972, -30002.91322499981, -29649.34458979476, -29795.43580966862, -29665.501927624326, -29790.23442502846, -29913.554637842444, -30071.141023532444, -29897.82976172966, -29922.445482547326, -29557.448431599172, -29601.797781076402, -29871.040267777982, -29773.356675876406, -29955.530000449162, -29984.44880312825, -29881.368547199767, -30025.403528519793, -29878.75064985404, -29764.403593913165, -29670.755210090556, -29568.779574730706, -29786.3891216829, -30057.63277585619, -29860.83813594021, -29741.915640969215, -29777.885634214686, -29976.21027442633, -29953.744760234193, -30108.26842092144, -29790.5915650707, -29783.214302088596, -29608.115626567964, -29991.074675852167, -29748.50214140118, -29968.645502783616, -29845.28743018343, -29833.87470671902, -29850.51406418121, -30097.885287719044, -29901.15529115687, -29759.689998074, -29891.947840988094, -30032.599978584898, -29804.044154568222], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.430246969417387, "mean_inference_ms": 0.25124393988243215, "mean_action_processing_ms": 0.05926675654044394, "mean_env_wait_ms": 1.7028612323813217, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002516158903488005, "StateBufferConnector_ms": 0.0017537011040581597, "ViewRequirementAgentConnector_ms": 0.0450208933666499}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 35640, "num_agent_steps_trained": 35640, "num_env_steps_sampled": 35640, "num_env_steps_trained": 35640, "num_env_steps_sampled_this_iter": 1800, "num_env_steps_trained_this_iter": 1800, "num_env_steps_sampled_throughput_per_sec": 161.77322071997364, "num_env_steps_trained_throughput_per_sec": 161.77322071997364, "timesteps_total": 35640, "num_steps_trained_this_iter": 1800, "agent_timesteps_total": 35640, "timers": {"training_iteration_time_ms": 2226.721, "sample_time_ms": 2221.245, "load_time_ms": 0.224, "load_throughput": 1607184.077, "learn_time_ms": 4.663, "learn_throughput": 77204.463, "synch_weights_time_ms": 0.548}, "counters": {"num_env_steps_sampled": 35640, "num_env_steps_trained": 35640, "num_agent_steps_sampled": 35640, "num_agent_steps_trained": 35640}, "done": false, "episodes_total": 99, "training_iteration": 20, "trial_id": "4935e_00000", "date": "2023-07-25_15-50-22", "timestamp": 1690289422, "time_this_iter_s": 11.128893852233887, "time_total_s": 224.01841711997986, "pid": 67353, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[0, 0.003], [5400, 0.001], [10800, 0.00075], [16200, 0.0005], [21600, 0.00025], [27000, 0.0001], [32400, 7.5e-05], [37800, 5e-05], [43200, 2.5e-05], [48600, 1e-05], [54000, 7.5e-06], [59400, 5e-06], [64800, 2.5e-06], [70200, 1e-06], [75600, 5e-07], [81000, 1e-07]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x177531310>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 224.01841711997986, "iterations_since_restore": 20, "perf": {"cpu_util_percent": 26.262500000000003, "ram_util_percent": 78.43125}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 5.3333333333333326e-05, "entropy_coeff": 0.10000000000000002, "policy_entropy": -1859.4880777994792, "policy_loss": -8444595634154155.0, "vf_loss": 2481929045.3333335}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 120.0, "num_grad_updates_lifetime": 311.0, "diff_num_grad_updates_vs_sampler_policy": 310.0}}, "num_env_steps_sampled": 37440, "num_env_steps_trained": 37440, "num_agent_steps_sampled": 37440, "num_agent_steps_trained": 37440}, "sampler_results": {"episode_reward_max": -29557.448431599172, "episode_reward_min": -30145.7689349501, "episode_reward_mean": -29869.404764443887, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-30134.70637972163, -29762.082259138468, -29984.42375117467, -29884.054884107227, -29732.63462021125, -29734.74741394928, -29599.58056175506, -29832.797365967963, -29766.292425560343, -30084.192366059553, -29681.35111266077, -29821.739926135935, -29806.54303736546, -29871.84153731382, -29891.674793035487, -29892.823880389962, -29875.158047759254, -29994.204920873275, -29981.235816298202, -29745.265375235438, -29826.982526647404, -29962.08693607791, -29971.522223064138, -29866.98890678254, -29846.907193765634, -29951.164493724882, -29817.127153326233, -29832.47065890343, -30013.566140807965, -29670.92799848734, -30105.278329191522, -29856.88333937987, -29919.502939343452, -29953.62872535819, -29765.037883982135, -29902.414857735148, -30145.7689349501, -29804.63900864462, -29751.998564301775, -30018.118508833555, -29713.869352751786, -29887.37659015742, -29734.729943288814, -29826.223158529236, -30042.544949823463, -30039.39342858763, -29770.50066907107, -29719.259510635333, -30009.326254365078, -29902.54622393914, -30032.460224054972, -30002.91322499981, -29649.34458979476, -29795.43580966862, -29665.501927624326, -29790.23442502846, -29913.554637842444, -30071.141023532444, -29897.82976172966, -29922.445482547326, -29557.448431599172, -29601.797781076402, -29871.040267777982, -29773.356675876406, -29955.530000449162, -29984.44880312825, -29881.368547199767, -30025.403528519793, -29878.75064985404, -29764.403593913165, -29670.755210090556, -29568.779574730706, -29786.3891216829, -30057.63277585619, -29860.83813594021, -29741.915640969215, -29777.885634214686, -29976.21027442633, -29953.744760234193, -30108.26842092144, -29790.5915650707, -29783.214302088596, -29608.115626567964, -29991.074675852167, -29748.50214140118, -29968.645502783616, -29845.28743018343, -29833.87470671902, -29850.51406418121, -30097.885287719044, -29901.15529115687, -29759.689998074, -29891.947840988094, -30032.599978584898, -29804.044154568222, -29951.533957514817, -29937.63066043682, -29933.74484703228, -30139.950688976096, -29827.508910036497], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.427870534283492, "mean_inference_ms": 0.2506934932345781, "mean_action_processing_ms": 0.05916196526578437, "mean_env_wait_ms": 1.6382437598305324, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0025022029876708984, "StateBufferConnector_ms": 0.0017445087432861328, "ViewRequirementAgentConnector_ms": 0.04489946365356445}}, "episode_reward_max": -29557.448431599172, "episode_reward_min": -30145.7689349501, "episode_reward_mean": -29869.404764443887, "episode_len_mean": 360.0, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-30134.70637972163, -29762.082259138468, -29984.42375117467, -29884.054884107227, -29732.63462021125, -29734.74741394928, -29599.58056175506, -29832.797365967963, -29766.292425560343, -30084.192366059553, -29681.35111266077, -29821.739926135935, -29806.54303736546, -29871.84153731382, -29891.674793035487, -29892.823880389962, -29875.158047759254, -29994.204920873275, -29981.235816298202, -29745.265375235438, -29826.982526647404, -29962.08693607791, -29971.522223064138, -29866.98890678254, -29846.907193765634, -29951.164493724882, -29817.127153326233, -29832.47065890343, -30013.566140807965, -29670.92799848734, -30105.278329191522, -29856.88333937987, -29919.502939343452, -29953.62872535819, -29765.037883982135, -29902.414857735148, -30145.7689349501, -29804.63900864462, -29751.998564301775, -30018.118508833555, -29713.869352751786, -29887.37659015742, -29734.729943288814, -29826.223158529236, -30042.544949823463, -30039.39342858763, -29770.50066907107, -29719.259510635333, -30009.326254365078, -29902.54622393914, -30032.460224054972, -30002.91322499981, -29649.34458979476, -29795.43580966862, -29665.501927624326, -29790.23442502846, -29913.554637842444, -30071.141023532444, -29897.82976172966, -29922.445482547326, -29557.448431599172, -29601.797781076402, -29871.040267777982, -29773.356675876406, -29955.530000449162, -29984.44880312825, -29881.368547199767, -30025.403528519793, -29878.75064985404, -29764.403593913165, -29670.755210090556, -29568.779574730706, -29786.3891216829, -30057.63277585619, -29860.83813594021, -29741.915640969215, -29777.885634214686, -29976.21027442633, -29953.744760234193, -30108.26842092144, -29790.5915650707, -29783.214302088596, -29608.115626567964, -29991.074675852167, -29748.50214140118, -29968.645502783616, -29845.28743018343, -29833.87470671902, -29850.51406418121, -30097.885287719044, -29901.15529115687, -29759.689998074, -29891.947840988094, -30032.599978584898, -29804.044154568222, -29951.533957514817, -29937.63066043682, -29933.74484703228, -30139.950688976096, -29827.508910036497], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.427870534283492, "mean_inference_ms": 0.2506934932345781, "mean_action_processing_ms": 0.05916196526578437, "mean_env_wait_ms": 1.6382437598305324, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0025022029876708984, "StateBufferConnector_ms": 0.0017445087432861328, "ViewRequirementAgentConnector_ms": 0.04489946365356445}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 37440, "num_agent_steps_trained": 37440, "num_env_steps_sampled": 37440, "num_env_steps_trained": 37440, "num_env_steps_sampled_this_iter": 1800, "num_env_steps_trained_this_iter": 1800, "num_env_steps_sampled_throughput_per_sec": 161.9637337971043, "num_env_steps_trained_throughput_per_sec": 161.9637337971043, "timesteps_total": 37440, "num_steps_trained_this_iter": 1800, "agent_timesteps_total": 37440, "timers": {"training_iteration_time_ms": 2224.018, "sample_time_ms": 2218.453, "load_time_ms": 0.223, "load_throughput": 1613538.619, "learn_time_ms": 4.746, "learn_throughput": 75854.367, "synch_weights_time_ms": 0.557}, "counters": {"num_env_steps_sampled": 37440, "num_env_steps_trained": 37440, "num_agent_steps_sampled": 37440, "num_agent_steps_trained": 37440}, "done": false, "episodes_total": 104, "training_iteration": 21, "trial_id": "4935e_00000", "date": "2023-07-25_15-50-33", "timestamp": 1690289433, "time_this_iter_s": 11.115731954574585, "time_total_s": 235.13414907455444, "pid": 67353, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[0, 0.003], [5400, 0.001], [10800, 0.00075], [16200, 0.0005], [21600, 0.00025], [27000, 0.0001], [32400, 7.5e-05], [37800, 5e-05], [43200, 2.5e-05], [48600, 1e-05], [54000, 7.5e-06], [59400, 5e-06], [64800, 2.5e-06], [70200, 1e-06], [75600, 5e-07], [81000, 1e-07]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x177531310>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 235.13414907455444, "iterations_since_restore": 21, "perf": {"cpu_util_percent": 24.20625, "ram_util_percent": 79.01875}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 4.5e-05, "entropy_coeff": 0.10000000000000002, "policy_entropy": -1859.5406494140625, "policy_loss": -2.6646108956524544e+16, "vf_loss": 2526880042.6666665}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 120.0, "num_grad_updates_lifetime": 326.0, "diff_num_grad_updates_vs_sampler_policy": 325.0}}, "num_env_steps_sampled": 39240, "num_env_steps_trained": 39240, "num_agent_steps_sampled": 39240, "num_agent_steps_trained": 39240}, "sampler_results": {"episode_reward_max": -29557.448431599172, "episode_reward_min": -30151.916052284887, "episode_reward_mean": -29873.956866698274, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-29734.74741394928, -29599.58056175506, -29832.797365967963, -29766.292425560343, -30084.192366059553, -29681.35111266077, -29821.739926135935, -29806.54303736546, -29871.84153731382, -29891.674793035487, -29892.823880389962, -29875.158047759254, -29994.204920873275, -29981.235816298202, -29745.265375235438, -29826.982526647404, -29962.08693607791, -29971.522223064138, -29866.98890678254, -29846.907193765634, -29951.164493724882, -29817.127153326233, -29832.47065890343, -30013.566140807965, -29670.92799848734, -30105.278329191522, -29856.88333937987, -29919.502939343452, -29953.62872535819, -29765.037883982135, -29902.414857735148, -30145.7689349501, -29804.63900864462, -29751.998564301775, -30018.118508833555, -29713.869352751786, -29887.37659015742, -29734.729943288814, -29826.223158529236, -30042.544949823463, -30039.39342858763, -29770.50066907107, -29719.259510635333, -30009.326254365078, -29902.54622393914, -30032.460224054972, -30002.91322499981, -29649.34458979476, -29795.43580966862, -29665.501927624326, -29790.23442502846, -29913.554637842444, -30071.141023532444, -29897.82976172966, -29922.445482547326, -29557.448431599172, -29601.797781076402, -29871.040267777982, -29773.356675876406, -29955.530000449162, -29984.44880312825, -29881.368547199767, -30025.403528519793, -29878.75064985404, -29764.403593913165, -29670.755210090556, -29568.779574730706, -29786.3891216829, -30057.63277585619, -29860.83813594021, -29741.915640969215, -29777.885634214686, -29976.21027442633, -29953.744760234193, -30108.26842092144, -29790.5915650707, -29783.214302088596, -29608.115626567964, -29991.074675852167, -29748.50214140118, -29968.645502783616, -29845.28743018343, -29833.87470671902, -29850.51406418121, -30097.885287719044, -29901.15529115687, -29759.689998074, -29891.947840988094, -30032.599978584898, -29804.044154568222, -29951.533957514817, -29937.63066043682, -29933.74484703228, -30139.950688976096, -29827.508910036497, -29855.852268362603, -30151.916052284887, -29945.921846470832, -29876.126214447297, -30123.29573822629], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.426298099110633, "mean_inference_ms": 0.25040852957895476, "mean_action_processing_ms": 0.05910779199674412, "mean_env_wait_ms": 1.6052152249653042, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0025131702423095703, "StateBufferConnector_ms": 0.001743316650390625, "ViewRequirementAgentConnector_ms": 0.045006513595581055}}, "episode_reward_max": -29557.448431599172, "episode_reward_min": -30151.916052284887, "episode_reward_mean": -29873.956866698274, "episode_len_mean": 360.0, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-29734.74741394928, -29599.58056175506, -29832.797365967963, -29766.292425560343, -30084.192366059553, -29681.35111266077, -29821.739926135935, -29806.54303736546, -29871.84153731382, -29891.674793035487, -29892.823880389962, -29875.158047759254, -29994.204920873275, -29981.235816298202, -29745.265375235438, -29826.982526647404, -29962.08693607791, -29971.522223064138, -29866.98890678254, -29846.907193765634, -29951.164493724882, -29817.127153326233, -29832.47065890343, -30013.566140807965, -29670.92799848734, -30105.278329191522, -29856.88333937987, -29919.502939343452, -29953.62872535819, -29765.037883982135, -29902.414857735148, -30145.7689349501, -29804.63900864462, -29751.998564301775, -30018.118508833555, -29713.869352751786, -29887.37659015742, -29734.729943288814, -29826.223158529236, -30042.544949823463, -30039.39342858763, -29770.50066907107, -29719.259510635333, -30009.326254365078, -29902.54622393914, -30032.460224054972, -30002.91322499981, -29649.34458979476, -29795.43580966862, -29665.501927624326, -29790.23442502846, -29913.554637842444, -30071.141023532444, -29897.82976172966, -29922.445482547326, -29557.448431599172, -29601.797781076402, -29871.040267777982, -29773.356675876406, -29955.530000449162, -29984.44880312825, -29881.368547199767, -30025.403528519793, -29878.75064985404, -29764.403593913165, -29670.755210090556, -29568.779574730706, -29786.3891216829, -30057.63277585619, -29860.83813594021, -29741.915640969215, -29777.885634214686, -29976.21027442633, -29953.744760234193, -30108.26842092144, -29790.5915650707, -29783.214302088596, -29608.115626567964, -29991.074675852167, -29748.50214140118, -29968.645502783616, -29845.28743018343, -29833.87470671902, -29850.51406418121, -30097.885287719044, -29901.15529115687, -29759.689998074, -29891.947840988094, -30032.599978584898, -29804.044154568222, -29951.533957514817, -29937.63066043682, -29933.74484703228, -30139.950688976096, -29827.508910036497, -29855.852268362603, -30151.916052284887, -29945.921846470832, -29876.126214447297, -30123.29573822629], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.426298099110633, "mean_inference_ms": 0.25040852957895476, "mean_action_processing_ms": 0.05910779199674412, "mean_env_wait_ms": 1.6052152249653042, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0025131702423095703, "StateBufferConnector_ms": 0.001743316650390625, "ViewRequirementAgentConnector_ms": 0.045006513595581055}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 39240, "num_agent_steps_trained": 39240, "num_env_steps_sampled": 39240, "num_env_steps_trained": 39240, "num_env_steps_sampled_this_iter": 1800, "num_env_steps_trained_this_iter": 1800, "num_env_steps_sampled_throughput_per_sec": 161.40726880392438, "num_env_steps_trained_throughput_per_sec": 161.40726880392438, "timesteps_total": 39240, "num_steps_trained_this_iter": 1800, "agent_timesteps_total": 39240, "timers": {"training_iteration_time_ms": 2226.542, "sample_time_ms": 2221.058, "load_time_ms": 0.216, "load_throughput": 1669005.681, "learn_time_ms": 4.693, "learn_throughput": 76704.416, "synch_weights_time_ms": 0.542}, "counters": {"num_env_steps_sampled": 39240, "num_env_steps_trained": 39240, "num_agent_steps_sampled": 39240, "num_agent_steps_trained": 39240}, "done": false, "episodes_total": 109, "training_iteration": 22, "trial_id": "4935e_00000", "date": "2023-07-25_15-50-44", "timestamp": 1690289444, "time_this_iter_s": 11.153971910476685, "time_total_s": 246.28812098503113, "pid": 67353, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[0, 0.003], [5400, 0.001], [10800, 0.00075], [16200, 0.0005], [21600, 0.00025], [27000, 0.0001], [32400, 7.5e-05], [37800, 5e-05], [43200, 2.5e-05], [48600, 1e-05], [54000, 7.5e-06], [59400, 5e-06], [64800, 2.5e-06], [70200, 1e-06], [75600, 5e-07], [81000, 1e-07]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x177531310>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 246.28812098503113, "iterations_since_restore": 22, "perf": {"cpu_util_percent": 24.36875, "ram_util_percent": 79.0375}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 3.666666666666667e-05, "entropy_coeff": 0.10000000000000002, "policy_entropy": -1859.598388671875, "policy_loss": -8.522617427828736e+16, "vf_loss": 2525908608.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 120.0, "num_grad_updates_lifetime": 341.0, "diff_num_grad_updates_vs_sampler_policy": 340.0}}, "num_env_steps_sampled": 41040, "num_env_steps_trained": 41040, "num_agent_steps_sampled": 41040, "num_agent_steps_trained": 41040}, "sampler_results": {"episode_reward_max": -29557.448431599172, "episode_reward_min": -30151.916052284887, "episode_reward_mean": -29883.47215323667, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-29681.35111266077, -29821.739926135935, -29806.54303736546, -29871.84153731382, -29891.674793035487, -29892.823880389962, -29875.158047759254, -29994.204920873275, -29981.235816298202, -29745.265375235438, -29826.982526647404, -29962.08693607791, -29971.522223064138, -29866.98890678254, -29846.907193765634, -29951.164493724882, -29817.127153326233, -29832.47065890343, -30013.566140807965, -29670.92799848734, -30105.278329191522, -29856.88333937987, -29919.502939343452, -29953.62872535819, -29765.037883982135, -29902.414857735148, -30145.7689349501, -29804.63900864462, -29751.998564301775, -30018.118508833555, -29713.869352751786, -29887.37659015742, -29734.729943288814, -29826.223158529236, -30042.544949823463, -30039.39342858763, -29770.50066907107, -29719.259510635333, -30009.326254365078, -29902.54622393914, -30032.460224054972, -30002.91322499981, -29649.34458979476, -29795.43580966862, -29665.501927624326, -29790.23442502846, -29913.554637842444, -30071.141023532444, -29897.82976172966, -29922.445482547326, -29557.448431599172, -29601.797781076402, -29871.040267777982, -29773.356675876406, -29955.530000449162, -29984.44880312825, -29881.368547199767, -30025.403528519793, -29878.75064985404, -29764.403593913165, -29670.755210090556, -29568.779574730706, -29786.3891216829, -30057.63277585619, -29860.83813594021, -29741.915640969215, -29777.885634214686, -29976.21027442633, -29953.744760234193, -30108.26842092144, -29790.5915650707, -29783.214302088596, -29608.115626567964, -29991.074675852167, -29748.50214140118, -29968.645502783616, -29845.28743018343, -29833.87470671902, -29850.51406418121, -30097.885287719044, -29901.15529115687, -29759.689998074, -29891.947840988094, -30032.599978584898, -29804.044154568222, -29951.533957514817, -29937.63066043682, -29933.74484703228, -30139.950688976096, -29827.508910036497, -29855.852268362603, -30151.916052284887, -29945.921846470832, -29876.126214447297, -30123.29573822629, -29949.21956200145, -30018.650957774873, -30042.397093530824, -29927.452749041655, -30031.418424782692], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.425252099615336, "mean_inference_ms": 0.250194882645156, "mean_action_processing_ms": 0.05906873411092544, "mean_env_wait_ms": 1.5846100769347384, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0025091171264648438, "StateBufferConnector_ms": 0.0017464160919189453, "ViewRequirementAgentConnector_ms": 0.04498767852783203}}, "episode_reward_max": -29557.448431599172, "episode_reward_min": -30151.916052284887, "episode_reward_mean": -29883.47215323667, "episode_len_mean": 360.0, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-29681.35111266077, -29821.739926135935, -29806.54303736546, -29871.84153731382, -29891.674793035487, -29892.823880389962, -29875.158047759254, -29994.204920873275, -29981.235816298202, -29745.265375235438, -29826.982526647404, -29962.08693607791, -29971.522223064138, -29866.98890678254, -29846.907193765634, -29951.164493724882, -29817.127153326233, -29832.47065890343, -30013.566140807965, -29670.92799848734, -30105.278329191522, -29856.88333937987, -29919.502939343452, -29953.62872535819, -29765.037883982135, -29902.414857735148, -30145.7689349501, -29804.63900864462, -29751.998564301775, -30018.118508833555, -29713.869352751786, -29887.37659015742, -29734.729943288814, -29826.223158529236, -30042.544949823463, -30039.39342858763, -29770.50066907107, -29719.259510635333, -30009.326254365078, -29902.54622393914, -30032.460224054972, -30002.91322499981, -29649.34458979476, -29795.43580966862, -29665.501927624326, -29790.23442502846, -29913.554637842444, -30071.141023532444, -29897.82976172966, -29922.445482547326, -29557.448431599172, -29601.797781076402, -29871.040267777982, -29773.356675876406, -29955.530000449162, -29984.44880312825, -29881.368547199767, -30025.403528519793, -29878.75064985404, -29764.403593913165, -29670.755210090556, -29568.779574730706, -29786.3891216829, -30057.63277585619, -29860.83813594021, -29741.915640969215, -29777.885634214686, -29976.21027442633, -29953.744760234193, -30108.26842092144, -29790.5915650707, -29783.214302088596, -29608.115626567964, -29991.074675852167, -29748.50214140118, -29968.645502783616, -29845.28743018343, -29833.87470671902, -29850.51406418121, -30097.885287719044, -29901.15529115687, -29759.689998074, -29891.947840988094, -30032.599978584898, -29804.044154568222, -29951.533957514817, -29937.63066043682, -29933.74484703228, -30139.950688976096, -29827.508910036497, -29855.852268362603, -30151.916052284887, -29945.921846470832, -29876.126214447297, -30123.29573822629, -29949.21956200145, -30018.650957774873, -30042.397093530824, -29927.452749041655, -30031.418424782692], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.425252099615336, "mean_inference_ms": 0.250194882645156, "mean_action_processing_ms": 0.05906873411092544, "mean_env_wait_ms": 1.5846100769347384, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0025091171264648438, "StateBufferConnector_ms": 0.0017464160919189453, "ViewRequirementAgentConnector_ms": 0.04498767852783203}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 41040, "num_agent_steps_trained": 41040, "num_env_steps_sampled": 41040, "num_env_steps_trained": 41040, "num_env_steps_sampled_this_iter": 1800, "num_env_steps_trained_this_iter": 1800, "num_env_steps_sampled_throughput_per_sec": 161.6617275035463, "num_env_steps_trained_throughput_per_sec": 161.6617275035463, "timesteps_total": 41040, "num_steps_trained_this_iter": 1800, "agent_timesteps_total": 41040, "timers": {"training_iteration_time_ms": 2228.618, "sample_time_ms": 2223.295, "load_time_ms": 0.216, "load_throughput": 1669743.935, "learn_time_ms": 4.572, "learn_throughput": 78741.216, "synch_weights_time_ms": 0.504}, "counters": {"num_env_steps_sampled": 41040, "num_env_steps_trained": 41040, "num_agent_steps_sampled": 41040, "num_agent_steps_trained": 41040}, "done": false, "episodes_total": 114, "training_iteration": 23, "trial_id": "4935e_00000", "date": "2023-07-25_15-50-56", "timestamp": 1690289456, "time_this_iter_s": 11.13650918006897, "time_total_s": 257.4246301651001, "pid": 67353, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[0, 0.003], [5400, 0.001], [10800, 0.00075], [16200, 0.0005], [21600, 0.00025], [27000, 0.0001], [32400, 7.5e-05], [37800, 5e-05], [43200, 2.5e-05], [48600, 1e-05], [54000, 7.5e-06], [59400, 5e-06], [64800, 2.5e-06], [70200, 1e-06], [75600, 5e-07], [81000, 1e-07]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x177531310>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 257.4246301651001, "iterations_since_restore": 23, "perf": {"cpu_util_percent": 24.63125, "ram_util_percent": 79.075}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 2.8333333333333335e-05, "entropy_coeff": 0.10000000000000002, "policy_entropy": -1859.7220865885417, "policy_loss": -4.017135732065417e+16, "vf_loss": 2496294933.3333335}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 120.0, "num_grad_updates_lifetime": 356.0, "diff_num_grad_updates_vs_sampler_policy": 355.0}}, "num_env_steps_sampled": 42840, "num_env_steps_trained": 42840, "num_agent_steps_sampled": 42840, "num_agent_steps_trained": 42840}, "sampler_results": {"episode_reward_max": -29557.448431599172, "episode_reward_min": -30151.916052284887, "episode_reward_mean": -29887.53667451973, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-29892.823880389962, -29875.158047759254, -29994.204920873275, -29981.235816298202, -29745.265375235438, -29826.982526647404, -29962.08693607791, -29971.522223064138, -29866.98890678254, -29846.907193765634, -29951.164493724882, -29817.127153326233, -29832.47065890343, -30013.566140807965, -29670.92799848734, -30105.278329191522, -29856.88333937987, -29919.502939343452, -29953.62872535819, -29765.037883982135, -29902.414857735148, -30145.7689349501, -29804.63900864462, -29751.998564301775, -30018.118508833555, -29713.869352751786, -29887.37659015742, -29734.729943288814, -29826.223158529236, -30042.544949823463, -30039.39342858763, -29770.50066907107, -29719.259510635333, -30009.326254365078, -29902.54622393914, -30032.460224054972, -30002.91322499981, -29649.34458979476, -29795.43580966862, -29665.501927624326, -29790.23442502846, -29913.554637842444, -30071.141023532444, -29897.82976172966, -29922.445482547326, -29557.448431599172, -29601.797781076402, -29871.040267777982, -29773.356675876406, -29955.530000449162, -29984.44880312825, -29881.368547199767, -30025.403528519793, -29878.75064985404, -29764.403593913165, -29670.755210090556, -29568.779574730706, -29786.3891216829, -30057.63277585619, -29860.83813594021, -29741.915640969215, -29777.885634214686, -29976.21027442633, -29953.744760234193, -30108.26842092144, -29790.5915650707, -29783.214302088596, -29608.115626567964, -29991.074675852167, -29748.50214140118, -29968.645502783616, -29845.28743018343, -29833.87470671902, -29850.51406418121, -30097.885287719044, -29901.15529115687, -29759.689998074, -29891.947840988094, -30032.599978584898, -29804.044154568222, -29951.533957514817, -29937.63066043682, -29933.74484703228, -30139.950688976096, -29827.508910036497, -29855.852268362603, -30151.916052284887, -29945.921846470832, -29876.126214447297, -30123.29573822629, -29949.21956200145, -30018.650957774873, -30042.397093530824, -29927.452749041655, -30031.418424782692, -29806.615581414244, -29839.18189809488, -30007.78046845992, -29878.750381270766, -29947.274205578404], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.424586132006417, "mean_inference_ms": 0.2500536807234215, "mean_action_processing_ms": 0.05904327519119975, "mean_env_wait_ms": 1.5699850433243332, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002521991729736328, "StateBufferConnector_ms": 0.001760721206665039, "ViewRequirementAgentConnector_ms": 0.04510498046875}}, "episode_reward_max": -29557.448431599172, "episode_reward_min": -30151.916052284887, "episode_reward_mean": -29887.53667451973, "episode_len_mean": 360.0, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-29892.823880389962, -29875.158047759254, -29994.204920873275, -29981.235816298202, -29745.265375235438, -29826.982526647404, -29962.08693607791, -29971.522223064138, -29866.98890678254, -29846.907193765634, -29951.164493724882, -29817.127153326233, -29832.47065890343, -30013.566140807965, -29670.92799848734, -30105.278329191522, -29856.88333937987, -29919.502939343452, -29953.62872535819, -29765.037883982135, -29902.414857735148, -30145.7689349501, -29804.63900864462, -29751.998564301775, -30018.118508833555, -29713.869352751786, -29887.37659015742, -29734.729943288814, -29826.223158529236, -30042.544949823463, -30039.39342858763, -29770.50066907107, -29719.259510635333, -30009.326254365078, -29902.54622393914, -30032.460224054972, -30002.91322499981, -29649.34458979476, -29795.43580966862, -29665.501927624326, -29790.23442502846, -29913.554637842444, -30071.141023532444, -29897.82976172966, -29922.445482547326, -29557.448431599172, -29601.797781076402, -29871.040267777982, -29773.356675876406, -29955.530000449162, -29984.44880312825, -29881.368547199767, -30025.403528519793, -29878.75064985404, -29764.403593913165, -29670.755210090556, -29568.779574730706, -29786.3891216829, -30057.63277585619, -29860.83813594021, -29741.915640969215, -29777.885634214686, -29976.21027442633, -29953.744760234193, -30108.26842092144, -29790.5915650707, -29783.214302088596, -29608.115626567964, -29991.074675852167, -29748.50214140118, -29968.645502783616, -29845.28743018343, -29833.87470671902, -29850.51406418121, -30097.885287719044, -29901.15529115687, -29759.689998074, -29891.947840988094, -30032.599978584898, -29804.044154568222, -29951.533957514817, -29937.63066043682, -29933.74484703228, -30139.950688976096, -29827.508910036497, -29855.852268362603, -30151.916052284887, -29945.921846470832, -29876.126214447297, -30123.29573822629, -29949.21956200145, -30018.650957774873, -30042.397093530824, -29927.452749041655, -30031.418424782692, -29806.615581414244, -29839.18189809488, -30007.78046845992, -29878.750381270766, -29947.274205578404], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.424586132006417, "mean_inference_ms": 0.2500536807234215, "mean_action_processing_ms": 0.05904327519119975, "mean_env_wait_ms": 1.5699850433243332, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002521991729736328, "StateBufferConnector_ms": 0.001760721206665039, "ViewRequirementAgentConnector_ms": 0.04510498046875}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 42840, "num_agent_steps_trained": 42840, "num_env_steps_sampled": 42840, "num_env_steps_trained": 42840, "num_env_steps_sampled_this_iter": 1800, "num_env_steps_trained_this_iter": 1800, "num_env_steps_sampled_throughput_per_sec": 160.20063987763402, "num_env_steps_trained_throughput_per_sec": 160.20063987763402, "timesteps_total": 42840, "num_steps_trained_this_iter": 1800, "agent_timesteps_total": 42840, "timers": {"training_iteration_time_ms": 2237.018, "sample_time_ms": 2231.627, "load_time_ms": 0.217, "load_throughput": 1660927.775, "learn_time_ms": 4.636, "learn_throughput": 77647.931, "synch_weights_time_ms": 0.505}, "counters": {"num_env_steps_sampled": 42840, "num_env_steps_trained": 42840, "num_agent_steps_sampled": 42840, "num_agent_steps_trained": 42840}, "done": false, "episodes_total": 119, "training_iteration": 24, "trial_id": "4935e_00000", "date": "2023-07-25_15-51-07", "timestamp": 1690289467, "time_this_iter_s": 11.23808479309082, "time_total_s": 268.6627149581909, "pid": 67353, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[0, 0.003], [5400, 0.001], [10800, 0.00075], [16200, 0.0005], [21600, 0.00025], [27000, 0.0001], [32400, 7.5e-05], [37800, 5e-05], [43200, 2.5e-05], [48600, 1e-05], [54000, 7.5e-06], [59400, 5e-06], [64800, 2.5e-06], [70200, 1e-06], [75600, 5e-07], [81000, 1e-07]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x177531310>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 268.6627149581909, "iterations_since_restore": 24, "perf": {"cpu_util_percent": 25.86875, "ram_util_percent": 79.16874999999999}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 2.2000000000000003e-05, "entropy_coeff": 0.10000000000000002, "policy_entropy": -1859.7611897786458, "policy_loss": -1.0703058194804054e+16, "vf_loss": 2495668096.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 120.0, "num_grad_updates_lifetime": 371.0, "diff_num_grad_updates_vs_sampler_policy": 370.0}}, "num_env_steps_sampled": 44640, "num_env_steps_trained": 44640, "num_agent_steps_sampled": 44640, "num_agent_steps_trained": 44640}, "sampler_results": {"episode_reward_max": -29557.448431599172, "episode_reward_min": -30151.916052284887, "episode_reward_mean": -29889.977828903102, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-29826.982526647404, -29962.08693607791, -29971.522223064138, -29866.98890678254, -29846.907193765634, -29951.164493724882, -29817.127153326233, -29832.47065890343, -30013.566140807965, -29670.92799848734, -30105.278329191522, -29856.88333937987, -29919.502939343452, -29953.62872535819, -29765.037883982135, -29902.414857735148, -30145.7689349501, -29804.63900864462, -29751.998564301775, -30018.118508833555, -29713.869352751786, -29887.37659015742, -29734.729943288814, -29826.223158529236, -30042.544949823463, -30039.39342858763, -29770.50066907107, -29719.259510635333, -30009.326254365078, -29902.54622393914, -30032.460224054972, -30002.91322499981, -29649.34458979476, -29795.43580966862, -29665.501927624326, -29790.23442502846, -29913.554637842444, -30071.141023532444, -29897.82976172966, -29922.445482547326, -29557.448431599172, -29601.797781076402, -29871.040267777982, -29773.356675876406, -29955.530000449162, -29984.44880312825, -29881.368547199767, -30025.403528519793, -29878.75064985404, -29764.403593913165, -29670.755210090556, -29568.779574730706, -29786.3891216829, -30057.63277585619, -29860.83813594021, -29741.915640969215, -29777.885634214686, -29976.21027442633, -29953.744760234193, -30108.26842092144, -29790.5915650707, -29783.214302088596, -29608.115626567964, -29991.074675852167, -29748.50214140118, -29968.645502783616, -29845.28743018343, -29833.87470671902, -29850.51406418121, -30097.885287719044, -29901.15529115687, -29759.689998074, -29891.947840988094, -30032.599978584898, -29804.044154568222, -29951.533957514817, -29937.63066043682, -29933.74484703228, -30139.950688976096, -29827.508910036497, -29855.852268362603, -30151.916052284887, -29945.921846470832, -29876.126214447297, -30123.29573822629, -29949.21956200145, -30018.650957774873, -30042.397093530824, -29927.452749041655, -30031.418424782692, -29806.615581414244, -29839.18189809488, -30007.78046845992, -29878.750381270766, -29947.274205578404, -30133.13085219224, -29902.218624990124, -29872.130656927475, -29859.728693872108, -29965.594650911324], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.4241645407097225, "mean_inference_ms": 0.24993894837792716, "mean_action_processing_ms": 0.059022931487447236, "mean_env_wait_ms": 1.5588026253899832, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00252532958984375, "StateBufferConnector_ms": 0.0017523765563964844, "ViewRequirementAgentConnector_ms": 0.04515671730041504}}, "episode_reward_max": -29557.448431599172, "episode_reward_min": -30151.916052284887, "episode_reward_mean": -29889.977828903102, "episode_len_mean": 360.0, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-29826.982526647404, -29962.08693607791, -29971.522223064138, -29866.98890678254, -29846.907193765634, -29951.164493724882, -29817.127153326233, -29832.47065890343, -30013.566140807965, -29670.92799848734, -30105.278329191522, -29856.88333937987, -29919.502939343452, -29953.62872535819, -29765.037883982135, -29902.414857735148, -30145.7689349501, -29804.63900864462, -29751.998564301775, -30018.118508833555, -29713.869352751786, -29887.37659015742, -29734.729943288814, -29826.223158529236, -30042.544949823463, -30039.39342858763, -29770.50066907107, -29719.259510635333, -30009.326254365078, -29902.54622393914, -30032.460224054972, -30002.91322499981, -29649.34458979476, -29795.43580966862, -29665.501927624326, -29790.23442502846, -29913.554637842444, -30071.141023532444, -29897.82976172966, -29922.445482547326, -29557.448431599172, -29601.797781076402, -29871.040267777982, -29773.356675876406, -29955.530000449162, -29984.44880312825, -29881.368547199767, -30025.403528519793, -29878.75064985404, -29764.403593913165, -29670.755210090556, -29568.779574730706, -29786.3891216829, -30057.63277585619, -29860.83813594021, -29741.915640969215, -29777.885634214686, -29976.21027442633, -29953.744760234193, -30108.26842092144, -29790.5915650707, -29783.214302088596, -29608.115626567964, -29991.074675852167, -29748.50214140118, -29968.645502783616, -29845.28743018343, -29833.87470671902, -29850.51406418121, -30097.885287719044, -29901.15529115687, -29759.689998074, -29891.947840988094, -30032.599978584898, -29804.044154568222, -29951.533957514817, -29937.63066043682, -29933.74484703228, -30139.950688976096, -29827.508910036497, -29855.852268362603, -30151.916052284887, -29945.921846470832, -29876.126214447297, -30123.29573822629, -29949.21956200145, -30018.650957774873, -30042.397093530824, -29927.452749041655, -30031.418424782692, -29806.615581414244, -29839.18189809488, -30007.78046845992, -29878.750381270766, -29947.274205578404, -30133.13085219224, -29902.218624990124, -29872.130656927475, -29859.728693872108, -29965.594650911324], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.4241645407097225, "mean_inference_ms": 0.24993894837792716, "mean_action_processing_ms": 0.059022931487447236, "mean_env_wait_ms": 1.5588026253899832, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00252532958984375, "StateBufferConnector_ms": 0.0017523765563964844, "ViewRequirementAgentConnector_ms": 0.04515671730041504}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 44640, "num_agent_steps_trained": 44640, "num_env_steps_sampled": 44640, "num_env_steps_trained": 44640, "num_env_steps_sampled_this_iter": 1800, "num_env_steps_trained_this_iter": 1800, "num_env_steps_sampled_throughput_per_sec": 161.2106982916133, "num_env_steps_trained_throughput_per_sec": 161.2106982916133, "timesteps_total": 44640, "num_steps_trained_this_iter": 1800, "agent_timesteps_total": 44640, "timers": {"training_iteration_time_ms": 2240.133, "sample_time_ms": 2234.582, "load_time_ms": 0.237, "load_throughput": 1516013.494, "learn_time_ms": 4.754, "learn_throughput": 75719.709, "synch_weights_time_ms": 0.525}, "counters": {"num_env_steps_sampled": 44640, "num_env_steps_trained": 44640, "num_agent_steps_sampled": 44640, "num_agent_steps_trained": 44640}, "done": false, "episodes_total": 124, "training_iteration": 25, "trial_id": "4935e_00000", "date": "2023-07-25_15-51-18", "timestamp": 1690289478, "time_this_iter_s": 11.16764497756958, "time_total_s": 279.8303599357605, "pid": 67353, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[0, 0.003], [5400, 0.001], [10800, 0.00075], [16200, 0.0005], [21600, 0.00025], [27000, 0.0001], [32400, 7.5e-05], [37800, 5e-05], [43200, 2.5e-05], [48600, 1e-05], [54000, 7.5e-06], [59400, 5e-06], [64800, 2.5e-06], [70200, 1e-06], [75600, 5e-07], [81000, 1e-07]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x177531310>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 279.8303599357605, "iterations_since_restore": 25, "perf": {"cpu_util_percent": 31.65, "ram_util_percent": 79.0875}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1.7e-05, "entropy_coeff": 0.10000000000000002, "policy_entropy": -1859.7856038411458, "policy_loss": -6267504819787093.0, "vf_loss": 2525792533.3333335}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 120.0, "num_grad_updates_lifetime": 386.0, "diff_num_grad_updates_vs_sampler_policy": 385.0}}, "num_env_steps_sampled": 46440, "num_env_steps_trained": 46440, "num_agent_steps_sampled": 46440, "num_agent_steps_trained": 46440}, "sampler_results": {"episode_reward_max": -29557.448431599172, "episode_reward_min": -30151.916052284887, "episode_reward_mean": -29892.417278937402, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-29951.164493724882, -29817.127153326233, -29832.47065890343, -30013.566140807965, -29670.92799848734, -30105.278329191522, -29856.88333937987, -29919.502939343452, -29953.62872535819, -29765.037883982135, -29902.414857735148, -30145.7689349501, -29804.63900864462, -29751.998564301775, -30018.118508833555, -29713.869352751786, -29887.37659015742, -29734.729943288814, -29826.223158529236, -30042.544949823463, -30039.39342858763, -29770.50066907107, -29719.259510635333, -30009.326254365078, -29902.54622393914, -30032.460224054972, -30002.91322499981, -29649.34458979476, -29795.43580966862, -29665.501927624326, -29790.23442502846, -29913.554637842444, -30071.141023532444, -29897.82976172966, -29922.445482547326, -29557.448431599172, -29601.797781076402, -29871.040267777982, -29773.356675876406, -29955.530000449162, -29984.44880312825, -29881.368547199767, -30025.403528519793, -29878.75064985404, -29764.403593913165, -29670.755210090556, -29568.779574730706, -29786.3891216829, -30057.63277585619, -29860.83813594021, -29741.915640969215, -29777.885634214686, -29976.21027442633, -29953.744760234193, -30108.26842092144, -29790.5915650707, -29783.214302088596, -29608.115626567964, -29991.074675852167, -29748.50214140118, -29968.645502783616, -29845.28743018343, -29833.87470671902, -29850.51406418121, -30097.885287719044, -29901.15529115687, -29759.689998074, -29891.947840988094, -30032.599978584898, -29804.044154568222, -29951.533957514817, -29937.63066043682, -29933.74484703228, -30139.950688976096, -29827.508910036497, -29855.852268362603, -30151.916052284887, -29945.921846470832, -29876.126214447297, -30123.29573822629, -29949.21956200145, -30018.650957774873, -30042.397093530824, -29927.452749041655, -30031.418424782692, -29806.615581414244, -29839.18189809488, -30007.78046845992, -29878.750381270766, -29947.274205578404, -30133.13085219224, -29902.218624990124, -29872.130656927475, -29859.728693872108, -29965.594650911324, -30064.04298742653, -29778.414620080992, -29864.984283157333, -29902.234597104536, -30108.7563019982], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.423694617760873, "mean_inference_ms": 0.2498578434392683, "mean_action_processing_ms": 0.059009187413465114, "mean_env_wait_ms": 1.549926861275387, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0025212764739990234, "StateBufferConnector_ms": 0.0017516613006591797, "ViewRequirementAgentConnector_ms": 0.0451045036315918}}, "episode_reward_max": -29557.448431599172, "episode_reward_min": -30151.916052284887, "episode_reward_mean": -29892.417278937402, "episode_len_mean": 360.0, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-29951.164493724882, -29817.127153326233, -29832.47065890343, -30013.566140807965, -29670.92799848734, -30105.278329191522, -29856.88333937987, -29919.502939343452, -29953.62872535819, -29765.037883982135, -29902.414857735148, -30145.7689349501, -29804.63900864462, -29751.998564301775, -30018.118508833555, -29713.869352751786, -29887.37659015742, -29734.729943288814, -29826.223158529236, -30042.544949823463, -30039.39342858763, -29770.50066907107, -29719.259510635333, -30009.326254365078, -29902.54622393914, -30032.460224054972, -30002.91322499981, -29649.34458979476, -29795.43580966862, -29665.501927624326, -29790.23442502846, -29913.554637842444, -30071.141023532444, -29897.82976172966, -29922.445482547326, -29557.448431599172, -29601.797781076402, -29871.040267777982, -29773.356675876406, -29955.530000449162, -29984.44880312825, -29881.368547199767, -30025.403528519793, -29878.75064985404, -29764.403593913165, -29670.755210090556, -29568.779574730706, -29786.3891216829, -30057.63277585619, -29860.83813594021, -29741.915640969215, -29777.885634214686, -29976.21027442633, -29953.744760234193, -30108.26842092144, -29790.5915650707, -29783.214302088596, -29608.115626567964, -29991.074675852167, -29748.50214140118, -29968.645502783616, -29845.28743018343, -29833.87470671902, -29850.51406418121, -30097.885287719044, -29901.15529115687, -29759.689998074, -29891.947840988094, -30032.599978584898, -29804.044154568222, -29951.533957514817, -29937.63066043682, -29933.74484703228, -30139.950688976096, -29827.508910036497, -29855.852268362603, -30151.916052284887, -29945.921846470832, -29876.126214447297, -30123.29573822629, -29949.21956200145, -30018.650957774873, -30042.397093530824, -29927.452749041655, -30031.418424782692, -29806.615581414244, -29839.18189809488, -30007.78046845992, -29878.750381270766, -29947.274205578404, -30133.13085219224, -29902.218624990124, -29872.130656927475, -29859.728693872108, -29965.594650911324, -30064.04298742653, -29778.414620080992, -29864.984283157333, -29902.234597104536, -30108.7563019982], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.423694617760873, "mean_inference_ms": 0.2498578434392683, "mean_action_processing_ms": 0.059009187413465114, "mean_env_wait_ms": 1.549926861275387, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0025212764739990234, "StateBufferConnector_ms": 0.0017516613006591797, "ViewRequirementAgentConnector_ms": 0.0451045036315918}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 46440, "num_agent_steps_trained": 46440, "num_env_steps_sampled": 46440, "num_env_steps_trained": 46440, "num_env_steps_sampled_this_iter": 1800, "num_env_steps_trained_this_iter": 1800, "num_env_steps_sampled_throughput_per_sec": 161.54448027999013, "num_env_steps_trained_throughput_per_sec": 161.54448027999013, "timesteps_total": 46440, "num_steps_trained_this_iter": 1800, "agent_timesteps_total": 46440, "timers": {"training_iteration_time_ms": 2230.786, "sample_time_ms": 2225.216, "load_time_ms": 0.256, "load_throughput": 1404342.857, "learn_time_ms": 4.756, "learn_throughput": 75686.309, "synch_weights_time_ms": 0.524}, "counters": {"num_env_steps_sampled": 46440, "num_env_steps_trained": 46440, "num_agent_steps_sampled": 46440, "num_agent_steps_trained": 46440}, "done": false, "episodes_total": 129, "training_iteration": 26, "trial_id": "4935e_00000", "date": "2023-07-25_15-51-29", "timestamp": 1690289489, "time_this_iter_s": 11.144546747207642, "time_total_s": 290.97490668296814, "pid": 67353, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[0, 0.003], [5400, 0.001], [10800, 0.00075], [16200, 0.0005], [21600, 0.00025], [27000, 0.0001], [32400, 7.5e-05], [37800, 5e-05], [43200, 2.5e-05], [48600, 1e-05], [54000, 7.5e-06], [59400, 5e-06], [64800, 2.5e-06], [70200, 1e-06], [75600, 5e-07], [81000, 1e-07]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x177531310>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 290.97490668296814, "iterations_since_restore": 26, "perf": {"cpu_util_percent": 22.975, "ram_util_percent": 79.3125}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1.2e-05, "entropy_coeff": 0.10000000000000002, "policy_entropy": -1859.8148600260417, "policy_loss": -3714345758324053.5, "vf_loss": 2457754154.6666665}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 120.0, "num_grad_updates_lifetime": 401.0, "diff_num_grad_updates_vs_sampler_policy": 400.0}}, "num_env_steps_sampled": 48240, "num_env_steps_trained": 48240, "num_agent_steps_sampled": 48240, "num_agent_steps_trained": 48240}, "sampler_results": {"episode_reward_max": -29557.448431599172, "episode_reward_min": -30174.632069893127, "episode_reward_mean": -29900.195085311247, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-30105.278329191522, -29856.88333937987, -29919.502939343452, -29953.62872535819, -29765.037883982135, -29902.414857735148, -30145.7689349501, -29804.63900864462, -29751.998564301775, -30018.118508833555, -29713.869352751786, -29887.37659015742, -29734.729943288814, -29826.223158529236, -30042.544949823463, -30039.39342858763, -29770.50066907107, -29719.259510635333, -30009.326254365078, -29902.54622393914, -30032.460224054972, -30002.91322499981, -29649.34458979476, -29795.43580966862, -29665.501927624326, -29790.23442502846, -29913.554637842444, -30071.141023532444, -29897.82976172966, -29922.445482547326, -29557.448431599172, -29601.797781076402, -29871.040267777982, -29773.356675876406, -29955.530000449162, -29984.44880312825, -29881.368547199767, -30025.403528519793, -29878.75064985404, -29764.403593913165, -29670.755210090556, -29568.779574730706, -29786.3891216829, -30057.63277585619, -29860.83813594021, -29741.915640969215, -29777.885634214686, -29976.21027442633, -29953.744760234193, -30108.26842092144, -29790.5915650707, -29783.214302088596, -29608.115626567964, -29991.074675852167, -29748.50214140118, -29968.645502783616, -29845.28743018343, -29833.87470671902, -29850.51406418121, -30097.885287719044, -29901.15529115687, -29759.689998074, -29891.947840988094, -30032.599978584898, -29804.044154568222, -29951.533957514817, -29937.63066043682, -29933.74484703228, -30139.950688976096, -29827.508910036497, -29855.852268362603, -30151.916052284887, -29945.921846470832, -29876.126214447297, -30123.29573822629, -29949.21956200145, -30018.650957774873, -30042.397093530824, -29927.452749041655, -30031.418424782692, -29806.615581414244, -29839.18189809488, -30007.78046845992, -29878.750381270766, -29947.274205578404, -30133.13085219224, -29902.218624990124, -29872.130656927475, -29859.728693872108, -29965.594650911324, -30064.04298742653, -29778.414620080992, -29864.984283157333, -29902.234597104536, -30108.7563019982, -29884.052520364767, -30174.632069893127, -30143.83973854518, -30151.07561909289, -29709.437134738244], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.422811059751484, "mean_inference_ms": 0.24980269154474002, "mean_action_processing_ms": 0.058999131514939754, "mean_env_wait_ms": 1.5426016137370206, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0025196075439453125, "StateBufferConnector_ms": 0.0017533302307128906, "ViewRequirementAgentConnector_ms": 0.04516720771789551}}, "episode_reward_max": -29557.448431599172, "episode_reward_min": -30174.632069893127, "episode_reward_mean": -29900.195085311247, "episode_len_mean": 360.0, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-30105.278329191522, -29856.88333937987, -29919.502939343452, -29953.62872535819, -29765.037883982135, -29902.414857735148, -30145.7689349501, -29804.63900864462, -29751.998564301775, -30018.118508833555, -29713.869352751786, -29887.37659015742, -29734.729943288814, -29826.223158529236, -30042.544949823463, -30039.39342858763, -29770.50066907107, -29719.259510635333, -30009.326254365078, -29902.54622393914, -30032.460224054972, -30002.91322499981, -29649.34458979476, -29795.43580966862, -29665.501927624326, -29790.23442502846, -29913.554637842444, -30071.141023532444, -29897.82976172966, -29922.445482547326, -29557.448431599172, -29601.797781076402, -29871.040267777982, -29773.356675876406, -29955.530000449162, -29984.44880312825, -29881.368547199767, -30025.403528519793, -29878.75064985404, -29764.403593913165, -29670.755210090556, -29568.779574730706, -29786.3891216829, -30057.63277585619, -29860.83813594021, -29741.915640969215, -29777.885634214686, -29976.21027442633, -29953.744760234193, -30108.26842092144, -29790.5915650707, -29783.214302088596, -29608.115626567964, -29991.074675852167, -29748.50214140118, -29968.645502783616, -29845.28743018343, -29833.87470671902, -29850.51406418121, -30097.885287719044, -29901.15529115687, -29759.689998074, -29891.947840988094, -30032.599978584898, -29804.044154568222, -29951.533957514817, -29937.63066043682, -29933.74484703228, -30139.950688976096, -29827.508910036497, -29855.852268362603, -30151.916052284887, -29945.921846470832, -29876.126214447297, -30123.29573822629, -29949.21956200145, -30018.650957774873, -30042.397093530824, -29927.452749041655, -30031.418424782692, -29806.615581414244, -29839.18189809488, -30007.78046845992, -29878.750381270766, -29947.274205578404, -30133.13085219224, -29902.218624990124, -29872.130656927475, -29859.728693872108, -29965.594650911324, -30064.04298742653, -29778.414620080992, -29864.984283157333, -29902.234597104536, -30108.7563019982, -29884.052520364767, -30174.632069893127, -30143.83973854518, -30151.07561909289, -29709.437134738244], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.422811059751484, "mean_inference_ms": 0.24980269154474002, "mean_action_processing_ms": 0.058999131514939754, "mean_env_wait_ms": 1.5426016137370206, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0025196075439453125, "StateBufferConnector_ms": 0.0017533302307128906, "ViewRequirementAgentConnector_ms": 0.04516720771789551}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 48240, "num_agent_steps_trained": 48240, "num_env_steps_sampled": 48240, "num_env_steps_trained": 48240, "num_env_steps_sampled_this_iter": 1800, "num_env_steps_trained_this_iter": 1800, "num_env_steps_sampled_throughput_per_sec": 161.93990858690128, "num_env_steps_trained_throughput_per_sec": 161.93990858690128, "timesteps_total": 48240, "num_steps_trained_this_iter": 1800, "agent_timesteps_total": 48240, "timers": {"training_iteration_time_ms": 2225.758, "sample_time_ms": 2220.269, "load_time_ms": 0.235, "load_throughput": 1532632.4, "learn_time_ms": 4.704, "learn_throughput": 76537.23, "synch_weights_time_ms": 0.518}, "counters": {"num_env_steps_sampled": 48240, "num_env_steps_trained": 48240, "num_agent_steps_sampled": 48240, "num_agent_steps_trained": 48240}, "done": false, "episodes_total": 134, "training_iteration": 27, "trial_id": "4935e_00000", "date": "2023-07-25_15-51-40", "timestamp": 1690289500, "time_this_iter_s": 11.117336988449097, "time_total_s": 302.09224367141724, "pid": 67353, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[0, 0.003], [5400, 0.001], [10800, 0.00075], [16200, 0.0005], [21600, 0.00025], [27000, 0.0001], [32400, 7.5e-05], [37800, 5e-05], [43200, 2.5e-05], [48600, 1e-05], [54000, 7.5e-06], [59400, 5e-06], [64800, 2.5e-06], [70200, 1e-06], [75600, 5e-07], [81000, 1e-07]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x177531310>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 302.09224367141724, "iterations_since_restore": 27, "perf": {"cpu_util_percent": 25.766666666666666, "ram_util_percent": 78.97999999999998}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 9.5e-06, "entropy_coeff": 0.10000000000000002, "policy_entropy": -1859.8266194661458, "policy_loss": -1939102162855253.2, "vf_loss": 2513928661.3333335}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 120.0, "num_grad_updates_lifetime": 416.0, "diff_num_grad_updates_vs_sampler_policy": 415.0}}, "num_env_steps_sampled": 50040, "num_env_steps_trained": 50040, "num_agent_steps_sampled": 50040, "num_agent_steps_trained": 50040}, "sampler_results": {"episode_reward_max": -29557.448431599172, "episode_reward_min": -30174.632069893127, "episode_reward_mean": -29900.337399078566, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-29902.414857735148, -30145.7689349501, -29804.63900864462, -29751.998564301775, -30018.118508833555, -29713.869352751786, -29887.37659015742, -29734.729943288814, -29826.223158529236, -30042.544949823463, -30039.39342858763, -29770.50066907107, -29719.259510635333, -30009.326254365078, -29902.54622393914, -30032.460224054972, -30002.91322499981, -29649.34458979476, -29795.43580966862, -29665.501927624326, -29790.23442502846, -29913.554637842444, -30071.141023532444, -29897.82976172966, -29922.445482547326, -29557.448431599172, -29601.797781076402, -29871.040267777982, -29773.356675876406, -29955.530000449162, -29984.44880312825, -29881.368547199767, -30025.403528519793, -29878.75064985404, -29764.403593913165, -29670.755210090556, -29568.779574730706, -29786.3891216829, -30057.63277585619, -29860.83813594021, -29741.915640969215, -29777.885634214686, -29976.21027442633, -29953.744760234193, -30108.26842092144, -29790.5915650707, -29783.214302088596, -29608.115626567964, -29991.074675852167, -29748.50214140118, -29968.645502783616, -29845.28743018343, -29833.87470671902, -29850.51406418121, -30097.885287719044, -29901.15529115687, -29759.689998074, -29891.947840988094, -30032.599978584898, -29804.044154568222, -29951.533957514817, -29937.63066043682, -29933.74484703228, -30139.950688976096, -29827.508910036497, -29855.852268362603, -30151.916052284887, -29945.921846470832, -29876.126214447297, -30123.29573822629, -29949.21956200145, -30018.650957774873, -30042.397093530824, -29927.452749041655, -30031.418424782692, -29806.615581414244, -29839.18189809488, -30007.78046845992, -29878.750381270766, -29947.274205578404, -30133.13085219224, -29902.218624990124, -29872.130656927475, -29859.728693872108, -29965.594650911324, -30064.04298742653, -29778.414620080992, -29864.984283157333, -29902.234597104536, -30108.7563019982, -29884.052520364767, -30174.632069893127, -30143.83973854518, -30151.07561909289, -29709.437134738244, -29754.698620915642, -30070.308814531836, -29993.26869500578, -29752.799588510075, -30043.48687502352], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.4215051649729595, "mean_inference_ms": 0.24977313007058247, "mean_action_processing_ms": 0.058991998230567916, "mean_env_wait_ms": 1.5364792155809597, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0025174617767333984, "StateBufferConnector_ms": 0.0017502307891845703, "ViewRequirementAgentConnector_ms": 0.04510235786437988}}, "episode_reward_max": -29557.448431599172, "episode_reward_min": -30174.632069893127, "episode_reward_mean": -29900.337399078566, "episode_len_mean": 360.0, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-29902.414857735148, -30145.7689349501, -29804.63900864462, -29751.998564301775, -30018.118508833555, -29713.869352751786, -29887.37659015742, -29734.729943288814, -29826.223158529236, -30042.544949823463, -30039.39342858763, -29770.50066907107, -29719.259510635333, -30009.326254365078, -29902.54622393914, -30032.460224054972, -30002.91322499981, -29649.34458979476, -29795.43580966862, -29665.501927624326, -29790.23442502846, -29913.554637842444, -30071.141023532444, -29897.82976172966, -29922.445482547326, -29557.448431599172, -29601.797781076402, -29871.040267777982, -29773.356675876406, -29955.530000449162, -29984.44880312825, -29881.368547199767, -30025.403528519793, -29878.75064985404, -29764.403593913165, -29670.755210090556, -29568.779574730706, -29786.3891216829, -30057.63277585619, -29860.83813594021, -29741.915640969215, -29777.885634214686, -29976.21027442633, -29953.744760234193, -30108.26842092144, -29790.5915650707, -29783.214302088596, -29608.115626567964, -29991.074675852167, -29748.50214140118, -29968.645502783616, -29845.28743018343, -29833.87470671902, -29850.51406418121, -30097.885287719044, -29901.15529115687, -29759.689998074, -29891.947840988094, -30032.599978584898, -29804.044154568222, -29951.533957514817, -29937.63066043682, -29933.74484703228, -30139.950688976096, -29827.508910036497, -29855.852268362603, -30151.916052284887, -29945.921846470832, -29876.126214447297, -30123.29573822629, -29949.21956200145, -30018.650957774873, -30042.397093530824, -29927.452749041655, -30031.418424782692, -29806.615581414244, -29839.18189809488, -30007.78046845992, -29878.750381270766, -29947.274205578404, -30133.13085219224, -29902.218624990124, -29872.130656927475, -29859.728693872108, -29965.594650911324, -30064.04298742653, -29778.414620080992, -29864.984283157333, -29902.234597104536, -30108.7563019982, -29884.052520364767, -30174.632069893127, -30143.83973854518, -30151.07561909289, -29709.437134738244, -29754.698620915642, -30070.308814531836, -29993.26869500578, -29752.799588510075, -30043.48687502352], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.4215051649729595, "mean_inference_ms": 0.24977313007058247, "mean_action_processing_ms": 0.058991998230567916, "mean_env_wait_ms": 1.5364792155809597, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0025174617767333984, "StateBufferConnector_ms": 0.0017502307891845703, "ViewRequirementAgentConnector_ms": 0.04510235786437988}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 50040, "num_agent_steps_trained": 50040, "num_env_steps_sampled": 50040, "num_env_steps_trained": 50040, "num_env_steps_sampled_this_iter": 1800, "num_env_steps_trained_this_iter": 1800, "num_env_steps_sampled_throughput_per_sec": 162.96042042347082, "num_env_steps_trained_throughput_per_sec": 162.96042042347082, "timesteps_total": 50040, "num_steps_trained_this_iter": 1800, "agent_timesteps_total": 50040, "timers": {"training_iteration_time_ms": 2216.077, "sample_time_ms": 2210.616, "load_time_ms": 0.222, "load_throughput": 1622903.525, "learn_time_ms": 4.676, "learn_throughput": 76985.211, "synch_weights_time_ms": 0.53}, "counters": {"num_env_steps_sampled": 50040, "num_env_steps_trained": 50040, "num_agent_steps_sampled": 50040, "num_agent_steps_trained": 50040}, "done": false, "episodes_total": 139, "training_iteration": 28, "trial_id": "4935e_00000", "date": "2023-07-25_15-51-51", "timestamp": 1690289511, "time_this_iter_s": 11.047774314880371, "time_total_s": 313.1400179862976, "pid": 67353, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[0, 0.003], [5400, 0.001], [10800, 0.00075], [16200, 0.0005], [21600, 0.00025], [27000, 0.0001], [32400, 7.5e-05], [37800, 5e-05], [43200, 2.5e-05], [48600, 1e-05], [54000, 7.5e-06], [59400, 5e-06], [64800, 2.5e-06], [70200, 1e-06], [75600, 5e-07], [81000, 1e-07]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x177531310>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 313.1400179862976, "iterations_since_restore": 28, "perf": {"cpu_util_percent": 22.90625, "ram_util_percent": 79.29375}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 8.666666666666668e-06, "entropy_coeff": 0.10000000000000002, "policy_entropy": -1859.834228515625, "policy_loss": -2797314828158976.0, "vf_loss": 2479734741.3333335}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 120.0, "num_grad_updates_lifetime": 431.0, "diff_num_grad_updates_vs_sampler_policy": 430.0}}, "num_env_steps_sampled": 51840, "num_env_steps_trained": 51840, "num_agent_steps_sampled": 51840, "num_agent_steps_trained": 51840}, "sampler_results": {"episode_reward_max": -29557.448431599172, "episode_reward_min": -30174.632069893127, "episode_reward_mean": -29897.75396241781, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-29713.869352751786, -29887.37659015742, -29734.729943288814, -29826.223158529236, -30042.544949823463, -30039.39342858763, -29770.50066907107, -29719.259510635333, -30009.326254365078, -29902.54622393914, -30032.460224054972, -30002.91322499981, -29649.34458979476, -29795.43580966862, -29665.501927624326, -29790.23442502846, -29913.554637842444, -30071.141023532444, -29897.82976172966, -29922.445482547326, -29557.448431599172, -29601.797781076402, -29871.040267777982, -29773.356675876406, -29955.530000449162, -29984.44880312825, -29881.368547199767, -30025.403528519793, -29878.75064985404, -29764.403593913165, -29670.755210090556, -29568.779574730706, -29786.3891216829, -30057.63277585619, -29860.83813594021, -29741.915640969215, -29777.885634214686, -29976.21027442633, -29953.744760234193, -30108.26842092144, -29790.5915650707, -29783.214302088596, -29608.115626567964, -29991.074675852167, -29748.50214140118, -29968.645502783616, -29845.28743018343, -29833.87470671902, -29850.51406418121, -30097.885287719044, -29901.15529115687, -29759.689998074, -29891.947840988094, -30032.599978584898, -29804.044154568222, -29951.533957514817, -29937.63066043682, -29933.74484703228, -30139.950688976096, -29827.508910036497, -29855.852268362603, -30151.916052284887, -29945.921846470832, -29876.126214447297, -30123.29573822629, -29949.21956200145, -30018.650957774873, -30042.397093530824, -29927.452749041655, -30031.418424782692, -29806.615581414244, -29839.18189809488, -30007.78046845992, -29878.750381270766, -29947.274205578404, -30133.13085219224, -29902.218624990124, -29872.130656927475, -29859.728693872108, -29965.594650911324, -30064.04298742653, -29778.414620080992, -29864.984283157333, -29902.234597104536, -30108.7563019982, -29884.052520364767, -30174.632069893127, -30143.83973854518, -30151.07561909289, -29709.437134738244, -29754.698620915642, -30070.308814531836, -29993.26869500578, -29752.799588510075, -30043.48687502352, -29838.241144333268, -29920.611377895126, -29924.455142119088, -29811.5423120522, -29869.746231989895], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.42015057428616, "mean_inference_ms": 0.24976038462087338, "mean_action_processing_ms": 0.058985532073909726, "mean_env_wait_ms": 1.5312790033985706, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0025174617767333984, "StateBufferConnector_ms": 0.0017573833465576172, "ViewRequirementAgentConnector_ms": 0.045079708099365234}}, "episode_reward_max": -29557.448431599172, "episode_reward_min": -30174.632069893127, "episode_reward_mean": -29897.75396241781, "episode_len_mean": 360.0, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-29713.869352751786, -29887.37659015742, -29734.729943288814, -29826.223158529236, -30042.544949823463, -30039.39342858763, -29770.50066907107, -29719.259510635333, -30009.326254365078, -29902.54622393914, -30032.460224054972, -30002.91322499981, -29649.34458979476, -29795.43580966862, -29665.501927624326, -29790.23442502846, -29913.554637842444, -30071.141023532444, -29897.82976172966, -29922.445482547326, -29557.448431599172, -29601.797781076402, -29871.040267777982, -29773.356675876406, -29955.530000449162, -29984.44880312825, -29881.368547199767, -30025.403528519793, -29878.75064985404, -29764.403593913165, -29670.755210090556, -29568.779574730706, -29786.3891216829, -30057.63277585619, -29860.83813594021, -29741.915640969215, -29777.885634214686, -29976.21027442633, -29953.744760234193, -30108.26842092144, -29790.5915650707, -29783.214302088596, -29608.115626567964, -29991.074675852167, -29748.50214140118, -29968.645502783616, -29845.28743018343, -29833.87470671902, -29850.51406418121, -30097.885287719044, -29901.15529115687, -29759.689998074, -29891.947840988094, -30032.599978584898, -29804.044154568222, -29951.533957514817, -29937.63066043682, -29933.74484703228, -30139.950688976096, -29827.508910036497, -29855.852268362603, -30151.916052284887, -29945.921846470832, -29876.126214447297, -30123.29573822629, -29949.21956200145, -30018.650957774873, -30042.397093530824, -29927.452749041655, -30031.418424782692, -29806.615581414244, -29839.18189809488, -30007.78046845992, -29878.750381270766, -29947.274205578404, -30133.13085219224, -29902.218624990124, -29872.130656927475, -29859.728693872108, -29965.594650911324, -30064.04298742653, -29778.414620080992, -29864.984283157333, -29902.234597104536, -30108.7563019982, -29884.052520364767, -30174.632069893127, -30143.83973854518, -30151.07561909289, -29709.437134738244, -29754.698620915642, -30070.308814531836, -29993.26869500578, -29752.799588510075, -30043.48687502352, -29838.241144333268, -29920.611377895126, -29924.455142119088, -29811.5423120522, -29869.746231989895], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.42015057428616, "mean_inference_ms": 0.24976038462087338, "mean_action_processing_ms": 0.058985532073909726, "mean_env_wait_ms": 1.5312790033985706, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0025174617767333984, "StateBufferConnector_ms": 0.0017573833465576172, "ViewRequirementAgentConnector_ms": 0.045079708099365234}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 51840, "num_agent_steps_trained": 51840, "num_env_steps_sampled": 51840, "num_env_steps_trained": 51840, "num_env_steps_sampled_this_iter": 1800, "num_env_steps_trained_this_iter": 1800, "num_env_steps_sampled_throughput_per_sec": 161.4499935203992, "num_env_steps_trained_throughput_per_sec": 161.4499935203992, "timesteps_total": 51840, "num_steps_trained_this_iter": 1800, "agent_timesteps_total": 51840, "timers": {"training_iteration_time_ms": 2219.448, "sample_time_ms": 2213.86, "load_time_ms": 0.228, "load_throughput": 1581264.467, "learn_time_ms": 4.764, "learn_throughput": 75564.725, "synch_weights_time_ms": 0.562}, "counters": {"num_env_steps_sampled": 51840, "num_env_steps_trained": 51840, "num_agent_steps_sampled": 51840, "num_agent_steps_trained": 51840}, "done": false, "episodes_total": 144, "training_iteration": 29, "trial_id": "4935e_00000", "date": "2023-07-25_15-52-02", "timestamp": 1690289522, "time_this_iter_s": 11.151432991027832, "time_total_s": 324.29145097732544, "pid": 67353, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[0, 0.003], [5400, 0.001], [10800, 0.00075], [16200, 0.0005], [21600, 0.00025], [27000, 0.0001], [32400, 7.5e-05], [37800, 5e-05], [43200, 2.5e-05], [48600, 1e-05], [54000, 7.5e-06], [59400, 5e-06], [64800, 2.5e-06], [70200, 1e-06], [75600, 5e-07], [81000, 1e-07]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x177531310>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 324.29145097732544, "iterations_since_restore": 29, "perf": {"cpu_util_percent": 22.93125, "ram_util_percent": 79.23750000000001}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 7.833333333333333e-06, "entropy_coeff": 0.10000000000000002, "policy_entropy": -1859.8367513020833, "policy_loss": -189154638469120.0, "vf_loss": 2450201770.6666665}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 120.0, "num_grad_updates_lifetime": 446.0, "diff_num_grad_updates_vs_sampler_policy": 445.0}}, "num_env_steps_sampled": 53640, "num_env_steps_trained": 53640, "num_agent_steps_sampled": 53640, "num_agent_steps_trained": 53640}, "sampler_results": {"episode_reward_max": -29557.448431599172, "episode_reward_min": -30174.632069893127, "episode_reward_mean": -29901.652196684223, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-30039.39342858763, -29770.50066907107, -29719.259510635333, -30009.326254365078, -29902.54622393914, -30032.460224054972, -30002.91322499981, -29649.34458979476, -29795.43580966862, -29665.501927624326, -29790.23442502846, -29913.554637842444, -30071.141023532444, -29897.82976172966, -29922.445482547326, -29557.448431599172, -29601.797781076402, -29871.040267777982, -29773.356675876406, -29955.530000449162, -29984.44880312825, -29881.368547199767, -30025.403528519793, -29878.75064985404, -29764.403593913165, -29670.755210090556, -29568.779574730706, -29786.3891216829, -30057.63277585619, -29860.83813594021, -29741.915640969215, -29777.885634214686, -29976.21027442633, -29953.744760234193, -30108.26842092144, -29790.5915650707, -29783.214302088596, -29608.115626567964, -29991.074675852167, -29748.50214140118, -29968.645502783616, -29845.28743018343, -29833.87470671902, -29850.51406418121, -30097.885287719044, -29901.15529115687, -29759.689998074, -29891.947840988094, -30032.599978584898, -29804.044154568222, -29951.533957514817, -29937.63066043682, -29933.74484703228, -30139.950688976096, -29827.508910036497, -29855.852268362603, -30151.916052284887, -29945.921846470832, -29876.126214447297, -30123.29573822629, -29949.21956200145, -30018.650957774873, -30042.397093530824, -29927.452749041655, -30031.418424782692, -29806.615581414244, -29839.18189809488, -30007.78046845992, -29878.750381270766, -29947.274205578404, -30133.13085219224, -29902.218624990124, -29872.130656927475, -29859.728693872108, -29965.594650911324, -30064.04298742653, -29778.414620080992, -29864.984283157333, -29902.234597104536, -30108.7563019982, -29884.052520364767, -30174.632069893127, -30143.83973854518, -30151.07561909289, -29709.437134738244, -29754.698620915642, -30070.308814531836, -29993.26869500578, -29752.799588510075, -30043.48687502352, -29838.241144333268, -29920.611377895126, -29924.455142119088, -29811.5423120522, -29869.746231989895, -29761.5002540869, -30139.582092677083, -30035.73094352778, -30005.63178435851, -29652.122346541295], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.418962812185394, "mean_inference_ms": 0.2497607377349304, "mean_action_processing_ms": 0.058981448693543666, "mean_env_wait_ms": 1.526639233035564, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002524137496948242, "StateBufferConnector_ms": 0.0017535686492919922, "ViewRequirementAgentConnector_ms": 0.045070648193359375}}, "episode_reward_max": -29557.448431599172, "episode_reward_min": -30174.632069893127, "episode_reward_mean": -29901.652196684223, "episode_len_mean": 360.0, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-30039.39342858763, -29770.50066907107, -29719.259510635333, -30009.326254365078, -29902.54622393914, -30032.460224054972, -30002.91322499981, -29649.34458979476, -29795.43580966862, -29665.501927624326, -29790.23442502846, -29913.554637842444, -30071.141023532444, -29897.82976172966, -29922.445482547326, -29557.448431599172, -29601.797781076402, -29871.040267777982, -29773.356675876406, -29955.530000449162, -29984.44880312825, -29881.368547199767, -30025.403528519793, -29878.75064985404, -29764.403593913165, -29670.755210090556, -29568.779574730706, -29786.3891216829, -30057.63277585619, -29860.83813594021, -29741.915640969215, -29777.885634214686, -29976.21027442633, -29953.744760234193, -30108.26842092144, -29790.5915650707, -29783.214302088596, -29608.115626567964, -29991.074675852167, -29748.50214140118, -29968.645502783616, -29845.28743018343, -29833.87470671902, -29850.51406418121, -30097.885287719044, -29901.15529115687, -29759.689998074, -29891.947840988094, -30032.599978584898, -29804.044154568222, -29951.533957514817, -29937.63066043682, -29933.74484703228, -30139.950688976096, -29827.508910036497, -29855.852268362603, -30151.916052284887, -29945.921846470832, -29876.126214447297, -30123.29573822629, -29949.21956200145, -30018.650957774873, -30042.397093530824, -29927.452749041655, -30031.418424782692, -29806.615581414244, -29839.18189809488, -30007.78046845992, -29878.750381270766, -29947.274205578404, -30133.13085219224, -29902.218624990124, -29872.130656927475, -29859.728693872108, -29965.594650911324, -30064.04298742653, -29778.414620080992, -29864.984283157333, -29902.234597104536, -30108.7563019982, -29884.052520364767, -30174.632069893127, -30143.83973854518, -30151.07561909289, -29709.437134738244, -29754.698620915642, -30070.308814531836, -29993.26869500578, -29752.799588510075, -30043.48687502352, -29838.241144333268, -29920.611377895126, -29924.455142119088, -29811.5423120522, -29869.746231989895, -29761.5002540869, -30139.582092677083, -30035.73094352778, -30005.63178435851, -29652.122346541295], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.418962812185394, "mean_inference_ms": 0.2497607377349304, "mean_action_processing_ms": 0.058981448693543666, "mean_env_wait_ms": 1.526639233035564, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002524137496948242, "StateBufferConnector_ms": 0.0017535686492919922, "ViewRequirementAgentConnector_ms": 0.045070648193359375}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 53640, "num_agent_steps_trained": 53640, "num_env_steps_sampled": 53640, "num_env_steps_trained": 53640, "num_env_steps_sampled_this_iter": 1800, "num_env_steps_trained_this_iter": 1800, "num_env_steps_sampled_throughput_per_sec": 161.65999670159738, "num_env_steps_trained_throughput_per_sec": 161.65999670159738, "timesteps_total": 53640, "num_steps_trained_this_iter": 1800, "agent_timesteps_total": 53640, "timers": {"training_iteration_time_ms": 2228.334, "sample_time_ms": 2222.8, "load_time_ms": 0.218, "load_throughput": 1649857.343, "learn_time_ms": 4.738, "learn_throughput": 75977.268, "synch_weights_time_ms": 0.544}, "counters": {"num_env_steps_sampled": 53640, "num_env_steps_trained": 53640, "num_agent_steps_sampled": 53640, "num_agent_steps_trained": 53640}, "done": false, "episodes_total": 149, "training_iteration": 30, "trial_id": "4935e_00000", "date": "2023-07-25_15-52-14", "timestamp": 1690289534, "time_this_iter_s": 11.136528253555298, "time_total_s": 335.42797923088074, "pid": 67353, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[0, 0.003], [5400, 0.001], [10800, 0.00075], [16200, 0.0005], [21600, 0.00025], [27000, 0.0001], [32400, 7.5e-05], [37800, 5e-05], [43200, 2.5e-05], [48600, 1e-05], [54000, 7.5e-06], [59400, 5e-06], [64800, 2.5e-06], [70200, 1e-06], [75600, 5e-07], [81000, 1e-07]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x177531310>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 335.42797923088074, "iterations_since_restore": 30, "perf": {"cpu_util_percent": 29.2875, "ram_util_percent": 78.36250000000001}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 7e-06, "entropy_coeff": 0.10000000000000002, "policy_entropy": -1859.837890625, "policy_loss": -2594042248101888.0, "vf_loss": 2434823850.6666665}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 120.0, "num_grad_updates_lifetime": 461.0, "diff_num_grad_updates_vs_sampler_policy": 460.0}}, "num_env_steps_sampled": 55440, "num_env_steps_trained": 55440, "num_agent_steps_sampled": 55440, "num_agent_steps_trained": 55440}, "sampler_results": {"episode_reward_max": -29557.448431599172, "episode_reward_min": -30233.345798788116, "episode_reward_mean": -29902.028095540092, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-30032.460224054972, -30002.91322499981, -29649.34458979476, -29795.43580966862, -29665.501927624326, -29790.23442502846, -29913.554637842444, -30071.141023532444, -29897.82976172966, -29922.445482547326, -29557.448431599172, -29601.797781076402, -29871.040267777982, -29773.356675876406, -29955.530000449162, -29984.44880312825, -29881.368547199767, -30025.403528519793, -29878.75064985404, -29764.403593913165, -29670.755210090556, -29568.779574730706, -29786.3891216829, -30057.63277585619, -29860.83813594021, -29741.915640969215, -29777.885634214686, -29976.21027442633, -29953.744760234193, -30108.26842092144, -29790.5915650707, -29783.214302088596, -29608.115626567964, -29991.074675852167, -29748.50214140118, -29968.645502783616, -29845.28743018343, -29833.87470671902, -29850.51406418121, -30097.885287719044, -29901.15529115687, -29759.689998074, -29891.947840988094, -30032.599978584898, -29804.044154568222, -29951.533957514817, -29937.63066043682, -29933.74484703228, -30139.950688976096, -29827.508910036497, -29855.852268362603, -30151.916052284887, -29945.921846470832, -29876.126214447297, -30123.29573822629, -29949.21956200145, -30018.650957774873, -30042.397093530824, -29927.452749041655, -30031.418424782692, -29806.615581414244, -29839.18189809488, -30007.78046845992, -29878.750381270766, -29947.274205578404, -30133.13085219224, -29902.218624990124, -29872.130656927475, -29859.728693872108, -29965.594650911324, -30064.04298742653, -29778.414620080992, -29864.984283157333, -29902.234597104536, -30108.7563019982, -29884.052520364767, -30174.632069893127, -30143.83973854518, -30151.07561909289, -29709.437134738244, -29754.698620915642, -30070.308814531836, -29993.26869500578, -29752.799588510075, -30043.48687502352, -29838.241144333268, -29920.611377895126, -29924.455142119088, -29811.5423120522, -29869.746231989895, -29761.5002540869, -30139.582092677083, -30035.73094352778, -30005.63178435851, -29652.122346541295, -30233.345798788116, -29839.15438020255, -29880.69717237495, -29868.909199066777, -29656.50942175287], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.417813548681437, "mean_inference_ms": 0.24977005817710757, "mean_action_processing_ms": 0.0589792758516797, "mean_env_wait_ms": 1.5225312038483272, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002530336380004883, "StateBufferConnector_ms": 0.0017561912536621094, "ViewRequirementAgentConnector_ms": 0.04528450965881348}}, "episode_reward_max": -29557.448431599172, "episode_reward_min": -30233.345798788116, "episode_reward_mean": -29902.028095540092, "episode_len_mean": 360.0, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-30032.460224054972, -30002.91322499981, -29649.34458979476, -29795.43580966862, -29665.501927624326, -29790.23442502846, -29913.554637842444, -30071.141023532444, -29897.82976172966, -29922.445482547326, -29557.448431599172, -29601.797781076402, -29871.040267777982, -29773.356675876406, -29955.530000449162, -29984.44880312825, -29881.368547199767, -30025.403528519793, -29878.75064985404, -29764.403593913165, -29670.755210090556, -29568.779574730706, -29786.3891216829, -30057.63277585619, -29860.83813594021, -29741.915640969215, -29777.885634214686, -29976.21027442633, -29953.744760234193, -30108.26842092144, -29790.5915650707, -29783.214302088596, -29608.115626567964, -29991.074675852167, -29748.50214140118, -29968.645502783616, -29845.28743018343, -29833.87470671902, -29850.51406418121, -30097.885287719044, -29901.15529115687, -29759.689998074, -29891.947840988094, -30032.599978584898, -29804.044154568222, -29951.533957514817, -29937.63066043682, -29933.74484703228, -30139.950688976096, -29827.508910036497, -29855.852268362603, -30151.916052284887, -29945.921846470832, -29876.126214447297, -30123.29573822629, -29949.21956200145, -30018.650957774873, -30042.397093530824, -29927.452749041655, -30031.418424782692, -29806.615581414244, -29839.18189809488, -30007.78046845992, -29878.750381270766, -29947.274205578404, -30133.13085219224, -29902.218624990124, -29872.130656927475, -29859.728693872108, -29965.594650911324, -30064.04298742653, -29778.414620080992, -29864.984283157333, -29902.234597104536, -30108.7563019982, -29884.052520364767, -30174.632069893127, -30143.83973854518, -30151.07561909289, -29709.437134738244, -29754.698620915642, -30070.308814531836, -29993.26869500578, -29752.799588510075, -30043.48687502352, -29838.241144333268, -29920.611377895126, -29924.455142119088, -29811.5423120522, -29869.746231989895, -29761.5002540869, -30139.582092677083, -30035.73094352778, -30005.63178435851, -29652.122346541295, -30233.345798788116, -29839.15438020255, -29880.69717237495, -29868.909199066777, -29656.50942175287], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.417813548681437, "mean_inference_ms": 0.24977005817710757, "mean_action_processing_ms": 0.0589792758516797, "mean_env_wait_ms": 1.5225312038483272, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002530336380004883, "StateBufferConnector_ms": 0.0017561912536621094, "ViewRequirementAgentConnector_ms": 0.04528450965881348}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 55440, "num_agent_steps_trained": 55440, "num_env_steps_sampled": 55440, "num_env_steps_trained": 55440, "num_env_steps_sampled_this_iter": 1800, "num_env_steps_trained_this_iter": 1800, "num_env_steps_sampled_throughput_per_sec": 161.8007210167272, "num_env_steps_trained_throughput_per_sec": 161.8007210167272, "timesteps_total": 55440, "num_steps_trained_this_iter": 1800, "agent_timesteps_total": 55440, "timers": {"training_iteration_time_ms": 2225.918, "sample_time_ms": 2220.402, "load_time_ms": 0.232, "load_throughput": 1555045.767, "learn_time_ms": 4.726, "learn_throughput": 76181.967, "synch_weights_time_ms": 0.526}, "counters": {"num_env_steps_sampled": 55440, "num_env_steps_trained": 55440, "num_agent_steps_sampled": 55440, "num_agent_steps_trained": 55440}, "done": false, "episodes_total": 154, "training_iteration": 31, "trial_id": "4935e_00000", "date": "2023-07-25_15-52-25", "timestamp": 1690289545, "time_this_iter_s": 11.127209901809692, "time_total_s": 346.55518913269043, "pid": 67353, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[0, 0.003], [5400, 0.001], [10800, 0.00075], [16200, 0.0005], [21600, 0.00025], [27000, 0.0001], [32400, 7.5e-05], [37800, 5e-05], [43200, 2.5e-05], [48600, 1e-05], [54000, 7.5e-06], [59400, 5e-06], [64800, 2.5e-06], [70200, 1e-06], [75600, 5e-07], [81000, 1e-07]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x177531310>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 346.55518913269043, "iterations_since_restore": 31, "perf": {"cpu_util_percent": 24.18, "ram_util_percent": 79.71333333333332}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 6.166666666666667e-06, "entropy_coeff": 0.10000000000000002, "policy_entropy": -1859.8374837239583, "policy_loss": -1878024324354048.0, "vf_loss": 2498794026.6666665}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 120.0, "num_grad_updates_lifetime": 476.0, "diff_num_grad_updates_vs_sampler_policy": 475.0}}, "num_env_steps_sampled": 57240, "num_env_steps_trained": 57240, "num_agent_steps_sampled": 57240, "num_agent_steps_trained": 57240}, "sampler_results": {"episode_reward_max": -29557.448431599172, "episode_reward_min": -30233.345798788116, "episode_reward_mean": -29908.617710688766, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-29790.23442502846, -29913.554637842444, -30071.141023532444, -29897.82976172966, -29922.445482547326, -29557.448431599172, -29601.797781076402, -29871.040267777982, -29773.356675876406, -29955.530000449162, -29984.44880312825, -29881.368547199767, -30025.403528519793, -29878.75064985404, -29764.403593913165, -29670.755210090556, -29568.779574730706, -29786.3891216829, -30057.63277585619, -29860.83813594021, -29741.915640969215, -29777.885634214686, -29976.21027442633, -29953.744760234193, -30108.26842092144, -29790.5915650707, -29783.214302088596, -29608.115626567964, -29991.074675852167, -29748.50214140118, -29968.645502783616, -29845.28743018343, -29833.87470671902, -29850.51406418121, -30097.885287719044, -29901.15529115687, -29759.689998074, -29891.947840988094, -30032.599978584898, -29804.044154568222, -29951.533957514817, -29937.63066043682, -29933.74484703228, -30139.950688976096, -29827.508910036497, -29855.852268362603, -30151.916052284887, -29945.921846470832, -29876.126214447297, -30123.29573822629, -29949.21956200145, -30018.650957774873, -30042.397093530824, -29927.452749041655, -30031.418424782692, -29806.615581414244, -29839.18189809488, -30007.78046845992, -29878.750381270766, -29947.274205578404, -30133.13085219224, -29902.218624990124, -29872.130656927475, -29859.728693872108, -29965.594650911324, -30064.04298742653, -29778.414620080992, -29864.984283157333, -29902.234597104536, -30108.7563019982, -29884.052520364767, -30174.632069893127, -30143.83973854518, -30151.07561909289, -29709.437134738244, -29754.698620915642, -30070.308814531836, -29993.26869500578, -29752.799588510075, -30043.48687502352, -29838.241144333268, -29920.611377895126, -29924.455142119088, -29811.5423120522, -29869.746231989895, -29761.5002540869, -30139.582092677083, -30035.73094352778, -30005.63178435851, -29652.122346541295, -30233.345798788116, -29839.15438020255, -29880.69717237495, -29868.909199066777, -29656.50942175287, -29786.387514156668, -29940.772096504068, -30112.522561288562, -29980.439121478223, -29984.4959975829], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.416712226487656, "mean_inference_ms": 0.24978160066958727, "mean_action_processing_ms": 0.058977171613493765, "mean_env_wait_ms": 1.5188891917688734, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002537965774536133, "StateBufferConnector_ms": 0.0017619132995605469, "ViewRequirementAgentConnector_ms": 0.045356035232543945}}, "episode_reward_max": -29557.448431599172, "episode_reward_min": -30233.345798788116, "episode_reward_mean": -29908.617710688766, "episode_len_mean": 360.0, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-29790.23442502846, -29913.554637842444, -30071.141023532444, -29897.82976172966, -29922.445482547326, -29557.448431599172, -29601.797781076402, -29871.040267777982, -29773.356675876406, -29955.530000449162, -29984.44880312825, -29881.368547199767, -30025.403528519793, -29878.75064985404, -29764.403593913165, -29670.755210090556, -29568.779574730706, -29786.3891216829, -30057.63277585619, -29860.83813594021, -29741.915640969215, -29777.885634214686, -29976.21027442633, -29953.744760234193, -30108.26842092144, -29790.5915650707, -29783.214302088596, -29608.115626567964, -29991.074675852167, -29748.50214140118, -29968.645502783616, -29845.28743018343, -29833.87470671902, -29850.51406418121, -30097.885287719044, -29901.15529115687, -29759.689998074, -29891.947840988094, -30032.599978584898, -29804.044154568222, -29951.533957514817, -29937.63066043682, -29933.74484703228, -30139.950688976096, -29827.508910036497, -29855.852268362603, -30151.916052284887, -29945.921846470832, -29876.126214447297, -30123.29573822629, -29949.21956200145, -30018.650957774873, -30042.397093530824, -29927.452749041655, -30031.418424782692, -29806.615581414244, -29839.18189809488, -30007.78046845992, -29878.750381270766, -29947.274205578404, -30133.13085219224, -29902.218624990124, -29872.130656927475, -29859.728693872108, -29965.594650911324, -30064.04298742653, -29778.414620080992, -29864.984283157333, -29902.234597104536, -30108.7563019982, -29884.052520364767, -30174.632069893127, -30143.83973854518, -30151.07561909289, -29709.437134738244, -29754.698620915642, -30070.308814531836, -29993.26869500578, -29752.799588510075, -30043.48687502352, -29838.241144333268, -29920.611377895126, -29924.455142119088, -29811.5423120522, -29869.746231989895, -29761.5002540869, -30139.582092677083, -30035.73094352778, -30005.63178435851, -29652.122346541295, -30233.345798788116, -29839.15438020255, -29880.69717237495, -29868.909199066777, -29656.50942175287, -29786.387514156668, -29940.772096504068, -30112.522561288562, -29980.439121478223, -29984.4959975829], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.416712226487656, "mean_inference_ms": 0.24978160066958727, "mean_action_processing_ms": 0.058977171613493765, "mean_env_wait_ms": 1.5188891917688734, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002537965774536133, "StateBufferConnector_ms": 0.0017619132995605469, "ViewRequirementAgentConnector_ms": 0.045356035232543945}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 57240, "num_agent_steps_trained": 57240, "num_env_steps_sampled": 57240, "num_env_steps_trained": 57240, "num_env_steps_sampled_this_iter": 1800, "num_env_steps_trained_this_iter": 1800, "num_env_steps_sampled_throughput_per_sec": 162.86185340492764, "num_env_steps_trained_throughput_per_sec": 162.86185340492764, "timesteps_total": 57240, "num_steps_trained_this_iter": 1800, "agent_timesteps_total": 57240, "timers": {"training_iteration_time_ms": 2217.701, "sample_time_ms": 2212.112, "load_time_ms": 0.233, "load_throughput": 1546287.189, "learn_time_ms": 4.787, "learn_throughput": 75198.932, "synch_weights_time_ms": 0.535}, "counters": {"num_env_steps_sampled": 57240, "num_env_steps_trained": 57240, "num_agent_steps_sampled": 57240, "num_agent_steps_trained": 57240}, "done": false, "episodes_total": 159, "training_iteration": 32, "trial_id": "4935e_00000", "date": "2023-07-25_15-52-36", "timestamp": 1690289556, "time_this_iter_s": 11.054362773895264, "time_total_s": 357.6095519065857, "pid": 67353, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[0, 0.003], [5400, 0.001], [10800, 0.00075], [16200, 0.0005], [21600, 0.00025], [27000, 0.0001], [32400, 7.5e-05], [37800, 5e-05], [43200, 2.5e-05], [48600, 1e-05], [54000, 7.5e-06], [59400, 5e-06], [64800, 2.5e-06], [70200, 1e-06], [75600, 5e-07], [81000, 1e-07]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x177531310>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 357.6095519065857, "iterations_since_restore": 32, "perf": {"cpu_util_percent": 23.56875, "ram_util_percent": 79.01875}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 5.3333333333333345e-06, "entropy_coeff": 0.10000000000000002, "policy_entropy": -1859.8390299479167, "policy_loss": -1059345837413717.4, "vf_loss": 2478544021.3333335}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 120.0, "num_grad_updates_lifetime": 491.0, "diff_num_grad_updates_vs_sampler_policy": 490.0}}, "num_env_steps_sampled": 59040, "num_env_steps_trained": 59040, "num_agent_steps_sampled": 59040, "num_agent_steps_trained": 59040}, "sampler_results": {"episode_reward_max": -29557.448431599172, "episode_reward_min": -30233.345798788116, "episode_reward_mean": -29909.571086529355, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-29557.448431599172, -29601.797781076402, -29871.040267777982, -29773.356675876406, -29955.530000449162, -29984.44880312825, -29881.368547199767, -30025.403528519793, -29878.75064985404, -29764.403593913165, -29670.755210090556, -29568.779574730706, -29786.3891216829, -30057.63277585619, -29860.83813594021, -29741.915640969215, -29777.885634214686, -29976.21027442633, -29953.744760234193, -30108.26842092144, -29790.5915650707, -29783.214302088596, -29608.115626567964, -29991.074675852167, -29748.50214140118, -29968.645502783616, -29845.28743018343, -29833.87470671902, -29850.51406418121, -30097.885287719044, -29901.15529115687, -29759.689998074, -29891.947840988094, -30032.599978584898, -29804.044154568222, -29951.533957514817, -29937.63066043682, -29933.74484703228, -30139.950688976096, -29827.508910036497, -29855.852268362603, -30151.916052284887, -29945.921846470832, -29876.126214447297, -30123.29573822629, -29949.21956200145, -30018.650957774873, -30042.397093530824, -29927.452749041655, -30031.418424782692, -29806.615581414244, -29839.18189809488, -30007.78046845992, -29878.750381270766, -29947.274205578404, -30133.13085219224, -29902.218624990124, -29872.130656927475, -29859.728693872108, -29965.594650911324, -30064.04298742653, -29778.414620080992, -29864.984283157333, -29902.234597104536, -30108.7563019982, -29884.052520364767, -30174.632069893127, -30143.83973854518, -30151.07561909289, -29709.437134738244, -29754.698620915642, -30070.308814531836, -29993.26869500578, -29752.799588510075, -30043.48687502352, -29838.241144333268, -29920.611377895126, -29924.455142119088, -29811.5423120522, -29869.746231989895, -29761.5002540869, -30139.582092677083, -30035.73094352778, -30005.63178435851, -29652.122346541295, -30233.345798788116, -29839.15438020255, -29880.69717237495, -29868.909199066777, -29656.50942175287, -29786.387514156668, -29940.772096504068, -30112.522561288562, -29980.439121478223, -29984.4959975829, -30113.054436096532, -30023.27791941823, -29800.69896446871, -29887.260219338234, -29866.251375417585], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.415545475825502, "mean_inference_ms": 0.24978057078570512, "mean_action_processing_ms": 0.0589730116137439, "mean_env_wait_ms": 1.515581578035493, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0025289058685302734, "StateBufferConnector_ms": 0.0017600059509277344, "ViewRequirementAgentConnector_ms": 0.04527854919433594}}, "episode_reward_max": -29557.448431599172, "episode_reward_min": -30233.345798788116, "episode_reward_mean": -29909.571086529355, "episode_len_mean": 360.0, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-29557.448431599172, -29601.797781076402, -29871.040267777982, -29773.356675876406, -29955.530000449162, -29984.44880312825, -29881.368547199767, -30025.403528519793, -29878.75064985404, -29764.403593913165, -29670.755210090556, -29568.779574730706, -29786.3891216829, -30057.63277585619, -29860.83813594021, -29741.915640969215, -29777.885634214686, -29976.21027442633, -29953.744760234193, -30108.26842092144, -29790.5915650707, -29783.214302088596, -29608.115626567964, -29991.074675852167, -29748.50214140118, -29968.645502783616, -29845.28743018343, -29833.87470671902, -29850.51406418121, -30097.885287719044, -29901.15529115687, -29759.689998074, -29891.947840988094, -30032.599978584898, -29804.044154568222, -29951.533957514817, -29937.63066043682, -29933.74484703228, -30139.950688976096, -29827.508910036497, -29855.852268362603, -30151.916052284887, -29945.921846470832, -29876.126214447297, -30123.29573822629, -29949.21956200145, -30018.650957774873, -30042.397093530824, -29927.452749041655, -30031.418424782692, -29806.615581414244, -29839.18189809488, -30007.78046845992, -29878.750381270766, -29947.274205578404, -30133.13085219224, -29902.218624990124, -29872.130656927475, -29859.728693872108, -29965.594650911324, -30064.04298742653, -29778.414620080992, -29864.984283157333, -29902.234597104536, -30108.7563019982, -29884.052520364767, -30174.632069893127, -30143.83973854518, -30151.07561909289, -29709.437134738244, -29754.698620915642, -30070.308814531836, -29993.26869500578, -29752.799588510075, -30043.48687502352, -29838.241144333268, -29920.611377895126, -29924.455142119088, -29811.5423120522, -29869.746231989895, -29761.5002540869, -30139.582092677083, -30035.73094352778, -30005.63178435851, -29652.122346541295, -30233.345798788116, -29839.15438020255, -29880.69717237495, -29868.909199066777, -29656.50942175287, -29786.387514156668, -29940.772096504068, -30112.522561288562, -29980.439121478223, -29984.4959975829, -30113.054436096532, -30023.27791941823, -29800.69896446871, -29887.260219338234, -29866.251375417585], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.415545475825502, "mean_inference_ms": 0.24978057078570512, "mean_action_processing_ms": 0.0589730116137439, "mean_env_wait_ms": 1.515581578035493, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0025289058685302734, "StateBufferConnector_ms": 0.0017600059509277344, "ViewRequirementAgentConnector_ms": 0.04527854919433594}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 59040, "num_agent_steps_trained": 59040, "num_env_steps_sampled": 59040, "num_env_steps_trained": 59040, "num_env_steps_sampled_this_iter": 1800, "num_env_steps_trained_this_iter": 1800, "num_env_steps_sampled_throughput_per_sec": 162.89123983219872, "num_env_steps_trained_throughput_per_sec": 162.89123983219872, "timesteps_total": 59040, "num_steps_trained_this_iter": 1800, "agent_timesteps_total": 59040, "timers": {"training_iteration_time_ms": 2210.254, "sample_time_ms": 2204.793, "load_time_ms": 0.213, "load_throughput": 1693337.939, "learn_time_ms": 4.691, "learn_throughput": 76749.252, "synch_weights_time_ms": 0.525}, "counters": {"num_env_steps_sampled": 59040, "num_env_steps_trained": 59040, "num_agent_steps_sampled": 59040, "num_agent_steps_trained": 59040}, "done": false, "episodes_total": 164, "training_iteration": 33, "trial_id": "4935e_00000", "date": "2023-07-25_15-52-47", "timestamp": 1690289567, "time_this_iter_s": 11.052347898483276, "time_total_s": 368.66189980506897, "pid": 67353, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[0, 0.003], [5400, 0.001], [10800, 0.00075], [16200, 0.0005], [21600, 0.00025], [27000, 0.0001], [32400, 7.5e-05], [37800, 5e-05], [43200, 2.5e-05], [48600, 1e-05], [54000, 7.5e-06], [59400, 5e-06], [64800, 2.5e-06], [70200, 1e-06], [75600, 5e-07], [81000, 1e-07]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x177531310>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 368.66189980506897, "iterations_since_restore": 33, "perf": {"cpu_util_percent": 23.30625, "ram_util_percent": 79.15}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 4.5e-06, "entropy_coeff": 0.10000000000000002, "policy_entropy": -1859.8402913411458, "policy_loss": -315005038903296.0, "vf_loss": 2512736021.3333335}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 120.0, "num_grad_updates_lifetime": 506.0, "diff_num_grad_updates_vs_sampler_policy": 505.0}}, "num_env_steps_sampled": 60840, "num_env_steps_trained": 60840, "num_agent_steps_sampled": 60840, "num_agent_steps_trained": 60840}, "sampler_results": {"episode_reward_max": -29568.779574730706, "episode_reward_min": -30233.345798788116, "episode_reward_mean": -29922.959364327064, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-29984.44880312825, -29881.368547199767, -30025.403528519793, -29878.75064985404, -29764.403593913165, -29670.755210090556, -29568.779574730706, -29786.3891216829, -30057.63277585619, -29860.83813594021, -29741.915640969215, -29777.885634214686, -29976.21027442633, -29953.744760234193, -30108.26842092144, -29790.5915650707, -29783.214302088596, -29608.115626567964, -29991.074675852167, -29748.50214140118, -29968.645502783616, -29845.28743018343, -29833.87470671902, -29850.51406418121, -30097.885287719044, -29901.15529115687, -29759.689998074, -29891.947840988094, -30032.599978584898, -29804.044154568222, -29951.533957514817, -29937.63066043682, -29933.74484703228, -30139.950688976096, -29827.508910036497, -29855.852268362603, -30151.916052284887, -29945.921846470832, -29876.126214447297, -30123.29573822629, -29949.21956200145, -30018.650957774873, -30042.397093530824, -29927.452749041655, -30031.418424782692, -29806.615581414244, -29839.18189809488, -30007.78046845992, -29878.750381270766, -29947.274205578404, -30133.13085219224, -29902.218624990124, -29872.130656927475, -29859.728693872108, -29965.594650911324, -30064.04298742653, -29778.414620080992, -29864.984283157333, -29902.234597104536, -30108.7563019982, -29884.052520364767, -30174.632069893127, -30143.83973854518, -30151.07561909289, -29709.437134738244, -29754.698620915642, -30070.308814531836, -29993.26869500578, -29752.799588510075, -30043.48687502352, -29838.241144333268, -29920.611377895126, -29924.455142119088, -29811.5423120522, -29869.746231989895, -29761.5002540869, -30139.582092677083, -30035.73094352778, -30005.63178435851, -29652.122346541295, -30233.345798788116, -29839.15438020255, -29880.69717237495, -29868.909199066777, -29656.50942175287, -29786.387514156668, -29940.772096504068, -30112.522561288562, -29980.439121478223, -29984.4959975829, -30113.054436096532, -30023.27791941823, -29800.69896446871, -29887.260219338234, -29866.251375417585, -29860.21131238479, -30018.512591913997, -30019.601462185994, -30204.452278414577, -29995.223291650258], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.414411308656468, "mean_inference_ms": 0.24978858618093105, "mean_action_processing_ms": 0.058970182503153536, "mean_env_wait_ms": 1.5125079035279476, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002515077590942383, "StateBufferConnector_ms": 0.001760244369506836, "ViewRequirementAgentConnector_ms": 0.045195579528808594}}, "episode_reward_max": -29568.779574730706, "episode_reward_min": -30233.345798788116, "episode_reward_mean": -29922.959364327064, "episode_len_mean": 360.0, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-29984.44880312825, -29881.368547199767, -30025.403528519793, -29878.75064985404, -29764.403593913165, -29670.755210090556, -29568.779574730706, -29786.3891216829, -30057.63277585619, -29860.83813594021, -29741.915640969215, -29777.885634214686, -29976.21027442633, -29953.744760234193, -30108.26842092144, -29790.5915650707, -29783.214302088596, -29608.115626567964, -29991.074675852167, -29748.50214140118, -29968.645502783616, -29845.28743018343, -29833.87470671902, -29850.51406418121, -30097.885287719044, -29901.15529115687, -29759.689998074, -29891.947840988094, -30032.599978584898, -29804.044154568222, -29951.533957514817, -29937.63066043682, -29933.74484703228, -30139.950688976096, -29827.508910036497, -29855.852268362603, -30151.916052284887, -29945.921846470832, -29876.126214447297, -30123.29573822629, -29949.21956200145, -30018.650957774873, -30042.397093530824, -29927.452749041655, -30031.418424782692, -29806.615581414244, -29839.18189809488, -30007.78046845992, -29878.750381270766, -29947.274205578404, -30133.13085219224, -29902.218624990124, -29872.130656927475, -29859.728693872108, -29965.594650911324, -30064.04298742653, -29778.414620080992, -29864.984283157333, -29902.234597104536, -30108.7563019982, -29884.052520364767, -30174.632069893127, -30143.83973854518, -30151.07561909289, -29709.437134738244, -29754.698620915642, -30070.308814531836, -29993.26869500578, -29752.799588510075, -30043.48687502352, -29838.241144333268, -29920.611377895126, -29924.455142119088, -29811.5423120522, -29869.746231989895, -29761.5002540869, -30139.582092677083, -30035.73094352778, -30005.63178435851, -29652.122346541295, -30233.345798788116, -29839.15438020255, -29880.69717237495, -29868.909199066777, -29656.50942175287, -29786.387514156668, -29940.772096504068, -30112.522561288562, -29980.439121478223, -29984.4959975829, -30113.054436096532, -30023.27791941823, -29800.69896446871, -29887.260219338234, -29866.251375417585, -29860.21131238479, -30018.512591913997, -30019.601462185994, -30204.452278414577, -29995.223291650258], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.414411308656468, "mean_inference_ms": 0.24978858618093105, "mean_action_processing_ms": 0.058970182503153536, "mean_env_wait_ms": 1.5125079035279476, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002515077590942383, "StateBufferConnector_ms": 0.001760244369506836, "ViewRequirementAgentConnector_ms": 0.045195579528808594}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 60840, "num_agent_steps_trained": 60840, "num_env_steps_sampled": 60840, "num_env_steps_trained": 60840, "num_env_steps_sampled_this_iter": 1800, "num_env_steps_trained_this_iter": 1800, "num_env_steps_sampled_throughput_per_sec": 162.69055311166767, "num_env_steps_trained_throughput_per_sec": 162.69055311166767, "timesteps_total": 60840, "num_steps_trained_this_iter": 1800, "agent_timesteps_total": 60840, "timers": {"training_iteration_time_ms": 2211.417, "sample_time_ms": 2206.033, "load_time_ms": 0.213, "load_throughput": 1693148.06, "learn_time_ms": 4.622, "learn_throughput": 77893.475, "synch_weights_time_ms": 0.517}, "counters": {"num_env_steps_sampled": 60840, "num_env_steps_trained": 60840, "num_agent_steps_sampled": 60840, "num_agent_steps_trained": 60840}, "done": false, "episodes_total": 169, "training_iteration": 34, "trial_id": "4935e_00000", "date": "2023-07-25_15-52-58", "timestamp": 1690289578, "time_this_iter_s": 11.065935850143433, "time_total_s": 379.7278356552124, "pid": 67353, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[0, 0.003], [5400, 0.001], [10800, 0.00075], [16200, 0.0005], [21600, 0.00025], [27000, 0.0001], [32400, 7.5e-05], [37800, 5e-05], [43200, 2.5e-05], [48600, 1e-05], [54000, 7.5e-06], [59400, 5e-06], [64800, 2.5e-06], [70200, 1e-06], [75600, 5e-07], [81000, 1e-07]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x177531310>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 379.7278356552124, "iterations_since_restore": 34, "perf": {"cpu_util_percent": 22.346666666666668, "ram_util_percent": 79.38666666666667}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 3.666666666666667e-06, "entropy_coeff": 0.10000000000000002, "policy_entropy": -1859.8407389322917, "policy_loss": -312613881053184.0, "vf_loss": 2450089664.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 120.0, "num_grad_updates_lifetime": 521.0, "diff_num_grad_updates_vs_sampler_policy": 520.0}}, "num_env_steps_sampled": 62640, "num_env_steps_trained": 62640, "num_agent_steps_sampled": 62640, "num_agent_steps_trained": 62640}, "sampler_results": {"episode_reward_max": -29568.779574730706, "episode_reward_min": -30233.345798788116, "episode_reward_mean": -29916.105613870208, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-29670.755210090556, -29568.779574730706, -29786.3891216829, -30057.63277585619, -29860.83813594021, -29741.915640969215, -29777.885634214686, -29976.21027442633, -29953.744760234193, -30108.26842092144, -29790.5915650707, -29783.214302088596, -29608.115626567964, -29991.074675852167, -29748.50214140118, -29968.645502783616, -29845.28743018343, -29833.87470671902, -29850.51406418121, -30097.885287719044, -29901.15529115687, -29759.689998074, -29891.947840988094, -30032.599978584898, -29804.044154568222, -29951.533957514817, -29937.63066043682, -29933.74484703228, -30139.950688976096, -29827.508910036497, -29855.852268362603, -30151.916052284887, -29945.921846470832, -29876.126214447297, -30123.29573822629, -29949.21956200145, -30018.650957774873, -30042.397093530824, -29927.452749041655, -30031.418424782692, -29806.615581414244, -29839.18189809488, -30007.78046845992, -29878.750381270766, -29947.274205578404, -30133.13085219224, -29902.218624990124, -29872.130656927475, -29859.728693872108, -29965.594650911324, -30064.04298742653, -29778.414620080992, -29864.984283157333, -29902.234597104536, -30108.7563019982, -29884.052520364767, -30174.632069893127, -30143.83973854518, -30151.07561909289, -29709.437134738244, -29754.698620915642, -30070.308814531836, -29993.26869500578, -29752.799588510075, -30043.48687502352, -29838.241144333268, -29920.611377895126, -29924.455142119088, -29811.5423120522, -29869.746231989895, -29761.5002540869, -30139.582092677083, -30035.73094352778, -30005.63178435851, -29652.122346541295, -30233.345798788116, -29839.15438020255, -29880.69717237495, -29868.909199066777, -29656.50942175287, -29786.387514156668, -29940.772096504068, -30112.522561288562, -29980.439121478223, -29984.4959975829, -30113.054436096532, -30023.27791941823, -29800.69896446871, -29887.260219338234, -29866.251375417585, -29860.21131238479, -30018.512591913997, -30019.601462185994, -30204.452278414577, -29995.223291650258, -29732.67275139709, -29725.906849650288, -29943.414783710286, -29718.729913982388, -29728.27577818911], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.413412664013424, "mean_inference_ms": 0.24980688640903145, "mean_action_processing_ms": 0.05896845139667477, "mean_env_wait_ms": 1.5097623359315322, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0025131702423095703, "StateBufferConnector_ms": 0.0017590522766113281, "ViewRequirementAgentConnector_ms": 0.045185089111328125}}, "episode_reward_max": -29568.779574730706, "episode_reward_min": -30233.345798788116, "episode_reward_mean": -29916.105613870208, "episode_len_mean": 360.0, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-29670.755210090556, -29568.779574730706, -29786.3891216829, -30057.63277585619, -29860.83813594021, -29741.915640969215, -29777.885634214686, -29976.21027442633, -29953.744760234193, -30108.26842092144, -29790.5915650707, -29783.214302088596, -29608.115626567964, -29991.074675852167, -29748.50214140118, -29968.645502783616, -29845.28743018343, -29833.87470671902, -29850.51406418121, -30097.885287719044, -29901.15529115687, -29759.689998074, -29891.947840988094, -30032.599978584898, -29804.044154568222, -29951.533957514817, -29937.63066043682, -29933.74484703228, -30139.950688976096, -29827.508910036497, -29855.852268362603, -30151.916052284887, -29945.921846470832, -29876.126214447297, -30123.29573822629, -29949.21956200145, -30018.650957774873, -30042.397093530824, -29927.452749041655, -30031.418424782692, -29806.615581414244, -29839.18189809488, -30007.78046845992, -29878.750381270766, -29947.274205578404, -30133.13085219224, -29902.218624990124, -29872.130656927475, -29859.728693872108, -29965.594650911324, -30064.04298742653, -29778.414620080992, -29864.984283157333, -29902.234597104536, -30108.7563019982, -29884.052520364767, -30174.632069893127, -30143.83973854518, -30151.07561909289, -29709.437134738244, -29754.698620915642, -30070.308814531836, -29993.26869500578, -29752.799588510075, -30043.48687502352, -29838.241144333268, -29920.611377895126, -29924.455142119088, -29811.5423120522, -29869.746231989895, -29761.5002540869, -30139.582092677083, -30035.73094352778, -30005.63178435851, -29652.122346541295, -30233.345798788116, -29839.15438020255, -29880.69717237495, -29868.909199066777, -29656.50942175287, -29786.387514156668, -29940.772096504068, -30112.522561288562, -29980.439121478223, -29984.4959975829, -30113.054436096532, -30023.27791941823, -29800.69896446871, -29887.260219338234, -29866.251375417585, -29860.21131238479, -30018.512591913997, -30019.601462185994, -30204.452278414577, -29995.223291650258, -29732.67275139709, -29725.906849650288, -29943.414783710286, -29718.729913982388, -29728.27577818911], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.413412664013424, "mean_inference_ms": 0.24980688640903145, "mean_action_processing_ms": 0.05896845139667477, "mean_env_wait_ms": 1.5097623359315322, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0025131702423095703, "StateBufferConnector_ms": 0.0017590522766113281, "ViewRequirementAgentConnector_ms": 0.045185089111328125}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 62640, "num_agent_steps_trained": 62640, "num_env_steps_sampled": 62640, "num_env_steps_trained": 62640, "num_env_steps_sampled_this_iter": 1800, "num_env_steps_trained_this_iter": 1800, "num_env_steps_sampled_throughput_per_sec": 161.596346250622, "num_env_steps_trained_throughput_per_sec": 161.596346250622, "timesteps_total": 62640, "num_steps_trained_this_iter": 1800, "agent_timesteps_total": 62640, "timers": {"training_iteration_time_ms": 2220.27, "sample_time_ms": 2214.484, "load_time_ms": 0.219, "load_throughput": 1646798.386, "learn_time_ms": 4.96, "learn_throughput": 72578.37, "synch_weights_time_ms": 0.567}, "counters": {"num_env_steps_sampled": 62640, "num_env_steps_trained": 62640, "num_agent_steps_sampled": 62640, "num_agent_steps_trained": 62640}, "done": false, "episodes_total": 174, "training_iteration": 35, "trial_id": "4935e_00000", "date": "2023-07-25_15-53-09", "timestamp": 1690289589, "time_this_iter_s": 11.141165256500244, "time_total_s": 390.86900091171265, "pid": 67353, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[0, 0.003], [5400, 0.001], [10800, 0.00075], [16200, 0.0005], [21600, 0.00025], [27000, 0.0001], [32400, 7.5e-05], [37800, 5e-05], [43200, 2.5e-05], [48600, 1e-05], [54000, 7.5e-06], [59400, 5e-06], [64800, 2.5e-06], [70200, 1e-06], [75600, 5e-07], [81000, 1e-07]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x177531310>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 390.86900091171265, "iterations_since_restore": 35, "perf": {"cpu_util_percent": 24.55, "ram_util_percent": 79.375}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 2.8333333333333335e-06, "entropy_coeff": 0.10000000000000002, "policy_entropy": -1859.8406982421875, "policy_loss": -196819478659072.0, "vf_loss": 2473262549.3333335}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 120.0, "num_grad_updates_lifetime": 536.0, "diff_num_grad_updates_vs_sampler_policy": 535.0}}, "num_env_steps_sampled": 64440, "num_env_steps_trained": 64440, "num_agent_steps_sampled": 64440, "num_agent_steps_trained": 64440}, "sampler_results": {"episode_reward_max": -29585.311827919053, "episode_reward_min": -30233.345798788116, "episode_reward_mean": -29915.885638687243, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-29741.915640969215, -29777.885634214686, -29976.21027442633, -29953.744760234193, -30108.26842092144, -29790.5915650707, -29783.214302088596, -29608.115626567964, -29991.074675852167, -29748.50214140118, -29968.645502783616, -29845.28743018343, -29833.87470671902, -29850.51406418121, -30097.885287719044, -29901.15529115687, -29759.689998074, -29891.947840988094, -30032.599978584898, -29804.044154568222, -29951.533957514817, -29937.63066043682, -29933.74484703228, -30139.950688976096, -29827.508910036497, -29855.852268362603, -30151.916052284887, -29945.921846470832, -29876.126214447297, -30123.29573822629, -29949.21956200145, -30018.650957774873, -30042.397093530824, -29927.452749041655, -30031.418424782692, -29806.615581414244, -29839.18189809488, -30007.78046845992, -29878.750381270766, -29947.274205578404, -30133.13085219224, -29902.218624990124, -29872.130656927475, -29859.728693872108, -29965.594650911324, -30064.04298742653, -29778.414620080992, -29864.984283157333, -29902.234597104536, -30108.7563019982, -29884.052520364767, -30174.632069893127, -30143.83973854518, -30151.07561909289, -29709.437134738244, -29754.698620915642, -30070.308814531836, -29993.26869500578, -29752.799588510075, -30043.48687502352, -29838.241144333268, -29920.611377895126, -29924.455142119088, -29811.5423120522, -29869.746231989895, -29761.5002540869, -30139.582092677083, -30035.73094352778, -30005.63178435851, -29652.122346541295, -30233.345798788116, -29839.15438020255, -29880.69717237495, -29868.909199066777, -29656.50942175287, -29786.387514156668, -29940.772096504068, -30112.522561288562, -29980.439121478223, -29984.4959975829, -30113.054436096532, -30023.27791941823, -29800.69896446871, -29887.260219338234, -29866.251375417585, -29860.21131238479, -30018.512591913997, -30019.601462185994, -30204.452278414577, -29995.223291650258, -29732.67275139709, -29725.906849650288, -29943.414783710286, -29718.729913982388, -29728.27577818911, -29724.936695805318, -29837.831322222362, -29958.293524780096, -29585.311827919053, -29816.02392927729], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.412520808325097, "mean_inference_ms": 0.24981902576597925, "mean_action_processing_ms": 0.05896600973335591, "mean_env_wait_ms": 1.50715409542474, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002507925033569336, "StateBufferConnector_ms": 0.0017600059509277344, "ViewRequirementAgentConnector_ms": 0.045169830322265625}}, "episode_reward_max": -29585.311827919053, "episode_reward_min": -30233.345798788116, "episode_reward_mean": -29915.885638687243, "episode_len_mean": 360.0, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-29741.915640969215, -29777.885634214686, -29976.21027442633, -29953.744760234193, -30108.26842092144, -29790.5915650707, -29783.214302088596, -29608.115626567964, -29991.074675852167, -29748.50214140118, -29968.645502783616, -29845.28743018343, -29833.87470671902, -29850.51406418121, -30097.885287719044, -29901.15529115687, -29759.689998074, -29891.947840988094, -30032.599978584898, -29804.044154568222, -29951.533957514817, -29937.63066043682, -29933.74484703228, -30139.950688976096, -29827.508910036497, -29855.852268362603, -30151.916052284887, -29945.921846470832, -29876.126214447297, -30123.29573822629, -29949.21956200145, -30018.650957774873, -30042.397093530824, -29927.452749041655, -30031.418424782692, -29806.615581414244, -29839.18189809488, -30007.78046845992, -29878.750381270766, -29947.274205578404, -30133.13085219224, -29902.218624990124, -29872.130656927475, -29859.728693872108, -29965.594650911324, -30064.04298742653, -29778.414620080992, -29864.984283157333, -29902.234597104536, -30108.7563019982, -29884.052520364767, -30174.632069893127, -30143.83973854518, -30151.07561909289, -29709.437134738244, -29754.698620915642, -30070.308814531836, -29993.26869500578, -29752.799588510075, -30043.48687502352, -29838.241144333268, -29920.611377895126, -29924.455142119088, -29811.5423120522, -29869.746231989895, -29761.5002540869, -30139.582092677083, -30035.73094352778, -30005.63178435851, -29652.122346541295, -30233.345798788116, -29839.15438020255, -29880.69717237495, -29868.909199066777, -29656.50942175287, -29786.387514156668, -29940.772096504068, -30112.522561288562, -29980.439121478223, -29984.4959975829, -30113.054436096532, -30023.27791941823, -29800.69896446871, -29887.260219338234, -29866.251375417585, -29860.21131238479, -30018.512591913997, -30019.601462185994, -30204.452278414577, -29995.223291650258, -29732.67275139709, -29725.906849650288, -29943.414783710286, -29718.729913982388, -29728.27577818911, -29724.936695805318, -29837.831322222362, -29958.293524780096, -29585.311827919053, -29816.02392927729], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.412520808325097, "mean_inference_ms": 0.24981902576597925, "mean_action_processing_ms": 0.05896600973335591, "mean_env_wait_ms": 1.50715409542474, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002507925033569336, "StateBufferConnector_ms": 0.0017600059509277344, "ViewRequirementAgentConnector_ms": 0.045169830322265625}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 64440, "num_agent_steps_trained": 64440, "num_env_steps_sampled": 64440, "num_env_steps_trained": 64440, "num_env_steps_sampled_this_iter": 1800, "num_env_steps_trained_this_iter": 1800, "num_env_steps_sampled_throughput_per_sec": 161.58531329947948, "num_env_steps_trained_throughput_per_sec": 161.58531329947948, "timesteps_total": 64440, "num_steps_trained_this_iter": 1800, "agent_timesteps_total": 64440, "timers": {"training_iteration_time_ms": 2227.838, "sample_time_ms": 2222.089, "load_time_ms": 0.219, "load_throughput": 1646080.279, "learn_time_ms": 4.921, "learn_throughput": 73156.82, "synch_weights_time_ms": 0.569}, "counters": {"num_env_steps_sampled": 64440, "num_env_steps_trained": 64440, "num_agent_steps_sampled": 64440, "num_agent_steps_trained": 64440}, "done": false, "episodes_total": 179, "training_iteration": 36, "trial_id": "4935e_00000", "date": "2023-07-25_15-53-20", "timestamp": 1690289600, "time_this_iter_s": 11.141937971115112, "time_total_s": 402.01093888282776, "pid": 67353, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[0, 0.003], [5400, 0.001], [10800, 0.00075], [16200, 0.0005], [21600, 0.00025], [27000, 0.0001], [32400, 7.5e-05], [37800, 5e-05], [43200, 2.5e-05], [48600, 1e-05], [54000, 7.5e-06], [59400, 5e-06], [64800, 2.5e-06], [70200, 1e-06], [75600, 5e-07], [81000, 1e-07]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x177531310>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 402.01093888282776, "iterations_since_restore": 36, "perf": {"cpu_util_percent": 22.475, "ram_util_percent": 79.50625000000001}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 2.2e-06, "entropy_coeff": 0.10000000000000002, "policy_entropy": -1859.8420003255208, "policy_loss": -181499235173717.34, "vf_loss": 2488911850.6666665}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 120.0, "num_grad_updates_lifetime": 551.0, "diff_num_grad_updates_vs_sampler_policy": 550.0}}, "num_env_steps_sampled": 66240, "num_env_steps_trained": 66240, "num_agent_steps_sampled": 66240, "num_agent_steps_trained": 66240}, "sampler_results": {"episode_reward_max": -29585.311827919053, "episode_reward_min": -30233.345798788116, "episode_reward_mean": -29913.228038377318, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-29790.5915650707, -29783.214302088596, -29608.115626567964, -29991.074675852167, -29748.50214140118, -29968.645502783616, -29845.28743018343, -29833.87470671902, -29850.51406418121, -30097.885287719044, -29901.15529115687, -29759.689998074, -29891.947840988094, -30032.599978584898, -29804.044154568222, -29951.533957514817, -29937.63066043682, -29933.74484703228, -30139.950688976096, -29827.508910036497, -29855.852268362603, -30151.916052284887, -29945.921846470832, -29876.126214447297, -30123.29573822629, -29949.21956200145, -30018.650957774873, -30042.397093530824, -29927.452749041655, -30031.418424782692, -29806.615581414244, -29839.18189809488, -30007.78046845992, -29878.750381270766, -29947.274205578404, -30133.13085219224, -29902.218624990124, -29872.130656927475, -29859.728693872108, -29965.594650911324, -30064.04298742653, -29778.414620080992, -29864.984283157333, -29902.234597104536, -30108.7563019982, -29884.052520364767, -30174.632069893127, -30143.83973854518, -30151.07561909289, -29709.437134738244, -29754.698620915642, -30070.308814531836, -29993.26869500578, -29752.799588510075, -30043.48687502352, -29838.241144333268, -29920.611377895126, -29924.455142119088, -29811.5423120522, -29869.746231989895, -29761.5002540869, -30139.582092677083, -30035.73094352778, -30005.63178435851, -29652.122346541295, -30233.345798788116, -29839.15438020255, -29880.69717237495, -29868.909199066777, -29656.50942175287, -29786.387514156668, -29940.772096504068, -30112.522561288562, -29980.439121478223, -29984.4959975829, -30113.054436096532, -30023.27791941823, -29800.69896446871, -29887.260219338234, -29866.251375417585, -29860.21131238479, -30018.512591913997, -30019.601462185994, -30204.452278414577, -29995.223291650258, -29732.67275139709, -29725.906849650288, -29943.414783710286, -29718.729913982388, -29728.27577818911, -29724.936695805318, -29837.831322222362, -29958.293524780096, -29585.311827919053, -29816.02392927729, -29695.265333660434, -29852.20611686021, -30018.171670373737, -29875.327304266277, -29851.294274613432], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.411688276749187, "mean_inference_ms": 0.24983655331223564, "mean_action_processing_ms": 0.05896438501740578, "mean_env_wait_ms": 1.5047781565885459, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002505064010620117, "StateBufferConnector_ms": 0.0017600059509277344, "ViewRequirementAgentConnector_ms": 0.045081138610839844}}, "episode_reward_max": -29585.311827919053, "episode_reward_min": -30233.345798788116, "episode_reward_mean": -29913.228038377318, "episode_len_mean": 360.0, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-29790.5915650707, -29783.214302088596, -29608.115626567964, -29991.074675852167, -29748.50214140118, -29968.645502783616, -29845.28743018343, -29833.87470671902, -29850.51406418121, -30097.885287719044, -29901.15529115687, -29759.689998074, -29891.947840988094, -30032.599978584898, -29804.044154568222, -29951.533957514817, -29937.63066043682, -29933.74484703228, -30139.950688976096, -29827.508910036497, -29855.852268362603, -30151.916052284887, -29945.921846470832, -29876.126214447297, -30123.29573822629, -29949.21956200145, -30018.650957774873, -30042.397093530824, -29927.452749041655, -30031.418424782692, -29806.615581414244, -29839.18189809488, -30007.78046845992, -29878.750381270766, -29947.274205578404, -30133.13085219224, -29902.218624990124, -29872.130656927475, -29859.728693872108, -29965.594650911324, -30064.04298742653, -29778.414620080992, -29864.984283157333, -29902.234597104536, -30108.7563019982, -29884.052520364767, -30174.632069893127, -30143.83973854518, -30151.07561909289, -29709.437134738244, -29754.698620915642, -30070.308814531836, -29993.26869500578, -29752.799588510075, -30043.48687502352, -29838.241144333268, -29920.611377895126, -29924.455142119088, -29811.5423120522, -29869.746231989895, -29761.5002540869, -30139.582092677083, -30035.73094352778, -30005.63178435851, -29652.122346541295, -30233.345798788116, -29839.15438020255, -29880.69717237495, -29868.909199066777, -29656.50942175287, -29786.387514156668, -29940.772096504068, -30112.522561288562, -29980.439121478223, -29984.4959975829, -30113.054436096532, -30023.27791941823, -29800.69896446871, -29887.260219338234, -29866.251375417585, -29860.21131238479, -30018.512591913997, -30019.601462185994, -30204.452278414577, -29995.223291650258, -29732.67275139709, -29725.906849650288, -29943.414783710286, -29718.729913982388, -29728.27577818911, -29724.936695805318, -29837.831322222362, -29958.293524780096, -29585.311827919053, -29816.02392927729, -29695.265333660434, -29852.20611686021, -30018.171670373737, -29875.327304266277, -29851.294274613432], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.411688276749187, "mean_inference_ms": 0.24983655331223564, "mean_action_processing_ms": 0.05896438501740578, "mean_env_wait_ms": 1.5047781565885459, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002505064010620117, "StateBufferConnector_ms": 0.0017600059509277344, "ViewRequirementAgentConnector_ms": 0.045081138610839844}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 66240, "num_agent_steps_trained": 66240, "num_env_steps_sampled": 66240, "num_env_steps_trained": 66240, "num_env_steps_sampled_this_iter": 1800, "num_env_steps_trained_this_iter": 1800, "num_env_steps_sampled_throughput_per_sec": 161.8954140334014, "num_env_steps_trained_throughput_per_sec": 161.8954140334014, "timesteps_total": 66240, "num_steps_trained_this_iter": 1800, "agent_timesteps_total": 66240, "timers": {"training_iteration_time_ms": 2225.779, "sample_time_ms": 2220.414, "load_time_ms": 0.215, "load_throughput": 1671037.45, "learn_time_ms": 4.61, "learn_throughput": 78088.447, "synch_weights_time_ms": 0.507}, "counters": {"num_env_steps_sampled": 66240, "num_env_steps_trained": 66240, "num_agent_steps_sampled": 66240, "num_agent_steps_trained": 66240}, "done": false, "episodes_total": 184, "training_iteration": 37, "trial_id": "4935e_00000", "date": "2023-07-25_15-53-31", "timestamp": 1690289611, "time_this_iter_s": 11.120582103729248, "time_total_s": 413.131520986557, "pid": 67353, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[0, 0.003], [5400, 0.001], [10800, 0.00075], [16200, 0.0005], [21600, 0.00025], [27000, 0.0001], [32400, 7.5e-05], [37800, 5e-05], [43200, 2.5e-05], [48600, 1e-05], [54000, 7.5e-06], [59400, 5e-06], [64800, 2.5e-06], [70200, 1e-06], [75600, 5e-07], [81000, 1e-07]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x177531310>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 413.131520986557, "iterations_since_restore": 37, "perf": {"cpu_util_percent": 24.125, "ram_util_percent": 79.43124999999999}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1.7e-06, "entropy_coeff": 0.10000000000000002, "policy_entropy": -1859.8452962239583, "policy_loss": -84440960223914.67, "vf_loss": 2491319893.3333335}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 120.0, "num_grad_updates_lifetime": 566.0, "diff_num_grad_updates_vs_sampler_policy": 565.0}}, "num_env_steps_sampled": 68040, "num_env_steps_trained": 68040, "num_agent_steps_sampled": 68040, "num_agent_steps_trained": 68040}, "sampler_results": {"episode_reward_max": -29585.311827919053, "episode_reward_min": -30233.345798788116, "episode_reward_mean": -29917.464942360482, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-29968.645502783616, -29845.28743018343, -29833.87470671902, -29850.51406418121, -30097.885287719044, -29901.15529115687, -29759.689998074, -29891.947840988094, -30032.599978584898, -29804.044154568222, -29951.533957514817, -29937.63066043682, -29933.74484703228, -30139.950688976096, -29827.508910036497, -29855.852268362603, -30151.916052284887, -29945.921846470832, -29876.126214447297, -30123.29573822629, -29949.21956200145, -30018.650957774873, -30042.397093530824, -29927.452749041655, -30031.418424782692, -29806.615581414244, -29839.18189809488, -30007.78046845992, -29878.750381270766, -29947.274205578404, -30133.13085219224, -29902.218624990124, -29872.130656927475, -29859.728693872108, -29965.594650911324, -30064.04298742653, -29778.414620080992, -29864.984283157333, -29902.234597104536, -30108.7563019982, -29884.052520364767, -30174.632069893127, -30143.83973854518, -30151.07561909289, -29709.437134738244, -29754.698620915642, -30070.308814531836, -29993.26869500578, -29752.799588510075, -30043.48687502352, -29838.241144333268, -29920.611377895126, -29924.455142119088, -29811.5423120522, -29869.746231989895, -29761.5002540869, -30139.582092677083, -30035.73094352778, -30005.63178435851, -29652.122346541295, -30233.345798788116, -29839.15438020255, -29880.69717237495, -29868.909199066777, -29656.50942175287, -29786.387514156668, -29940.772096504068, -30112.522561288562, -29980.439121478223, -29984.4959975829, -30113.054436096532, -30023.27791941823, -29800.69896446871, -29887.260219338234, -29866.251375417585, -29860.21131238479, -30018.512591913997, -30019.601462185994, -30204.452278414577, -29995.223291650258, -29732.67275139709, -29725.906849650288, -29943.414783710286, -29718.729913982388, -29728.27577818911, -29724.936695805318, -29837.831322222362, -29958.293524780096, -29585.311827919053, -29816.02392927729, -29695.265333660434, -29852.20611686021, -30018.171670373737, -29875.327304266277, -29851.294274613432, -29756.35552602704, -29692.812524018445, -29910.092514829263, -30110.1876900806, -29875.740454341816], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.410852353023001, "mean_inference_ms": 0.24985264465421872, "mean_action_processing_ms": 0.05896246601553097, "mean_env_wait_ms": 1.502547917717087, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0025038719177246094, "StateBufferConnector_ms": 0.0017635822296142578, "ViewRequirementAgentConnector_ms": 0.04508090019226074}}, "episode_reward_max": -29585.311827919053, "episode_reward_min": -30233.345798788116, "episode_reward_mean": -29917.464942360482, "episode_len_mean": 360.0, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-29968.645502783616, -29845.28743018343, -29833.87470671902, -29850.51406418121, -30097.885287719044, -29901.15529115687, -29759.689998074, -29891.947840988094, -30032.599978584898, -29804.044154568222, -29951.533957514817, -29937.63066043682, -29933.74484703228, -30139.950688976096, -29827.508910036497, -29855.852268362603, -30151.916052284887, -29945.921846470832, -29876.126214447297, -30123.29573822629, -29949.21956200145, -30018.650957774873, -30042.397093530824, -29927.452749041655, -30031.418424782692, -29806.615581414244, -29839.18189809488, -30007.78046845992, -29878.750381270766, -29947.274205578404, -30133.13085219224, -29902.218624990124, -29872.130656927475, -29859.728693872108, -29965.594650911324, -30064.04298742653, -29778.414620080992, -29864.984283157333, -29902.234597104536, -30108.7563019982, -29884.052520364767, -30174.632069893127, -30143.83973854518, -30151.07561909289, -29709.437134738244, -29754.698620915642, -30070.308814531836, -29993.26869500578, -29752.799588510075, -30043.48687502352, -29838.241144333268, -29920.611377895126, -29924.455142119088, -29811.5423120522, -29869.746231989895, -29761.5002540869, -30139.582092677083, -30035.73094352778, -30005.63178435851, -29652.122346541295, -30233.345798788116, -29839.15438020255, -29880.69717237495, -29868.909199066777, -29656.50942175287, -29786.387514156668, -29940.772096504068, -30112.522561288562, -29980.439121478223, -29984.4959975829, -30113.054436096532, -30023.27791941823, -29800.69896446871, -29887.260219338234, -29866.251375417585, -29860.21131238479, -30018.512591913997, -30019.601462185994, -30204.452278414577, -29995.223291650258, -29732.67275139709, -29725.906849650288, -29943.414783710286, -29718.729913982388, -29728.27577818911, -29724.936695805318, -29837.831322222362, -29958.293524780096, -29585.311827919053, -29816.02392927729, -29695.265333660434, -29852.20611686021, -30018.171670373737, -29875.327304266277, -29851.294274613432, -29756.35552602704, -29692.812524018445, -29910.092514829263, -30110.1876900806, -29875.740454341816], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.410852353023001, "mean_inference_ms": 0.24985264465421872, "mean_action_processing_ms": 0.05896246601553097, "mean_env_wait_ms": 1.502547917717087, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0025038719177246094, "StateBufferConnector_ms": 0.0017635822296142578, "ViewRequirementAgentConnector_ms": 0.04508090019226074}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 68040, "num_agent_steps_trained": 68040, "num_env_steps_sampled": 68040, "num_env_steps_trained": 68040, "num_env_steps_sampled_this_iter": 1800, "num_env_steps_trained_this_iter": 1800, "num_env_steps_sampled_throughput_per_sec": 161.68953618649462, "num_env_steps_trained_throughput_per_sec": 161.68953618649462, "timesteps_total": 68040, "num_steps_trained_this_iter": 1800, "agent_timesteps_total": 68040, "timers": {"training_iteration_time_ms": 2225.062, "sample_time_ms": 2219.645, "load_time_ms": 0.215, "load_throughput": 1677721.6, "learn_time_ms": 4.67, "learn_throughput": 77095.272, "synch_weights_time_ms": 0.5}, "counters": {"num_env_steps_sampled": 68040, "num_env_steps_trained": 68040, "num_agent_steps_sampled": 68040, "num_agent_steps_trained": 68040}, "done": false, "episodes_total": 189, "training_iteration": 38, "trial_id": "4935e_00000", "date": "2023-07-25_15-53-43", "timestamp": 1690289623, "time_this_iter_s": 11.134420156478882, "time_total_s": 424.2659411430359, "pid": 67353, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[0, 0.003], [5400, 0.001], [10800, 0.00075], [16200, 0.0005], [21600, 0.00025], [27000, 0.0001], [32400, 7.5e-05], [37800, 5e-05], [43200, 2.5e-05], [48600, 1e-05], [54000, 7.5e-06], [59400, 5e-06], [64800, 2.5e-06], [70200, 1e-06], [75600, 5e-07], [81000, 1e-07]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x177531310>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 424.2659411430359, "iterations_since_restore": 38, "perf": {"cpu_util_percent": 22.575000000000003, "ram_util_percent": 79.4875}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1.2e-06, "entropy_coeff": 0.10000000000000002, "policy_entropy": -1859.8463134765625, "policy_loss": -175644335232341.34, "vf_loss": 2516942912.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 120.0, "num_grad_updates_lifetime": 581.0, "diff_num_grad_updates_vs_sampler_policy": 580.0}}, "num_env_steps_sampled": 69840, "num_env_steps_trained": 69840, "num_agent_steps_sampled": 69840, "num_agent_steps_trained": 69840}, "sampler_results": {"episode_reward_max": -29585.311827919053, "episode_reward_min": -30233.345798788116, "episode_reward_mean": -29920.716906314843, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-29901.15529115687, -29759.689998074, -29891.947840988094, -30032.599978584898, -29804.044154568222, -29951.533957514817, -29937.63066043682, -29933.74484703228, -30139.950688976096, -29827.508910036497, -29855.852268362603, -30151.916052284887, -29945.921846470832, -29876.126214447297, -30123.29573822629, -29949.21956200145, -30018.650957774873, -30042.397093530824, -29927.452749041655, -30031.418424782692, -29806.615581414244, -29839.18189809488, -30007.78046845992, -29878.750381270766, -29947.274205578404, -30133.13085219224, -29902.218624990124, -29872.130656927475, -29859.728693872108, -29965.594650911324, -30064.04298742653, -29778.414620080992, -29864.984283157333, -29902.234597104536, -30108.7563019982, -29884.052520364767, -30174.632069893127, -30143.83973854518, -30151.07561909289, -29709.437134738244, -29754.698620915642, -30070.308814531836, -29993.26869500578, -29752.799588510075, -30043.48687502352, -29838.241144333268, -29920.611377895126, -29924.455142119088, -29811.5423120522, -29869.746231989895, -29761.5002540869, -30139.582092677083, -30035.73094352778, -30005.63178435851, -29652.122346541295, -30233.345798788116, -29839.15438020255, -29880.69717237495, -29868.909199066777, -29656.50942175287, -29786.387514156668, -29940.772096504068, -30112.522561288562, -29980.439121478223, -29984.4959975829, -30113.054436096532, -30023.27791941823, -29800.69896446871, -29887.260219338234, -29866.251375417585, -29860.21131238479, -30018.512591913997, -30019.601462185994, -30204.452278414577, -29995.223291650258, -29732.67275139709, -29725.906849650288, -29943.414783710286, -29718.729913982388, -29728.27577818911, -29724.936695805318, -29837.831322222362, -29958.293524780096, -29585.311827919053, -29816.02392927729, -29695.265333660434, -29852.20611686021, -30018.171670373737, -29875.327304266277, -29851.294274613432, -29756.35552602704, -29692.812524018445, -29910.092514829263, -30110.1876900806, -29875.740454341816, -29984.19355397358, -29858.82987325074, -29871.259264531935, -30131.13362484784, -30075.987070417603], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.41000196491373, "mean_inference_ms": 0.2498736313539222, "mean_action_processing_ms": 0.05896165651114445, "mean_env_wait_ms": 1.5005079325674253, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002507448196411133, "StateBufferConnector_ms": 0.0017590522766113281, "ViewRequirementAgentConnector_ms": 0.0450596809387207}}, "episode_reward_max": -29585.311827919053, "episode_reward_min": -30233.345798788116, "episode_reward_mean": -29920.716906314843, "episode_len_mean": 360.0, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-29901.15529115687, -29759.689998074, -29891.947840988094, -30032.599978584898, -29804.044154568222, -29951.533957514817, -29937.63066043682, -29933.74484703228, -30139.950688976096, -29827.508910036497, -29855.852268362603, -30151.916052284887, -29945.921846470832, -29876.126214447297, -30123.29573822629, -29949.21956200145, -30018.650957774873, -30042.397093530824, -29927.452749041655, -30031.418424782692, -29806.615581414244, -29839.18189809488, -30007.78046845992, -29878.750381270766, -29947.274205578404, -30133.13085219224, -29902.218624990124, -29872.130656927475, -29859.728693872108, -29965.594650911324, -30064.04298742653, -29778.414620080992, -29864.984283157333, -29902.234597104536, -30108.7563019982, -29884.052520364767, -30174.632069893127, -30143.83973854518, -30151.07561909289, -29709.437134738244, -29754.698620915642, -30070.308814531836, -29993.26869500578, -29752.799588510075, -30043.48687502352, -29838.241144333268, -29920.611377895126, -29924.455142119088, -29811.5423120522, -29869.746231989895, -29761.5002540869, -30139.582092677083, -30035.73094352778, -30005.63178435851, -29652.122346541295, -30233.345798788116, -29839.15438020255, -29880.69717237495, -29868.909199066777, -29656.50942175287, -29786.387514156668, -29940.772096504068, -30112.522561288562, -29980.439121478223, -29984.4959975829, -30113.054436096532, -30023.27791941823, -29800.69896446871, -29887.260219338234, -29866.251375417585, -29860.21131238479, -30018.512591913997, -30019.601462185994, -30204.452278414577, -29995.223291650258, -29732.67275139709, -29725.906849650288, -29943.414783710286, -29718.729913982388, -29728.27577818911, -29724.936695805318, -29837.831322222362, -29958.293524780096, -29585.311827919053, -29816.02392927729, -29695.265333660434, -29852.20611686021, -30018.171670373737, -29875.327304266277, -29851.294274613432, -29756.35552602704, -29692.812524018445, -29910.092514829263, -30110.1876900806, -29875.740454341816, -29984.19355397358, -29858.82987325074, -29871.259264531935, -30131.13362484784, -30075.987070417603], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.41000196491373, "mean_inference_ms": 0.2498736313539222, "mean_action_processing_ms": 0.05896165651114445, "mean_env_wait_ms": 1.5005079325674253, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002507448196411133, "StateBufferConnector_ms": 0.0017590522766113281, "ViewRequirementAgentConnector_ms": 0.0450596809387207}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 69840, "num_agent_steps_trained": 69840, "num_env_steps_sampled": 69840, "num_env_steps_trained": 69840, "num_env_steps_sampled_this_iter": 1800, "num_env_steps_trained_this_iter": 1800, "num_env_steps_sampled_throughput_per_sec": 162.42324491719774, "num_env_steps_trained_throughput_per_sec": 162.42324491719774, "timesteps_total": 69840, "num_steps_trained_this_iter": 1800, "agent_timesteps_total": 69840, "timers": {"training_iteration_time_ms": 2221.451, "sample_time_ms": 2216.064, "load_time_ms": 0.214, "load_throughput": 1682582.394, "learn_time_ms": 4.632, "learn_throughput": 77718.272, "synch_weights_time_ms": 0.509}, "counters": {"num_env_steps_sampled": 69840, "num_env_steps_trained": 69840, "num_agent_steps_sampled": 69840, "num_agent_steps_trained": 69840}, "done": false, "episodes_total": 194, "training_iteration": 39, "trial_id": "4935e_00000", "date": "2023-07-25_15-53-54", "timestamp": 1690289634, "time_this_iter_s": 11.084264039993286, "time_total_s": 435.3502051830292, "pid": 67353, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[0, 0.003], [5400, 0.001], [10800, 0.00075], [16200, 0.0005], [21600, 0.00025], [27000, 0.0001], [32400, 7.5e-05], [37800, 5e-05], [43200, 2.5e-05], [48600, 1e-05], [54000, 7.5e-06], [59400, 5e-06], [64800, 2.5e-06], [70200, 1e-06], [75600, 5e-07], [81000, 1e-07]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x177531310>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 435.3502051830292, "iterations_since_restore": 39, "perf": {"cpu_util_percent": 23.9, "ram_util_percent": 79.40666666666667}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 9e-07, "entropy_coeff": 0.10000000000000002, "policy_entropy": -1859.8467203776042, "policy_loss": -159534056484864.0, "vf_loss": 2461074560.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 120.0, "num_grad_updates_lifetime": 596.0, "diff_num_grad_updates_vs_sampler_policy": 595.0}}, "num_env_steps_sampled": 71640, "num_env_steps_trained": 71640, "num_agent_steps_sampled": 71640, "num_agent_steps_trained": 71640}, "sampler_results": {"episode_reward_max": -29585.311827919053, "episode_reward_min": -30233.345798788116, "episode_reward_mean": -29924.872903817613, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-29951.533957514817, -29937.63066043682, -29933.74484703228, -30139.950688976096, -29827.508910036497, -29855.852268362603, -30151.916052284887, -29945.921846470832, -29876.126214447297, -30123.29573822629, -29949.21956200145, -30018.650957774873, -30042.397093530824, -29927.452749041655, -30031.418424782692, -29806.615581414244, -29839.18189809488, -30007.78046845992, -29878.750381270766, -29947.274205578404, -30133.13085219224, -29902.218624990124, -29872.130656927475, -29859.728693872108, -29965.594650911324, -30064.04298742653, -29778.414620080992, -29864.984283157333, -29902.234597104536, -30108.7563019982, -29884.052520364767, -30174.632069893127, -30143.83973854518, -30151.07561909289, -29709.437134738244, -29754.698620915642, -30070.308814531836, -29993.26869500578, -29752.799588510075, -30043.48687502352, -29838.241144333268, -29920.611377895126, -29924.455142119088, -29811.5423120522, -29869.746231989895, -29761.5002540869, -30139.582092677083, -30035.73094352778, -30005.63178435851, -29652.122346541295, -30233.345798788116, -29839.15438020255, -29880.69717237495, -29868.909199066777, -29656.50942175287, -29786.387514156668, -29940.772096504068, -30112.522561288562, -29980.439121478223, -29984.4959975829, -30113.054436096532, -30023.27791941823, -29800.69896446871, -29887.260219338234, -29866.251375417585, -29860.21131238479, -30018.512591913997, -30019.601462185994, -30204.452278414577, -29995.223291650258, -29732.67275139709, -29725.906849650288, -29943.414783710286, -29718.729913982388, -29728.27577818911, -29724.936695805318, -29837.831322222362, -29958.293524780096, -29585.311827919053, -29816.02392927729, -29695.265333660434, -29852.20611686021, -30018.171670373737, -29875.327304266277, -29851.294274613432, -29756.35552602704, -29692.812524018445, -29910.092514829263, -30110.1876900806, -29875.740454341816, -29984.19355397358, -29858.82987325074, -29871.259264531935, -30131.13362484784, -30075.987070417603, -29833.424221843467, -30013.58085180937, -30105.616752690992, -30124.00592166468, -29728.40926564023], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.409265173198702, "mean_inference_ms": 0.24989346832869927, "mean_action_processing_ms": 0.05896106867147582, "mean_env_wait_ms": 1.4986034184995334, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002489805221557617, "StateBufferConnector_ms": 0.001753091812133789, "ViewRequirementAgentConnector_ms": 0.044905662536621094}}, "episode_reward_max": -29585.311827919053, "episode_reward_min": -30233.345798788116, "episode_reward_mean": -29924.872903817613, "episode_len_mean": 360.0, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-29951.533957514817, -29937.63066043682, -29933.74484703228, -30139.950688976096, -29827.508910036497, -29855.852268362603, -30151.916052284887, -29945.921846470832, -29876.126214447297, -30123.29573822629, -29949.21956200145, -30018.650957774873, -30042.397093530824, -29927.452749041655, -30031.418424782692, -29806.615581414244, -29839.18189809488, -30007.78046845992, -29878.750381270766, -29947.274205578404, -30133.13085219224, -29902.218624990124, -29872.130656927475, -29859.728693872108, -29965.594650911324, -30064.04298742653, -29778.414620080992, -29864.984283157333, -29902.234597104536, -30108.7563019982, -29884.052520364767, -30174.632069893127, -30143.83973854518, -30151.07561909289, -29709.437134738244, -29754.698620915642, -30070.308814531836, -29993.26869500578, -29752.799588510075, -30043.48687502352, -29838.241144333268, -29920.611377895126, -29924.455142119088, -29811.5423120522, -29869.746231989895, -29761.5002540869, -30139.582092677083, -30035.73094352778, -30005.63178435851, -29652.122346541295, -30233.345798788116, -29839.15438020255, -29880.69717237495, -29868.909199066777, -29656.50942175287, -29786.387514156668, -29940.772096504068, -30112.522561288562, -29980.439121478223, -29984.4959975829, -30113.054436096532, -30023.27791941823, -29800.69896446871, -29887.260219338234, -29866.251375417585, -29860.21131238479, -30018.512591913997, -30019.601462185994, -30204.452278414577, -29995.223291650258, -29732.67275139709, -29725.906849650288, -29943.414783710286, -29718.729913982388, -29728.27577818911, -29724.936695805318, -29837.831322222362, -29958.293524780096, -29585.311827919053, -29816.02392927729, -29695.265333660434, -29852.20611686021, -30018.171670373737, -29875.327304266277, -29851.294274613432, -29756.35552602704, -29692.812524018445, -29910.092514829263, -30110.1876900806, -29875.740454341816, -29984.19355397358, -29858.82987325074, -29871.259264531935, -30131.13362484784, -30075.987070417603, -29833.424221843467, -30013.58085180937, -30105.616752690992, -30124.00592166468, -29728.40926564023], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.409265173198702, "mean_inference_ms": 0.24989346832869927, "mean_action_processing_ms": 0.05896106867147582, "mean_env_wait_ms": 1.4986034184995334, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002489805221557617, "StateBufferConnector_ms": 0.001753091812133789, "ViewRequirementAgentConnector_ms": 0.044905662536621094}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 71640, "num_agent_steps_trained": 71640, "num_env_steps_sampled": 71640, "num_env_steps_trained": 71640, "num_env_steps_sampled_this_iter": 1800, "num_env_steps_trained_this_iter": 1800, "num_env_steps_sampled_throughput_per_sec": 160.99072960882847, "num_env_steps_trained_throughput_per_sec": 160.99072960882847, "timesteps_total": 71640, "num_steps_trained_this_iter": 1800, "agent_timesteps_total": 71640, "timers": {"training_iteration_time_ms": 2226.283, "sample_time_ms": 2220.792, "load_time_ms": 0.219, "load_throughput": 1645542.11, "learn_time_ms": 4.707, "learn_throughput": 76481.793, "synch_weights_time_ms": 0.531}, "counters": {"num_env_steps_sampled": 71640, "num_env_steps_trained": 71640, "num_agent_steps_sampled": 71640, "num_agent_steps_trained": 71640}, "done": false, "episodes_total": 199, "training_iteration": 40, "trial_id": "4935e_00000", "date": "2023-07-25_15-54-05", "timestamp": 1690289645, "time_this_iter_s": 11.182945966720581, "time_total_s": 446.53315114974976, "pid": 67353, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[0, 0.003], [5400, 0.001], [10800, 0.00075], [16200, 0.0005], [21600, 0.00025], [27000, 0.0001], [32400, 7.5e-05], [37800, 5e-05], [43200, 2.5e-05], [48600, 1e-05], [54000, 7.5e-06], [59400, 5e-06], [64800, 2.5e-06], [70200, 1e-06], [75600, 5e-07], [81000, 1e-07]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x177531310>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 446.53315114974976, "iterations_since_restore": 40, "perf": {"cpu_util_percent": 24.09375, "ram_util_percent": 79.28125}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 7.333333333333332e-07, "entropy_coeff": 0.10000000000000002, "policy_entropy": -1859.8468424479167, "policy_loss": -61387758764032.0, "vf_loss": 2424131456.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 120.0, "num_grad_updates_lifetime": 611.0, "diff_num_grad_updates_vs_sampler_policy": 610.0}}, "num_env_steps_sampled": 73440, "num_env_steps_trained": 73440, "num_agent_steps_sampled": 73440, "num_agent_steps_trained": 73440}, "sampler_results": {"episode_reward_max": -29493.622950342055, "episode_reward_min": -30233.345798788116, "episode_reward_mean": -29915.292728793196, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-29855.852268362603, -30151.916052284887, -29945.921846470832, -29876.126214447297, -30123.29573822629, -29949.21956200145, -30018.650957774873, -30042.397093530824, -29927.452749041655, -30031.418424782692, -29806.615581414244, -29839.18189809488, -30007.78046845992, -29878.750381270766, -29947.274205578404, -30133.13085219224, -29902.218624990124, -29872.130656927475, -29859.728693872108, -29965.594650911324, -30064.04298742653, -29778.414620080992, -29864.984283157333, -29902.234597104536, -30108.7563019982, -29884.052520364767, -30174.632069893127, -30143.83973854518, -30151.07561909289, -29709.437134738244, -29754.698620915642, -30070.308814531836, -29993.26869500578, -29752.799588510075, -30043.48687502352, -29838.241144333268, -29920.611377895126, -29924.455142119088, -29811.5423120522, -29869.746231989895, -29761.5002540869, -30139.582092677083, -30035.73094352778, -30005.63178435851, -29652.122346541295, -30233.345798788116, -29839.15438020255, -29880.69717237495, -29868.909199066777, -29656.50942175287, -29786.387514156668, -29940.772096504068, -30112.522561288562, -29980.439121478223, -29984.4959975829, -30113.054436096532, -30023.27791941823, -29800.69896446871, -29887.260219338234, -29866.251375417585, -29860.21131238479, -30018.512591913997, -30019.601462185994, -30204.452278414577, -29995.223291650258, -29732.67275139709, -29725.906849650288, -29943.414783710286, -29718.729913982388, -29728.27577818911, -29724.936695805318, -29837.831322222362, -29958.293524780096, -29585.311827919053, -29816.02392927729, -29695.265333660434, -29852.20611686021, -30018.171670373737, -29875.327304266277, -29851.294274613432, -29756.35552602704, -29692.812524018445, -29910.092514829263, -30110.1876900806, -29875.740454341816, -29984.19355397358, -29858.82987325074, -29871.259264531935, -30131.13362484784, -30075.987070417603, -29833.424221843467, -30013.58085180937, -30105.616752690992, -30124.00592166468, -29728.40926564023, -29727.02008502632, -29849.55095524363, -29686.043412542873, -30076.11415840042, -29493.622950342055], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.408543366266958, "mean_inference_ms": 0.2499169110377122, "mean_action_processing_ms": 0.05896093109060155, "mean_env_wait_ms": 1.4969230930644242, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0024938583374023438, "StateBufferConnector_ms": 0.0017745494842529297, "ViewRequirementAgentConnector_ms": 0.04493451118469238}}, "episode_reward_max": -29493.622950342055, "episode_reward_min": -30233.345798788116, "episode_reward_mean": -29915.292728793196, "episode_len_mean": 360.0, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-29855.852268362603, -30151.916052284887, -29945.921846470832, -29876.126214447297, -30123.29573822629, -29949.21956200145, -30018.650957774873, -30042.397093530824, -29927.452749041655, -30031.418424782692, -29806.615581414244, -29839.18189809488, -30007.78046845992, -29878.750381270766, -29947.274205578404, -30133.13085219224, -29902.218624990124, -29872.130656927475, -29859.728693872108, -29965.594650911324, -30064.04298742653, -29778.414620080992, -29864.984283157333, -29902.234597104536, -30108.7563019982, -29884.052520364767, -30174.632069893127, -30143.83973854518, -30151.07561909289, -29709.437134738244, -29754.698620915642, -30070.308814531836, -29993.26869500578, -29752.799588510075, -30043.48687502352, -29838.241144333268, -29920.611377895126, -29924.455142119088, -29811.5423120522, -29869.746231989895, -29761.5002540869, -30139.582092677083, -30035.73094352778, -30005.63178435851, -29652.122346541295, -30233.345798788116, -29839.15438020255, -29880.69717237495, -29868.909199066777, -29656.50942175287, -29786.387514156668, -29940.772096504068, -30112.522561288562, -29980.439121478223, -29984.4959975829, -30113.054436096532, -30023.27791941823, -29800.69896446871, -29887.260219338234, -29866.251375417585, -29860.21131238479, -30018.512591913997, -30019.601462185994, -30204.452278414577, -29995.223291650258, -29732.67275139709, -29725.906849650288, -29943.414783710286, -29718.729913982388, -29728.27577818911, -29724.936695805318, -29837.831322222362, -29958.293524780096, -29585.311827919053, -29816.02392927729, -29695.265333660434, -29852.20611686021, -30018.171670373737, -29875.327304266277, -29851.294274613432, -29756.35552602704, -29692.812524018445, -29910.092514829263, -30110.1876900806, -29875.740454341816, -29984.19355397358, -29858.82987325074, -29871.259264531935, -30131.13362484784, -30075.987070417603, -29833.424221843467, -30013.58085180937, -30105.616752690992, -30124.00592166468, -29728.40926564023, -29727.02008502632, -29849.55095524363, -29686.043412542873, -30076.11415840042, -29493.622950342055], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.408543366266958, "mean_inference_ms": 0.2499169110377122, "mean_action_processing_ms": 0.05896093109060155, "mean_env_wait_ms": 1.4969230930644242, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0024938583374023438, "StateBufferConnector_ms": 0.0017745494842529297, "ViewRequirementAgentConnector_ms": 0.04493451118469238}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 73440, "num_agent_steps_trained": 73440, "num_env_steps_sampled": 73440, "num_env_steps_trained": 73440, "num_env_steps_sampled_this_iter": 1800, "num_env_steps_trained_this_iter": 1800, "num_env_steps_sampled_throughput_per_sec": 160.91845353765277, "num_env_steps_trained_throughput_per_sec": 160.91845353765277, "timesteps_total": 73440, "num_steps_trained_this_iter": 1800, "agent_timesteps_total": 73440, "timers": {"training_iteration_time_ms": 2236.646, "sample_time_ms": 2231.212, "load_time_ms": 0.219, "load_throughput": 1646259.747, "learn_time_ms": 4.656, "learn_throughput": 77317.527, "synch_weights_time_ms": 0.525}, "counters": {"num_env_steps_sampled": 73440, "num_env_steps_trained": 73440, "num_agent_steps_sampled": 73440, "num_agent_steps_trained": 73440}, "done": false, "episodes_total": 204, "training_iteration": 41, "trial_id": "4935e_00000", "date": "2023-07-25_15-54-16", "timestamp": 1690289656, "time_this_iter_s": 11.187902927398682, "time_total_s": 457.72105407714844, "pid": 67353, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[0, 0.003], [5400, 0.001], [10800, 0.00075], [16200, 0.0005], [21600, 0.00025], [27000, 0.0001], [32400, 7.5e-05], [37800, 5e-05], [43200, 2.5e-05], [48600, 1e-05], [54000, 7.5e-06], [59400, 5e-06], [64800, 2.5e-06], [70200, 1e-06], [75600, 5e-07], [81000, 1e-07]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x177531310>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 457.72105407714844, "iterations_since_restore": 41, "perf": {"cpu_util_percent": 24.7125, "ram_util_percent": 78.79374999999999}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 5.666666666666666e-07, "entropy_coeff": 0.10000000000000002, "policy_entropy": -1859.8465169270833, "policy_loss": -51514145680042.664, "vf_loss": 2477221973.3333335}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 120.0, "num_grad_updates_lifetime": 626.0, "diff_num_grad_updates_vs_sampler_policy": 625.0}}, "num_env_steps_sampled": 75240, "num_env_steps_trained": 75240, "num_agent_steps_sampled": 75240, "num_agent_steps_trained": 75240}, "sampler_results": {"episode_reward_max": -29493.622950342055, "episode_reward_min": -30233.345798788116, "episode_reward_mean": -29913.295968262846, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-29949.21956200145, -30018.650957774873, -30042.397093530824, -29927.452749041655, -30031.418424782692, -29806.615581414244, -29839.18189809488, -30007.78046845992, -29878.750381270766, -29947.274205578404, -30133.13085219224, -29902.218624990124, -29872.130656927475, -29859.728693872108, -29965.594650911324, -30064.04298742653, -29778.414620080992, -29864.984283157333, -29902.234597104536, -30108.7563019982, -29884.052520364767, -30174.632069893127, -30143.83973854518, -30151.07561909289, -29709.437134738244, -29754.698620915642, -30070.308814531836, -29993.26869500578, -29752.799588510075, -30043.48687502352, -29838.241144333268, -29920.611377895126, -29924.455142119088, -29811.5423120522, -29869.746231989895, -29761.5002540869, -30139.582092677083, -30035.73094352778, -30005.63178435851, -29652.122346541295, -30233.345798788116, -29839.15438020255, -29880.69717237495, -29868.909199066777, -29656.50942175287, -29786.387514156668, -29940.772096504068, -30112.522561288562, -29980.439121478223, -29984.4959975829, -30113.054436096532, -30023.27791941823, -29800.69896446871, -29887.260219338234, -29866.251375417585, -29860.21131238479, -30018.512591913997, -30019.601462185994, -30204.452278414577, -29995.223291650258, -29732.67275139709, -29725.906849650288, -29943.414783710286, -29718.729913982388, -29728.27577818911, -29724.936695805318, -29837.831322222362, -29958.293524780096, -29585.311827919053, -29816.02392927729, -29695.265333660434, -29852.20611686021, -30018.171670373737, -29875.327304266277, -29851.294274613432, -29756.35552602704, -29692.812524018445, -29910.092514829263, -30110.1876900806, -29875.740454341816, -29984.19355397358, -29858.82987325074, -29871.259264531935, -30131.13362484784, -30075.987070417603, -29833.424221843467, -30013.58085180937, -30105.616752690992, -30124.00592166468, -29728.40926564023, -29727.02008502632, -29849.55095524363, -29686.043412542873, -30076.11415840042, -29493.622950342055, -29999.940953204612, -29927.552167962298, -30034.237481121414, -29940.106997576408, -29851.598466892006], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.407802553678624, "mean_inference_ms": 0.24993363949860078, "mean_action_processing_ms": 0.05895948276675036, "mean_env_wait_ms": 1.4953458376296436, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002495288848876953, "StateBufferConnector_ms": 0.001775979995727539, "ViewRequirementAgentConnector_ms": 0.04483318328857422}}, "episode_reward_max": -29493.622950342055, "episode_reward_min": -30233.345798788116, "episode_reward_mean": -29913.295968262846, "episode_len_mean": 360.0, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-29949.21956200145, -30018.650957774873, -30042.397093530824, -29927.452749041655, -30031.418424782692, -29806.615581414244, -29839.18189809488, -30007.78046845992, -29878.750381270766, -29947.274205578404, -30133.13085219224, -29902.218624990124, -29872.130656927475, -29859.728693872108, -29965.594650911324, -30064.04298742653, -29778.414620080992, -29864.984283157333, -29902.234597104536, -30108.7563019982, -29884.052520364767, -30174.632069893127, -30143.83973854518, -30151.07561909289, -29709.437134738244, -29754.698620915642, -30070.308814531836, -29993.26869500578, -29752.799588510075, -30043.48687502352, -29838.241144333268, -29920.611377895126, -29924.455142119088, -29811.5423120522, -29869.746231989895, -29761.5002540869, -30139.582092677083, -30035.73094352778, -30005.63178435851, -29652.122346541295, -30233.345798788116, -29839.15438020255, -29880.69717237495, -29868.909199066777, -29656.50942175287, -29786.387514156668, -29940.772096504068, -30112.522561288562, -29980.439121478223, -29984.4959975829, -30113.054436096532, -30023.27791941823, -29800.69896446871, -29887.260219338234, -29866.251375417585, -29860.21131238479, -30018.512591913997, -30019.601462185994, -30204.452278414577, -29995.223291650258, -29732.67275139709, -29725.906849650288, -29943.414783710286, -29718.729913982388, -29728.27577818911, -29724.936695805318, -29837.831322222362, -29958.293524780096, -29585.311827919053, -29816.02392927729, -29695.265333660434, -29852.20611686021, -30018.171670373737, -29875.327304266277, -29851.294274613432, -29756.35552602704, -29692.812524018445, -29910.092514829263, -30110.1876900806, -29875.740454341816, -29984.19355397358, -29858.82987325074, -29871.259264531935, -30131.13362484784, -30075.987070417603, -29833.424221843467, -30013.58085180937, -30105.616752690992, -30124.00592166468, -29728.40926564023, -29727.02008502632, -29849.55095524363, -29686.043412542873, -30076.11415840042, -29493.622950342055, -29999.940953204612, -29927.552167962298, -30034.237481121414, -29940.106997576408, -29851.598466892006], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.407802553678624, "mean_inference_ms": 0.24993363949860078, "mean_action_processing_ms": 0.05895948276675036, "mean_env_wait_ms": 1.4953458376296436, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002495288848876953, "StateBufferConnector_ms": 0.001775979995727539, "ViewRequirementAgentConnector_ms": 0.04483318328857422}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 75240, "num_agent_steps_trained": 75240, "num_env_steps_sampled": 75240, "num_env_steps_trained": 75240, "num_env_steps_sampled_this_iter": 1800, "num_env_steps_trained_this_iter": 1800, "num_env_steps_sampled_throughput_per_sec": 163.00664972808931, "num_env_steps_trained_throughput_per_sec": 163.00664972808931, "timesteps_total": 75240, "num_steps_trained_this_iter": 1800, "agent_timesteps_total": 75240, "timers": {"training_iteration_time_ms": 2222.82, "sample_time_ms": 2217.515, "load_time_ms": 0.216, "load_throughput": 1666610.861, "learn_time_ms": 4.548, "learn_throughput": 79160.63, "synch_weights_time_ms": 0.508}, "counters": {"num_env_steps_sampled": 75240, "num_env_steps_trained": 75240, "num_agent_steps_sampled": 75240, "num_agent_steps_trained": 75240}, "done": false, "episodes_total": 209, "training_iteration": 42, "trial_id": "4935e_00000", "date": "2023-07-25_15-54-27", "timestamp": 1690289667, "time_this_iter_s": 11.044528245925903, "time_total_s": 468.76558232307434, "pid": 67353, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[0, 0.003], [5400, 0.001], [10800, 0.00075], [16200, 0.0005], [21600, 0.00025], [27000, 0.0001], [32400, 7.5e-05], [37800, 5e-05], [43200, 2.5e-05], [48600, 1e-05], [54000, 7.5e-06], [59400, 5e-06], [64800, 2.5e-06], [70200, 1e-06], [75600, 5e-07], [81000, 1e-07]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x177531310>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 468.76558232307434, "iterations_since_restore": 42, "perf": {"cpu_util_percent": 22.575000000000003, "ram_util_percent": 79.40625}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 4.2e-07, "entropy_coeff": 0.10000000000000002, "policy_entropy": -1859.8575439453125, "policy_loss": -29637991322965.332, "vf_loss": 2451545685.3333335}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 120.0, "num_grad_updates_lifetime": 641.0, "diff_num_grad_updates_vs_sampler_policy": 640.0}}, "num_env_steps_sampled": 77040, "num_env_steps_trained": 77040, "num_agent_steps_sampled": 77040, "num_agent_steps_trained": 77040}, "sampler_results": {"episode_reward_max": -29493.622950342055, "episode_reward_min": -30233.345798788116, "episode_reward_mean": -29901.455117730562, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-29806.615581414244, -29839.18189809488, -30007.78046845992, -29878.750381270766, -29947.274205578404, -30133.13085219224, -29902.218624990124, -29872.130656927475, -29859.728693872108, -29965.594650911324, -30064.04298742653, -29778.414620080992, -29864.984283157333, -29902.234597104536, -30108.7563019982, -29884.052520364767, -30174.632069893127, -30143.83973854518, -30151.07561909289, -29709.437134738244, -29754.698620915642, -30070.308814531836, -29993.26869500578, -29752.799588510075, -30043.48687502352, -29838.241144333268, -29920.611377895126, -29924.455142119088, -29811.5423120522, -29869.746231989895, -29761.5002540869, -30139.582092677083, -30035.73094352778, -30005.63178435851, -29652.122346541295, -30233.345798788116, -29839.15438020255, -29880.69717237495, -29868.909199066777, -29656.50942175287, -29786.387514156668, -29940.772096504068, -30112.522561288562, -29980.439121478223, -29984.4959975829, -30113.054436096532, -30023.27791941823, -29800.69896446871, -29887.260219338234, -29866.251375417585, -29860.21131238479, -30018.512591913997, -30019.601462185994, -30204.452278414577, -29995.223291650258, -29732.67275139709, -29725.906849650288, -29943.414783710286, -29718.729913982388, -29728.27577818911, -29724.936695805318, -29837.831322222362, -29958.293524780096, -29585.311827919053, -29816.02392927729, -29695.265333660434, -29852.20611686021, -30018.171670373737, -29875.327304266277, -29851.294274613432, -29756.35552602704, -29692.812524018445, -29910.092514829263, -30110.1876900806, -29875.740454341816, -29984.19355397358, -29858.82987325074, -29871.259264531935, -30131.13362484784, -30075.987070417603, -29833.424221843467, -30013.58085180937, -30105.616752690992, -30124.00592166468, -29728.40926564023, -29727.02008502632, -29849.55095524363, -29686.043412542873, -30076.11415840042, -29493.622950342055, -29999.940953204612, -29927.552167962298, -30034.237481121414, -29940.106997576408, -29851.598466892006, -29851.17816675025, -29758.31571960719, -29698.70096416914, -29752.33836249519, -29724.520520881266], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.407071157620997, "mean_inference_ms": 0.24996221689009576, "mean_action_processing_ms": 0.05895985453311491, "mean_env_wait_ms": 1.4939529330148873, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002496957778930664, "StateBufferConnector_ms": 0.001779794692993164, "ViewRequirementAgentConnector_ms": 0.04483199119567871}}, "episode_reward_max": -29493.622950342055, "episode_reward_min": -30233.345798788116, "episode_reward_mean": -29901.455117730562, "episode_len_mean": 360.0, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-29806.615581414244, -29839.18189809488, -30007.78046845992, -29878.750381270766, -29947.274205578404, -30133.13085219224, -29902.218624990124, -29872.130656927475, -29859.728693872108, -29965.594650911324, -30064.04298742653, -29778.414620080992, -29864.984283157333, -29902.234597104536, -30108.7563019982, -29884.052520364767, -30174.632069893127, -30143.83973854518, -30151.07561909289, -29709.437134738244, -29754.698620915642, -30070.308814531836, -29993.26869500578, -29752.799588510075, -30043.48687502352, -29838.241144333268, -29920.611377895126, -29924.455142119088, -29811.5423120522, -29869.746231989895, -29761.5002540869, -30139.582092677083, -30035.73094352778, -30005.63178435851, -29652.122346541295, -30233.345798788116, -29839.15438020255, -29880.69717237495, -29868.909199066777, -29656.50942175287, -29786.387514156668, -29940.772096504068, -30112.522561288562, -29980.439121478223, -29984.4959975829, -30113.054436096532, -30023.27791941823, -29800.69896446871, -29887.260219338234, -29866.251375417585, -29860.21131238479, -30018.512591913997, -30019.601462185994, -30204.452278414577, -29995.223291650258, -29732.67275139709, -29725.906849650288, -29943.414783710286, -29718.729913982388, -29728.27577818911, -29724.936695805318, -29837.831322222362, -29958.293524780096, -29585.311827919053, -29816.02392927729, -29695.265333660434, -29852.20611686021, -30018.171670373737, -29875.327304266277, -29851.294274613432, -29756.35552602704, -29692.812524018445, -29910.092514829263, -30110.1876900806, -29875.740454341816, -29984.19355397358, -29858.82987325074, -29871.259264531935, -30131.13362484784, -30075.987070417603, -29833.424221843467, -30013.58085180937, -30105.616752690992, -30124.00592166468, -29728.40926564023, -29727.02008502632, -29849.55095524363, -29686.043412542873, -30076.11415840042, -29493.622950342055, -29999.940953204612, -29927.552167962298, -30034.237481121414, -29940.106997576408, -29851.598466892006, -29851.17816675025, -29758.31571960719, -29698.70096416914, -29752.33836249519, -29724.520520881266], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.407071157620997, "mean_inference_ms": 0.24996221689009576, "mean_action_processing_ms": 0.05895985453311491, "mean_env_wait_ms": 1.4939529330148873, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002496957778930664, "StateBufferConnector_ms": 0.001779794692993164, "ViewRequirementAgentConnector_ms": 0.04483199119567871}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 77040, "num_agent_steps_trained": 77040, "num_env_steps_sampled": 77040, "num_env_steps_trained": 77040, "num_env_steps_sampled_this_iter": 1800, "num_env_steps_trained_this_iter": 1800, "num_env_steps_sampled_throughput_per_sec": 160.25501395825458, "num_env_steps_trained_throughput_per_sec": 160.25501395825458, "timesteps_total": 77040, "num_steps_trained_this_iter": 1800, "agent_timesteps_total": 77040, "timers": {"training_iteration_time_ms": 2227.45, "sample_time_ms": 2222.102, "load_time_ms": 0.216, "load_throughput": 1670482.841, "learn_time_ms": 4.592, "learn_throughput": 78395.356, "synch_weights_time_ms": 0.508}, "counters": {"num_env_steps_sampled": 77040, "num_env_steps_trained": 77040, "num_agent_steps_sampled": 77040, "num_agent_steps_trained": 77040}, "done": false, "episodes_total": 214, "training_iteration": 43, "trial_id": "4935e_00000", "date": "2023-07-25_15-54-38", "timestamp": 1690289678, "time_this_iter_s": 11.234200954437256, "time_total_s": 479.9997832775116, "pid": 67353, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[0, 0.003], [5400, 0.001], [10800, 0.00075], [16200, 0.0005], [21600, 0.00025], [27000, 0.0001], [32400, 7.5e-05], [37800, 5e-05], [43200, 2.5e-05], [48600, 1e-05], [54000, 7.5e-06], [59400, 5e-06], [64800, 2.5e-06], [70200, 1e-06], [75600, 5e-07], [81000, 1e-07]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x177531310>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 479.9997832775116, "iterations_since_restore": 43, "perf": {"cpu_util_percent": 24.60666666666667, "ram_util_percent": 79.55333333333333}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 2.8666666666666664e-07, "entropy_coeff": 0.10000000000000002, "policy_entropy": -1859.8604736328125, "policy_loss": -29596794017109.332, "vf_loss": 2481796992.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 120.0, "num_grad_updates_lifetime": 656.0, "diff_num_grad_updates_vs_sampler_policy": 655.0}}, "num_env_steps_sampled": 78840, "num_env_steps_trained": 78840, "num_agent_steps_sampled": 78840, "num_agent_steps_trained": 78840}, "sampler_results": {"episode_reward_max": -29493.622950342055, "episode_reward_min": -30233.345798788116, "episode_reward_mean": -29895.093148837037, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-30133.13085219224, -29902.218624990124, -29872.130656927475, -29859.728693872108, -29965.594650911324, -30064.04298742653, -29778.414620080992, -29864.984283157333, -29902.234597104536, -30108.7563019982, -29884.052520364767, -30174.632069893127, -30143.83973854518, -30151.07561909289, -29709.437134738244, -29754.698620915642, -30070.308814531836, -29993.26869500578, -29752.799588510075, -30043.48687502352, -29838.241144333268, -29920.611377895126, -29924.455142119088, -29811.5423120522, -29869.746231989895, -29761.5002540869, -30139.582092677083, -30035.73094352778, -30005.63178435851, -29652.122346541295, -30233.345798788116, -29839.15438020255, -29880.69717237495, -29868.909199066777, -29656.50942175287, -29786.387514156668, -29940.772096504068, -30112.522561288562, -29980.439121478223, -29984.4959975829, -30113.054436096532, -30023.27791941823, -29800.69896446871, -29887.260219338234, -29866.251375417585, -29860.21131238479, -30018.512591913997, -30019.601462185994, -30204.452278414577, -29995.223291650258, -29732.67275139709, -29725.906849650288, -29943.414783710286, -29718.729913982388, -29728.27577818911, -29724.936695805318, -29837.831322222362, -29958.293524780096, -29585.311827919053, -29816.02392927729, -29695.265333660434, -29852.20611686021, -30018.171670373737, -29875.327304266277, -29851.294274613432, -29756.35552602704, -29692.812524018445, -29910.092514829263, -30110.1876900806, -29875.740454341816, -29984.19355397358, -29858.82987325074, -29871.259264531935, -30131.13362484784, -30075.987070417603, -29833.424221843467, -30013.58085180937, -30105.616752690992, -30124.00592166468, -29728.40926564023, -29727.02008502632, -29849.55095524363, -29686.043412542873, -30076.11415840042, -29493.622950342055, -29999.940953204612, -29927.552167962298, -30034.237481121414, -29940.106997576408, -29851.598466892006, -29851.17816675025, -29758.31571960719, -29698.70096416914, -29752.33836249519, -29724.520520881266, -29828.47634821921, -29912.34275767336, -29738.78365407845, -29581.156238000196, -29782.646647494497], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.406311449466099, "mean_inference_ms": 0.2499893936937399, "mean_action_processing_ms": 0.05895997398664877, "mean_env_wait_ms": 1.4926258323013133, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0024788379669189453, "StateBufferConnector_ms": 0.0017712116241455078, "ViewRequirementAgentConnector_ms": 0.04470038414001465}}, "episode_reward_max": -29493.622950342055, "episode_reward_min": -30233.345798788116, "episode_reward_mean": -29895.093148837037, "episode_len_mean": 360.0, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-30133.13085219224, -29902.218624990124, -29872.130656927475, -29859.728693872108, -29965.594650911324, -30064.04298742653, -29778.414620080992, -29864.984283157333, -29902.234597104536, -30108.7563019982, -29884.052520364767, -30174.632069893127, -30143.83973854518, -30151.07561909289, -29709.437134738244, -29754.698620915642, -30070.308814531836, -29993.26869500578, -29752.799588510075, -30043.48687502352, -29838.241144333268, -29920.611377895126, -29924.455142119088, -29811.5423120522, -29869.746231989895, -29761.5002540869, -30139.582092677083, -30035.73094352778, -30005.63178435851, -29652.122346541295, -30233.345798788116, -29839.15438020255, -29880.69717237495, -29868.909199066777, -29656.50942175287, -29786.387514156668, -29940.772096504068, -30112.522561288562, -29980.439121478223, -29984.4959975829, -30113.054436096532, -30023.27791941823, -29800.69896446871, -29887.260219338234, -29866.251375417585, -29860.21131238479, -30018.512591913997, -30019.601462185994, -30204.452278414577, -29995.223291650258, -29732.67275139709, -29725.906849650288, -29943.414783710286, -29718.729913982388, -29728.27577818911, -29724.936695805318, -29837.831322222362, -29958.293524780096, -29585.311827919053, -29816.02392927729, -29695.265333660434, -29852.20611686021, -30018.171670373737, -29875.327304266277, -29851.294274613432, -29756.35552602704, -29692.812524018445, -29910.092514829263, -30110.1876900806, -29875.740454341816, -29984.19355397358, -29858.82987325074, -29871.259264531935, -30131.13362484784, -30075.987070417603, -29833.424221843467, -30013.58085180937, -30105.616752690992, -30124.00592166468, -29728.40926564023, -29727.02008502632, -29849.55095524363, -29686.043412542873, -30076.11415840042, -29493.622950342055, -29999.940953204612, -29927.552167962298, -30034.237481121414, -29940.106997576408, -29851.598466892006, -29851.17816675025, -29758.31571960719, -29698.70096416914, -29752.33836249519, -29724.520520881266, -29828.47634821921, -29912.34275767336, -29738.78365407845, -29581.156238000196, -29782.646647494497], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.406311449466099, "mean_inference_ms": 0.2499893936937399, "mean_action_processing_ms": 0.05895997398664877, "mean_env_wait_ms": 1.4926258323013133, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0024788379669189453, "StateBufferConnector_ms": 0.0017712116241455078, "ViewRequirementAgentConnector_ms": 0.04470038414001465}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 78840, "num_agent_steps_trained": 78840, "num_env_steps_sampled": 78840, "num_env_steps_trained": 78840, "num_env_steps_sampled_this_iter": 1800, "num_env_steps_trained_this_iter": 1800, "num_env_steps_sampled_throughput_per_sec": 161.11623013127613, "num_env_steps_trained_throughput_per_sec": 161.11623013127613, "timesteps_total": 78840, "num_steps_trained_this_iter": 1800, "agent_timesteps_total": 78840, "timers": {"training_iteration_time_ms": 2240.406, "sample_time_ms": 2235.052, "load_time_ms": 0.214, "load_throughput": 1680335.455, "learn_time_ms": 4.595, "learn_throughput": 78338.415, "synch_weights_time_ms": 0.513}, "counters": {"num_env_steps_sampled": 78840, "num_env_steps_trained": 78840, "num_agent_steps_sampled": 78840, "num_agent_steps_trained": 78840}, "done": false, "episodes_total": 219, "training_iteration": 44, "trial_id": "4935e_00000", "date": "2023-07-25_15-54-50", "timestamp": 1690289690, "time_this_iter_s": 11.174153089523315, "time_total_s": 491.1739363670349, "pid": 67353, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[0, 0.003], [5400, 0.001], [10800, 0.00075], [16200, 0.0005], [21600, 0.00025], [27000, 0.0001], [32400, 7.5e-05], [37800, 5e-05], [43200, 2.5e-05], [48600, 1e-05], [54000, 7.5e-06], [59400, 5e-06], [64800, 2.5e-06], [70200, 1e-06], [75600, 5e-07], [81000, 1e-07]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x177531310>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 491.1739363670349, "iterations_since_restore": 44, "perf": {"cpu_util_percent": 24.75, "ram_util_percent": 79.53750000000001}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1.5333333333333333e-07, "entropy_coeff": 0.10000000000000002, "policy_entropy": -1859.8600667317708, "policy_loss": -6247795593216.0, "vf_loss": 2531623936.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 120.0, "num_grad_updates_lifetime": 671.0, "diff_num_grad_updates_vs_sampler_policy": 670.0}}, "num_env_steps_sampled": 80640, "num_env_steps_trained": 80640, "num_agent_steps_sampled": 80640, "num_agent_steps_trained": 80640}, "sampler_results": {"episode_reward_max": -29493.622950342055, "episode_reward_min": -30233.345798788116, "episode_reward_mean": -29887.7157987357, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-30064.04298742653, -29778.414620080992, -29864.984283157333, -29902.234597104536, -30108.7563019982, -29884.052520364767, -30174.632069893127, -30143.83973854518, -30151.07561909289, -29709.437134738244, -29754.698620915642, -30070.308814531836, -29993.26869500578, -29752.799588510075, -30043.48687502352, -29838.241144333268, -29920.611377895126, -29924.455142119088, -29811.5423120522, -29869.746231989895, -29761.5002540869, -30139.582092677083, -30035.73094352778, -30005.63178435851, -29652.122346541295, -30233.345798788116, -29839.15438020255, -29880.69717237495, -29868.909199066777, -29656.50942175287, -29786.387514156668, -29940.772096504068, -30112.522561288562, -29980.439121478223, -29984.4959975829, -30113.054436096532, -30023.27791941823, -29800.69896446871, -29887.260219338234, -29866.251375417585, -29860.21131238479, -30018.512591913997, -30019.601462185994, -30204.452278414577, -29995.223291650258, -29732.67275139709, -29725.906849650288, -29943.414783710286, -29718.729913982388, -29728.27577818911, -29724.936695805318, -29837.831322222362, -29958.293524780096, -29585.311827919053, -29816.02392927729, -29695.265333660434, -29852.20611686021, -30018.171670373737, -29875.327304266277, -29851.294274613432, -29756.35552602704, -29692.812524018445, -29910.092514829263, -30110.1876900806, -29875.740454341816, -29984.19355397358, -29858.82987325074, -29871.259264531935, -30131.13362484784, -30075.987070417603, -29833.424221843467, -30013.58085180937, -30105.616752690992, -30124.00592166468, -29728.40926564023, -29727.02008502632, -29849.55095524363, -29686.043412542873, -30076.11415840042, -29493.622950342055, -29999.940953204612, -29927.552167962298, -30034.237481121414, -29940.106997576408, -29851.598466892006, -29851.17816675025, -29758.31571960719, -29698.70096416914, -29752.33836249519, -29724.520520881266, -29828.47634821921, -29912.34275767336, -29738.78365407845, -29581.156238000196, -29782.646647494497, -29534.140652548722, -29954.82094612775, -29678.508092159133, -29753.41040762024, -30074.188370303957], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.4055410695022195, "mean_inference_ms": 0.2500154566775869, "mean_action_processing_ms": 0.05896039790622431, "mean_env_wait_ms": 1.4914222053132695, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002505064010620117, "StateBufferConnector_ms": 0.0017931461334228516, "ViewRequirementAgentConnector_ms": 0.0449521541595459}}, "episode_reward_max": -29493.622950342055, "episode_reward_min": -30233.345798788116, "episode_reward_mean": -29887.7157987357, "episode_len_mean": 360.0, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-30064.04298742653, -29778.414620080992, -29864.984283157333, -29902.234597104536, -30108.7563019982, -29884.052520364767, -30174.632069893127, -30143.83973854518, -30151.07561909289, -29709.437134738244, -29754.698620915642, -30070.308814531836, -29993.26869500578, -29752.799588510075, -30043.48687502352, -29838.241144333268, -29920.611377895126, -29924.455142119088, -29811.5423120522, -29869.746231989895, -29761.5002540869, -30139.582092677083, -30035.73094352778, -30005.63178435851, -29652.122346541295, -30233.345798788116, -29839.15438020255, -29880.69717237495, -29868.909199066777, -29656.50942175287, -29786.387514156668, -29940.772096504068, -30112.522561288562, -29980.439121478223, -29984.4959975829, -30113.054436096532, -30023.27791941823, -29800.69896446871, -29887.260219338234, -29866.251375417585, -29860.21131238479, -30018.512591913997, -30019.601462185994, -30204.452278414577, -29995.223291650258, -29732.67275139709, -29725.906849650288, -29943.414783710286, -29718.729913982388, -29728.27577818911, -29724.936695805318, -29837.831322222362, -29958.293524780096, -29585.311827919053, -29816.02392927729, -29695.265333660434, -29852.20611686021, -30018.171670373737, -29875.327304266277, -29851.294274613432, -29756.35552602704, -29692.812524018445, -29910.092514829263, -30110.1876900806, -29875.740454341816, -29984.19355397358, -29858.82987325074, -29871.259264531935, -30131.13362484784, -30075.987070417603, -29833.424221843467, -30013.58085180937, -30105.616752690992, -30124.00592166468, -29728.40926564023, -29727.02008502632, -29849.55095524363, -29686.043412542873, -30076.11415840042, -29493.622950342055, -29999.940953204612, -29927.552167962298, -30034.237481121414, -29940.106997576408, -29851.598466892006, -29851.17816675025, -29758.31571960719, -29698.70096416914, -29752.33836249519, -29724.520520881266, -29828.47634821921, -29912.34275767336, -29738.78365407845, -29581.156238000196, -29782.646647494497, -29534.140652548722, -29954.82094612775, -29678.508092159133, -29753.41040762024, -30074.188370303957], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.4055410695022195, "mean_inference_ms": 0.2500154566775869, "mean_action_processing_ms": 0.05896039790622431, "mean_env_wait_ms": 1.4914222053132695, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002505064010620117, "StateBufferConnector_ms": 0.0017931461334228516, "ViewRequirementAgentConnector_ms": 0.0449521541595459}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 80640, "num_agent_steps_trained": 80640, "num_env_steps_sampled": 80640, "num_env_steps_trained": 80640, "num_env_steps_sampled_this_iter": 1800, "num_env_steps_trained_this_iter": 1800, "num_env_steps_sampled_throughput_per_sec": 161.08792742325537, "num_env_steps_trained_throughput_per_sec": 161.08792742325537, "timesteps_total": 80640, "num_steps_trained_this_iter": 1800, "agent_timesteps_total": 80640, "timers": {"training_iteration_time_ms": 2234.599, "sample_time_ms": 2229.229, "load_time_ms": 0.213, "load_throughput": 1693907.83, "learn_time_ms": 4.604, "learn_throughput": 78200.876, "synch_weights_time_ms": 0.521}, "counters": {"num_env_steps_sampled": 80640, "num_env_steps_trained": 80640, "num_agent_steps_sampled": 80640, "num_agent_steps_trained": 80640}, "done": false, "episodes_total": 224, "training_iteration": 45, "trial_id": "4935e_00000", "date": "2023-07-25_15-55-01", "timestamp": 1690289701, "time_this_iter_s": 11.176215887069702, "time_total_s": 502.3501522541046, "pid": 67353, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[0, 0.003], [5400, 0.001], [10800, 0.00075], [16200, 0.0005], [21600, 0.00025], [27000, 0.0001], [32400, 7.5e-05], [37800, 5e-05], [43200, 2.5e-05], [48600, 1e-05], [54000, 7.5e-06], [59400, 5e-06], [64800, 2.5e-06], [70200, 1e-06], [75600, 5e-07], [81000, 1e-07]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x177531310>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 502.3501522541046, "iterations_since_restore": 45, "perf": {"cpu_util_percent": 21.9625, "ram_util_percent": 79.29375}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-07, "entropy_coeff": 0.10000000000000002, "policy_entropy": -1859.8601481119792, "policy_loss": -1927182415189.3333, "vf_loss": 2488135978.6666665}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 120.0, "num_grad_updates_lifetime": 686.0, "diff_num_grad_updates_vs_sampler_policy": 685.0}}, "num_env_steps_sampled": 82440, "num_env_steps_trained": 82440, "num_agent_steps_sampled": 82440, "num_agent_steps_trained": 82440}, "sampler_results": {"episode_reward_max": -29493.622950342055, "episode_reward_min": -30233.345798788116, "episode_reward_mean": -29881.60808228964, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-29884.052520364767, -30174.632069893127, -30143.83973854518, -30151.07561909289, -29709.437134738244, -29754.698620915642, -30070.308814531836, -29993.26869500578, -29752.799588510075, -30043.48687502352, -29838.241144333268, -29920.611377895126, -29924.455142119088, -29811.5423120522, -29869.746231989895, -29761.5002540869, -30139.582092677083, -30035.73094352778, -30005.63178435851, -29652.122346541295, -30233.345798788116, -29839.15438020255, -29880.69717237495, -29868.909199066777, -29656.50942175287, -29786.387514156668, -29940.772096504068, -30112.522561288562, -29980.439121478223, -29984.4959975829, -30113.054436096532, -30023.27791941823, -29800.69896446871, -29887.260219338234, -29866.251375417585, -29860.21131238479, -30018.512591913997, -30019.601462185994, -30204.452278414577, -29995.223291650258, -29732.67275139709, -29725.906849650288, -29943.414783710286, -29718.729913982388, -29728.27577818911, -29724.936695805318, -29837.831322222362, -29958.293524780096, -29585.311827919053, -29816.02392927729, -29695.265333660434, -29852.20611686021, -30018.171670373737, -29875.327304266277, -29851.294274613432, -29756.35552602704, -29692.812524018445, -29910.092514829263, -30110.1876900806, -29875.740454341816, -29984.19355397358, -29858.82987325074, -29871.259264531935, -30131.13362484784, -30075.987070417603, -29833.424221843467, -30013.58085180937, -30105.616752690992, -30124.00592166468, -29728.40926564023, -29727.02008502632, -29849.55095524363, -29686.043412542873, -30076.11415840042, -29493.622950342055, -29999.940953204612, -29927.552167962298, -30034.237481121414, -29940.106997576408, -29851.598466892006, -29851.17816675025, -29758.31571960719, -29698.70096416914, -29752.33836249519, -29724.520520881266, -29828.47634821921, -29912.34275767336, -29738.78365407845, -29581.156238000196, -29782.646647494497, -29534.140652548722, -29954.82094612775, -29678.508092159133, -29753.41040762024, -30074.188370303957, -29813.00050972671, -30009.122726198522, -29785.933695821175, -29676.234010301047, -29823.370203113936], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.404809770425394, "mean_inference_ms": 0.25004122949860985, "mean_action_processing_ms": 0.05896090634562365, "mean_env_wait_ms": 1.4903093977100104, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002509593963623047, "StateBufferConnector_ms": 0.0017876625061035156, "ViewRequirementAgentConnector_ms": 0.04491472244262695}}, "episode_reward_max": -29493.622950342055, "episode_reward_min": -30233.345798788116, "episode_reward_mean": -29881.60808228964, "episode_len_mean": 360.0, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-29884.052520364767, -30174.632069893127, -30143.83973854518, -30151.07561909289, -29709.437134738244, -29754.698620915642, -30070.308814531836, -29993.26869500578, -29752.799588510075, -30043.48687502352, -29838.241144333268, -29920.611377895126, -29924.455142119088, -29811.5423120522, -29869.746231989895, -29761.5002540869, -30139.582092677083, -30035.73094352778, -30005.63178435851, -29652.122346541295, -30233.345798788116, -29839.15438020255, -29880.69717237495, -29868.909199066777, -29656.50942175287, -29786.387514156668, -29940.772096504068, -30112.522561288562, -29980.439121478223, -29984.4959975829, -30113.054436096532, -30023.27791941823, -29800.69896446871, -29887.260219338234, -29866.251375417585, -29860.21131238479, -30018.512591913997, -30019.601462185994, -30204.452278414577, -29995.223291650258, -29732.67275139709, -29725.906849650288, -29943.414783710286, -29718.729913982388, -29728.27577818911, -29724.936695805318, -29837.831322222362, -29958.293524780096, -29585.311827919053, -29816.02392927729, -29695.265333660434, -29852.20611686021, -30018.171670373737, -29875.327304266277, -29851.294274613432, -29756.35552602704, -29692.812524018445, -29910.092514829263, -30110.1876900806, -29875.740454341816, -29984.19355397358, -29858.82987325074, -29871.259264531935, -30131.13362484784, -30075.987070417603, -29833.424221843467, -30013.58085180937, -30105.616752690992, -30124.00592166468, -29728.40926564023, -29727.02008502632, -29849.55095524363, -29686.043412542873, -30076.11415840042, -29493.622950342055, -29999.940953204612, -29927.552167962298, -30034.237481121414, -29940.106997576408, -29851.598466892006, -29851.17816675025, -29758.31571960719, -29698.70096416914, -29752.33836249519, -29724.520520881266, -29828.47634821921, -29912.34275767336, -29738.78365407845, -29581.156238000196, -29782.646647494497, -29534.140652548722, -29954.82094612775, -29678.508092159133, -29753.41040762024, -30074.188370303957, -29813.00050972671, -30009.122726198522, -29785.933695821175, -29676.234010301047, -29823.370203113936], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.404809770425394, "mean_inference_ms": 0.25004122949860985, "mean_action_processing_ms": 0.05896090634562365, "mean_env_wait_ms": 1.4903093977100104, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002509593963623047, "StateBufferConnector_ms": 0.0017876625061035156, "ViewRequirementAgentConnector_ms": 0.04491472244262695}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 82440, "num_agent_steps_trained": 82440, "num_env_steps_sampled": 82440, "num_env_steps_trained": 82440, "num_env_steps_sampled_this_iter": 1800, "num_env_steps_trained_this_iter": 1800, "num_env_steps_sampled_throughput_per_sec": 161.03655899721758, "num_env_steps_trained_throughput_per_sec": 161.03655899721758, "timesteps_total": 82440, "num_steps_trained_this_iter": 1800, "agent_timesteps_total": 82440, "timers": {"training_iteration_time_ms": 2235.152, "sample_time_ms": 2229.806, "load_time_ms": 0.213, "load_throughput": 1687094.346, "learn_time_ms": 4.594, "learn_throughput": 78363.215, "synch_weights_time_ms": 0.506}, "counters": {"num_env_steps_sampled": 82440, "num_env_steps_trained": 82440, "num_agent_steps_sampled": 82440, "num_agent_steps_trained": 82440}, "done": false, "episodes_total": 229, "training_iteration": 46, "trial_id": "4935e_00000", "date": "2023-07-25_15-55-12", "timestamp": 1690289712, "time_this_iter_s": 11.17973780632019, "time_total_s": 513.5298900604248, "pid": 67353, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[0, 0.003], [5400, 0.001], [10800, 0.00075], [16200, 0.0005], [21600, 0.00025], [27000, 0.0001], [32400, 7.5e-05], [37800, 5e-05], [43200, 2.5e-05], [48600, 1e-05], [54000, 7.5e-06], [59400, 5e-06], [64800, 2.5e-06], [70200, 1e-06], [75600, 5e-07], [81000, 1e-07]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x177531310>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 513.5298900604248, "iterations_since_restore": 46, "perf": {"cpu_util_percent": 24.81875, "ram_util_percent": 79.475}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-07, "entropy_coeff": 0.10000000000000002, "policy_entropy": -1859.8600667317708, "policy_loss": -7198859968512.0, "vf_loss": 2519241130.6666665}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 120.0, "num_grad_updates_lifetime": 701.0, "diff_num_grad_updates_vs_sampler_policy": 700.0}}, "num_env_steps_sampled": 84240, "num_env_steps_trained": 84240, "num_agent_steps_sampled": 84240, "num_agent_steps_trained": 84240}, "sampler_results": {"episode_reward_max": -29493.622950342055, "episode_reward_min": -30233.345798788116, "episode_reward_mean": -29881.653562376127, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-29754.698620915642, -30070.308814531836, -29993.26869500578, -29752.799588510075, -30043.48687502352, -29838.241144333268, -29920.611377895126, -29924.455142119088, -29811.5423120522, -29869.746231989895, -29761.5002540869, -30139.582092677083, -30035.73094352778, -30005.63178435851, -29652.122346541295, -30233.345798788116, -29839.15438020255, -29880.69717237495, -29868.909199066777, -29656.50942175287, -29786.387514156668, -29940.772096504068, -30112.522561288562, -29980.439121478223, -29984.4959975829, -30113.054436096532, -30023.27791941823, -29800.69896446871, -29887.260219338234, -29866.251375417585, -29860.21131238479, -30018.512591913997, -30019.601462185994, -30204.452278414577, -29995.223291650258, -29732.67275139709, -29725.906849650288, -29943.414783710286, -29718.729913982388, -29728.27577818911, -29724.936695805318, -29837.831322222362, -29958.293524780096, -29585.311827919053, -29816.02392927729, -29695.265333660434, -29852.20611686021, -30018.171670373737, -29875.327304266277, -29851.294274613432, -29756.35552602704, -29692.812524018445, -29910.092514829263, -30110.1876900806, -29875.740454341816, -29984.19355397358, -29858.82987325074, -29871.259264531935, -30131.13362484784, -30075.987070417603, -29833.424221843467, -30013.58085180937, -30105.616752690992, -30124.00592166468, -29728.40926564023, -29727.02008502632, -29849.55095524363, -29686.043412542873, -30076.11415840042, -29493.622950342055, -29999.940953204612, -29927.552167962298, -30034.237481121414, -29940.106997576408, -29851.598466892006, -29851.17816675025, -29758.31571960719, -29698.70096416914, -29752.33836249519, -29724.520520881266, -29828.47634821921, -29912.34275767336, -29738.78365407845, -29581.156238000196, -29782.646647494497, -29534.140652548722, -29954.82094612775, -29678.508092159133, -29753.41040762024, -30074.188370303957, -29813.00050972671, -30009.122726198522, -29785.933695821175, -29676.234010301047, -29823.370203113936, -30043.81083780306, -29959.476595282806, -30118.200268327324, -29886.69951357799, -30059.39787629178], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.4041287457578004, "mean_inference_ms": 0.25005456004998067, "mean_action_processing_ms": 0.0589598119235964, "mean_env_wait_ms": 1.489270550356346, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0025115013122558594, "StateBufferConnector_ms": 0.0017809867858886719, "ViewRequirementAgentConnector_ms": 0.044816017150878906}}, "episode_reward_max": -29493.622950342055, "episode_reward_min": -30233.345798788116, "episode_reward_mean": -29881.653562376127, "episode_len_mean": 360.0, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-29754.698620915642, -30070.308814531836, -29993.26869500578, -29752.799588510075, -30043.48687502352, -29838.241144333268, -29920.611377895126, -29924.455142119088, -29811.5423120522, -29869.746231989895, -29761.5002540869, -30139.582092677083, -30035.73094352778, -30005.63178435851, -29652.122346541295, -30233.345798788116, -29839.15438020255, -29880.69717237495, -29868.909199066777, -29656.50942175287, -29786.387514156668, -29940.772096504068, -30112.522561288562, -29980.439121478223, -29984.4959975829, -30113.054436096532, -30023.27791941823, -29800.69896446871, -29887.260219338234, -29866.251375417585, -29860.21131238479, -30018.512591913997, -30019.601462185994, -30204.452278414577, -29995.223291650258, -29732.67275139709, -29725.906849650288, -29943.414783710286, -29718.729913982388, -29728.27577818911, -29724.936695805318, -29837.831322222362, -29958.293524780096, -29585.311827919053, -29816.02392927729, -29695.265333660434, -29852.20611686021, -30018.171670373737, -29875.327304266277, -29851.294274613432, -29756.35552602704, -29692.812524018445, -29910.092514829263, -30110.1876900806, -29875.740454341816, -29984.19355397358, -29858.82987325074, -29871.259264531935, -30131.13362484784, -30075.987070417603, -29833.424221843467, -30013.58085180937, -30105.616752690992, -30124.00592166468, -29728.40926564023, -29727.02008502632, -29849.55095524363, -29686.043412542873, -30076.11415840042, -29493.622950342055, -29999.940953204612, -29927.552167962298, -30034.237481121414, -29940.106997576408, -29851.598466892006, -29851.17816675025, -29758.31571960719, -29698.70096416914, -29752.33836249519, -29724.520520881266, -29828.47634821921, -29912.34275767336, -29738.78365407845, -29581.156238000196, -29782.646647494497, -29534.140652548722, -29954.82094612775, -29678.508092159133, -29753.41040762024, -30074.188370303957, -29813.00050972671, -30009.122726198522, -29785.933695821175, -29676.234010301047, -29823.370203113936, -30043.81083780306, -29959.476595282806, -30118.200268327324, -29886.69951357799, -30059.39787629178], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.4041287457578004, "mean_inference_ms": 0.25005456004998067, "mean_action_processing_ms": 0.0589598119235964, "mean_env_wait_ms": 1.489270550356346, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0025115013122558594, "StateBufferConnector_ms": 0.0017809867858886719, "ViewRequirementAgentConnector_ms": 0.044816017150878906}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 84240, "num_agent_steps_trained": 84240, "num_env_steps_sampled": 84240, "num_env_steps_trained": 84240, "num_env_steps_sampled_this_iter": 1800, "num_env_steps_trained_this_iter": 1800, "num_env_steps_sampled_throughput_per_sec": 161.90120843462773, "num_env_steps_trained_throughput_per_sec": 161.90120843462773, "timesteps_total": 84240, "num_steps_trained_this_iter": 1800, "agent_timesteps_total": 84240, "timers": {"training_iteration_time_ms": 2229.538, "sample_time_ms": 2224.111, "load_time_ms": 0.222, "load_throughput": 1620813.053, "learn_time_ms": 4.624, "learn_throughput": 77856.926, "synch_weights_time_ms": 0.547}, "counters": {"num_env_steps_sampled": 84240, "num_env_steps_trained": 84240, "num_agent_steps_sampled": 84240, "num_agent_steps_trained": 84240}, "done": false, "episodes_total": 234, "training_iteration": 47, "trial_id": "4935e_00000", "date": "2023-07-25_15-55-23", "timestamp": 1690289723, "time_this_iter_s": 11.120069980621338, "time_total_s": 524.6499600410461, "pid": 67353, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[0, 0.003], [5400, 0.001], [10800, 0.00075], [16200, 0.0005], [21600, 0.00025], [27000, 0.0001], [32400, 7.5e-05], [37800, 5e-05], [43200, 2.5e-05], [48600, 1e-05], [54000, 7.5e-06], [59400, 5e-06], [64800, 2.5e-06], [70200, 1e-06], [75600, 5e-07], [81000, 1e-07]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x177531310>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 524.6499600410461, "iterations_since_restore": 47, "perf": {"cpu_util_percent": 24.91875, "ram_util_percent": 79.36875}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-07, "entropy_coeff": 0.10000000000000002, "policy_entropy": -1859.8604736328125, "policy_loss": -2221141917696.0, "vf_loss": 2458466304.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 120.0, "num_grad_updates_lifetime": 716.0, "diff_num_grad_updates_vs_sampler_policy": 715.0}}, "num_env_steps_sampled": 86040, "num_env_steps_trained": 86040, "num_agent_steps_sampled": 86040, "num_agent_steps_trained": 86040}, "sampler_results": {"episode_reward_max": -29493.622950342055, "episode_reward_min": -30289.079314542912, "episode_reward_mean": -29883.17662835862, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-29838.241144333268, -29920.611377895126, -29924.455142119088, -29811.5423120522, -29869.746231989895, -29761.5002540869, -30139.582092677083, -30035.73094352778, -30005.63178435851, -29652.122346541295, -30233.345798788116, -29839.15438020255, -29880.69717237495, -29868.909199066777, -29656.50942175287, -29786.387514156668, -29940.772096504068, -30112.522561288562, -29980.439121478223, -29984.4959975829, -30113.054436096532, -30023.27791941823, -29800.69896446871, -29887.260219338234, -29866.251375417585, -29860.21131238479, -30018.512591913997, -30019.601462185994, -30204.452278414577, -29995.223291650258, -29732.67275139709, -29725.906849650288, -29943.414783710286, -29718.729913982388, -29728.27577818911, -29724.936695805318, -29837.831322222362, -29958.293524780096, -29585.311827919053, -29816.02392927729, -29695.265333660434, -29852.20611686021, -30018.171670373737, -29875.327304266277, -29851.294274613432, -29756.35552602704, -29692.812524018445, -29910.092514829263, -30110.1876900806, -29875.740454341816, -29984.19355397358, -29858.82987325074, -29871.259264531935, -30131.13362484784, -30075.987070417603, -29833.424221843467, -30013.58085180937, -30105.616752690992, -30124.00592166468, -29728.40926564023, -29727.02008502632, -29849.55095524363, -29686.043412542873, -30076.11415840042, -29493.622950342055, -29999.940953204612, -29927.552167962298, -30034.237481121414, -29940.106997576408, -29851.598466892006, -29851.17816675025, -29758.31571960719, -29698.70096416914, -29752.33836249519, -29724.520520881266, -29828.47634821921, -29912.34275767336, -29738.78365407845, -29581.156238000196, -29782.646647494497, -29534.140652548722, -29954.82094612775, -29678.508092159133, -29753.41040762024, -30074.188370303957, -29813.00050972671, -30009.122726198522, -29785.933695821175, -29676.234010301047, -29823.370203113936, -30043.81083780306, -29959.476595282806, -30118.200268327324, -29886.69951357799, -30059.39787629178, -29859.246272981756, -29865.168614678318, -30006.781781675334, -30289.079314542912, -29746.593208358234], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.403543884553294, "mean_inference_ms": 0.2500713331426667, "mean_action_processing_ms": 0.0589598521168602, "mean_env_wait_ms": 1.4883231333902336, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0025148391723632812, "StateBufferConnector_ms": 0.0017898082733154297, "ViewRequirementAgentConnector_ms": 0.04483604431152344}}, "episode_reward_max": -29493.622950342055, "episode_reward_min": -30289.079314542912, "episode_reward_mean": -29883.17662835862, "episode_len_mean": 360.0, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-29838.241144333268, -29920.611377895126, -29924.455142119088, -29811.5423120522, -29869.746231989895, -29761.5002540869, -30139.582092677083, -30035.73094352778, -30005.63178435851, -29652.122346541295, -30233.345798788116, -29839.15438020255, -29880.69717237495, -29868.909199066777, -29656.50942175287, -29786.387514156668, -29940.772096504068, -30112.522561288562, -29980.439121478223, -29984.4959975829, -30113.054436096532, -30023.27791941823, -29800.69896446871, -29887.260219338234, -29866.251375417585, -29860.21131238479, -30018.512591913997, -30019.601462185994, -30204.452278414577, -29995.223291650258, -29732.67275139709, -29725.906849650288, -29943.414783710286, -29718.729913982388, -29728.27577818911, -29724.936695805318, -29837.831322222362, -29958.293524780096, -29585.311827919053, -29816.02392927729, -29695.265333660434, -29852.20611686021, -30018.171670373737, -29875.327304266277, -29851.294274613432, -29756.35552602704, -29692.812524018445, -29910.092514829263, -30110.1876900806, -29875.740454341816, -29984.19355397358, -29858.82987325074, -29871.259264531935, -30131.13362484784, -30075.987070417603, -29833.424221843467, -30013.58085180937, -30105.616752690992, -30124.00592166468, -29728.40926564023, -29727.02008502632, -29849.55095524363, -29686.043412542873, -30076.11415840042, -29493.622950342055, -29999.940953204612, -29927.552167962298, -30034.237481121414, -29940.106997576408, -29851.598466892006, -29851.17816675025, -29758.31571960719, -29698.70096416914, -29752.33836249519, -29724.520520881266, -29828.47634821921, -29912.34275767336, -29738.78365407845, -29581.156238000196, -29782.646647494497, -29534.140652548722, -29954.82094612775, -29678.508092159133, -29753.41040762024, -30074.188370303957, -29813.00050972671, -30009.122726198522, -29785.933695821175, -29676.234010301047, -29823.370203113936, -30043.81083780306, -29959.476595282806, -30118.200268327324, -29886.69951357799, -30059.39787629178, -29859.246272981756, -29865.168614678318, -30006.781781675334, -30289.079314542912, -29746.593208358234], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.403543884553294, "mean_inference_ms": 0.2500713331426667, "mean_action_processing_ms": 0.0589598521168602, "mean_env_wait_ms": 1.4883231333902336, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0025148391723632812, "StateBufferConnector_ms": 0.0017898082733154297, "ViewRequirementAgentConnector_ms": 0.04483604431152344}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 86040, "num_agent_steps_trained": 86040, "num_env_steps_sampled": 86040, "num_env_steps_trained": 86040, "num_env_steps_sampled_this_iter": 1800, "num_env_steps_trained_this_iter": 1800, "num_env_steps_sampled_throughput_per_sec": 161.38474888707594, "num_env_steps_trained_throughput_per_sec": 161.38474888707594, "timesteps_total": 86040, "num_steps_trained_this_iter": 1800, "agent_timesteps_total": 86040, "timers": {"training_iteration_time_ms": 2227.126, "sample_time_ms": 2221.661, "load_time_ms": 0.222, "load_throughput": 1618034.119, "learn_time_ms": 4.652, "learn_throughput": 77385.286, "synch_weights_time_ms": 0.557}, "counters": {"num_env_steps_sampled": 86040, "num_env_steps_trained": 86040, "num_agent_steps_sampled": 86040, "num_agent_steps_trained": 86040}, "done": false, "episodes_total": 239, "training_iteration": 48, "trial_id": "4935e_00000", "date": "2023-07-25_15-55-34", "timestamp": 1690289734, "time_this_iter_s": 11.155670166015625, "time_total_s": 535.8056302070618, "pid": 67353, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[0, 0.003], [5400, 0.001], [10800, 0.00075], [16200, 0.0005], [21600, 0.00025], [27000, 0.0001], [32400, 7.5e-05], [37800, 5e-05], [43200, 2.5e-05], [48600, 1e-05], [54000, 7.5e-06], [59400, 5e-06], [64800, 2.5e-06], [70200, 1e-06], [75600, 5e-07], [81000, 1e-07]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x177531310>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 535.8056302070618, "iterations_since_restore": 48, "perf": {"cpu_util_percent": 24.03125, "ram_util_percent": 79.3125}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-07, "entropy_coeff": 0.10000000000000002, "policy_entropy": -1859.8598225911458, "policy_loss": -1391032482474.6667, "vf_loss": 2549836586.6666665}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 120.0, "num_grad_updates_lifetime": 731.0, "diff_num_grad_updates_vs_sampler_policy": 730.0}}, "num_env_steps_sampled": 87840, "num_env_steps_trained": 87840, "num_agent_steps_sampled": 87840, "num_agent_steps_trained": 87840}, "sampler_results": {"episode_reward_max": -29493.622950342055, "episode_reward_min": -30289.079314542912, "episode_reward_mean": -29888.099121500283, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-29761.5002540869, -30139.582092677083, -30035.73094352778, -30005.63178435851, -29652.122346541295, -30233.345798788116, -29839.15438020255, -29880.69717237495, -29868.909199066777, -29656.50942175287, -29786.387514156668, -29940.772096504068, -30112.522561288562, -29980.439121478223, -29984.4959975829, -30113.054436096532, -30023.27791941823, -29800.69896446871, -29887.260219338234, -29866.251375417585, -29860.21131238479, -30018.512591913997, -30019.601462185994, -30204.452278414577, -29995.223291650258, -29732.67275139709, -29725.906849650288, -29943.414783710286, -29718.729913982388, -29728.27577818911, -29724.936695805318, -29837.831322222362, -29958.293524780096, -29585.311827919053, -29816.02392927729, -29695.265333660434, -29852.20611686021, -30018.171670373737, -29875.327304266277, -29851.294274613432, -29756.35552602704, -29692.812524018445, -29910.092514829263, -30110.1876900806, -29875.740454341816, -29984.19355397358, -29858.82987325074, -29871.259264531935, -30131.13362484784, -30075.987070417603, -29833.424221843467, -30013.58085180937, -30105.616752690992, -30124.00592166468, -29728.40926564023, -29727.02008502632, -29849.55095524363, -29686.043412542873, -30076.11415840042, -29493.622950342055, -29999.940953204612, -29927.552167962298, -30034.237481121414, -29940.106997576408, -29851.598466892006, -29851.17816675025, -29758.31571960719, -29698.70096416914, -29752.33836249519, -29724.520520881266, -29828.47634821921, -29912.34275767336, -29738.78365407845, -29581.156238000196, -29782.646647494497, -29534.140652548722, -29954.82094612775, -29678.508092159133, -29753.41040762024, -30074.188370303957, -29813.00050972671, -30009.122726198522, -29785.933695821175, -29676.234010301047, -29823.370203113936, -30043.81083780306, -29959.476595282806, -30118.200268327324, -29886.69951357799, -30059.39787629178, -29859.246272981756, -29865.168614678318, -30006.781781675334, -30289.079314542912, -29746.593208358234, -29895.261504209688, -29845.61078481126, -29991.366086599584, -29933.65605863185, -30190.95108830336], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.402984308286935, "mean_inference_ms": 0.2500663024083684, "mean_action_processing_ms": 0.058958881586823005, "mean_env_wait_ms": 1.487377223765918, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002508878707885742, "StateBufferConnector_ms": 0.0017781257629394531, "ViewRequirementAgentConnector_ms": 0.04476523399353027}}, "episode_reward_max": -29493.622950342055, "episode_reward_min": -30289.079314542912, "episode_reward_mean": -29888.099121500283, "episode_len_mean": 360.0, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-29761.5002540869, -30139.582092677083, -30035.73094352778, -30005.63178435851, -29652.122346541295, -30233.345798788116, -29839.15438020255, -29880.69717237495, -29868.909199066777, -29656.50942175287, -29786.387514156668, -29940.772096504068, -30112.522561288562, -29980.439121478223, -29984.4959975829, -30113.054436096532, -30023.27791941823, -29800.69896446871, -29887.260219338234, -29866.251375417585, -29860.21131238479, -30018.512591913997, -30019.601462185994, -30204.452278414577, -29995.223291650258, -29732.67275139709, -29725.906849650288, -29943.414783710286, -29718.729913982388, -29728.27577818911, -29724.936695805318, -29837.831322222362, -29958.293524780096, -29585.311827919053, -29816.02392927729, -29695.265333660434, -29852.20611686021, -30018.171670373737, -29875.327304266277, -29851.294274613432, -29756.35552602704, -29692.812524018445, -29910.092514829263, -30110.1876900806, -29875.740454341816, -29984.19355397358, -29858.82987325074, -29871.259264531935, -30131.13362484784, -30075.987070417603, -29833.424221843467, -30013.58085180937, -30105.616752690992, -30124.00592166468, -29728.40926564023, -29727.02008502632, -29849.55095524363, -29686.043412542873, -30076.11415840042, -29493.622950342055, -29999.940953204612, -29927.552167962298, -30034.237481121414, -29940.106997576408, -29851.598466892006, -29851.17816675025, -29758.31571960719, -29698.70096416914, -29752.33836249519, -29724.520520881266, -29828.47634821921, -29912.34275767336, -29738.78365407845, -29581.156238000196, -29782.646647494497, -29534.140652548722, -29954.82094612775, -29678.508092159133, -29753.41040762024, -30074.188370303957, -29813.00050972671, -30009.122726198522, -29785.933695821175, -29676.234010301047, -29823.370203113936, -30043.81083780306, -29959.476595282806, -30118.200268327324, -29886.69951357799, -30059.39787629178, -29859.246272981756, -29865.168614678318, -30006.781781675334, -30289.079314542912, -29746.593208358234, -29895.261504209688, -29845.61078481126, -29991.366086599584, -29933.65605863185, -30190.95108830336], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.402984308286935, "mean_inference_ms": 0.2500663024083684, "mean_action_processing_ms": 0.058958881586823005, "mean_env_wait_ms": 1.487377223765918, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002508878707885742, "StateBufferConnector_ms": 0.0017781257629394531, "ViewRequirementAgentConnector_ms": 0.04476523399353027}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 87840, "num_agent_steps_trained": 87840, "num_env_steps_sampled": 87840, "num_env_steps_trained": 87840, "num_env_steps_sampled_this_iter": 1800, "num_env_steps_trained_this_iter": 1800, "num_env_steps_sampled_throughput_per_sec": 163.34311859888538, "num_env_steps_trained_throughput_per_sec": 163.34311859888538, "timesteps_total": 87840, "num_steps_trained_this_iter": 1800, "agent_timesteps_total": 87840, "timers": {"training_iteration_time_ms": 2217.309, "sample_time_ms": 2211.951, "load_time_ms": 0.218, "load_throughput": 1650578.749, "learn_time_ms": 4.599, "learn_throughput": 78272.222, "synch_weights_time_ms": 0.509}, "counters": {"num_env_steps_sampled": 87840, "num_env_steps_trained": 87840, "num_agent_steps_sampled": 87840, "num_agent_steps_trained": 87840}, "done": false, "episodes_total": 244, "training_iteration": 49, "trial_id": "4935e_00000", "date": "2023-07-25_15-55-45", "timestamp": 1690289745, "time_this_iter_s": 11.021891117095947, "time_total_s": 546.8275213241577, "pid": 67353, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[0, 0.003], [5400, 0.001], [10800, 0.00075], [16200, 0.0005], [21600, 0.00025], [27000, 0.0001], [32400, 7.5e-05], [37800, 5e-05], [43200, 2.5e-05], [48600, 1e-05], [54000, 7.5e-06], [59400, 5e-06], [64800, 2.5e-06], [70200, 1e-06], [75600, 5e-07], [81000, 1e-07]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x177531310>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 546.8275213241577, "iterations_since_restore": 49, "perf": {"cpu_util_percent": 21.806666666666672, "ram_util_percent": 79.35333333333332}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-07, "entropy_coeff": 0.10000000000000002, "policy_entropy": -1859.8604736328125, "policy_loss": -4741243169450.667, "vf_loss": 2454664746.6666665}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 120.0, "num_grad_updates_lifetime": 746.0, "diff_num_grad_updates_vs_sampler_policy": 745.0}}, "num_env_steps_sampled": 89640, "num_env_steps_trained": 89640, "num_agent_steps_sampled": 89640, "num_agent_steps_trained": 89640}, "sampler_results": {"episode_reward_max": -29493.622950342055, "episode_reward_min": -30289.079314542912, "episode_reward_mean": -29889.422846944464, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-30233.345798788116, -29839.15438020255, -29880.69717237495, -29868.909199066777, -29656.50942175287, -29786.387514156668, -29940.772096504068, -30112.522561288562, -29980.439121478223, -29984.4959975829, -30113.054436096532, -30023.27791941823, -29800.69896446871, -29887.260219338234, -29866.251375417585, -29860.21131238479, -30018.512591913997, -30019.601462185994, -30204.452278414577, -29995.223291650258, -29732.67275139709, -29725.906849650288, -29943.414783710286, -29718.729913982388, -29728.27577818911, -29724.936695805318, -29837.831322222362, -29958.293524780096, -29585.311827919053, -29816.02392927729, -29695.265333660434, -29852.20611686021, -30018.171670373737, -29875.327304266277, -29851.294274613432, -29756.35552602704, -29692.812524018445, -29910.092514829263, -30110.1876900806, -29875.740454341816, -29984.19355397358, -29858.82987325074, -29871.259264531935, -30131.13362484784, -30075.987070417603, -29833.424221843467, -30013.58085180937, -30105.616752690992, -30124.00592166468, -29728.40926564023, -29727.02008502632, -29849.55095524363, -29686.043412542873, -30076.11415840042, -29493.622950342055, -29999.940953204612, -29927.552167962298, -30034.237481121414, -29940.106997576408, -29851.598466892006, -29851.17816675025, -29758.31571960719, -29698.70096416914, -29752.33836249519, -29724.520520881266, -29828.47634821921, -29912.34275767336, -29738.78365407845, -29581.156238000196, -29782.646647494497, -29534.140652548722, -29954.82094612775, -29678.508092159133, -29753.41040762024, -30074.188370303957, -29813.00050972671, -30009.122726198522, -29785.933695821175, -29676.234010301047, -29823.370203113936, -30043.81083780306, -29959.476595282806, -30118.200268327324, -29886.69951357799, -30059.39787629178, -29859.246272981756, -29865.168614678318, -30006.781781675334, -30289.079314542912, -29746.593208358234, -29895.261504209688, -29845.61078481126, -29991.366086599584, -29933.65605863185, -30190.95108830336, -30023.581809845524, -30159.735297225863, -29907.91758061034, -29942.070068756948, -29693.63520917123], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.402425781342145, "mean_inference_ms": 0.25005440402709966, "mean_action_processing_ms": 0.058957171965087304, "mean_env_wait_ms": 1.4864775972399453, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0025043487548828125, "StateBufferConnector_ms": 0.0017790794372558594, "ViewRequirementAgentConnector_ms": 0.04474020004272461}}, "episode_reward_max": -29493.622950342055, "episode_reward_min": -30289.079314542912, "episode_reward_mean": -29889.422846944464, "episode_len_mean": 360.0, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-30233.345798788116, -29839.15438020255, -29880.69717237495, -29868.909199066777, -29656.50942175287, -29786.387514156668, -29940.772096504068, -30112.522561288562, -29980.439121478223, -29984.4959975829, -30113.054436096532, -30023.27791941823, -29800.69896446871, -29887.260219338234, -29866.251375417585, -29860.21131238479, -30018.512591913997, -30019.601462185994, -30204.452278414577, -29995.223291650258, -29732.67275139709, -29725.906849650288, -29943.414783710286, -29718.729913982388, -29728.27577818911, -29724.936695805318, -29837.831322222362, -29958.293524780096, -29585.311827919053, -29816.02392927729, -29695.265333660434, -29852.20611686021, -30018.171670373737, -29875.327304266277, -29851.294274613432, -29756.35552602704, -29692.812524018445, -29910.092514829263, -30110.1876900806, -29875.740454341816, -29984.19355397358, -29858.82987325074, -29871.259264531935, -30131.13362484784, -30075.987070417603, -29833.424221843467, -30013.58085180937, -30105.616752690992, -30124.00592166468, -29728.40926564023, -29727.02008502632, -29849.55095524363, -29686.043412542873, -30076.11415840042, -29493.622950342055, -29999.940953204612, -29927.552167962298, -30034.237481121414, -29940.106997576408, -29851.598466892006, -29851.17816675025, -29758.31571960719, -29698.70096416914, -29752.33836249519, -29724.520520881266, -29828.47634821921, -29912.34275767336, -29738.78365407845, -29581.156238000196, -29782.646647494497, -29534.140652548722, -29954.82094612775, -29678.508092159133, -29753.41040762024, -30074.188370303957, -29813.00050972671, -30009.122726198522, -29785.933695821175, -29676.234010301047, -29823.370203113936, -30043.81083780306, -29959.476595282806, -30118.200268327324, -29886.69951357799, -30059.39787629178, -29859.246272981756, -29865.168614678318, -30006.781781675334, -30289.079314542912, -29746.593208358234, -29895.261504209688, -29845.61078481126, -29991.366086599584, -29933.65605863185, -30190.95108830336, -30023.581809845524, -30159.735297225863, -29907.91758061034, -29942.070068756948, -29693.63520917123], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.402425781342145, "mean_inference_ms": 0.25005440402709966, "mean_action_processing_ms": 0.058957171965087304, "mean_env_wait_ms": 1.4864775972399453, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0025043487548828125, "StateBufferConnector_ms": 0.0017790794372558594, "ViewRequirementAgentConnector_ms": 0.04474020004272461}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 89640, "num_agent_steps_trained": 89640, "num_env_steps_sampled": 89640, "num_env_steps_trained": 89640, "num_env_steps_sampled_this_iter": 1800, "num_env_steps_trained_this_iter": 1800, "num_env_steps_sampled_throughput_per_sec": 162.60362316694622, "num_env_steps_trained_throughput_per_sec": 162.60362316694622, "timesteps_total": 89640, "num_steps_trained_this_iter": 1800, "agent_timesteps_total": 89640, "timers": {"training_iteration_time_ms": 2208.948, "sample_time_ms": 2203.582, "load_time_ms": 0.219, "load_throughput": 1640357.892, "learn_time_ms": 4.602, "learn_throughput": 78231.669, "synch_weights_time_ms": 0.513}, "counters": {"num_env_steps_sampled": 89640, "num_env_steps_trained": 89640, "num_agent_steps_sampled": 89640, "num_agent_steps_trained": 89640}, "done": false, "episodes_total": 249, "training_iteration": 50, "trial_id": "4935e_00000", "date": "2023-07-25_15-55-56", "timestamp": 1690289756, "time_this_iter_s": 11.07195496559143, "time_total_s": 557.8994762897491, "pid": 67353, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[0, 0.003], [5400, 0.001], [10800, 0.00075], [16200, 0.0005], [21600, 0.00025], [27000, 0.0001], [32400, 7.5e-05], [37800, 5e-05], [43200, 2.5e-05], [48600, 1e-05], [54000, 7.5e-06], [59400, 5e-06], [64800, 2.5e-06], [70200, 1e-06], [75600, 5e-07], [81000, 1e-07]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x177531310>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 557.8994762897491, "iterations_since_restore": 50, "perf": {"cpu_util_percent": 22.35, "ram_util_percent": 79.3625}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-07, "entropy_coeff": 0.10000000000000002, "policy_entropy": -1859.8599853515625, "policy_loss": -5436592294570.667, "vf_loss": 2517461376.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 120.0, "num_grad_updates_lifetime": 761.0, "diff_num_grad_updates_vs_sampler_policy": 760.0}}, "num_env_steps_sampled": 91440, "num_env_steps_trained": 91440, "num_agent_steps_sampled": 91440, "num_agent_steps_trained": 91440}, "sampler_results": {"episode_reward_max": -29493.622950342055, "episode_reward_min": -30289.079314542912, "episode_reward_mean": -29889.406451158797, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-29786.387514156668, -29940.772096504068, -30112.522561288562, -29980.439121478223, -29984.4959975829, -30113.054436096532, -30023.27791941823, -29800.69896446871, -29887.260219338234, -29866.251375417585, -29860.21131238479, -30018.512591913997, -30019.601462185994, -30204.452278414577, -29995.223291650258, -29732.67275139709, -29725.906849650288, -29943.414783710286, -29718.729913982388, -29728.27577818911, -29724.936695805318, -29837.831322222362, -29958.293524780096, -29585.311827919053, -29816.02392927729, -29695.265333660434, -29852.20611686021, -30018.171670373737, -29875.327304266277, -29851.294274613432, -29756.35552602704, -29692.812524018445, -29910.092514829263, -30110.1876900806, -29875.740454341816, -29984.19355397358, -29858.82987325074, -29871.259264531935, -30131.13362484784, -30075.987070417603, -29833.424221843467, -30013.58085180937, -30105.616752690992, -30124.00592166468, -29728.40926564023, -29727.02008502632, -29849.55095524363, -29686.043412542873, -30076.11415840042, -29493.622950342055, -29999.940953204612, -29927.552167962298, -30034.237481121414, -29940.106997576408, -29851.598466892006, -29851.17816675025, -29758.31571960719, -29698.70096416914, -29752.33836249519, -29724.520520881266, -29828.47634821921, -29912.34275767336, -29738.78365407845, -29581.156238000196, -29782.646647494497, -29534.140652548722, -29954.82094612775, -29678.508092159133, -29753.41040762024, -30074.188370303957, -29813.00050972671, -30009.122726198522, -29785.933695821175, -29676.234010301047, -29823.370203113936, -30043.81083780306, -29959.476595282806, -30118.200268327324, -29886.69951357799, -30059.39787629178, -29859.246272981756, -29865.168614678318, -30006.781781675334, -30289.079314542912, -29746.593208358234, -29895.261504209688, -29845.61078481126, -29991.366086599584, -29933.65605863185, -30190.95108830336, -30023.581809845524, -30159.735297225863, -29907.91758061034, -29942.070068756948, -29693.63520917123, -29812.873974677997, -29907.89440624365, -29810.298594569467, -29918.551763915988, -30027.357654211384], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.401952640677813, "mean_inference_ms": 0.2500327806384133, "mean_action_processing_ms": 0.058954073582907156, "mean_env_wait_ms": 1.4856206054644983, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0024793148040771484, "StateBufferConnector_ms": 0.0017685890197753906, "ViewRequirementAgentConnector_ms": 0.04437875747680664}}, "episode_reward_max": -29493.622950342055, "episode_reward_min": -30289.079314542912, "episode_reward_mean": -29889.406451158797, "episode_len_mean": 360.0, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-29786.387514156668, -29940.772096504068, -30112.522561288562, -29980.439121478223, -29984.4959975829, -30113.054436096532, -30023.27791941823, -29800.69896446871, -29887.260219338234, -29866.251375417585, -29860.21131238479, -30018.512591913997, -30019.601462185994, -30204.452278414577, -29995.223291650258, -29732.67275139709, -29725.906849650288, -29943.414783710286, -29718.729913982388, -29728.27577818911, -29724.936695805318, -29837.831322222362, -29958.293524780096, -29585.311827919053, -29816.02392927729, -29695.265333660434, -29852.20611686021, -30018.171670373737, -29875.327304266277, -29851.294274613432, -29756.35552602704, -29692.812524018445, -29910.092514829263, -30110.1876900806, -29875.740454341816, -29984.19355397358, -29858.82987325074, -29871.259264531935, -30131.13362484784, -30075.987070417603, -29833.424221843467, -30013.58085180937, -30105.616752690992, -30124.00592166468, -29728.40926564023, -29727.02008502632, -29849.55095524363, -29686.043412542873, -30076.11415840042, -29493.622950342055, -29999.940953204612, -29927.552167962298, -30034.237481121414, -29940.106997576408, -29851.598466892006, -29851.17816675025, -29758.31571960719, -29698.70096416914, -29752.33836249519, -29724.520520881266, -29828.47634821921, -29912.34275767336, -29738.78365407845, -29581.156238000196, -29782.646647494497, -29534.140652548722, -29954.82094612775, -29678.508092159133, -29753.41040762024, -30074.188370303957, -29813.00050972671, -30009.122726198522, -29785.933695821175, -29676.234010301047, -29823.370203113936, -30043.81083780306, -29959.476595282806, -30118.200268327324, -29886.69951357799, -30059.39787629178, -29859.246272981756, -29865.168614678318, -30006.781781675334, -30289.079314542912, -29746.593208358234, -29895.261504209688, -29845.61078481126, -29991.366086599584, -29933.65605863185, -30190.95108830336, -30023.581809845524, -30159.735297225863, -29907.91758061034, -29942.070068756948, -29693.63520917123, -29812.873974677997, -29907.89440624365, -29810.298594569467, -29918.551763915988, -30027.357654211384], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.401952640677813, "mean_inference_ms": 0.2500327806384133, "mean_action_processing_ms": 0.058954073582907156, "mean_env_wait_ms": 1.4856206054644983, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0024793148040771484, "StateBufferConnector_ms": 0.0017685890197753906, "ViewRequirementAgentConnector_ms": 0.04437875747680664}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 91440, "num_agent_steps_trained": 91440, "num_env_steps_sampled": 91440, "num_env_steps_trained": 91440, "num_env_steps_sampled_this_iter": 1800, "num_env_steps_trained_this_iter": 1800, "num_env_steps_sampled_throughput_per_sec": 160.71231787278737, "num_env_steps_trained_throughput_per_sec": 160.71231787278737, "timesteps_total": 91440, "num_steps_trained_this_iter": 1800, "agent_timesteps_total": 91440, "timers": {"training_iteration_time_ms": 2226.991, "sample_time_ms": 2221.564, "load_time_ms": 0.216, "load_throughput": 1662939.912, "learn_time_ms": 4.663, "learn_throughput": 77210.384, "synch_weights_time_ms": 0.516}, "counters": {"num_env_steps_sampled": 91440, "num_env_steps_trained": 91440, "num_agent_steps_sampled": 91440, "num_agent_steps_trained": 91440}, "done": false, "episodes_total": 254, "training_iteration": 51, "trial_id": "4935e_00000", "date": "2023-07-25_15-56-08", "timestamp": 1690289768, "time_this_iter_s": 11.202333211898804, "time_total_s": 569.101809501648, "pid": 67353, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[0, 0.003], [5400, 0.001], [10800, 0.00075], [16200, 0.0005], [21600, 0.00025], [27000, 0.0001], [32400, 7.5e-05], [37800, 5e-05], [43200, 2.5e-05], [48600, 1e-05], [54000, 7.5e-06], [59400, 5e-06], [64800, 2.5e-06], [70200, 1e-06], [75600, 5e-07], [81000, 1e-07]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x177531310>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 569.101809501648, "iterations_since_restore": 51, "perf": {"cpu_util_percent": 24.575000000000003, "ram_util_percent": 79.26875}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-07, "entropy_coeff": 0.10000000000000002, "policy_entropy": -1859.8603515625, "policy_loss": -1821139943424.0, "vf_loss": 2491123648.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 120.0, "num_grad_updates_lifetime": 776.0, "diff_num_grad_updates_vs_sampler_policy": 775.0}}, "num_env_steps_sampled": 93240, "num_env_steps_trained": 93240, "num_agent_steps_sampled": 93240, "num_agent_steps_trained": 93240}, "sampler_results": {"episode_reward_max": -29493.622950342055, "episode_reward_min": -30289.079314542912, "episode_reward_mean": -29886.266141194446, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-30113.054436096532, -30023.27791941823, -29800.69896446871, -29887.260219338234, -29866.251375417585, -29860.21131238479, -30018.512591913997, -30019.601462185994, -30204.452278414577, -29995.223291650258, -29732.67275139709, -29725.906849650288, -29943.414783710286, -29718.729913982388, -29728.27577818911, -29724.936695805318, -29837.831322222362, -29958.293524780096, -29585.311827919053, -29816.02392927729, -29695.265333660434, -29852.20611686021, -30018.171670373737, -29875.327304266277, -29851.294274613432, -29756.35552602704, -29692.812524018445, -29910.092514829263, -30110.1876900806, -29875.740454341816, -29984.19355397358, -29858.82987325074, -29871.259264531935, -30131.13362484784, -30075.987070417603, -29833.424221843467, -30013.58085180937, -30105.616752690992, -30124.00592166468, -29728.40926564023, -29727.02008502632, -29849.55095524363, -29686.043412542873, -30076.11415840042, -29493.622950342055, -29999.940953204612, -29927.552167962298, -30034.237481121414, -29940.106997576408, -29851.598466892006, -29851.17816675025, -29758.31571960719, -29698.70096416914, -29752.33836249519, -29724.520520881266, -29828.47634821921, -29912.34275767336, -29738.78365407845, -29581.156238000196, -29782.646647494497, -29534.140652548722, -29954.82094612775, -29678.508092159133, -29753.41040762024, -30074.188370303957, -29813.00050972671, -30009.122726198522, -29785.933695821175, -29676.234010301047, -29823.370203113936, -30043.81083780306, -29959.476595282806, -30118.200268327324, -29886.69951357799, -30059.39787629178, -29859.246272981756, -29865.168614678318, -30006.781781675334, -30289.079314542912, -29746.593208358234, -29895.261504209688, -29845.61078481126, -29991.366086599584, -29933.65605863185, -30190.95108830336, -30023.581809845524, -30159.735297225863, -29907.91758061034, -29942.070068756948, -29693.63520917123, -29812.873974677997, -29907.89440624365, -29810.298594569467, -29918.551763915988, -30027.357654211384, -29778.1883225291, -29980.16289108057, -29924.491264451637, -29914.166874096354, -29893.576942417283], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.401615673029711, "mean_inference_ms": 0.25001042104246124, "mean_action_processing_ms": 0.058951431115319954, "mean_env_wait_ms": 1.4848248050072983, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002477407455444336, "StateBufferConnector_ms": 0.0017666816711425781, "ViewRequirementAgentConnector_ms": 0.04434800148010254}}, "episode_reward_max": -29493.622950342055, "episode_reward_min": -30289.079314542912, "episode_reward_mean": -29886.266141194446, "episode_len_mean": 360.0, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-30113.054436096532, -30023.27791941823, -29800.69896446871, -29887.260219338234, -29866.251375417585, -29860.21131238479, -30018.512591913997, -30019.601462185994, -30204.452278414577, -29995.223291650258, -29732.67275139709, -29725.906849650288, -29943.414783710286, -29718.729913982388, -29728.27577818911, -29724.936695805318, -29837.831322222362, -29958.293524780096, -29585.311827919053, -29816.02392927729, -29695.265333660434, -29852.20611686021, -30018.171670373737, -29875.327304266277, -29851.294274613432, -29756.35552602704, -29692.812524018445, -29910.092514829263, -30110.1876900806, -29875.740454341816, -29984.19355397358, -29858.82987325074, -29871.259264531935, -30131.13362484784, -30075.987070417603, -29833.424221843467, -30013.58085180937, -30105.616752690992, -30124.00592166468, -29728.40926564023, -29727.02008502632, -29849.55095524363, -29686.043412542873, -30076.11415840042, -29493.622950342055, -29999.940953204612, -29927.552167962298, -30034.237481121414, -29940.106997576408, -29851.598466892006, -29851.17816675025, -29758.31571960719, -29698.70096416914, -29752.33836249519, -29724.520520881266, -29828.47634821921, -29912.34275767336, -29738.78365407845, -29581.156238000196, -29782.646647494497, -29534.140652548722, -29954.82094612775, -29678.508092159133, -29753.41040762024, -30074.188370303957, -29813.00050972671, -30009.122726198522, -29785.933695821175, -29676.234010301047, -29823.370203113936, -30043.81083780306, -29959.476595282806, -30118.200268327324, -29886.69951357799, -30059.39787629178, -29859.246272981756, -29865.168614678318, -30006.781781675334, -30289.079314542912, -29746.593208358234, -29895.261504209688, -29845.61078481126, -29991.366086599584, -29933.65605863185, -30190.95108830336, -30023.581809845524, -30159.735297225863, -29907.91758061034, -29942.070068756948, -29693.63520917123, -29812.873974677997, -29907.89440624365, -29810.298594569467, -29918.551763915988, -30027.357654211384, -29778.1883225291, -29980.16289108057, -29924.491264451637, -29914.166874096354, -29893.576942417283], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.401615673029711, "mean_inference_ms": 0.25001042104246124, "mean_action_processing_ms": 0.058951431115319954, "mean_env_wait_ms": 1.4848248050072983, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002477407455444336, "StateBufferConnector_ms": 0.0017666816711425781, "ViewRequirementAgentConnector_ms": 0.04434800148010254}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 93240, "num_agent_steps_trained": 93240, "num_env_steps_sampled": 93240, "num_env_steps_trained": 93240, "num_env_steps_sampled_this_iter": 1800, "num_env_steps_trained_this_iter": 1800, "num_env_steps_sampled_throughput_per_sec": 159.99970160645927, "num_env_steps_trained_throughput_per_sec": 159.99970160645927, "timesteps_total": 93240, "num_steps_trained_this_iter": 1800, "agent_timesteps_total": 93240, "timers": {"training_iteration_time_ms": 2245.007, "sample_time_ms": 2239.503, "load_time_ms": 0.221, "load_throughput": 1632377.773, "learn_time_ms": 4.726, "learn_throughput": 76179.277, "synch_weights_time_ms": 0.523}, "counters": {"num_env_steps_sampled": 93240, "num_env_steps_trained": 93240, "num_agent_steps_sampled": 93240, "num_agent_steps_trained": 93240}, "done": false, "episodes_total": 259, "training_iteration": 52, "trial_id": "4935e_00000", "date": "2023-07-25_15-56-19", "timestamp": 1690289779, "time_this_iter_s": 11.252047061920166, "time_total_s": 580.3538565635681, "pid": 67353, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[0, 0.003], [5400, 0.001], [10800, 0.00075], [16200, 0.0005], [21600, 0.00025], [27000, 0.0001], [32400, 7.5e-05], [37800, 5e-05], [43200, 2.5e-05], [48600, 1e-05], [54000, 7.5e-06], [59400, 5e-06], [64800, 2.5e-06], [70200, 1e-06], [75600, 5e-07], [81000, 1e-07]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x177531310>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 580.3538565635681, "iterations_since_restore": 52, "perf": {"cpu_util_percent": 29.5375, "ram_util_percent": 79.4625}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-07, "entropy_coeff": 0.10000000000000002, "policy_entropy": -1859.8601481119792, "policy_loss": -3046351029589.3335, "vf_loss": 2487695722.6666665}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 120.0, "num_grad_updates_lifetime": 791.0, "diff_num_grad_updates_vs_sampler_policy": 790.0}}, "num_env_steps_sampled": 95040, "num_env_steps_trained": 95040, "num_agent_steps_sampled": 95040, "num_agent_steps_trained": 95040}, "sampler_results": {"episode_reward_max": -29493.622950342055, "episode_reward_min": -30289.079314542912, "episode_reward_mean": -29888.420745384978, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-29860.21131238479, -30018.512591913997, -30019.601462185994, -30204.452278414577, -29995.223291650258, -29732.67275139709, -29725.906849650288, -29943.414783710286, -29718.729913982388, -29728.27577818911, -29724.936695805318, -29837.831322222362, -29958.293524780096, -29585.311827919053, -29816.02392927729, -29695.265333660434, -29852.20611686021, -30018.171670373737, -29875.327304266277, -29851.294274613432, -29756.35552602704, -29692.812524018445, -29910.092514829263, -30110.1876900806, -29875.740454341816, -29984.19355397358, -29858.82987325074, -29871.259264531935, -30131.13362484784, -30075.987070417603, -29833.424221843467, -30013.58085180937, -30105.616752690992, -30124.00592166468, -29728.40926564023, -29727.02008502632, -29849.55095524363, -29686.043412542873, -30076.11415840042, -29493.622950342055, -29999.940953204612, -29927.552167962298, -30034.237481121414, -29940.106997576408, -29851.598466892006, -29851.17816675025, -29758.31571960719, -29698.70096416914, -29752.33836249519, -29724.520520881266, -29828.47634821921, -29912.34275767336, -29738.78365407845, -29581.156238000196, -29782.646647494497, -29534.140652548722, -29954.82094612775, -29678.508092159133, -29753.41040762024, -30074.188370303957, -29813.00050972671, -30009.122726198522, -29785.933695821175, -29676.234010301047, -29823.370203113936, -30043.81083780306, -29959.476595282806, -30118.200268327324, -29886.69951357799, -30059.39787629178, -29859.246272981756, -29865.168614678318, -30006.781781675334, -30289.079314542912, -29746.593208358234, -29895.261504209688, -29845.61078481126, -29991.366086599584, -29933.65605863185, -30190.95108830336, -30023.581809845524, -30159.735297225863, -29907.91758061034, -29942.070068756948, -29693.63520917123, -29812.873974677997, -29907.89440624365, -29810.298594569467, -29918.551763915988, -30027.357654211384, -29778.1883225291, -29980.16289108057, -29924.491264451637, -29914.166874096354, -29893.576942417283, -29913.08623008574, -30279.299033279745, -29882.02203689561, -29909.89398011046, -29921.702053421035], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.401309656565203, "mean_inference_ms": 0.24999283803545702, "mean_action_processing_ms": 0.05894965083070492, "mean_env_wait_ms": 1.4840741025363855, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002464771270751953, "StateBufferConnector_ms": 0.0017595291137695312, "ViewRequirementAgentConnector_ms": 0.04436540603637695}}, "episode_reward_max": -29493.622950342055, "episode_reward_min": -30289.079314542912, "episode_reward_mean": -29888.420745384978, "episode_len_mean": 360.0, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-29860.21131238479, -30018.512591913997, -30019.601462185994, -30204.452278414577, -29995.223291650258, -29732.67275139709, -29725.906849650288, -29943.414783710286, -29718.729913982388, -29728.27577818911, -29724.936695805318, -29837.831322222362, -29958.293524780096, -29585.311827919053, -29816.02392927729, -29695.265333660434, -29852.20611686021, -30018.171670373737, -29875.327304266277, -29851.294274613432, -29756.35552602704, -29692.812524018445, -29910.092514829263, -30110.1876900806, -29875.740454341816, -29984.19355397358, -29858.82987325074, -29871.259264531935, -30131.13362484784, -30075.987070417603, -29833.424221843467, -30013.58085180937, -30105.616752690992, -30124.00592166468, -29728.40926564023, -29727.02008502632, -29849.55095524363, -29686.043412542873, -30076.11415840042, -29493.622950342055, -29999.940953204612, -29927.552167962298, -30034.237481121414, -29940.106997576408, -29851.598466892006, -29851.17816675025, -29758.31571960719, -29698.70096416914, -29752.33836249519, -29724.520520881266, -29828.47634821921, -29912.34275767336, -29738.78365407845, -29581.156238000196, -29782.646647494497, -29534.140652548722, -29954.82094612775, -29678.508092159133, -29753.41040762024, -30074.188370303957, -29813.00050972671, -30009.122726198522, -29785.933695821175, -29676.234010301047, -29823.370203113936, -30043.81083780306, -29959.476595282806, -30118.200268327324, -29886.69951357799, -30059.39787629178, -29859.246272981756, -29865.168614678318, -30006.781781675334, -30289.079314542912, -29746.593208358234, -29895.261504209688, -29845.61078481126, -29991.366086599584, -29933.65605863185, -30190.95108830336, -30023.581809845524, -30159.735297225863, -29907.91758061034, -29942.070068756948, -29693.63520917123, -29812.873974677997, -29907.89440624365, -29810.298594569467, -29918.551763915988, -30027.357654211384, -29778.1883225291, -29980.16289108057, -29924.491264451637, -29914.166874096354, -29893.576942417283, -29913.08623008574, -30279.299033279745, -29882.02203689561, -29909.89398011046, -29921.702053421035], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.401309656565203, "mean_inference_ms": 0.24999283803545702, "mean_action_processing_ms": 0.05894965083070492, "mean_env_wait_ms": 1.4840741025363855, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002464771270751953, "StateBufferConnector_ms": 0.0017595291137695312, "ViewRequirementAgentConnector_ms": 0.04436540603637695}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 95040, "num_agent_steps_trained": 95040, "num_env_steps_sampled": 95040, "num_env_steps_trained": 95040, "num_env_steps_sampled_this_iter": 1800, "num_env_steps_trained_this_iter": 1800, "num_env_steps_sampled_throughput_per_sec": 162.86955827843744, "num_env_steps_trained_throughput_per_sec": 162.86955827843744, "timesteps_total": 95040, "num_steps_trained_this_iter": 1800, "agent_timesteps_total": 95040, "timers": {"training_iteration_time_ms": 2230.171, "sample_time_ms": 2224.565, "load_time_ms": 0.228, "load_throughput": 1577135.408, "learn_time_ms": 4.797, "learn_throughput": 75041.594, "synch_weights_time_ms": 0.54}, "counters": {"num_env_steps_sampled": 95040, "num_env_steps_trained": 95040, "num_agent_steps_sampled": 95040, "num_agent_steps_trained": 95040}, "done": false, "episodes_total": 264, "training_iteration": 53, "trial_id": "4935e_00000", "date": "2023-07-25_15-56-30", "timestamp": 1690289790, "time_this_iter_s": 11.053751707077026, "time_total_s": 591.4076082706451, "pid": 67353, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[0, 0.003], [5400, 0.001], [10800, 0.00075], [16200, 0.0005], [21600, 0.00025], [27000, 0.0001], [32400, 7.5e-05], [37800, 5e-05], [43200, 2.5e-05], [48600, 1e-05], [54000, 7.5e-06], [59400, 5e-06], [64800, 2.5e-06], [70200, 1e-06], [75600, 5e-07], [81000, 1e-07]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x177531310>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 591.4076082706451, "iterations_since_restore": 53, "perf": {"cpu_util_percent": 21.66, "ram_util_percent": 79.68}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-07, "entropy_coeff": 0.10000000000000002, "policy_entropy": -1859.8599853515625, "policy_loss": -4003837258410.6665, "vf_loss": 2518726016.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 120.0, "num_grad_updates_lifetime": 806.0, "diff_num_grad_updates_vs_sampler_policy": 805.0}}, "num_env_steps_sampled": 96840, "num_env_steps_trained": 96840, "num_agent_steps_sampled": 96840, "num_agent_steps_trained": 96840}, "sampler_results": {"episode_reward_max": -29493.622950342055, "episode_reward_min": -30289.079314542912, "episode_reward_mean": -29878.49868965389, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-29732.67275139709, -29725.906849650288, -29943.414783710286, -29718.729913982388, -29728.27577818911, -29724.936695805318, -29837.831322222362, -29958.293524780096, -29585.311827919053, -29816.02392927729, -29695.265333660434, -29852.20611686021, -30018.171670373737, -29875.327304266277, -29851.294274613432, -29756.35552602704, -29692.812524018445, -29910.092514829263, -30110.1876900806, -29875.740454341816, -29984.19355397358, -29858.82987325074, -29871.259264531935, -30131.13362484784, -30075.987070417603, -29833.424221843467, -30013.58085180937, -30105.616752690992, -30124.00592166468, -29728.40926564023, -29727.02008502632, -29849.55095524363, -29686.043412542873, -30076.11415840042, -29493.622950342055, -29999.940953204612, -29927.552167962298, -30034.237481121414, -29940.106997576408, -29851.598466892006, -29851.17816675025, -29758.31571960719, -29698.70096416914, -29752.33836249519, -29724.520520881266, -29828.47634821921, -29912.34275767336, -29738.78365407845, -29581.156238000196, -29782.646647494497, -29534.140652548722, -29954.82094612775, -29678.508092159133, -29753.41040762024, -30074.188370303957, -29813.00050972671, -30009.122726198522, -29785.933695821175, -29676.234010301047, -29823.370203113936, -30043.81083780306, -29959.476595282806, -30118.200268327324, -29886.69951357799, -30059.39787629178, -29859.246272981756, -29865.168614678318, -30006.781781675334, -30289.079314542912, -29746.593208358234, -29895.261504209688, -29845.61078481126, -29991.366086599584, -29933.65605863185, -30190.95108830336, -30023.581809845524, -30159.735297225863, -29907.91758061034, -29942.070068756948, -29693.63520917123, -29812.873974677997, -29907.89440624365, -29810.298594569467, -29918.551763915988, -30027.357654211384, -29778.1883225291, -29980.16289108057, -29924.491264451637, -29914.166874096354, -29893.576942417283, -29913.08623008574, -30279.299033279745, -29882.02203689561, -29909.89398011046, -29921.702053421035, -29834.9640053065, -29769.254348493607, -29820.60178498895, -29659.48732552499, -30021.4878991273], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.401109318762383, "mean_inference_ms": 0.24997522082176726, "mean_action_processing_ms": 0.05894821854408688, "mean_env_wait_ms": 1.4834084354165367, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0024755001068115234, "StateBufferConnector_ms": 0.0017609596252441406, "ViewRequirementAgentConnector_ms": 0.04440593719482422}}, "episode_reward_max": -29493.622950342055, "episode_reward_min": -30289.079314542912, "episode_reward_mean": -29878.49868965389, "episode_len_mean": 360.0, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-29732.67275139709, -29725.906849650288, -29943.414783710286, -29718.729913982388, -29728.27577818911, -29724.936695805318, -29837.831322222362, -29958.293524780096, -29585.311827919053, -29816.02392927729, -29695.265333660434, -29852.20611686021, -30018.171670373737, -29875.327304266277, -29851.294274613432, -29756.35552602704, -29692.812524018445, -29910.092514829263, -30110.1876900806, -29875.740454341816, -29984.19355397358, -29858.82987325074, -29871.259264531935, -30131.13362484784, -30075.987070417603, -29833.424221843467, -30013.58085180937, -30105.616752690992, -30124.00592166468, -29728.40926564023, -29727.02008502632, -29849.55095524363, -29686.043412542873, -30076.11415840042, -29493.622950342055, -29999.940953204612, -29927.552167962298, -30034.237481121414, -29940.106997576408, -29851.598466892006, -29851.17816675025, -29758.31571960719, -29698.70096416914, -29752.33836249519, -29724.520520881266, -29828.47634821921, -29912.34275767336, -29738.78365407845, -29581.156238000196, -29782.646647494497, -29534.140652548722, -29954.82094612775, -29678.508092159133, -29753.41040762024, -30074.188370303957, -29813.00050972671, -30009.122726198522, -29785.933695821175, -29676.234010301047, -29823.370203113936, -30043.81083780306, -29959.476595282806, -30118.200268327324, -29886.69951357799, -30059.39787629178, -29859.246272981756, -29865.168614678318, -30006.781781675334, -30289.079314542912, -29746.593208358234, -29895.261504209688, -29845.61078481126, -29991.366086599584, -29933.65605863185, -30190.95108830336, -30023.581809845524, -30159.735297225863, -29907.91758061034, -29942.070068756948, -29693.63520917123, -29812.873974677997, -29907.89440624365, -29810.298594569467, -29918.551763915988, -30027.357654211384, -29778.1883225291, -29980.16289108057, -29924.491264451637, -29914.166874096354, -29893.576942417283, -29913.08623008574, -30279.299033279745, -29882.02203689561, -29909.89398011046, -29921.702053421035, -29834.9640053065, -29769.254348493607, -29820.60178498895, -29659.48732552499, -30021.4878991273], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.401109318762383, "mean_inference_ms": 0.24997522082176726, "mean_action_processing_ms": 0.05894821854408688, "mean_env_wait_ms": 1.4834084354165367, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0024755001068115234, "StateBufferConnector_ms": 0.0017609596252441406, "ViewRequirementAgentConnector_ms": 0.04440593719482422}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 96840, "num_agent_steps_trained": 96840, "num_env_steps_sampled": 96840, "num_env_steps_trained": 96840, "num_env_steps_sampled_this_iter": 1800, "num_env_steps_trained_this_iter": 1800, "num_env_steps_sampled_throughput_per_sec": 159.36262272968733, "num_env_steps_trained_throughput_per_sec": 159.36262272968733, "timesteps_total": 96840, "num_steps_trained_this_iter": 1800, "agent_timesteps_total": 96840, "timers": {"training_iteration_time_ms": 2234.668, "sample_time_ms": 2229.118, "load_time_ms": 0.226, "load_throughput": 1592941.703, "learn_time_ms": 4.74, "learn_throughput": 75954.337, "synch_weights_time_ms": 0.547}, "counters": {"num_env_steps_sampled": 96840, "num_env_steps_trained": 96840, "num_agent_steps_sampled": 96840, "num_agent_steps_trained": 96840}, "done": false, "episodes_total": 269, "training_iteration": 54, "trial_id": "4935e_00000", "date": "2023-07-25_15-56-41", "timestamp": 1690289801, "time_this_iter_s": 11.2971830368042, "time_total_s": 602.7047913074493, "pid": 67353, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[0, 0.003], [5400, 0.001], [10800, 0.00075], [16200, 0.0005], [21600, 0.00025], [27000, 0.0001], [32400, 7.5e-05], [37800, 5e-05], [43200, 2.5e-05], [48600, 1e-05], [54000, 7.5e-06], [59400, 5e-06], [64800, 2.5e-06], [70200, 1e-06], [75600, 5e-07], [81000, 1e-07]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x177531310>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 602.7047913074493, "iterations_since_restore": 54, "perf": {"cpu_util_percent": 26.125, "ram_util_percent": 78.74375}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-07, "entropy_coeff": 0.10000000000000002, "policy_entropy": -1859.8601888020833, "policy_loss": -1136767991808.0, "vf_loss": 2504374272.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 120.0, "num_grad_updates_lifetime": 821.0, "diff_num_grad_updates_vs_sampler_policy": 820.0}}, "num_env_steps_sampled": 98640, "num_env_steps_trained": 98640, "num_agent_steps_sampled": 98640, "num_agent_steps_trained": 98640}, "sampler_results": {"episode_reward_max": -29493.622950342055, "episode_reward_min": -30289.079314542912, "episode_reward_mean": -29886.316473692645, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-29724.936695805318, -29837.831322222362, -29958.293524780096, -29585.311827919053, -29816.02392927729, -29695.265333660434, -29852.20611686021, -30018.171670373737, -29875.327304266277, -29851.294274613432, -29756.35552602704, -29692.812524018445, -29910.092514829263, -30110.1876900806, -29875.740454341816, -29984.19355397358, -29858.82987325074, -29871.259264531935, -30131.13362484784, -30075.987070417603, -29833.424221843467, -30013.58085180937, -30105.616752690992, -30124.00592166468, -29728.40926564023, -29727.02008502632, -29849.55095524363, -29686.043412542873, -30076.11415840042, -29493.622950342055, -29999.940953204612, -29927.552167962298, -30034.237481121414, -29940.106997576408, -29851.598466892006, -29851.17816675025, -29758.31571960719, -29698.70096416914, -29752.33836249519, -29724.520520881266, -29828.47634821921, -29912.34275767336, -29738.78365407845, -29581.156238000196, -29782.646647494497, -29534.140652548722, -29954.82094612775, -29678.508092159133, -29753.41040762024, -30074.188370303957, -29813.00050972671, -30009.122726198522, -29785.933695821175, -29676.234010301047, -29823.370203113936, -30043.81083780306, -29959.476595282806, -30118.200268327324, -29886.69951357799, -30059.39787629178, -29859.246272981756, -29865.168614678318, -30006.781781675334, -30289.079314542912, -29746.593208358234, -29895.261504209688, -29845.61078481126, -29991.366086599584, -29933.65605863185, -30190.95108830336, -30023.581809845524, -30159.735297225863, -29907.91758061034, -29942.070068756948, -29693.63520917123, -29812.873974677997, -29907.89440624365, -29810.298594569467, -29918.551763915988, -30027.357654211384, -29778.1883225291, -29980.16289108057, -29924.491264451637, -29914.166874096354, -29893.576942417283, -29913.08623008574, -30279.299033279745, -29882.02203689561, -29909.89398011046, -29921.702053421035, -29834.9640053065, -29769.254348493607, -29820.60178498895, -29659.48732552499, -30021.4878991273, -29956.863566987584, -29749.27073272009, -29878.241387697926, -30063.430100590835, -29982.972692807583], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.400949551764086, "mean_inference_ms": 0.24995827893104214, "mean_action_processing_ms": 0.05894690770326054, "mean_env_wait_ms": 1.4827096681567116, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0024766921997070312, "StateBufferConnector_ms": 0.0017733573913574219, "ViewRequirementAgentConnector_ms": 0.044419288635253906}}, "episode_reward_max": -29493.622950342055, "episode_reward_min": -30289.079314542912, "episode_reward_mean": -29886.316473692645, "episode_len_mean": 360.0, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-29724.936695805318, -29837.831322222362, -29958.293524780096, -29585.311827919053, -29816.02392927729, -29695.265333660434, -29852.20611686021, -30018.171670373737, -29875.327304266277, -29851.294274613432, -29756.35552602704, -29692.812524018445, -29910.092514829263, -30110.1876900806, -29875.740454341816, -29984.19355397358, -29858.82987325074, -29871.259264531935, -30131.13362484784, -30075.987070417603, -29833.424221843467, -30013.58085180937, -30105.616752690992, -30124.00592166468, -29728.40926564023, -29727.02008502632, -29849.55095524363, -29686.043412542873, -30076.11415840042, -29493.622950342055, -29999.940953204612, -29927.552167962298, -30034.237481121414, -29940.106997576408, -29851.598466892006, -29851.17816675025, -29758.31571960719, -29698.70096416914, -29752.33836249519, -29724.520520881266, -29828.47634821921, -29912.34275767336, -29738.78365407845, -29581.156238000196, -29782.646647494497, -29534.140652548722, -29954.82094612775, -29678.508092159133, -29753.41040762024, -30074.188370303957, -29813.00050972671, -30009.122726198522, -29785.933695821175, -29676.234010301047, -29823.370203113936, -30043.81083780306, -29959.476595282806, -30118.200268327324, -29886.69951357799, -30059.39787629178, -29859.246272981756, -29865.168614678318, -30006.781781675334, -30289.079314542912, -29746.593208358234, -29895.261504209688, -29845.61078481126, -29991.366086599584, -29933.65605863185, -30190.95108830336, -30023.581809845524, -30159.735297225863, -29907.91758061034, -29942.070068756948, -29693.63520917123, -29812.873974677997, -29907.89440624365, -29810.298594569467, -29918.551763915988, -30027.357654211384, -29778.1883225291, -29980.16289108057, -29924.491264451637, -29914.166874096354, -29893.576942417283, -29913.08623008574, -30279.299033279745, -29882.02203689561, -29909.89398011046, -29921.702053421035, -29834.9640053065, -29769.254348493607, -29820.60178498895, -29659.48732552499, -30021.4878991273, -29956.863566987584, -29749.27073272009, -29878.241387697926, -30063.430100590835, -29982.972692807583], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.400949551764086, "mean_inference_ms": 0.24995827893104214, "mean_action_processing_ms": 0.05894690770326054, "mean_env_wait_ms": 1.4827096681567116, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0024766921997070312, "StateBufferConnector_ms": 0.0017733573913574219, "ViewRequirementAgentConnector_ms": 0.044419288635253906}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 98640, "num_agent_steps_trained": 98640, "num_env_steps_sampled": 98640, "num_env_steps_trained": 98640, "num_env_steps_sampled_this_iter": 1800, "num_env_steps_trained_this_iter": 1800, "num_env_steps_sampled_throughput_per_sec": 162.73207988218405, "num_env_steps_trained_throughput_per_sec": 162.73207988218405, "timesteps_total": 98640, "num_steps_trained_this_iter": 1800, "agent_timesteps_total": 98640, "timers": {"training_iteration_time_ms": 2235.602, "sample_time_ms": 2230.187, "load_time_ms": 0.217, "load_throughput": 1660927.775, "learn_time_ms": 4.629, "learn_throughput": 77773.514, "synch_weights_time_ms": 0.537}, "counters": {"num_env_steps_sampled": 98640, "num_env_steps_trained": 98640, "num_agent_steps_sampled": 98640, "num_agent_steps_trained": 98640}, "done": false, "episodes_total": 274, "training_iteration": 55, "trial_id": "4935e_00000", "date": "2023-07-25_15-56-52", "timestamp": 1690289812, "time_this_iter_s": 11.063190698623657, "time_total_s": 613.767982006073, "pid": 67353, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[0, 0.003], [5400, 0.001], [10800, 0.00075], [16200, 0.0005], [21600, 0.00025], [27000, 0.0001], [32400, 7.5e-05], [37800, 5e-05], [43200, 2.5e-05], [48600, 1e-05], [54000, 7.5e-06], [59400, 5e-06], [64800, 2.5e-06], [70200, 1e-06], [75600, 5e-07], [81000, 1e-07]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x177531310>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 613.767982006073, "iterations_since_restore": 55, "perf": {"cpu_util_percent": 24.10625, "ram_util_percent": 78.225}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-07, "entropy_coeff": 0.10000000000000002, "policy_entropy": -1859.8601481119792, "policy_loss": -2170358022144.0, "vf_loss": 2523161002.6666665}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 120.0, "num_grad_updates_lifetime": 836.0, "diff_num_grad_updates_vs_sampler_policy": 835.0}}, "num_env_steps_sampled": 100440, "num_env_steps_trained": 100440, "num_agent_steps_sampled": 100440, "num_agent_steps_trained": 100440}, "sampler_results": {"episode_reward_max": -29493.622950342055, "episode_reward_min": -30289.079314542912, "episode_reward_mean": -29895.140122928362, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-29695.265333660434, -29852.20611686021, -30018.171670373737, -29875.327304266277, -29851.294274613432, -29756.35552602704, -29692.812524018445, -29910.092514829263, -30110.1876900806, -29875.740454341816, -29984.19355397358, -29858.82987325074, -29871.259264531935, -30131.13362484784, -30075.987070417603, -29833.424221843467, -30013.58085180937, -30105.616752690992, -30124.00592166468, -29728.40926564023, -29727.02008502632, -29849.55095524363, -29686.043412542873, -30076.11415840042, -29493.622950342055, -29999.940953204612, -29927.552167962298, -30034.237481121414, -29940.106997576408, -29851.598466892006, -29851.17816675025, -29758.31571960719, -29698.70096416914, -29752.33836249519, -29724.520520881266, -29828.47634821921, -29912.34275767336, -29738.78365407845, -29581.156238000196, -29782.646647494497, -29534.140652548722, -29954.82094612775, -29678.508092159133, -29753.41040762024, -30074.188370303957, -29813.00050972671, -30009.122726198522, -29785.933695821175, -29676.234010301047, -29823.370203113936, -30043.81083780306, -29959.476595282806, -30118.200268327324, -29886.69951357799, -30059.39787629178, -29859.246272981756, -29865.168614678318, -30006.781781675334, -30289.079314542912, -29746.593208358234, -29895.261504209688, -29845.61078481126, -29991.366086599584, -29933.65605863185, -30190.95108830336, -30023.581809845524, -30159.735297225863, -29907.91758061034, -29942.070068756948, -29693.63520917123, -29812.873974677997, -29907.89440624365, -29810.298594569467, -29918.551763915988, -30027.357654211384, -29778.1883225291, -29980.16289108057, -29924.491264451637, -29914.166874096354, -29893.576942417283, -29913.08623008574, -30279.299033279745, -29882.02203689561, -29909.89398011046, -29921.702053421035, -29834.9640053065, -29769.254348493607, -29820.60178498895, -29659.48732552499, -30021.4878991273, -29956.863566987584, -29749.27073272009, -29878.241387697926, -30063.430100590835, -29982.972692807583, -30011.25451141636, -29796.36636034372, -30001.965895035664, -29859.151104067558, -30136.024352712873], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.400830376434154, "mean_inference_ms": 0.24994474816174508, "mean_action_processing_ms": 0.05894623732620312, "mean_env_wait_ms": 1.4820321701216586, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002498149871826172, "StateBufferConnector_ms": 0.0017778873443603516, "ViewRequirementAgentConnector_ms": 0.04450631141662598}}, "episode_reward_max": -29493.622950342055, "episode_reward_min": -30289.079314542912, "episode_reward_mean": -29895.140122928362, "episode_len_mean": 360.0, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-29695.265333660434, -29852.20611686021, -30018.171670373737, -29875.327304266277, -29851.294274613432, -29756.35552602704, -29692.812524018445, -29910.092514829263, -30110.1876900806, -29875.740454341816, -29984.19355397358, -29858.82987325074, -29871.259264531935, -30131.13362484784, -30075.987070417603, -29833.424221843467, -30013.58085180937, -30105.616752690992, -30124.00592166468, -29728.40926564023, -29727.02008502632, -29849.55095524363, -29686.043412542873, -30076.11415840042, -29493.622950342055, -29999.940953204612, -29927.552167962298, -30034.237481121414, -29940.106997576408, -29851.598466892006, -29851.17816675025, -29758.31571960719, -29698.70096416914, -29752.33836249519, -29724.520520881266, -29828.47634821921, -29912.34275767336, -29738.78365407845, -29581.156238000196, -29782.646647494497, -29534.140652548722, -29954.82094612775, -29678.508092159133, -29753.41040762024, -30074.188370303957, -29813.00050972671, -30009.122726198522, -29785.933695821175, -29676.234010301047, -29823.370203113936, -30043.81083780306, -29959.476595282806, -30118.200268327324, -29886.69951357799, -30059.39787629178, -29859.246272981756, -29865.168614678318, -30006.781781675334, -30289.079314542912, -29746.593208358234, -29895.261504209688, -29845.61078481126, -29991.366086599584, -29933.65605863185, -30190.95108830336, -30023.581809845524, -30159.735297225863, -29907.91758061034, -29942.070068756948, -29693.63520917123, -29812.873974677997, -29907.89440624365, -29810.298594569467, -29918.551763915988, -30027.357654211384, -29778.1883225291, -29980.16289108057, -29924.491264451637, -29914.166874096354, -29893.576942417283, -29913.08623008574, -30279.299033279745, -29882.02203689561, -29909.89398011046, -29921.702053421035, -29834.9640053065, -29769.254348493607, -29820.60178498895, -29659.48732552499, -30021.4878991273, -29956.863566987584, -29749.27073272009, -29878.241387697926, -30063.430100590835, -29982.972692807583, -30011.25451141636, -29796.36636034372, -30001.965895035664, -29859.151104067558, -30136.024352712873], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.400830376434154, "mean_inference_ms": 0.24994474816174508, "mean_action_processing_ms": 0.05894623732620312, "mean_env_wait_ms": 1.4820321701216586, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002498149871826172, "StateBufferConnector_ms": 0.0017778873443603516, "ViewRequirementAgentConnector_ms": 0.04450631141662598}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 100440, "num_agent_steps_trained": 100440, "num_env_steps_sampled": 100440, "num_env_steps_trained": 100440, "num_env_steps_sampled_this_iter": 1800, "num_env_steps_trained_this_iter": 1800, "num_env_steps_sampled_throughput_per_sec": 160.827914440519, "num_env_steps_trained_throughput_per_sec": 160.827914440519, "timesteps_total": 100440, "num_steps_trained_this_iter": 1800, "agent_timesteps_total": 100440, "timers": {"training_iteration_time_ms": 2225.311, "sample_time_ms": 2219.91, "load_time_ms": 0.215, "load_throughput": 1676976.277, "learn_time_ms": 4.621, "learn_throughput": 77909.15, "synch_weights_time_ms": 0.534}, "counters": {"num_env_steps_sampled": 100440, "num_env_steps_trained": 100440, "num_agent_steps_sampled": 100440, "num_agent_steps_trained": 100440}, "done": false, "episodes_total": 279, "training_iteration": 56, "trial_id": "4935e_00000", "date": "2023-07-25_15-57-04", "timestamp": 1690289824, "time_this_iter_s": 11.194246053695679, "time_total_s": 624.9622280597687, "pid": 67353, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[0, 0.003], [5400, 0.001], [10800, 0.00075], [16200, 0.0005], [21600, 0.00025], [27000, 0.0001], [32400, 7.5e-05], [37800, 5e-05], [43200, 2.5e-05], [48600, 1e-05], [54000, 7.5e-06], [59400, 5e-06], [64800, 2.5e-06], [70200, 1e-06], [75600, 5e-07], [81000, 1e-07]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x177531310>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 624.9622280597687, "iterations_since_restore": 56, "perf": {"cpu_util_percent": 24.25625, "ram_util_percent": 78.7125}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-07, "entropy_coeff": 0.10000000000000002, "policy_entropy": -1859.8602294921875, "policy_loss": -4718624426325.333, "vf_loss": 2488700778.6666665}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 120.0, "num_grad_updates_lifetime": 851.0, "diff_num_grad_updates_vs_sampler_policy": 850.0}}, "num_env_steps_sampled": 102240, "num_env_steps_trained": 102240, "num_agent_steps_sampled": 102240, "num_agent_steps_trained": 102240}, "sampler_results": {"episode_reward_max": -29493.622950342055, "episode_reward_min": -30289.079314542912, "episode_reward_mean": -29900.586815233357, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-29756.35552602704, -29692.812524018445, -29910.092514829263, -30110.1876900806, -29875.740454341816, -29984.19355397358, -29858.82987325074, -29871.259264531935, -30131.13362484784, -30075.987070417603, -29833.424221843467, -30013.58085180937, -30105.616752690992, -30124.00592166468, -29728.40926564023, -29727.02008502632, -29849.55095524363, -29686.043412542873, -30076.11415840042, -29493.622950342055, -29999.940953204612, -29927.552167962298, -30034.237481121414, -29940.106997576408, -29851.598466892006, -29851.17816675025, -29758.31571960719, -29698.70096416914, -29752.33836249519, -29724.520520881266, -29828.47634821921, -29912.34275767336, -29738.78365407845, -29581.156238000196, -29782.646647494497, -29534.140652548722, -29954.82094612775, -29678.508092159133, -29753.41040762024, -30074.188370303957, -29813.00050972671, -30009.122726198522, -29785.933695821175, -29676.234010301047, -29823.370203113936, -30043.81083780306, -29959.476595282806, -30118.200268327324, -29886.69951357799, -30059.39787629178, -29859.246272981756, -29865.168614678318, -30006.781781675334, -30289.079314542912, -29746.593208358234, -29895.261504209688, -29845.61078481126, -29991.366086599584, -29933.65605863185, -30190.95108830336, -30023.581809845524, -30159.735297225863, -29907.91758061034, -29942.070068756948, -29693.63520917123, -29812.873974677997, -29907.89440624365, -29810.298594569467, -29918.551763915988, -30027.357654211384, -29778.1883225291, -29980.16289108057, -29924.491264451637, -29914.166874096354, -29893.576942417283, -29913.08623008574, -30279.299033279745, -29882.02203689561, -29909.89398011046, -29921.702053421035, -29834.9640053065, -29769.254348493607, -29820.60178498895, -29659.48732552499, -30021.4878991273, -29956.863566987584, -29749.27073272009, -29878.241387697926, -30063.430100590835, -29982.972692807583, -30011.25451141636, -29796.36636034372, -30001.965895035664, -29859.151104067558, -30136.024352712873, -30125.045845889104, -29925.146990008343, -29807.883216179467, -30049.684736767475, -29929.17314142955], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.400737822563317, "mean_inference_ms": 0.24993448964753878, "mean_action_processing_ms": 0.058946229913273376, "mean_env_wait_ms": 1.4814040153513182, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0025081634521484375, "StateBufferConnector_ms": 0.0017876625061035156, "ViewRequirementAgentConnector_ms": 0.04475522041320801}}, "episode_reward_max": -29493.622950342055, "episode_reward_min": -30289.079314542912, "episode_reward_mean": -29900.586815233357, "episode_len_mean": 360.0, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-29756.35552602704, -29692.812524018445, -29910.092514829263, -30110.1876900806, -29875.740454341816, -29984.19355397358, -29858.82987325074, -29871.259264531935, -30131.13362484784, -30075.987070417603, -29833.424221843467, -30013.58085180937, -30105.616752690992, -30124.00592166468, -29728.40926564023, -29727.02008502632, -29849.55095524363, -29686.043412542873, -30076.11415840042, -29493.622950342055, -29999.940953204612, -29927.552167962298, -30034.237481121414, -29940.106997576408, -29851.598466892006, -29851.17816675025, -29758.31571960719, -29698.70096416914, -29752.33836249519, -29724.520520881266, -29828.47634821921, -29912.34275767336, -29738.78365407845, -29581.156238000196, -29782.646647494497, -29534.140652548722, -29954.82094612775, -29678.508092159133, -29753.41040762024, -30074.188370303957, -29813.00050972671, -30009.122726198522, -29785.933695821175, -29676.234010301047, -29823.370203113936, -30043.81083780306, -29959.476595282806, -30118.200268327324, -29886.69951357799, -30059.39787629178, -29859.246272981756, -29865.168614678318, -30006.781781675334, -30289.079314542912, -29746.593208358234, -29895.261504209688, -29845.61078481126, -29991.366086599584, -29933.65605863185, -30190.95108830336, -30023.581809845524, -30159.735297225863, -29907.91758061034, -29942.070068756948, -29693.63520917123, -29812.873974677997, -29907.89440624365, -29810.298594569467, -29918.551763915988, -30027.357654211384, -29778.1883225291, -29980.16289108057, -29924.491264451637, -29914.166874096354, -29893.576942417283, -29913.08623008574, -30279.299033279745, -29882.02203689561, -29909.89398011046, -29921.702053421035, -29834.9640053065, -29769.254348493607, -29820.60178498895, -29659.48732552499, -30021.4878991273, -29956.863566987584, -29749.27073272009, -29878.241387697926, -30063.430100590835, -29982.972692807583, -30011.25451141636, -29796.36636034372, -30001.965895035664, -29859.151104067558, -30136.024352712873, -30125.045845889104, -29925.146990008343, -29807.883216179467, -30049.684736767475, -29929.17314142955], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.400737822563317, "mean_inference_ms": 0.24993448964753878, "mean_action_processing_ms": 0.058946229913273376, "mean_env_wait_ms": 1.4814040153513182, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0025081634521484375, "StateBufferConnector_ms": 0.0017876625061035156, "ViewRequirementAgentConnector_ms": 0.04475522041320801}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 102240, "num_agent_steps_trained": 102240, "num_env_steps_sampled": 102240, "num_env_steps_trained": 102240, "num_env_steps_sampled_this_iter": 1800, "num_env_steps_trained_this_iter": 1800, "num_env_steps_sampled_throughput_per_sec": 160.7950279064323, "num_env_steps_trained_throughput_per_sec": 160.7950279064323, "timesteps_total": 102240, "num_steps_trained_this_iter": 1800, "agent_timesteps_total": 102240, "timers": {"training_iteration_time_ms": 2238.637, "sample_time_ms": 2233.23, "load_time_ms": 0.214, "load_throughput": 1684647.373, "learn_time_ms": 4.622, "learn_throughput": 77881.824, "synch_weights_time_ms": 0.538}, "counters": {"num_env_steps_sampled": 102240, "num_env_steps_trained": 102240, "num_agent_steps_sampled": 102240, "num_agent_steps_trained": 102240}, "done": false, "episodes_total": 284, "training_iteration": 57, "trial_id": "4935e_00000", "date": "2023-07-25_15-57-15", "timestamp": 1690289835, "time_this_iter_s": 11.196791887283325, "time_total_s": 636.159019947052, "pid": 67353, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[0, 0.003], [5400, 0.001], [10800, 0.00075], [16200, 0.0005], [21600, 0.00025], [27000, 0.0001], [32400, 7.5e-05], [37800, 5e-05], [43200, 2.5e-05], [48600, 1e-05], [54000, 7.5e-06], [59400, 5e-06], [64800, 2.5e-06], [70200, 1e-06], [75600, 5e-07], [81000, 1e-07]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x177531310>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 636.159019947052, "iterations_since_restore": 57, "perf": {"cpu_util_percent": 23.668750000000003, "ram_util_percent": 78.5875}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-07, "entropy_coeff": 0.10000000000000002, "policy_entropy": -1859.8604329427083, "policy_loss": -2187941448362.6667, "vf_loss": 2456078698.6666665}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 120.0, "num_grad_updates_lifetime": 866.0, "diff_num_grad_updates_vs_sampler_policy": 865.0}}, "num_env_steps_sampled": 104040, "num_env_steps_trained": 104040, "num_agent_steps_sampled": 104040, "num_agent_steps_trained": 104040}, "sampler_results": {"episode_reward_max": -29493.622950342055, "episode_reward_min": -30289.079314542912, "episode_reward_mean": -29900.273653221157, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-29984.19355397358, -29858.82987325074, -29871.259264531935, -30131.13362484784, -30075.987070417603, -29833.424221843467, -30013.58085180937, -30105.616752690992, -30124.00592166468, -29728.40926564023, -29727.02008502632, -29849.55095524363, -29686.043412542873, -30076.11415840042, -29493.622950342055, -29999.940953204612, -29927.552167962298, -30034.237481121414, -29940.106997576408, -29851.598466892006, -29851.17816675025, -29758.31571960719, -29698.70096416914, -29752.33836249519, -29724.520520881266, -29828.47634821921, -29912.34275767336, -29738.78365407845, -29581.156238000196, -29782.646647494497, -29534.140652548722, -29954.82094612775, -29678.508092159133, -29753.41040762024, -30074.188370303957, -29813.00050972671, -30009.122726198522, -29785.933695821175, -29676.234010301047, -29823.370203113936, -30043.81083780306, -29959.476595282806, -30118.200268327324, -29886.69951357799, -30059.39787629178, -29859.246272981756, -29865.168614678318, -30006.781781675334, -30289.079314542912, -29746.593208358234, -29895.261504209688, -29845.61078481126, -29991.366086599584, -29933.65605863185, -30190.95108830336, -30023.581809845524, -30159.735297225863, -29907.91758061034, -29942.070068756948, -29693.63520917123, -29812.873974677997, -29907.89440624365, -29810.298594569467, -29918.551763915988, -30027.357654211384, -29778.1883225291, -29980.16289108057, -29924.491264451637, -29914.166874096354, -29893.576942417283, -29913.08623008574, -30279.299033279745, -29882.02203689561, -29909.89398011046, -29921.702053421035, -29834.9640053065, -29769.254348493607, -29820.60178498895, -29659.48732552499, -30021.4878991273, -29956.863566987584, -29749.27073272009, -29878.241387697926, -30063.430100590835, -29982.972692807583, -30011.25451141636, -29796.36636034372, -30001.965895035664, -29859.151104067558, -30136.024352712873, -30125.045845889104, -29925.146990008343, -29807.883216179467, -30049.684736767475, -29929.17314142955, -29975.45568071386, -29858.83328117909, -29977.68922812979, -29832.09875319912, -29669.795564855514], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.400666579692645, "mean_inference_ms": 0.24992135030807872, "mean_action_processing_ms": 0.058945983925422565, "mean_env_wait_ms": 1.4807792723947892, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0025103092193603516, "StateBufferConnector_ms": 0.0017790794372558594, "ViewRequirementAgentConnector_ms": 0.04473304748535156}}, "episode_reward_max": -29493.622950342055, "episode_reward_min": -30289.079314542912, "episode_reward_mean": -29900.273653221157, "episode_len_mean": 360.0, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-29984.19355397358, -29858.82987325074, -29871.259264531935, -30131.13362484784, -30075.987070417603, -29833.424221843467, -30013.58085180937, -30105.616752690992, -30124.00592166468, -29728.40926564023, -29727.02008502632, -29849.55095524363, -29686.043412542873, -30076.11415840042, -29493.622950342055, -29999.940953204612, -29927.552167962298, -30034.237481121414, -29940.106997576408, -29851.598466892006, -29851.17816675025, -29758.31571960719, -29698.70096416914, -29752.33836249519, -29724.520520881266, -29828.47634821921, -29912.34275767336, -29738.78365407845, -29581.156238000196, -29782.646647494497, -29534.140652548722, -29954.82094612775, -29678.508092159133, -29753.41040762024, -30074.188370303957, -29813.00050972671, -30009.122726198522, -29785.933695821175, -29676.234010301047, -29823.370203113936, -30043.81083780306, -29959.476595282806, -30118.200268327324, -29886.69951357799, -30059.39787629178, -29859.246272981756, -29865.168614678318, -30006.781781675334, -30289.079314542912, -29746.593208358234, -29895.261504209688, -29845.61078481126, -29991.366086599584, -29933.65605863185, -30190.95108830336, -30023.581809845524, -30159.735297225863, -29907.91758061034, -29942.070068756948, -29693.63520917123, -29812.873974677997, -29907.89440624365, -29810.298594569467, -29918.551763915988, -30027.357654211384, -29778.1883225291, -29980.16289108057, -29924.491264451637, -29914.166874096354, -29893.576942417283, -29913.08623008574, -30279.299033279745, -29882.02203689561, -29909.89398011046, -29921.702053421035, -29834.9640053065, -29769.254348493607, -29820.60178498895, -29659.48732552499, -30021.4878991273, -29956.863566987584, -29749.27073272009, -29878.241387697926, -30063.430100590835, -29982.972692807583, -30011.25451141636, -29796.36636034372, -30001.965895035664, -29859.151104067558, -30136.024352712873, -30125.045845889104, -29925.146990008343, -29807.883216179467, -30049.684736767475, -29929.17314142955, -29975.45568071386, -29858.83328117909, -29977.68922812979, -29832.09875319912, -29669.795564855514], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.400666579692645, "mean_inference_ms": 0.24992135030807872, "mean_action_processing_ms": 0.058945983925422565, "mean_env_wait_ms": 1.4807792723947892, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0025103092193603516, "StateBufferConnector_ms": 0.0017790794372558594, "ViewRequirementAgentConnector_ms": 0.04473304748535156}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 104040, "num_agent_steps_trained": 104040, "num_env_steps_sampled": 104040, "num_env_steps_trained": 104040, "num_env_steps_sampled_this_iter": 1800, "num_env_steps_trained_this_iter": 1800, "num_env_steps_sampled_throughput_per_sec": 162.108374386775, "num_env_steps_trained_throughput_per_sec": 162.108374386775, "timesteps_total": 104040, "num_steps_trained_this_iter": 1800, "agent_timesteps_total": 104040, "timers": {"training_iteration_time_ms": 2229.796, "sample_time_ms": 2224.388, "load_time_ms": 0.22, "load_throughput": 1636092.144, "learn_time_ms": 4.63, "learn_throughput": 77758.695, "synch_weights_time_ms": 0.525}, "counters": {"num_env_steps_sampled": 104040, "num_env_steps_trained": 104040, "num_agent_steps_sampled": 104040, "num_agent_steps_trained": 104040}, "done": false, "episodes_total": 289, "training_iteration": 58, "trial_id": "4935e_00000", "date": "2023-07-25_15-57-26", "timestamp": 1690289846, "time_this_iter_s": 11.105767965316772, "time_total_s": 647.2647879123688, "pid": 67353, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[0, 0.003], [5400, 0.001], [10800, 0.00075], [16200, 0.0005], [21600, 0.00025], [27000, 0.0001], [32400, 7.5e-05], [37800, 5e-05], [43200, 2.5e-05], [48600, 1e-05], [54000, 7.5e-06], [59400, 5e-06], [64800, 2.5e-06], [70200, 1e-06], [75600, 5e-07], [81000, 1e-07]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x177531310>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 647.2647879123688, "iterations_since_restore": 58, "perf": {"cpu_util_percent": 22.506666666666668, "ram_util_percent": 78.56666666666665}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-07, "entropy_coeff": 0.10000000000000002, "policy_entropy": -1859.8603515625, "policy_loss": -4193511555072.0, "vf_loss": 2475223850.6666665}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 120.0, "num_grad_updates_lifetime": 881.0, "diff_num_grad_updates_vs_sampler_policy": 880.0}}, "num_env_steps_sampled": 105840, "num_env_steps_trained": 105840, "num_agent_steps_sampled": 105840, "num_agent_steps_trained": 105840}, "sampler_results": {"episode_reward_max": -29493.622950342055, "episode_reward_min": -30289.079314542912, "episode_reward_mean": -29895.555451501732, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-29833.424221843467, -30013.58085180937, -30105.616752690992, -30124.00592166468, -29728.40926564023, -29727.02008502632, -29849.55095524363, -29686.043412542873, -30076.11415840042, -29493.622950342055, -29999.940953204612, -29927.552167962298, -30034.237481121414, -29940.106997576408, -29851.598466892006, -29851.17816675025, -29758.31571960719, -29698.70096416914, -29752.33836249519, -29724.520520881266, -29828.47634821921, -29912.34275767336, -29738.78365407845, -29581.156238000196, -29782.646647494497, -29534.140652548722, -29954.82094612775, -29678.508092159133, -29753.41040762024, -30074.188370303957, -29813.00050972671, -30009.122726198522, -29785.933695821175, -29676.234010301047, -29823.370203113936, -30043.81083780306, -29959.476595282806, -30118.200268327324, -29886.69951357799, -30059.39787629178, -29859.246272981756, -29865.168614678318, -30006.781781675334, -30289.079314542912, -29746.593208358234, -29895.261504209688, -29845.61078481126, -29991.366086599584, -29933.65605863185, -30190.95108830336, -30023.581809845524, -30159.735297225863, -29907.91758061034, -29942.070068756948, -29693.63520917123, -29812.873974677997, -29907.89440624365, -29810.298594569467, -29918.551763915988, -30027.357654211384, -29778.1883225291, -29980.16289108057, -29924.491264451637, -29914.166874096354, -29893.576942417283, -29913.08623008574, -30279.299033279745, -29882.02203689561, -29909.89398011046, -29921.702053421035, -29834.9640053065, -29769.254348493607, -29820.60178498895, -29659.48732552499, -30021.4878991273, -29956.863566987584, -29749.27073272009, -29878.241387697926, -30063.430100590835, -29982.972692807583, -30011.25451141636, -29796.36636034372, -30001.965895035664, -29859.151104067558, -30136.024352712873, -30125.045845889104, -29925.146990008343, -29807.883216179467, -30049.684736767475, -29929.17314142955, -29975.45568071386, -29858.83328117909, -29977.68922812979, -29832.09875319912, -29669.795564855514, -29875.44341170331, -29998.48427884018, -29844.59518535603, -29913.48692848351, -29817.573410696103], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.400615959893668, "mean_inference_ms": 0.24991237036623823, "mean_action_processing_ms": 0.05894596950736046, "mean_env_wait_ms": 1.4802071472023908, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0025081634521484375, "StateBufferConnector_ms": 0.0017769336700439453, "ViewRequirementAgentConnector_ms": 0.0447697639465332}}, "episode_reward_max": -29493.622950342055, "episode_reward_min": -30289.079314542912, "episode_reward_mean": -29895.555451501732, "episode_len_mean": 360.0, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-29833.424221843467, -30013.58085180937, -30105.616752690992, -30124.00592166468, -29728.40926564023, -29727.02008502632, -29849.55095524363, -29686.043412542873, -30076.11415840042, -29493.622950342055, -29999.940953204612, -29927.552167962298, -30034.237481121414, -29940.106997576408, -29851.598466892006, -29851.17816675025, -29758.31571960719, -29698.70096416914, -29752.33836249519, -29724.520520881266, -29828.47634821921, -29912.34275767336, -29738.78365407845, -29581.156238000196, -29782.646647494497, -29534.140652548722, -29954.82094612775, -29678.508092159133, -29753.41040762024, -30074.188370303957, -29813.00050972671, -30009.122726198522, -29785.933695821175, -29676.234010301047, -29823.370203113936, -30043.81083780306, -29959.476595282806, -30118.200268327324, -29886.69951357799, -30059.39787629178, -29859.246272981756, -29865.168614678318, -30006.781781675334, -30289.079314542912, -29746.593208358234, -29895.261504209688, -29845.61078481126, -29991.366086599584, -29933.65605863185, -30190.95108830336, -30023.581809845524, -30159.735297225863, -29907.91758061034, -29942.070068756948, -29693.63520917123, -29812.873974677997, -29907.89440624365, -29810.298594569467, -29918.551763915988, -30027.357654211384, -29778.1883225291, -29980.16289108057, -29924.491264451637, -29914.166874096354, -29893.576942417283, -29913.08623008574, -30279.299033279745, -29882.02203689561, -29909.89398011046, -29921.702053421035, -29834.9640053065, -29769.254348493607, -29820.60178498895, -29659.48732552499, -30021.4878991273, -29956.863566987584, -29749.27073272009, -29878.241387697926, -30063.430100590835, -29982.972692807583, -30011.25451141636, -29796.36636034372, -30001.965895035664, -29859.151104067558, -30136.024352712873, -30125.045845889104, -29925.146990008343, -29807.883216179467, -30049.684736767475, -29929.17314142955, -29975.45568071386, -29858.83328117909, -29977.68922812979, -29832.09875319912, -29669.795564855514, -29875.44341170331, -29998.48427884018, -29844.59518535603, -29913.48692848351, -29817.573410696103], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.400615959893668, "mean_inference_ms": 0.24991237036623823, "mean_action_processing_ms": 0.05894596950736046, "mean_env_wait_ms": 1.4802071472023908, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0025081634521484375, "StateBufferConnector_ms": 0.0017769336700439453, "ViewRequirementAgentConnector_ms": 0.0447697639465332}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 105840, "num_agent_steps_trained": 105840, "num_env_steps_sampled": 105840, "num_env_steps_trained": 105840, "num_env_steps_sampled_this_iter": 1800, "num_env_steps_trained_this_iter": 1800, "num_env_steps_sampled_throughput_per_sec": 161.4249282345951, "num_env_steps_trained_throughput_per_sec": 161.4249282345951, "timesteps_total": 105840, "num_steps_trained_this_iter": 1800, "agent_timesteps_total": 105840, "timers": {"training_iteration_time_ms": 2225.428, "sample_time_ms": 2220.005, "load_time_ms": 0.223, "load_throughput": 1613711.061, "learn_time_ms": 4.655, "learn_throughput": 77340.892, "synch_weights_time_ms": 0.512}, "counters": {"num_env_steps_sampled": 105840, "num_env_steps_trained": 105840, "num_agent_steps_sampled": 105840, "num_agent_steps_trained": 105840}, "done": false, "episodes_total": 294, "training_iteration": 59, "trial_id": "4935e_00000", "date": "2023-07-25_15-57-37", "timestamp": 1690289857, "time_this_iter_s": 11.152788877487183, "time_total_s": 658.417576789856, "pid": 67353, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[0, 0.003], [5400, 0.001], [10800, 0.00075], [16200, 0.0005], [21600, 0.00025], [27000, 0.0001], [32400, 7.5e-05], [37800, 5e-05], [43200, 2.5e-05], [48600, 1e-05], [54000, 7.5e-06], [59400, 5e-06], [64800, 2.5e-06], [70200, 1e-06], [75600, 5e-07], [81000, 1e-07]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x177531310>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 658.417576789856, "iterations_since_restore": 59, "perf": {"cpu_util_percent": 23.025, "ram_util_percent": 78.55}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-07, "entropy_coeff": 0.10000000000000002, "policy_entropy": -1859.8603922526042, "policy_loss": -1081307758592.0, "vf_loss": 2476757312.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 120.0, "num_grad_updates_lifetime": 896.0, "diff_num_grad_updates_vs_sampler_policy": 895.0}}, "num_env_steps_sampled": 107640, "num_env_steps_trained": 107640, "num_agent_steps_sampled": 107640, "num_agent_steps_trained": 107640}, "sampler_results": {"episode_reward_max": -29493.622950342055, "episode_reward_min": -30421.939916595737, "episode_reward_mean": -29897.359516157492, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-29727.02008502632, -29849.55095524363, -29686.043412542873, -30076.11415840042, -29493.622950342055, -29999.940953204612, -29927.552167962298, -30034.237481121414, -29940.106997576408, -29851.598466892006, -29851.17816675025, -29758.31571960719, -29698.70096416914, -29752.33836249519, -29724.520520881266, -29828.47634821921, -29912.34275767336, -29738.78365407845, -29581.156238000196, -29782.646647494497, -29534.140652548722, -29954.82094612775, -29678.508092159133, -29753.41040762024, -30074.188370303957, -29813.00050972671, -30009.122726198522, -29785.933695821175, -29676.234010301047, -29823.370203113936, -30043.81083780306, -29959.476595282806, -30118.200268327324, -29886.69951357799, -30059.39787629178, -29859.246272981756, -29865.168614678318, -30006.781781675334, -30289.079314542912, -29746.593208358234, -29895.261504209688, -29845.61078481126, -29991.366086599584, -29933.65605863185, -30190.95108830336, -30023.581809845524, -30159.735297225863, -29907.91758061034, -29942.070068756948, -29693.63520917123, -29812.873974677997, -29907.89440624365, -29810.298594569467, -29918.551763915988, -30027.357654211384, -29778.1883225291, -29980.16289108057, -29924.491264451637, -29914.166874096354, -29893.576942417283, -29913.08623008574, -30279.299033279745, -29882.02203689561, -29909.89398011046, -29921.702053421035, -29834.9640053065, -29769.254348493607, -29820.60178498895, -29659.48732552499, -30021.4878991273, -29956.863566987584, -29749.27073272009, -29878.241387697926, -30063.430100590835, -29982.972692807583, -30011.25451141636, -29796.36636034372, -30001.965895035664, -29859.151104067558, -30136.024352712873, -30125.045845889104, -29925.146990008343, -29807.883216179467, -30049.684736767475, -29929.17314142955, -29975.45568071386, -29858.83328117909, -29977.68922812979, -29832.09875319912, -29669.795564855514, -29875.44341170331, -29998.48427884018, -29844.59518535603, -29913.48692848351, -29817.573410696103, -29919.96503199338, -30421.939916595737, -29974.20755043081, -29878.59461816494, -29790.736362038933], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.400524104594129, "mean_inference_ms": 0.2498980428213695, "mean_action_processing_ms": 0.05894467094070413, "mean_env_wait_ms": 1.4796393867538453, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0025043487548828125, "StateBufferConnector_ms": 0.0017733573913574219, "ViewRequirementAgentConnector_ms": 0.04478049278259277}}, "episode_reward_max": -29493.622950342055, "episode_reward_min": -30421.939916595737, "episode_reward_mean": -29897.359516157492, "episode_len_mean": 360.0, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-29727.02008502632, -29849.55095524363, -29686.043412542873, -30076.11415840042, -29493.622950342055, -29999.940953204612, -29927.552167962298, -30034.237481121414, -29940.106997576408, -29851.598466892006, -29851.17816675025, -29758.31571960719, -29698.70096416914, -29752.33836249519, -29724.520520881266, -29828.47634821921, -29912.34275767336, -29738.78365407845, -29581.156238000196, -29782.646647494497, -29534.140652548722, -29954.82094612775, -29678.508092159133, -29753.41040762024, -30074.188370303957, -29813.00050972671, -30009.122726198522, -29785.933695821175, -29676.234010301047, -29823.370203113936, -30043.81083780306, -29959.476595282806, -30118.200268327324, -29886.69951357799, -30059.39787629178, -29859.246272981756, -29865.168614678318, -30006.781781675334, -30289.079314542912, -29746.593208358234, -29895.261504209688, -29845.61078481126, -29991.366086599584, -29933.65605863185, -30190.95108830336, -30023.581809845524, -30159.735297225863, -29907.91758061034, -29942.070068756948, -29693.63520917123, -29812.873974677997, -29907.89440624365, -29810.298594569467, -29918.551763915988, -30027.357654211384, -29778.1883225291, -29980.16289108057, -29924.491264451637, -29914.166874096354, -29893.576942417283, -29913.08623008574, -30279.299033279745, -29882.02203689561, -29909.89398011046, -29921.702053421035, -29834.9640053065, -29769.254348493607, -29820.60178498895, -29659.48732552499, -30021.4878991273, -29956.863566987584, -29749.27073272009, -29878.241387697926, -30063.430100590835, -29982.972692807583, -30011.25451141636, -29796.36636034372, -30001.965895035664, -29859.151104067558, -30136.024352712873, -30125.045845889104, -29925.146990008343, -29807.883216179467, -30049.684736767475, -29929.17314142955, -29975.45568071386, -29858.83328117909, -29977.68922812979, -29832.09875319912, -29669.795564855514, -29875.44341170331, -29998.48427884018, -29844.59518535603, -29913.48692848351, -29817.573410696103, -29919.96503199338, -30421.939916595737, -29974.20755043081, -29878.59461816494, -29790.736362038933], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.400524104594129, "mean_inference_ms": 0.2498980428213695, "mean_action_processing_ms": 0.05894467094070413, "mean_env_wait_ms": 1.4796393867538453, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0025043487548828125, "StateBufferConnector_ms": 0.0017733573913574219, "ViewRequirementAgentConnector_ms": 0.04478049278259277}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 107640, "num_agent_steps_trained": 107640, "num_env_steps_sampled": 107640, "num_env_steps_trained": 107640, "num_env_steps_sampled_this_iter": 1800, "num_env_steps_trained_this_iter": 1800, "num_env_steps_sampled_throughput_per_sec": 162.9915842360401, "num_env_steps_trained_throughput_per_sec": 162.9915842360401, "timesteps_total": 107640, "num_steps_trained_this_iter": 1800, "agent_timesteps_total": 107640, "timers": {"training_iteration_time_ms": 2219.411, "sample_time_ms": 2213.972, "load_time_ms": 0.215, "load_throughput": 1672147.774, "learn_time_ms": 4.665, "learn_throughput": 77164.613, "synch_weights_time_ms": 0.525}, "counters": {"num_env_steps_sampled": 107640, "num_env_steps_trained": 107640, "num_agent_steps_sampled": 107640, "num_agent_steps_trained": 107640}, "done": false, "episodes_total": 299, "training_iteration": 60, "trial_id": "4935e_00000", "date": "2023-07-25_15-57-48", "timestamp": 1690289868, "time_this_iter_s": 11.045563220977783, "time_total_s": 669.4631400108337, "pid": 67353, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[0, 0.003], [5400, 0.001], [10800, 0.00075], [16200, 0.0005], [21600, 0.00025], [27000, 0.0001], [32400, 7.5e-05], [37800, 5e-05], [43200, 2.5e-05], [48600, 1e-05], [54000, 7.5e-06], [59400, 5e-06], [64800, 2.5e-06], [70200, 1e-06], [75600, 5e-07], [81000, 1e-07]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x177531310>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 669.4631400108337, "iterations_since_restore": 60, "perf": {"cpu_util_percent": 23.675, "ram_util_percent": 78.36250000000001}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-07, "entropy_coeff": 0.10000000000000002, "policy_entropy": -1859.860107421875, "policy_loss": -897313011029.3334, "vf_loss": 2494421610.6666665}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 120.0, "num_grad_updates_lifetime": 911.0, "diff_num_grad_updates_vs_sampler_policy": 910.0}}, "num_env_steps_sampled": 109440, "num_env_steps_trained": 109440, "num_agent_steps_sampled": 109440, "num_agent_steps_trained": 109440}, "sampler_results": {"episode_reward_max": -29534.140652548722, "episode_reward_min": -30421.939916595737, "episode_reward_mean": -29907.49315728894, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-29999.940953204612, -29927.552167962298, -30034.237481121414, -29940.106997576408, -29851.598466892006, -29851.17816675025, -29758.31571960719, -29698.70096416914, -29752.33836249519, -29724.520520881266, -29828.47634821921, -29912.34275767336, -29738.78365407845, -29581.156238000196, -29782.646647494497, -29534.140652548722, -29954.82094612775, -29678.508092159133, -29753.41040762024, -30074.188370303957, -29813.00050972671, -30009.122726198522, -29785.933695821175, -29676.234010301047, -29823.370203113936, -30043.81083780306, -29959.476595282806, -30118.200268327324, -29886.69951357799, -30059.39787629178, -29859.246272981756, -29865.168614678318, -30006.781781675334, -30289.079314542912, -29746.593208358234, -29895.261504209688, -29845.61078481126, -29991.366086599584, -29933.65605863185, -30190.95108830336, -30023.581809845524, -30159.735297225863, -29907.91758061034, -29942.070068756948, -29693.63520917123, -29812.873974677997, -29907.89440624365, -29810.298594569467, -29918.551763915988, -30027.357654211384, -29778.1883225291, -29980.16289108057, -29924.491264451637, -29914.166874096354, -29893.576942417283, -29913.08623008574, -30279.299033279745, -29882.02203689561, -29909.89398011046, -29921.702053421035, -29834.9640053065, -29769.254348493607, -29820.60178498895, -29659.48732552499, -30021.4878991273, -29956.863566987584, -29749.27073272009, -29878.241387697926, -30063.430100590835, -29982.972692807583, -30011.25451141636, -29796.36636034372, -30001.965895035664, -29859.151104067558, -30136.024352712873, -30125.045845889104, -29925.146990008343, -29807.883216179467, -30049.684736767475, -29929.17314142955, -29975.45568071386, -29858.83328117909, -29977.68922812979, -29832.09875319912, -29669.795564855514, -29875.44341170331, -29998.48427884018, -29844.59518535603, -29913.48692848351, -29817.573410696103, -29919.96503199338, -30421.939916595737, -29974.20755043081, -29878.59461816494, -29790.736362038933, -29954.092227270135, -30121.575868762175, -29862.165744373986, -29935.3981530079, -29972.483681286023], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.400436568821866, "mean_inference_ms": 0.24988510238798764, "mean_action_processing_ms": 0.0589435193669327, "mean_env_wait_ms": 1.4790502655388051, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0025107860565185547, "StateBufferConnector_ms": 0.0017473697662353516, "ViewRequirementAgentConnector_ms": 0.0447840690612793}}, "episode_reward_max": -29534.140652548722, "episode_reward_min": -30421.939916595737, "episode_reward_mean": -29907.49315728894, "episode_len_mean": 360.0, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-29999.940953204612, -29927.552167962298, -30034.237481121414, -29940.106997576408, -29851.598466892006, -29851.17816675025, -29758.31571960719, -29698.70096416914, -29752.33836249519, -29724.520520881266, -29828.47634821921, -29912.34275767336, -29738.78365407845, -29581.156238000196, -29782.646647494497, -29534.140652548722, -29954.82094612775, -29678.508092159133, -29753.41040762024, -30074.188370303957, -29813.00050972671, -30009.122726198522, -29785.933695821175, -29676.234010301047, -29823.370203113936, -30043.81083780306, -29959.476595282806, -30118.200268327324, -29886.69951357799, -30059.39787629178, -29859.246272981756, -29865.168614678318, -30006.781781675334, -30289.079314542912, -29746.593208358234, -29895.261504209688, -29845.61078481126, -29991.366086599584, -29933.65605863185, -30190.95108830336, -30023.581809845524, -30159.735297225863, -29907.91758061034, -29942.070068756948, -29693.63520917123, -29812.873974677997, -29907.89440624365, -29810.298594569467, -29918.551763915988, -30027.357654211384, -29778.1883225291, -29980.16289108057, -29924.491264451637, -29914.166874096354, -29893.576942417283, -29913.08623008574, -30279.299033279745, -29882.02203689561, -29909.89398011046, -29921.702053421035, -29834.9640053065, -29769.254348493607, -29820.60178498895, -29659.48732552499, -30021.4878991273, -29956.863566987584, -29749.27073272009, -29878.241387697926, -30063.430100590835, -29982.972692807583, -30011.25451141636, -29796.36636034372, -30001.965895035664, -29859.151104067558, -30136.024352712873, -30125.045845889104, -29925.146990008343, -29807.883216179467, -30049.684736767475, -29929.17314142955, -29975.45568071386, -29858.83328117909, -29977.68922812979, -29832.09875319912, -29669.795564855514, -29875.44341170331, -29998.48427884018, -29844.59518535603, -29913.48692848351, -29817.573410696103, -29919.96503199338, -30421.939916595737, -29974.20755043081, -29878.59461816494, -29790.736362038933, -29954.092227270135, -30121.575868762175, -29862.165744373986, -29935.3981530079, -29972.483681286023], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.400436568821866, "mean_inference_ms": 0.24988510238798764, "mean_action_processing_ms": 0.0589435193669327, "mean_env_wait_ms": 1.4790502655388051, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0025107860565185547, "StateBufferConnector_ms": 0.0017473697662353516, "ViewRequirementAgentConnector_ms": 0.0447840690612793}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 109440, "num_agent_steps_trained": 109440, "num_env_steps_sampled": 109440, "num_env_steps_trained": 109440, "num_env_steps_sampled_this_iter": 1800, "num_env_steps_trained_this_iter": 1800, "num_env_steps_sampled_throughput_per_sec": 162.00287057240985, "num_env_steps_trained_throughput_per_sec": 162.00287057240985, "timesteps_total": 109440, "num_steps_trained_this_iter": 1800, "agent_timesteps_total": 109440, "timers": {"training_iteration_time_ms": 2215.433, "sample_time_ms": 2210.054, "load_time_ms": 0.213, "load_throughput": 1691630.562, "learn_time_ms": 4.607, "learn_throughput": 78139.768, "synch_weights_time_ms": 0.526}, "counters": {"num_env_steps_sampled": 109440, "num_env_steps_trained": 109440, "num_agent_steps_sampled": 109440, "num_agent_steps_trained": 109440}, "done": false, "episodes_total": 304, "training_iteration": 61, "trial_id": "4935e_00000", "date": "2023-07-25_15-57-59", "timestamp": 1690289879, "time_this_iter_s": 11.113051891326904, "time_total_s": 680.5761919021606, "pid": 67353, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[0, 0.003], [5400, 0.001], [10800, 0.00075], [16200, 0.0005], [21600, 0.00025], [27000, 0.0001], [32400, 7.5e-05], [37800, 5e-05], [43200, 2.5e-05], [48600, 1e-05], [54000, 7.5e-06], [59400, 5e-06], [64800, 2.5e-06], [70200, 1e-06], [75600, 5e-07], [81000, 1e-07]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x177531310>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 680.5761919021606, "iterations_since_restore": 61, "perf": {"cpu_util_percent": 22.9125, "ram_util_percent": 78.4625}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-07, "entropy_coeff": 0.10000000000000002, "policy_entropy": -1859.8603515625, "policy_loss": -2620699262976.0, "vf_loss": 2463119146.6666665}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 120.0, "num_grad_updates_lifetime": 926.0, "diff_num_grad_updates_vs_sampler_policy": 925.0}}, "num_env_steps_sampled": 111240, "num_env_steps_trained": 111240, "num_agent_steps_sampled": 111240, "num_agent_steps_trained": 111240}, "sampler_results": {"episode_reward_max": -29534.140652548722, "episode_reward_min": -30421.939916595737, "episode_reward_mean": -29907.22620807829, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-29851.17816675025, -29758.31571960719, -29698.70096416914, -29752.33836249519, -29724.520520881266, -29828.47634821921, -29912.34275767336, -29738.78365407845, -29581.156238000196, -29782.646647494497, -29534.140652548722, -29954.82094612775, -29678.508092159133, -29753.41040762024, -30074.188370303957, -29813.00050972671, -30009.122726198522, -29785.933695821175, -29676.234010301047, -29823.370203113936, -30043.81083780306, -29959.476595282806, -30118.200268327324, -29886.69951357799, -30059.39787629178, -29859.246272981756, -29865.168614678318, -30006.781781675334, -30289.079314542912, -29746.593208358234, -29895.261504209688, -29845.61078481126, -29991.366086599584, -29933.65605863185, -30190.95108830336, -30023.581809845524, -30159.735297225863, -29907.91758061034, -29942.070068756948, -29693.63520917123, -29812.873974677997, -29907.89440624365, -29810.298594569467, -29918.551763915988, -30027.357654211384, -29778.1883225291, -29980.16289108057, -29924.491264451637, -29914.166874096354, -29893.576942417283, -29913.08623008574, -30279.299033279745, -29882.02203689561, -29909.89398011046, -29921.702053421035, -29834.9640053065, -29769.254348493607, -29820.60178498895, -29659.48732552499, -30021.4878991273, -29956.863566987584, -29749.27073272009, -29878.241387697926, -30063.430100590835, -29982.972692807583, -30011.25451141636, -29796.36636034372, -30001.965895035664, -29859.151104067558, -30136.024352712873, -30125.045845889104, -29925.146990008343, -29807.883216179467, -30049.684736767475, -29929.17314142955, -29975.45568071386, -29858.83328117909, -29977.68922812979, -29832.09875319912, -29669.795564855514, -29875.44341170331, -29998.48427884018, -29844.59518535603, -29913.48692848351, -29817.573410696103, -29919.96503199338, -30421.939916595737, -29974.20755043081, -29878.59461816494, -29790.736362038933, -29954.092227270135, -30121.575868762175, -29862.165744373986, -29935.3981530079, -29972.483681286023, -30081.021836307966, -29907.429103221653, -29987.41080214936, -29987.367854337004, -29763.511549675353], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.400392069846264, "mean_inference_ms": 0.24987455157199961, "mean_action_processing_ms": 0.05894267196900241, "mean_env_wait_ms": 1.4785108899423227, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0024983882904052734, "StateBufferConnector_ms": 0.0017390251159667969, "ViewRequirementAgentConnector_ms": 0.04472994804382324}}, "episode_reward_max": -29534.140652548722, "episode_reward_min": -30421.939916595737, "episode_reward_mean": -29907.22620807829, "episode_len_mean": 360.0, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-29851.17816675025, -29758.31571960719, -29698.70096416914, -29752.33836249519, -29724.520520881266, -29828.47634821921, -29912.34275767336, -29738.78365407845, -29581.156238000196, -29782.646647494497, -29534.140652548722, -29954.82094612775, -29678.508092159133, -29753.41040762024, -30074.188370303957, -29813.00050972671, -30009.122726198522, -29785.933695821175, -29676.234010301047, -29823.370203113936, -30043.81083780306, -29959.476595282806, -30118.200268327324, -29886.69951357799, -30059.39787629178, -29859.246272981756, -29865.168614678318, -30006.781781675334, -30289.079314542912, -29746.593208358234, -29895.261504209688, -29845.61078481126, -29991.366086599584, -29933.65605863185, -30190.95108830336, -30023.581809845524, -30159.735297225863, -29907.91758061034, -29942.070068756948, -29693.63520917123, -29812.873974677997, -29907.89440624365, -29810.298594569467, -29918.551763915988, -30027.357654211384, -29778.1883225291, -29980.16289108057, -29924.491264451637, -29914.166874096354, -29893.576942417283, -29913.08623008574, -30279.299033279745, -29882.02203689561, -29909.89398011046, -29921.702053421035, -29834.9640053065, -29769.254348493607, -29820.60178498895, -29659.48732552499, -30021.4878991273, -29956.863566987584, -29749.27073272009, -29878.241387697926, -30063.430100590835, -29982.972692807583, -30011.25451141636, -29796.36636034372, -30001.965895035664, -29859.151104067558, -30136.024352712873, -30125.045845889104, -29925.146990008343, -29807.883216179467, -30049.684736767475, -29929.17314142955, -29975.45568071386, -29858.83328117909, -29977.68922812979, -29832.09875319912, -29669.795564855514, -29875.44341170331, -29998.48427884018, -29844.59518535603, -29913.48692848351, -29817.573410696103, -29919.96503199338, -30421.939916595737, -29974.20755043081, -29878.59461816494, -29790.736362038933, -29954.092227270135, -30121.575868762175, -29862.165744373986, -29935.3981530079, -29972.483681286023, -30081.021836307966, -29907.429103221653, -29987.41080214936, -29987.367854337004, -29763.511549675353], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.400392069846264, "mean_inference_ms": 0.24987455157199961, "mean_action_processing_ms": 0.05894267196900241, "mean_env_wait_ms": 1.4785108899423227, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0024983882904052734, "StateBufferConnector_ms": 0.0017390251159667969, "ViewRequirementAgentConnector_ms": 0.04472994804382324}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 111240, "num_agent_steps_trained": 111240, "num_env_steps_sampled": 111240, "num_env_steps_trained": 111240, "num_env_steps_sampled_this_iter": 1800, "num_env_steps_trained_this_iter": 1800, "num_env_steps_sampled_throughput_per_sec": 161.4667609863738, "num_env_steps_trained_throughput_per_sec": 161.4667609863738, "timesteps_total": 111240, "num_steps_trained_this_iter": 1800, "agent_timesteps_total": 111240, "timers": {"training_iteration_time_ms": 2225.862, "sample_time_ms": 2220.485, "load_time_ms": 0.211, "load_throughput": 1702502.469, "learn_time_ms": 4.612, "learn_throughput": 78056.96, "synch_weights_time_ms": 0.521}, "counters": {"num_env_steps_sampled": 111240, "num_env_steps_trained": 111240, "num_agent_steps_sampled": 111240, "num_agent_steps_trained": 111240}, "done": false, "episodes_total": 309, "training_iteration": 62, "trial_id": "4935e_00000", "date": "2023-07-25_15-58-10", "timestamp": 1690289890, "time_this_iter_s": 11.149867057800293, "time_total_s": 691.7260589599609, "pid": 67353, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[0, 0.003], [5400, 0.001], [10800, 0.00075], [16200, 0.0005], [21600, 0.00025], [27000, 0.0001], [32400, 7.5e-05], [37800, 5e-05], [43200, 2.5e-05], [48600, 1e-05], [54000, 7.5e-06], [59400, 5e-06], [64800, 2.5e-06], [70200, 1e-06], [75600, 5e-07], [81000, 1e-07]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x177531310>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 691.7260589599609, "iterations_since_restore": 62, "perf": {"cpu_util_percent": 24.466666666666665, "ram_util_percent": 78.57333333333332}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-07, "entropy_coeff": 0.10000000000000002, "policy_entropy": -1859.8605550130208, "policy_loss": -1019630332586.6666, "vf_loss": 2482018069.3333335}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 120.0, "num_grad_updates_lifetime": 941.0, "diff_num_grad_updates_vs_sampler_policy": 940.0}}, "num_env_steps_sampled": 113040, "num_env_steps_trained": 113040, "num_agent_steps_sampled": 113040, "num_agent_steps_trained": 113040}, "sampler_results": {"episode_reward_max": -29534.140652548722, "episode_reward_min": -30421.939916595737, "episode_reward_mean": -29910.874298846265, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-29828.47634821921, -29912.34275767336, -29738.78365407845, -29581.156238000196, -29782.646647494497, -29534.140652548722, -29954.82094612775, -29678.508092159133, -29753.41040762024, -30074.188370303957, -29813.00050972671, -30009.122726198522, -29785.933695821175, -29676.234010301047, -29823.370203113936, -30043.81083780306, -29959.476595282806, -30118.200268327324, -29886.69951357799, -30059.39787629178, -29859.246272981756, -29865.168614678318, -30006.781781675334, -30289.079314542912, -29746.593208358234, -29895.261504209688, -29845.61078481126, -29991.366086599584, -29933.65605863185, -30190.95108830336, -30023.581809845524, -30159.735297225863, -29907.91758061034, -29942.070068756948, -29693.63520917123, -29812.873974677997, -29907.89440624365, -29810.298594569467, -29918.551763915988, -30027.357654211384, -29778.1883225291, -29980.16289108057, -29924.491264451637, -29914.166874096354, -29893.576942417283, -29913.08623008574, -30279.299033279745, -29882.02203689561, -29909.89398011046, -29921.702053421035, -29834.9640053065, -29769.254348493607, -29820.60178498895, -29659.48732552499, -30021.4878991273, -29956.863566987584, -29749.27073272009, -29878.241387697926, -30063.430100590835, -29982.972692807583, -30011.25451141636, -29796.36636034372, -30001.965895035664, -29859.151104067558, -30136.024352712873, -30125.045845889104, -29925.146990008343, -29807.883216179467, -30049.684736767475, -29929.17314142955, -29975.45568071386, -29858.83328117909, -29977.68922812979, -29832.09875319912, -29669.795564855514, -29875.44341170331, -29998.48427884018, -29844.59518535603, -29913.48692848351, -29817.573410696103, -29919.96503199338, -30421.939916595737, -29974.20755043081, -29878.59461816494, -29790.736362038933, -29954.092227270135, -30121.575868762175, -29862.165744373986, -29935.3981530079, -29972.483681286023, -30081.021836307966, -29907.429103221653, -29987.41080214936, -29987.367854337004, -29763.511549675353, -29724.3035331757, -29863.22248768989, -29810.68328115103, -29920.182441782854, -29831.47106690145], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.400330068973795, "mean_inference_ms": 0.24985935108217316, "mean_action_processing_ms": 0.05894127834897217, "mean_env_wait_ms": 1.477958176143199, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002506732940673828, "StateBufferConnector_ms": 0.0017414093017578125, "ViewRequirementAgentConnector_ms": 0.04481863975524902}}, "episode_reward_max": -29534.140652548722, "episode_reward_min": -30421.939916595737, "episode_reward_mean": -29910.874298846265, "episode_len_mean": 360.0, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-29828.47634821921, -29912.34275767336, -29738.78365407845, -29581.156238000196, -29782.646647494497, -29534.140652548722, -29954.82094612775, -29678.508092159133, -29753.41040762024, -30074.188370303957, -29813.00050972671, -30009.122726198522, -29785.933695821175, -29676.234010301047, -29823.370203113936, -30043.81083780306, -29959.476595282806, -30118.200268327324, -29886.69951357799, -30059.39787629178, -29859.246272981756, -29865.168614678318, -30006.781781675334, -30289.079314542912, -29746.593208358234, -29895.261504209688, -29845.61078481126, -29991.366086599584, -29933.65605863185, -30190.95108830336, -30023.581809845524, -30159.735297225863, -29907.91758061034, -29942.070068756948, -29693.63520917123, -29812.873974677997, -29907.89440624365, -29810.298594569467, -29918.551763915988, -30027.357654211384, -29778.1883225291, -29980.16289108057, -29924.491264451637, -29914.166874096354, -29893.576942417283, -29913.08623008574, -30279.299033279745, -29882.02203689561, -29909.89398011046, -29921.702053421035, -29834.9640053065, -29769.254348493607, -29820.60178498895, -29659.48732552499, -30021.4878991273, -29956.863566987584, -29749.27073272009, -29878.241387697926, -30063.430100590835, -29982.972692807583, -30011.25451141636, -29796.36636034372, -30001.965895035664, -29859.151104067558, -30136.024352712873, -30125.045845889104, -29925.146990008343, -29807.883216179467, -30049.684736767475, -29929.17314142955, -29975.45568071386, -29858.83328117909, -29977.68922812979, -29832.09875319912, -29669.795564855514, -29875.44341170331, -29998.48427884018, -29844.59518535603, -29913.48692848351, -29817.573410696103, -29919.96503199338, -30421.939916595737, -29974.20755043081, -29878.59461816494, -29790.736362038933, -29954.092227270135, -30121.575868762175, -29862.165744373986, -29935.3981530079, -29972.483681286023, -30081.021836307966, -29907.429103221653, -29987.41080214936, -29987.367854337004, -29763.511549675353, -29724.3035331757, -29863.22248768989, -29810.68328115103, -29920.182441782854, -29831.47106690145], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.400330068973795, "mean_inference_ms": 0.24985935108217316, "mean_action_processing_ms": 0.05894127834897217, "mean_env_wait_ms": 1.477958176143199, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002506732940673828, "StateBufferConnector_ms": 0.0017414093017578125, "ViewRequirementAgentConnector_ms": 0.04481863975524902}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 113040, "num_agent_steps_trained": 113040, "num_env_steps_sampled": 113040, "num_env_steps_trained": 113040, "num_env_steps_sampled_this_iter": 1800, "num_env_steps_trained_this_iter": 1800, "num_env_steps_sampled_throughput_per_sec": 161.58569026260588, "num_env_steps_trained_throughput_per_sec": 161.58569026260588, "timesteps_total": 113040, "num_steps_trained_this_iter": 1800, "agent_timesteps_total": 113040, "timers": {"training_iteration_time_ms": 2228.731, "sample_time_ms": 2223.253, "load_time_ms": 0.215, "load_throughput": 1676045.554, "learn_time_ms": 4.661, "learn_throughput": 77244.748, "synch_weights_time_ms": 0.57}, "counters": {"num_env_steps_sampled": 113040, "num_env_steps_trained": 113040, "num_agent_steps_sampled": 113040, "num_agent_steps_trained": 113040}, "done": false, "episodes_total": 314, "training_iteration": 63, "trial_id": "4935e_00000", "date": "2023-07-25_15-58-22", "timestamp": 1690289902, "time_this_iter_s": 11.142156839370728, "time_total_s": 702.8682157993317, "pid": 67353, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[0, 0.003], [5400, 0.001], [10800, 0.00075], [16200, 0.0005], [21600, 0.00025], [27000, 0.0001], [32400, 7.5e-05], [37800, 5e-05], [43200, 2.5e-05], [48600, 1e-05], [54000, 7.5e-06], [59400, 5e-06], [64800, 2.5e-06], [70200, 1e-06], [75600, 5e-07], [81000, 1e-07]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x177531310>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 702.8682157993317, "iterations_since_restore": 63, "perf": {"cpu_util_percent": 26.64375, "ram_util_percent": 78.64375}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-07, "entropy_coeff": 0.10000000000000002, "policy_entropy": -1859.8602701822917, "policy_loss": -4237748256768.0, "vf_loss": 2489276096.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 120.0, "num_grad_updates_lifetime": 956.0, "diff_num_grad_updates_vs_sampler_policy": 955.0}}, "num_env_steps_sampled": 114840, "num_env_steps_trained": 114840, "num_agent_steps_sampled": 114840, "num_agent_steps_trained": 114840}, "sampler_results": {"episode_reward_max": -29534.140652548722, "episode_reward_min": -30421.939916595737, "episode_reward_mean": -29917.834069924906, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-29534.140652548722, -29954.82094612775, -29678.508092159133, -29753.41040762024, -30074.188370303957, -29813.00050972671, -30009.122726198522, -29785.933695821175, -29676.234010301047, -29823.370203113936, -30043.81083780306, -29959.476595282806, -30118.200268327324, -29886.69951357799, -30059.39787629178, -29859.246272981756, -29865.168614678318, -30006.781781675334, -30289.079314542912, -29746.593208358234, -29895.261504209688, -29845.61078481126, -29991.366086599584, -29933.65605863185, -30190.95108830336, -30023.581809845524, -30159.735297225863, -29907.91758061034, -29942.070068756948, -29693.63520917123, -29812.873974677997, -29907.89440624365, -29810.298594569467, -29918.551763915988, -30027.357654211384, -29778.1883225291, -29980.16289108057, -29924.491264451637, -29914.166874096354, -29893.576942417283, -29913.08623008574, -30279.299033279745, -29882.02203689561, -29909.89398011046, -29921.702053421035, -29834.9640053065, -29769.254348493607, -29820.60178498895, -29659.48732552499, -30021.4878991273, -29956.863566987584, -29749.27073272009, -29878.241387697926, -30063.430100590835, -29982.972692807583, -30011.25451141636, -29796.36636034372, -30001.965895035664, -29859.151104067558, -30136.024352712873, -30125.045845889104, -29925.146990008343, -29807.883216179467, -30049.684736767475, -29929.17314142955, -29975.45568071386, -29858.83328117909, -29977.68922812979, -29832.09875319912, -29669.795564855514, -29875.44341170331, -29998.48427884018, -29844.59518535603, -29913.48692848351, -29817.573410696103, -29919.96503199338, -30421.939916595737, -29974.20755043081, -29878.59461816494, -29790.736362038933, -29954.092227270135, -30121.575868762175, -29862.165744373986, -29935.3981530079, -29972.483681286023, -30081.021836307966, -29907.429103221653, -29987.41080214936, -29987.367854337004, -29763.511549675353, -29724.3035331757, -29863.22248768989, -29810.68328115103, -29920.182441782854, -29831.47106690145, -30089.354066681914, -29742.48222249411, -29820.000789343856, -29989.463119610067, -29898.082555198955], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.40024969791962, "mean_inference_ms": 0.24984189180744604, "mean_action_processing_ms": 0.05893965706773093, "mean_env_wait_ms": 1.4774073526207843, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0024983882904052734, "StateBufferConnector_ms": 0.0017418861389160156, "ViewRequirementAgentConnector_ms": 0.04474449157714844}}, "episode_reward_max": -29534.140652548722, "episode_reward_min": -30421.939916595737, "episode_reward_mean": -29917.834069924906, "episode_len_mean": 360.0, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-29534.140652548722, -29954.82094612775, -29678.508092159133, -29753.41040762024, -30074.188370303957, -29813.00050972671, -30009.122726198522, -29785.933695821175, -29676.234010301047, -29823.370203113936, -30043.81083780306, -29959.476595282806, -30118.200268327324, -29886.69951357799, -30059.39787629178, -29859.246272981756, -29865.168614678318, -30006.781781675334, -30289.079314542912, -29746.593208358234, -29895.261504209688, -29845.61078481126, -29991.366086599584, -29933.65605863185, -30190.95108830336, -30023.581809845524, -30159.735297225863, -29907.91758061034, -29942.070068756948, -29693.63520917123, -29812.873974677997, -29907.89440624365, -29810.298594569467, -29918.551763915988, -30027.357654211384, -29778.1883225291, -29980.16289108057, -29924.491264451637, -29914.166874096354, -29893.576942417283, -29913.08623008574, -30279.299033279745, -29882.02203689561, -29909.89398011046, -29921.702053421035, -29834.9640053065, -29769.254348493607, -29820.60178498895, -29659.48732552499, -30021.4878991273, -29956.863566987584, -29749.27073272009, -29878.241387697926, -30063.430100590835, -29982.972692807583, -30011.25451141636, -29796.36636034372, -30001.965895035664, -29859.151104067558, -30136.024352712873, -30125.045845889104, -29925.146990008343, -29807.883216179467, -30049.684736767475, -29929.17314142955, -29975.45568071386, -29858.83328117909, -29977.68922812979, -29832.09875319912, -29669.795564855514, -29875.44341170331, -29998.48427884018, -29844.59518535603, -29913.48692848351, -29817.573410696103, -29919.96503199338, -30421.939916595737, -29974.20755043081, -29878.59461816494, -29790.736362038933, -29954.092227270135, -30121.575868762175, -29862.165744373986, -29935.3981530079, -29972.483681286023, -30081.021836307966, -29907.429103221653, -29987.41080214936, -29987.367854337004, -29763.511549675353, -29724.3035331757, -29863.22248768989, -29810.68328115103, -29920.182441782854, -29831.47106690145, -30089.354066681914, -29742.48222249411, -29820.000789343856, -29989.463119610067, -29898.082555198955], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.40024969791962, "mean_inference_ms": 0.24984189180744604, "mean_action_processing_ms": 0.05893965706773093, "mean_env_wait_ms": 1.4774073526207843, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0024983882904052734, "StateBufferConnector_ms": 0.0017418861389160156, "ViewRequirementAgentConnector_ms": 0.04474449157714844}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 114840, "num_agent_steps_trained": 114840, "num_env_steps_sampled": 114840, "num_env_steps_trained": 114840, "num_env_steps_sampled_this_iter": 1800, "num_env_steps_trained_this_iter": 1800, "num_env_steps_sampled_throughput_per_sec": 162.32188178254057, "num_env_steps_trained_throughput_per_sec": 162.32188178254057, "timesteps_total": 114840, "num_steps_trained_this_iter": 1800, "agent_timesteps_total": 114840, "timers": {"training_iteration_time_ms": 2222.858, "sample_time_ms": 2217.41, "load_time_ms": 0.215, "load_throughput": 1676603.864, "learn_time_ms": 4.644, "learn_throughput": 77515.988, "synch_weights_time_ms": 0.555}, "counters": {"num_env_steps_sampled": 114840, "num_env_steps_trained": 114840, "num_agent_steps_sampled": 114840, "num_agent_steps_trained": 114840}, "done": false, "episodes_total": 319, "training_iteration": 64, "trial_id": "4935e_00000", "date": "2023-07-25_15-58-33", "timestamp": 1690289913, "time_this_iter_s": 11.091118097305298, "time_total_s": 713.959333896637, "pid": 67353, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[0, 0.003], [5400, 0.001], [10800, 0.00075], [16200, 0.0005], [21600, 0.00025], [27000, 0.0001], [32400, 7.5e-05], [37800, 5e-05], [43200, 2.5e-05], [48600, 1e-05], [54000, 7.5e-06], [59400, 5e-06], [64800, 2.5e-06], [70200, 1e-06], [75600, 5e-07], [81000, 1e-07]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x177531310>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 713.959333896637, "iterations_since_restore": 64, "perf": {"cpu_util_percent": 24.956249999999997, "ram_util_percent": 78.0375}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-07, "entropy_coeff": 0.10000000000000002, "policy_entropy": -1859.8602294921875, "policy_loss": -1600035815424.0, "vf_loss": 2478121301.3333335}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 120.0, "num_grad_updates_lifetime": 971.0, "diff_num_grad_updates_vs_sampler_policy": 970.0}}, "num_env_steps_sampled": 116640, "num_env_steps_trained": 116640, "num_agent_steps_sampled": 116640, "num_agent_steps_trained": 116640}, "sampler_results": {"episode_reward_max": -29659.48732552499, "episode_reward_min": -30421.939916595737, "episode_reward_mean": -29918.517610222003, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-29813.00050972671, -30009.122726198522, -29785.933695821175, -29676.234010301047, -29823.370203113936, -30043.81083780306, -29959.476595282806, -30118.200268327324, -29886.69951357799, -30059.39787629178, -29859.246272981756, -29865.168614678318, -30006.781781675334, -30289.079314542912, -29746.593208358234, -29895.261504209688, -29845.61078481126, -29991.366086599584, -29933.65605863185, -30190.95108830336, -30023.581809845524, -30159.735297225863, -29907.91758061034, -29942.070068756948, -29693.63520917123, -29812.873974677997, -29907.89440624365, -29810.298594569467, -29918.551763915988, -30027.357654211384, -29778.1883225291, -29980.16289108057, -29924.491264451637, -29914.166874096354, -29893.576942417283, -29913.08623008574, -30279.299033279745, -29882.02203689561, -29909.89398011046, -29921.702053421035, -29834.9640053065, -29769.254348493607, -29820.60178498895, -29659.48732552499, -30021.4878991273, -29956.863566987584, -29749.27073272009, -29878.241387697926, -30063.430100590835, -29982.972692807583, -30011.25451141636, -29796.36636034372, -30001.965895035664, -29859.151104067558, -30136.024352712873, -30125.045845889104, -29925.146990008343, -29807.883216179467, -30049.684736767475, -29929.17314142955, -29975.45568071386, -29858.83328117909, -29977.68922812979, -29832.09875319912, -29669.795564855514, -29875.44341170331, -29998.48427884018, -29844.59518535603, -29913.48692848351, -29817.573410696103, -29919.96503199338, -30421.939916595737, -29974.20755043081, -29878.59461816494, -29790.736362038933, -29954.092227270135, -30121.575868762175, -29862.165744373986, -29935.3981530079, -29972.483681286023, -30081.021836307966, -29907.429103221653, -29987.41080214936, -29987.367854337004, -29763.511549675353, -29724.3035331757, -29863.22248768989, -29810.68328115103, -29920.182441782854, -29831.47106690145, -30089.354066681914, -29742.48222249411, -29820.000789343856, -29989.463119610067, -29898.082555198955, -29726.961135734775, -29899.760472305024, -29878.626196737107, -29668.54550266056, -29889.529191033496], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.400179701703352, "mean_inference_ms": 0.2498289740606979, "mean_action_processing_ms": 0.05893881671040136, "mean_env_wait_ms": 1.476880296691478, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0024785995483398438, "StateBufferConnector_ms": 0.0017311573028564453, "ViewRequirementAgentConnector_ms": 0.04449915885925293}}, "episode_reward_max": -29659.48732552499, "episode_reward_min": -30421.939916595737, "episode_reward_mean": -29918.517610222003, "episode_len_mean": 360.0, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-29813.00050972671, -30009.122726198522, -29785.933695821175, -29676.234010301047, -29823.370203113936, -30043.81083780306, -29959.476595282806, -30118.200268327324, -29886.69951357799, -30059.39787629178, -29859.246272981756, -29865.168614678318, -30006.781781675334, -30289.079314542912, -29746.593208358234, -29895.261504209688, -29845.61078481126, -29991.366086599584, -29933.65605863185, -30190.95108830336, -30023.581809845524, -30159.735297225863, -29907.91758061034, -29942.070068756948, -29693.63520917123, -29812.873974677997, -29907.89440624365, -29810.298594569467, -29918.551763915988, -30027.357654211384, -29778.1883225291, -29980.16289108057, -29924.491264451637, -29914.166874096354, -29893.576942417283, -29913.08623008574, -30279.299033279745, -29882.02203689561, -29909.89398011046, -29921.702053421035, -29834.9640053065, -29769.254348493607, -29820.60178498895, -29659.48732552499, -30021.4878991273, -29956.863566987584, -29749.27073272009, -29878.241387697926, -30063.430100590835, -29982.972692807583, -30011.25451141636, -29796.36636034372, -30001.965895035664, -29859.151104067558, -30136.024352712873, -30125.045845889104, -29925.146990008343, -29807.883216179467, -30049.684736767475, -29929.17314142955, -29975.45568071386, -29858.83328117909, -29977.68922812979, -29832.09875319912, -29669.795564855514, -29875.44341170331, -29998.48427884018, -29844.59518535603, -29913.48692848351, -29817.573410696103, -29919.96503199338, -30421.939916595737, -29974.20755043081, -29878.59461816494, -29790.736362038933, -29954.092227270135, -30121.575868762175, -29862.165744373986, -29935.3981530079, -29972.483681286023, -30081.021836307966, -29907.429103221653, -29987.41080214936, -29987.367854337004, -29763.511549675353, -29724.3035331757, -29863.22248768989, -29810.68328115103, -29920.182441782854, -29831.47106690145, -30089.354066681914, -29742.48222249411, -29820.000789343856, -29989.463119610067, -29898.082555198955, -29726.961135734775, -29899.760472305024, -29878.626196737107, -29668.54550266056, -29889.529191033496], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.400179701703352, "mean_inference_ms": 0.2498289740606979, "mean_action_processing_ms": 0.05893881671040136, "mean_env_wait_ms": 1.476880296691478, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0024785995483398438, "StateBufferConnector_ms": 0.0017311573028564453, "ViewRequirementAgentConnector_ms": 0.04449915885925293}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 116640, "num_agent_steps_trained": 116640, "num_env_steps_sampled": 116640, "num_env_steps_trained": 116640, "num_env_steps_sampled_this_iter": 1800, "num_env_steps_trained_this_iter": 1800, "num_env_steps_sampled_throughput_per_sec": 160.3150689425657, "num_env_steps_trained_throughput_per_sec": 160.3150689425657, "timesteps_total": 116640, "num_steps_trained_this_iter": 1800, "agent_timesteps_total": 116640, "timers": {"training_iteration_time_ms": 2231.687, "sample_time_ms": 2226.223, "load_time_ms": 0.212, "load_throughput": 1695048.765, "learn_time_ms": 4.703, "learn_throughput": 76553.528, "synch_weights_time_ms": 0.517}, "counters": {"num_env_steps_sampled": 116640, "num_env_steps_trained": 116640, "num_agent_steps_sampled": 116640, "num_agent_steps_trained": 116640}, "done": false, "episodes_total": 324, "training_iteration": 65, "trial_id": "4935e_00000", "date": "2023-07-25_15-58-44", "timestamp": 1690289924, "time_this_iter_s": 11.229866981506348, "time_total_s": 725.1892008781433, "pid": 67353, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[0, 0.003], [5400, 0.001], [10800, 0.00075], [16200, 0.0005], [21600, 0.00025], [27000, 0.0001], [32400, 7.5e-05], [37800, 5e-05], [43200, 2.5e-05], [48600, 1e-05], [54000, 7.5e-06], [59400, 5e-06], [64800, 2.5e-06], [70200, 1e-06], [75600, 5e-07], [81000, 1e-07]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x177531310>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 725.1892008781433, "iterations_since_restore": 65, "perf": {"cpu_util_percent": 26.21875, "ram_util_percent": 77.88125}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-07, "entropy_coeff": 0.10000000000000002, "policy_entropy": -1859.8600260416667, "policy_loss": -917402058752.0, "vf_loss": 2523747008.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 120.0, "num_grad_updates_lifetime": 986.0, "diff_num_grad_updates_vs_sampler_policy": 985.0}}, "num_env_steps_sampled": 118440, "num_env_steps_trained": 118440, "num_agent_steps_sampled": 118440, "num_agent_steps_trained": 118440}, "sampler_results": {"episode_reward_max": -29659.48732552499, "episode_reward_min": -30421.939916595737, "episode_reward_mean": -29924.546282280422, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-30043.81083780306, -29959.476595282806, -30118.200268327324, -29886.69951357799, -30059.39787629178, -29859.246272981756, -29865.168614678318, -30006.781781675334, -30289.079314542912, -29746.593208358234, -29895.261504209688, -29845.61078481126, -29991.366086599584, -29933.65605863185, -30190.95108830336, -30023.581809845524, -30159.735297225863, -29907.91758061034, -29942.070068756948, -29693.63520917123, -29812.873974677997, -29907.89440624365, -29810.298594569467, -29918.551763915988, -30027.357654211384, -29778.1883225291, -29980.16289108057, -29924.491264451637, -29914.166874096354, -29893.576942417283, -29913.08623008574, -30279.299033279745, -29882.02203689561, -29909.89398011046, -29921.702053421035, -29834.9640053065, -29769.254348493607, -29820.60178498895, -29659.48732552499, -30021.4878991273, -29956.863566987584, -29749.27073272009, -29878.241387697926, -30063.430100590835, -29982.972692807583, -30011.25451141636, -29796.36636034372, -30001.965895035664, -29859.151104067558, -30136.024352712873, -30125.045845889104, -29925.146990008343, -29807.883216179467, -30049.684736767475, -29929.17314142955, -29975.45568071386, -29858.83328117909, -29977.68922812979, -29832.09875319912, -29669.795564855514, -29875.44341170331, -29998.48427884018, -29844.59518535603, -29913.48692848351, -29817.573410696103, -29919.96503199338, -30421.939916595737, -29974.20755043081, -29878.59461816494, -29790.736362038933, -29954.092227270135, -30121.575868762175, -29862.165744373986, -29935.3981530079, -29972.483681286023, -30081.021836307966, -29907.429103221653, -29987.41080214936, -29987.367854337004, -29763.511549675353, -29724.3035331757, -29863.22248768989, -29810.68328115103, -29920.182441782854, -29831.47106690145, -30089.354066681914, -29742.48222249411, -29820.000789343856, -29989.463119610067, -29898.082555198955, -29726.961135734775, -29899.760472305024, -29878.626196737107, -29668.54550266056, -29889.529191033496, -29710.267566470306, -30108.97802111229, -29843.573925247816, -29890.824278062966, -30156.884560109007], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.400154043952718, "mean_inference_ms": 0.249818384769608, "mean_action_processing_ms": 0.05893825436158476, "mean_env_wait_ms": 1.4763534330133767, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0024709701538085938, "StateBufferConnector_ms": 0.0017371177673339844, "ViewRequirementAgentConnector_ms": 0.04454541206359863}}, "episode_reward_max": -29659.48732552499, "episode_reward_min": -30421.939916595737, "episode_reward_mean": -29924.546282280422, "episode_len_mean": 360.0, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-30043.81083780306, -29959.476595282806, -30118.200268327324, -29886.69951357799, -30059.39787629178, -29859.246272981756, -29865.168614678318, -30006.781781675334, -30289.079314542912, -29746.593208358234, -29895.261504209688, -29845.61078481126, -29991.366086599584, -29933.65605863185, -30190.95108830336, -30023.581809845524, -30159.735297225863, -29907.91758061034, -29942.070068756948, -29693.63520917123, -29812.873974677997, -29907.89440624365, -29810.298594569467, -29918.551763915988, -30027.357654211384, -29778.1883225291, -29980.16289108057, -29924.491264451637, -29914.166874096354, -29893.576942417283, -29913.08623008574, -30279.299033279745, -29882.02203689561, -29909.89398011046, -29921.702053421035, -29834.9640053065, -29769.254348493607, -29820.60178498895, -29659.48732552499, -30021.4878991273, -29956.863566987584, -29749.27073272009, -29878.241387697926, -30063.430100590835, -29982.972692807583, -30011.25451141636, -29796.36636034372, -30001.965895035664, -29859.151104067558, -30136.024352712873, -30125.045845889104, -29925.146990008343, -29807.883216179467, -30049.684736767475, -29929.17314142955, -29975.45568071386, -29858.83328117909, -29977.68922812979, -29832.09875319912, -29669.795564855514, -29875.44341170331, -29998.48427884018, -29844.59518535603, -29913.48692848351, -29817.573410696103, -29919.96503199338, -30421.939916595737, -29974.20755043081, -29878.59461816494, -29790.736362038933, -29954.092227270135, -30121.575868762175, -29862.165744373986, -29935.3981530079, -29972.483681286023, -30081.021836307966, -29907.429103221653, -29987.41080214936, -29987.367854337004, -29763.511549675353, -29724.3035331757, -29863.22248768989, -29810.68328115103, -29920.182441782854, -29831.47106690145, -30089.354066681914, -29742.48222249411, -29820.000789343856, -29989.463119610067, -29898.082555198955, -29726.961135734775, -29899.760472305024, -29878.626196737107, -29668.54550266056, -29889.529191033496, -29710.267566470306, -30108.97802111229, -29843.573925247816, -29890.824278062966, -30156.884560109007], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.400154043952718, "mean_inference_ms": 0.249818384769608, "mean_action_processing_ms": 0.05893825436158476, "mean_env_wait_ms": 1.4763534330133767, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0024709701538085938, "StateBufferConnector_ms": 0.0017371177673339844, "ViewRequirementAgentConnector_ms": 0.04454541206359863}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 118440, "num_agent_steps_trained": 118440, "num_env_steps_sampled": 118440, "num_env_steps_trained": 118440, "num_env_steps_sampled_this_iter": 1800, "num_env_steps_trained_this_iter": 1800, "num_env_steps_sampled_throughput_per_sec": 159.92307844822224, "num_env_steps_trained_throughput_per_sec": 159.92307844822224, "timesteps_total": 118440, "num_steps_trained_this_iter": 1800, "agent_timesteps_total": 118440, "timers": {"training_iteration_time_ms": 2248.32, "sample_time_ms": 2242.736, "load_time_ms": 0.217, "load_throughput": 1655283.315, "learn_time_ms": 4.794, "learn_throughput": 75088.988, "synch_weights_time_ms": 0.538}, "counters": {"num_env_steps_sampled": 118440, "num_env_steps_trained": 118440, "num_agent_steps_sampled": 118440, "num_agent_steps_trained": 118440}, "done": false, "episodes_total": 329, "training_iteration": 66, "trial_id": "4935e_00000", "date": "2023-07-25_15-58-55", "timestamp": 1690289935, "time_this_iter_s": 11.257548093795776, "time_total_s": 736.4467489719391, "pid": 67353, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[0, 0.003], [5400, 0.001], [10800, 0.00075], [16200, 0.0005], [21600, 0.00025], [27000, 0.0001], [32400, 7.5e-05], [37800, 5e-05], [43200, 2.5e-05], [48600, 1e-05], [54000, 7.5e-06], [59400, 5e-06], [64800, 2.5e-06], [70200, 1e-06], [75600, 5e-07], [81000, 1e-07]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x177531310>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 736.4467489719391, "iterations_since_restore": 66, "perf": {"cpu_util_percent": 29.549999999999997, "ram_util_percent": 79.05625}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-07, "entropy_coeff": 0.10000000000000002, "policy_entropy": -1859.8603108723958, "policy_loss": -3015064354816.0, "vf_loss": 2477244800.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 120.0, "num_grad_updates_lifetime": 1001.0, "diff_num_grad_updates_vs_sampler_policy": 1000.0}}, "num_env_steps_sampled": 120240, "num_env_steps_trained": 120240, "num_agent_steps_sampled": 120240, "num_agent_steps_trained": 120240}, "sampler_results": {"episode_reward_max": -29659.48732552499, "episode_reward_min": -30421.939916595737, "episode_reward_mean": -29916.163092143932, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-29859.246272981756, -29865.168614678318, -30006.781781675334, -30289.079314542912, -29746.593208358234, -29895.261504209688, -29845.61078481126, -29991.366086599584, -29933.65605863185, -30190.95108830336, -30023.581809845524, -30159.735297225863, -29907.91758061034, -29942.070068756948, -29693.63520917123, -29812.873974677997, -29907.89440624365, -29810.298594569467, -29918.551763915988, -30027.357654211384, -29778.1883225291, -29980.16289108057, -29924.491264451637, -29914.166874096354, -29893.576942417283, -29913.08623008574, -30279.299033279745, -29882.02203689561, -29909.89398011046, -29921.702053421035, -29834.9640053065, -29769.254348493607, -29820.60178498895, -29659.48732552499, -30021.4878991273, -29956.863566987584, -29749.27073272009, -29878.241387697926, -30063.430100590835, -29982.972692807583, -30011.25451141636, -29796.36636034372, -30001.965895035664, -29859.151104067558, -30136.024352712873, -30125.045845889104, -29925.146990008343, -29807.883216179467, -30049.684736767475, -29929.17314142955, -29975.45568071386, -29858.83328117909, -29977.68922812979, -29832.09875319912, -29669.795564855514, -29875.44341170331, -29998.48427884018, -29844.59518535603, -29913.48692848351, -29817.573410696103, -29919.96503199338, -30421.939916595737, -29974.20755043081, -29878.59461816494, -29790.736362038933, -29954.092227270135, -30121.575868762175, -29862.165744373986, -29935.3981530079, -29972.483681286023, -30081.021836307966, -29907.429103221653, -29987.41080214936, -29987.367854337004, -29763.511549675353, -29724.3035331757, -29863.22248768989, -29810.68328115103, -29920.182441782854, -29831.47106690145, -30089.354066681914, -29742.48222249411, -29820.000789343856, -29989.463119610067, -29898.082555198955, -29726.961135734775, -29899.760472305024, -29878.626196737107, -29668.54550266056, -29889.529191033496, -29710.267566470306, -30108.97802111229, -29843.573925247816, -29890.824278062966, -30156.884560109007, -30121.124559396467, -29782.770520284528, -29687.108916399684, -29797.444996422997, -29840.817085131093], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.400119427398259, "mean_inference_ms": 0.249812934875068, "mean_action_processing_ms": 0.05893859631703499, "mean_env_wait_ms": 1.4758554208317383, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0024733543395996094, "StateBufferConnector_ms": 0.0017380714416503906, "ViewRequirementAgentConnector_ms": 0.04459691047668457}}, "episode_reward_max": -29659.48732552499, "episode_reward_min": -30421.939916595737, "episode_reward_mean": -29916.163092143932, "episode_len_mean": 360.0, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-29859.246272981756, -29865.168614678318, -30006.781781675334, -30289.079314542912, -29746.593208358234, -29895.261504209688, -29845.61078481126, -29991.366086599584, -29933.65605863185, -30190.95108830336, -30023.581809845524, -30159.735297225863, -29907.91758061034, -29942.070068756948, -29693.63520917123, -29812.873974677997, -29907.89440624365, -29810.298594569467, -29918.551763915988, -30027.357654211384, -29778.1883225291, -29980.16289108057, -29924.491264451637, -29914.166874096354, -29893.576942417283, -29913.08623008574, -30279.299033279745, -29882.02203689561, -29909.89398011046, -29921.702053421035, -29834.9640053065, -29769.254348493607, -29820.60178498895, -29659.48732552499, -30021.4878991273, -29956.863566987584, -29749.27073272009, -29878.241387697926, -30063.430100590835, -29982.972692807583, -30011.25451141636, -29796.36636034372, -30001.965895035664, -29859.151104067558, -30136.024352712873, -30125.045845889104, -29925.146990008343, -29807.883216179467, -30049.684736767475, -29929.17314142955, -29975.45568071386, -29858.83328117909, -29977.68922812979, -29832.09875319912, -29669.795564855514, -29875.44341170331, -29998.48427884018, -29844.59518535603, -29913.48692848351, -29817.573410696103, -29919.96503199338, -30421.939916595737, -29974.20755043081, -29878.59461816494, -29790.736362038933, -29954.092227270135, -30121.575868762175, -29862.165744373986, -29935.3981530079, -29972.483681286023, -30081.021836307966, -29907.429103221653, -29987.41080214936, -29987.367854337004, -29763.511549675353, -29724.3035331757, -29863.22248768989, -29810.68328115103, -29920.182441782854, -29831.47106690145, -30089.354066681914, -29742.48222249411, -29820.000789343856, -29989.463119610067, -29898.082555198955, -29726.961135734775, -29899.760472305024, -29878.626196737107, -29668.54550266056, -29889.529191033496, -29710.267566470306, -30108.97802111229, -29843.573925247816, -29890.824278062966, -30156.884560109007, -30121.124559396467, -29782.770520284528, -29687.108916399684, -29797.444996422997, -29840.817085131093], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.400119427398259, "mean_inference_ms": 0.249812934875068, "mean_action_processing_ms": 0.05893859631703499, "mean_env_wait_ms": 1.4758554208317383, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0024733543395996094, "StateBufferConnector_ms": 0.0017380714416503906, "ViewRequirementAgentConnector_ms": 0.04459691047668457}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 120240, "num_agent_steps_trained": 120240, "num_env_steps_sampled": 120240, "num_env_steps_trained": 120240, "num_env_steps_sampled_this_iter": 1800, "num_env_steps_trained_this_iter": 1800, "num_env_steps_sampled_throughput_per_sec": 161.8631826540319, "num_env_steps_trained_throughput_per_sec": 161.8631826540319, "timesteps_total": 120240, "num_steps_trained_this_iter": 1800, "agent_timesteps_total": 120240, "timers": {"training_iteration_time_ms": 2237.581, "sample_time_ms": 2231.967, "load_time_ms": 0.218, "load_throughput": 1650578.749, "learn_time_ms": 4.817, "learn_throughput": 74734.433, "synch_weights_time_ms": 0.546}, "counters": {"num_env_steps_sampled": 120240, "num_env_steps_trained": 120240, "num_agent_steps_sampled": 120240, "num_agent_steps_trained": 120240}, "done": false, "episodes_total": 334, "training_iteration": 67, "trial_id": "4935e_00000", "date": "2023-07-25_15-59-06", "timestamp": 1690289946, "time_this_iter_s": 11.122628211975098, "time_total_s": 747.5693771839142, "pid": 67353, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[0, 0.003], [5400, 0.001], [10800, 0.00075], [16200, 0.0005], [21600, 0.00025], [27000, 0.0001], [32400, 7.5e-05], [37800, 5e-05], [43200, 2.5e-05], [48600, 1e-05], [54000, 7.5e-06], [59400, 5e-06], [64800, 2.5e-06], [70200, 1e-06], [75600, 5e-07], [81000, 1e-07]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x177531310>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 747.5693771839142, "iterations_since_restore": 67, "perf": {"cpu_util_percent": 25.73125, "ram_util_percent": 78.425}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-07, "entropy_coeff": 0.10000000000000002, "policy_entropy": -1859.8602294921875, "policy_loss": -1142345539584.0, "vf_loss": 2506069269.3333335}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 120.0, "num_grad_updates_lifetime": 1016.0, "diff_num_grad_updates_vs_sampler_policy": 1015.0}}, "num_env_steps_sampled": 122040, "num_env_steps_trained": 122040, "num_agent_steps_sampled": 122040, "num_agent_steps_trained": 122040}, "sampler_results": {"episode_reward_max": -29659.48732552499, "episode_reward_min": -30421.939916595737, "episode_reward_mean": -29913.11806160797, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-29895.261504209688, -29845.61078481126, -29991.366086599584, -29933.65605863185, -30190.95108830336, -30023.581809845524, -30159.735297225863, -29907.91758061034, -29942.070068756948, -29693.63520917123, -29812.873974677997, -29907.89440624365, -29810.298594569467, -29918.551763915988, -30027.357654211384, -29778.1883225291, -29980.16289108057, -29924.491264451637, -29914.166874096354, -29893.576942417283, -29913.08623008574, -30279.299033279745, -29882.02203689561, -29909.89398011046, -29921.702053421035, -29834.9640053065, -29769.254348493607, -29820.60178498895, -29659.48732552499, -30021.4878991273, -29956.863566987584, -29749.27073272009, -29878.241387697926, -30063.430100590835, -29982.972692807583, -30011.25451141636, -29796.36636034372, -30001.965895035664, -29859.151104067558, -30136.024352712873, -30125.045845889104, -29925.146990008343, -29807.883216179467, -30049.684736767475, -29929.17314142955, -29975.45568071386, -29858.83328117909, -29977.68922812979, -29832.09875319912, -29669.795564855514, -29875.44341170331, -29998.48427884018, -29844.59518535603, -29913.48692848351, -29817.573410696103, -29919.96503199338, -30421.939916595737, -29974.20755043081, -29878.59461816494, -29790.736362038933, -29954.092227270135, -30121.575868762175, -29862.165744373986, -29935.3981530079, -29972.483681286023, -30081.021836307966, -29907.429103221653, -29987.41080214936, -29987.367854337004, -29763.511549675353, -29724.3035331757, -29863.22248768989, -29810.68328115103, -29920.182441782854, -29831.47106690145, -30089.354066681914, -29742.48222249411, -29820.000789343856, -29989.463119610067, -29898.082555198955, -29726.961135734775, -29899.760472305024, -29878.626196737107, -29668.54550266056, -29889.529191033496, -29710.267566470306, -30108.97802111229, -29843.573925247816, -29890.824278062966, -30156.884560109007, -30121.124559396467, -29782.770520284528, -29687.108916399684, -29797.444996422997, -29840.817085131093, -29832.19064666323, -30050.52425866646, -29816.89664344548, -29789.33945007267, -29973.415139792094], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.4000927968609655, "mean_inference_ms": 0.24980437775560907, "mean_action_processing_ms": 0.05893813133438404, "mean_env_wait_ms": 1.4753730691413793, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002469301223754883, "StateBufferConnector_ms": 0.0017342567443847656, "ViewRequirementAgentConnector_ms": 0.04464864730834961}}, "episode_reward_max": -29659.48732552499, "episode_reward_min": -30421.939916595737, "episode_reward_mean": -29913.11806160797, "episode_len_mean": 360.0, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-29895.261504209688, -29845.61078481126, -29991.366086599584, -29933.65605863185, -30190.95108830336, -30023.581809845524, -30159.735297225863, -29907.91758061034, -29942.070068756948, -29693.63520917123, -29812.873974677997, -29907.89440624365, -29810.298594569467, -29918.551763915988, -30027.357654211384, -29778.1883225291, -29980.16289108057, -29924.491264451637, -29914.166874096354, -29893.576942417283, -29913.08623008574, -30279.299033279745, -29882.02203689561, -29909.89398011046, -29921.702053421035, -29834.9640053065, -29769.254348493607, -29820.60178498895, -29659.48732552499, -30021.4878991273, -29956.863566987584, -29749.27073272009, -29878.241387697926, -30063.430100590835, -29982.972692807583, -30011.25451141636, -29796.36636034372, -30001.965895035664, -29859.151104067558, -30136.024352712873, -30125.045845889104, -29925.146990008343, -29807.883216179467, -30049.684736767475, -29929.17314142955, -29975.45568071386, -29858.83328117909, -29977.68922812979, -29832.09875319912, -29669.795564855514, -29875.44341170331, -29998.48427884018, -29844.59518535603, -29913.48692848351, -29817.573410696103, -29919.96503199338, -30421.939916595737, -29974.20755043081, -29878.59461816494, -29790.736362038933, -29954.092227270135, -30121.575868762175, -29862.165744373986, -29935.3981530079, -29972.483681286023, -30081.021836307966, -29907.429103221653, -29987.41080214936, -29987.367854337004, -29763.511549675353, -29724.3035331757, -29863.22248768989, -29810.68328115103, -29920.182441782854, -29831.47106690145, -30089.354066681914, -29742.48222249411, -29820.000789343856, -29989.463119610067, -29898.082555198955, -29726.961135734775, -29899.760472305024, -29878.626196737107, -29668.54550266056, -29889.529191033496, -29710.267566470306, -30108.97802111229, -29843.573925247816, -29890.824278062966, -30156.884560109007, -30121.124559396467, -29782.770520284528, -29687.108916399684, -29797.444996422997, -29840.817085131093, -29832.19064666323, -30050.52425866646, -29816.89664344548, -29789.33945007267, -29973.415139792094], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.4000927968609655, "mean_inference_ms": 0.24980437775560907, "mean_action_processing_ms": 0.05893813133438404, "mean_env_wait_ms": 1.4753730691413793, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002469301223754883, "StateBufferConnector_ms": 0.0017342567443847656, "ViewRequirementAgentConnector_ms": 0.04464864730834961}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 122040, "num_agent_steps_trained": 122040, "num_env_steps_sampled": 122040, "num_env_steps_trained": 122040, "num_env_steps_sampled_this_iter": 1800, "num_env_steps_trained_this_iter": 1800, "num_env_steps_sampled_throughput_per_sec": 161.28757856703857, "num_env_steps_trained_throughput_per_sec": 161.28757856703857, "timesteps_total": 122040, "num_steps_trained_this_iter": 1800, "agent_timesteps_total": 122040, "timers": {"training_iteration_time_ms": 2228.06, "sample_time_ms": 2222.554, "load_time_ms": 0.212, "load_throughput": 1699245.375, "learn_time_ms": 4.722, "learn_throughput": 76233.891, "synch_weights_time_ms": 0.539}, "counters": {"num_env_steps_sampled": 122040, "num_env_steps_trained": 122040, "num_agent_steps_sampled": 122040, "num_agent_steps_trained": 122040}, "done": false, "episodes_total": 339, "training_iteration": 68, "trial_id": "4935e_00000", "date": "2023-07-25_15-59-18", "timestamp": 1690289958, "time_this_iter_s": 11.162235021591187, "time_total_s": 758.7316122055054, "pid": 67353, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[0, 0.003], [5400, 0.001], [10800, 0.00075], [16200, 0.0005], [21600, 0.00025], [27000, 0.0001], [32400, 7.5e-05], [37800, 5e-05], [43200, 2.5e-05], [48600, 1e-05], [54000, 7.5e-06], [59400, 5e-06], [64800, 2.5e-06], [70200, 1e-06], [75600, 5e-07], [81000, 1e-07]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x177531310>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 758.7316122055054, "iterations_since_restore": 68, "perf": {"cpu_util_percent": 24.96875, "ram_util_percent": 78.53125}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-07, "entropy_coeff": 0.10000000000000002, "policy_entropy": -1859.8603108723958, "policy_loss": -1711702523904.0, "vf_loss": 2491957184.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 120.0, "num_grad_updates_lifetime": 1031.0, "diff_num_grad_updates_vs_sampler_policy": 1030.0}}, "num_env_steps_sampled": 123840, "num_env_steps_trained": 123840, "num_agent_steps_sampled": 123840, "num_agent_steps_trained": 123840}, "sampler_results": {"episode_reward_max": -29659.48732552499, "episode_reward_min": -30421.939916595737, "episode_reward_mean": -29908.226955034144, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-30023.581809845524, -30159.735297225863, -29907.91758061034, -29942.070068756948, -29693.63520917123, -29812.873974677997, -29907.89440624365, -29810.298594569467, -29918.551763915988, -30027.357654211384, -29778.1883225291, -29980.16289108057, -29924.491264451637, -29914.166874096354, -29893.576942417283, -29913.08623008574, -30279.299033279745, -29882.02203689561, -29909.89398011046, -29921.702053421035, -29834.9640053065, -29769.254348493607, -29820.60178498895, -29659.48732552499, -30021.4878991273, -29956.863566987584, -29749.27073272009, -29878.241387697926, -30063.430100590835, -29982.972692807583, -30011.25451141636, -29796.36636034372, -30001.965895035664, -29859.151104067558, -30136.024352712873, -30125.045845889104, -29925.146990008343, -29807.883216179467, -30049.684736767475, -29929.17314142955, -29975.45568071386, -29858.83328117909, -29977.68922812979, -29832.09875319912, -29669.795564855514, -29875.44341170331, -29998.48427884018, -29844.59518535603, -29913.48692848351, -29817.573410696103, -29919.96503199338, -30421.939916595737, -29974.20755043081, -29878.59461816494, -29790.736362038933, -29954.092227270135, -30121.575868762175, -29862.165744373986, -29935.3981530079, -29972.483681286023, -30081.021836307966, -29907.429103221653, -29987.41080214936, -29987.367854337004, -29763.511549675353, -29724.3035331757, -29863.22248768989, -29810.68328115103, -29920.182441782854, -29831.47106690145, -30089.354066681914, -29742.48222249411, -29820.000789343856, -29989.463119610067, -29898.082555198955, -29726.961135734775, -29899.760472305024, -29878.626196737107, -29668.54550266056, -29889.529191033496, -29710.267566470306, -30108.97802111229, -29843.573925247816, -29890.824278062966, -30156.884560109007, -30121.124559396467, -29782.770520284528, -29687.108916399684, -29797.444996422997, -29840.817085131093, -29832.19064666323, -30050.52425866646, -29816.89664344548, -29789.33945007267, -29973.415139792094, -30149.59453944091, -29907.539997490116, -29738.511837944392, -29717.39785991153, -29854.69063038665], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.400093684019044, "mean_inference_ms": 0.24979850634633727, "mean_action_processing_ms": 0.05893795858808829, "mean_env_wait_ms": 1.4749241394393129, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0024750232696533203, "StateBufferConnector_ms": 0.001737356185913086, "ViewRequirementAgentConnector_ms": 0.04471015930175781}}, "episode_reward_max": -29659.48732552499, "episode_reward_min": -30421.939916595737, "episode_reward_mean": -29908.226955034144, "episode_len_mean": 360.0, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-30023.581809845524, -30159.735297225863, -29907.91758061034, -29942.070068756948, -29693.63520917123, -29812.873974677997, -29907.89440624365, -29810.298594569467, -29918.551763915988, -30027.357654211384, -29778.1883225291, -29980.16289108057, -29924.491264451637, -29914.166874096354, -29893.576942417283, -29913.08623008574, -30279.299033279745, -29882.02203689561, -29909.89398011046, -29921.702053421035, -29834.9640053065, -29769.254348493607, -29820.60178498895, -29659.48732552499, -30021.4878991273, -29956.863566987584, -29749.27073272009, -29878.241387697926, -30063.430100590835, -29982.972692807583, -30011.25451141636, -29796.36636034372, -30001.965895035664, -29859.151104067558, -30136.024352712873, -30125.045845889104, -29925.146990008343, -29807.883216179467, -30049.684736767475, -29929.17314142955, -29975.45568071386, -29858.83328117909, -29977.68922812979, -29832.09875319912, -29669.795564855514, -29875.44341170331, -29998.48427884018, -29844.59518535603, -29913.48692848351, -29817.573410696103, -29919.96503199338, -30421.939916595737, -29974.20755043081, -29878.59461816494, -29790.736362038933, -29954.092227270135, -30121.575868762175, -29862.165744373986, -29935.3981530079, -29972.483681286023, -30081.021836307966, -29907.429103221653, -29987.41080214936, -29987.367854337004, -29763.511549675353, -29724.3035331757, -29863.22248768989, -29810.68328115103, -29920.182441782854, -29831.47106690145, -30089.354066681914, -29742.48222249411, -29820.000789343856, -29989.463119610067, -29898.082555198955, -29726.961135734775, -29899.760472305024, -29878.626196737107, -29668.54550266056, -29889.529191033496, -29710.267566470306, -30108.97802111229, -29843.573925247816, -29890.824278062966, -30156.884560109007, -30121.124559396467, -29782.770520284528, -29687.108916399684, -29797.444996422997, -29840.817085131093, -29832.19064666323, -30050.52425866646, -29816.89664344548, -29789.33945007267, -29973.415139792094, -30149.59453944091, -29907.539997490116, -29738.511837944392, -29717.39785991153, -29854.69063038665], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.400093684019044, "mean_inference_ms": 0.24979850634633727, "mean_action_processing_ms": 0.05893795858808829, "mean_env_wait_ms": 1.4749241394393129, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0024750232696533203, "StateBufferConnector_ms": 0.001737356185913086, "ViewRequirementAgentConnector_ms": 0.04471015930175781}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 123840, "num_agent_steps_trained": 123840, "num_env_steps_sampled": 123840, "num_env_steps_trained": 123840, "num_env_steps_sampled_this_iter": 1800, "num_env_steps_trained_this_iter": 1800, "num_env_steps_sampled_throughput_per_sec": 162.38417372789033, "num_env_steps_trained_throughput_per_sec": 162.38417372789033, "timesteps_total": 123840, "num_steps_trained_this_iter": 1800, "agent_timesteps_total": 123840, "timers": {"training_iteration_time_ms": 2224.492, "sample_time_ms": 2218.932, "load_time_ms": 0.217, "load_throughput": 1660562.455, "learn_time_ms": 4.78, "learn_throughput": 75309.575, "synch_weights_time_ms": 0.529}, "counters": {"num_env_steps_sampled": 123840, "num_env_steps_trained": 123840, "num_agent_steps_sampled": 123840, "num_agent_steps_trained": 123840}, "done": false, "episodes_total": 344, "training_iteration": 69, "trial_id": "4935e_00000", "date": "2023-07-25_15-59-29", "timestamp": 1690289969, "time_this_iter_s": 11.086846828460693, "time_total_s": 769.8184590339661, "pid": 67353, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[0, 0.003], [5400, 0.001], [10800, 0.00075], [16200, 0.0005], [21600, 0.00025], [27000, 0.0001], [32400, 7.5e-05], [37800, 5e-05], [43200, 2.5e-05], [48600, 1e-05], [54000, 7.5e-06], [59400, 5e-06], [64800, 2.5e-06], [70200, 1e-06], [75600, 5e-07], [81000, 1e-07]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x177531310>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 769.8184590339661, "iterations_since_restore": 69, "perf": {"cpu_util_percent": 25.220000000000002, "ram_util_percent": 78.72}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-07, "entropy_coeff": 0.10000000000000002, "policy_entropy": -1859.8597005208333, "policy_loss": -845707427840.0, "vf_loss": 2534003797.3333335}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 120.0, "num_grad_updates_lifetime": 1046.0, "diff_num_grad_updates_vs_sampler_policy": 1045.0}}, "num_env_steps_sampled": 125640, "num_env_steps_trained": 125640, "num_agent_steps_sampled": 125640, "num_agent_steps_trained": 125640}, "sampler_results": {"episode_reward_max": -29659.48732552499, "episode_reward_min": -30421.939916595737, "episode_reward_mean": -29908.512562326632, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-29812.873974677997, -29907.89440624365, -29810.298594569467, -29918.551763915988, -30027.357654211384, -29778.1883225291, -29980.16289108057, -29924.491264451637, -29914.166874096354, -29893.576942417283, -29913.08623008574, -30279.299033279745, -29882.02203689561, -29909.89398011046, -29921.702053421035, -29834.9640053065, -29769.254348493607, -29820.60178498895, -29659.48732552499, -30021.4878991273, -29956.863566987584, -29749.27073272009, -29878.241387697926, -30063.430100590835, -29982.972692807583, -30011.25451141636, -29796.36636034372, -30001.965895035664, -29859.151104067558, -30136.024352712873, -30125.045845889104, -29925.146990008343, -29807.883216179467, -30049.684736767475, -29929.17314142955, -29975.45568071386, -29858.83328117909, -29977.68922812979, -29832.09875319912, -29669.795564855514, -29875.44341170331, -29998.48427884018, -29844.59518535603, -29913.48692848351, -29817.573410696103, -29919.96503199338, -30421.939916595737, -29974.20755043081, -29878.59461816494, -29790.736362038933, -29954.092227270135, -30121.575868762175, -29862.165744373986, -29935.3981530079, -29972.483681286023, -30081.021836307966, -29907.429103221653, -29987.41080214936, -29987.367854337004, -29763.511549675353, -29724.3035331757, -29863.22248768989, -29810.68328115103, -29920.182441782854, -29831.47106690145, -30089.354066681914, -29742.48222249411, -29820.000789343856, -29989.463119610067, -29898.082555198955, -29726.961135734775, -29899.760472305024, -29878.626196737107, -29668.54550266056, -29889.529191033496, -29710.267566470306, -30108.97802111229, -29843.573925247816, -29890.824278062966, -30156.884560109007, -30121.124559396467, -29782.770520284528, -29687.108916399684, -29797.444996422997, -29840.817085131093, -29832.19064666323, -30050.52425866646, -29816.89664344548, -29789.33945007267, -29973.415139792094, -30149.59453944091, -29907.539997490116, -29738.511837944392, -29717.39785991153, -29854.69063038665, -29717.324579615626, -29982.331329465604, -30082.168226746213, -29687.143989206936, -30286.532569824314], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.400211604802849, "mean_inference_ms": 0.24984306985296648, "mean_action_processing_ms": 0.05894497381091424, "mean_env_wait_ms": 1.4746392391559373, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002500295639038086, "StateBufferConnector_ms": 0.001744985580444336, "ViewRequirementAgentConnector_ms": 0.04506397247314453}}, "episode_reward_max": -29659.48732552499, "episode_reward_min": -30421.939916595737, "episode_reward_mean": -29908.512562326632, "episode_len_mean": 360.0, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-29812.873974677997, -29907.89440624365, -29810.298594569467, -29918.551763915988, -30027.357654211384, -29778.1883225291, -29980.16289108057, -29924.491264451637, -29914.166874096354, -29893.576942417283, -29913.08623008574, -30279.299033279745, -29882.02203689561, -29909.89398011046, -29921.702053421035, -29834.9640053065, -29769.254348493607, -29820.60178498895, -29659.48732552499, -30021.4878991273, -29956.863566987584, -29749.27073272009, -29878.241387697926, -30063.430100590835, -29982.972692807583, -30011.25451141636, -29796.36636034372, -30001.965895035664, -29859.151104067558, -30136.024352712873, -30125.045845889104, -29925.146990008343, -29807.883216179467, -30049.684736767475, -29929.17314142955, -29975.45568071386, -29858.83328117909, -29977.68922812979, -29832.09875319912, -29669.795564855514, -29875.44341170331, -29998.48427884018, -29844.59518535603, -29913.48692848351, -29817.573410696103, -29919.96503199338, -30421.939916595737, -29974.20755043081, -29878.59461816494, -29790.736362038933, -29954.092227270135, -30121.575868762175, -29862.165744373986, -29935.3981530079, -29972.483681286023, -30081.021836307966, -29907.429103221653, -29987.41080214936, -29987.367854337004, -29763.511549675353, -29724.3035331757, -29863.22248768989, -29810.68328115103, -29920.182441782854, -29831.47106690145, -30089.354066681914, -29742.48222249411, -29820.000789343856, -29989.463119610067, -29898.082555198955, -29726.961135734775, -29899.760472305024, -29878.626196737107, -29668.54550266056, -29889.529191033496, -29710.267566470306, -30108.97802111229, -29843.573925247816, -29890.824278062966, -30156.884560109007, -30121.124559396467, -29782.770520284528, -29687.108916399684, -29797.444996422997, -29840.817085131093, -29832.19064666323, -30050.52425866646, -29816.89664344548, -29789.33945007267, -29973.415139792094, -30149.59453944091, -29907.539997490116, -29738.511837944392, -29717.39785991153, -29854.69063038665, -29717.324579615626, -29982.331329465604, -30082.168226746213, -29687.143989206936, -30286.532569824314], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.400211604802849, "mean_inference_ms": 0.24984306985296648, "mean_action_processing_ms": 0.05894497381091424, "mean_env_wait_ms": 1.4746392391559373, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002500295639038086, "StateBufferConnector_ms": 0.001744985580444336, "ViewRequirementAgentConnector_ms": 0.04506397247314453}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 125640, "num_agent_steps_trained": 125640, "num_env_steps_sampled": 125640, "num_env_steps_trained": 125640, "num_env_steps_sampled_this_iter": 1800, "num_env_steps_trained_this_iter": 1800, "num_env_steps_sampled_throughput_per_sec": 151.7550211639011, "num_env_steps_trained_throughput_per_sec": 151.7550211639011, "timesteps_total": 125640, "num_steps_trained_this_iter": 1800, "agent_timesteps_total": 125640, "timers": {"training_iteration_time_ms": 2294.593, "sample_time_ms": 2288.672, "load_time_ms": 0.232, "load_throughput": 1552008.881, "learn_time_ms": 5.068, "learn_throughput": 71033.379, "synch_weights_time_ms": 0.581}, "counters": {"num_env_steps_sampled": 125640, "num_env_steps_trained": 125640, "num_agent_steps_sampled": 125640, "num_agent_steps_trained": 125640}, "done": false, "episodes_total": 349, "training_iteration": 70, "trial_id": "4935e_00000", "date": "2023-07-25_15-59-41", "timestamp": 1690289981, "time_this_iter_s": 11.863569974899292, "time_total_s": 781.6820290088654, "pid": 67353, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[0, 0.003], [5400, 0.001], [10800, 0.00075], [16200, 0.0005], [21600, 0.00025], [27000, 0.0001], [32400, 7.5e-05], [37800, 5e-05], [43200, 2.5e-05], [48600, 1e-05], [54000, 7.5e-06], [59400, 5e-06], [64800, 2.5e-06], [70200, 1e-06], [75600, 5e-07], [81000, 1e-07]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x177531310>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 781.6820290088654, "iterations_since_restore": 70, "perf": {"cpu_util_percent": 31.064705882352936, "ram_util_percent": 79.2529411764706}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-07, "entropy_coeff": 0.10000000000000002, "policy_entropy": -1859.8603515625, "policy_loss": -812040781824.0, "vf_loss": 2503720405.3333335}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 120.0, "num_grad_updates_lifetime": 1061.0, "diff_num_grad_updates_vs_sampler_policy": 1060.0}}, "num_env_steps_sampled": 127440, "num_env_steps_trained": 127440, "num_agent_steps_sampled": 127440, "num_agent_steps_trained": 127440}, "sampler_results": {"episode_reward_max": -29659.48732552499, "episode_reward_min": -30421.939916595737, "episode_reward_mean": -29907.792389400867, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-29778.1883225291, -29980.16289108057, -29924.491264451637, -29914.166874096354, -29893.576942417283, -29913.08623008574, -30279.299033279745, -29882.02203689561, -29909.89398011046, -29921.702053421035, -29834.9640053065, -29769.254348493607, -29820.60178498895, -29659.48732552499, -30021.4878991273, -29956.863566987584, -29749.27073272009, -29878.241387697926, -30063.430100590835, -29982.972692807583, -30011.25451141636, -29796.36636034372, -30001.965895035664, -29859.151104067558, -30136.024352712873, -30125.045845889104, -29925.146990008343, -29807.883216179467, -30049.684736767475, -29929.17314142955, -29975.45568071386, -29858.83328117909, -29977.68922812979, -29832.09875319912, -29669.795564855514, -29875.44341170331, -29998.48427884018, -29844.59518535603, -29913.48692848351, -29817.573410696103, -29919.96503199338, -30421.939916595737, -29974.20755043081, -29878.59461816494, -29790.736362038933, -29954.092227270135, -30121.575868762175, -29862.165744373986, -29935.3981530079, -29972.483681286023, -30081.021836307966, -29907.429103221653, -29987.41080214936, -29987.367854337004, -29763.511549675353, -29724.3035331757, -29863.22248768989, -29810.68328115103, -29920.182441782854, -29831.47106690145, -30089.354066681914, -29742.48222249411, -29820.000789343856, -29989.463119610067, -29898.082555198955, -29726.961135734775, -29899.760472305024, -29878.626196737107, -29668.54550266056, -29889.529191033496, -29710.267566470306, -30108.97802111229, -29843.573925247816, -29890.824278062966, -30156.884560109007, -30121.124559396467, -29782.770520284528, -29687.108916399684, -29797.444996422997, -29840.817085131093, -29832.19064666323, -30050.52425866646, -29816.89664344548, -29789.33945007267, -29973.415139792094, -30149.59453944091, -29907.539997490116, -29738.511837944392, -29717.39785991153, -29854.69063038665, -29717.324579615626, -29982.331329465604, -30082.168226746213, -29687.143989206936, -30286.532569824314, -29959.506899356104, -29958.04864419184, -29770.28982717038, -29791.058852426595, -29926.054877896197], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.400320441486537, "mean_inference_ms": 0.24989317463744917, "mean_action_processing_ms": 0.058952966707369464, "mean_env_wait_ms": 1.474389626479844, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002505064010620117, "StateBufferConnector_ms": 0.0017535686492919922, "ViewRequirementAgentConnector_ms": 0.045148611068725586}}, "episode_reward_max": -29659.48732552499, "episode_reward_min": -30421.939916595737, "episode_reward_mean": -29907.792389400867, "episode_len_mean": 360.0, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-29778.1883225291, -29980.16289108057, -29924.491264451637, -29914.166874096354, -29893.576942417283, -29913.08623008574, -30279.299033279745, -29882.02203689561, -29909.89398011046, -29921.702053421035, -29834.9640053065, -29769.254348493607, -29820.60178498895, -29659.48732552499, -30021.4878991273, -29956.863566987584, -29749.27073272009, -29878.241387697926, -30063.430100590835, -29982.972692807583, -30011.25451141636, -29796.36636034372, -30001.965895035664, -29859.151104067558, -30136.024352712873, -30125.045845889104, -29925.146990008343, -29807.883216179467, -30049.684736767475, -29929.17314142955, -29975.45568071386, -29858.83328117909, -29977.68922812979, -29832.09875319912, -29669.795564855514, -29875.44341170331, -29998.48427884018, -29844.59518535603, -29913.48692848351, -29817.573410696103, -29919.96503199338, -30421.939916595737, -29974.20755043081, -29878.59461816494, -29790.736362038933, -29954.092227270135, -30121.575868762175, -29862.165744373986, -29935.3981530079, -29972.483681286023, -30081.021836307966, -29907.429103221653, -29987.41080214936, -29987.367854337004, -29763.511549675353, -29724.3035331757, -29863.22248768989, -29810.68328115103, -29920.182441782854, -29831.47106690145, -30089.354066681914, -29742.48222249411, -29820.000789343856, -29989.463119610067, -29898.082555198955, -29726.961135734775, -29899.760472305024, -29878.626196737107, -29668.54550266056, -29889.529191033496, -29710.267566470306, -30108.97802111229, -29843.573925247816, -29890.824278062966, -30156.884560109007, -30121.124559396467, -29782.770520284528, -29687.108916399684, -29797.444996422997, -29840.817085131093, -29832.19064666323, -30050.52425866646, -29816.89664344548, -29789.33945007267, -29973.415139792094, -30149.59453944091, -29907.539997490116, -29738.511837944392, -29717.39785991153, -29854.69063038665, -29717.324579615626, -29982.331329465604, -30082.168226746213, -29687.143989206936, -30286.532569824314, -29959.506899356104, -29958.04864419184, -29770.28982717038, -29791.058852426595, -29926.054877896197], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.400320441486537, "mean_inference_ms": 0.24989317463744917, "mean_action_processing_ms": 0.058952966707369464, "mean_env_wait_ms": 1.474389626479844, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002505064010620117, "StateBufferConnector_ms": 0.0017535686492919922, "ViewRequirementAgentConnector_ms": 0.045148611068725586}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 127440, "num_agent_steps_trained": 127440, "num_env_steps_sampled": 127440, "num_env_steps_trained": 127440, "num_env_steps_sampled_this_iter": 1800, "num_env_steps_trained_this_iter": 1800, "num_env_steps_sampled_throughput_per_sec": 159.5944044032281, "num_env_steps_trained_throughput_per_sec": 159.5944044032281, "timesteps_total": 127440, "num_steps_trained_this_iter": 1800, "agent_timesteps_total": 127440, "timers": {"training_iteration_time_ms": 2313.97, "sample_time_ms": 2308.227, "load_time_ms": 0.227, "load_throughput": 1583254.105, "learn_time_ms": 4.905, "learn_throughput": 73396.854, "synch_weights_time_ms": 0.572}, "counters": {"num_env_steps_sampled": 127440, "num_env_steps_trained": 127440, "num_agent_steps_sampled": 127440, "num_agent_steps_trained": 127440}, "done": false, "episodes_total": 354, "training_iteration": 71, "trial_id": "4935e_00000", "date": "2023-07-25_15-59-52", "timestamp": 1690289992, "time_this_iter_s": 11.280709743499756, "time_total_s": 792.9627387523651, "pid": 67353, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[0, 0.003], [5400, 0.001], [10800, 0.00075], [16200, 0.0005], [21600, 0.00025], [27000, 0.0001], [32400, 7.5e-05], [37800, 5e-05], [43200, 2.5e-05], [48600, 1e-05], [54000, 7.5e-06], [59400, 5e-06], [64800, 2.5e-06], [70200, 1e-06], [75600, 5e-07], [81000, 1e-07]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x177531310>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 792.9627387523651, "iterations_since_restore": 71, "perf": {"cpu_util_percent": 27.73125, "ram_util_percent": 78.40625}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-07, "entropy_coeff": 0.10000000000000002, "policy_entropy": -1859.8605143229167, "policy_loss": -4825857480021.333, "vf_loss": 2461505536.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 120.0, "num_grad_updates_lifetime": 1076.0, "diff_num_grad_updates_vs_sampler_policy": 1075.0}}, "num_env_steps_sampled": 129240, "num_env_steps_trained": 129240, "num_agent_steps_sampled": 129240, "num_agent_steps_trained": 129240}, "sampler_results": {"episode_reward_max": -29659.48732552499, "episode_reward_min": -30421.939916595737, "episode_reward_mean": -29908.80456274419, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-29913.08623008574, -30279.299033279745, -29882.02203689561, -29909.89398011046, -29921.702053421035, -29834.9640053065, -29769.254348493607, -29820.60178498895, -29659.48732552499, -30021.4878991273, -29956.863566987584, -29749.27073272009, -29878.241387697926, -30063.430100590835, -29982.972692807583, -30011.25451141636, -29796.36636034372, -30001.965895035664, -29859.151104067558, -30136.024352712873, -30125.045845889104, -29925.146990008343, -29807.883216179467, -30049.684736767475, -29929.17314142955, -29975.45568071386, -29858.83328117909, -29977.68922812979, -29832.09875319912, -29669.795564855514, -29875.44341170331, -29998.48427884018, -29844.59518535603, -29913.48692848351, -29817.573410696103, -29919.96503199338, -30421.939916595737, -29974.20755043081, -29878.59461816494, -29790.736362038933, -29954.092227270135, -30121.575868762175, -29862.165744373986, -29935.3981530079, -29972.483681286023, -30081.021836307966, -29907.429103221653, -29987.41080214936, -29987.367854337004, -29763.511549675353, -29724.3035331757, -29863.22248768989, -29810.68328115103, -29920.182441782854, -29831.47106690145, -30089.354066681914, -29742.48222249411, -29820.000789343856, -29989.463119610067, -29898.082555198955, -29726.961135734775, -29899.760472305024, -29878.626196737107, -29668.54550266056, -29889.529191033496, -29710.267566470306, -30108.97802111229, -29843.573925247816, -29890.824278062966, -30156.884560109007, -30121.124559396467, -29782.770520284528, -29687.108916399684, -29797.444996422997, -29840.817085131093, -29832.19064666323, -30050.52425866646, -29816.89664344548, -29789.33945007267, -29973.415139792094, -30149.59453944091, -29907.539997490116, -29738.511837944392, -29717.39785991153, -29854.69063038665, -29717.324579615626, -29982.331329465604, -30082.168226746213, -29687.143989206936, -30286.532569824314, -29959.506899356104, -29958.04864419184, -29770.28982717038, -29791.058852426595, -29926.054877896197, -29888.297217110598, -29777.370065151335, -30171.52137833329, -29945.340745334142, -29809.274222978987], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.400521331535584, "mean_inference_ms": 0.2499570437587743, "mean_action_processing_ms": 0.05896242733596632, "mean_env_wait_ms": 1.474184334761996, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0025124549865722656, "StateBufferConnector_ms": 0.0017504692077636719, "ViewRequirementAgentConnector_ms": 0.04511070251464844}}, "episode_reward_max": -29659.48732552499, "episode_reward_min": -30421.939916595737, "episode_reward_mean": -29908.80456274419, "episode_len_mean": 360.0, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-29913.08623008574, -30279.299033279745, -29882.02203689561, -29909.89398011046, -29921.702053421035, -29834.9640053065, -29769.254348493607, -29820.60178498895, -29659.48732552499, -30021.4878991273, -29956.863566987584, -29749.27073272009, -29878.241387697926, -30063.430100590835, -29982.972692807583, -30011.25451141636, -29796.36636034372, -30001.965895035664, -29859.151104067558, -30136.024352712873, -30125.045845889104, -29925.146990008343, -29807.883216179467, -30049.684736767475, -29929.17314142955, -29975.45568071386, -29858.83328117909, -29977.68922812979, -29832.09875319912, -29669.795564855514, -29875.44341170331, -29998.48427884018, -29844.59518535603, -29913.48692848351, -29817.573410696103, -29919.96503199338, -30421.939916595737, -29974.20755043081, -29878.59461816494, -29790.736362038933, -29954.092227270135, -30121.575868762175, -29862.165744373986, -29935.3981530079, -29972.483681286023, -30081.021836307966, -29907.429103221653, -29987.41080214936, -29987.367854337004, -29763.511549675353, -29724.3035331757, -29863.22248768989, -29810.68328115103, -29920.182441782854, -29831.47106690145, -30089.354066681914, -29742.48222249411, -29820.000789343856, -29989.463119610067, -29898.082555198955, -29726.961135734775, -29899.760472305024, -29878.626196737107, -29668.54550266056, -29889.529191033496, -29710.267566470306, -30108.97802111229, -29843.573925247816, -29890.824278062966, -30156.884560109007, -30121.124559396467, -29782.770520284528, -29687.108916399684, -29797.444996422997, -29840.817085131093, -29832.19064666323, -30050.52425866646, -29816.89664344548, -29789.33945007267, -29973.415139792094, -30149.59453944091, -29907.539997490116, -29738.511837944392, -29717.39785991153, -29854.69063038665, -29717.324579615626, -29982.331329465604, -30082.168226746213, -29687.143989206936, -30286.532569824314, -29959.506899356104, -29958.04864419184, -29770.28982717038, -29791.058852426595, -29926.054877896197, -29888.297217110598, -29777.370065151335, -30171.52137833329, -29945.340745334142, -29809.274222978987], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.400521331535584, "mean_inference_ms": 0.2499570437587743, "mean_action_processing_ms": 0.05896242733596632, "mean_env_wait_ms": 1.474184334761996, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0025124549865722656, "StateBufferConnector_ms": 0.0017504692077636719, "ViewRequirementAgentConnector_ms": 0.04511070251464844}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 129240, "num_agent_steps_trained": 129240, "num_env_steps_sampled": 129240, "num_env_steps_trained": 129240, "num_env_steps_sampled_this_iter": 1800, "num_env_steps_trained_this_iter": 1800, "num_env_steps_sampled_throughput_per_sec": 154.24678710550114, "num_env_steps_trained_throughput_per_sec": 154.24678710550114, "timesteps_total": 129240, "num_steps_trained_this_iter": 1800, "agent_timesteps_total": 129240, "timers": {"training_iteration_time_ms": 2294.81, "sample_time_ms": 2288.522, "load_time_ms": 0.223, "load_throughput": 1613883.54, "learn_time_ms": 5.451, "learn_throughput": 66042.209, "synch_weights_time_ms": 0.577}, "counters": {"num_env_steps_sampled": 129240, "num_env_steps_trained": 129240, "num_agent_steps_sampled": 129240, "num_agent_steps_trained": 129240}, "done": false, "episodes_total": 359, "training_iteration": 72, "trial_id": "4935e_00000", "date": "2023-07-25_16-00-04", "timestamp": 1690290004, "time_this_iter_s": 11.67168116569519, "time_total_s": 804.6344199180603, "pid": 67353, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[0, 0.003], [5400, 0.001], [10800, 0.00075], [16200, 0.0005], [21600, 0.00025], [27000, 0.0001], [32400, 7.5e-05], [37800, 5e-05], [43200, 2.5e-05], [48600, 1e-05], [54000, 7.5e-06], [59400, 5e-06], [64800, 2.5e-06], [70200, 1e-06], [75600, 5e-07], [81000, 1e-07]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x177531310>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 804.6344199180603, "iterations_since_restore": 72, "perf": {"cpu_util_percent": 34.55882352941177, "ram_util_percent": 79.6941176470588}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-07, "entropy_coeff": 0.10000000000000002, "policy_entropy": -1859.8601481119792, "policy_loss": -2579440429738.6665, "vf_loss": 2485023808.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 120.0, "num_grad_updates_lifetime": 1091.0, "diff_num_grad_updates_vs_sampler_policy": 1090.0}}, "num_env_steps_sampled": 131040, "num_env_steps_trained": 131040, "num_agent_steps_sampled": 131040, "num_agent_steps_trained": 131040}, "sampler_results": {"episode_reward_max": -29659.48732552499, "episode_reward_min": -30421.939916595737, "episode_reward_mean": -29904.84902435619, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-29834.9640053065, -29769.254348493607, -29820.60178498895, -29659.48732552499, -30021.4878991273, -29956.863566987584, -29749.27073272009, -29878.241387697926, -30063.430100590835, -29982.972692807583, -30011.25451141636, -29796.36636034372, -30001.965895035664, -29859.151104067558, -30136.024352712873, -30125.045845889104, -29925.146990008343, -29807.883216179467, -30049.684736767475, -29929.17314142955, -29975.45568071386, -29858.83328117909, -29977.68922812979, -29832.09875319912, -29669.795564855514, -29875.44341170331, -29998.48427884018, -29844.59518535603, -29913.48692848351, -29817.573410696103, -29919.96503199338, -30421.939916595737, -29974.20755043081, -29878.59461816494, -29790.736362038933, -29954.092227270135, -30121.575868762175, -29862.165744373986, -29935.3981530079, -29972.483681286023, -30081.021836307966, -29907.429103221653, -29987.41080214936, -29987.367854337004, -29763.511549675353, -29724.3035331757, -29863.22248768989, -29810.68328115103, -29920.182441782854, -29831.47106690145, -30089.354066681914, -29742.48222249411, -29820.000789343856, -29989.463119610067, -29898.082555198955, -29726.961135734775, -29899.760472305024, -29878.626196737107, -29668.54550266056, -29889.529191033496, -29710.267566470306, -30108.97802111229, -29843.573925247816, -29890.824278062966, -30156.884560109007, -30121.124559396467, -29782.770520284528, -29687.108916399684, -29797.444996422997, -29840.817085131093, -29832.19064666323, -30050.52425866646, -29816.89664344548, -29789.33945007267, -29973.415139792094, -30149.59453944091, -29907.539997490116, -29738.511837944392, -29717.39785991153, -29854.69063038665, -29717.324579615626, -29982.331329465604, -30082.168226746213, -29687.143989206936, -30286.532569824314, -29959.506899356104, -29958.04864419184, -29770.28982717038, -29791.058852426595, -29926.054877896197, -29888.297217110598, -29777.370065151335, -30171.52137833329, -29945.340745334142, -29809.274222978987, -30003.612159195603, -29749.4413232626, -29956.040516945835, -29859.41680316103, -29941.938692426713], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.4008909837429, "mean_inference_ms": 0.25003655843394185, "mean_action_processing_ms": 0.05897415502000981, "mean_env_wait_ms": 1.4740661623890952, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0025081634521484375, "StateBufferConnector_ms": 0.0017561912536621094, "ViewRequirementAgentConnector_ms": 0.045135498046875}}, "episode_reward_max": -29659.48732552499, "episode_reward_min": -30421.939916595737, "episode_reward_mean": -29904.84902435619, "episode_len_mean": 360.0, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-29834.9640053065, -29769.254348493607, -29820.60178498895, -29659.48732552499, -30021.4878991273, -29956.863566987584, -29749.27073272009, -29878.241387697926, -30063.430100590835, -29982.972692807583, -30011.25451141636, -29796.36636034372, -30001.965895035664, -29859.151104067558, -30136.024352712873, -30125.045845889104, -29925.146990008343, -29807.883216179467, -30049.684736767475, -29929.17314142955, -29975.45568071386, -29858.83328117909, -29977.68922812979, -29832.09875319912, -29669.795564855514, -29875.44341170331, -29998.48427884018, -29844.59518535603, -29913.48692848351, -29817.573410696103, -29919.96503199338, -30421.939916595737, -29974.20755043081, -29878.59461816494, -29790.736362038933, -29954.092227270135, -30121.575868762175, -29862.165744373986, -29935.3981530079, -29972.483681286023, -30081.021836307966, -29907.429103221653, -29987.41080214936, -29987.367854337004, -29763.511549675353, -29724.3035331757, -29863.22248768989, -29810.68328115103, -29920.182441782854, -29831.47106690145, -30089.354066681914, -29742.48222249411, -29820.000789343856, -29989.463119610067, -29898.082555198955, -29726.961135734775, -29899.760472305024, -29878.626196737107, -29668.54550266056, -29889.529191033496, -29710.267566470306, -30108.97802111229, -29843.573925247816, -29890.824278062966, -30156.884560109007, -30121.124559396467, -29782.770520284528, -29687.108916399684, -29797.444996422997, -29840.817085131093, -29832.19064666323, -30050.52425866646, -29816.89664344548, -29789.33945007267, -29973.415139792094, -30149.59453944091, -29907.539997490116, -29738.511837944392, -29717.39785991153, -29854.69063038665, -29717.324579615626, -29982.331329465604, -30082.168226746213, -29687.143989206936, -30286.532569824314, -29959.506899356104, -29958.04864419184, -29770.28982717038, -29791.058852426595, -29926.054877896197, -29888.297217110598, -29777.370065151335, -30171.52137833329, -29945.340745334142, -29809.274222978987, -30003.612159195603, -29749.4413232626, -29956.040516945835, -29859.41680316103, -29941.938692426713], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.4008909837429, "mean_inference_ms": 0.25003655843394185, "mean_action_processing_ms": 0.05897415502000981, "mean_env_wait_ms": 1.4740661623890952, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0025081634521484375, "StateBufferConnector_ms": 0.0017561912536621094, "ViewRequirementAgentConnector_ms": 0.045135498046875}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 131040, "num_agent_steps_trained": 131040, "num_env_steps_sampled": 131040, "num_env_steps_trained": 131040, "num_env_steps_sampled_this_iter": 1800, "num_env_steps_trained_this_iter": 1800, "num_env_steps_sampled_throughput_per_sec": 153.65231468681404, "num_env_steps_trained_throughput_per_sec": 153.65231468681404, "timesteps_total": 131040, "num_steps_trained_this_iter": 1800, "agent_timesteps_total": 131040, "timers": {"training_iteration_time_ms": 2338.426, "sample_time_ms": 2331.83, "load_time_ms": 0.235, "load_throughput": 1530923.086, "learn_time_ms": 5.677, "learn_throughput": 63413.146, "synch_weights_time_ms": 0.641}, "counters": {"num_env_steps_sampled": 131040, "num_env_steps_trained": 131040, "num_agent_steps_sampled": 131040, "num_agent_steps_trained": 131040}, "done": false, "episodes_total": 364, "training_iteration": 73, "trial_id": "4935e_00000", "date": "2023-07-25_16-00-15", "timestamp": 1690290015, "time_this_iter_s": 11.717957019805908, "time_total_s": 816.3523769378662, "pid": 67353, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[0, 0.003], [5400, 0.001], [10800, 0.00075], [16200, 0.0005], [21600, 0.00025], [27000, 0.0001], [32400, 7.5e-05], [37800, 5e-05], [43200, 2.5e-05], [48600, 1e-05], [54000, 7.5e-06], [59400, 5e-06], [64800, 2.5e-06], [70200, 1e-06], [75600, 5e-07], [81000, 1e-07]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x177531310>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 816.3523769378662, "iterations_since_restore": 73, "perf": {"cpu_util_percent": 36.44117647058823, "ram_util_percent": 79.40588235294118}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-07, "entropy_coeff": 0.10000000000000002, "policy_entropy": -1859.8604329427083, "policy_loss": -3344669883050.6665, "vf_loss": 2471147349.3333335}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 120.0, "num_grad_updates_lifetime": 1106.0, "diff_num_grad_updates_vs_sampler_policy": 1105.0}}, "num_env_steps_sampled": 132840, "num_env_steps_trained": 132840, "num_agent_steps_sampled": 132840, "num_agent_steps_trained": 132840}, "sampler_results": {"episode_reward_max": -29668.54550266056, "episode_reward_min": -30421.939916595737, "episode_reward_mean": -29906.067309069924, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-29956.863566987584, -29749.27073272009, -29878.241387697926, -30063.430100590835, -29982.972692807583, -30011.25451141636, -29796.36636034372, -30001.965895035664, -29859.151104067558, -30136.024352712873, -30125.045845889104, -29925.146990008343, -29807.883216179467, -30049.684736767475, -29929.17314142955, -29975.45568071386, -29858.83328117909, -29977.68922812979, -29832.09875319912, -29669.795564855514, -29875.44341170331, -29998.48427884018, -29844.59518535603, -29913.48692848351, -29817.573410696103, -29919.96503199338, -30421.939916595737, -29974.20755043081, -29878.59461816494, -29790.736362038933, -29954.092227270135, -30121.575868762175, -29862.165744373986, -29935.3981530079, -29972.483681286023, -30081.021836307966, -29907.429103221653, -29987.41080214936, -29987.367854337004, -29763.511549675353, -29724.3035331757, -29863.22248768989, -29810.68328115103, -29920.182441782854, -29831.47106690145, -30089.354066681914, -29742.48222249411, -29820.000789343856, -29989.463119610067, -29898.082555198955, -29726.961135734775, -29899.760472305024, -29878.626196737107, -29668.54550266056, -29889.529191033496, -29710.267566470306, -30108.97802111229, -29843.573925247816, -29890.824278062966, -30156.884560109007, -30121.124559396467, -29782.770520284528, -29687.108916399684, -29797.444996422997, -29840.817085131093, -29832.19064666323, -30050.52425866646, -29816.89664344548, -29789.33945007267, -29973.415139792094, -30149.59453944091, -29907.539997490116, -29738.511837944392, -29717.39785991153, -29854.69063038665, -29717.324579615626, -29982.331329465604, -30082.168226746213, -29687.143989206936, -30286.532569824314, -29959.506899356104, -29958.04864419184, -29770.28982717038, -29791.058852426595, -29926.054877896197, -29888.297217110598, -29777.370065151335, -30171.52137833329, -29945.340745334142, -29809.274222978987, -30003.612159195603, -29749.4413232626, -29956.040516945835, -29859.41680316103, -29941.938692426713, -29872.13589846417, -29735.48375069168, -29850.43818004308, -29969.41182719759, -29800.15417841809], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.401455526595865, "mean_inference_ms": 0.2501330342054818, "mean_action_processing_ms": 0.05898826439933008, "mean_env_wait_ms": 1.4740120031620672, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002510547637939453, "StateBufferConnector_ms": 0.0017666816711425781, "ViewRequirementAgentConnector_ms": 0.04523277282714844}}, "episode_reward_max": -29668.54550266056, "episode_reward_min": -30421.939916595737, "episode_reward_mean": -29906.067309069924, "episode_len_mean": 360.0, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-29956.863566987584, -29749.27073272009, -29878.241387697926, -30063.430100590835, -29982.972692807583, -30011.25451141636, -29796.36636034372, -30001.965895035664, -29859.151104067558, -30136.024352712873, -30125.045845889104, -29925.146990008343, -29807.883216179467, -30049.684736767475, -29929.17314142955, -29975.45568071386, -29858.83328117909, -29977.68922812979, -29832.09875319912, -29669.795564855514, -29875.44341170331, -29998.48427884018, -29844.59518535603, -29913.48692848351, -29817.573410696103, -29919.96503199338, -30421.939916595737, -29974.20755043081, -29878.59461816494, -29790.736362038933, -29954.092227270135, -30121.575868762175, -29862.165744373986, -29935.3981530079, -29972.483681286023, -30081.021836307966, -29907.429103221653, -29987.41080214936, -29987.367854337004, -29763.511549675353, -29724.3035331757, -29863.22248768989, -29810.68328115103, -29920.182441782854, -29831.47106690145, -30089.354066681914, -29742.48222249411, -29820.000789343856, -29989.463119610067, -29898.082555198955, -29726.961135734775, -29899.760472305024, -29878.626196737107, -29668.54550266056, -29889.529191033496, -29710.267566470306, -30108.97802111229, -29843.573925247816, -29890.824278062966, -30156.884560109007, -30121.124559396467, -29782.770520284528, -29687.108916399684, -29797.444996422997, -29840.817085131093, -29832.19064666323, -30050.52425866646, -29816.89664344548, -29789.33945007267, -29973.415139792094, -30149.59453944091, -29907.539997490116, -29738.511837944392, -29717.39785991153, -29854.69063038665, -29717.324579615626, -29982.331329465604, -30082.168226746213, -29687.143989206936, -30286.532569824314, -29959.506899356104, -29958.04864419184, -29770.28982717038, -29791.058852426595, -29926.054877896197, -29888.297217110598, -29777.370065151335, -30171.52137833329, -29945.340745334142, -29809.274222978987, -30003.612159195603, -29749.4413232626, -29956.040516945835, -29859.41680316103, -29941.938692426713, -29872.13589846417, -29735.48375069168, -29850.43818004308, -29969.41182719759, -29800.15417841809], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.401455526595865, "mean_inference_ms": 0.2501330342054818, "mean_action_processing_ms": 0.05898826439933008, "mean_env_wait_ms": 1.4740120031620672, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002510547637939453, "StateBufferConnector_ms": 0.0017666816711425781, "ViewRequirementAgentConnector_ms": 0.04523277282714844}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 132840, "num_agent_steps_trained": 132840, "num_env_steps_sampled": 132840, "num_env_steps_trained": 132840, "num_env_steps_sampled_this_iter": 1800, "num_env_steps_trained_this_iter": 1800, "num_env_steps_sampled_throughput_per_sec": 148.88497883465067, "num_env_steps_trained_throughput_per_sec": 148.88497883465067, "timesteps_total": 132840, "num_steps_trained_this_iter": 1800, "agent_timesteps_total": 132840, "timers": {"training_iteration_time_ms": 2380.451, "sample_time_ms": 2374.389, "load_time_ms": 0.261, "load_throughput": 1380588.315, "learn_time_ms": 5.091, "learn_throughput": 70713.691, "synch_weights_time_ms": 0.654}, "counters": {"num_env_steps_sampled": 132840, "num_env_steps_trained": 132840, "num_agent_steps_sampled": 132840, "num_agent_steps_trained": 132840}, "done": false, "episodes_total": 369, "training_iteration": 74, "trial_id": "4935e_00000", "date": "2023-07-25_16-00-27", "timestamp": 1690290027, "time_this_iter_s": 12.09230089187622, "time_total_s": 828.4446778297424, "pid": 67353, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[0, 0.003], [5400, 0.001], [10800, 0.00075], [16200, 0.0005], [21600, 0.00025], [27000, 0.0001], [32400, 7.5e-05], [37800, 5e-05], [43200, 2.5e-05], [48600, 1e-05], [54000, 7.5e-06], [59400, 5e-06], [64800, 2.5e-06], [70200, 1e-06], [75600, 5e-07], [81000, 1e-07]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x177531310>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 828.4446778297424, "iterations_since_restore": 74, "perf": {"cpu_util_percent": 46.28235294117647, "ram_util_percent": 81.30588235294117}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-07, "entropy_coeff": 0.10000000000000002, "policy_entropy": -1859.8603108723958, "policy_loss": -746291036160.0, "vf_loss": 2475980778.6666665}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 120.0, "num_grad_updates_lifetime": 1121.0, "diff_num_grad_updates_vs_sampler_policy": 1120.0}}, "num_env_steps_sampled": 134640, "num_env_steps_trained": 134640, "num_agent_steps_sampled": 134640, "num_agent_steps_trained": 134640}, "sampler_results": {"episode_reward_max": -29668.54550266056, "episode_reward_min": -30421.939916595737, "episode_reward_mean": -29909.58459500989, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-30011.25451141636, -29796.36636034372, -30001.965895035664, -29859.151104067558, -30136.024352712873, -30125.045845889104, -29925.146990008343, -29807.883216179467, -30049.684736767475, -29929.17314142955, -29975.45568071386, -29858.83328117909, -29977.68922812979, -29832.09875319912, -29669.795564855514, -29875.44341170331, -29998.48427884018, -29844.59518535603, -29913.48692848351, -29817.573410696103, -29919.96503199338, -30421.939916595737, -29974.20755043081, -29878.59461816494, -29790.736362038933, -29954.092227270135, -30121.575868762175, -29862.165744373986, -29935.3981530079, -29972.483681286023, -30081.021836307966, -29907.429103221653, -29987.41080214936, -29987.367854337004, -29763.511549675353, -29724.3035331757, -29863.22248768989, -29810.68328115103, -29920.182441782854, -29831.47106690145, -30089.354066681914, -29742.48222249411, -29820.000789343856, -29989.463119610067, -29898.082555198955, -29726.961135734775, -29899.760472305024, -29878.626196737107, -29668.54550266056, -29889.529191033496, -29710.267566470306, -30108.97802111229, -29843.573925247816, -29890.824278062966, -30156.884560109007, -30121.124559396467, -29782.770520284528, -29687.108916399684, -29797.444996422997, -29840.817085131093, -29832.19064666323, -30050.52425866646, -29816.89664344548, -29789.33945007267, -29973.415139792094, -30149.59453944091, -29907.539997490116, -29738.511837944392, -29717.39785991153, -29854.69063038665, -29717.324579615626, -29982.331329465604, -30082.168226746213, -29687.143989206936, -30286.532569824314, -29959.506899356104, -29958.04864419184, -29770.28982717038, -29791.058852426595, -29926.054877896197, -29888.297217110598, -29777.370065151335, -30171.52137833329, -29945.340745334142, -29809.274222978987, -30003.612159195603, -29749.4413232626, -29956.040516945835, -29859.41680316103, -29941.938692426713, -29872.13589846417, -29735.48375069168, -29850.43818004308, -29969.41182719759, -29800.15417841809, -30225.273671742467, -30073.53900158375, -29998.245710549963, -29857.55084602622, -29827.89784489894], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.402118213594884, "mean_inference_ms": 0.2502370857101544, "mean_action_processing_ms": 0.05900356236091742, "mean_env_wait_ms": 1.4739951908400764, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002526521682739258, "StateBufferConnector_ms": 0.0017664432525634766, "ViewRequirementAgentConnector_ms": 0.045476675033569336}}, "episode_reward_max": -29668.54550266056, "episode_reward_min": -30421.939916595737, "episode_reward_mean": -29909.58459500989, "episode_len_mean": 360.0, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-30011.25451141636, -29796.36636034372, -30001.965895035664, -29859.151104067558, -30136.024352712873, -30125.045845889104, -29925.146990008343, -29807.883216179467, -30049.684736767475, -29929.17314142955, -29975.45568071386, -29858.83328117909, -29977.68922812979, -29832.09875319912, -29669.795564855514, -29875.44341170331, -29998.48427884018, -29844.59518535603, -29913.48692848351, -29817.573410696103, -29919.96503199338, -30421.939916595737, -29974.20755043081, -29878.59461816494, -29790.736362038933, -29954.092227270135, -30121.575868762175, -29862.165744373986, -29935.3981530079, -29972.483681286023, -30081.021836307966, -29907.429103221653, -29987.41080214936, -29987.367854337004, -29763.511549675353, -29724.3035331757, -29863.22248768989, -29810.68328115103, -29920.182441782854, -29831.47106690145, -30089.354066681914, -29742.48222249411, -29820.000789343856, -29989.463119610067, -29898.082555198955, -29726.961135734775, -29899.760472305024, -29878.626196737107, -29668.54550266056, -29889.529191033496, -29710.267566470306, -30108.97802111229, -29843.573925247816, -29890.824278062966, -30156.884560109007, -30121.124559396467, -29782.770520284528, -29687.108916399684, -29797.444996422997, -29840.817085131093, -29832.19064666323, -30050.52425866646, -29816.89664344548, -29789.33945007267, -29973.415139792094, -30149.59453944091, -29907.539997490116, -29738.511837944392, -29717.39785991153, -29854.69063038665, -29717.324579615626, -29982.331329465604, -30082.168226746213, -29687.143989206936, -30286.532569824314, -29959.506899356104, -29958.04864419184, -29770.28982717038, -29791.058852426595, -29926.054877896197, -29888.297217110598, -29777.370065151335, -30171.52137833329, -29945.340745334142, -29809.274222978987, -30003.612159195603, -29749.4413232626, -29956.040516945835, -29859.41680316103, -29941.938692426713, -29872.13589846417, -29735.48375069168, -29850.43818004308, -29969.41182719759, -29800.15417841809, -30225.273671742467, -30073.53900158375, -29998.245710549963, -29857.55084602622, -29827.89784489894], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.402118213594884, "mean_inference_ms": 0.2502370857101544, "mean_action_processing_ms": 0.05900356236091742, "mean_env_wait_ms": 1.4739951908400764, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002526521682739258, "StateBufferConnector_ms": 0.0017664432525634766, "ViewRequirementAgentConnector_ms": 0.045476675033569336}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 134640, "num_agent_steps_trained": 134640, "num_env_steps_sampled": 134640, "num_env_steps_trained": 134640, "num_env_steps_sampled_this_iter": 1800, "num_env_steps_trained_this_iter": 1800, "num_env_steps_sampled_throughput_per_sec": 157.4479448716038, "num_env_steps_trained_throughput_per_sec": 157.4479448716038, "timesteps_total": 134640, "num_steps_trained_this_iter": 1800, "agent_timesteps_total": 134640, "timers": {"training_iteration_time_ms": 2352.21, "sample_time_ms": 2345.597, "load_time_ms": 0.253, "load_throughput": 1420995.144, "learn_time_ms": 5.653, "learn_throughput": 63687.836, "synch_weights_time_ms": 0.655}, "counters": {"num_env_steps_sampled": 134640, "num_env_steps_trained": 134640, "num_agent_steps_sampled": 134640, "num_agent_steps_trained": 134640}, "done": false, "episodes_total": 374, "training_iteration": 75, "trial_id": "4935e_00000", "date": "2023-07-25_16-00-39", "timestamp": 1690290039, "time_this_iter_s": 11.434574127197266, "time_total_s": 839.8792519569397, "pid": 67353, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[0, 0.003], [5400, 0.001], [10800, 0.00075], [16200, 0.0005], [21600, 0.00025], [27000, 0.0001], [32400, 7.5e-05], [37800, 5e-05], [43200, 2.5e-05], [48600, 1e-05], [54000, 7.5e-06], [59400, 5e-06], [64800, 2.5e-06], [70200, 1e-06], [75600, 5e-07], [81000, 1e-07]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x177531310>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 839.8792519569397, "iterations_since_restore": 75, "perf": {"cpu_util_percent": 34.224999999999994, "ram_util_percent": 81.8}}
