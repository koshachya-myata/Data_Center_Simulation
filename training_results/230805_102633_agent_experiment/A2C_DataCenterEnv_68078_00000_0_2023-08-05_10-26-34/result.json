{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-12, "entropy_coeff": 0.1, "policy_entropy": -322.4460083007813, "policy_loss": -3697910.275, "vf_loss": 21072794.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 13.0, "diff_num_grad_updates_vs_sampler_policy": 12.0}}, "num_env_steps_sampled": 1380240, "num_env_steps_trained": 1380240, "num_agent_steps_sampled": 1380240, "num_agent_steps_trained": 1380240}, "sampler_results": {"episode_reward_max": -3549.0042802439984, "episode_reward_min": -3556.9165450507317, "episode_reward_mean": -3551.6526204725815, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3549.037036123015, -3549.0042802439984, -3556.9165450507317], "episode_lengths": [360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.269147366533448, "mean_inference_ms": 0.37643669050783063, "mean_action_processing_ms": 0.09262815434881981, "mean_env_wait_ms": 3.6458947060838214, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0034809112548828125, "StateBufferConnector_ms": 0.0031550725301106772, "ViewRequirementAgentConnector_ms": 0.06951491038004558}}, "episode_reward_max": -3549.0042802439984, "episode_reward_min": -3556.9165450507317, "episode_reward_mean": -3551.6526204725815, "episode_len_mean": 360.0, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-3549.037036123015, -3549.0042802439984, -3556.9165450507317], "episode_lengths": [360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.269147366533448, "mean_inference_ms": 0.37643669050783063, "mean_action_processing_ms": 0.09262815434881981, "mean_env_wait_ms": 3.6458947060838214, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0034809112548828125, "StateBufferConnector_ms": 0.0031550725301106772, "ViewRequirementAgentConnector_ms": 0.06951491038004558}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1380240, "num_agent_steps_trained": 1380240, "num_env_steps_sampled": 1380240, "num_env_steps_trained": 1380240, "num_env_steps_sampled_this_iter": 1080, "num_env_steps_trained_this_iter": 1080, "num_env_steps_sampled_throughput_per_sec": 87.22912994367428, "num_env_steps_trained_throughput_per_sec": 87.22912994367428, "timesteps_total": 1380240, "num_steps_trained_this_iter": 1080, "agent_timesteps_total": 1380240, "timers": {"training_iteration_time_ms": 4127.046, "sample_time_ms": 4111.56, "load_time_ms": 0.388, "load_throughput": 926728.38, "learn_time_ms": 14.298, "learn_throughput": 25178.133, "synch_weights_time_ms": 0.753}, "counters": {"num_env_steps_sampled": 1380240, "num_env_steps_trained": 1380240, "num_agent_steps_sampled": 1380240, "num_agent_steps_trained": 1380240}, "done": false, "episodes_total": 5234, "training_iteration": 1101, "trial_id": "68078_00000", "date": "2023-08-05_10-26-53", "timestamp": 1691220413, "time_this_iter_s": 12.383676052093506, "time_total_s": 14294.59102344513, "pid": 54946, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[1400000, 5e-09], [1405400, 8e-09], [1410800, 2.5e-09], [1416200, 2.5e-09], [1421600, 2.5e-09], [1427000, 2.5e-09], [1432400, 1e-09], [1437800, 1e-09], [1443200, 1e-09], [1448600, 5e-10], [1454000, 5e-10], [1459400, 5e-10], [1464800, 5e-10], [1470200, 1e-10], [1475600, 1e-10], [1481000, 1e-10], [1486400, 1e-10], [1491800, 5e-11], [1497200, 5e-11], [1502600, 2.5e-11], [1508000, 2.5e-11], [1513400, 1e-11], [1518800, 1e-11], [1524200, 5e-12], [1529600, 5e-12], [1535000, 1e-12]], "grad_clip": 5, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.2, "final_epsilon": 0.01, "epsilon_timesteps": 1401170}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x3061b8b80>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 12.383676052093506, "iterations_since_restore": 1, "perf": {"cpu_util_percent": 30.005555555555556, "ram_util_percent": 68.18333333333332}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-12, "entropy_coeff": 0.1, "policy_entropy": -322.55332641601564, "policy_loss": -9284715.73125, "vf_loss": 21051369.4}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 33.0, "diff_num_grad_updates_vs_sampler_policy": 32.0}}, "num_env_steps_sampled": 1381680, "num_env_steps_trained": 1381680, "num_agent_steps_sampled": 1381680, "num_agent_steps_trained": 1381680}, "sampler_results": {"episode_reward_max": -3549.0042802439984, "episode_reward_min": -3579.5606359965905, "episode_reward_mean": -3557.7219690083293, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3549.037036123015, -3549.0042802439984, -3556.9165450507317, -3556.425604484131, -3579.5606359965905, -3554.5587335093637, -3558.5509476504776], "episode_lengths": [360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.29049622663968, "mean_inference_ms": 0.3758022687551344, "mean_action_processing_ms": 0.0923219907308346, "mean_env_wait_ms": 2.769915978510153, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0038521630423409598, "StateBufferConnector_ms": 0.0029359545026506695, "ViewRequirementAgentConnector_ms": 0.06858280726841517}}, "episode_reward_max": -3549.0042802439984, "episode_reward_min": -3579.5606359965905, "episode_reward_mean": -3557.7219690083293, "episode_len_mean": 360.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-3549.037036123015, -3549.0042802439984, -3556.9165450507317, -3556.425604484131, -3579.5606359965905, -3554.5587335093637, -3558.5509476504776], "episode_lengths": [360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.29049622663968, "mean_inference_ms": 0.3758022687551344, "mean_action_processing_ms": 0.0923219907308346, "mean_env_wait_ms": 2.769915978510153, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0038521630423409598, "StateBufferConnector_ms": 0.0029359545026506695, "ViewRequirementAgentConnector_ms": 0.06858280726841517}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1381680, "num_agent_steps_trained": 1381680, "num_env_steps_sampled": 1381680, "num_env_steps_trained": 1381680, "num_env_steps_sampled_this_iter": 1440, "num_env_steps_trained_this_iter": 1440, "num_env_steps_sampled_throughput_per_sec": 113.38112870863506, "num_env_steps_trained_throughput_per_sec": 113.38112870863506, "timesteps_total": 1381680, "num_steps_trained_this_iter": 1440, "agent_timesteps_total": 1381680, "timers": {"training_iteration_time_ms": 3583.087, "sample_time_ms": 3570.079, "load_time_ms": 0.34, "load_throughput": 1060357.753, "learn_time_ms": 11.885, "learn_throughput": 30291.334, "synch_weights_time_ms": 0.737}, "counters": {"num_env_steps_sampled": 1381680, "num_env_steps_trained": 1381680, "num_agent_steps_sampled": 1381680, "num_agent_steps_trained": 1381680}, "done": false, "episodes_total": 5238, "training_iteration": 1102, "trial_id": "68078_00000", "date": "2023-08-05_10-27-06", "timestamp": 1691220426, "time_this_iter_s": 12.7030930519104, "time_total_s": 14307.29411649704, "pid": 54946, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[1400000, 5e-09], [1405400, 8e-09], [1410800, 2.5e-09], [1416200, 2.5e-09], [1421600, 2.5e-09], [1427000, 2.5e-09], [1432400, 1e-09], [1437800, 1e-09], [1443200, 1e-09], [1448600, 5e-10], [1454000, 5e-10], [1459400, 5e-10], [1464800, 5e-10], [1470200, 1e-10], [1475600, 1e-10], [1481000, 1e-10], [1486400, 1e-10], [1491800, 5e-11], [1497200, 5e-11], [1502600, 2.5e-11], [1508000, 2.5e-11], [1513400, 1e-11], [1518800, 1e-11], [1524200, 5e-12], [1529600, 5e-12], [1535000, 1e-12]], "grad_clip": 5, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.2, "final_epsilon": 0.01, "epsilon_timesteps": 1401170}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x3061b8b80>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 25.086769104003906, "iterations_since_restore": 2, "perf": {"cpu_util_percent": 23.705555555555556, "ram_util_percent": 68.25}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-12, "entropy_coeff": 0.1, "policy_entropy": -322.2617553710937, "policy_loss": -6094411.95625, "vf_loss": 20978958.6}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 53.0, "diff_num_grad_updates_vs_sampler_policy": 52.0}}, "num_env_steps_sampled": 1383120, "num_env_steps_trained": 1383120, "num_agent_steps_sampled": 1383120, "num_agent_steps_trained": 1383120}, "sampler_results": {"episode_reward_max": -3545.6724673899225, "episode_reward_min": -3618.2340839301255, "episode_reward_mean": -3561.366333304973, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3549.037036123015, -3549.0042802439984, -3556.9165450507317, -3556.425604484131, -3579.5606359965905, -3554.5587335093637, -3558.5509476504776, -3558.1416054821716, -3545.6724673899225, -3618.2340839301255, -3548.927726494181], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.314842331837216, "mean_inference_ms": 0.38117984614237027, "mean_action_processing_ms": 0.09321676170502653, "mean_env_wait_ms": 2.3832950020208497, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003964250737970526, "StateBufferConnector_ms": 0.0028155066750266337, "ViewRequirementAgentConnector_ms": 0.06739226254549893}}, "episode_reward_max": -3545.6724673899225, "episode_reward_min": -3618.2340839301255, "episode_reward_mean": -3561.366333304973, "episode_len_mean": 360.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-3549.037036123015, -3549.0042802439984, -3556.9165450507317, -3556.425604484131, -3579.5606359965905, -3554.5587335093637, -3558.5509476504776, -3558.1416054821716, -3545.6724673899225, -3618.2340839301255, -3548.927726494181], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.314842331837216, "mean_inference_ms": 0.38117984614237027, "mean_action_processing_ms": 0.09321676170502653, "mean_env_wait_ms": 2.3832950020208497, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003964250737970526, "StateBufferConnector_ms": 0.0028155066750266337, "ViewRequirementAgentConnector_ms": 0.06739226254549893}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1383120, "num_agent_steps_trained": 1383120, "num_env_steps_sampled": 1383120, "num_env_steps_trained": 1383120, "num_env_steps_sampled_this_iter": 1440, "num_env_steps_trained_this_iter": 1440, "num_env_steps_sampled_throughput_per_sec": 110.8766424841018, "num_env_steps_trained_throughput_per_sec": 110.8766424841018, "timesteps_total": 1383120, "num_steps_trained_this_iter": 1440, "agent_timesteps_total": 1383120, "timers": {"training_iteration_time_ms": 3200.903, "sample_time_ms": 3189.552, "load_time_ms": 0.301, "load_throughput": 1194958.405, "learn_time_ms": 10.249, "learn_throughput": 35126.05, "synch_weights_time_ms": 0.755}, "counters": {"num_env_steps_sampled": 1383120, "num_env_steps_trained": 1383120, "num_agent_steps_sampled": 1383120, "num_agent_steps_trained": 1383120}, "done": false, "episodes_total": 5242, "training_iteration": 1103, "trial_id": "68078_00000", "date": "2023-08-05_10-27-19", "timestamp": 1691220439, "time_this_iter_s": 12.98995304107666, "time_total_s": 14320.284069538116, "pid": 54946, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[1400000, 5e-09], [1405400, 8e-09], [1410800, 2.5e-09], [1416200, 2.5e-09], [1421600, 2.5e-09], [1427000, 2.5e-09], [1432400, 1e-09], [1437800, 1e-09], [1443200, 1e-09], [1448600, 5e-10], [1454000, 5e-10], [1459400, 5e-10], [1464800, 5e-10], [1470200, 1e-10], [1475600, 1e-10], [1481000, 1e-10], [1486400, 1e-10], [1491800, 5e-11], [1497200, 5e-11], [1502600, 2.5e-11], [1508000, 2.5e-11], [1513400, 1e-11], [1518800, 1e-11], [1524200, 5e-12], [1529600, 5e-12], [1535000, 1e-12]], "grad_clip": 5, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.2, "final_epsilon": 0.01, "epsilon_timesteps": 1401170}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x3061b8b80>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 38.076722145080566, "iterations_since_restore": 3, "perf": {"cpu_util_percent": 26.61052631578947, "ram_util_percent": 68.76842105263158}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-12, "entropy_coeff": 0.1, "policy_entropy": -322.30438232421875, "policy_loss": -3272465.746875, "vf_loss": 20944296.8}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 73.0, "diff_num_grad_updates_vs_sampler_policy": 72.0}}, "num_env_steps_sampled": 1384560, "num_env_steps_trained": 1384560, "num_agent_steps_sampled": 1384560, "num_agent_steps_trained": 1384560}, "sampler_results": {"episode_reward_max": -3545.5010284891423, "episode_reward_min": -3618.2340839301255, "episode_reward_mean": -3557.937576877217, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3549.037036123015, -3549.0042802439984, -3556.9165450507317, -3556.425604484131, -3579.5606359965905, -3554.5587335093637, -3558.5509476504776, -3558.1416054821716, -3545.6724673899225, -3618.2340839301255, -3548.927726494181, -3547.552260505779, -3546.921394619684, -3554.0593031889484, -3545.5010284891423], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.338331102327374, "mean_inference_ms": 0.38198053454190467, "mean_action_processing_ms": 0.09329994041653779, "mean_env_wait_ms": 2.1489863799592315, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0037860870361328125, "StateBufferConnector_ms": 0.0027338663736979165, "ViewRequirementAgentConnector_ms": 0.06636301676432292}}, "episode_reward_max": -3545.5010284891423, "episode_reward_min": -3618.2340839301255, "episode_reward_mean": -3557.937576877217, "episode_len_mean": 360.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-3549.037036123015, -3549.0042802439984, -3556.9165450507317, -3556.425604484131, -3579.5606359965905, -3554.5587335093637, -3558.5509476504776, -3558.1416054821716, -3545.6724673899225, -3618.2340839301255, -3548.927726494181, -3547.552260505779, -3546.921394619684, -3554.0593031889484, -3545.5010284891423], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.338331102327374, "mean_inference_ms": 0.38198053454190467, "mean_action_processing_ms": 0.09329994041653779, "mean_env_wait_ms": 2.1489863799592315, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0037860870361328125, "StateBufferConnector_ms": 0.0027338663736979165, "ViewRequirementAgentConnector_ms": 0.06636301676432292}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1384560, "num_agent_steps_trained": 1384560, "num_env_steps_sampled": 1384560, "num_env_steps_trained": 1384560, "num_env_steps_sampled_this_iter": 1440, "num_env_steps_trained_this_iter": 1440, "num_env_steps_sampled_throughput_per_sec": 111.2564899796729, "num_env_steps_trained_throughput_per_sec": 111.2564899796729, "timesteps_total": 1384560, "num_steps_trained_this_iter": 1440, "agent_timesteps_total": 1384560, "timers": {"training_iteration_time_ms": 3222.485, "sample_time_ms": 3211.294, "load_time_ms": 0.294, "load_throughput": 1224514.995, "learn_time_ms": 10.103, "learn_throughput": 35632.437, "synch_weights_time_ms": 0.749}, "counters": {"num_env_steps_sampled": 1384560, "num_env_steps_trained": 1384560, "num_agent_steps_sampled": 1384560, "num_agent_steps_trained": 1384560}, "done": false, "episodes_total": 5246, "training_iteration": 1104, "trial_id": "68078_00000", "date": "2023-08-05_10-27-32", "timestamp": 1691220452, "time_this_iter_s": 12.945527076721191, "time_total_s": 14333.229596614838, "pid": 54946, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[1400000, 5e-09], [1405400, 8e-09], [1410800, 2.5e-09], [1416200, 2.5e-09], [1421600, 2.5e-09], [1427000, 2.5e-09], [1432400, 1e-09], [1437800, 1e-09], [1443200, 1e-09], [1448600, 5e-10], [1454000, 5e-10], [1459400, 5e-10], [1464800, 5e-10], [1470200, 1e-10], [1475600, 1e-10], [1481000, 1e-10], [1486400, 1e-10], [1491800, 5e-11], [1497200, 5e-11], [1502600, 2.5e-11], [1508000, 2.5e-11], [1513400, 1e-11], [1518800, 1e-11], [1524200, 5e-12], [1529600, 5e-12], [1535000, 1e-12]], "grad_clip": 5, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.2, "final_epsilon": 0.01, "epsilon_timesteps": 1401170}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x3061b8b80>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 51.02224922180176, "iterations_since_restore": 4, "perf": {"cpu_util_percent": 20.738888888888894, "ram_util_percent": 68.57777777777778}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-12, "entropy_coeff": 0.1, "policy_entropy": -322.2744995117188, "policy_loss": -3853428.7421875, "vf_loss": 20926680.3}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 93.0, "diff_num_grad_updates_vs_sampler_policy": 92.0}}, "num_env_steps_sampled": 1386000, "num_env_steps_trained": 1386000, "num_agent_steps_sampled": 1386000, "num_agent_steps_trained": 1386000}, "sampler_results": {"episode_reward_max": -3541.0547551462187, "episode_reward_min": -3618.2340839301255, "episode_reward_mean": -3555.2410181431255, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3549.037036123015, -3549.0042802439984, -3556.9165450507317, -3556.425604484131, -3579.5606359965905, -3554.5587335093637, -3558.5509476504776, -3558.1416054821716, -3545.6724673899225, -3618.2340839301255, -3548.927726494181, -3547.552260505779, -3546.921394619684, -3554.0593031889484, -3545.5010284891423, -3550.7689397104114, -3545.753746589813, -3541.0547551462187, -3542.938250114688], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.351750139673942, "mean_inference_ms": 0.38180651418069717, "mean_action_processing_ms": 0.09322138904402613, "mean_env_wait_ms": 1.9875438483664376, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003681684795178865, "StateBufferConnector_ms": 0.0027455781635485196, "ViewRequirementAgentConnector_ms": 0.06627911015560753}}, "episode_reward_max": -3541.0547551462187, "episode_reward_min": -3618.2340839301255, "episode_reward_mean": -3555.2410181431255, "episode_len_mean": 360.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-3549.037036123015, -3549.0042802439984, -3556.9165450507317, -3556.425604484131, -3579.5606359965905, -3554.5587335093637, -3558.5509476504776, -3558.1416054821716, -3545.6724673899225, -3618.2340839301255, -3548.927726494181, -3547.552260505779, -3546.921394619684, -3554.0593031889484, -3545.5010284891423, -3550.7689397104114, -3545.753746589813, -3541.0547551462187, -3542.938250114688], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.351750139673942, "mean_inference_ms": 0.38180651418069717, "mean_action_processing_ms": 0.09322138904402613, "mean_env_wait_ms": 1.9875438483664376, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003681684795178865, "StateBufferConnector_ms": 0.0027455781635485196, "ViewRequirementAgentConnector_ms": 0.06627911015560753}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1386000, "num_agent_steps_trained": 1386000, "num_env_steps_sampled": 1386000, "num_env_steps_trained": 1386000, "num_env_steps_sampled_this_iter": 1440, "num_env_steps_trained_this_iter": 1440, "num_env_steps_sampled_throughput_per_sec": 113.1629236245537, "num_env_steps_trained_throughput_per_sec": 113.1629236245537, "timesteps_total": 1386000, "num_steps_trained_this_iter": 1440, "agent_timesteps_total": 1386000, "timers": {"training_iteration_time_ms": 3207.431, "sample_time_ms": 3196.81, "load_time_ms": 0.299, "load_throughput": 1203626.497, "learn_time_ms": 9.586, "learn_throughput": 37555.887, "synch_weights_time_ms": 0.691}, "counters": {"num_env_steps_sampled": 1386000, "num_env_steps_trained": 1386000, "num_agent_steps_sampled": 1386000, "num_agent_steps_trained": 1386000}, "done": false, "episodes_total": 5250, "training_iteration": 1105, "trial_id": "68078_00000", "date": "2023-08-05_10-27-45", "timestamp": 1691220465, "time_this_iter_s": 12.727544784545898, "time_total_s": 14345.957141399384, "pid": 54946, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[1400000, 5e-09], [1405400, 8e-09], [1410800, 2.5e-09], [1416200, 2.5e-09], [1421600, 2.5e-09], [1427000, 2.5e-09], [1432400, 1e-09], [1437800, 1e-09], [1443200, 1e-09], [1448600, 5e-10], [1454000, 5e-10], [1459400, 5e-10], [1464800, 5e-10], [1470200, 1e-10], [1475600, 1e-10], [1481000, 1e-10], [1486400, 1e-10], [1491800, 5e-11], [1497200, 5e-11], [1502600, 2.5e-11], [1508000, 2.5e-11], [1513400, 1e-11], [1518800, 1e-11], [1524200, 5e-12], [1529600, 5e-12], [1535000, 1e-12]], "grad_clip": 5, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.2, "final_epsilon": 0.01, "epsilon_timesteps": 1401170}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x3061b8b80>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 63.749794006347656, "iterations_since_restore": 5, "perf": {"cpu_util_percent": 22.005555555555556, "ram_util_percent": 68.69444444444443}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-12, "entropy_coeff": 0.1, "policy_entropy": -322.4094482421875, "policy_loss": -2416090.18125, "vf_loss": 20920165.2}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 113.0, "diff_num_grad_updates_vs_sampler_policy": 112.0}}, "num_env_steps_sampled": 1387440, "num_env_steps_trained": 1387440, "num_agent_steps_sampled": 1387440, "num_agent_steps_trained": 1387440}, "sampler_results": {"episode_reward_max": -3541.0547551462187, "episode_reward_min": -3618.2340839301255, "episode_reward_mean": -3553.8308304043203, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3549.037036123015, -3549.0042802439984, -3556.9165450507317, -3556.425604484131, -3579.5606359965905, -3554.5587335093637, -3558.5509476504776, -3558.1416054821716, -3545.6724673899225, -3618.2340839301255, -3548.927726494181, -3547.552260505779, -3546.921394619684, -3554.0593031889484, -3545.5010284891423, -3550.7689397104114, -3545.753746589813, -3541.0547551462187, -3542.938250114688, -3545.993290424746, -3545.1354260959706, -3553.362149148736, -3544.0388889105407], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.364490335755142, "mean_inference_ms": 0.38129450110999796, "mean_action_processing_ms": 0.09309668912815457, "mean_env_wait_ms": 1.8689187517836472, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0037514645120371943, "StateBufferConnector_ms": 0.0027252280193826427, "ViewRequirementAgentConnector_ms": 0.06588852923849355}}, "episode_reward_max": -3541.0547551462187, "episode_reward_min": -3618.2340839301255, "episode_reward_mean": -3553.8308304043203, "episode_len_mean": 360.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-3549.037036123015, -3549.0042802439984, -3556.9165450507317, -3556.425604484131, -3579.5606359965905, -3554.5587335093637, -3558.5509476504776, -3558.1416054821716, -3545.6724673899225, -3618.2340839301255, -3548.927726494181, -3547.552260505779, -3546.921394619684, -3554.0593031889484, -3545.5010284891423, -3550.7689397104114, -3545.753746589813, -3541.0547551462187, -3542.938250114688, -3545.993290424746, -3545.1354260959706, -3553.362149148736, -3544.0388889105407], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.364490335755142, "mean_inference_ms": 0.38129450110999796, "mean_action_processing_ms": 0.09309668912815457, "mean_env_wait_ms": 1.8689187517836472, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0037514645120371943, "StateBufferConnector_ms": 0.0027252280193826427, "ViewRequirementAgentConnector_ms": 0.06588852923849355}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1387440, "num_agent_steps_trained": 1387440, "num_env_steps_sampled": 1387440, "num_env_steps_trained": 1387440, "num_env_steps_sampled_this_iter": 1440, "num_env_steps_trained_this_iter": 1440, "num_env_steps_sampled_throughput_per_sec": 111.24670901784046, "num_env_steps_trained_throughput_per_sec": 111.24670901784046, "timesteps_total": 1387440, "num_steps_trained_this_iter": 1440, "agent_timesteps_total": 1387440, "timers": {"training_iteration_time_ms": 3216.793, "sample_time_ms": 3206.12, "load_time_ms": 0.301, "load_throughput": 1196947.634, "learn_time_ms": 9.634, "learn_throughput": 37369.436, "synch_weights_time_ms": 0.693}, "counters": {"num_env_steps_sampled": 1387440, "num_env_steps_trained": 1387440, "num_agent_steps_sampled": 1387440, "num_agent_steps_trained": 1387440}, "done": false, "episodes_total": 5254, "training_iteration": 1106, "trial_id": "68078_00000", "date": "2023-08-05_10-27-57", "timestamp": 1691220477, "time_this_iter_s": 12.946796894073486, "time_total_s": 14358.903938293457, "pid": 54946, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[1400000, 5e-09], [1405400, 8e-09], [1410800, 2.5e-09], [1416200, 2.5e-09], [1421600, 2.5e-09], [1427000, 2.5e-09], [1432400, 1e-09], [1437800, 1e-09], [1443200, 1e-09], [1448600, 5e-10], [1454000, 5e-10], [1459400, 5e-10], [1464800, 5e-10], [1470200, 1e-10], [1475600, 1e-10], [1481000, 1e-10], [1486400, 1e-10], [1491800, 5e-11], [1497200, 5e-11], [1502600, 2.5e-11], [1508000, 2.5e-11], [1513400, 1e-11], [1518800, 1e-11], [1524200, 5e-12], [1529600, 5e-12], [1535000, 1e-12]], "grad_clip": 5, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.2, "final_epsilon": 0.01, "epsilon_timesteps": 1401170}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x3061b8b80>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 76.69659090042114, "iterations_since_restore": 6, "perf": {"cpu_util_percent": 21.415789473684214, "ram_util_percent": 68.6736842105263}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-12, "entropy_coeff": 0.1, "policy_entropy": -322.4927673339844, "policy_loss": -9861879.128125, "vf_loss": 21044172.4}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 133.0, "diff_num_grad_updates_vs_sampler_policy": 132.0}}, "num_env_steps_sampled": 1388880, "num_env_steps_trained": 1388880, "num_agent_steps_sampled": 1388880, "num_agent_steps_trained": 1388880}, "sampler_results": {"episode_reward_max": -3541.0547551462187, "episode_reward_min": -3618.2340839301255, "episode_reward_mean": -3553.2471980744604, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3549.037036123015, -3549.0042802439984, -3556.9165450507317, -3556.425604484131, -3579.5606359965905, -3554.5587335093637, -3558.5509476504776, -3558.1416054821716, -3545.6724673899225, -3618.2340839301255, -3548.927726494181, -3547.552260505779, -3546.921394619684, -3554.0593031889484, -3545.5010284891423, -3550.7689397104114, -3545.753746589813, -3541.0547551462187, -3542.938250114688, -3545.993290424746, -3545.1354260959706, -3553.362149148736, -3544.0388889105407, -3549.9316400437892, -3549.39529152929, -3547.7973748347345, -3552.4409423032403], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.3741311806098375, "mean_inference_ms": 0.3806928093357141, "mean_action_processing_ms": 0.09296511492872775, "mean_env_wait_ms": 1.777617462908327, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0036672309592918114, "StateBufferConnector_ms": 0.0027329833419234666, "ViewRequirementAgentConnector_ms": 0.06574083257604528}}, "episode_reward_max": -3541.0547551462187, "episode_reward_min": -3618.2340839301255, "episode_reward_mean": -3553.2471980744604, "episode_len_mean": 360.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-3549.037036123015, -3549.0042802439984, -3556.9165450507317, -3556.425604484131, -3579.5606359965905, -3554.5587335093637, -3558.5509476504776, -3558.1416054821716, -3545.6724673899225, -3618.2340839301255, -3548.927726494181, -3547.552260505779, -3546.921394619684, -3554.0593031889484, -3545.5010284891423, -3550.7689397104114, -3545.753746589813, -3541.0547551462187, -3542.938250114688, -3545.993290424746, -3545.1354260959706, -3553.362149148736, -3544.0388889105407, -3549.9316400437892, -3549.39529152929, -3547.7973748347345, -3552.4409423032403], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.3741311806098375, "mean_inference_ms": 0.3806928093357141, "mean_action_processing_ms": 0.09296511492872775, "mean_env_wait_ms": 1.777617462908327, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0036672309592918114, "StateBufferConnector_ms": 0.0027329833419234666, "ViewRequirementAgentConnector_ms": 0.06574083257604528}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1388880, "num_agent_steps_trained": 1388880, "num_env_steps_sampled": 1388880, "num_env_steps_trained": 1388880, "num_env_steps_sampled_this_iter": 1440, "num_env_steps_trained_this_iter": 1440, "num_env_steps_sampled_throughput_per_sec": 112.1373316878795, "num_env_steps_trained_throughput_per_sec": 112.1373316878795, "timesteps_total": 1388880, "num_steps_trained_this_iter": 1440, "agent_timesteps_total": 1388880, "timers": {"training_iteration_time_ms": 3210.459, "sample_time_ms": 3199.818, "load_time_ms": 0.303, "load_throughput": 1189685.975, "learn_time_ms": 9.606, "learn_throughput": 37474.981, "synch_weights_time_ms": 0.686}, "counters": {"num_env_steps_sampled": 1388880, "num_env_steps_trained": 1388880, "num_agent_steps_sampled": 1388880, "num_agent_steps_trained": 1388880}, "done": false, "episodes_total": 5258, "training_iteration": 1107, "trial_id": "68078_00000", "date": "2023-08-05_10-28-10", "timestamp": 1691220490, "time_this_iter_s": 12.843938112258911, "time_total_s": 14371.747876405716, "pid": 54946, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[1400000, 5e-09], [1405400, 8e-09], [1410800, 2.5e-09], [1416200, 2.5e-09], [1421600, 2.5e-09], [1427000, 2.5e-09], [1432400, 1e-09], [1437800, 1e-09], [1443200, 1e-09], [1448600, 5e-10], [1454000, 5e-10], [1459400, 5e-10], [1464800, 5e-10], [1470200, 1e-10], [1475600, 1e-10], [1481000, 1e-10], [1486400, 1e-10], [1491800, 5e-11], [1497200, 5e-11], [1502600, 2.5e-11], [1508000, 2.5e-11], [1513400, 1e-11], [1518800, 1e-11], [1524200, 5e-12], [1529600, 5e-12], [1535000, 1e-12]], "grad_clip": 5, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.2, "final_epsilon": 0.01, "epsilon_timesteps": 1401170}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x3061b8b80>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 89.54052901268005, "iterations_since_restore": 7, "perf": {"cpu_util_percent": 21.077777777777776, "ram_util_percent": 68.87222222222222}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-12, "entropy_coeff": 0.1, "policy_entropy": -322.2038269042969, "policy_loss": -590441.175, "vf_loss": 20917194.8}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 153.0, "diff_num_grad_updates_vs_sampler_policy": 152.0}}, "num_env_steps_sampled": 1390320, "num_env_steps_trained": 1390320, "num_agent_steps_sampled": 1390320, "num_agent_steps_trained": 1390320}, "sampler_results": {"episode_reward_max": -3541.0547551462187, "episode_reward_min": -3634.5049529545286, "episode_reward_mean": -3555.489166533845, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3549.037036123015, -3549.0042802439984, -3556.9165450507317, -3556.425604484131, -3579.5606359965905, -3554.5587335093637, -3558.5509476504776, -3558.1416054821716, -3545.6724673899225, -3618.2340839301255, -3548.927726494181, -3547.552260505779, -3546.921394619684, -3554.0593031889484, -3545.5010284891423, -3550.7689397104114, -3545.753746589813, -3541.0547551462187, -3542.938250114688, -3545.993290424746, -3545.1354260959706, -3553.362149148736, -3544.0388889105407, -3549.9316400437892, -3549.39529152929, -3547.7973748347345, -3552.4409423032403, -3558.688862480492, -3545.3599684208316, -3634.5049529545286, -3543.9360306829058], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.38187526436811, "mean_inference_ms": 0.3802081993540845, "mean_action_processing_ms": 0.0928582751472276, "mean_env_wait_ms": 1.704562235331283, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0037101007276965727, "StateBufferConnector_ms": 0.00274642821281187, "ViewRequirementAgentConnector_ms": 0.06558433655769594}}, "episode_reward_max": -3541.0547551462187, "episode_reward_min": -3634.5049529545286, "episode_reward_mean": -3555.489166533845, "episode_len_mean": 360.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-3549.037036123015, -3549.0042802439984, -3556.9165450507317, -3556.425604484131, -3579.5606359965905, -3554.5587335093637, -3558.5509476504776, -3558.1416054821716, -3545.6724673899225, -3618.2340839301255, -3548.927726494181, -3547.552260505779, -3546.921394619684, -3554.0593031889484, -3545.5010284891423, -3550.7689397104114, -3545.753746589813, -3541.0547551462187, -3542.938250114688, -3545.993290424746, -3545.1354260959706, -3553.362149148736, -3544.0388889105407, -3549.9316400437892, -3549.39529152929, -3547.7973748347345, -3552.4409423032403, -3558.688862480492, -3545.3599684208316, -3634.5049529545286, -3543.9360306829058], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.38187526436811, "mean_inference_ms": 0.3802081993540845, "mean_action_processing_ms": 0.0928582751472276, "mean_env_wait_ms": 1.704562235331283, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0037101007276965727, "StateBufferConnector_ms": 0.00274642821281187, "ViewRequirementAgentConnector_ms": 0.06558433655769594}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1390320, "num_agent_steps_trained": 1390320, "num_env_steps_sampled": 1390320, "num_env_steps_trained": 1390320, "num_env_steps_sampled_this_iter": 1440, "num_env_steps_trained_this_iter": 1440, "num_env_steps_sampled_throughput_per_sec": 112.11244913632193, "num_env_steps_trained_throughput_per_sec": 112.11244913632193, "timesteps_total": 1390320, "num_steps_trained_this_iter": 1440, "agent_timesteps_total": 1390320, "timers": {"training_iteration_time_ms": 3218.513, "sample_time_ms": 3207.892, "load_time_ms": 0.3, "load_throughput": 1200182.37, "learn_time_ms": 9.568, "learn_throughput": 37624.387, "synch_weights_time_ms": 0.708}, "counters": {"num_env_steps_sampled": 1390320, "num_env_steps_trained": 1390320, "num_agent_steps_sampled": 1390320, "num_agent_steps_trained": 1390320}, "done": false, "episodes_total": 5262, "training_iteration": 1108, "trial_id": "68078_00000", "date": "2023-08-05_10-28-23", "timestamp": 1691220503, "time_this_iter_s": 12.84685492515564, "time_total_s": 14384.594731330872, "pid": 54946, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[1400000, 5e-09], [1405400, 8e-09], [1410800, 2.5e-09], [1416200, 2.5e-09], [1421600, 2.5e-09], [1427000, 2.5e-09], [1432400, 1e-09], [1437800, 1e-09], [1443200, 1e-09], [1448600, 5e-10], [1454000, 5e-10], [1459400, 5e-10], [1464800, 5e-10], [1470200, 1e-10], [1475600, 1e-10], [1481000, 1e-10], [1486400, 1e-10], [1491800, 5e-11], [1497200, 5e-11], [1502600, 2.5e-11], [1508000, 2.5e-11], [1513400, 1e-11], [1518800, 1e-11], [1524200, 5e-12], [1529600, 5e-12], [1535000, 1e-12]], "grad_clip": 5, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.2, "final_epsilon": 0.01, "epsilon_timesteps": 1401170}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x3061b8b80>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 102.3873839378357, "iterations_since_restore": 8, "perf": {"cpu_util_percent": 23.916666666666668, "ram_util_percent": 69.03333333333332}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-12, "entropy_coeff": 0.1, "policy_entropy": -322.2980651855469, "policy_loss": -2793869.36875, "vf_loss": 20989016.8}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 173.0, "diff_num_grad_updates_vs_sampler_policy": 172.0}}, "num_env_steps_sampled": 1391760, "num_env_steps_trained": 1391760, "num_agent_steps_sampled": 1391760, "num_agent_steps_trained": 1391760}, "sampler_results": {"episode_reward_max": -3541.0547551462187, "episode_reward_min": -3634.5049529545286, "episode_reward_mean": -3554.4311873295055, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3549.037036123015, -3549.0042802439984, -3556.9165450507317, -3556.425604484131, -3579.5606359965905, -3554.5587335093637, -3558.5509476504776, -3558.1416054821716, -3545.6724673899225, -3618.2340839301255, -3548.927726494181, -3547.552260505779, -3546.921394619684, -3554.0593031889484, -3545.5010284891423, -3550.7689397104114, -3545.753746589813, -3541.0547551462187, -3542.938250114688, -3545.993290424746, -3545.1354260959706, -3553.362149148736, -3544.0388889105407, -3549.9316400437892, -3549.39529152929, -3547.7973748347345, -3552.4409423032403, -3558.688862480492, -3545.3599684208316, -3634.5049529545286, -3543.9360306829058, -3545.4643868304174, -3545.6020746271856, -3546.266420774299, -3547.5945117515953], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.385652036985063, "mean_inference_ms": 0.3798959828833819, "mean_action_processing_ms": 0.09278754884405888, "mean_env_wait_ms": 1.6445279247518207, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0036736897059849332, "StateBufferConnector_ms": 0.0027336393083844867, "ViewRequirementAgentConnector_ms": 0.06561074938092913}}, "episode_reward_max": -3541.0547551462187, "episode_reward_min": -3634.5049529545286, "episode_reward_mean": -3554.4311873295055, "episode_len_mean": 360.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-3549.037036123015, -3549.0042802439984, -3556.9165450507317, -3556.425604484131, -3579.5606359965905, -3554.5587335093637, -3558.5509476504776, -3558.1416054821716, -3545.6724673899225, -3618.2340839301255, -3548.927726494181, -3547.552260505779, -3546.921394619684, -3554.0593031889484, -3545.5010284891423, -3550.7689397104114, -3545.753746589813, -3541.0547551462187, -3542.938250114688, -3545.993290424746, -3545.1354260959706, -3553.362149148736, -3544.0388889105407, -3549.9316400437892, -3549.39529152929, -3547.7973748347345, -3552.4409423032403, -3558.688862480492, -3545.3599684208316, -3634.5049529545286, -3543.9360306829058, -3545.4643868304174, -3545.6020746271856, -3546.266420774299, -3547.5945117515953], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.385652036985063, "mean_inference_ms": 0.3798959828833819, "mean_action_processing_ms": 0.09278754884405888, "mean_env_wait_ms": 1.6445279247518207, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0036736897059849332, "StateBufferConnector_ms": 0.0027336393083844867, "ViewRequirementAgentConnector_ms": 0.06561074938092913}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1391760, "num_agent_steps_trained": 1391760, "num_env_steps_sampled": 1391760, "num_env_steps_trained": 1391760, "num_env_steps_sampled_this_iter": 1440, "num_env_steps_trained_this_iter": 1440, "num_env_steps_sampled_throughput_per_sec": 114.60367564510273, "num_env_steps_trained_throughput_per_sec": 114.60367564510273, "timesteps_total": 1391760, "num_steps_trained_this_iter": 1440, "agent_timesteps_total": 1391760, "timers": {"training_iteration_time_ms": 3185.961, "sample_time_ms": 3175.342, "load_time_ms": 0.301, "load_throughput": 1197517.202, "learn_time_ms": 9.53, "learn_throughput": 37776.502, "synch_weights_time_ms": 0.742}, "counters": {"num_env_steps_sampled": 1391760, "num_env_steps_trained": 1391760, "num_agent_steps_sampled": 1391760, "num_agent_steps_trained": 1391760}, "done": false, "episodes_total": 5266, "training_iteration": 1109, "trial_id": "68078_00000", "date": "2023-08-05_10-28-36", "timestamp": 1691220516, "time_this_iter_s": 12.567695140838623, "time_total_s": 14397.16242647171, "pid": 54946, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[1400000, 5e-09], [1405400, 8e-09], [1410800, 2.5e-09], [1416200, 2.5e-09], [1421600, 2.5e-09], [1427000, 2.5e-09], [1432400, 1e-09], [1437800, 1e-09], [1443200, 1e-09], [1448600, 5e-10], [1454000, 5e-10], [1459400, 5e-10], [1464800, 5e-10], [1470200, 1e-10], [1475600, 1e-10], [1481000, 1e-10], [1486400, 1e-10], [1491800, 5e-11], [1497200, 5e-11], [1502600, 2.5e-11], [1508000, 2.5e-11], [1513400, 1e-11], [1518800, 1e-11], [1524200, 5e-12], [1529600, 5e-12], [1535000, 1e-12]], "grad_clip": 5, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.2, "final_epsilon": 0.01, "epsilon_timesteps": 1401170}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x3061b8b80>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 114.95507907867432, "iterations_since_restore": 9, "perf": {"cpu_util_percent": 25.227777777777778, "ram_util_percent": 69.09444444444445}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-12, "entropy_coeff": 0.1, "policy_entropy": -322.2441162109375, "policy_loss": -1124308.29375, "vf_loss": 20949736.5}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 193.0, "diff_num_grad_updates_vs_sampler_policy": 192.0}}, "num_env_steps_sampled": 1393200, "num_env_steps_trained": 1393200, "num_agent_steps_sampled": 1393200, "num_agent_steps_trained": 1393200}, "sampler_results": {"episode_reward_max": -3541.0547551462187, "episode_reward_min": -3634.5049529545286, "episode_reward_mean": -3553.473527444723, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3549.037036123015, -3549.0042802439984, -3556.9165450507317, -3556.425604484131, -3579.5606359965905, -3554.5587335093637, -3558.5509476504776, -3558.1416054821716, -3545.6724673899225, -3618.2340839301255, -3548.927726494181, -3547.552260505779, -3546.921394619684, -3554.0593031889484, -3545.5010284891423, -3550.7689397104114, -3545.753746589813, -3541.0547551462187, -3542.938250114688, -3545.993290424746, -3545.1354260959706, -3553.362149148736, -3544.0388889105407, -3549.9316400437892, -3549.39529152929, -3547.7973748347345, -3552.4409423032403, -3558.688862480492, -3545.3599684208316, -3634.5049529545286, -3543.9360306829058, -3545.4643868304174, -3545.6020746271856, -3546.266420774299, -3547.5945117515953, -3546.2515639788735, -3547.180654663955, -3542.5744282811743, -3544.3693668875094], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.387033542286661, "mean_inference_ms": 0.3798210076143977, "mean_action_processing_ms": 0.09277031271947446, "mean_env_wait_ms": 1.5943243979133144, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0036368003258338342, "StateBufferConnector_ms": 0.0027387570112179485, "ViewRequirementAgentConnector_ms": 0.06557366786858974}}, "episode_reward_max": -3541.0547551462187, "episode_reward_min": -3634.5049529545286, "episode_reward_mean": -3553.473527444723, "episode_len_mean": 360.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-3549.037036123015, -3549.0042802439984, -3556.9165450507317, -3556.425604484131, -3579.5606359965905, -3554.5587335093637, -3558.5509476504776, -3558.1416054821716, -3545.6724673899225, -3618.2340839301255, -3548.927726494181, -3547.552260505779, -3546.921394619684, -3554.0593031889484, -3545.5010284891423, -3550.7689397104114, -3545.753746589813, -3541.0547551462187, -3542.938250114688, -3545.993290424746, -3545.1354260959706, -3553.362149148736, -3544.0388889105407, -3549.9316400437892, -3549.39529152929, -3547.7973748347345, -3552.4409423032403, -3558.688862480492, -3545.3599684208316, -3634.5049529545286, -3543.9360306829058, -3545.4643868304174, -3545.6020746271856, -3546.266420774299, -3547.5945117515953, -3546.2515639788735, -3547.180654663955, -3542.5744282811743, -3544.3693668875094], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.387033542286661, "mean_inference_ms": 0.3798210076143977, "mean_action_processing_ms": 0.09277031271947446, "mean_env_wait_ms": 1.5943243979133144, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0036368003258338342, "StateBufferConnector_ms": 0.0027387570112179485, "ViewRequirementAgentConnector_ms": 0.06557366786858974}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1393200, "num_agent_steps_trained": 1393200, "num_env_steps_sampled": 1393200, "num_env_steps_trained": 1393200, "num_env_steps_sampled_this_iter": 1440, "num_env_steps_trained_this_iter": 1440, "num_env_steps_sampled_throughput_per_sec": 114.2767997481588, "num_env_steps_trained_throughput_per_sec": 114.2767997481588, "timesteps_total": 1393200, "num_steps_trained_this_iter": 1440, "agent_timesteps_total": 1393200, "timers": {"training_iteration_time_ms": 3164.389, "sample_time_ms": 3153.589, "load_time_ms": 0.301, "load_throughput": 1195147.57, "learn_time_ms": 9.684, "learn_throughput": 37174.026, "synch_weights_time_ms": 0.768}, "counters": {"num_env_steps_sampled": 1393200, "num_env_steps_trained": 1393200, "num_agent_steps_sampled": 1393200, "num_agent_steps_trained": 1393200}, "done": false, "episodes_total": 5270, "training_iteration": 1110, "trial_id": "68078_00000", "date": "2023-08-05_10-28-48", "timestamp": 1691220528, "time_this_iter_s": 12.603559970855713, "time_total_s": 14409.765986442566, "pid": 54946, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[1400000, 5e-09], [1405400, 8e-09], [1410800, 2.5e-09], [1416200, 2.5e-09], [1421600, 2.5e-09], [1427000, 2.5e-09], [1432400, 1e-09], [1437800, 1e-09], [1443200, 1e-09], [1448600, 5e-10], [1454000, 5e-10], [1459400, 5e-10], [1464800, 5e-10], [1470200, 1e-10], [1475600, 1e-10], [1481000, 1e-10], [1486400, 1e-10], [1491800, 5e-11], [1497200, 5e-11], [1502600, 2.5e-11], [1508000, 2.5e-11], [1513400, 1e-11], [1518800, 1e-11], [1524200, 5e-12], [1529600, 5e-12], [1535000, 1e-12]], "grad_clip": 5, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.2, "final_epsilon": 0.01, "epsilon_timesteps": 1401170}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x3061b8b80>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 127.55863904953003, "iterations_since_restore": 10, "perf": {"cpu_util_percent": 28.23888888888889, "ram_util_percent": 69.03888888888889}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-12, "entropy_coeff": 0.1, "policy_entropy": -322.4103942871094, "policy_loss": -4627171.146875, "vf_loss": 20968562.6}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 213.0, "diff_num_grad_updates_vs_sampler_policy": 212.0}}, "num_env_steps_sampled": 1394640, "num_env_steps_trained": 1394640, "num_agent_steps_sampled": 1394640, "num_agent_steps_trained": 1394640}, "sampler_results": {"episode_reward_max": -3541.0547551462187, "episode_reward_min": -3634.5049529545286, "episode_reward_mean": -3553.103679635476, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3549.037036123015, -3549.0042802439984, -3556.9165450507317, -3556.425604484131, -3579.5606359965905, -3554.5587335093637, -3558.5509476504776, -3558.1416054821716, -3545.6724673899225, -3618.2340839301255, -3548.927726494181, -3547.552260505779, -3546.921394619684, -3554.0593031889484, -3545.5010284891423, -3550.7689397104114, -3545.753746589813, -3541.0547551462187, -3542.938250114688, -3545.993290424746, -3545.1354260959706, -3553.362149148736, -3544.0388889105407, -3549.9316400437892, -3549.39529152929, -3547.7973748347345, -3552.4409423032403, -3558.688862480492, -3545.3599684208316, -3634.5049529545286, -3543.9360306829058, -3545.4643868304174, -3545.6020746271856, -3546.266420774299, -3547.5945117515953, -3546.2515639788735, -3547.180654663955, -3542.5744282811743, -3544.3693668875094, -3551.0170721001214, -3544.0199045456034, -3555.9008252174585, -3547.052852118063], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.386358732265138, "mean_inference_ms": 0.37987293548569107, "mean_action_processing_ms": 0.09278048174940264, "mean_env_wait_ms": 1.551744621729944, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003821905269179233, "StateBufferConnector_ms": 0.0027756358301916787, "ViewRequirementAgentConnector_ms": 0.06585731062778206}}, "episode_reward_max": -3541.0547551462187, "episode_reward_min": -3634.5049529545286, "episode_reward_mean": -3553.103679635476, "episode_len_mean": 360.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-3549.037036123015, -3549.0042802439984, -3556.9165450507317, -3556.425604484131, -3579.5606359965905, -3554.5587335093637, -3558.5509476504776, -3558.1416054821716, -3545.6724673899225, -3618.2340839301255, -3548.927726494181, -3547.552260505779, -3546.921394619684, -3554.0593031889484, -3545.5010284891423, -3550.7689397104114, -3545.753746589813, -3541.0547551462187, -3542.938250114688, -3545.993290424746, -3545.1354260959706, -3553.362149148736, -3544.0388889105407, -3549.9316400437892, -3549.39529152929, -3547.7973748347345, -3552.4409423032403, -3558.688862480492, -3545.3599684208316, -3634.5049529545286, -3543.9360306829058, -3545.4643868304174, -3545.6020746271856, -3546.266420774299, -3547.5945117515953, -3546.2515639788735, -3547.180654663955, -3542.5744282811743, -3544.3693668875094, -3551.0170721001214, -3544.0199045456034, -3555.9008252174585, -3547.052852118063], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.386358732265138, "mean_inference_ms": 0.37987293548569107, "mean_action_processing_ms": 0.09278048174940264, "mean_env_wait_ms": 1.551744621729944, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003821905269179233, "StateBufferConnector_ms": 0.0027756358301916787, "ViewRequirementAgentConnector_ms": 0.06585731062778206}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1394640, "num_agent_steps_trained": 1394640, "num_env_steps_sampled": 1394640, "num_env_steps_trained": 1394640, "num_env_steps_sampled_this_iter": 1440, "num_env_steps_trained_this_iter": 1440, "num_env_steps_sampled_throughput_per_sec": 115.03820996380061, "num_env_steps_trained_throughput_per_sec": 115.03820996380061, "timesteps_total": 1394640, "num_steps_trained_this_iter": 1440, "agent_timesteps_total": 1394640, "timers": {"training_iteration_time_ms": 3134.512, "sample_time_ms": 3123.515, "load_time_ms": 0.31, "load_throughput": 1161588.922, "learn_time_ms": 9.865, "learn_throughput": 36493.188, "synch_weights_time_ms": 0.773}, "counters": {"num_env_steps_sampled": 1394640, "num_env_steps_trained": 1394640, "num_agent_steps_sampled": 1394640, "num_agent_steps_trained": 1394640}, "done": false, "episodes_total": 5274, "training_iteration": 1111, "trial_id": "68078_00000", "date": "2023-08-05_10-29-01", "timestamp": 1691220541, "time_this_iter_s": 12.5201997756958, "time_total_s": 14422.286186218262, "pid": 54946, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[1400000, 5e-09], [1405400, 8e-09], [1410800, 2.5e-09], [1416200, 2.5e-09], [1421600, 2.5e-09], [1427000, 2.5e-09], [1432400, 1e-09], [1437800, 1e-09], [1443200, 1e-09], [1448600, 5e-10], [1454000, 5e-10], [1459400, 5e-10], [1464800, 5e-10], [1470200, 1e-10], [1475600, 1e-10], [1481000, 1e-10], [1486400, 1e-10], [1491800, 5e-11], [1497200, 5e-11], [1502600, 2.5e-11], [1508000, 2.5e-11], [1513400, 1e-11], [1518800, 1e-11], [1524200, 5e-12], [1529600, 5e-12], [1535000, 1e-12]], "grad_clip": 5, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.2, "final_epsilon": 0.01, "epsilon_timesteps": 1401170}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x3061b8b80>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 140.07883882522583, "iterations_since_restore": 11, "perf": {"cpu_util_percent": 31.09444444444444, "ram_util_percent": 69.10555555555555}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-12, "entropy_coeff": 0.1, "policy_entropy": -322.2446228027344, "policy_loss": -2584473.93125, "vf_loss": 21005753.6}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 233.0, "diff_num_grad_updates_vs_sampler_policy": 232.0}}, "num_env_steps_sampled": 1396080, "num_env_steps_trained": 1396080, "num_agent_steps_sampled": 1396080, "num_agent_steps_trained": 1396080}, "sampler_results": {"episode_reward_max": -3541.0547551462187, "episode_reward_min": -3634.5049529545286, "episode_reward_mean": -3552.783665237869, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3549.037036123015, -3549.0042802439984, -3556.9165450507317, -3556.425604484131, -3579.5606359965905, -3554.5587335093637, -3558.5509476504776, -3558.1416054821716, -3545.6724673899225, -3618.2340839301255, -3548.927726494181, -3547.552260505779, -3546.921394619684, -3554.0593031889484, -3545.5010284891423, -3550.7689397104114, -3545.753746589813, -3541.0547551462187, -3542.938250114688, -3545.993290424746, -3545.1354260959706, -3553.362149148736, -3544.0388889105407, -3549.9316400437892, -3549.39529152929, -3547.7973748347345, -3552.4409423032403, -3558.688862480492, -3545.3599684208316, -3634.5049529545286, -3543.9360306829058, -3545.4643868304174, -3545.6020746271856, -3546.266420774299, -3547.5945117515953, -3546.2515639788735, -3547.180654663955, -3542.5744282811743, -3544.3693668875094, -3551.0170721001214, -3544.0199045456034, -3555.9008252174585, -3547.052852118063, -3545.461085477762, -3547.521011190102, -3554.165795312169, -3550.2261498743355], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.386151644359034, "mean_inference_ms": 0.38000589466290313, "mean_action_processing_ms": 0.09280774044070722, "mean_env_wait_ms": 1.5151750017514618, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003851220962849069, "StateBufferConnector_ms": 0.0027839173661901597, "ViewRequirementAgentConnector_ms": 0.06608861557980801}}, "episode_reward_max": -3541.0547551462187, "episode_reward_min": -3634.5049529545286, "episode_reward_mean": -3552.783665237869, "episode_len_mean": 360.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-3549.037036123015, -3549.0042802439984, -3556.9165450507317, -3556.425604484131, -3579.5606359965905, -3554.5587335093637, -3558.5509476504776, -3558.1416054821716, -3545.6724673899225, -3618.2340839301255, -3548.927726494181, -3547.552260505779, -3546.921394619684, -3554.0593031889484, -3545.5010284891423, -3550.7689397104114, -3545.753746589813, -3541.0547551462187, -3542.938250114688, -3545.993290424746, -3545.1354260959706, -3553.362149148736, -3544.0388889105407, -3549.9316400437892, -3549.39529152929, -3547.7973748347345, -3552.4409423032403, -3558.688862480492, -3545.3599684208316, -3634.5049529545286, -3543.9360306829058, -3545.4643868304174, -3545.6020746271856, -3546.266420774299, -3547.5945117515953, -3546.2515639788735, -3547.180654663955, -3542.5744282811743, -3544.3693668875094, -3551.0170721001214, -3544.0199045456034, -3555.9008252174585, -3547.052852118063, -3545.461085477762, -3547.521011190102, -3554.165795312169, -3550.2261498743355], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.386151644359034, "mean_inference_ms": 0.38000589466290313, "mean_action_processing_ms": 0.09280774044070722, "mean_env_wait_ms": 1.5151750017514618, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003851220962849069, "StateBufferConnector_ms": 0.0027839173661901597, "ViewRequirementAgentConnector_ms": 0.06608861557980801}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1396080, "num_agent_steps_trained": 1396080, "num_env_steps_sampled": 1396080, "num_env_steps_trained": 1396080, "num_env_steps_sampled_this_iter": 1440, "num_env_steps_trained_this_iter": 1440, "num_env_steps_sampled_throughput_per_sec": 111.86110534140772, "num_env_steps_trained_throughput_per_sec": 111.86110534140772, "timesteps_total": 1396080, "num_steps_trained_this_iter": 1440, "agent_timesteps_total": 1396080, "timers": {"training_iteration_time_ms": 3170.924, "sample_time_ms": 3159.899, "load_time_ms": 0.317, "load_throughput": 1137095.745, "learn_time_ms": 9.922, "learn_throughput": 36282.558, "synch_weights_time_ms": 0.736}, "counters": {"num_env_steps_sampled": 1396080, "num_env_steps_trained": 1396080, "num_agent_steps_sampled": 1396080, "num_agent_steps_trained": 1396080}, "done": false, "episodes_total": 5278, "training_iteration": 1112, "trial_id": "68078_00000", "date": "2023-08-05_10-29-14", "timestamp": 1691220554, "time_this_iter_s": 12.875693798065186, "time_total_s": 14435.161880016327, "pid": 54946, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[1400000, 5e-09], [1405400, 8e-09], [1410800, 2.5e-09], [1416200, 2.5e-09], [1421600, 2.5e-09], [1427000, 2.5e-09], [1432400, 1e-09], [1437800, 1e-09], [1443200, 1e-09], [1448600, 5e-10], [1454000, 5e-10], [1459400, 5e-10], [1464800, 5e-10], [1470200, 1e-10], [1475600, 1e-10], [1481000, 1e-10], [1486400, 1e-10], [1491800, 5e-11], [1497200, 5e-11], [1502600, 2.5e-11], [1508000, 2.5e-11], [1513400, 1e-11], [1518800, 1e-11], [1524200, 5e-12], [1529600, 5e-12], [1535000, 1e-12]], "grad_clip": 5, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.2, "final_epsilon": 0.01, "epsilon_timesteps": 1401170}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x3061b8b80>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 152.95453262329102, "iterations_since_restore": 12, "perf": {"cpu_util_percent": 31.061111111111114, "ram_util_percent": 69.07222222222222}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-12, "entropy_coeff": 0.1, "policy_entropy": -322.2040222167969, "policy_loss": 5308.13125, "vf_loss": 20919902.7}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 253.0, "diff_num_grad_updates_vs_sampler_policy": 252.0}}, "num_env_steps_sampled": 1397520, "num_env_steps_trained": 1397520, "num_agent_steps_sampled": 1397520, "num_agent_steps_trained": 1397520}, "sampler_results": {"episode_reward_max": -3541.0547551462187, "episode_reward_min": -3634.5049529545286, "episode_reward_mean": -3552.640576404936, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3549.037036123015, -3549.0042802439984, -3556.9165450507317, -3556.425604484131, -3579.5606359965905, -3554.5587335093637, -3558.5509476504776, -3558.1416054821716, -3545.6724673899225, -3618.2340839301255, -3548.927726494181, -3547.552260505779, -3546.921394619684, -3554.0593031889484, -3545.5010284891423, -3550.7689397104114, -3545.753746589813, -3541.0547551462187, -3542.938250114688, -3545.993290424746, -3545.1354260959706, -3553.362149148736, -3544.0388889105407, -3549.9316400437892, -3549.39529152929, -3547.7973748347345, -3552.4409423032403, -3558.688862480492, -3545.3599684208316, -3634.5049529545286, -3543.9360306829058, -3545.4643868304174, -3545.6020746271856, -3546.266420774299, -3547.5945117515953, -3546.2515639788735, -3547.180654663955, -3542.5744282811743, -3544.3693668875094, -3551.0170721001214, -3544.0199045456034, -3555.9008252174585, -3547.052852118063, -3545.461085477762, -3547.521011190102, -3554.165795312169, -3550.2261498743355, -3552.7367250934403, -3556.950081432851, -3551.8274508706522, -3542.322873074976], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.385216686585305, "mean_inference_ms": 0.38014783613285924, "mean_action_processing_ms": 0.09283584514433248, "mean_env_wait_ms": 1.483215500051361, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00382077460195504, "StateBufferConnector_ms": 0.0027913673251282935, "ViewRequirementAgentConnector_ms": 0.06626026303160425}}, "episode_reward_max": -3541.0547551462187, "episode_reward_min": -3634.5049529545286, "episode_reward_mean": -3552.640576404936, "episode_len_mean": 360.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-3549.037036123015, -3549.0042802439984, -3556.9165450507317, -3556.425604484131, -3579.5606359965905, -3554.5587335093637, -3558.5509476504776, -3558.1416054821716, -3545.6724673899225, -3618.2340839301255, -3548.927726494181, -3547.552260505779, -3546.921394619684, -3554.0593031889484, -3545.5010284891423, -3550.7689397104114, -3545.753746589813, -3541.0547551462187, -3542.938250114688, -3545.993290424746, -3545.1354260959706, -3553.362149148736, -3544.0388889105407, -3549.9316400437892, -3549.39529152929, -3547.7973748347345, -3552.4409423032403, -3558.688862480492, -3545.3599684208316, -3634.5049529545286, -3543.9360306829058, -3545.4643868304174, -3545.6020746271856, -3546.266420774299, -3547.5945117515953, -3546.2515639788735, -3547.180654663955, -3542.5744282811743, -3544.3693668875094, -3551.0170721001214, -3544.0199045456034, -3555.9008252174585, -3547.052852118063, -3545.461085477762, -3547.521011190102, -3554.165795312169, -3550.2261498743355, -3552.7367250934403, -3556.950081432851, -3551.8274508706522, -3542.322873074976], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.385216686585305, "mean_inference_ms": 0.38014783613285924, "mean_action_processing_ms": 0.09283584514433248, "mean_env_wait_ms": 1.483215500051361, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00382077460195504, "StateBufferConnector_ms": 0.0027913673251282935, "ViewRequirementAgentConnector_ms": 0.06626026303160425}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1397520, "num_agent_steps_trained": 1397520, "num_env_steps_sampled": 1397520, "num_env_steps_trained": 1397520, "num_env_steps_sampled_this_iter": 1440, "num_env_steps_trained_this_iter": 1440, "num_env_steps_sampled_throughput_per_sec": 114.4755516480094, "num_env_steps_trained_throughput_per_sec": 114.4755516480094, "timesteps_total": 1397520, "num_steps_trained_this_iter": 1440, "agent_timesteps_total": 1397520, "timers": {"training_iteration_time_ms": 3164.243, "sample_time_ms": 3153.301, "load_time_ms": 0.31, "load_throughput": 1162125.329, "learn_time_ms": 9.862, "learn_throughput": 36505.187, "synch_weights_time_ms": 0.72}, "counters": {"num_env_steps_sampled": 1397520, "num_env_steps_trained": 1397520, "num_agent_steps_sampled": 1397520, "num_agent_steps_trained": 1397520}, "done": false, "episodes_total": 5282, "training_iteration": 1113, "trial_id": "68078_00000", "date": "2023-08-05_10-29-26", "timestamp": 1691220566, "time_this_iter_s": 12.581862926483154, "time_total_s": 14447.74374294281, "pid": 54946, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[1400000, 5e-09], [1405400, 8e-09], [1410800, 2.5e-09], [1416200, 2.5e-09], [1421600, 2.5e-09], [1427000, 2.5e-09], [1432400, 1e-09], [1437800, 1e-09], [1443200, 1e-09], [1448600, 5e-10], [1454000, 5e-10], [1459400, 5e-10], [1464800, 5e-10], [1470200, 1e-10], [1475600, 1e-10], [1481000, 1e-10], [1486400, 1e-10], [1491800, 5e-11], [1497200, 5e-11], [1502600, 2.5e-11], [1508000, 2.5e-11], [1513400, 1e-11], [1518800, 1e-11], [1524200, 5e-12], [1529600, 5e-12], [1535000, 1e-12]], "grad_clip": 5, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.2, "final_epsilon": 0.01, "epsilon_timesteps": 1401170}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x3061b8b80>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 165.53639554977417, "iterations_since_restore": 13, "perf": {"cpu_util_percent": 26.96666666666667, "ram_util_percent": 69.23333333333332}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-12, "entropy_coeff": 0.1, "policy_entropy": -322.2936645507813, "policy_loss": -4551906.953125, "vf_loss": 20943495.3}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 273.0, "diff_num_grad_updates_vs_sampler_policy": 272.0}}, "num_env_steps_sampled": 1398960, "num_env_steps_trained": 1398960, "num_agent_steps_sampled": 1398960, "num_agent_steps_trained": 1398960}, "sampler_results": {"episode_reward_max": -3541.0547551462187, "episode_reward_min": -3634.5049529545286, "episode_reward_mean": -3552.3269635398797, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3549.037036123015, -3549.0042802439984, -3556.9165450507317, -3556.425604484131, -3579.5606359965905, -3554.5587335093637, -3558.5509476504776, -3558.1416054821716, -3545.6724673899225, -3618.2340839301255, -3548.927726494181, -3547.552260505779, -3546.921394619684, -3554.0593031889484, -3545.5010284891423, -3550.7689397104114, -3545.753746589813, -3541.0547551462187, -3542.938250114688, -3545.993290424746, -3545.1354260959706, -3553.362149148736, -3544.0388889105407, -3549.9316400437892, -3549.39529152929, -3547.7973748347345, -3552.4409423032403, -3558.688862480492, -3545.3599684208316, -3634.5049529545286, -3543.9360306829058, -3545.4643868304174, -3545.6020746271856, -3546.266420774299, -3547.5945117515953, -3546.2515639788735, -3547.180654663955, -3542.5744282811743, -3544.3693668875094, -3551.0170721001214, -3544.0199045456034, -3555.9008252174585, -3547.052852118063, -3545.461085477762, -3547.521011190102, -3554.165795312169, -3550.2261498743355, -3552.7367250934403, -3556.950081432851, -3551.8274508706522, -3542.322873074976, -3555.148544277189, -3548.850835727826, -3545.449122148641, -3543.8650958880057], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.383303785331338, "mean_inference_ms": 0.38023531742532996, "mean_action_processing_ms": 0.0928527615763985, "mean_env_wait_ms": 1.454875428023131, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0037800181995738635, "StateBufferConnector_ms": 0.0027912313287908382, "ViewRequirementAgentConnector_ms": 0.06616809151389381}}, "episode_reward_max": -3541.0547551462187, "episode_reward_min": -3634.5049529545286, "episode_reward_mean": -3552.3269635398797, "episode_len_mean": 360.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-3549.037036123015, -3549.0042802439984, -3556.9165450507317, -3556.425604484131, -3579.5606359965905, -3554.5587335093637, -3558.5509476504776, -3558.1416054821716, -3545.6724673899225, -3618.2340839301255, -3548.927726494181, -3547.552260505779, -3546.921394619684, -3554.0593031889484, -3545.5010284891423, -3550.7689397104114, -3545.753746589813, -3541.0547551462187, -3542.938250114688, -3545.993290424746, -3545.1354260959706, -3553.362149148736, -3544.0388889105407, -3549.9316400437892, -3549.39529152929, -3547.7973748347345, -3552.4409423032403, -3558.688862480492, -3545.3599684208316, -3634.5049529545286, -3543.9360306829058, -3545.4643868304174, -3545.6020746271856, -3546.266420774299, -3547.5945117515953, -3546.2515639788735, -3547.180654663955, -3542.5744282811743, -3544.3693668875094, -3551.0170721001214, -3544.0199045456034, -3555.9008252174585, -3547.052852118063, -3545.461085477762, -3547.521011190102, -3554.165795312169, -3550.2261498743355, -3552.7367250934403, -3556.950081432851, -3551.8274508706522, -3542.322873074976, -3555.148544277189, -3548.850835727826, -3545.449122148641, -3543.8650958880057], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.383303785331338, "mean_inference_ms": 0.38023531742532996, "mean_action_processing_ms": 0.0928527615763985, "mean_env_wait_ms": 1.454875428023131, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0037800181995738635, "StateBufferConnector_ms": 0.0027912313287908382, "ViewRequirementAgentConnector_ms": 0.06616809151389381}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1398960, "num_agent_steps_trained": 1398960, "num_env_steps_sampled": 1398960, "num_env_steps_trained": 1398960, "num_env_steps_sampled_this_iter": 1440, "num_env_steps_trained_this_iter": 1440, "num_env_steps_sampled_throughput_per_sec": 116.27591280562362, "num_env_steps_trained_throughput_per_sec": 116.27591280562362, "timesteps_total": 1398960, "num_steps_trained_this_iter": 1440, "agent_timesteps_total": 1398960, "timers": {"training_iteration_time_ms": 3146.382, "sample_time_ms": 3135.538, "load_time_ms": 0.31, "load_throughput": 1161588.922, "learn_time_ms": 9.755, "learn_throughput": 36903.282, "synch_weights_time_ms": 0.73}, "counters": {"num_env_steps_sampled": 1398960, "num_env_steps_trained": 1398960, "num_agent_steps_sampled": 1398960, "num_agent_steps_trained": 1398960}, "done": false, "episodes_total": 5286, "training_iteration": 1114, "trial_id": "68078_00000", "date": "2023-08-05_10-29-39", "timestamp": 1691220579, "time_this_iter_s": 12.386897802352905, "time_total_s": 14460.130640745163, "pid": 54946, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[1400000, 5e-09], [1405400, 8e-09], [1410800, 2.5e-09], [1416200, 2.5e-09], [1421600, 2.5e-09], [1427000, 2.5e-09], [1432400, 1e-09], [1437800, 1e-09], [1443200, 1e-09], [1448600, 5e-10], [1454000, 5e-10], [1459400, 5e-10], [1464800, 5e-10], [1470200, 1e-10], [1475600, 1e-10], [1481000, 1e-10], [1486400, 1e-10], [1491800, 5e-11], [1497200, 5e-11], [1502600, 2.5e-11], [1508000, 2.5e-11], [1513400, 1e-11], [1518800, 1e-11], [1524200, 5e-12], [1529600, 5e-12], [1535000, 1e-12]], "grad_clip": 5, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.2, "final_epsilon": 0.01, "epsilon_timesteps": 1401170}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x3061b8b80>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 177.92329335212708, "iterations_since_restore": 14, "perf": {"cpu_util_percent": 26.583333333333332, "ram_util_percent": 69.15555555555555}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 5.022222222222222e-09, "entropy_coeff": 0.1, "policy_entropy": -322.1172302246094, "policy_loss": 329747.134375, "vf_loss": 20900402.3}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 293.0, "diff_num_grad_updates_vs_sampler_policy": 292.0}}, "num_env_steps_sampled": 1400400, "num_env_steps_trained": 1400400, "num_agent_steps_sampled": 1400400, "num_agent_steps_trained": 1400400}, "sampler_results": {"episode_reward_max": -3541.0547551462187, "episode_reward_min": -3634.5049529545286, "episode_reward_mean": -3551.812455924022, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3549.037036123015, -3549.0042802439984, -3556.9165450507317, -3556.425604484131, -3579.5606359965905, -3554.5587335093637, -3558.5509476504776, -3558.1416054821716, -3545.6724673899225, -3618.2340839301255, -3548.927726494181, -3547.552260505779, -3546.921394619684, -3554.0593031889484, -3545.5010284891423, -3550.7689397104114, -3545.753746589813, -3541.0547551462187, -3542.938250114688, -3545.993290424746, -3545.1354260959706, -3553.362149148736, -3544.0388889105407, -3549.9316400437892, -3549.39529152929, -3547.7973748347345, -3552.4409423032403, -3558.688862480492, -3545.3599684208316, -3634.5049529545286, -3543.9360306829058, -3545.4643868304174, -3545.6020746271856, -3546.266420774299, -3547.5945117515953, -3546.2515639788735, -3547.180654663955, -3542.5744282811743, -3544.3693668875094, -3551.0170721001214, -3544.0199045456034, -3555.9008252174585, -3547.052852118063, -3545.461085477762, -3547.521011190102, -3554.165795312169, -3550.2261498743355, -3552.7367250934403, -3556.950081432851, -3551.8274508706522, -3542.322873074976, -3555.148544277189, -3548.850835727826, -3545.449122148641, -3543.8650958880057, -3547.4566727516185, -3545.9979029870665, -3544.4425739389712, -3541.0547551462187], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.380793461917809, "mean_inference_ms": 0.38030894907164614, "mean_action_processing_ms": 0.0928654912476097, "mean_env_wait_ms": 1.4295272790386677, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0037447880890409827, "StateBufferConnector_ms": 0.0027753539004568327, "ViewRequirementAgentConnector_ms": 0.06605285709187136}}, "episode_reward_max": -3541.0547551462187, "episode_reward_min": -3634.5049529545286, "episode_reward_mean": -3551.812455924022, "episode_len_mean": 360.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-3549.037036123015, -3549.0042802439984, -3556.9165450507317, -3556.425604484131, -3579.5606359965905, -3554.5587335093637, -3558.5509476504776, -3558.1416054821716, -3545.6724673899225, -3618.2340839301255, -3548.927726494181, -3547.552260505779, -3546.921394619684, -3554.0593031889484, -3545.5010284891423, -3550.7689397104114, -3545.753746589813, -3541.0547551462187, -3542.938250114688, -3545.993290424746, -3545.1354260959706, -3553.362149148736, -3544.0388889105407, -3549.9316400437892, -3549.39529152929, -3547.7973748347345, -3552.4409423032403, -3558.688862480492, -3545.3599684208316, -3634.5049529545286, -3543.9360306829058, -3545.4643868304174, -3545.6020746271856, -3546.266420774299, -3547.5945117515953, -3546.2515639788735, -3547.180654663955, -3542.5744282811743, -3544.3693668875094, -3551.0170721001214, -3544.0199045456034, -3555.9008252174585, -3547.052852118063, -3545.461085477762, -3547.521011190102, -3554.165795312169, -3550.2261498743355, -3552.7367250934403, -3556.950081432851, -3551.8274508706522, -3542.322873074976, -3555.148544277189, -3548.850835727826, -3545.449122148641, -3543.8650958880057, -3547.4566727516185, -3545.9979029870665, -3544.4425739389712, -3541.0547551462187], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.380793461917809, "mean_inference_ms": 0.38030894907164614, "mean_action_processing_ms": 0.0928654912476097, "mean_env_wait_ms": 1.4295272790386677, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0037447880890409827, "StateBufferConnector_ms": 0.0027753539004568327, "ViewRequirementAgentConnector_ms": 0.06605285709187136}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1400400, "num_agent_steps_trained": 1400400, "num_env_steps_sampled": 1400400, "num_env_steps_trained": 1400400, "num_env_steps_sampled_this_iter": 1440, "num_env_steps_trained_this_iter": 1440, "num_env_steps_sampled_throughput_per_sec": 116.10987222257424, "num_env_steps_trained_throughput_per_sec": 116.10987222257424, "timesteps_total": 1400400, "num_steps_trained_this_iter": 1440, "agent_timesteps_total": 1400400, "timers": {"training_iteration_time_ms": 3101.44, "sample_time_ms": 3090.31, "load_time_ms": 0.309, "load_throughput": 1164904.675, "learn_time_ms": 10.029, "learn_throughput": 35894.174, "synch_weights_time_ms": 0.741}, "counters": {"num_env_steps_sampled": 1400400, "num_env_steps_trained": 1400400, "num_agent_steps_sampled": 1400400, "num_agent_steps_trained": 1400400}, "done": false, "episodes_total": 5290, "training_iteration": 1115, "trial_id": "68078_00000", "date": "2023-08-05_10-29-51", "timestamp": 1691220591, "time_this_iter_s": 12.4048593044281, "time_total_s": 14472.535500049591, "pid": 54946, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[1400000, 5e-09], [1405400, 8e-09], [1410800, 2.5e-09], [1416200, 2.5e-09], [1421600, 2.5e-09], [1427000, 2.5e-09], [1432400, 1e-09], [1437800, 1e-09], [1443200, 1e-09], [1448600, 5e-10], [1454000, 5e-10], [1459400, 5e-10], [1464800, 5e-10], [1470200, 1e-10], [1475600, 1e-10], [1481000, 1e-10], [1486400, 1e-10], [1491800, 5e-11], [1497200, 5e-11], [1502600, 2.5e-11], [1508000, 2.5e-11], [1513400, 1e-11], [1518800, 1e-11], [1524200, 5e-12], [1529600, 5e-12], [1535000, 1e-12]], "grad_clip": 5, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.2, "final_epsilon": 0.01, "epsilon_timesteps": 1401170}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x3061b8b80>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 190.32815265655518, "iterations_since_restore": 15, "perf": {"cpu_util_percent": 24.635294117647057, "ram_util_percent": 69.04117647058824}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 5.8222222222222225e-09, "entropy_coeff": 0.1, "policy_entropy": -322.478955078125, "policy_loss": -10436178.58125, "vf_loss": 21043425.2}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 313.0, "diff_num_grad_updates_vs_sampler_policy": 312.0}}, "num_env_steps_sampled": 1401840, "num_env_steps_trained": 1401840, "num_agent_steps_sampled": 1401840, "num_agent_steps_trained": 1401840}, "sampler_results": {"episode_reward_max": -3541.0547551462187, "episode_reward_min": -3634.5049529545286, "episode_reward_mean": -3551.779601844543, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3549.037036123015, -3549.0042802439984, -3556.9165450507317, -3556.425604484131, -3579.5606359965905, -3554.5587335093637, -3558.5509476504776, -3558.1416054821716, -3545.6724673899225, -3618.2340839301255, -3548.927726494181, -3547.552260505779, -3546.921394619684, -3554.0593031889484, -3545.5010284891423, -3550.7689397104114, -3545.753746589813, -3541.0547551462187, -3542.938250114688, -3545.993290424746, -3545.1354260959706, -3553.362149148736, -3544.0388889105407, -3549.9316400437892, -3549.39529152929, -3547.7973748347345, -3552.4409423032403, -3558.688862480492, -3545.3599684208316, -3634.5049529545286, -3543.9360306829058, -3545.4643868304174, -3545.6020746271856, -3546.266420774299, -3547.5945117515953, -3546.2515639788735, -3547.180654663955, -3542.5744282811743, -3544.3693668875094, -3551.0170721001214, -3544.0199045456034, -3555.9008252174585, -3547.052852118063, -3545.461085477762, -3547.521011190102, -3554.165795312169, -3550.2261498743355, -3552.7367250934403, -3556.950081432851, -3551.8274508706522, -3542.322873074976, -3555.148544277189, -3548.850835727826, -3545.449122148641, -3543.8650958880057, -3547.4566727516185, -3545.9979029870665, -3544.4425739389712, -3541.0547551462187, -3558.430752215632, -3552.3085968989235, -3542.488506293041, -3551.9521612813114], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.377751032707783, "mean_inference_ms": 0.3803453279321995, "mean_action_processing_ms": 0.09287206805200669, "mean_env_wait_ms": 1.4068291968744413, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0037170591808500745, "StateBufferConnector_ms": 0.0027679261707124255, "ViewRequirementAgentConnector_ms": 0.06596512264675564}}, "episode_reward_max": -3541.0547551462187, "episode_reward_min": -3634.5049529545286, "episode_reward_mean": -3551.779601844543, "episode_len_mean": 360.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-3549.037036123015, -3549.0042802439984, -3556.9165450507317, -3556.425604484131, -3579.5606359965905, -3554.5587335093637, -3558.5509476504776, -3558.1416054821716, -3545.6724673899225, -3618.2340839301255, -3548.927726494181, -3547.552260505779, -3546.921394619684, -3554.0593031889484, -3545.5010284891423, -3550.7689397104114, -3545.753746589813, -3541.0547551462187, -3542.938250114688, -3545.993290424746, -3545.1354260959706, -3553.362149148736, -3544.0388889105407, -3549.9316400437892, -3549.39529152929, -3547.7973748347345, -3552.4409423032403, -3558.688862480492, -3545.3599684208316, -3634.5049529545286, -3543.9360306829058, -3545.4643868304174, -3545.6020746271856, -3546.266420774299, -3547.5945117515953, -3546.2515639788735, -3547.180654663955, -3542.5744282811743, -3544.3693668875094, -3551.0170721001214, -3544.0199045456034, -3555.9008252174585, -3547.052852118063, -3545.461085477762, -3547.521011190102, -3554.165795312169, -3550.2261498743355, -3552.7367250934403, -3556.950081432851, -3551.8274508706522, -3542.322873074976, -3555.148544277189, -3548.850835727826, -3545.449122148641, -3543.8650958880057, -3547.4566727516185, -3545.9979029870665, -3544.4425739389712, -3541.0547551462187, -3558.430752215632, -3552.3085968989235, -3542.488506293041, -3551.9521612813114], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.377751032707783, "mean_inference_ms": 0.3803453279321995, "mean_action_processing_ms": 0.09287206805200669, "mean_env_wait_ms": 1.4068291968744413, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0037170591808500745, "StateBufferConnector_ms": 0.0027679261707124255, "ViewRequirementAgentConnector_ms": 0.06596512264675564}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1401840, "num_agent_steps_trained": 1401840, "num_env_steps_sampled": 1401840, "num_env_steps_trained": 1401840, "num_env_steps_sampled_this_iter": 1440, "num_env_steps_trained_this_iter": 1440, "num_env_steps_sampled_throughput_per_sec": 116.31737341337983, "num_env_steps_trained_throughput_per_sec": 116.31737341337983, "timesteps_total": 1401840, "num_steps_trained_this_iter": 1440, "agent_timesteps_total": 1401840, "timers": {"training_iteration_time_ms": 3097.754, "sample_time_ms": 3086.711, "load_time_ms": 0.302, "load_throughput": 1194013.475, "learn_time_ms": 9.973, "learn_throughput": 36098.493, "synch_weights_time_ms": 0.72}, "counters": {"num_env_steps_sampled": 1401840, "num_env_steps_trained": 1401840, "num_agent_steps_sampled": 1401840, "num_agent_steps_trained": 1401840}, "done": false, "episodes_total": 5294, "training_iteration": 1116, "trial_id": "68078_00000", "date": "2023-08-05_10-30-04", "timestamp": 1691220604, "time_this_iter_s": 12.382914781570435, "time_total_s": 14484.918414831161, "pid": 54946, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[1400000, 5e-09], [1405400, 8e-09], [1410800, 2.5e-09], [1416200, 2.5e-09], [1421600, 2.5e-09], [1427000, 2.5e-09], [1432400, 1e-09], [1437800, 1e-09], [1443200, 1e-09], [1448600, 5e-10], [1454000, 5e-10], [1459400, 5e-10], [1464800, 5e-10], [1470200, 1e-10], [1475600, 1e-10], [1481000, 1e-10], [1486400, 1e-10], [1491800, 5e-11], [1497200, 5e-11], [1502600, 2.5e-11], [1508000, 2.5e-11], [1513400, 1e-11], [1518800, 1e-11], [1524200, 5e-12], [1529600, 5e-12], [1535000, 1e-12]], "grad_clip": 5, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.2, "final_epsilon": 0.01, "epsilon_timesteps": 1401170}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x3061b8b80>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 202.7110674381256, "iterations_since_restore": 16, "perf": {"cpu_util_percent": 25.72222222222222, "ram_util_percent": 69.00555555555556}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 6.622222222222222e-09, "entropy_coeff": 0.1, "policy_entropy": -322.29075927734374, "policy_loss": -9384178.08125, "vf_loss": 20974743.3}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 333.0, "diff_num_grad_updates_vs_sampler_policy": 332.0}}, "num_env_steps_sampled": 1403280, "num_env_steps_trained": 1403280, "num_agent_steps_sampled": 1403280, "num_agent_steps_trained": 1403280}, "sampler_results": {"episode_reward_max": -3541.0503481917694, "episode_reward_min": -3634.5049529545286, "episode_reward_mean": -3551.5020059699596, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3549.037036123015, -3549.0042802439984, -3556.9165450507317, -3556.425604484131, -3579.5606359965905, -3554.5587335093637, -3558.5509476504776, -3558.1416054821716, -3545.6724673899225, -3618.2340839301255, -3548.927726494181, -3547.552260505779, -3546.921394619684, -3554.0593031889484, -3545.5010284891423, -3550.7689397104114, -3545.753746589813, -3541.0547551462187, -3542.938250114688, -3545.993290424746, -3545.1354260959706, -3553.362149148736, -3544.0388889105407, -3549.9316400437892, -3549.39529152929, -3547.7973748347345, -3552.4409423032403, -3558.688862480492, -3545.3599684208316, -3634.5049529545286, -3543.9360306829058, -3545.4643868304174, -3545.6020746271856, -3546.266420774299, -3547.5945117515953, -3546.2515639788735, -3547.180654663955, -3542.5744282811743, -3544.3693668875094, -3551.0170721001214, -3544.0199045456034, -3555.9008252174585, -3547.052852118063, -3545.461085477762, -3547.521011190102, -3554.165795312169, -3550.2261498743355, -3552.7367250934403, -3556.950081432851, -3551.8274508706522, -3542.322873074976, -3555.148544277189, -3548.850835727826, -3545.449122148641, -3543.8650958880057, -3547.4566727516185, -3545.9979029870665, -3544.4425739389712, -3541.0547551462187, -3558.430752215632, -3552.3085968989235, -3542.488506293041, -3551.9521612813114, -3550.3427946578804, -3541.0503481917694, -3548.596138550916, -3548.530202380513], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.374350976775071, "mean_inference_ms": 0.38037170467365494, "mean_action_processing_ms": 0.09287664724299362, "mean_env_wait_ms": 1.3862597614260284, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0037403249028903334, "StateBufferConnector_ms": 0.0027692140038333723, "ViewRequirementAgentConnector_ms": 0.06592878654821595}}, "episode_reward_max": -3541.0503481917694, "episode_reward_min": -3634.5049529545286, "episode_reward_mean": -3551.5020059699596, "episode_len_mean": 360.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-3549.037036123015, -3549.0042802439984, -3556.9165450507317, -3556.425604484131, -3579.5606359965905, -3554.5587335093637, -3558.5509476504776, -3558.1416054821716, -3545.6724673899225, -3618.2340839301255, -3548.927726494181, -3547.552260505779, -3546.921394619684, -3554.0593031889484, -3545.5010284891423, -3550.7689397104114, -3545.753746589813, -3541.0547551462187, -3542.938250114688, -3545.993290424746, -3545.1354260959706, -3553.362149148736, -3544.0388889105407, -3549.9316400437892, -3549.39529152929, -3547.7973748347345, -3552.4409423032403, -3558.688862480492, -3545.3599684208316, -3634.5049529545286, -3543.9360306829058, -3545.4643868304174, -3545.6020746271856, -3546.266420774299, -3547.5945117515953, -3546.2515639788735, -3547.180654663955, -3542.5744282811743, -3544.3693668875094, -3551.0170721001214, -3544.0199045456034, -3555.9008252174585, -3547.052852118063, -3545.461085477762, -3547.521011190102, -3554.165795312169, -3550.2261498743355, -3552.7367250934403, -3556.950081432851, -3551.8274508706522, -3542.322873074976, -3555.148544277189, -3548.850835727826, -3545.449122148641, -3543.8650958880057, -3547.4566727516185, -3545.9979029870665, -3544.4425739389712, -3541.0547551462187, -3558.430752215632, -3552.3085968989235, -3542.488506293041, -3551.9521612813114, -3550.3427946578804, -3541.0503481917694, -3548.596138550916, -3548.530202380513], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.374350976775071, "mean_inference_ms": 0.38037170467365494, "mean_action_processing_ms": 0.09287664724299362, "mean_env_wait_ms": 1.3862597614260284, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0037403249028903334, "StateBufferConnector_ms": 0.0027692140038333723, "ViewRequirementAgentConnector_ms": 0.06592878654821595}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1403280, "num_agent_steps_trained": 1403280, "num_env_steps_sampled": 1403280, "num_env_steps_trained": 1403280, "num_env_steps_sampled_this_iter": 1440, "num_env_steps_trained_this_iter": 1440, "num_env_steps_sampled_throughput_per_sec": 116.7107047261167, "num_env_steps_trained_throughput_per_sec": 116.7107047261167, "timesteps_total": 1403280, "num_steps_trained_this_iter": 1440, "agent_timesteps_total": 1403280, "timers": {"training_iteration_time_ms": 3092.476, "sample_time_ms": 3081.65, "load_time_ms": 0.304, "load_throughput": 1182604.511, "learn_time_ms": 9.749, "learn_throughput": 36927.74, "synch_weights_time_ms": 0.724}, "counters": {"num_env_steps_sampled": 1403280, "num_env_steps_trained": 1403280, "num_agent_steps_sampled": 1403280, "num_agent_steps_trained": 1403280}, "done": false, "episodes_total": 5298, "training_iteration": 1117, "trial_id": "68078_00000", "date": "2023-08-05_10-30-16", "timestamp": 1691220616, "time_this_iter_s": 12.341309785842896, "time_total_s": 14497.259724617004, "pid": 54946, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[1400000, 5e-09], [1405400, 8e-09], [1410800, 2.5e-09], [1416200, 2.5e-09], [1421600, 2.5e-09], [1427000, 2.5e-09], [1432400, 1e-09], [1437800, 1e-09], [1443200, 1e-09], [1448600, 5e-10], [1454000, 5e-10], [1459400, 5e-10], [1464800, 5e-10], [1470200, 1e-10], [1475600, 1e-10], [1481000, 1e-10], [1486400, 1e-10], [1491800, 5e-11], [1497200, 5e-11], [1502600, 2.5e-11], [1508000, 2.5e-11], [1513400, 1e-11], [1518800, 1e-11], [1524200, 5e-12], [1529600, 5e-12], [1535000, 1e-12]], "grad_clip": 5, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.2, "final_epsilon": 0.01, "epsilon_timesteps": 1401170}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x3061b8b80>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 215.0523772239685, "iterations_since_restore": 17, "perf": {"cpu_util_percent": 27.227777777777774, "ram_util_percent": 68.89444444444445}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 7.422222222222223e-09, "entropy_coeff": 0.1, "policy_entropy": -322.2109008789063, "policy_loss": -1927796.6375, "vf_loss": 20964380.8}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 353.0, "diff_num_grad_updates_vs_sampler_policy": 352.0}}, "num_env_steps_sampled": 1404720, "num_env_steps_trained": 1404720, "num_agent_steps_sampled": 1404720, "num_agent_steps_trained": 1404720}, "sampler_results": {"episode_reward_max": -3541.0503481917694, "episode_reward_min": -3634.5049529545286, "episode_reward_mean": -3551.3114016112904, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3549.037036123015, -3549.0042802439984, -3556.9165450507317, -3556.425604484131, -3579.5606359965905, -3554.5587335093637, -3558.5509476504776, -3558.1416054821716, -3545.6724673899225, -3618.2340839301255, -3548.927726494181, -3547.552260505779, -3546.921394619684, -3554.0593031889484, -3545.5010284891423, -3550.7689397104114, -3545.753746589813, -3541.0547551462187, -3542.938250114688, -3545.993290424746, -3545.1354260959706, -3553.362149148736, -3544.0388889105407, -3549.9316400437892, -3549.39529152929, -3547.7973748347345, -3552.4409423032403, -3558.688862480492, -3545.3599684208316, -3634.5049529545286, -3543.9360306829058, -3545.4643868304174, -3545.6020746271856, -3546.266420774299, -3547.5945117515953, -3546.2515639788735, -3547.180654663955, -3542.5744282811743, -3544.3693668875094, -3551.0170721001214, -3544.0199045456034, -3555.9008252174585, -3547.052852118063, -3545.461085477762, -3547.521011190102, -3554.165795312169, -3550.2261498743355, -3552.7367250934403, -3556.950081432851, -3551.8274508706522, -3542.322873074976, -3555.148544277189, -3548.850835727826, -3545.449122148641, -3543.8650958880057, -3547.4566727516185, -3545.9979029870665, -3544.4425739389712, -3541.0547551462187, -3558.430752215632, -3552.3085968989235, -3542.488506293041, -3551.9521612813114, -3550.3427946578804, -3541.0503481917694, -3548.596138550916, -3548.530202380513, -3546.9339454621813, -3545.8715705840937, -3552.167853757343, -3547.5017446107067], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.370838229175267, "mean_inference_ms": 0.3804027666579349, "mean_action_processing_ms": 0.09288261864148982, "mean_env_wait_ms": 1.3675974226341252, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0037609691351232393, "StateBufferConnector_ms": 0.002758603700449769, "ViewRequirementAgentConnector_ms": 0.06589654465796242}}, "episode_reward_max": -3541.0503481917694, "episode_reward_min": -3634.5049529545286, "episode_reward_mean": -3551.3114016112904, "episode_len_mean": 360.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-3549.037036123015, -3549.0042802439984, -3556.9165450507317, -3556.425604484131, -3579.5606359965905, -3554.5587335093637, -3558.5509476504776, -3558.1416054821716, -3545.6724673899225, -3618.2340839301255, -3548.927726494181, -3547.552260505779, -3546.921394619684, -3554.0593031889484, -3545.5010284891423, -3550.7689397104114, -3545.753746589813, -3541.0547551462187, -3542.938250114688, -3545.993290424746, -3545.1354260959706, -3553.362149148736, -3544.0388889105407, -3549.9316400437892, -3549.39529152929, -3547.7973748347345, -3552.4409423032403, -3558.688862480492, -3545.3599684208316, -3634.5049529545286, -3543.9360306829058, -3545.4643868304174, -3545.6020746271856, -3546.266420774299, -3547.5945117515953, -3546.2515639788735, -3547.180654663955, -3542.5744282811743, -3544.3693668875094, -3551.0170721001214, -3544.0199045456034, -3555.9008252174585, -3547.052852118063, -3545.461085477762, -3547.521011190102, -3554.165795312169, -3550.2261498743355, -3552.7367250934403, -3556.950081432851, -3551.8274508706522, -3542.322873074976, -3555.148544277189, -3548.850835727826, -3545.449122148641, -3543.8650958880057, -3547.4566727516185, -3545.9979029870665, -3544.4425739389712, -3541.0547551462187, -3558.430752215632, -3552.3085968989235, -3542.488506293041, -3551.9521612813114, -3550.3427946578804, -3541.0503481917694, -3548.596138550916, -3548.530202380513, -3546.9339454621813, -3545.8715705840937, -3552.167853757343, -3547.5017446107067], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.370838229175267, "mean_inference_ms": 0.3804027666579349, "mean_action_processing_ms": 0.09288261864148982, "mean_env_wait_ms": 1.3675974226341252, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0037609691351232393, "StateBufferConnector_ms": 0.002758603700449769, "ViewRequirementAgentConnector_ms": 0.06589654465796242}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1404720, "num_agent_steps_trained": 1404720, "num_env_steps_sampled": 1404720, "num_env_steps_trained": 1404720, "num_env_steps_sampled_this_iter": 1440, "num_env_steps_trained_this_iter": 1440, "num_env_steps_sampled_throughput_per_sec": 115.87415637576017, "num_env_steps_trained_throughput_per_sec": 115.87415637576017, "timesteps_total": 1404720, "num_steps_trained_this_iter": 1440, "agent_timesteps_total": 1404720, "timers": {"training_iteration_time_ms": 3096.413, "sample_time_ms": 3085.639, "load_time_ms": 0.305, "load_throughput": 1181032.022, "learn_time_ms": 9.687, "learn_throughput": 37164.235, "synch_weights_time_ms": 0.734}, "counters": {"num_env_steps_sampled": 1404720, "num_env_steps_trained": 1404720, "num_agent_steps_sampled": 1404720, "num_agent_steps_trained": 1404720}, "done": false, "episodes_total": 5302, "training_iteration": 1118, "trial_id": "68078_00000", "date": "2023-08-05_10-30-29", "timestamp": 1691220629, "time_this_iter_s": 12.430010080337524, "time_total_s": 14509.689734697342, "pid": 54946, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[1400000, 5e-09], [1405400, 8e-09], [1410800, 2.5e-09], [1416200, 2.5e-09], [1421600, 2.5e-09], [1427000, 2.5e-09], [1432400, 1e-09], [1437800, 1e-09], [1443200, 1e-09], [1448600, 5e-10], [1454000, 5e-10], [1459400, 5e-10], [1464800, 5e-10], [1470200, 1e-10], [1475600, 1e-10], [1481000, 1e-10], [1486400, 1e-10], [1491800, 5e-11], [1497200, 5e-11], [1502600, 2.5e-11], [1508000, 2.5e-11], [1513400, 1e-11], [1518800, 1e-11], [1524200, 5e-12], [1529600, 5e-12], [1535000, 1e-12]], "grad_clip": 5, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.2, "final_epsilon": 0.01, "epsilon_timesteps": 1401170}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x3061b8b80>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 227.48238730430603, "iterations_since_restore": 18, "perf": {"cpu_util_percent": 28.705882352941178, "ram_util_percent": 69.04705882352941}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 7.592592592592592e-09, "entropy_coeff": 0.1, "policy_entropy": -322.27666625976565, "policy_loss": -2051096.03125, "vf_loss": 20945279.3}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 373.0, "diff_num_grad_updates_vs_sampler_policy": 372.0}}, "num_env_steps_sampled": 1406160, "num_env_steps_trained": 1406160, "num_agent_steps_sampled": 1406160, "num_agent_steps_trained": 1406160}, "sampler_results": {"episode_reward_max": -3541.0503481917694, "episode_reward_min": -3634.5049529545286, "episode_reward_mean": -3551.3669028025347, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3549.037036123015, -3549.0042802439984, -3556.9165450507317, -3556.425604484131, -3579.5606359965905, -3554.5587335093637, -3558.5509476504776, -3558.1416054821716, -3545.6724673899225, -3618.2340839301255, -3548.927726494181, -3547.552260505779, -3546.921394619684, -3554.0593031889484, -3545.5010284891423, -3550.7689397104114, -3545.753746589813, -3541.0547551462187, -3542.938250114688, -3545.993290424746, -3545.1354260959706, -3553.362149148736, -3544.0388889105407, -3549.9316400437892, -3549.39529152929, -3547.7973748347345, -3552.4409423032403, -3558.688862480492, -3545.3599684208316, -3634.5049529545286, -3543.9360306829058, -3545.4643868304174, -3545.6020746271856, -3546.266420774299, -3547.5945117515953, -3546.2515639788735, -3547.180654663955, -3542.5744282811743, -3544.3693668875094, -3551.0170721001214, -3544.0199045456034, -3555.9008252174585, -3547.052852118063, -3545.461085477762, -3547.521011190102, -3554.165795312169, -3550.2261498743355, -3552.7367250934403, -3556.950081432851, -3551.8274508706522, -3542.322873074976, -3555.148544277189, -3548.850835727826, -3545.449122148641, -3543.8650958880057, -3547.4566727516185, -3545.9979029870665, -3544.4425739389712, -3541.0547551462187, -3558.430752215632, -3552.3085968989235, -3542.488506293041, -3551.9521612813114, -3550.3427946578804, -3541.0503481917694, -3548.596138550916, -3548.530202380513, -3546.9339454621813, -3545.8715705840937, -3552.167853757343, -3547.5017446107067, -3557.0902630512483, -3554.60137859827, -3553.3447340824177, -3544.3718200565513], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.367168005264008, "mean_inference_ms": 0.3804542055396636, "mean_action_processing_ms": 0.09289328342034757, "mean_env_wait_ms": 1.3506457735116304, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0037438074747721353, "StateBufferConnector_ms": 0.0027558008829752603, "ViewRequirementAgentConnector_ms": 0.06595516204833984}}, "episode_reward_max": -3541.0503481917694, "episode_reward_min": -3634.5049529545286, "episode_reward_mean": -3551.3669028025347, "episode_len_mean": 360.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-3549.037036123015, -3549.0042802439984, -3556.9165450507317, -3556.425604484131, -3579.5606359965905, -3554.5587335093637, -3558.5509476504776, -3558.1416054821716, -3545.6724673899225, -3618.2340839301255, -3548.927726494181, -3547.552260505779, -3546.921394619684, -3554.0593031889484, -3545.5010284891423, -3550.7689397104114, -3545.753746589813, -3541.0547551462187, -3542.938250114688, -3545.993290424746, -3545.1354260959706, -3553.362149148736, -3544.0388889105407, -3549.9316400437892, -3549.39529152929, -3547.7973748347345, -3552.4409423032403, -3558.688862480492, -3545.3599684208316, -3634.5049529545286, -3543.9360306829058, -3545.4643868304174, -3545.6020746271856, -3546.266420774299, -3547.5945117515953, -3546.2515639788735, -3547.180654663955, -3542.5744282811743, -3544.3693668875094, -3551.0170721001214, -3544.0199045456034, -3555.9008252174585, -3547.052852118063, -3545.461085477762, -3547.521011190102, -3554.165795312169, -3550.2261498743355, -3552.7367250934403, -3556.950081432851, -3551.8274508706522, -3542.322873074976, -3555.148544277189, -3548.850835727826, -3545.449122148641, -3543.8650958880057, -3547.4566727516185, -3545.9979029870665, -3544.4425739389712, -3541.0547551462187, -3558.430752215632, -3552.3085968989235, -3542.488506293041, -3551.9521612813114, -3550.3427946578804, -3541.0503481917694, -3548.596138550916, -3548.530202380513, -3546.9339454621813, -3545.8715705840937, -3552.167853757343, -3547.5017446107067, -3557.0902630512483, -3554.60137859827, -3553.3447340824177, -3544.3718200565513], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.367168005264008, "mean_inference_ms": 0.3804542055396636, "mean_action_processing_ms": 0.09289328342034757, "mean_env_wait_ms": 1.3506457735116304, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0037438074747721353, "StateBufferConnector_ms": 0.0027558008829752603, "ViewRequirementAgentConnector_ms": 0.06595516204833984}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1406160, "num_agent_steps_trained": 1406160, "num_env_steps_sampled": 1406160, "num_env_steps_trained": 1406160, "num_env_steps_sampled_this_iter": 1440, "num_env_steps_trained_this_iter": 1440, "num_env_steps_sampled_throughput_per_sec": 115.97766986415392, "num_env_steps_trained_throughput_per_sec": 115.97766986415392, "timesteps_total": 1406160, "num_steps_trained_this_iter": 1440, "agent_timesteps_total": 1406160, "timers": {"training_iteration_time_ms": 3104.365, "sample_time_ms": 3093.461, "load_time_ms": 0.305, "load_throughput": 1181956.509, "learn_time_ms": 9.799, "learn_throughput": 36738.519, "synch_weights_time_ms": 0.752}, "counters": {"num_env_steps_sampled": 1406160, "num_env_steps_trained": 1406160, "num_agent_steps_sampled": 1406160, "num_agent_steps_trained": 1406160}, "done": false, "episodes_total": 5306, "training_iteration": 1119, "trial_id": "68078_00000", "date": "2023-08-05_10-30-41", "timestamp": 1691220641, "time_this_iter_s": 12.419018030166626, "time_total_s": 14522.108752727509, "pid": 54946, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[1400000, 5e-09], [1405400, 8e-09], [1410800, 2.5e-09], [1416200, 2.5e-09], [1421600, 2.5e-09], [1427000, 2.5e-09], [1432400, 1e-09], [1437800, 1e-09], [1443200, 1e-09], [1448600, 5e-10], [1454000, 5e-10], [1459400, 5e-10], [1464800, 5e-10], [1470200, 1e-10], [1475600, 1e-10], [1481000, 1e-10], [1486400, 1e-10], [1491800, 5e-11], [1497200, 5e-11], [1502600, 2.5e-11], [1508000, 2.5e-11], [1513400, 1e-11], [1518800, 1e-11], [1524200, 5e-12], [1529600, 5e-12], [1535000, 1e-12]], "grad_clip": 5, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.2, "final_epsilon": 0.01, "epsilon_timesteps": 1401170}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x3061b8b80>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 239.90140533447266, "iterations_since_restore": 19, "perf": {"cpu_util_percent": 27.211111111111116, "ram_util_percent": 68.94444444444446}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 6.125925925925926e-09, "entropy_coeff": 0.1, "policy_entropy": -322.3230834960938, "policy_loss": -4980060.41875, "vf_loss": 20974083.6}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 393.0, "diff_num_grad_updates_vs_sampler_policy": 392.0}}, "num_env_steps_sampled": 1407600, "num_env_steps_trained": 1407600, "num_agent_steps_sampled": 1407600, "num_agent_steps_trained": 1407600}, "sampler_results": {"episode_reward_max": -3541.0503481917694, "episode_reward_min": -3634.5049529545286, "episode_reward_mean": -3551.2665595933377, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3549.037036123015, -3549.0042802439984, -3556.9165450507317, -3556.425604484131, -3579.5606359965905, -3554.5587335093637, -3558.5509476504776, -3558.1416054821716, -3545.6724673899225, -3618.2340839301255, -3548.927726494181, -3547.552260505779, -3546.921394619684, -3554.0593031889484, -3545.5010284891423, -3550.7689397104114, -3545.753746589813, -3541.0547551462187, -3542.938250114688, -3545.993290424746, -3545.1354260959706, -3553.362149148736, -3544.0388889105407, -3549.9316400437892, -3549.39529152929, -3547.7973748347345, -3552.4409423032403, -3558.688862480492, -3545.3599684208316, -3634.5049529545286, -3543.9360306829058, -3545.4643868304174, -3545.6020746271856, -3546.266420774299, -3547.5945117515953, -3546.2515639788735, -3547.180654663955, -3542.5744282811743, -3544.3693668875094, -3551.0170721001214, -3544.0199045456034, -3555.9008252174585, -3547.052852118063, -3545.461085477762, -3547.521011190102, -3554.165795312169, -3550.2261498743355, -3552.7367250934403, -3556.950081432851, -3551.8274508706522, -3542.322873074976, -3555.148544277189, -3548.850835727826, -3545.449122148641, -3543.8650958880057, -3547.4566727516185, -3545.9979029870665, -3544.4425739389712, -3541.0547551462187, -3558.430752215632, -3552.3085968989235, -3542.488506293041, -3551.9521612813114, -3550.3427946578804, -3541.0503481917694, -3548.596138550916, -3548.530202380513, -3546.9339454621813, -3545.8715705840937, -3552.167853757343, -3547.5017446107067, -3557.0902630512483, -3554.60137859827, -3553.3447340824177, -3544.3718200565513, -3549.0942537353635, -3551.9175093796453, -3549.1993638290223, -3547.3293707395324], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.363642408214596, "mean_inference_ms": 0.3805126566390598, "mean_action_processing_ms": 0.0929060813293331, "mean_env_wait_ms": 1.3351556700058413, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0037265729300583464, "StateBufferConnector_ms": 0.002759619604183149, "ViewRequirementAgentConnector_ms": 0.06601569018786467}}, "episode_reward_max": -3541.0503481917694, "episode_reward_min": -3634.5049529545286, "episode_reward_mean": -3551.2665595933377, "episode_len_mean": 360.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-3549.037036123015, -3549.0042802439984, -3556.9165450507317, -3556.425604484131, -3579.5606359965905, -3554.5587335093637, -3558.5509476504776, -3558.1416054821716, -3545.6724673899225, -3618.2340839301255, -3548.927726494181, -3547.552260505779, -3546.921394619684, -3554.0593031889484, -3545.5010284891423, -3550.7689397104114, -3545.753746589813, -3541.0547551462187, -3542.938250114688, -3545.993290424746, -3545.1354260959706, -3553.362149148736, -3544.0388889105407, -3549.9316400437892, -3549.39529152929, -3547.7973748347345, -3552.4409423032403, -3558.688862480492, -3545.3599684208316, -3634.5049529545286, -3543.9360306829058, -3545.4643868304174, -3545.6020746271856, -3546.266420774299, -3547.5945117515953, -3546.2515639788735, -3547.180654663955, -3542.5744282811743, -3544.3693668875094, -3551.0170721001214, -3544.0199045456034, -3555.9008252174585, -3547.052852118063, -3545.461085477762, -3547.521011190102, -3554.165795312169, -3550.2261498743355, -3552.7367250934403, -3556.950081432851, -3551.8274508706522, -3542.322873074976, -3555.148544277189, -3548.850835727826, -3545.449122148641, -3543.8650958880057, -3547.4566727516185, -3545.9979029870665, -3544.4425739389712, -3541.0547551462187, -3558.430752215632, -3552.3085968989235, -3542.488506293041, -3551.9521612813114, -3550.3427946578804, -3541.0503481917694, -3548.596138550916, -3548.530202380513, -3546.9339454621813, -3545.8715705840937, -3552.167853757343, -3547.5017446107067, -3557.0902630512483, -3554.60137859827, -3553.3447340824177, -3544.3718200565513, -3549.0942537353635, -3551.9175093796453, -3549.1993638290223, -3547.3293707395324], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.363642408214596, "mean_inference_ms": 0.3805126566390598, "mean_action_processing_ms": 0.0929060813293331, "mean_env_wait_ms": 1.3351556700058413, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0037265729300583464, "StateBufferConnector_ms": 0.002759619604183149, "ViewRequirementAgentConnector_ms": 0.06601569018786467}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1407600, "num_agent_steps_trained": 1407600, "num_env_steps_sampled": 1407600, "num_env_steps_trained": 1407600, "num_env_steps_sampled_this_iter": 1440, "num_env_steps_trained_this_iter": 1440, "num_env_steps_sampled_throughput_per_sec": 114.9291988643321, "num_env_steps_trained_throughput_per_sec": 114.9291988643321, "timesteps_total": 1407600, "num_steps_trained_this_iter": 1440, "agent_timesteps_total": 1407600, "timers": {"training_iteration_time_ms": 3117.15, "sample_time_ms": 3106.269, "load_time_ms": 0.303, "load_throughput": 1189967.247, "learn_time_ms": 9.778, "learn_throughput": 36816.9, "synch_weights_time_ms": 0.752}, "counters": {"num_env_steps_sampled": 1407600, "num_env_steps_trained": 1407600, "num_agent_steps_sampled": 1407600, "num_agent_steps_trained": 1407600}, "done": false, "episodes_total": 5310, "training_iteration": 1120, "trial_id": "68078_00000", "date": "2023-08-05_10-30-54", "timestamp": 1691220654, "time_this_iter_s": 12.532255172729492, "time_total_s": 14534.641007900238, "pid": 54946, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[1400000, 5e-09], [1405400, 8e-09], [1410800, 2.5e-09], [1416200, 2.5e-09], [1421600, 2.5e-09], [1427000, 2.5e-09], [1432400, 1e-09], [1437800, 1e-09], [1443200, 1e-09], [1448600, 5e-10], [1454000, 5e-10], [1459400, 5e-10], [1464800, 5e-10], [1470200, 1e-10], [1475600, 1e-10], [1481000, 1e-10], [1486400, 1e-10], [1491800, 5e-11], [1497200, 5e-11], [1502600, 2.5e-11], [1508000, 2.5e-11], [1513400, 1e-11], [1518800, 1e-11], [1524200, 5e-12], [1529600, 5e-12], [1535000, 1e-12]], "grad_clip": 5, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.2, "final_epsilon": 0.01, "epsilon_timesteps": 1401170}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x3061b8b80>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 252.43366050720215, "iterations_since_restore": 20, "perf": {"cpu_util_percent": 27.87222222222222, "ram_util_percent": 69.01666666666667}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 4.659259259259259e-09, "entropy_coeff": 0.1, "policy_entropy": -322.3348815917969, "policy_loss": -3004689.609375, "vf_loss": 20966212.3}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 413.0, "diff_num_grad_updates_vs_sampler_policy": 412.0}}, "num_env_steps_sampled": 1409040, "num_env_steps_trained": 1409040, "num_agent_steps_sampled": 1409040, "num_agent_steps_trained": 1409040}, "sampler_results": {"episode_reward_max": -3541.0503481917694, "episode_reward_min": -3634.5049529545286, "episode_reward_mean": -3551.069531373766, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3549.037036123015, -3549.0042802439984, -3556.9165450507317, -3556.425604484131, -3579.5606359965905, -3554.5587335093637, -3558.5509476504776, -3558.1416054821716, -3545.6724673899225, -3618.2340839301255, -3548.927726494181, -3547.552260505779, -3546.921394619684, -3554.0593031889484, -3545.5010284891423, -3550.7689397104114, -3545.753746589813, -3541.0547551462187, -3542.938250114688, -3545.993290424746, -3545.1354260959706, -3553.362149148736, -3544.0388889105407, -3549.9316400437892, -3549.39529152929, -3547.7973748347345, -3552.4409423032403, -3558.688862480492, -3545.3599684208316, -3634.5049529545286, -3543.9360306829058, -3545.4643868304174, -3545.6020746271856, -3546.266420774299, -3547.5945117515953, -3546.2515639788735, -3547.180654663955, -3542.5744282811743, -3544.3693668875094, -3551.0170721001214, -3544.0199045456034, -3555.9008252174585, -3547.052852118063, -3545.461085477762, -3547.521011190102, -3554.165795312169, -3550.2261498743355, -3552.7367250934403, -3556.950081432851, -3551.8274508706522, -3542.322873074976, -3555.148544277189, -3548.850835727826, -3545.449122148641, -3543.8650958880057, -3547.4566727516185, -3545.9979029870665, -3544.4425739389712, -3541.0547551462187, -3558.430752215632, -3552.3085968989235, -3542.488506293041, -3551.9521612813114, -3550.3427946578804, -3541.0503481917694, -3548.596138550916, -3548.530202380513, -3546.9339454621813, -3545.8715705840937, -3552.167853757343, -3547.5017446107067, -3557.0902630512483, -3554.60137859827, -3553.3447340824177, -3544.3718200565513, -3549.0942537353635, -3551.9175093796453, -3549.1993638290223, -3547.3293707395324, -3544.5091473304215, -3552.7155455678558, -3542.806241773586, -3548.681961477035], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.360416721369979, "mean_inference_ms": 0.3805955862639504, "mean_action_processing_ms": 0.09292243796656623, "mean_env_wait_ms": 1.320953399236222, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0037842486278120294, "StateBufferConnector_ms": 0.0027840396007859564, "ViewRequirementAgentConnector_ms": 0.06661415100097656}}, "episode_reward_max": -3541.0503481917694, "episode_reward_min": -3634.5049529545286, "episode_reward_mean": -3551.069531373766, "episode_len_mean": 360.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-3549.037036123015, -3549.0042802439984, -3556.9165450507317, -3556.425604484131, -3579.5606359965905, -3554.5587335093637, -3558.5509476504776, -3558.1416054821716, -3545.6724673899225, -3618.2340839301255, -3548.927726494181, -3547.552260505779, -3546.921394619684, -3554.0593031889484, -3545.5010284891423, -3550.7689397104114, -3545.753746589813, -3541.0547551462187, -3542.938250114688, -3545.993290424746, -3545.1354260959706, -3553.362149148736, -3544.0388889105407, -3549.9316400437892, -3549.39529152929, -3547.7973748347345, -3552.4409423032403, -3558.688862480492, -3545.3599684208316, -3634.5049529545286, -3543.9360306829058, -3545.4643868304174, -3545.6020746271856, -3546.266420774299, -3547.5945117515953, -3546.2515639788735, -3547.180654663955, -3542.5744282811743, -3544.3693668875094, -3551.0170721001214, -3544.0199045456034, -3555.9008252174585, -3547.052852118063, -3545.461085477762, -3547.521011190102, -3554.165795312169, -3550.2261498743355, -3552.7367250934403, -3556.950081432851, -3551.8274508706522, -3542.322873074976, -3555.148544277189, -3548.850835727826, -3545.449122148641, -3543.8650958880057, -3547.4566727516185, -3545.9979029870665, -3544.4425739389712, -3541.0547551462187, -3558.430752215632, -3552.3085968989235, -3542.488506293041, -3551.9521612813114, -3550.3427946578804, -3541.0503481917694, -3548.596138550916, -3548.530202380513, -3546.9339454621813, -3545.8715705840937, -3552.167853757343, -3547.5017446107067, -3557.0902630512483, -3554.60137859827, -3553.3447340824177, -3544.3718200565513, -3549.0942537353635, -3551.9175093796453, -3549.1993638290223, -3547.3293707395324, -3544.5091473304215, -3552.7155455678558, -3542.806241773586, -3548.681961477035], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.360416721369979, "mean_inference_ms": 0.3805955862639504, "mean_action_processing_ms": 0.09292243796656623, "mean_env_wait_ms": 1.320953399236222, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0037842486278120294, "StateBufferConnector_ms": 0.0027840396007859564, "ViewRequirementAgentConnector_ms": 0.06661415100097656}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1409040, "num_agent_steps_trained": 1409040, "num_env_steps_sampled": 1409040, "num_env_steps_trained": 1409040, "num_env_steps_sampled_this_iter": 1440, "num_env_steps_trained_this_iter": 1440, "num_env_steps_sampled_throughput_per_sec": 113.85508077779498, "num_env_steps_trained_throughput_per_sec": 113.85508077779498, "timesteps_total": 1409040, "num_steps_trained_this_iter": 1440, "agent_timesteps_total": 1409040, "timers": {"training_iteration_time_ms": 3137.822, "sample_time_ms": 3126.912, "load_time_ms": 0.304, "load_throughput": 1184088.331, "learn_time_ms": 9.815, "learn_throughput": 36679.617, "synch_weights_time_ms": 0.743}, "counters": {"num_env_steps_sampled": 1409040, "num_env_steps_trained": 1409040, "num_agent_steps_sampled": 1409040, "num_agent_steps_trained": 1409040}, "done": false, "episodes_total": 5314, "training_iteration": 1121, "trial_id": "68078_00000", "date": "2023-08-05_10-31-06", "timestamp": 1691220666, "time_this_iter_s": 12.650630235671997, "time_total_s": 14547.29163813591, "pid": 54946, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[1400000, 5e-09], [1405400, 8e-09], [1410800, 2.5e-09], [1416200, 2.5e-09], [1421600, 2.5e-09], [1427000, 2.5e-09], [1432400, 1e-09], [1437800, 1e-09], [1443200, 1e-09], [1448600, 5e-10], [1454000, 5e-10], [1459400, 5e-10], [1464800, 5e-10], [1470200, 1e-10], [1475600, 1e-10], [1481000, 1e-10], [1486400, 1e-10], [1491800, 5e-11], [1497200, 5e-11], [1502600, 2.5e-11], [1508000, 2.5e-11], [1513400, 1e-11], [1518800, 1e-11], [1524200, 5e-12], [1529600, 5e-12], [1535000, 1e-12]], "grad_clip": 5, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.2, "final_epsilon": 0.01, "epsilon_timesteps": 1401170}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x3061b8b80>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 265.08429074287415, "iterations_since_restore": 21, "perf": {"cpu_util_percent": 26.022222222222222, "ram_util_percent": 68.69444444444444}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 3.1925925925925923e-09, "entropy_coeff": 0.1, "policy_entropy": -322.3586791992187, "policy_loss": -5584365.0625, "vf_loss": 20995139.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 433.0, "diff_num_grad_updates_vs_sampler_policy": 432.0}}, "num_env_steps_sampled": 1410480, "num_env_steps_trained": 1410480, "num_agent_steps_sampled": 1410480, "num_agent_steps_trained": 1410480}, "sampler_results": {"episode_reward_max": -3541.0503481917694, "episode_reward_min": -3634.5049529545286, "episode_reward_mean": -3550.8641571054964, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3549.037036123015, -3549.0042802439984, -3556.9165450507317, -3556.425604484131, -3579.5606359965905, -3554.5587335093637, -3558.5509476504776, -3558.1416054821716, -3545.6724673899225, -3618.2340839301255, -3548.927726494181, -3547.552260505779, -3546.921394619684, -3554.0593031889484, -3545.5010284891423, -3550.7689397104114, -3545.753746589813, -3541.0547551462187, -3542.938250114688, -3545.993290424746, -3545.1354260959706, -3553.362149148736, -3544.0388889105407, -3549.9316400437892, -3549.39529152929, -3547.7973748347345, -3552.4409423032403, -3558.688862480492, -3545.3599684208316, -3634.5049529545286, -3543.9360306829058, -3545.4643868304174, -3545.6020746271856, -3546.266420774299, -3547.5945117515953, -3546.2515639788735, -3547.180654663955, -3542.5744282811743, -3544.3693668875094, -3551.0170721001214, -3544.0199045456034, -3555.9008252174585, -3547.052852118063, -3545.461085477762, -3547.521011190102, -3554.165795312169, -3550.2261498743355, -3552.7367250934403, -3556.950081432851, -3551.8274508706522, -3542.322873074976, -3555.148544277189, -3548.850835727826, -3545.449122148641, -3543.8650958880057, -3547.4566727516185, -3545.9979029870665, -3544.4425739389712, -3541.0547551462187, -3558.430752215632, -3552.3085968989235, -3542.488506293041, -3551.9521612813114, -3550.3427946578804, -3541.0503481917694, -3548.596138550916, -3548.530202380513, -3546.9339454621813, -3545.8715705840937, -3552.167853757343, -3547.5017446107067, -3557.0902630512483, -3554.60137859827, -3553.3447340824177, -3544.3718200565513, -3549.0942537353635, -3551.9175093796453, -3549.1993638290223, -3547.3293707395324, -3544.5091473304215, -3552.7155455678558, -3542.806241773586, -3548.681961477035, -3542.7530494827456, -3551.5505413099872, -3544.587980402555, -3547.5189929602807], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.357378103721915, "mean_inference_ms": 0.38069514540155397, "mean_action_processing_ms": 0.09294209024517573, "mean_env_wait_ms": 1.3077909166614525, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003793047762465203, "StateBufferConnector_ms": 0.0027829203112372035, "ViewRequirementAgentConnector_ms": 0.06657523670415769}}, "episode_reward_max": -3541.0503481917694, "episode_reward_min": -3634.5049529545286, "episode_reward_mean": -3550.8641571054964, "episode_len_mean": 360.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-3549.037036123015, -3549.0042802439984, -3556.9165450507317, -3556.425604484131, -3579.5606359965905, -3554.5587335093637, -3558.5509476504776, -3558.1416054821716, -3545.6724673899225, -3618.2340839301255, -3548.927726494181, -3547.552260505779, -3546.921394619684, -3554.0593031889484, -3545.5010284891423, -3550.7689397104114, -3545.753746589813, -3541.0547551462187, -3542.938250114688, -3545.993290424746, -3545.1354260959706, -3553.362149148736, -3544.0388889105407, -3549.9316400437892, -3549.39529152929, -3547.7973748347345, -3552.4409423032403, -3558.688862480492, -3545.3599684208316, -3634.5049529545286, -3543.9360306829058, -3545.4643868304174, -3545.6020746271856, -3546.266420774299, -3547.5945117515953, -3546.2515639788735, -3547.180654663955, -3542.5744282811743, -3544.3693668875094, -3551.0170721001214, -3544.0199045456034, -3555.9008252174585, -3547.052852118063, -3545.461085477762, -3547.521011190102, -3554.165795312169, -3550.2261498743355, -3552.7367250934403, -3556.950081432851, -3551.8274508706522, -3542.322873074976, -3555.148544277189, -3548.850835727826, -3545.449122148641, -3543.8650958880057, -3547.4566727516185, -3545.9979029870665, -3544.4425739389712, -3541.0547551462187, -3558.430752215632, -3552.3085968989235, -3542.488506293041, -3551.9521612813114, -3550.3427946578804, -3541.0503481917694, -3548.596138550916, -3548.530202380513, -3546.9339454621813, -3545.8715705840937, -3552.167853757343, -3547.5017446107067, -3557.0902630512483, -3554.60137859827, -3553.3447340824177, -3544.3718200565513, -3549.0942537353635, -3551.9175093796453, -3549.1993638290223, -3547.3293707395324, -3544.5091473304215, -3552.7155455678558, -3542.806241773586, -3548.681961477035, -3542.7530494827456, -3551.5505413099872, -3544.587980402555, -3547.5189929602807], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.357378103721915, "mean_inference_ms": 0.38069514540155397, "mean_action_processing_ms": 0.09294209024517573, "mean_env_wait_ms": 1.3077909166614525, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003793047762465203, "StateBufferConnector_ms": 0.0027829203112372035, "ViewRequirementAgentConnector_ms": 0.06657523670415769}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1410480, "num_agent_steps_trained": 1410480, "num_env_steps_sampled": 1410480, "num_env_steps_trained": 1410480, "num_env_steps_sampled_this_iter": 1440, "num_env_steps_trained_this_iter": 1440, "num_env_steps_sampled_throughput_per_sec": 114.87582059554305, "num_env_steps_trained_throughput_per_sec": 114.87582059554305, "timesteps_total": 1410480, "num_steps_trained_this_iter": 1440, "agent_timesteps_total": 1410480, "timers": {"training_iteration_time_ms": 3146.889, "sample_time_ms": 3135.98, "load_time_ms": 0.306, "load_throughput": 1177715.81, "learn_time_ms": 9.826, "learn_throughput": 36636.809, "synch_weights_time_ms": 0.73}, "counters": {"num_env_steps_sampled": 1410480, "num_env_steps_trained": 1410480, "num_agent_steps_sampled": 1410480, "num_agent_steps_trained": 1410480}, "done": false, "episodes_total": 5318, "training_iteration": 1122, "trial_id": "68078_00000", "date": "2023-08-05_10-31-19", "timestamp": 1691220679, "time_this_iter_s": 12.53821063041687, "time_total_s": 14559.829848766327, "pid": 54946, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[1400000, 5e-09], [1405400, 8e-09], [1410800, 2.5e-09], [1416200, 2.5e-09], [1421600, 2.5e-09], [1427000, 2.5e-09], [1432400, 1e-09], [1437800, 1e-09], [1443200, 1e-09], [1448600, 5e-10], [1454000, 5e-10], [1459400, 5e-10], [1464800, 5e-10], [1470200, 1e-10], [1475600, 1e-10], [1481000, 1e-10], [1486400, 1e-10], [1491800, 5e-11], [1497200, 5e-11], [1502600, 2.5e-11], [1508000, 2.5e-11], [1513400, 1e-11], [1518800, 1e-11], [1524200, 5e-12], [1529600, 5e-12], [1535000, 1e-12]], "grad_clip": 5, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.2, "final_epsilon": 0.01, "epsilon_timesteps": 1401170}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x3061b8b80>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 277.622501373291, "iterations_since_restore": 22, "perf": {"cpu_util_percent": 29.61111111111111, "ram_util_percent": 68.81111111111112}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 2.5e-09, "entropy_coeff": 0.1, "policy_entropy": -322.2188293457031, "policy_loss": -4015234.95625, "vf_loss": 20939454.7}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 453.0, "diff_num_grad_updates_vs_sampler_policy": 452.0}}, "num_env_steps_sampled": 1411920, "num_env_steps_trained": 1411920, "num_agent_steps_sampled": 1411920, "num_agent_steps_trained": 1411920}, "sampler_results": {"episode_reward_max": -3541.0503481917694, "episode_reward_min": -3634.5049529545286, "episode_reward_mean": -3550.6838487117648, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3549.037036123015, -3549.0042802439984, -3556.9165450507317, -3556.425604484131, -3579.5606359965905, -3554.5587335093637, -3558.5509476504776, -3558.1416054821716, -3545.6724673899225, -3618.2340839301255, -3548.927726494181, -3547.552260505779, -3546.921394619684, -3554.0593031889484, -3545.5010284891423, -3550.7689397104114, -3545.753746589813, -3541.0547551462187, -3542.938250114688, -3545.993290424746, -3545.1354260959706, -3553.362149148736, -3544.0388889105407, -3549.9316400437892, -3549.39529152929, -3547.7973748347345, -3552.4409423032403, -3558.688862480492, -3545.3599684208316, -3634.5049529545286, -3543.9360306829058, -3545.4643868304174, -3545.6020746271856, -3546.266420774299, -3547.5945117515953, -3546.2515639788735, -3547.180654663955, -3542.5744282811743, -3544.3693668875094, -3551.0170721001214, -3544.0199045456034, -3555.9008252174585, -3547.052852118063, -3545.461085477762, -3547.521011190102, -3554.165795312169, -3550.2261498743355, -3552.7367250934403, -3556.950081432851, -3551.8274508706522, -3542.322873074976, -3555.148544277189, -3548.850835727826, -3545.449122148641, -3543.8650958880057, -3547.4566727516185, -3545.9979029870665, -3544.4425739389712, -3541.0547551462187, -3558.430752215632, -3552.3085968989235, -3542.488506293041, -3551.9521612813114, -3550.3427946578804, -3541.0503481917694, -3548.596138550916, -3548.530202380513, -3546.9339454621813, -3545.8715705840937, -3552.167853757343, -3547.5017446107067, -3557.0902630512483, -3554.60137859827, -3553.3447340824177, -3544.3718200565513, -3549.0942537353635, -3551.9175093796453, -3549.1993638290223, -3547.3293707395324, -3544.5091473304215, -3552.7155455678558, -3542.806241773586, -3548.681961477035, -3542.7530494827456, -3551.5505413099872, -3544.587980402555, -3547.5189929602807, -3543.9826496059522, -3549.063141630265, -3550.6318788461967, -3543.3708945100543], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.35463922100098, "mean_inference_ms": 0.38077663366799014, "mean_action_processing_ms": 0.09295826909056465, "mean_env_wait_ms": 1.2955730071341016, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003766489552927541, "StateBufferConnector_ms": 0.0027779694441910628, "ViewRequirementAgentConnector_ms": 0.06647476783165565}}, "episode_reward_max": -3541.0503481917694, "episode_reward_min": -3634.5049529545286, "episode_reward_mean": -3550.6838487117648, "episode_len_mean": 360.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-3549.037036123015, -3549.0042802439984, -3556.9165450507317, -3556.425604484131, -3579.5606359965905, -3554.5587335093637, -3558.5509476504776, -3558.1416054821716, -3545.6724673899225, -3618.2340839301255, -3548.927726494181, -3547.552260505779, -3546.921394619684, -3554.0593031889484, -3545.5010284891423, -3550.7689397104114, -3545.753746589813, -3541.0547551462187, -3542.938250114688, -3545.993290424746, -3545.1354260959706, -3553.362149148736, -3544.0388889105407, -3549.9316400437892, -3549.39529152929, -3547.7973748347345, -3552.4409423032403, -3558.688862480492, -3545.3599684208316, -3634.5049529545286, -3543.9360306829058, -3545.4643868304174, -3545.6020746271856, -3546.266420774299, -3547.5945117515953, -3546.2515639788735, -3547.180654663955, -3542.5744282811743, -3544.3693668875094, -3551.0170721001214, -3544.0199045456034, -3555.9008252174585, -3547.052852118063, -3545.461085477762, -3547.521011190102, -3554.165795312169, -3550.2261498743355, -3552.7367250934403, -3556.950081432851, -3551.8274508706522, -3542.322873074976, -3555.148544277189, -3548.850835727826, -3545.449122148641, -3543.8650958880057, -3547.4566727516185, -3545.9979029870665, -3544.4425739389712, -3541.0547551462187, -3558.430752215632, -3552.3085968989235, -3542.488506293041, -3551.9521612813114, -3550.3427946578804, -3541.0503481917694, -3548.596138550916, -3548.530202380513, -3546.9339454621813, -3545.8715705840937, -3552.167853757343, -3547.5017446107067, -3557.0902630512483, -3554.60137859827, -3553.3447340824177, -3544.3718200565513, -3549.0942537353635, -3551.9175093796453, -3549.1993638290223, -3547.3293707395324, -3544.5091473304215, -3552.7155455678558, -3542.806241773586, -3548.681961477035, -3542.7530494827456, -3551.5505413099872, -3544.587980402555, -3547.5189929602807, -3543.9826496059522, -3549.063141630265, -3550.6318788461967, -3543.3708945100543], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.35463922100098, "mean_inference_ms": 0.38077663366799014, "mean_action_processing_ms": 0.09295826909056465, "mean_env_wait_ms": 1.2955730071341016, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003766489552927541, "StateBufferConnector_ms": 0.0027779694441910628, "ViewRequirementAgentConnector_ms": 0.06647476783165565}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1411920, "num_agent_steps_trained": 1411920, "num_env_steps_sampled": 1411920, "num_env_steps_trained": 1411920, "num_env_steps_sampled_this_iter": 1440, "num_env_steps_trained_this_iter": 1440, "num_env_steps_sampled_throughput_per_sec": 114.10785854829578, "num_env_steps_trained_throughput_per_sec": 114.10785854829578, "timesteps_total": 1411920, "num_steps_trained_this_iter": 1440, "agent_timesteps_total": 1411920, "timers": {"training_iteration_time_ms": 3146.329, "sample_time_ms": 3135.223, "load_time_ms": 0.307, "load_throughput": 1174326.832, "learn_time_ms": 10.014, "learn_throughput": 35950.236, "synch_weights_time_ms": 0.737}, "counters": {"num_env_steps_sampled": 1411920, "num_env_steps_trained": 1411920, "num_agent_steps_sampled": 1411920, "num_agent_steps_trained": 1411920}, "done": false, "episodes_total": 5322, "training_iteration": 1123, "trial_id": "68078_00000", "date": "2023-08-05_10-31-31", "timestamp": 1691220691, "time_this_iter_s": 12.622691631317139, "time_total_s": 14572.452540397644, "pid": 54946, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[1400000, 5e-09], [1405400, 8e-09], [1410800, 2.5e-09], [1416200, 2.5e-09], [1421600, 2.5e-09], [1427000, 2.5e-09], [1432400, 1e-09], [1437800, 1e-09], [1443200, 1e-09], [1448600, 5e-10], [1454000, 5e-10], [1459400, 5e-10], [1464800, 5e-10], [1470200, 1e-10], [1475600, 1e-10], [1481000, 1e-10], [1486400, 1e-10], [1491800, 5e-11], [1497200, 5e-11], [1502600, 2.5e-11], [1508000, 2.5e-11], [1513400, 1e-11], [1518800, 1e-11], [1524200, 5e-12], [1529600, 5e-12], [1535000, 1e-12]], "grad_clip": 5, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.2, "final_epsilon": 0.01, "epsilon_timesteps": 1401170}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x3061b8b80>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 290.24519300460815, "iterations_since_restore": 23, "perf": {"cpu_util_percent": 26.15, "ram_util_percent": 68.83888888888889}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 2.5e-09, "entropy_coeff": 0.1, "policy_entropy": -322.1897827148438, "policy_loss": 32885.053125, "vf_loss": 20933936.6}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 473.0, "diff_num_grad_updates_vs_sampler_policy": 472.0}}, "num_env_steps_sampled": 1413360, "num_env_steps_trained": 1413360, "num_agent_steps_sampled": 1413360, "num_agent_steps_trained": 1413360}, "sampler_results": {"episode_reward_max": -3541.0503481917694, "episode_reward_min": -3634.5049529545286, "episode_reward_mean": -3550.5416725824653, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3549.037036123015, -3549.0042802439984, -3556.9165450507317, -3556.425604484131, -3579.5606359965905, -3554.5587335093637, -3558.5509476504776, -3558.1416054821716, -3545.6724673899225, -3618.2340839301255, -3548.927726494181, -3547.552260505779, -3546.921394619684, -3554.0593031889484, -3545.5010284891423, -3550.7689397104114, -3545.753746589813, -3541.0547551462187, -3542.938250114688, -3545.993290424746, -3545.1354260959706, -3553.362149148736, -3544.0388889105407, -3549.9316400437892, -3549.39529152929, -3547.7973748347345, -3552.4409423032403, -3558.688862480492, -3545.3599684208316, -3634.5049529545286, -3543.9360306829058, -3545.4643868304174, -3545.6020746271856, -3546.266420774299, -3547.5945117515953, -3546.2515639788735, -3547.180654663955, -3542.5744282811743, -3544.3693668875094, -3551.0170721001214, -3544.0199045456034, -3555.9008252174585, -3547.052852118063, -3545.461085477762, -3547.521011190102, -3554.165795312169, -3550.2261498743355, -3552.7367250934403, -3556.950081432851, -3551.8274508706522, -3542.322873074976, -3555.148544277189, -3548.850835727826, -3545.449122148641, -3543.8650958880057, -3547.4566727516185, -3545.9979029870665, -3544.4425739389712, -3541.0547551462187, -3558.430752215632, -3552.3085968989235, -3542.488506293041, -3551.9521612813114, -3550.3427946578804, -3541.0503481917694, -3548.596138550916, -3548.530202380513, -3546.9339454621813, -3545.8715705840937, -3552.167853757343, -3547.5017446107067, -3557.0902630512483, -3554.60137859827, -3553.3447340824177, -3544.3718200565513, -3549.0942537353635, -3551.9175093796453, -3549.1993638290223, -3547.3293707395324, -3544.5091473304215, -3552.7155455678558, -3542.806241773586, -3548.681961477035, -3542.7530494827456, -3551.5505413099872, -3544.587980402555, -3547.5189929602807, -3543.9826496059522, -3549.063141630265, -3550.6318788461967, -3543.3708945100543, -3553.46249641705, -3546.1503509079953, -3544.2454623910853, -3545.3703528475035], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.352039773951095, "mean_inference_ms": 0.38087645563339145, "mean_action_processing_ms": 0.0929776011682571, "mean_env_wait_ms": 1.284250487498126, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0037697741859837584, "StateBufferConnector_ms": 0.0027902502762643913, "ViewRequirementAgentConnector_ms": 0.06678505947715357}}, "episode_reward_max": -3541.0503481917694, "episode_reward_min": -3634.5049529545286, "episode_reward_mean": -3550.5416725824653, "episode_len_mean": 360.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-3549.037036123015, -3549.0042802439984, -3556.9165450507317, -3556.425604484131, -3579.5606359965905, -3554.5587335093637, -3558.5509476504776, -3558.1416054821716, -3545.6724673899225, -3618.2340839301255, -3548.927726494181, -3547.552260505779, -3546.921394619684, -3554.0593031889484, -3545.5010284891423, -3550.7689397104114, -3545.753746589813, -3541.0547551462187, -3542.938250114688, -3545.993290424746, -3545.1354260959706, -3553.362149148736, -3544.0388889105407, -3549.9316400437892, -3549.39529152929, -3547.7973748347345, -3552.4409423032403, -3558.688862480492, -3545.3599684208316, -3634.5049529545286, -3543.9360306829058, -3545.4643868304174, -3545.6020746271856, -3546.266420774299, -3547.5945117515953, -3546.2515639788735, -3547.180654663955, -3542.5744282811743, -3544.3693668875094, -3551.0170721001214, -3544.0199045456034, -3555.9008252174585, -3547.052852118063, -3545.461085477762, -3547.521011190102, -3554.165795312169, -3550.2261498743355, -3552.7367250934403, -3556.950081432851, -3551.8274508706522, -3542.322873074976, -3555.148544277189, -3548.850835727826, -3545.449122148641, -3543.8650958880057, -3547.4566727516185, -3545.9979029870665, -3544.4425739389712, -3541.0547551462187, -3558.430752215632, -3552.3085968989235, -3542.488506293041, -3551.9521612813114, -3550.3427946578804, -3541.0503481917694, -3548.596138550916, -3548.530202380513, -3546.9339454621813, -3545.8715705840937, -3552.167853757343, -3547.5017446107067, -3557.0902630512483, -3554.60137859827, -3553.3447340824177, -3544.3718200565513, -3549.0942537353635, -3551.9175093796453, -3549.1993638290223, -3547.3293707395324, -3544.5091473304215, -3552.7155455678558, -3542.806241773586, -3548.681961477035, -3542.7530494827456, -3551.5505413099872, -3544.587980402555, -3547.5189929602807, -3543.9826496059522, -3549.063141630265, -3550.6318788461967, -3543.3708945100543, -3553.46249641705, -3546.1503509079953, -3544.2454623910853, -3545.3703528475035], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.352039773951095, "mean_inference_ms": 0.38087645563339145, "mean_action_processing_ms": 0.0929776011682571, "mean_env_wait_ms": 1.284250487498126, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0037697741859837584, "StateBufferConnector_ms": 0.0027902502762643913, "ViewRequirementAgentConnector_ms": 0.06678505947715357}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1413360, "num_agent_steps_trained": 1413360, "num_env_steps_sampled": 1413360, "num_env_steps_trained": 1413360, "num_env_steps_sampled_this_iter": 1440, "num_env_steps_trained_this_iter": 1440, "num_env_steps_sampled_throughput_per_sec": 114.32788916865036, "num_env_steps_trained_throughput_per_sec": 114.32788916865036, "timesteps_total": 1413360, "num_steps_trained_this_iter": 1440, "agent_timesteps_total": 1413360, "timers": {"training_iteration_time_ms": 3149.413, "sample_time_ms": 3138.381, "load_time_ms": 0.304, "load_throughput": 1185855.211, "learn_time_ms": 9.958, "learn_throughput": 36152.253, "synch_weights_time_ms": 0.723}, "counters": {"num_env_steps_sampled": 1413360, "num_env_steps_trained": 1413360, "num_agent_steps_sampled": 1413360, "num_agent_steps_trained": 1413360}, "done": false, "episodes_total": 5326, "training_iteration": 1124, "trial_id": "68078_00000", "date": "2023-08-05_10-31-44", "timestamp": 1691220704, "time_this_iter_s": 12.598186016082764, "time_total_s": 14585.050726413727, "pid": 54946, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[1400000, 5e-09], [1405400, 8e-09], [1410800, 2.5e-09], [1416200, 2.5e-09], [1421600, 2.5e-09], [1427000, 2.5e-09], [1432400, 1e-09], [1437800, 1e-09], [1443200, 1e-09], [1448600, 5e-10], [1454000, 5e-10], [1459400, 5e-10], [1464800, 5e-10], [1470200, 1e-10], [1475600, 1e-10], [1481000, 1e-10], [1486400, 1e-10], [1491800, 5e-11], [1497200, 5e-11], [1502600, 2.5e-11], [1508000, 2.5e-11], [1513400, 1e-11], [1518800, 1e-11], [1524200, 5e-12], [1529600, 5e-12], [1535000, 1e-12]], "grad_clip": 5, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.2, "final_epsilon": 0.01, "epsilon_timesteps": 1401170}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x3061b8b80>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 302.8433790206909, "iterations_since_restore": 24, "perf": {"cpu_util_percent": 27.294444444444444, "ram_util_percent": 68.74444444444444}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 2.5e-09, "entropy_coeff": 0.1, "policy_entropy": -322.16871337890626, "policy_loss": -2932415.6875, "vf_loss": 20926599.2}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 493.0, "diff_num_grad_updates_vs_sampler_policy": 492.0}}, "num_env_steps_sampled": 1414800, "num_env_steps_trained": 1414800, "num_agent_steps_sampled": 1414800, "num_agent_steps_trained": 1414800}, "sampler_results": {"episode_reward_max": -3541.0503481917694, "episode_reward_min": -3634.5049529545286, "episode_reward_mean": -3550.2360211811997, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3549.037036123015, -3549.0042802439984, -3556.9165450507317, -3556.425604484131, -3579.5606359965905, -3554.5587335093637, -3558.5509476504776, -3558.1416054821716, -3545.6724673899225, -3618.2340839301255, -3548.927726494181, -3547.552260505779, -3546.921394619684, -3554.0593031889484, -3545.5010284891423, -3550.7689397104114, -3545.753746589813, -3541.0547551462187, -3542.938250114688, -3545.993290424746, -3545.1354260959706, -3553.362149148736, -3544.0388889105407, -3549.9316400437892, -3549.39529152929, -3547.7973748347345, -3552.4409423032403, -3558.688862480492, -3545.3599684208316, -3634.5049529545286, -3543.9360306829058, -3545.4643868304174, -3545.6020746271856, -3546.266420774299, -3547.5945117515953, -3546.2515639788735, -3547.180654663955, -3542.5744282811743, -3544.3693668875094, -3551.0170721001214, -3544.0199045456034, -3555.9008252174585, -3547.052852118063, -3545.461085477762, -3547.521011190102, -3554.165795312169, -3550.2261498743355, -3552.7367250934403, -3556.950081432851, -3551.8274508706522, -3542.322873074976, -3555.148544277189, -3548.850835727826, -3545.449122148641, -3543.8650958880057, -3547.4566727516185, -3545.9979029870665, -3544.4425739389712, -3541.0547551462187, -3558.430752215632, -3552.3085968989235, -3542.488506293041, -3551.9521612813114, -3550.3427946578804, -3541.0503481917694, -3548.596138550916, -3548.530202380513, -3546.9339454621813, -3545.8715705840937, -3552.167853757343, -3547.5017446107067, -3557.0902630512483, -3554.60137859827, -3553.3447340824177, -3544.3718200565513, -3549.0942537353635, -3551.9175093796453, -3549.1993638290223, -3547.3293707395324, -3544.5091473304215, -3552.7155455678558, -3542.806241773586, -3548.681961477035, -3542.7530494827456, -3551.5505413099872, -3544.587980402555, -3547.5189929602807, -3543.9826496059522, -3549.063141630265, -3550.6318788461967, -3543.3708945100543, -3553.46249641705, -3546.1503509079953, -3544.2454623910853, -3545.3703528475035, -3542.9859966714794, -3542.27026037034, -3543.854227330668, -3542.796717232129], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.34934747769174, "mean_inference_ms": 0.380958809506803, "mean_action_processing_ms": 0.09299365038638249, "mean_env_wait_ms": 1.2736090513133662, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0037470249214557687, "StateBufferConnector_ms": 0.0027854033190794665, "ViewRequirementAgentConnector_ms": 0.06669217889959161}}, "episode_reward_max": -3541.0503481917694, "episode_reward_min": -3634.5049529545286, "episode_reward_mean": -3550.2360211811997, "episode_len_mean": 360.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-3549.037036123015, -3549.0042802439984, -3556.9165450507317, -3556.425604484131, -3579.5606359965905, -3554.5587335093637, -3558.5509476504776, -3558.1416054821716, -3545.6724673899225, -3618.2340839301255, -3548.927726494181, -3547.552260505779, -3546.921394619684, -3554.0593031889484, -3545.5010284891423, -3550.7689397104114, -3545.753746589813, -3541.0547551462187, -3542.938250114688, -3545.993290424746, -3545.1354260959706, -3553.362149148736, -3544.0388889105407, -3549.9316400437892, -3549.39529152929, -3547.7973748347345, -3552.4409423032403, -3558.688862480492, -3545.3599684208316, -3634.5049529545286, -3543.9360306829058, -3545.4643868304174, -3545.6020746271856, -3546.266420774299, -3547.5945117515953, -3546.2515639788735, -3547.180654663955, -3542.5744282811743, -3544.3693668875094, -3551.0170721001214, -3544.0199045456034, -3555.9008252174585, -3547.052852118063, -3545.461085477762, -3547.521011190102, -3554.165795312169, -3550.2261498743355, -3552.7367250934403, -3556.950081432851, -3551.8274508706522, -3542.322873074976, -3555.148544277189, -3548.850835727826, -3545.449122148641, -3543.8650958880057, -3547.4566727516185, -3545.9979029870665, -3544.4425739389712, -3541.0547551462187, -3558.430752215632, -3552.3085968989235, -3542.488506293041, -3551.9521612813114, -3550.3427946578804, -3541.0503481917694, -3548.596138550916, -3548.530202380513, -3546.9339454621813, -3545.8715705840937, -3552.167853757343, -3547.5017446107067, -3557.0902630512483, -3554.60137859827, -3553.3447340824177, -3544.3718200565513, -3549.0942537353635, -3551.9175093796453, -3549.1993638290223, -3547.3293707395324, -3544.5091473304215, -3552.7155455678558, -3542.806241773586, -3548.681961477035, -3542.7530494827456, -3551.5505413099872, -3544.587980402555, -3547.5189929602807, -3543.9826496059522, -3549.063141630265, -3550.6318788461967, -3543.3708945100543, -3553.46249641705, -3546.1503509079953, -3544.2454623910853, -3545.3703528475035, -3542.9859966714794, -3542.27026037034, -3543.854227330668, -3542.796717232129], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.34934747769174, "mean_inference_ms": 0.380958809506803, "mean_action_processing_ms": 0.09299365038638249, "mean_env_wait_ms": 1.2736090513133662, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0037470249214557687, "StateBufferConnector_ms": 0.0027854033190794665, "ViewRequirementAgentConnector_ms": 0.06669217889959161}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1414800, "num_agent_steps_trained": 1414800, "num_env_steps_sampled": 1414800, "num_env_steps_trained": 1414800, "num_env_steps_sampled_this_iter": 1440, "num_env_steps_trained_this_iter": 1440, "num_env_steps_sampled_throughput_per_sec": 117.41990056728737, "num_env_steps_trained_throughput_per_sec": 117.41990056728737, "timesteps_total": 1414800, "num_steps_trained_this_iter": 1440, "agent_timesteps_total": 1414800, "timers": {"training_iteration_time_ms": 3112.424, "sample_time_ms": 3101.404, "load_time_ms": 0.302, "load_throughput": 1191469.613, "learn_time_ms": 9.951, "learn_throughput": 36178.065, "synch_weights_time_ms": 0.72}, "counters": {"num_env_steps_sampled": 1414800, "num_env_steps_trained": 1414800, "num_agent_steps_sampled": 1414800, "num_agent_steps_trained": 1414800}, "done": false, "episodes_total": 5330, "training_iteration": 1125, "trial_id": "68078_00000", "date": "2023-08-05_10-31-56", "timestamp": 1691220716, "time_this_iter_s": 12.266518115997314, "time_total_s": 14597.317244529724, "pid": 54946, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[1400000, 5e-09], [1405400, 8e-09], [1410800, 2.5e-09], [1416200, 2.5e-09], [1421600, 2.5e-09], [1427000, 2.5e-09], [1432400, 1e-09], [1437800, 1e-09], [1443200, 1e-09], [1448600, 5e-10], [1454000, 5e-10], [1459400, 5e-10], [1464800, 5e-10], [1470200, 1e-10], [1475600, 1e-10], [1481000, 1e-10], [1486400, 1e-10], [1491800, 5e-11], [1497200, 5e-11], [1502600, 2.5e-11], [1508000, 2.5e-11], [1513400, 1e-11], [1518800, 1e-11], [1524200, 5e-12], [1529600, 5e-12], [1535000, 1e-12]], "grad_clip": 5, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.2, "final_epsilon": 0.01, "epsilon_timesteps": 1401170}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x3061b8b80>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 315.10989713668823, "iterations_since_restore": 25, "perf": {"cpu_util_percent": 28.852941176470587, "ram_util_percent": 68.61764705882354}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 2.5e-09, "entropy_coeff": 0.1, "policy_entropy": -322.2718933105469, "policy_loss": -1070414.015625, "vf_loss": 20940788.7}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 513.0, "diff_num_grad_updates_vs_sampler_policy": 512.0}}, "num_env_steps_sampled": 1416240, "num_env_steps_trained": 1416240, "num_agent_steps_sampled": 1416240, "num_agent_steps_trained": 1416240}, "sampler_results": {"episode_reward_max": -3541.0503481917694, "episode_reward_min": -3634.5049529545286, "episode_reward_mean": -3550.097900236712, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3556.425604484131, -3579.5606359965905, -3554.5587335093637, -3558.5509476504776, -3558.1416054821716, -3545.6724673899225, -3618.2340839301255, -3548.927726494181, -3547.552260505779, -3546.921394619684, -3554.0593031889484, -3545.5010284891423, -3550.7689397104114, -3545.753746589813, -3541.0547551462187, -3542.938250114688, -3545.993290424746, -3545.1354260959706, -3553.362149148736, -3544.0388889105407, -3549.9316400437892, -3549.39529152929, -3547.7973748347345, -3552.4409423032403, -3558.688862480492, -3545.3599684208316, -3634.5049529545286, -3543.9360306829058, -3545.4643868304174, -3545.6020746271856, -3546.266420774299, -3547.5945117515953, -3546.2515639788735, -3547.180654663955, -3542.5744282811743, -3544.3693668875094, -3551.0170721001214, -3544.0199045456034, -3555.9008252174585, -3547.052852118063, -3545.461085477762, -3547.521011190102, -3554.165795312169, -3550.2261498743355, -3552.7367250934403, -3556.950081432851, -3551.8274508706522, -3542.322873074976, -3555.148544277189, -3548.850835727826, -3545.449122148641, -3543.8650958880057, -3547.4566727516185, -3545.9979029870665, -3544.4425739389712, -3541.0547551462187, -3558.430752215632, -3552.3085968989235, -3542.488506293041, -3551.9521612813114, -3550.3427946578804, -3541.0503481917694, -3548.596138550916, -3548.530202380513, -3546.9339454621813, -3545.8715705840937, -3552.167853757343, -3547.5017446107067, -3557.0902630512483, -3554.60137859827, -3553.3447340824177, -3544.3718200565513, -3549.0942537353635, -3551.9175093796453, -3549.1993638290223, -3547.3293707395324, -3544.5091473304215, -3552.7155455678558, -3542.806241773586, -3548.681961477035, -3542.7530494827456, -3551.5505413099872, -3544.587980402555, -3547.5189929602807, -3543.9826496059522, -3549.063141630265, -3550.6318788461967, -3543.3708945100543, -3553.46249641705, -3546.1503509079953, -3544.2454623910853, -3545.3703528475035, -3542.9859966714794, -3542.27026037034, -3543.854227330668, -3542.796717232129, -3548.722902040503, -3550.3963809169077, -3547.349561178362, -3544.912944014346], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.349251302682959, "mean_inference_ms": 0.3811921478369993, "mean_action_processing_ms": 0.0930239746922889, "mean_env_wait_ms": 1.1922467116300108, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003757476806640625, "StateBufferConnector_ms": 0.0028018951416015625, "ViewRequirementAgentConnector_ms": 0.06699419021606445}}, "episode_reward_max": -3541.0503481917694, "episode_reward_min": -3634.5049529545286, "episode_reward_mean": -3550.097900236712, "episode_len_mean": 360.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-3556.425604484131, -3579.5606359965905, -3554.5587335093637, -3558.5509476504776, -3558.1416054821716, -3545.6724673899225, -3618.2340839301255, -3548.927726494181, -3547.552260505779, -3546.921394619684, -3554.0593031889484, -3545.5010284891423, -3550.7689397104114, -3545.753746589813, -3541.0547551462187, -3542.938250114688, -3545.993290424746, -3545.1354260959706, -3553.362149148736, -3544.0388889105407, -3549.9316400437892, -3549.39529152929, -3547.7973748347345, -3552.4409423032403, -3558.688862480492, -3545.3599684208316, -3634.5049529545286, -3543.9360306829058, -3545.4643868304174, -3545.6020746271856, -3546.266420774299, -3547.5945117515953, -3546.2515639788735, -3547.180654663955, -3542.5744282811743, -3544.3693668875094, -3551.0170721001214, -3544.0199045456034, -3555.9008252174585, -3547.052852118063, -3545.461085477762, -3547.521011190102, -3554.165795312169, -3550.2261498743355, -3552.7367250934403, -3556.950081432851, -3551.8274508706522, -3542.322873074976, -3555.148544277189, -3548.850835727826, -3545.449122148641, -3543.8650958880057, -3547.4566727516185, -3545.9979029870665, -3544.4425739389712, -3541.0547551462187, -3558.430752215632, -3552.3085968989235, -3542.488506293041, -3551.9521612813114, -3550.3427946578804, -3541.0503481917694, -3548.596138550916, -3548.530202380513, -3546.9339454621813, -3545.8715705840937, -3552.167853757343, -3547.5017446107067, -3557.0902630512483, -3554.60137859827, -3553.3447340824177, -3544.3718200565513, -3549.0942537353635, -3551.9175093796453, -3549.1993638290223, -3547.3293707395324, -3544.5091473304215, -3552.7155455678558, -3542.806241773586, -3548.681961477035, -3542.7530494827456, -3551.5505413099872, -3544.587980402555, -3547.5189929602807, -3543.9826496059522, -3549.063141630265, -3550.6318788461967, -3543.3708945100543, -3553.46249641705, -3546.1503509079953, -3544.2454623910853, -3545.3703528475035, -3542.9859966714794, -3542.27026037034, -3543.854227330668, -3542.796717232129, -3548.722902040503, -3550.3963809169077, -3547.349561178362, -3544.912944014346], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.349251302682959, "mean_inference_ms": 0.3811921478369993, "mean_action_processing_ms": 0.0930239746922889, "mean_env_wait_ms": 1.1922467116300108, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003757476806640625, "StateBufferConnector_ms": 0.0028018951416015625, "ViewRequirementAgentConnector_ms": 0.06699419021606445}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1416240, "num_agent_steps_trained": 1416240, "num_env_steps_sampled": 1416240, "num_env_steps_trained": 1416240, "num_env_steps_sampled_this_iter": 1440, "num_env_steps_trained_this_iter": 1440, "num_env_steps_sampled_throughput_per_sec": 113.16911931784168, "num_env_steps_trained_throughput_per_sec": 113.16911931784168, "timesteps_total": 1416240, "num_steps_trained_this_iter": 1440, "agent_timesteps_total": 1416240, "timers": {"training_iteration_time_ms": 3129.147, "sample_time_ms": 3118.303, "load_time_ms": 0.3, "load_throughput": 1201423.806, "learn_time_ms": 9.77, "learn_throughput": 36845.919, "synch_weights_time_ms": 0.726}, "counters": {"num_env_steps_sampled": 1416240, "num_env_steps_trained": 1416240, "num_agent_steps_sampled": 1416240, "num_agent_steps_trained": 1416240}, "done": false, "episodes_total": 5334, "training_iteration": 1126, "trial_id": "68078_00000", "date": "2023-08-05_10-32-09", "timestamp": 1691220729, "time_this_iter_s": 12.727037906646729, "time_total_s": 14610.04428243637, "pid": 54946, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[1400000, 5e-09], [1405400, 8e-09], [1410800, 2.5e-09], [1416200, 2.5e-09], [1421600, 2.5e-09], [1427000, 2.5e-09], [1432400, 1e-09], [1437800, 1e-09], [1443200, 1e-09], [1448600, 5e-10], [1454000, 5e-10], [1459400, 5e-10], [1464800, 5e-10], [1470200, 1e-10], [1475600, 1e-10], [1481000, 1e-10], [1486400, 1e-10], [1491800, 5e-11], [1497200, 5e-11], [1502600, 2.5e-11], [1508000, 2.5e-11], [1513400, 1e-11], [1518800, 1e-11], [1524200, 5e-12], [1529600, 5e-12], [1535000, 1e-12]], "grad_clip": 5, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.2, "final_epsilon": 0.01, "epsilon_timesteps": 1401170}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x3061b8b80>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 327.83693504333496, "iterations_since_restore": 26, "perf": {"cpu_util_percent": 25.822222222222223, "ram_util_percent": 68.56666666666666}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 2.5e-09, "entropy_coeff": 0.1, "policy_entropy": -322.13898315429685, "policy_loss": 294974.075, "vf_loss": 20897117.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 533.0, "diff_num_grad_updates_vs_sampler_policy": 532.0}}, "num_env_steps_sampled": 1417680, "num_env_steps_trained": 1417680, "num_agent_steps_sampled": 1417680, "num_agent_steps_trained": 1417680}, "sampler_results": {"episode_reward_max": -3540.7956288644655, "episode_reward_min": -3634.5049529545286, "episode_reward_mean": -3549.4601222838846, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3558.1416054821716, -3545.6724673899225, -3618.2340839301255, -3548.927726494181, -3547.552260505779, -3546.921394619684, -3554.0593031889484, -3545.5010284891423, -3550.7689397104114, -3545.753746589813, -3541.0547551462187, -3542.938250114688, -3545.993290424746, -3545.1354260959706, -3553.362149148736, -3544.0388889105407, -3549.9316400437892, -3549.39529152929, -3547.7973748347345, -3552.4409423032403, -3558.688862480492, -3545.3599684208316, -3634.5049529545286, -3543.9360306829058, -3545.4643868304174, -3545.6020746271856, -3546.266420774299, -3547.5945117515953, -3546.2515639788735, -3547.180654663955, -3542.5744282811743, -3544.3693668875094, -3551.0170721001214, -3544.0199045456034, -3555.9008252174585, -3547.052852118063, -3545.461085477762, -3547.521011190102, -3554.165795312169, -3550.2261498743355, -3552.7367250934403, -3556.950081432851, -3551.8274508706522, -3542.322873074976, -3555.148544277189, -3548.850835727826, -3545.449122148641, -3543.8650958880057, -3547.4566727516185, -3545.9979029870665, -3544.4425739389712, -3541.0547551462187, -3558.430752215632, -3552.3085968989235, -3542.488506293041, -3551.9521612813114, -3550.3427946578804, -3541.0503481917694, -3548.596138550916, -3548.530202380513, -3546.9339454621813, -3545.8715705840937, -3552.167853757343, -3547.5017446107067, -3557.0902630512483, -3554.60137859827, -3553.3447340824177, -3544.3718200565513, -3549.0942537353635, -3551.9175093796453, -3549.1993638290223, -3547.3293707395324, -3544.5091473304215, -3552.7155455678558, -3542.806241773586, -3548.681961477035, -3542.7530494827456, -3551.5505413099872, -3544.587980402555, -3547.5189929602807, -3543.9826496059522, -3549.063141630265, -3550.6318788461967, -3543.3708945100543, -3553.46249641705, -3546.1503509079953, -3544.2454623910853, -3545.3703528475035, -3542.9859966714794, -3542.27026037034, -3543.854227330668, -3542.796717232129, -3548.722902040503, -3550.3963809169077, -3547.349561178362, -3544.912944014346, -3551.8633391618464, -3545.511259124869, -3547.1478992066427, -3540.7956288644655], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.348481684482842, "mean_inference_ms": 0.38149964444576484, "mean_action_processing_ms": 0.09307687923055302, "mean_env_wait_ms": 1.1483477672764943, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0037534236907958984, "StateBufferConnector_ms": 0.002805471420288086, "ViewRequirementAgentConnector_ms": 0.06690096855163574}}, "episode_reward_max": -3540.7956288644655, "episode_reward_min": -3634.5049529545286, "episode_reward_mean": -3549.4601222838846, "episode_len_mean": 360.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-3558.1416054821716, -3545.6724673899225, -3618.2340839301255, -3548.927726494181, -3547.552260505779, -3546.921394619684, -3554.0593031889484, -3545.5010284891423, -3550.7689397104114, -3545.753746589813, -3541.0547551462187, -3542.938250114688, -3545.993290424746, -3545.1354260959706, -3553.362149148736, -3544.0388889105407, -3549.9316400437892, -3549.39529152929, -3547.7973748347345, -3552.4409423032403, -3558.688862480492, -3545.3599684208316, -3634.5049529545286, -3543.9360306829058, -3545.4643868304174, -3545.6020746271856, -3546.266420774299, -3547.5945117515953, -3546.2515639788735, -3547.180654663955, -3542.5744282811743, -3544.3693668875094, -3551.0170721001214, -3544.0199045456034, -3555.9008252174585, -3547.052852118063, -3545.461085477762, -3547.521011190102, -3554.165795312169, -3550.2261498743355, -3552.7367250934403, -3556.950081432851, -3551.8274508706522, -3542.322873074976, -3555.148544277189, -3548.850835727826, -3545.449122148641, -3543.8650958880057, -3547.4566727516185, -3545.9979029870665, -3544.4425739389712, -3541.0547551462187, -3558.430752215632, -3552.3085968989235, -3542.488506293041, -3551.9521612813114, -3550.3427946578804, -3541.0503481917694, -3548.596138550916, -3548.530202380513, -3546.9339454621813, -3545.8715705840937, -3552.167853757343, -3547.5017446107067, -3557.0902630512483, -3554.60137859827, -3553.3447340824177, -3544.3718200565513, -3549.0942537353635, -3551.9175093796453, -3549.1993638290223, -3547.3293707395324, -3544.5091473304215, -3552.7155455678558, -3542.806241773586, -3548.681961477035, -3542.7530494827456, -3551.5505413099872, -3544.587980402555, -3547.5189929602807, -3543.9826496059522, -3549.063141630265, -3550.6318788461967, -3543.3708945100543, -3553.46249641705, -3546.1503509079953, -3544.2454623910853, -3545.3703528475035, -3542.9859966714794, -3542.27026037034, -3543.854227330668, -3542.796717232129, -3548.722902040503, -3550.3963809169077, -3547.349561178362, -3544.912944014346, -3551.8633391618464, -3545.511259124869, -3547.1478992066427, -3540.7956288644655], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.348481684482842, "mean_inference_ms": 0.38149964444576484, "mean_action_processing_ms": 0.09307687923055302, "mean_env_wait_ms": 1.1483477672764943, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0037534236907958984, "StateBufferConnector_ms": 0.002805471420288086, "ViewRequirementAgentConnector_ms": 0.06690096855163574}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1417680, "num_agent_steps_trained": 1417680, "num_env_steps_sampled": 1417680, "num_env_steps_trained": 1417680, "num_env_steps_sampled_this_iter": 1440, "num_env_steps_trained_this_iter": 1440, "num_env_steps_sampled_throughput_per_sec": 114.28835565698714, "num_env_steps_trained_throughput_per_sec": 114.28835565698714, "timesteps_total": 1417680, "num_steps_trained_this_iter": 1440, "agent_timesteps_total": 1417680, "timers": {"training_iteration_time_ms": 3145.412, "sample_time_ms": 3134.624, "load_time_ms": 0.299, "load_throughput": 1205740.989, "learn_time_ms": 9.73, "learn_throughput": 37000.131, "synch_weights_time_ms": 0.713}, "counters": {"num_env_steps_sampled": 1417680, "num_env_steps_trained": 1417680, "num_agent_steps_sampled": 1417680, "num_agent_steps_trained": 1417680}, "done": false, "episodes_total": 5338, "training_iteration": 1127, "trial_id": "68078_00000", "date": "2023-08-05_10-32-22", "timestamp": 1691220742, "time_this_iter_s": 12.602569341659546, "time_total_s": 14622.64685177803, "pid": 54946, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[1400000, 5e-09], [1405400, 8e-09], [1410800, 2.5e-09], [1416200, 2.5e-09], [1421600, 2.5e-09], [1427000, 2.5e-09], [1432400, 1e-09], [1437800, 1e-09], [1443200, 1e-09], [1448600, 5e-10], [1454000, 5e-10], [1459400, 5e-10], [1464800, 5e-10], [1470200, 1e-10], [1475600, 1e-10], [1481000, 1e-10], [1486400, 1e-10], [1491800, 5e-11], [1497200, 5e-11], [1502600, 2.5e-11], [1508000, 2.5e-11], [1513400, 1e-11], [1518800, 1e-11], [1524200, 5e-12], [1529600, 5e-12], [1535000, 1e-12]], "grad_clip": 5, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.2, "final_epsilon": 0.01, "epsilon_timesteps": 1401170}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x3061b8b80>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 340.4395043849945, "iterations_since_restore": 27, "perf": {"cpu_util_percent": 24.838888888888885, "ram_util_percent": 68.63333333333334}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 2.5e-09, "entropy_coeff": 0.1, "policy_entropy": -322.3868469238281, "policy_loss": -9445560.2125, "vf_loss": 21021017.7}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 553.0, "diff_num_grad_updates_vs_sampler_policy": 552.0}}, "num_env_steps_sampled": 1419120, "num_env_steps_trained": 1419120, "num_agent_steps_sampled": 1419120, "num_agent_steps_trained": 1419120}, "sampler_results": {"episode_reward_max": -3540.7956288644655, "episode_reward_min": -3634.5049529545286, "episode_reward_mean": -3548.7158065601197, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3547.552260505779, -3546.921394619684, -3554.0593031889484, -3545.5010284891423, -3550.7689397104114, -3545.753746589813, -3541.0547551462187, -3542.938250114688, -3545.993290424746, -3545.1354260959706, -3553.362149148736, -3544.0388889105407, -3549.9316400437892, -3549.39529152929, -3547.7973748347345, -3552.4409423032403, -3558.688862480492, -3545.3599684208316, -3634.5049529545286, -3543.9360306829058, -3545.4643868304174, -3545.6020746271856, -3546.266420774299, -3547.5945117515953, -3546.2515639788735, -3547.180654663955, -3542.5744282811743, -3544.3693668875094, -3551.0170721001214, -3544.0199045456034, -3555.9008252174585, -3547.052852118063, -3545.461085477762, -3547.521011190102, -3554.165795312169, -3550.2261498743355, -3552.7367250934403, -3556.950081432851, -3551.8274508706522, -3542.322873074976, -3555.148544277189, -3548.850835727826, -3545.449122148641, -3543.8650958880057, -3547.4566727516185, -3545.9979029870665, -3544.4425739389712, -3541.0547551462187, -3558.430752215632, -3552.3085968989235, -3542.488506293041, -3551.9521612813114, -3550.3427946578804, -3541.0503481917694, -3548.596138550916, -3548.530202380513, -3546.9339454621813, -3545.8715705840937, -3552.167853757343, -3547.5017446107067, -3557.0902630512483, -3554.60137859827, -3553.3447340824177, -3544.3718200565513, -3549.0942537353635, -3551.9175093796453, -3549.1993638290223, -3547.3293707395324, -3544.5091473304215, -3552.7155455678558, -3542.806241773586, -3548.681961477035, -3542.7530494827456, -3551.5505413099872, -3544.587980402555, -3547.5189929602807, -3543.9826496059522, -3549.063141630265, -3550.6318788461967, -3543.3708945100543, -3553.46249641705, -3546.1503509079953, -3544.2454623910853, -3545.3703528475035, -3542.9859966714794, -3542.27026037034, -3543.854227330668, -3542.796717232129, -3548.722902040503, -3550.3963809169077, -3547.349561178362, -3544.912944014346, -3551.8633391618464, -3545.511259124869, -3547.1478992066427, -3540.7956288644655, -3552.521010774109, -3547.4303895779244, -3546.157297863772, -3550.4356127041497], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.346069635643951, "mean_inference_ms": 0.3811947257477782, "mean_action_processing_ms": 0.09302203191341246, "mean_env_wait_ms": 1.120601410696535, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0037856101989746094, "StateBufferConnector_ms": 0.0028100013732910156, "ViewRequirementAgentConnector_ms": 0.0669710636138916}}, "episode_reward_max": -3540.7956288644655, "episode_reward_min": -3634.5049529545286, "episode_reward_mean": -3548.7158065601197, "episode_len_mean": 360.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-3547.552260505779, -3546.921394619684, -3554.0593031889484, -3545.5010284891423, -3550.7689397104114, -3545.753746589813, -3541.0547551462187, -3542.938250114688, -3545.993290424746, -3545.1354260959706, -3553.362149148736, -3544.0388889105407, -3549.9316400437892, -3549.39529152929, -3547.7973748347345, -3552.4409423032403, -3558.688862480492, -3545.3599684208316, -3634.5049529545286, -3543.9360306829058, -3545.4643868304174, -3545.6020746271856, -3546.266420774299, -3547.5945117515953, -3546.2515639788735, -3547.180654663955, -3542.5744282811743, -3544.3693668875094, -3551.0170721001214, -3544.0199045456034, -3555.9008252174585, -3547.052852118063, -3545.461085477762, -3547.521011190102, -3554.165795312169, -3550.2261498743355, -3552.7367250934403, -3556.950081432851, -3551.8274508706522, -3542.322873074976, -3555.148544277189, -3548.850835727826, -3545.449122148641, -3543.8650958880057, -3547.4566727516185, -3545.9979029870665, -3544.4425739389712, -3541.0547551462187, -3558.430752215632, -3552.3085968989235, -3542.488506293041, -3551.9521612813114, -3550.3427946578804, -3541.0503481917694, -3548.596138550916, -3548.530202380513, -3546.9339454621813, -3545.8715705840937, -3552.167853757343, -3547.5017446107067, -3557.0902630512483, -3554.60137859827, -3553.3447340824177, -3544.3718200565513, -3549.0942537353635, -3551.9175093796453, -3549.1993638290223, -3547.3293707395324, -3544.5091473304215, -3552.7155455678558, -3542.806241773586, -3548.681961477035, -3542.7530494827456, -3551.5505413099872, -3544.587980402555, -3547.5189929602807, -3543.9826496059522, -3549.063141630265, -3550.6318788461967, -3543.3708945100543, -3553.46249641705, -3546.1503509079953, -3544.2454623910853, -3545.3703528475035, -3542.9859966714794, -3542.27026037034, -3543.854227330668, -3542.796717232129, -3548.722902040503, -3550.3963809169077, -3547.349561178362, -3544.912944014346, -3551.8633391618464, -3545.511259124869, -3547.1478992066427, -3540.7956288644655, -3552.521010774109, -3547.4303895779244, -3546.157297863772, -3550.4356127041497], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.346069635643951, "mean_inference_ms": 0.3811947257477782, "mean_action_processing_ms": 0.09302203191341246, "mean_env_wait_ms": 1.120601410696535, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0037856101989746094, "StateBufferConnector_ms": 0.0028100013732910156, "ViewRequirementAgentConnector_ms": 0.0669710636138916}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1419120, "num_agent_steps_trained": 1419120, "num_env_steps_sampled": 1419120, "num_env_steps_trained": 1419120, "num_env_steps_sampled_this_iter": 1440, "num_env_steps_trained_this_iter": 1440, "num_env_steps_sampled_throughput_per_sec": 110.60343500723626, "num_env_steps_trained_throughput_per_sec": 110.60343500723626, "timesteps_total": 1419120, "num_steps_trained_this_iter": 1440, "agent_timesteps_total": 1419120, "timers": {"training_iteration_time_ms": 3211.481, "sample_time_ms": 3200.74, "load_time_ms": 0.299, "load_throughput": 1205067.39, "learn_time_ms": 9.695, "learn_throughput": 37132.978, "synch_weights_time_ms": 0.701}, "counters": {"num_env_steps_sampled": 1419120, "num_env_steps_trained": 1419120, "num_agent_steps_sampled": 1419120, "num_agent_steps_trained": 1419120}, "done": false, "episodes_total": 5342, "training_iteration": 1128, "trial_id": "68078_00000", "date": "2023-08-05_10-32-35", "timestamp": 1691220755, "time_this_iter_s": 13.022345066070557, "time_total_s": 14635.669196844101, "pid": 54946, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[1400000, 5e-09], [1405400, 8e-09], [1410800, 2.5e-09], [1416200, 2.5e-09], [1421600, 2.5e-09], [1427000, 2.5e-09], [1432400, 1e-09], [1437800, 1e-09], [1443200, 1e-09], [1448600, 5e-10], [1454000, 5e-10], [1459400, 5e-10], [1464800, 5e-10], [1470200, 1e-10], [1475600, 1e-10], [1481000, 1e-10], [1486400, 1e-10], [1491800, 5e-11], [1497200, 5e-11], [1502600, 2.5e-11], [1508000, 2.5e-11], [1513400, 1e-11], [1518800, 1e-11], [1524200, 5e-12], [1529600, 5e-12], [1535000, 1e-12]], "grad_clip": 5, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.2, "final_epsilon": 0.01, "epsilon_timesteps": 1401170}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x3061b8b80>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 353.46184945106506, "iterations_since_restore": 28, "perf": {"cpu_util_percent": 25.963157894736838, "ram_util_percent": 68.9157894736842}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 2.5e-09, "entropy_coeff": 0.1, "policy_entropy": -322.5367858886719, "policy_loss": -5158907.14375, "vf_loss": 22103105.7}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 573.0, "diff_num_grad_updates_vs_sampler_policy": 572.0}}, "num_env_steps_sampled": 1420560, "num_env_steps_trained": 1420560, "num_agent_steps_sampled": 1420560, "num_agent_steps_trained": 1420560}, "sampler_results": {"episode_reward_max": -3540.7956288644655, "episode_reward_min": -3643.1726358374194, "episode_reward_mean": -3549.560893031, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3550.7689397104114, -3545.753746589813, -3541.0547551462187, -3542.938250114688, -3545.993290424746, -3545.1354260959706, -3553.362149148736, -3544.0388889105407, -3549.9316400437892, -3549.39529152929, -3547.7973748347345, -3552.4409423032403, -3558.688862480492, -3545.3599684208316, -3634.5049529545286, -3543.9360306829058, -3545.4643868304174, -3545.6020746271856, -3546.266420774299, -3547.5945117515953, -3546.2515639788735, -3547.180654663955, -3542.5744282811743, -3544.3693668875094, -3551.0170721001214, -3544.0199045456034, -3555.9008252174585, -3547.052852118063, -3545.461085477762, -3547.521011190102, -3554.165795312169, -3550.2261498743355, -3552.7367250934403, -3556.950081432851, -3551.8274508706522, -3542.322873074976, -3555.148544277189, -3548.850835727826, -3545.449122148641, -3543.8650958880057, -3547.4566727516185, -3545.9979029870665, -3544.4425739389712, -3541.0547551462187, -3558.430752215632, -3552.3085968989235, -3542.488506293041, -3551.9521612813114, -3550.3427946578804, -3541.0503481917694, -3548.596138550916, -3548.530202380513, -3546.9339454621813, -3545.8715705840937, -3552.167853757343, -3547.5017446107067, -3557.0902630512483, -3554.60137859827, -3553.3447340824177, -3544.3718200565513, -3549.0942537353635, -3551.9175093796453, -3549.1993638290223, -3547.3293707395324, -3544.5091473304215, -3552.7155455678558, -3542.806241773586, -3548.681961477035, -3542.7530494827456, -3551.5505413099872, -3544.587980402555, -3547.5189929602807, -3543.9826496059522, -3549.063141630265, -3550.6318788461967, -3543.3708945100543, -3553.46249641705, -3546.1503509079953, -3544.2454623910853, -3545.3703528475035, -3542.9859966714794, -3542.27026037034, -3543.854227330668, -3542.796717232129, -3548.722902040503, -3550.3963809169077, -3547.349561178362, -3544.912944014346, -3551.8633391618464, -3545.511259124869, -3547.1478992066427, -3540.7956288644655, -3552.521010774109, -3547.4303895779244, -3546.157297863772, -3550.4356127041497, -3543.975899261874, -3548.749174758646, -3542.644924033714, -3643.1726358374194], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.3421839928946495, "mean_inference_ms": 0.38113104668609443, "mean_action_processing_ms": 0.09301454872655988, "mean_env_wait_ms": 1.1008514369479518, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0037841796875, "StateBufferConnector_ms": 0.002817392349243164, "ViewRequirementAgentConnector_ms": 0.06700682640075684}}, "episode_reward_max": -3540.7956288644655, "episode_reward_min": -3643.1726358374194, "episode_reward_mean": -3549.560893031, "episode_len_mean": 360.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-3550.7689397104114, -3545.753746589813, -3541.0547551462187, -3542.938250114688, -3545.993290424746, -3545.1354260959706, -3553.362149148736, -3544.0388889105407, -3549.9316400437892, -3549.39529152929, -3547.7973748347345, -3552.4409423032403, -3558.688862480492, -3545.3599684208316, -3634.5049529545286, -3543.9360306829058, -3545.4643868304174, -3545.6020746271856, -3546.266420774299, -3547.5945117515953, -3546.2515639788735, -3547.180654663955, -3542.5744282811743, -3544.3693668875094, -3551.0170721001214, -3544.0199045456034, -3555.9008252174585, -3547.052852118063, -3545.461085477762, -3547.521011190102, -3554.165795312169, -3550.2261498743355, -3552.7367250934403, -3556.950081432851, -3551.8274508706522, -3542.322873074976, -3555.148544277189, -3548.850835727826, -3545.449122148641, -3543.8650958880057, -3547.4566727516185, -3545.9979029870665, -3544.4425739389712, -3541.0547551462187, -3558.430752215632, -3552.3085968989235, -3542.488506293041, -3551.9521612813114, -3550.3427946578804, -3541.0503481917694, -3548.596138550916, -3548.530202380513, -3546.9339454621813, -3545.8715705840937, -3552.167853757343, -3547.5017446107067, -3557.0902630512483, -3554.60137859827, -3553.3447340824177, -3544.3718200565513, -3549.0942537353635, -3551.9175093796453, -3549.1993638290223, -3547.3293707395324, -3544.5091473304215, -3552.7155455678558, -3542.806241773586, -3548.681961477035, -3542.7530494827456, -3551.5505413099872, -3544.587980402555, -3547.5189929602807, -3543.9826496059522, -3549.063141630265, -3550.6318788461967, -3543.3708945100543, -3553.46249641705, -3546.1503509079953, -3544.2454623910853, -3545.3703528475035, -3542.9859966714794, -3542.27026037034, -3543.854227330668, -3542.796717232129, -3548.722902040503, -3550.3963809169077, -3547.349561178362, -3544.912944014346, -3551.8633391618464, -3545.511259124869, -3547.1478992066427, -3540.7956288644655, -3552.521010774109, -3547.4303895779244, -3546.157297863772, -3550.4356127041497, -3543.975899261874, -3548.749174758646, -3542.644924033714, -3643.1726358374194], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.3421839928946495, "mean_inference_ms": 0.38113104668609443, "mean_action_processing_ms": 0.09301454872655988, "mean_env_wait_ms": 1.1008514369479518, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0037841796875, "StateBufferConnector_ms": 0.002817392349243164, "ViewRequirementAgentConnector_ms": 0.06700682640075684}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1420560, "num_agent_steps_trained": 1420560, "num_env_steps_sampled": 1420560, "num_env_steps_trained": 1420560, "num_env_steps_sampled_this_iter": 1440, "num_env_steps_trained_this_iter": 1440, "num_env_steps_sampled_throughput_per_sec": 110.92733786503824, "num_env_steps_trained_throughput_per_sec": 110.92733786503824, "timesteps_total": 1420560, "num_steps_trained_this_iter": 1440, "agent_timesteps_total": 1420560, "timers": {"training_iteration_time_ms": 3232.207, "sample_time_ms": 3221.46, "load_time_ms": 0.3, "load_throughput": 1200755.022, "learn_time_ms": 9.693, "learn_throughput": 37139.098, "synch_weights_time_ms": 0.708}, "counters": {"num_env_steps_sampled": 1420560, "num_env_steps_trained": 1420560, "num_agent_steps_sampled": 1420560, "num_agent_steps_trained": 1420560}, "done": false, "episodes_total": 5346, "training_iteration": 1129, "trial_id": "68078_00000", "date": "2023-08-05_10-32-48", "timestamp": 1691220768, "time_this_iter_s": 12.984253883361816, "time_total_s": 14648.653450727463, "pid": 54946, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[1400000, 5e-09], [1405400, 8e-09], [1410800, 2.5e-09], [1416200, 2.5e-09], [1421600, 2.5e-09], [1427000, 2.5e-09], [1432400, 1e-09], [1437800, 1e-09], [1443200, 1e-09], [1448600, 5e-10], [1454000, 5e-10], [1459400, 5e-10], [1464800, 5e-10], [1470200, 1e-10], [1475600, 1e-10], [1481000, 1e-10], [1486400, 1e-10], [1491800, 5e-11], [1497200, 5e-11], [1502600, 2.5e-11], [1508000, 2.5e-11], [1513400, 1e-11], [1518800, 1e-11], [1524200, 5e-12], [1529600, 5e-12], [1535000, 1e-12]], "grad_clip": 5, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.2, "final_epsilon": 0.01, "epsilon_timesteps": 1401170}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x3061b8b80>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 366.4461033344269, "iterations_since_restore": 29, "perf": {"cpu_util_percent": 19.799999999999997, "ram_util_percent": 68.78333333333335}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 2.5e-09, "entropy_coeff": 0.1, "policy_entropy": -322.2265197753906, "policy_loss": -1272573.8625, "vf_loss": 21187960.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 593.0, "diff_num_grad_updates_vs_sampler_policy": 592.0}}, "num_env_steps_sampled": 1422000, "num_env_steps_trained": 1422000, "num_agent_steps_sampled": 1422000, "num_agent_steps_trained": 1422000}, "sampler_results": {"episode_reward_max": -3540.745687250526, "episode_reward_min": -3643.1726358374194, "episode_reward_mean": -3549.7696426193525, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3545.993290424746, -3545.1354260959706, -3553.362149148736, -3544.0388889105407, -3549.9316400437892, -3549.39529152929, -3547.7973748347345, -3552.4409423032403, -3558.688862480492, -3545.3599684208316, -3634.5049529545286, -3543.9360306829058, -3545.4643868304174, -3545.6020746271856, -3546.266420774299, -3547.5945117515953, -3546.2515639788735, -3547.180654663955, -3542.5744282811743, -3544.3693668875094, -3551.0170721001214, -3544.0199045456034, -3555.9008252174585, -3547.052852118063, -3545.461085477762, -3547.521011190102, -3554.165795312169, -3550.2261498743355, -3552.7367250934403, -3556.950081432851, -3551.8274508706522, -3542.322873074976, -3555.148544277189, -3548.850835727826, -3545.449122148641, -3543.8650958880057, -3547.4566727516185, -3545.9979029870665, -3544.4425739389712, -3541.0547551462187, -3558.430752215632, -3552.3085968989235, -3542.488506293041, -3551.9521612813114, -3550.3427946578804, -3541.0503481917694, -3548.596138550916, -3548.530202380513, -3546.9339454621813, -3545.8715705840937, -3552.167853757343, -3547.5017446107067, -3557.0902630512483, -3554.60137859827, -3553.3447340824177, -3544.3718200565513, -3549.0942537353635, -3551.9175093796453, -3549.1993638290223, -3547.3293707395324, -3544.5091473304215, -3552.7155455678558, -3542.806241773586, -3548.681961477035, -3542.7530494827456, -3551.5505413099872, -3544.587980402555, -3547.5189929602807, -3543.9826496059522, -3549.063141630265, -3550.6318788461967, -3543.3708945100543, -3553.46249641705, -3546.1503509079953, -3544.2454623910853, -3545.3703528475035, -3542.9859966714794, -3542.27026037034, -3543.854227330668, -3542.796717232129, -3548.722902040503, -3550.3963809169077, -3547.349561178362, -3544.912944014346, -3551.8633391618464, -3545.511259124869, -3547.1478992066427, -3540.7956288644655, -3552.521010774109, -3547.4303895779244, -3546.157297863772, -3550.4356127041497, -3543.975899261874, -3548.749174758646, -3542.644924033714, -3643.1726358374194, -3542.681351401795, -3540.745687250526, -3547.408389976526, -3570.5552217674776], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.3382570660719875, "mean_inference_ms": 0.3812203552889807, "mean_action_processing_ms": 0.0930369423661089, "mean_env_wait_ms": 1.0859172180383332, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0038123130798339844, "StateBufferConnector_ms": 0.002821683883666992, "ViewRequirementAgentConnector_ms": 0.0673074722290039}}, "episode_reward_max": -3540.745687250526, "episode_reward_min": -3643.1726358374194, "episode_reward_mean": -3549.7696426193525, "episode_len_mean": 360.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-3545.993290424746, -3545.1354260959706, -3553.362149148736, -3544.0388889105407, -3549.9316400437892, -3549.39529152929, -3547.7973748347345, -3552.4409423032403, -3558.688862480492, -3545.3599684208316, -3634.5049529545286, -3543.9360306829058, -3545.4643868304174, -3545.6020746271856, -3546.266420774299, -3547.5945117515953, -3546.2515639788735, -3547.180654663955, -3542.5744282811743, -3544.3693668875094, -3551.0170721001214, -3544.0199045456034, -3555.9008252174585, -3547.052852118063, -3545.461085477762, -3547.521011190102, -3554.165795312169, -3550.2261498743355, -3552.7367250934403, -3556.950081432851, -3551.8274508706522, -3542.322873074976, -3555.148544277189, -3548.850835727826, -3545.449122148641, -3543.8650958880057, -3547.4566727516185, -3545.9979029870665, -3544.4425739389712, -3541.0547551462187, -3558.430752215632, -3552.3085968989235, -3542.488506293041, -3551.9521612813114, -3550.3427946578804, -3541.0503481917694, -3548.596138550916, -3548.530202380513, -3546.9339454621813, -3545.8715705840937, -3552.167853757343, -3547.5017446107067, -3557.0902630512483, -3554.60137859827, -3553.3447340824177, -3544.3718200565513, -3549.0942537353635, -3551.9175093796453, -3549.1993638290223, -3547.3293707395324, -3544.5091473304215, -3552.7155455678558, -3542.806241773586, -3548.681961477035, -3542.7530494827456, -3551.5505413099872, -3544.587980402555, -3547.5189929602807, -3543.9826496059522, -3549.063141630265, -3550.6318788461967, -3543.3708945100543, -3553.46249641705, -3546.1503509079953, -3544.2454623910853, -3545.3703528475035, -3542.9859966714794, -3542.27026037034, -3543.854227330668, -3542.796717232129, -3548.722902040503, -3550.3963809169077, -3547.349561178362, -3544.912944014346, -3551.8633391618464, -3545.511259124869, -3547.1478992066427, -3540.7956288644655, -3552.521010774109, -3547.4303895779244, -3546.157297863772, -3550.4356127041497, -3543.975899261874, -3548.749174758646, -3542.644924033714, -3643.1726358374194, -3542.681351401795, -3540.745687250526, -3547.408389976526, -3570.5552217674776], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.3382570660719875, "mean_inference_ms": 0.3812203552889807, "mean_action_processing_ms": 0.0930369423661089, "mean_env_wait_ms": 1.0859172180383332, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0038123130798339844, "StateBufferConnector_ms": 0.002821683883666992, "ViewRequirementAgentConnector_ms": 0.0673074722290039}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1422000, "num_agent_steps_trained": 1422000, "num_env_steps_sampled": 1422000, "num_env_steps_trained": 1422000, "num_env_steps_sampled_this_iter": 1440, "num_env_steps_trained_this_iter": 1440, "num_env_steps_sampled_throughput_per_sec": 114.12090910550964, "num_env_steps_trained_throughput_per_sec": 114.12090910550964, "timesteps_total": 1422000, "num_steps_trained_this_iter": 1440, "agent_timesteps_total": 1422000, "timers": {"training_iteration_time_ms": 3212.791, "sample_time_ms": 3201.793, "load_time_ms": 0.303, "load_throughput": 1186880.553, "learn_time_ms": 9.732, "learn_throughput": 36990.795, "synch_weights_time_ms": 0.908}, "counters": {"num_env_steps_sampled": 1422000, "num_env_steps_trained": 1422000, "num_agent_steps_sampled": 1422000, "num_agent_steps_trained": 1422000}, "done": false, "episodes_total": 5350, "training_iteration": 1130, "trial_id": "68078_00000", "date": "2023-08-05_10-33-00", "timestamp": 1691220780, "time_this_iter_s": 12.621062278747559, "time_total_s": 14661.27451300621, "pid": 54946, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[1400000, 5e-09], [1405400, 8e-09], [1410800, 2.5e-09], [1416200, 2.5e-09], [1421600, 2.5e-09], [1427000, 2.5e-09], [1432400, 1e-09], [1437800, 1e-09], [1443200, 1e-09], [1448600, 5e-10], [1454000, 5e-10], [1459400, 5e-10], [1464800, 5e-10], [1470200, 1e-10], [1475600, 1e-10], [1481000, 1e-10], [1486400, 1e-10], [1491800, 5e-11], [1497200, 5e-11], [1502600, 2.5e-11], [1508000, 2.5e-11], [1513400, 1e-11], [1518800, 1e-11], [1524200, 5e-12], [1529600, 5e-12], [1535000, 1e-12]], "grad_clip": 5, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.2, "final_epsilon": 0.01, "epsilon_timesteps": 1401170}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x3061b8b80>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 379.06716561317444, "iterations_since_restore": 30, "perf": {"cpu_util_percent": 29.738888888888894, "ram_util_percent": 69.25000000000001}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 2.5e-09, "entropy_coeff": 0.1, "policy_entropy": -322.30120849609375, "policy_loss": -9181250.325, "vf_loss": 20973867.9}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 613.0, "diff_num_grad_updates_vs_sampler_policy": 612.0}}, "num_env_steps_sampled": 1423440, "num_env_steps_trained": 1423440, "num_agent_steps_sampled": 1423440, "num_agent_steps_trained": 1423440}, "sampler_results": {"episode_reward_max": -3540.745687250526, "episode_reward_min": -3643.1726358374194, "episode_reward_mean": -3549.707314212384, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3549.9316400437892, -3549.39529152929, -3547.7973748347345, -3552.4409423032403, -3558.688862480492, -3545.3599684208316, -3634.5049529545286, -3543.9360306829058, -3545.4643868304174, -3545.6020746271856, -3546.266420774299, -3547.5945117515953, -3546.2515639788735, -3547.180654663955, -3542.5744282811743, -3544.3693668875094, -3551.0170721001214, -3544.0199045456034, -3555.9008252174585, -3547.052852118063, -3545.461085477762, -3547.521011190102, -3554.165795312169, -3550.2261498743355, -3552.7367250934403, -3556.950081432851, -3551.8274508706522, -3542.322873074976, -3555.148544277189, -3548.850835727826, -3545.449122148641, -3543.8650958880057, -3547.4566727516185, -3545.9979029870665, -3544.4425739389712, -3541.0547551462187, -3558.430752215632, -3552.3085968989235, -3542.488506293041, -3551.9521612813114, -3550.3427946578804, -3541.0503481917694, -3548.596138550916, -3548.530202380513, -3546.9339454621813, -3545.8715705840937, -3552.167853757343, -3547.5017446107067, -3557.0902630512483, -3554.60137859827, -3553.3447340824177, -3544.3718200565513, -3549.0942537353635, -3551.9175093796453, -3549.1993638290223, -3547.3293707395324, -3544.5091473304215, -3552.7155455678558, -3542.806241773586, -3548.681961477035, -3542.7530494827456, -3551.5505413099872, -3544.587980402555, -3547.5189929602807, -3543.9826496059522, -3549.063141630265, -3550.6318788461967, -3543.3708945100543, -3553.46249641705, -3546.1503509079953, -3544.2454623910853, -3545.3703528475035, -3542.9859966714794, -3542.27026037034, -3543.854227330668, -3542.796717232129, -3548.722902040503, -3550.3963809169077, -3547.349561178362, -3544.912944014346, -3551.8633391618464, -3545.511259124869, -3547.1478992066427, -3540.7956288644655, -3552.521010774109, -3547.4303895779244, -3546.157297863772, -3550.4356127041497, -3543.975899261874, -3548.749174758646, -3542.644924033714, -3643.1726358374194, -3542.681351401795, -3540.745687250526, -3547.408389976526, -3570.5552217674776, -3540.9796917648564, -3551.5785167687327, -3540.8742972758123, -3548.864408073654], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.333263938794603, "mean_inference_ms": 0.3813941887104666, "mean_action_processing_ms": 0.09307502745436139, "mean_env_wait_ms": 1.0739120720143855, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003810405731201172, "StateBufferConnector_ms": 0.0028209686279296875, "ViewRequirementAgentConnector_ms": 0.06734919548034668}}, "episode_reward_max": -3540.745687250526, "episode_reward_min": -3643.1726358374194, "episode_reward_mean": -3549.707314212384, "episode_len_mean": 360.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-3549.9316400437892, -3549.39529152929, -3547.7973748347345, -3552.4409423032403, -3558.688862480492, -3545.3599684208316, -3634.5049529545286, -3543.9360306829058, -3545.4643868304174, -3545.6020746271856, -3546.266420774299, -3547.5945117515953, -3546.2515639788735, -3547.180654663955, -3542.5744282811743, -3544.3693668875094, -3551.0170721001214, -3544.0199045456034, -3555.9008252174585, -3547.052852118063, -3545.461085477762, -3547.521011190102, -3554.165795312169, -3550.2261498743355, -3552.7367250934403, -3556.950081432851, -3551.8274508706522, -3542.322873074976, -3555.148544277189, -3548.850835727826, -3545.449122148641, -3543.8650958880057, -3547.4566727516185, -3545.9979029870665, -3544.4425739389712, -3541.0547551462187, -3558.430752215632, -3552.3085968989235, -3542.488506293041, -3551.9521612813114, -3550.3427946578804, -3541.0503481917694, -3548.596138550916, -3548.530202380513, -3546.9339454621813, -3545.8715705840937, -3552.167853757343, -3547.5017446107067, -3557.0902630512483, -3554.60137859827, -3553.3447340824177, -3544.3718200565513, -3549.0942537353635, -3551.9175093796453, -3549.1993638290223, -3547.3293707395324, -3544.5091473304215, -3552.7155455678558, -3542.806241773586, -3548.681961477035, -3542.7530494827456, -3551.5505413099872, -3544.587980402555, -3547.5189929602807, -3543.9826496059522, -3549.063141630265, -3550.6318788461967, -3543.3708945100543, -3553.46249641705, -3546.1503509079953, -3544.2454623910853, -3545.3703528475035, -3542.9859966714794, -3542.27026037034, -3543.854227330668, -3542.796717232129, -3548.722902040503, -3550.3963809169077, -3547.349561178362, -3544.912944014346, -3551.8633391618464, -3545.511259124869, -3547.1478992066427, -3540.7956288644655, -3552.521010774109, -3547.4303895779244, -3546.157297863772, -3550.4356127041497, -3543.975899261874, -3548.749174758646, -3542.644924033714, -3643.1726358374194, -3542.681351401795, -3540.745687250526, -3547.408389976526, -3570.5552217674776, -3540.9796917648564, -3551.5785167687327, -3540.8742972758123, -3548.864408073654], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.333263938794603, "mean_inference_ms": 0.3813941887104666, "mean_action_processing_ms": 0.09307502745436139, "mean_env_wait_ms": 1.0739120720143855, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003810405731201172, "StateBufferConnector_ms": 0.0028209686279296875, "ViewRequirementAgentConnector_ms": 0.06734919548034668}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1423440, "num_agent_steps_trained": 1423440, "num_env_steps_sampled": 1423440, "num_env_steps_trained": 1423440, "num_env_steps_sampled_this_iter": 1440, "num_env_steps_trained_this_iter": 1440, "num_env_steps_sampled_throughput_per_sec": 116.02617038690913, "num_env_steps_trained_throughput_per_sec": 116.02617038690913, "timesteps_total": 1423440, "num_steps_trained_this_iter": 1440, "agent_timesteps_total": 1423440, "timers": {"training_iteration_time_ms": 3146.404, "sample_time_ms": 3135.276, "load_time_ms": 0.305, "load_throughput": 1181863.995, "learn_time_ms": 9.842, "learn_throughput": 36578.764, "synch_weights_time_ms": 0.928}, "counters": {"num_env_steps_sampled": 1423440, "num_env_steps_trained": 1423440, "num_agent_steps_sampled": 1423440, "num_agent_steps_trained": 1423440}, "done": false, "episodes_total": 5354, "training_iteration": 1131, "trial_id": "68078_00000", "date": "2023-08-05_10-33-13", "timestamp": 1691220793, "time_this_iter_s": 12.413864135742188, "time_total_s": 14673.688377141953, "pid": 54946, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[1400000, 5e-09], [1405400, 8e-09], [1410800, 2.5e-09], [1416200, 2.5e-09], [1421600, 2.5e-09], [1427000, 2.5e-09], [1432400, 1e-09], [1437800, 1e-09], [1443200, 1e-09], [1448600, 5e-10], [1454000, 5e-10], [1459400, 5e-10], [1464800, 5e-10], [1470200, 1e-10], [1475600, 1e-10], [1481000, 1e-10], [1486400, 1e-10], [1491800, 5e-11], [1497200, 5e-11], [1502600, 2.5e-11], [1508000, 2.5e-11], [1513400, 1e-11], [1518800, 1e-11], [1524200, 5e-12], [1529600, 5e-12], [1535000, 1e-12]], "grad_clip": 5, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.2, "final_epsilon": 0.01, "epsilon_timesteps": 1401170}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x3061b8b80>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 391.4810297489166, "iterations_since_restore": 31, "perf": {"cpu_util_percent": 27.63888888888889, "ram_util_percent": 69.26666666666667}}
