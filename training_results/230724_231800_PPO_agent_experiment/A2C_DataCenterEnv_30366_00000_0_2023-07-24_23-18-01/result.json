{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-07, "entropy_coeff": 0.09999999999999999, "policy_entropy": 69.7457936150687, "policy_loss": 11730.23197719029, "vf_loss": 959419.9988839285}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 84.5, "diff_num_grad_updates_vs_sampler_policy": 83.5}}, "num_env_steps_sampled": 21480, "num_env_steps_trained": 21480, "num_agent_steps_sampled": 21480, "num_agent_steps_trained": 21480}, "sampler_results": {"episode_reward_max": 6472.9208637880565, "episode_reward_min": 6339.812419465837, "episode_reward_mean": 6406.366641626946, "episode_len_mean": 3600.0, "episode_media": {}, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [6472.9208637880565, 6339.812419465837], "episode_lengths": [3600, 3600]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5341620763760939, "mean_inference_ms": 0.24812109949456007, "mean_action_processing_ms": 0.05814691762628861, "mean_env_wait_ms": 1.2016683100925651, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006186962127685547, "StateBufferConnector_ms": 0.0017404556274414062, "ViewRequirementAgentConnector_ms": 0.04380941390991211}}, "episode_reward_max": 6472.9208637880565, "episode_reward_min": 6339.812419465837, "episode_reward_mean": 6406.366641626946, "episode_len_mean": 3600.0, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [6472.9208637880565, 6339.812419465837], "episode_lengths": [3600, 3600]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5341620763760939, "mean_inference_ms": 0.24812109949456007, "mean_action_processing_ms": 0.05814691762628861, "mean_env_wait_ms": 1.2016683100925651, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006186962127685547, "StateBufferConnector_ms": 0.0017404556274414062, "ViewRequirementAgentConnector_ms": 0.04380941390991211}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 21480, "num_agent_steps_trained": 21480, "num_env_steps_sampled": 21480, "num_env_steps_trained": 21480, "num_env_steps_sampled_this_iter": 7200, "num_env_steps_trained_this_iter": 7200, "num_env_steps_sampled_throughput_per_sec": 481.3862245093474, "num_env_steps_trained_throughput_per_sec": 481.3862245093474, "timesteps_total": 21480, "num_steps_trained_this_iter": 7200, "agent_timesteps_total": 21480, "timers": {"training_iteration_time_ms": 7478.384, "sample_time_ms": 7400.933, "load_time_ms": 0.824, "load_throughput": 4369698.857, "learn_time_ms": 75.986, "learn_throughput": 47377.428, "synch_weights_time_ms": 0.597}, "counters": {"num_env_steps_sampled": 21480, "num_env_steps_trained": 21480, "num_agent_steps_sampled": 21480, "num_agent_steps_trained": 21480}, "done": false, "episodes_total": 121, "training_iteration": 21, "trial_id": "30366_00000", "date": "2023-07-24_23-18-20", "timestamp": 1690229900, "time_this_iter_s": 14.95867395401001, "time_total_s": 228.5714819431305, "pid": 49740, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 30, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[299400, 0.0005], [342600, 0.00025], [385800, 0.0001], [429000, 5e-05], [472200, 2.5e-05], [515400, 1e-05], [558600, 7.5e-06], [601800, 5e-06], [645000, 2.5e-06], [688200, 1e-06], [731400, 7.5e-07], [774600, 5e-07], [817800, 2.5e-07], [861000, 1e-07]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 3600, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x1590ec430>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 14.95867395401001, "iterations_since_restore": 1, "perf": {"cpu_util_percent": 25.218181818181815, "ram_util_percent": 79.62272727272727}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-07, "entropy_coeff": 0.09999999999999999, "policy_entropy": 69.8173782484872, "policy_loss": 11688.836373465401, "vf_loss": 927156.4305245535}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 196.5, "diff_num_grad_updates_vs_sampler_policy": 195.5}}, "num_env_steps_sampled": 28680, "num_env_steps_trained": 28680, "num_agent_steps_sampled": 28680, "num_agent_steps_trained": 28680}, "sampler_results": {"episode_reward_max": 6472.9208637880565, "episode_reward_min": 6211.571156794661, "episode_reward_mean": 6339.640779770671, "episode_len_mean": 3600.0, "episode_media": {}, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [6472.9208637880565, 6339.812419465837, 6334.258679034131, 6211.571156794661], "episode_lengths": [3600, 3600, 3600, 3600]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5349528379921283, "mean_inference_ms": 0.24764762889841324, "mean_action_processing_ms": 0.05818812380888333, "mean_env_wait_ms": 1.1393477295531282, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005543231964111328, "StateBufferConnector_ms": 0.0018537044525146484, "ViewRequirementAgentConnector_ms": 0.04772543907165527}}, "episode_reward_max": 6472.9208637880565, "episode_reward_min": 6211.571156794661, "episode_reward_mean": 6339.640779770671, "episode_len_mean": 3600.0, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [6472.9208637880565, 6339.812419465837, 6334.258679034131, 6211.571156794661], "episode_lengths": [3600, 3600, 3600, 3600]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5349528379921283, "mean_inference_ms": 0.24764762889841324, "mean_action_processing_ms": 0.05818812380888333, "mean_env_wait_ms": 1.1393477295531282, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005543231964111328, "StateBufferConnector_ms": 0.0018537044525146484, "ViewRequirementAgentConnector_ms": 0.04772543907165527}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 28680, "num_agent_steps_trained": 28680, "num_env_steps_sampled": 28680, "num_env_steps_trained": 28680, "num_env_steps_sampled_this_iter": 7200, "num_env_steps_trained_this_iter": 7200, "num_env_steps_sampled_throughput_per_sec": 547.916062109345, "num_env_steps_trained_throughput_per_sec": 547.916062109345, "timesteps_total": 28680, "num_steps_trained_this_iter": 7200, "agent_timesteps_total": 28680, "timers": {"training_iteration_time_ms": 7024.361, "sample_time_ms": 6953.465, "load_time_ms": 1.066, "load_throughput": 3378340.843, "learn_time_ms": 69.187, "learn_throughput": 52032.638, "synch_weights_time_ms": 0.6}, "counters": {"num_env_steps_sampled": 28680, "num_env_steps_trained": 28680, "num_agent_steps_sampled": 28680, "num_agent_steps_trained": 28680}, "done": false, "episodes_total": 123, "training_iteration": 22, "trial_id": "30366_00000", "date": "2023-07-24_23-18-33", "timestamp": 1690229913, "time_this_iter_s": 13.142621755599976, "time_total_s": 241.71410369873047, "pid": 49740, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 30, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[299400, 0.0005], [342600, 0.00025], [385800, 0.0001], [429000, 5e-05], [472200, 2.5e-05], [515400, 1e-05], [558600, 7.5e-06], [601800, 5e-06], [645000, 2.5e-06], [688200, 1e-06], [731400, 7.5e-07], [774600, 5e-07], [817800, 2.5e-07], [861000, 1e-07]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 3600, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x1590ec430>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 28.101295709609985, "iterations_since_restore": 2, "perf": {"cpu_util_percent": 26.26842105263158, "ram_util_percent": 79.27368421052631}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-07, "entropy_coeff": 0.09999999999999999, "policy_entropy": 70.00982461656842, "policy_loss": 10877.075073242188, "vf_loss": 833139.0638950893}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 308.5, "diff_num_grad_updates_vs_sampler_policy": 307.5}}, "num_env_steps_sampled": 35880, "num_env_steps_trained": 35880, "num_agent_steps_sampled": 35880, "num_agent_steps_trained": 35880}, "sampler_results": {"episode_reward_max": 6472.9208637880565, "episode_reward_min": 5875.440605207955, "episode_reward_mean": 6275.383984286739, "episode_len_mean": 3600.0, "episode_media": {}, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [6472.9208637880565, 6339.812419465837, 6334.258679034131, 6211.571156794661, 6418.300181429795, 5875.440605207955], "episode_lengths": [3600, 3600, 3600, 3600, 3600, 3600]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5351256207528545, "mean_inference_ms": 0.24786747294068226, "mean_action_processing_ms": 0.058316431376748634, "mean_env_wait_ms": 1.1058927249581776, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006095568339029948, "StateBufferConnector_ms": 0.002451737721761068, "ViewRequirementAgentConnector_ms": 0.05529324213663737}}, "episode_reward_max": 6472.9208637880565, "episode_reward_min": 5875.440605207955, "episode_reward_mean": 6275.383984286739, "episode_len_mean": 3600.0, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [6472.9208637880565, 6339.812419465837, 6334.258679034131, 6211.571156794661, 6418.300181429795, 5875.440605207955], "episode_lengths": [3600, 3600, 3600, 3600, 3600, 3600]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5351256207528545, "mean_inference_ms": 0.24786747294068226, "mean_action_processing_ms": 0.058316431376748634, "mean_env_wait_ms": 1.1058927249581776, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006095568339029948, "StateBufferConnector_ms": 0.002451737721761068, "ViewRequirementAgentConnector_ms": 0.05529324213663737}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 35880, "num_agent_steps_trained": 35880, "num_env_steps_sampled": 35880, "num_env_steps_trained": 35880, "num_env_steps_sampled_this_iter": 7200, "num_env_steps_trained_this_iter": 7200, "num_env_steps_sampled_throughput_per_sec": 543.8034831527281, "num_env_steps_trained_throughput_per_sec": 543.8034831527281, "timesteps_total": 35880, "num_steps_trained_this_iter": 7200, "agent_timesteps_total": 35880, "timers": {"training_iteration_time_ms": 6889.581, "sample_time_ms": 6820.836, "load_time_ms": 1.074, "load_throughput": 3351595.072, "learn_time_ms": 67.014, "learn_throughput": 53720.454, "synch_weights_time_ms": 0.614}, "counters": {"num_env_steps_sampled": 35880, "num_env_steps_trained": 35880, "num_agent_steps_sampled": 35880, "num_agent_steps_trained": 35880}, "done": false, "episodes_total": 125, "training_iteration": 23, "trial_id": "30366_00000", "date": "2023-07-24_23-18-46", "timestamp": 1690229926, "time_this_iter_s": 13.242061138153076, "time_total_s": 254.95616483688354, "pid": 49740, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 30, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[299400, 0.0005], [342600, 0.00025], [385800, 0.0001], [429000, 5e-05], [472200, 2.5e-05], [515400, 1e-05], [558600, 7.5e-06], [601800, 5e-06], [645000, 2.5e-06], [688200, 1e-06], [731400, 7.5e-07], [774600, 5e-07], [817800, 2.5e-07], [861000, 1e-07]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 3600, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x1590ec430>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 41.34335684776306, "iterations_since_restore": 3, "perf": {"cpu_util_percent": 22.833333333333336, "ram_util_percent": 79.32777777777778}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-07, "entropy_coeff": 0.09999999999999999, "policy_entropy": 69.51483549390521, "policy_loss": 12023.022962297711, "vf_loss": 1015305.0066964285}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 420.5, "diff_num_grad_updates_vs_sampler_policy": 419.5}}, "num_env_steps_sampled": 43080, "num_env_steps_trained": 43080, "num_agent_steps_sampled": 43080, "num_agent_steps_trained": 43080}, "sampler_results": {"episode_reward_max": 6524.779609310018, "episode_reward_min": 5875.440605207955, "episode_reward_mean": 6286.765137706647, "episode_len_mean": 3600.0, "episode_media": {}, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [6472.9208637880565, 6339.812419465837, 6334.258679034131, 6211.571156794661, 6418.300181429795, 5875.440605207955, 6117.037586622728, 6524.779609310018], "episode_lengths": [3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5351085264230886, "mean_inference_ms": 0.2477687317789184, "mean_action_processing_ms": 0.05835344575798584, "mean_env_wait_ms": 1.0837088730458526, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005665421485900879, "StateBufferConnector_ms": 0.002282857894897461, "ViewRequirementAgentConnector_ms": 0.05319714546203613}}, "episode_reward_max": 6524.779609310018, "episode_reward_min": 5875.440605207955, "episode_reward_mean": 6286.765137706647, "episode_len_mean": 3600.0, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [6472.9208637880565, 6339.812419465837, 6334.258679034131, 6211.571156794661, 6418.300181429795, 5875.440605207955, 6117.037586622728, 6524.779609310018], "episode_lengths": [3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5351085264230886, "mean_inference_ms": 0.2477687317789184, "mean_action_processing_ms": 0.05835344575798584, "mean_env_wait_ms": 1.0837088730458526, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005665421485900879, "StateBufferConnector_ms": 0.002282857894897461, "ViewRequirementAgentConnector_ms": 0.05319714546203613}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 43080, "num_agent_steps_trained": 43080, "num_env_steps_sampled": 43080, "num_env_steps_trained": 43080, "num_env_steps_sampled_this_iter": 7200, "num_env_steps_trained_this_iter": 7200, "num_env_steps_sampled_throughput_per_sec": 549.717221999466, "num_env_steps_trained_throughput_per_sec": 549.717221999466, "timesteps_total": 43080, "num_steps_trained_this_iter": 7200, "agent_timesteps_total": 43080, "timers": {"training_iteration_time_ms": 6804.388, "sample_time_ms": 6737.022, "load_time_ms": 1.036, "load_throughput": 3473743.464, "learn_time_ms": 65.675, "learn_throughput": 54815.312, "synch_weights_time_ms": 0.612}, "counters": {"num_env_steps_sampled": 43080, "num_env_steps_trained": 43080, "num_agent_steps_sampled": 43080, "num_agent_steps_trained": 43080}, "done": false, "episodes_total": 127, "training_iteration": 24, "trial_id": "30366_00000", "date": "2023-07-24_23-19-00", "timestamp": 1690229940, "time_this_iter_s": 13.099503993988037, "time_total_s": 268.0556688308716, "pid": 49740, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 30, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[299400, 0.0005], [342600, 0.00025], [385800, 0.0001], [429000, 5e-05], [472200, 2.5e-05], [515400, 1e-05], [558600, 7.5e-06], [601800, 5e-06], [645000, 2.5e-06], [688200, 1e-06], [731400, 7.5e-07], [774600, 5e-07], [817800, 2.5e-07], [861000, 1e-07]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 3600, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x1590ec430>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 54.4428608417511, "iterations_since_restore": 4, "perf": {"cpu_util_percent": 21.326315789473682, "ram_util_percent": 79.12105263157896}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-07, "entropy_coeff": 0.09999999999999999, "policy_entropy": 69.24109922136579, "policy_loss": 11164.995653424945, "vf_loss": 894565.7159598215}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 532.5, "diff_num_grad_updates_vs_sampler_policy": 531.5}}, "num_env_steps_sampled": 50280, "num_env_steps_trained": 50280, "num_agent_steps_sampled": 50280, "num_agent_steps_trained": 50280}, "sampler_results": {"episode_reward_max": 6524.779609310018, "episode_reward_min": 5875.440605207955, "episode_reward_mean": 6264.146906875314, "episode_len_mean": 3600.0, "episode_media": {}, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [6472.9208637880565, 6339.812419465837, 6334.258679034131, 6211.571156794661, 6418.300181429795, 5875.440605207955, 6117.037586622728, 6524.779609310018, 6229.074338156758, 6118.273628943209], "episode_lengths": [3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5350190061916903, "mean_inference_ms": 0.24770848508108628, "mean_action_processing_ms": 0.058380902833182126, "mean_env_wait_ms": 1.0677240361284053, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005421638488769531, "StateBufferConnector_ms": 0.0022172927856445312, "ViewRequirementAgentConnector_ms": 0.05243539810180664}}, "episode_reward_max": 6524.779609310018, "episode_reward_min": 5875.440605207955, "episode_reward_mean": 6264.146906875314, "episode_len_mean": 3600.0, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [6472.9208637880565, 6339.812419465837, 6334.258679034131, 6211.571156794661, 6418.300181429795, 5875.440605207955, 6117.037586622728, 6524.779609310018, 6229.074338156758, 6118.273628943209], "episode_lengths": [3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5350190061916903, "mean_inference_ms": 0.24770848508108628, "mean_action_processing_ms": 0.058380902833182126, "mean_env_wait_ms": 1.0677240361284053, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005421638488769531, "StateBufferConnector_ms": 0.0022172927856445312, "ViewRequirementAgentConnector_ms": 0.05243539810180664}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 50280, "num_agent_steps_trained": 50280, "num_env_steps_sampled": 50280, "num_env_steps_trained": 50280, "num_env_steps_sampled_this_iter": 7200, "num_env_steps_trained_this_iter": 7200, "num_env_steps_sampled_throughput_per_sec": 549.4218660377674, "num_env_steps_trained_throughput_per_sec": 549.4218660377674, "timesteps_total": 50280, "num_steps_trained_this_iter": 7200, "agent_timesteps_total": 50280, "timers": {"training_iteration_time_ms": 6753.977, "sample_time_ms": 6687.301, "load_time_ms": 1.059, "load_throughput": 3398873.247, "learn_time_ms": 64.971, "learn_throughput": 55409.565, "synch_weights_time_ms": 0.603}, "counters": {"num_env_steps_sampled": 50280, "num_env_steps_trained": 50280, "num_agent_steps_sampled": 50280, "num_agent_steps_trained": 50280}, "done": false, "episodes_total": 129, "training_iteration": 25, "trial_id": "30366_00000", "date": "2023-07-24_23-19-13", "timestamp": 1690229953, "time_this_iter_s": 13.10672903060913, "time_total_s": 281.1623978614807, "pid": 49740, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 30, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[299400, 0.0005], [342600, 0.00025], [385800, 0.0001], [429000, 5e-05], [472200, 2.5e-05], [515400, 1e-05], [558600, 7.5e-06], [601800, 5e-06], [645000, 2.5e-06], [688200, 1e-06], [731400, 7.5e-07], [774600, 5e-07], [817800, 2.5e-07], [861000, 1e-07]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 3600, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x1590ec430>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 67.54958987236023, "iterations_since_restore": 5, "perf": {"cpu_util_percent": 23.2, "ram_util_percent": 79.11052631578947}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-07, "entropy_coeff": 0.09999999999999999, "policy_entropy": 69.4416628565107, "policy_loss": 11538.602948869977, "vf_loss": 955442.2419084822}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 644.5, "diff_num_grad_updates_vs_sampler_policy": 643.5}}, "num_env_steps_sampled": 57480, "num_env_steps_trained": 57480, "num_agent_steps_sampled": 57480, "num_agent_steps_trained": 57480}, "sampler_results": {"episode_reward_max": 6524.779609310018, "episode_reward_min": 5875.440605207955, "episode_reward_mean": 6281.864511704637, "episode_len_mean": 3600.0, "episode_media": {}, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [6472.9208637880565, 6339.812419465837, 6334.258679034131, 6211.571156794661, 6418.300181429795, 5875.440605207955, 6117.037586622728, 6524.779609310018, 6229.074338156758, 6118.273628943209, 6419.584446941989, 6321.320624760528], "episode_lengths": [3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5349715821483686, "mean_inference_ms": 0.24779257667463564, "mean_action_processing_ms": 0.05842325771171825, "mean_env_wait_ms": 1.055921790693655, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004883607228597005, "StateBufferConnector_ms": 0.0021437803904215493, "ViewRequirementAgentConnector_ms": 0.05122820536295573}}, "episode_reward_max": 6524.779609310018, "episode_reward_min": 5875.440605207955, "episode_reward_mean": 6281.864511704637, "episode_len_mean": 3600.0, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [6472.9208637880565, 6339.812419465837, 6334.258679034131, 6211.571156794661, 6418.300181429795, 5875.440605207955, 6117.037586622728, 6524.779609310018, 6229.074338156758, 6118.273628943209, 6419.584446941989, 6321.320624760528], "episode_lengths": [3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5349715821483686, "mean_inference_ms": 0.24779257667463564, "mean_action_processing_ms": 0.05842325771171825, "mean_env_wait_ms": 1.055921790693655, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004883607228597005, "StateBufferConnector_ms": 0.0021437803904215493, "ViewRequirementAgentConnector_ms": 0.05122820536295573}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 57480, "num_agent_steps_trained": 57480, "num_env_steps_sampled": 57480, "num_env_steps_trained": 57480, "num_env_steps_sampled_this_iter": 7200, "num_env_steps_trained_this_iter": 7200, "num_env_steps_sampled_throughput_per_sec": 543.4664889411754, "num_env_steps_trained_throughput_per_sec": 543.4664889411754, "timesteps_total": 57480, "num_steps_trained_this_iter": 7200, "agent_timesteps_total": 57480, "timers": {"training_iteration_time_ms": 6583.126, "sample_time_ms": 6519.233, "load_time_ms": 1.14, "load_throughput": 3157634.915, "learn_time_ms": 62.11, "learn_throughput": 57961.374, "synch_weights_time_ms": 0.599}, "counters": {"num_env_steps_sampled": 57480, "num_env_steps_trained": 57480, "num_agent_steps_sampled": 57480, "num_agent_steps_trained": 57480}, "done": false, "episodes_total": 131, "training_iteration": 26, "trial_id": "30366_00000", "date": "2023-07-24_23-19-26", "timestamp": 1690229966, "time_this_iter_s": 13.250113010406494, "time_total_s": 294.4125108718872, "pid": 49740, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 30, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[299400, 0.0005], [342600, 0.00025], [385800, 0.0001], [429000, 5e-05], [472200, 2.5e-05], [515400, 1e-05], [558600, 7.5e-06], [601800, 5e-06], [645000, 2.5e-06], [688200, 1e-06], [731400, 7.5e-07], [774600, 5e-07], [817800, 2.5e-07], [861000, 1e-07]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 3600, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x1590ec430>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 80.79970288276672, "iterations_since_restore": 6, "perf": {"cpu_util_percent": 26.447368421052634, "ram_util_percent": 79.25263157894737}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-07, "entropy_coeff": 0.09999999999999999, "policy_entropy": 69.08683599744525, "policy_loss": 11503.070521763393, "vf_loss": 914373.4338727678}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 756.5, "diff_num_grad_updates_vs_sampler_policy": 755.5}}, "num_env_steps_sampled": 64680, "num_env_steps_trained": 64680, "num_agent_steps_sampled": 64680, "num_agent_steps_trained": 64680}, "sampler_results": {"episode_reward_max": 6524.779609310018, "episode_reward_min": 5875.440605207955, "episode_reward_mean": 6258.729596039886, "episode_len_mean": 3600.0, "episode_media": {}, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [6472.9208637880565, 6339.812419465837, 6334.258679034131, 6211.571156794661, 6418.300181429795, 5875.440605207955, 6117.037586622728, 6524.779609310018, 6229.074338156758, 6118.273628943209, 6419.584446941989, 6321.320624760528, 6077.574408109293, 6162.265795993462], "episode_lengths": [3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5348861163542032, "mean_inference_ms": 0.24780206859259107, "mean_action_processing_ms": 0.05844560550817655, "mean_env_wait_ms": 1.0464946306080567, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004514626094273159, "StateBufferConnector_ms": 0.0020946775163922992, "ViewRequirementAgentConnector_ms": 0.05049194608415876}}, "episode_reward_max": 6524.779609310018, "episode_reward_min": 5875.440605207955, "episode_reward_mean": 6258.729596039886, "episode_len_mean": 3600.0, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [6472.9208637880565, 6339.812419465837, 6334.258679034131, 6211.571156794661, 6418.300181429795, 5875.440605207955, 6117.037586622728, 6524.779609310018, 6229.074338156758, 6118.273628943209, 6419.584446941989, 6321.320624760528, 6077.574408109293, 6162.265795993462], "episode_lengths": [3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5348861163542032, "mean_inference_ms": 0.24780206859259107, "mean_action_processing_ms": 0.05844560550817655, "mean_env_wait_ms": 1.0464946306080567, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004514626094273159, "StateBufferConnector_ms": 0.0020946775163922992, "ViewRequirementAgentConnector_ms": 0.05049194608415876}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 64680, "num_agent_steps_trained": 64680, "num_env_steps_sampled": 64680, "num_env_steps_trained": 64680, "num_env_steps_sampled_this_iter": 7200, "num_env_steps_trained_this_iter": 7200, "num_env_steps_sampled_throughput_per_sec": 550.9586253070922, "num_env_steps_trained_throughput_per_sec": 550.9586253070922, "timesteps_total": 64680, "num_steps_trained_this_iter": 7200, "agent_timesteps_total": 64680, "timers": {"training_iteration_time_ms": 6575.87, "sample_time_ms": 6512.062, "load_time_ms": 1.097, "load_throughput": 3280644.505, "learn_time_ms": 62.071, "learn_throughput": 57997.752, "synch_weights_time_ms": 0.595}, "counters": {"num_env_steps_sampled": 64680, "num_env_steps_trained": 64680, "num_agent_steps_sampled": 64680, "num_agent_steps_trained": 64680}, "done": false, "episodes_total": 133, "training_iteration": 27, "trial_id": "30366_00000", "date": "2023-07-24_23-19-39", "timestamp": 1690229979, "time_this_iter_s": 13.070086240768433, "time_total_s": 307.48259711265564, "pid": 49740, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 30, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[299400, 0.0005], [342600, 0.00025], [385800, 0.0001], [429000, 5e-05], [472200, 2.5e-05], [515400, 1e-05], [558600, 7.5e-06], [601800, 5e-06], [645000, 2.5e-06], [688200, 1e-06], [731400, 7.5e-07], [774600, 5e-07], [817800, 2.5e-07], [861000, 1e-07]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 3600, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x1590ec430>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 93.86978912353516, "iterations_since_restore": 7, "perf": {"cpu_util_percent": 21.305555555555557, "ram_util_percent": 78.94999999999999}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-07, "entropy_coeff": 0.09999999999999999, "policy_entropy": 69.62437071119037, "policy_loss": 11022.582641601562, "vf_loss": 824143.6551339285}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 868.5, "diff_num_grad_updates_vs_sampler_policy": 867.5}}, "num_env_steps_sampled": 71880, "num_env_steps_trained": 71880, "num_agent_steps_sampled": 71880, "num_agent_steps_trained": 71880}, "sampler_results": {"episode_reward_max": 6524.779609310018, "episode_reward_min": 5822.434483329361, "episode_reward_mean": 6233.086607052259, "episode_len_mean": 3600.0, "episode_media": {}, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [6472.9208637880565, 6339.812419465837, 6334.258679034131, 6211.571156794661, 6418.300181429795, 5875.440605207955, 6117.037586622728, 6524.779609310018, 6229.074338156758, 6118.273628943209, 6419.584446941989, 6321.320624760528, 6077.574408109293, 6162.265795993462, 6284.736884948364, 5822.434483329361], "episode_lengths": [3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5347974791783079, "mean_inference_ms": 0.24775615078398644, "mean_action_processing_ms": 0.05845807899786062, "mean_env_wait_ms": 1.038675599664308, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004240870475769043, "StateBufferConnector_ms": 0.002084672451019287, "ViewRequirementAgentConnector_ms": 0.049933791160583496}}, "episode_reward_max": 6524.779609310018, "episode_reward_min": 5822.434483329361, "episode_reward_mean": 6233.086607052259, "episode_len_mean": 3600.0, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [6472.9208637880565, 6339.812419465837, 6334.258679034131, 6211.571156794661, 6418.300181429795, 5875.440605207955, 6117.037586622728, 6524.779609310018, 6229.074338156758, 6118.273628943209, 6419.584446941989, 6321.320624760528, 6077.574408109293, 6162.265795993462, 6284.736884948364, 5822.434483329361], "episode_lengths": [3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5347974791783079, "mean_inference_ms": 0.24775615078398644, "mean_action_processing_ms": 0.05845807899786062, "mean_env_wait_ms": 1.038675599664308, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004240870475769043, "StateBufferConnector_ms": 0.002084672451019287, "ViewRequirementAgentConnector_ms": 0.049933791160583496}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 71880, "num_agent_steps_trained": 71880, "num_env_steps_sampled": 71880, "num_env_steps_trained": 71880, "num_env_steps_sampled_this_iter": 7200, "num_env_steps_trained_this_iter": 7200, "num_env_steps_sampled_throughput_per_sec": 552.7144900529291, "num_env_steps_trained_throughput_per_sec": 552.7144900529291, "timesteps_total": 71880, "num_steps_trained_this_iter": 7200, "agent_timesteps_total": 71880, "timers": {"training_iteration_time_ms": 6554.524, "sample_time_ms": 6490.632, "load_time_ms": 1.076, "load_throughput": 3345332.861, "learn_time_ms": 62.186, "learn_throughput": 57890.996, "synch_weights_time_ms": 0.585}, "counters": {"num_env_steps_sampled": 71880, "num_env_steps_trained": 71880, "num_agent_steps_sampled": 71880, "num_agent_steps_trained": 71880}, "done": false, "episodes_total": 135, "training_iteration": 28, "trial_id": "30366_00000", "date": "2023-07-24_23-19-52", "timestamp": 1690229992, "time_this_iter_s": 13.028649091720581, "time_total_s": 320.5112462043762, "pid": 49740, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 30, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[299400, 0.0005], [342600, 0.00025], [385800, 0.0001], [429000, 5e-05], [472200, 2.5e-05], [515400, 1e-05], [558600, 7.5e-06], [601800, 5e-06], [645000, 2.5e-06], [688200, 1e-06], [731400, 7.5e-07], [774600, 5e-07], [817800, 2.5e-07], [861000, 1e-07]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 3600, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x1590ec430>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 106.89843821525574, "iterations_since_restore": 8, "perf": {"cpu_util_percent": 22.810526315789474, "ram_util_percent": 79.14736842105265}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-07, "entropy_coeff": 0.09999999999999999, "policy_entropy": 69.05965164729527, "policy_loss": 11400.565272739956, "vf_loss": 886826.3696986607}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 980.5, "diff_num_grad_updates_vs_sampler_policy": 979.5}}, "num_env_steps_sampled": 79080, "num_env_steps_trained": 79080, "num_agent_steps_sampled": 79080, "num_agent_steps_trained": 79080}, "sampler_results": {"episode_reward_max": 6524.779609310018, "episode_reward_min": 5822.434483329361, "episode_reward_mean": 6221.257115839969, "episode_len_mean": 3600.0, "episode_media": {}, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [6472.9208637880565, 6339.812419465837, 6334.258679034131, 6211.571156794661, 6418.300181429795, 5875.440605207955, 6117.037586622728, 6524.779609310018, 6229.074338156758, 6118.273628943209, 6419.584446941989, 6321.320624760528, 6077.574408109293, 6162.265795993462, 6284.736884948364, 5822.434483329361, 6148.113382034317, 6105.12899024897], "episode_lengths": [3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5347409828355053, "mean_inference_ms": 0.24773739761718255, "mean_action_processing_ms": 0.058471355319900616, "mean_env_wait_ms": 1.0322842743588576, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004012054867214627, "StateBufferConnector_ms": 0.0020517243279351127, "ViewRequirementAgentConnector_ms": 0.04939503139919705}}, "episode_reward_max": 6524.779609310018, "episode_reward_min": 5822.434483329361, "episode_reward_mean": 6221.257115839969, "episode_len_mean": 3600.0, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [6472.9208637880565, 6339.812419465837, 6334.258679034131, 6211.571156794661, 6418.300181429795, 5875.440605207955, 6117.037586622728, 6524.779609310018, 6229.074338156758, 6118.273628943209, 6419.584446941989, 6321.320624760528, 6077.574408109293, 6162.265795993462, 6284.736884948364, 5822.434483329361, 6148.113382034317, 6105.12899024897], "episode_lengths": [3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5347409828355053, "mean_inference_ms": 0.24773739761718255, "mean_action_processing_ms": 0.058471355319900616, "mean_env_wait_ms": 1.0322842743588576, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004012054867214627, "StateBufferConnector_ms": 0.0020517243279351127, "ViewRequirementAgentConnector_ms": 0.04939503139919705}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 79080, "num_agent_steps_trained": 79080, "num_env_steps_sampled": 79080, "num_env_steps_trained": 79080, "num_env_steps_sampled_this_iter": 7200, "num_env_steps_trained_this_iter": 7200, "num_env_steps_sampled_throughput_per_sec": 545.5932654626309, "num_env_steps_trained_throughput_per_sec": 545.5932654626309, "timesteps_total": 79080, "num_steps_trained_this_iter": 7200, "agent_timesteps_total": 79080, "timers": {"training_iteration_time_ms": 6564.423, "sample_time_ms": 6500.254, "load_time_ms": 1.13, "load_throughput": 3185816.187, "learn_time_ms": 62.402, "learn_throughput": 57690.053, "synch_weights_time_ms": 0.59}, "counters": {"num_env_steps_sampled": 79080, "num_env_steps_trained": 79080, "num_agent_steps_sampled": 79080, "num_agent_steps_trained": 79080}, "done": false, "episodes_total": 137, "training_iteration": 29, "trial_id": "30366_00000", "date": "2023-07-24_23-20-05", "timestamp": 1690230005, "time_this_iter_s": 13.198575973510742, "time_total_s": 333.70982217788696, "pid": 49740, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 30, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[299400, 0.0005], [342600, 0.00025], [385800, 0.0001], [429000, 5e-05], [472200, 2.5e-05], [515400, 1e-05], [558600, 7.5e-06], [601800, 5e-06], [645000, 2.5e-06], [688200, 1e-06], [731400, 7.5e-07], [774600, 5e-07], [817800, 2.5e-07], [861000, 1e-07]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 3600, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x1590ec430>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 120.09701418876648, "iterations_since_restore": 9, "perf": {"cpu_util_percent": 24.005555555555556, "ram_util_percent": 79.17777777777778}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-07, "entropy_coeff": 0.09999999999999999, "policy_entropy": 69.02824592590332, "policy_loss": 12240.465628487724, "vf_loss": 1058470.3221261161}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 1092.5, "diff_num_grad_updates_vs_sampler_policy": 1091.5}}, "num_env_steps_sampled": 86280, "num_env_steps_trained": 86280, "num_agent_steps_sampled": 86280, "num_agent_steps_trained": 86280}, "sampler_results": {"episode_reward_max": 6649.952851613771, "episode_reward_min": 5822.434483329361, "episode_reward_mean": 6255.5300385931305, "episode_len_mean": 3600.0, "episode_media": {}, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [6472.9208637880565, 6339.812419465837, 6334.258679034131, 6211.571156794661, 6418.300181429795, 5875.440605207955, 6117.037586622728, 6524.779609310018, 6229.074338156758, 6118.273628943209, 6419.584446941989, 6321.320624760528, 6077.574408109293, 6162.265795993462, 6284.736884948364, 5822.434483329361, 6148.113382034317, 6105.12899024897, 6478.019835129416, 6649.952851613771], "episode_lengths": [3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5346673835848008, "mean_inference_ms": 0.24776008182135478, "mean_action_processing_ms": 0.05848720851435073, "mean_env_wait_ms": 1.0269021175338466, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0038576126098632812, "StateBufferConnector_ms": 0.0020444393157958984, "ViewRequirementAgentConnector_ms": 0.04932284355163574}}, "episode_reward_max": 6649.952851613771, "episode_reward_min": 5822.434483329361, "episode_reward_mean": 6255.5300385931305, "episode_len_mean": 3600.0, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [6472.9208637880565, 6339.812419465837, 6334.258679034131, 6211.571156794661, 6418.300181429795, 5875.440605207955, 6117.037586622728, 6524.779609310018, 6229.074338156758, 6118.273628943209, 6419.584446941989, 6321.320624760528, 6077.574408109293, 6162.265795993462, 6284.736884948364, 5822.434483329361, 6148.113382034317, 6105.12899024897, 6478.019835129416, 6649.952851613771], "episode_lengths": [3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5346673835848008, "mean_inference_ms": 0.24776008182135478, "mean_action_processing_ms": 0.05848720851435073, "mean_env_wait_ms": 1.0269021175338466, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0038576126098632812, "StateBufferConnector_ms": 0.0020444393157958984, "ViewRequirementAgentConnector_ms": 0.04932284355163574}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 86280, "num_agent_steps_trained": 86280, "num_env_steps_sampled": 86280, "num_env_steps_trained": 86280, "num_env_steps_sampled_this_iter": 7200, "num_env_steps_trained_this_iter": 7200, "num_env_steps_sampled_throughput_per_sec": 547.4196646072182, "num_env_steps_trained_throughput_per_sec": 547.4196646072182, "timesteps_total": 86280, "num_steps_trained_this_iter": 7200, "agent_timesteps_total": 86280, "timers": {"training_iteration_time_ms": 6569.216, "sample_time_ms": 6505.191, "load_time_ms": 1.109, "load_throughput": 3245527.986, "learn_time_ms": 62.274, "learn_throughput": 57809.345, "synch_weights_time_ms": 0.596}, "counters": {"num_env_steps_sampled": 86280, "num_env_steps_trained": 86280, "num_agent_steps_sampled": 86280, "num_agent_steps_trained": 86280}, "done": false, "episodes_total": 139, "training_iteration": 30, "trial_id": "30366_00000", "date": "2023-07-24_23-20-18", "timestamp": 1690230018, "time_this_iter_s": 13.154514074325562, "time_total_s": 346.8643362522125, "pid": 49740, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 30, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[299400, 0.0005], [342600, 0.00025], [385800, 0.0001], [429000, 5e-05], [472200, 2.5e-05], [515400, 1e-05], [558600, 7.5e-06], [601800, 5e-06], [645000, 2.5e-06], [688200, 1e-06], [731400, 7.5e-07], [774600, 5e-07], [817800, 2.5e-07], [861000, 1e-07]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 3600, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x1590ec430>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 133.25152826309204, "iterations_since_restore": 10, "perf": {"cpu_util_percent": 22.426315789473687, "ram_util_percent": 78.39473684210526}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-07, "entropy_coeff": 0.09999999999999999, "policy_entropy": 69.09719501222882, "policy_loss": 11377.446166992188, "vf_loss": 1018627.111188616}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 1204.5, "diff_num_grad_updates_vs_sampler_policy": 1203.5}}, "num_env_steps_sampled": 93480, "num_env_steps_trained": 93480, "num_agent_steps_sampled": 93480, "num_agent_steps_trained": 93480}, "sampler_results": {"episode_reward_max": 6649.952851613771, "episode_reward_min": 5822.434483329361, "episode_reward_mean": 6264.271001465375, "episode_len_mean": 3600.0, "episode_media": {}, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [6472.9208637880565, 6339.812419465837, 6334.258679034131, 6211.571156794661, 6418.300181429795, 5875.440605207955, 6117.037586622728, 6524.779609310018, 6229.074338156758, 6118.273628943209, 6419.584446941989, 6321.320624760528, 6077.574408109293, 6162.265795993462, 6284.736884948364, 5822.434483329361, 6148.113382034317, 6105.12899024897, 6478.019835129416, 6649.952851613771, 6196.126866374364, 6507.234394001286], "episode_lengths": [3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5346279483656439, "mean_inference_ms": 0.2477697712913609, "mean_action_processing_ms": 0.058497934637945496, "mean_env_wait_ms": 1.022276111641717, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003719329833984375, "StateBufferConnector_ms": 0.0020308928056196733, "ViewRequirementAgentConnector_ms": 0.048913738944313744}}, "episode_reward_max": 6649.952851613771, "episode_reward_min": 5822.434483329361, "episode_reward_mean": 6264.271001465375, "episode_len_mean": 3600.0, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [6472.9208637880565, 6339.812419465837, 6334.258679034131, 6211.571156794661, 6418.300181429795, 5875.440605207955, 6117.037586622728, 6524.779609310018, 6229.074338156758, 6118.273628943209, 6419.584446941989, 6321.320624760528, 6077.574408109293, 6162.265795993462, 6284.736884948364, 5822.434483329361, 6148.113382034317, 6105.12899024897, 6478.019835129416, 6649.952851613771, 6196.126866374364, 6507.234394001286], "episode_lengths": [3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5346279483656439, "mean_inference_ms": 0.2477697712913609, "mean_action_processing_ms": 0.058497934637945496, "mean_env_wait_ms": 1.022276111641717, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003719329833984375, "StateBufferConnector_ms": 0.0020308928056196733, "ViewRequirementAgentConnector_ms": 0.048913738944313744}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 93480, "num_agent_steps_trained": 93480, "num_env_steps_sampled": 93480, "num_env_steps_trained": 93480, "num_env_steps_sampled_this_iter": 7200, "num_env_steps_trained_this_iter": 7200, "num_env_steps_sampled_throughput_per_sec": 548.3100337341796, "num_env_steps_trained_throughput_per_sec": 548.3100337341796, "timesteps_total": 93480, "num_steps_trained_this_iter": 7200, "agent_timesteps_total": 93480, "timers": {"training_iteration_time_ms": 6557.513, "sample_time_ms": 6493.657, "load_time_ms": 1.112, "load_throughput": 3236970.095, "learn_time_ms": 62.09, "learn_throughput": 57980.181, "synch_weights_time_ms": 0.607}, "counters": {"num_env_steps_sampled": 93480, "num_env_steps_trained": 93480, "num_agent_steps_sampled": 93480, "num_agent_steps_trained": 93480}, "done": false, "episodes_total": 141, "training_iteration": 31, "trial_id": "30366_00000", "date": "2023-07-24_23-20-32", "timestamp": 1690230032, "time_this_iter_s": 13.133226871490479, "time_total_s": 359.997563123703, "pid": 49740, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 30, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[299400, 0.0005], [342600, 0.00025], [385800, 0.0001], [429000, 5e-05], [472200, 2.5e-05], [515400, 1e-05], [558600, 7.5e-06], [601800, 5e-06], [645000, 2.5e-06], [688200, 1e-06], [731400, 7.5e-07], [774600, 5e-07], [817800, 2.5e-07], [861000, 1e-07]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 3600, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x1590ec430>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 146.38475513458252, "iterations_since_restore": 11, "perf": {"cpu_util_percent": 22.50526315789474, "ram_util_percent": 78.38421052631578}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-07, "entropy_coeff": 0.09999999999999999, "policy_entropy": 68.70814159938267, "policy_loss": 11968.201834542411, "vf_loss": 1012264.9274553572}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 1316.5, "diff_num_grad_updates_vs_sampler_policy": 1315.5}}, "num_env_steps_sampled": 100680, "num_env_steps_trained": 100680, "num_agent_steps_sampled": 100680, "num_agent_steps_trained": 100680}, "sampler_results": {"episode_reward_max": 6649.952851613771, "episode_reward_min": 5822.434483329361, "episode_reward_mean": 6280.464990987177, "episode_len_mean": 3600.0, "episode_media": {}, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [6472.9208637880565, 6339.812419465837, 6334.258679034131, 6211.571156794661, 6418.300181429795, 5875.440605207955, 6117.037586622728, 6524.779609310018, 6229.074338156758, 6118.273628943209, 6419.584446941989, 6321.320624760528, 6077.574408109293, 6162.265795993462, 6284.736884948364, 5822.434483329361, 6148.113382034317, 6105.12899024897, 6478.019835129416, 6649.952851613771, 6196.126866374364, 6507.234394001286, 6420.098054004528, 6497.099697449449], "episode_lengths": [3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5346138983221426, "mean_inference_ms": 0.24778875975002143, "mean_action_processing_ms": 0.05850862241038126, "mean_env_wait_ms": 1.0182733160936432, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00360111395517985, "StateBufferConnector_ms": 0.0020076831181844077, "ViewRequirementAgentConnector_ms": 0.048635403315226235}}, "episode_reward_max": 6649.952851613771, "episode_reward_min": 5822.434483329361, "episode_reward_mean": 6280.464990987177, "episode_len_mean": 3600.0, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [6472.9208637880565, 6339.812419465837, 6334.258679034131, 6211.571156794661, 6418.300181429795, 5875.440605207955, 6117.037586622728, 6524.779609310018, 6229.074338156758, 6118.273628943209, 6419.584446941989, 6321.320624760528, 6077.574408109293, 6162.265795993462, 6284.736884948364, 5822.434483329361, 6148.113382034317, 6105.12899024897, 6478.019835129416, 6649.952851613771, 6196.126866374364, 6507.234394001286, 6420.098054004528, 6497.099697449449], "episode_lengths": [3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5346138983221426, "mean_inference_ms": 0.24778875975002143, "mean_action_processing_ms": 0.05850862241038126, "mean_env_wait_ms": 1.0182733160936432, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00360111395517985, "StateBufferConnector_ms": 0.0020076831181844077, "ViewRequirementAgentConnector_ms": 0.048635403315226235}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 100680, "num_agent_steps_trained": 100680, "num_env_steps_sampled": 100680, "num_env_steps_trained": 100680, "num_env_steps_sampled_this_iter": 7200, "num_env_steps_trained_this_iter": 7200, "num_env_steps_sampled_throughput_per_sec": 546.0582621725073, "num_env_steps_trained_throughput_per_sec": 546.0582621725073, "timesteps_total": 100680, "num_steps_trained_this_iter": 7200, "agent_timesteps_total": 100680, "timers": {"training_iteration_time_ms": 6569.241, "sample_time_ms": 6505.082, "load_time_ms": 1.118, "load_throughput": 3220538.424, "learn_time_ms": 62.385, "learn_throughput": 57705.861, "synch_weights_time_ms": 0.609}, "counters": {"num_env_steps_sampled": 100680, "num_env_steps_trained": 100680, "num_agent_steps_sampled": 100680, "num_agent_steps_trained": 100680}, "done": false, "episodes_total": 143, "training_iteration": 32, "trial_id": "30366_00000", "date": "2023-07-24_23-20-45", "timestamp": 1690230045, "time_this_iter_s": 13.187347173690796, "time_total_s": 373.1849102973938, "pid": 49740, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 30, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[299400, 0.0005], [342600, 0.00025], [385800, 0.0001], [429000, 5e-05], [472200, 2.5e-05], [515400, 1e-05], [558600, 7.5e-06], [601800, 5e-06], [645000, 2.5e-06], [688200, 1e-06], [731400, 7.5e-07], [774600, 5e-07], [817800, 2.5e-07], [861000, 1e-07]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 3600, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x1590ec430>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 159.57210230827332, "iterations_since_restore": 12, "perf": {"cpu_util_percent": 22.605263157894736, "ram_util_percent": 78.83684210526314}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-07, "entropy_coeff": 0.09999999999999999, "policy_entropy": 69.31303180967059, "policy_loss": 11229.588640485492, "vf_loss": 948025.2837611607}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 1428.5, "diff_num_grad_updates_vs_sampler_policy": 1427.5}}, "num_env_steps_sampled": 107880, "num_env_steps_trained": 107880, "num_agent_steps_sampled": 107880, "num_agent_steps_trained": 107880}, "sampler_results": {"episode_reward_max": 6649.952851613771, "episode_reward_min": 5822.434483329361, "episode_reward_mean": 6281.021208214517, "episode_len_mean": 3600.0, "episode_media": {}, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [6472.9208637880565, 6339.812419465837, 6334.258679034131, 6211.571156794661, 6418.300181429795, 5875.440605207955, 6117.037586622728, 6524.779609310018, 6229.074338156758, 6118.273628943209, 6419.584446941989, 6321.320624760528, 6077.574408109293, 6162.265795993462, 6284.736884948364, 5822.434483329361, 6148.113382034317, 6105.12899024897, 6478.019835129416, 6649.952851613771, 6196.126866374364, 6507.234394001286, 6420.098054004528, 6497.099697449449, 6273.645648477113, 6301.745981408095], "episode_lengths": [3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5346066465023426, "mean_inference_ms": 0.2478158550722662, "mean_action_processing_ms": 0.05851843288714295, "mean_env_wait_ms": 1.0147661012427398, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0035120890690730168, "StateBufferConnector_ms": 0.001999048086313101, "ViewRequirementAgentConnector_ms": 0.048493421994722806}}, "episode_reward_max": 6649.952851613771, "episode_reward_min": 5822.434483329361, "episode_reward_mean": 6281.021208214517, "episode_len_mean": 3600.0, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [6472.9208637880565, 6339.812419465837, 6334.258679034131, 6211.571156794661, 6418.300181429795, 5875.440605207955, 6117.037586622728, 6524.779609310018, 6229.074338156758, 6118.273628943209, 6419.584446941989, 6321.320624760528, 6077.574408109293, 6162.265795993462, 6284.736884948364, 5822.434483329361, 6148.113382034317, 6105.12899024897, 6478.019835129416, 6649.952851613771, 6196.126866374364, 6507.234394001286, 6420.098054004528, 6497.099697449449, 6273.645648477113, 6301.745981408095], "episode_lengths": [3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5346066465023426, "mean_inference_ms": 0.2478158550722662, "mean_action_processing_ms": 0.05851843288714295, "mean_env_wait_ms": 1.0147661012427398, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0035120890690730168, "StateBufferConnector_ms": 0.001999048086313101, "ViewRequirementAgentConnector_ms": 0.048493421994722806}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 107880, "num_agent_steps_trained": 107880, "num_env_steps_sampled": 107880, "num_env_steps_trained": 107880, "num_env_steps_sampled_this_iter": 7200, "num_env_steps_trained_this_iter": 7200, "num_env_steps_sampled_throughput_per_sec": 546.9102889494434, "num_env_steps_trained_throughput_per_sec": 546.9102889494434, "timesteps_total": 107880, "num_steps_trained_this_iter": 7200, "agent_timesteps_total": 107880, "timers": {"training_iteration_time_ms": 6583.065, "sample_time_ms": 6519.215, "load_time_ms": 1.136, "load_throughput": 3168102.725, "learn_time_ms": 62.055, "learn_throughput": 58012.905, "synch_weights_time_ms": 0.61}, "counters": {"num_env_steps_sampled": 107880, "num_env_steps_trained": 107880, "num_agent_steps_sampled": 107880, "num_agent_steps_trained": 107880}, "done": false, "episodes_total": 145, "training_iteration": 33, "trial_id": "30366_00000", "date": "2023-07-24_23-20-58", "timestamp": 1690230058, "time_this_iter_s": 13.167052984237671, "time_total_s": 386.35196328163147, "pid": 49740, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 30, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[299400, 0.0005], [342600, 0.00025], [385800, 0.0001], [429000, 5e-05], [472200, 2.5e-05], [515400, 1e-05], [558600, 7.5e-06], [601800, 5e-06], [645000, 2.5e-06], [688200, 1e-06], [731400, 7.5e-07], [774600, 5e-07], [817800, 2.5e-07], [861000, 1e-07]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 3600, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x1590ec430>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 172.739155292511, "iterations_since_restore": 13, "perf": {"cpu_util_percent": 20.099999999999998, "ram_util_percent": 78.86111111111113}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-07, "entropy_coeff": 0.09999999999999999, "policy_entropy": 69.21325479234967, "policy_loss": 11252.05610874721, "vf_loss": 867654.2181919643}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 1540.5, "diff_num_grad_updates_vs_sampler_policy": 1539.5}}, "num_env_steps_sampled": 115080, "num_env_steps_trained": 115080, "num_agent_steps_sampled": 115080, "num_agent_steps_trained": 115080}, "sampler_results": {"episode_reward_max": 6649.952851613771, "episode_reward_min": 5822.434483329361, "episode_reward_mean": 6257.712910467051, "episode_len_mean": 3600.0, "episode_media": {}, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [6472.9208637880565, 6339.812419465837, 6334.258679034131, 6211.571156794661, 6418.300181429795, 5875.440605207955, 6117.037586622728, 6524.779609310018, 6229.074338156758, 6118.273628943209, 6419.584446941989, 6321.320624760528, 6077.574408109293, 6162.265795993462, 6284.736884948364, 5822.434483329361, 6148.113382034317, 6105.12899024897, 6478.019835129416, 6649.952851613771, 6196.126866374364, 6507.234394001286, 6420.098054004528, 6497.099697449449, 6273.645648477113, 6301.745981408095, 5883.384315134592, 6026.025764365394], "episode_lengths": [3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5345841295633706, "mean_inference_ms": 0.24783209368640166, "mean_action_processing_ms": 0.05852466015324599, "mean_env_wait_ms": 1.0116649825897872, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003426415579659598, "StateBufferConnector_ms": 0.001987389155796596, "ViewRequirementAgentConnector_ms": 0.04831382206508091}}, "episode_reward_max": 6649.952851613771, "episode_reward_min": 5822.434483329361, "episode_reward_mean": 6257.712910467051, "episode_len_mean": 3600.0, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [6472.9208637880565, 6339.812419465837, 6334.258679034131, 6211.571156794661, 6418.300181429795, 5875.440605207955, 6117.037586622728, 6524.779609310018, 6229.074338156758, 6118.273628943209, 6419.584446941989, 6321.320624760528, 6077.574408109293, 6162.265795993462, 6284.736884948364, 5822.434483329361, 6148.113382034317, 6105.12899024897, 6478.019835129416, 6649.952851613771, 6196.126866374364, 6507.234394001286, 6420.098054004528, 6497.099697449449, 6273.645648477113, 6301.745981408095, 5883.384315134592, 6026.025764365394], "episode_lengths": [3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5345841295633706, "mean_inference_ms": 0.24783209368640166, "mean_action_processing_ms": 0.05852466015324599, "mean_env_wait_ms": 1.0116649825897872, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003426415579659598, "StateBufferConnector_ms": 0.001987389155796596, "ViewRequirementAgentConnector_ms": 0.04831382206508091}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 115080, "num_agent_steps_trained": 115080, "num_env_steps_sampled": 115080, "num_env_steps_trained": 115080, "num_env_steps_sampled_this_iter": 7200, "num_env_steps_trained_this_iter": 7200, "num_env_steps_sampled_throughput_per_sec": 549.0115534078507, "num_env_steps_trained_throughput_per_sec": 549.0115534078507, "timesteps_total": 115080, "num_steps_trained_this_iter": 7200, "agent_timesteps_total": 115080, "timers": {"training_iteration_time_ms": 6574.85, "sample_time_ms": 6510.879, "load_time_ms": 1.093, "load_throughput": 3294890.436, "learn_time_ms": 62.227, "learn_throughput": 57852.691, "synch_weights_time_ms": 0.603}, "counters": {"num_env_steps_sampled": 115080, "num_env_steps_trained": 115080, "num_agent_steps_sampled": 115080, "num_agent_steps_trained": 115080}, "done": false, "episodes_total": 147, "training_iteration": 34, "trial_id": "30366_00000", "date": "2023-07-24_23-21-11", "timestamp": 1690230071, "time_this_iter_s": 13.116385698318481, "time_total_s": 399.46834897994995, "pid": 49740, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 30, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[299400, 0.0005], [342600, 0.00025], [385800, 0.0001], [429000, 5e-05], [472200, 2.5e-05], [515400, 1e-05], [558600, 7.5e-06], [601800, 5e-06], [645000, 2.5e-06], [688200, 1e-06], [731400, 7.5e-07], [774600, 5e-07], [817800, 2.5e-07], [861000, 1e-07]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 3600, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x1590ec430>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 185.85554099082947, "iterations_since_restore": 14, "perf": {"cpu_util_percent": 20.98421052631579, "ram_util_percent": 78.47368421052632}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-07, "entropy_coeff": 0.09999999999999999, "policy_entropy": 68.82645000730243, "policy_loss": 11683.279479980469, "vf_loss": 1008019.7371651785}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 1652.5, "diff_num_grad_updates_vs_sampler_policy": 1651.5}}, "num_env_steps_sampled": 122280, "num_env_steps_trained": 122280, "num_agent_steps_sampled": 122280, "num_agent_steps_trained": 122280}, "sampler_results": {"episode_reward_max": 6649.952851613771, "episode_reward_min": 5822.434483329361, "episode_reward_mean": 6271.405495523495, "episode_len_mean": 3600.0, "episode_media": {}, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [6472.9208637880565, 6339.812419465837, 6334.258679034131, 6211.571156794661, 6418.300181429795, 5875.440605207955, 6117.037586622728, 6524.779609310018, 6229.074338156758, 6118.273628943209, 6419.584446941989, 6321.320624760528, 6077.574408109293, 6162.265795993462, 6284.736884948364, 5822.434483329361, 6148.113382034317, 6105.12899024897, 6478.019835129416, 6649.952851613771, 6196.126866374364, 6507.234394001286, 6420.098054004528, 6497.099697449449, 6273.645648477113, 6301.745981408095, 5883.384315134592, 6026.025764365394, 6436.971932561103, 6489.231440066342], "episode_lengths": [3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5345593642351896, "mean_inference_ms": 0.24786389389664493, "mean_action_processing_ms": 0.058537855201720654, "mean_env_wait_ms": 1.0089359682233692, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003352959950764974, "StateBufferConnector_ms": 0.001967748006184896, "ViewRequirementAgentConnector_ms": 0.04815101623535156}}, "episode_reward_max": 6649.952851613771, "episode_reward_min": 5822.434483329361, "episode_reward_mean": 6271.405495523495, "episode_len_mean": 3600.0, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [6472.9208637880565, 6339.812419465837, 6334.258679034131, 6211.571156794661, 6418.300181429795, 5875.440605207955, 6117.037586622728, 6524.779609310018, 6229.074338156758, 6118.273628943209, 6419.584446941989, 6321.320624760528, 6077.574408109293, 6162.265795993462, 6284.736884948364, 5822.434483329361, 6148.113382034317, 6105.12899024897, 6478.019835129416, 6649.952851613771, 6196.126866374364, 6507.234394001286, 6420.098054004528, 6497.099697449449, 6273.645648477113, 6301.745981408095, 5883.384315134592, 6026.025764365394, 6436.971932561103, 6489.231440066342], "episode_lengths": [3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5345593642351896, "mean_inference_ms": 0.24786389389664493, "mean_action_processing_ms": 0.058537855201720654, "mean_env_wait_ms": 1.0089359682233692, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003352959950764974, "StateBufferConnector_ms": 0.001967748006184896, "ViewRequirementAgentConnector_ms": 0.04815101623535156}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 122280, "num_agent_steps_trained": 122280, "num_env_steps_sampled": 122280, "num_env_steps_trained": 122280, "num_env_steps_sampled_this_iter": 7200, "num_env_steps_trained_this_iter": 7200, "num_env_steps_sampled_throughput_per_sec": 543.9072540079517, "num_env_steps_trained_throughput_per_sec": 543.9072540079517, "timesteps_total": 122280, "num_steps_trained_this_iter": 7200, "agent_timesteps_total": 122280, "timers": {"training_iteration_time_ms": 6583.343, "sample_time_ms": 6519.07, "load_time_ms": 1.107, "load_throughput": 3253219.804, "learn_time_ms": 62.518, "learn_throughput": 57583.481, "synch_weights_time_ms": 0.6}, "counters": {"num_env_steps_sampled": 122280, "num_env_steps_trained": 122280, "num_agent_steps_sampled": 122280, "num_agent_steps_trained": 122280}, "done": false, "episodes_total": 149, "training_iteration": 35, "trial_id": "30366_00000", "date": "2023-07-24_23-21-24", "timestamp": 1690230084, "time_this_iter_s": 13.239525079727173, "time_total_s": 412.7078740596771, "pid": 49740, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 30, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[299400, 0.0005], [342600, 0.00025], [385800, 0.0001], [429000, 5e-05], [472200, 2.5e-05], [515400, 1e-05], [558600, 7.5e-06], [601800, 5e-06], [645000, 2.5e-06], [688200, 1e-06], [731400, 7.5e-07], [774600, 5e-07], [817800, 2.5e-07], [861000, 1e-07]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 3600, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x1590ec430>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 199.09506607055664, "iterations_since_restore": 15, "perf": {"cpu_util_percent": 23.757894736842104, "ram_util_percent": 78.4421052631579}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-07, "entropy_coeff": 0.09999999999999999, "policy_entropy": 69.1729508808681, "policy_loss": 11290.045436314174, "vf_loss": 852497.1026785715}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 1764.5, "diff_num_grad_updates_vs_sampler_policy": 1763.5}}, "num_env_steps_sampled": 129480, "num_env_steps_trained": 129480, "num_agent_steps_sampled": 129480, "num_agent_steps_trained": 129480}, "sampler_results": {"episode_reward_max": 6649.952851613771, "episode_reward_min": 5822.434483329361, "episode_reward_mean": 6261.71828175654, "episode_len_mean": 3600.0, "episode_media": {}, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [6472.9208637880565, 6339.812419465837, 6334.258679034131, 6211.571156794661, 6418.300181429795, 5875.440605207955, 6117.037586622728, 6524.779609310018, 6229.074338156758, 6118.273628943209, 6419.584446941989, 6321.320624760528, 6077.574408109293, 6162.265795993462, 6284.736884948364, 5822.434483329361, 6148.113382034317, 6105.12899024897, 6478.019835129416, 6649.952851613771, 6196.126866374364, 6507.234394001286, 6420.098054004528, 6497.099697449449, 6273.645648477113, 6301.745981408095, 5883.384315134592, 6026.025764365394, 6436.971932561103, 6489.231440066342, 6260.451966543025, 5972.368183961365], "episode_lengths": [3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5345293635997218, "mean_inference_ms": 0.24789737505253562, "mean_action_processing_ms": 0.0585499543915949, "mean_env_wait_ms": 1.0064762765171307, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0032819807529449463, "StateBufferConnector_ms": 0.0019513070583343506, "ViewRequirementAgentConnector_ms": 0.048107653856277466}}, "episode_reward_max": 6649.952851613771, "episode_reward_min": 5822.434483329361, "episode_reward_mean": 6261.71828175654, "episode_len_mean": 3600.0, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [6472.9208637880565, 6339.812419465837, 6334.258679034131, 6211.571156794661, 6418.300181429795, 5875.440605207955, 6117.037586622728, 6524.779609310018, 6229.074338156758, 6118.273628943209, 6419.584446941989, 6321.320624760528, 6077.574408109293, 6162.265795993462, 6284.736884948364, 5822.434483329361, 6148.113382034317, 6105.12899024897, 6478.019835129416, 6649.952851613771, 6196.126866374364, 6507.234394001286, 6420.098054004528, 6497.099697449449, 6273.645648477113, 6301.745981408095, 5883.384315134592, 6026.025764365394, 6436.971932561103, 6489.231440066342, 6260.451966543025, 5972.368183961365], "episode_lengths": [3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5345293635997218, "mean_inference_ms": 0.24789737505253562, "mean_action_processing_ms": 0.0585499543915949, "mean_env_wait_ms": 1.0064762765171307, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0032819807529449463, "StateBufferConnector_ms": 0.0019513070583343506, "ViewRequirementAgentConnector_ms": 0.048107653856277466}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 129480, "num_agent_steps_trained": 129480, "num_env_steps_sampled": 129480, "num_env_steps_trained": 129480, "num_env_steps_sampled_this_iter": 7200, "num_env_steps_trained_this_iter": 7200, "num_env_steps_sampled_throughput_per_sec": 548.2760081889761, "num_env_steps_trained_throughput_per_sec": 548.2760081889761, "timesteps_total": 129480, "num_steps_trained_this_iter": 7200, "agent_timesteps_total": 129480, "timers": {"training_iteration_time_ms": 6583.424, "sample_time_ms": 6519.046, "load_time_ms": 1.104, "load_throughput": 3259821.762, "learn_time_ms": 62.628, "learn_throughput": 57481.898, "synch_weights_time_ms": 0.594}, "counters": {"num_env_steps_sampled": 129480, "num_env_steps_trained": 129480, "num_agent_steps_sampled": 129480, "num_agent_steps_trained": 129480}, "done": false, "episodes_total": 151, "training_iteration": 36, "trial_id": "30366_00000", "date": "2023-07-24_23-21-38", "timestamp": 1690230098, "time_this_iter_s": 13.134305000305176, "time_total_s": 425.8421790599823, "pid": 49740, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 30, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[299400, 0.0005], [342600, 0.00025], [385800, 0.0001], [429000, 5e-05], [472200, 2.5e-05], [515400, 1e-05], [558600, 7.5e-06], [601800, 5e-06], [645000, 2.5e-06], [688200, 1e-06], [731400, 7.5e-07], [774600, 5e-07], [817800, 2.5e-07], [861000, 1e-07]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 3600, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x1590ec430>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 212.22937107086182, "iterations_since_restore": 16, "perf": {"cpu_util_percent": 22.966666666666665, "ram_util_percent": 78.59999999999998}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-07, "entropy_coeff": 0.09999999999999999, "policy_entropy": 68.45887640544346, "policy_loss": 11389.411167689732, "vf_loss": 934948.6905691965}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 1876.5, "diff_num_grad_updates_vs_sampler_policy": 1875.5}}, "num_env_steps_sampled": 136680, "num_env_steps_trained": 136680, "num_agent_steps_sampled": 136680, "num_agent_steps_trained": 136680}, "sampler_results": {"episode_reward_max": 6649.952851613771, "episode_reward_min": 5822.434483329361, "episode_reward_mean": 6263.386232022829, "episode_len_mean": 3600.0, "episode_media": {}, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [6472.9208637880565, 6339.812419465837, 6334.258679034131, 6211.571156794661, 6418.300181429795, 5875.440605207955, 6117.037586622728, 6524.779609310018, 6229.074338156758, 6118.273628943209, 6419.584446941989, 6321.320624760528, 6077.574408109293, 6162.265795993462, 6284.736884948364, 5822.434483329361, 6148.113382034317, 6105.12899024897, 6478.019835129416, 6649.952851613771, 6196.126866374364, 6507.234394001286, 6420.098054004528, 6497.099697449449, 6273.645648477113, 6301.745981408095, 5883.384315134592, 6026.025764365394, 6436.971932561103, 6489.231440066342, 6260.451966543025, 5972.368183961365, 6298.574182194228, 6281.572690372666], "episode_lengths": [3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5344961217952114, "mean_inference_ms": 0.2479309045506802, "mean_action_processing_ms": 0.05856074493676981, "mean_env_wait_ms": 1.0042701206112183, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0032796579248764936, "StateBufferConnector_ms": 0.0019382028018727021, "ViewRequirementAgentConnector_ms": 0.047948079950669235}}, "episode_reward_max": 6649.952851613771, "episode_reward_min": 5822.434483329361, "episode_reward_mean": 6263.386232022829, "episode_len_mean": 3600.0, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [6472.9208637880565, 6339.812419465837, 6334.258679034131, 6211.571156794661, 6418.300181429795, 5875.440605207955, 6117.037586622728, 6524.779609310018, 6229.074338156758, 6118.273628943209, 6419.584446941989, 6321.320624760528, 6077.574408109293, 6162.265795993462, 6284.736884948364, 5822.434483329361, 6148.113382034317, 6105.12899024897, 6478.019835129416, 6649.952851613771, 6196.126866374364, 6507.234394001286, 6420.098054004528, 6497.099697449449, 6273.645648477113, 6301.745981408095, 5883.384315134592, 6026.025764365394, 6436.971932561103, 6489.231440066342, 6260.451966543025, 5972.368183961365, 6298.574182194228, 6281.572690372666], "episode_lengths": [3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5344961217952114, "mean_inference_ms": 0.2479309045506802, "mean_action_processing_ms": 0.05856074493676981, "mean_env_wait_ms": 1.0042701206112183, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0032796579248764936, "StateBufferConnector_ms": 0.0019382028018727021, "ViewRequirementAgentConnector_ms": 0.047948079950669235}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 136680, "num_agent_steps_trained": 136680, "num_env_steps_sampled": 136680, "num_env_steps_trained": 136680, "num_env_steps_sampled_this_iter": 7200, "num_env_steps_trained_this_iter": 7200, "num_env_steps_sampled_throughput_per_sec": 546.5030451734999, "num_env_steps_trained_throughput_per_sec": 546.5030451734999, "timesteps_total": 136680, "num_steps_trained_this_iter": 7200, "agent_timesteps_total": 136680, "timers": {"training_iteration_time_ms": 6582.351, "sample_time_ms": 6518.7, "load_time_ms": 1.151, "load_throughput": 3128715.609, "learn_time_ms": 61.861, "learn_throughput": 58195.219, "synch_weights_time_ms": 0.588}, "counters": {"num_env_steps_sampled": 136680, "num_env_steps_trained": 136680, "num_agent_steps_sampled": 136680, "num_agent_steps_trained": 136680}, "done": false, "episodes_total": 153, "training_iteration": 37, "trial_id": "30366_00000", "date": "2023-07-24_23-21-51", "timestamp": 1690230111, "time_this_iter_s": 13.176666021347046, "time_total_s": 439.01884508132935, "pid": 49740, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 30, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[299400, 0.0005], [342600, 0.00025], [385800, 0.0001], [429000, 5e-05], [472200, 2.5e-05], [515400, 1e-05], [558600, 7.5e-06], [601800, 5e-06], [645000, 2.5e-06], [688200, 1e-06], [731400, 7.5e-07], [774600, 5e-07], [817800, 2.5e-07], [861000, 1e-07]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 3600, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x1590ec430>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 225.40603709220886, "iterations_since_restore": 17, "perf": {"cpu_util_percent": 21.647368421052633, "ram_util_percent": 78.6421052631579}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-07, "entropy_coeff": 0.09999999999999999, "policy_entropy": 67.97430052076068, "policy_loss": 11908.058968680245, "vf_loss": 982781.21484375}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 1988.5, "diff_num_grad_updates_vs_sampler_policy": 1987.5}}, "num_env_steps_sampled": 143880, "num_env_steps_trained": 143880, "num_agent_steps_sampled": 143880, "num_agent_steps_trained": 143880}, "sampler_results": {"episode_reward_max": 6649.952851613771, "episode_reward_min": 5822.434483329361, "episode_reward_mean": 6260.511692720171, "episode_len_mean": 3600.0, "episode_media": {}, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [6472.9208637880565, 6339.812419465837, 6334.258679034131, 6211.571156794661, 6418.300181429795, 5875.440605207955, 6117.037586622728, 6524.779609310018, 6229.074338156758, 6118.273628943209, 6419.584446941989, 6321.320624760528, 6077.574408109293, 6162.265795993462, 6284.736884948364, 5822.434483329361, 6148.113382034317, 6105.12899024897, 6478.019835129416, 6649.952851613771, 6196.126866374364, 6507.234394001286, 6420.098054004528, 6497.099697449449, 6273.645648477113, 6301.745981408095, 5883.384315134592, 6026.025764365394, 6436.971932561103, 6489.231440066342, 6260.451966543025, 5972.368183961365, 6298.574182194228, 6281.572690372666, 5989.062468186445, 6434.226580963533], "episode_lengths": [3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5344723575941867, "mean_inference_ms": 0.24795531018812234, "mean_action_processing_ms": 0.05856960015739146, "mean_env_wait_ms": 1.0022466888981592, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003237856758965386, "StateBufferConnector_ms": 0.0019272168477376301, "ViewRequirementAgentConnector_ms": 0.04789431889851888}}, "episode_reward_max": 6649.952851613771, "episode_reward_min": 5822.434483329361, "episode_reward_mean": 6260.511692720171, "episode_len_mean": 3600.0, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [6472.9208637880565, 6339.812419465837, 6334.258679034131, 6211.571156794661, 6418.300181429795, 5875.440605207955, 6117.037586622728, 6524.779609310018, 6229.074338156758, 6118.273628943209, 6419.584446941989, 6321.320624760528, 6077.574408109293, 6162.265795993462, 6284.736884948364, 5822.434483329361, 6148.113382034317, 6105.12899024897, 6478.019835129416, 6649.952851613771, 6196.126866374364, 6507.234394001286, 6420.098054004528, 6497.099697449449, 6273.645648477113, 6301.745981408095, 5883.384315134592, 6026.025764365394, 6436.971932561103, 6489.231440066342, 6260.451966543025, 5972.368183961365, 6298.574182194228, 6281.572690372666, 5989.062468186445, 6434.226580963533], "episode_lengths": [3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5344723575941867, "mean_inference_ms": 0.24795531018812234, "mean_action_processing_ms": 0.05856960015739146, "mean_env_wait_ms": 1.0022466888981592, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003237856758965386, "StateBufferConnector_ms": 0.0019272168477376301, "ViewRequirementAgentConnector_ms": 0.04789431889851888}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 143880, "num_agent_steps_trained": 143880, "num_env_steps_sampled": 143880, "num_env_steps_trained": 143880, "num_env_steps_sampled_this_iter": 7200, "num_env_steps_trained_this_iter": 7200, "num_env_steps_sampled_throughput_per_sec": 549.3780177690081, "num_env_steps_trained_throughput_per_sec": 549.3780177690081, "timesteps_total": 143880, "num_steps_trained_this_iter": 7200, "agent_timesteps_total": 143880, "timers": {"training_iteration_time_ms": 6576.437, "sample_time_ms": 6512.931, "load_time_ms": 1.146, "load_throughput": 3142650.821, "learn_time_ms": 61.723, "learn_throughput": 58324.698, "synch_weights_time_ms": 0.588}, "counters": {"num_env_steps_sampled": 143880, "num_env_steps_trained": 143880, "num_agent_steps_sampled": 143880, "num_agent_steps_trained": 143880}, "done": false, "episodes_total": 155, "training_iteration": 38, "trial_id": "30366_00000", "date": "2023-07-24_23-22-04", "timestamp": 1690230124, "time_this_iter_s": 13.107651948928833, "time_total_s": 452.1264970302582, "pid": 49740, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 30, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[299400, 0.0005], [342600, 0.00025], [385800, 0.0001], [429000, 5e-05], [472200, 2.5e-05], [515400, 1e-05], [558600, 7.5e-06], [601800, 5e-06], [645000, 2.5e-06], [688200, 1e-06], [731400, 7.5e-07], [774600, 5e-07], [817800, 2.5e-07], [861000, 1e-07]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 3600, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x1590ec430>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 238.5136890411377, "iterations_since_restore": 18, "perf": {"cpu_util_percent": 24.273684210526316, "ram_util_percent": 78.6421052631579}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-07, "entropy_coeff": 0.09999999999999999, "policy_entropy": 68.6028983933585, "policy_loss": 12257.918160574776, "vf_loss": 990137.2972935268}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 2100.5, "diff_num_grad_updates_vs_sampler_policy": 2099.5}}, "num_env_steps_sampled": 151080, "num_env_steps_trained": 151080, "num_agent_steps_sampled": 151080, "num_agent_steps_trained": 151080}, "sampler_results": {"episode_reward_max": 6649.952851613771, "episode_reward_min": 5822.434483329361, "episode_reward_mean": 6266.227414226404, "episode_len_mean": 3600.0, "episode_media": {}, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [6472.9208637880565, 6339.812419465837, 6334.258679034131, 6211.571156794661, 6418.300181429795, 5875.440605207955, 6117.037586622728, 6524.779609310018, 6229.074338156758, 6118.273628943209, 6419.584446941989, 6321.320624760528, 6077.574408109293, 6162.265795993462, 6284.736884948364, 5822.434483329361, 6148.113382034317, 6105.12899024897, 6478.019835129416, 6649.952851613771, 6196.126866374364, 6507.234394001286, 6420.098054004528, 6497.099697449449, 6273.645648477113, 6301.745981408095, 5883.384315134592, 6026.025764365394, 6436.971932561103, 6489.231440066342, 6260.451966543025, 5972.368183961365, 6298.574182194228, 6281.572690372666, 5989.062468186445, 6434.226580963533, 6327.710311238441, 6410.510491438744], "episode_lengths": [3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5344599816197887, "mean_inference_ms": 0.24797957619445402, "mean_action_processing_ms": 0.05857756188336277, "mean_env_wait_ms": 1.0004113075457202, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0031828880310058594, "StateBufferConnector_ms": 0.0019129953886333265, "ViewRequirementAgentConnector_ms": 0.047775946165385996}}, "episode_reward_max": 6649.952851613771, "episode_reward_min": 5822.434483329361, "episode_reward_mean": 6266.227414226404, "episode_len_mean": 3600.0, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [6472.9208637880565, 6339.812419465837, 6334.258679034131, 6211.571156794661, 6418.300181429795, 5875.440605207955, 6117.037586622728, 6524.779609310018, 6229.074338156758, 6118.273628943209, 6419.584446941989, 6321.320624760528, 6077.574408109293, 6162.265795993462, 6284.736884948364, 5822.434483329361, 6148.113382034317, 6105.12899024897, 6478.019835129416, 6649.952851613771, 6196.126866374364, 6507.234394001286, 6420.098054004528, 6497.099697449449, 6273.645648477113, 6301.745981408095, 5883.384315134592, 6026.025764365394, 6436.971932561103, 6489.231440066342, 6260.451966543025, 5972.368183961365, 6298.574182194228, 6281.572690372666, 5989.062468186445, 6434.226580963533, 6327.710311238441, 6410.510491438744], "episode_lengths": [3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5344599816197887, "mean_inference_ms": 0.24797957619445402, "mean_action_processing_ms": 0.05857756188336277, "mean_env_wait_ms": 1.0004113075457202, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0031828880310058594, "StateBufferConnector_ms": 0.0019129953886333265, "ViewRequirementAgentConnector_ms": 0.047775946165385996}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 151080, "num_agent_steps_trained": 151080, "num_env_steps_sampled": 151080, "num_env_steps_trained": 151080, "num_env_steps_sampled_this_iter": 7200, "num_env_steps_trained_this_iter": 7200, "num_env_steps_sampled_throughput_per_sec": 544.9634595178926, "num_env_steps_trained_throughput_per_sec": 544.9634595178926, "timesteps_total": 151080, "num_steps_trained_this_iter": 7200, "agent_timesteps_total": 151080, "timers": {"training_iteration_time_ms": 6586.179, "sample_time_ms": 6522.974, "load_time_ms": 1.166, "load_throughput": 3088462.753, "learn_time_ms": 61.409, "learn_throughput": 58623.4, "synch_weights_time_ms": 0.582}, "counters": {"num_env_steps_sampled": 151080, "num_env_steps_trained": 151080, "num_agent_steps_sampled": 151080, "num_agent_steps_trained": 151080}, "done": false, "episodes_total": 157, "training_iteration": 39, "trial_id": "30366_00000", "date": "2023-07-24_23-22-17", "timestamp": 1690230137, "time_this_iter_s": 13.213961839675903, "time_total_s": 465.3404588699341, "pid": 49740, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 30, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[299400, 0.0005], [342600, 0.00025], [385800, 0.0001], [429000, 5e-05], [472200, 2.5e-05], [515400, 1e-05], [558600, 7.5e-06], [601800, 5e-06], [645000, 2.5e-06], [688200, 1e-06], [731400, 7.5e-07], [774600, 5e-07], [817800, 2.5e-07], [861000, 1e-07]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 3600, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x1590ec430>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 251.7276508808136, "iterations_since_restore": 19, "perf": {"cpu_util_percent": 23.34210526315789, "ram_util_percent": 78.78947368421052}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-07, "entropy_coeff": 0.09999999999999999, "policy_entropy": 68.53498751776559, "policy_loss": 12252.870906284877, "vf_loss": 963779.720703125}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 2212.5, "diff_num_grad_updates_vs_sampler_policy": 2211.5}}, "num_env_steps_sampled": 158280, "num_env_steps_trained": 158280, "num_agent_steps_sampled": 158280, "num_agent_steps_trained": 158280}, "sampler_results": {"episode_reward_max": 6649.952851613771, "episode_reward_min": 5822.434483329361, "episode_reward_mean": 6258.424554704574, "episode_len_mean": 3600.0, "episode_media": {}, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [6472.9208637880565, 6339.812419465837, 6334.258679034131, 6211.571156794661, 6418.300181429795, 5875.440605207955, 6117.037586622728, 6524.779609310018, 6229.074338156758, 6118.273628943209, 6419.584446941989, 6321.320624760528, 6077.574408109293, 6162.265795993462, 6284.736884948364, 5822.434483329361, 6148.113382034317, 6105.12899024897, 6478.019835129416, 6649.952851613771, 6196.126866374364, 6507.234394001286, 6420.098054004528, 6497.099697449449, 6273.645648477113, 6301.745981408095, 5883.384315134592, 6026.025764365394, 6436.971932561103, 6489.231440066342, 6260.451966543025, 5972.368183961365, 6298.574182194228, 6281.572690372666, 5989.062468186445, 6434.226580963533, 6327.710311238441, 6410.510491438744, 5867.305940846087, 6353.0345067335265], "episode_lengths": [3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5344492521407217, "mean_inference_ms": 0.2479975894221611, "mean_action_processing_ms": 0.0585834291419692, "mean_env_wait_ms": 0.9987473305648115, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0031447410583496094, "StateBufferConnector_ms": 0.0019037723541259766, "ViewRequirementAgentConnector_ms": 0.047734975814819336}}, "episode_reward_max": 6649.952851613771, "episode_reward_min": 5822.434483329361, "episode_reward_mean": 6258.424554704574, "episode_len_mean": 3600.0, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [6472.9208637880565, 6339.812419465837, 6334.258679034131, 6211.571156794661, 6418.300181429795, 5875.440605207955, 6117.037586622728, 6524.779609310018, 6229.074338156758, 6118.273628943209, 6419.584446941989, 6321.320624760528, 6077.574408109293, 6162.265795993462, 6284.736884948364, 5822.434483329361, 6148.113382034317, 6105.12899024897, 6478.019835129416, 6649.952851613771, 6196.126866374364, 6507.234394001286, 6420.098054004528, 6497.099697449449, 6273.645648477113, 6301.745981408095, 5883.384315134592, 6026.025764365394, 6436.971932561103, 6489.231440066342, 6260.451966543025, 5972.368183961365, 6298.574182194228, 6281.572690372666, 5989.062468186445, 6434.226580963533, 6327.710311238441, 6410.510491438744, 5867.305940846087, 6353.0345067335265], "episode_lengths": [3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5344492521407217, "mean_inference_ms": 0.2479975894221611, "mean_action_processing_ms": 0.0585834291419692, "mean_env_wait_ms": 0.9987473305648115, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0031447410583496094, "StateBufferConnector_ms": 0.0019037723541259766, "ViewRequirementAgentConnector_ms": 0.047734975814819336}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 158280, "num_agent_steps_trained": 158280, "num_env_steps_sampled": 158280, "num_env_steps_trained": 158280, "num_env_steps_sampled_this_iter": 7200, "num_env_steps_trained_this_iter": 7200, "num_env_steps_sampled_throughput_per_sec": 545.7165257568573, "num_env_steps_trained_throughput_per_sec": 545.7165257568573, "timesteps_total": 158280, "num_steps_trained_this_iter": 7200, "agent_timesteps_total": 158280, "timers": {"training_iteration_time_ms": 6581.79, "sample_time_ms": 6518.95, "load_time_ms": 1.168, "load_throughput": 3081529.469, "learn_time_ms": 61.043, "learn_throughput": 58974.637, "synch_weights_time_ms": 0.581}, "counters": {"num_env_steps_sampled": 158280, "num_env_steps_trained": 158280, "num_agent_steps_sampled": 158280, "num_agent_steps_trained": 158280}, "done": false, "episodes_total": 159, "training_iteration": 40, "trial_id": "30366_00000", "date": "2023-07-24_23-22-30", "timestamp": 1690230150, "time_this_iter_s": 13.195585012435913, "time_total_s": 478.53604388237, "pid": 49740, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 30, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[299400, 0.0005], [342600, 0.00025], [385800, 0.0001], [429000, 5e-05], [472200, 2.5e-05], [515400, 1e-05], [558600, 7.5e-06], [601800, 5e-06], [645000, 2.5e-06], [688200, 1e-06], [731400, 7.5e-07], [774600, 5e-07], [817800, 2.5e-07], [861000, 1e-07]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 3600, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x1590ec430>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 264.9232358932495, "iterations_since_restore": 20, "perf": {"cpu_util_percent": 21.32777777777778, "ram_util_percent": 78.56666666666666}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-07, "entropy_coeff": 0.09999999999999999, "policy_entropy": 68.61041607175555, "policy_loss": 11093.570329938617, "vf_loss": 931616.6188616072}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 2324.5, "diff_num_grad_updates_vs_sampler_policy": 2323.5}}, "num_env_steps_sampled": 165480, "num_env_steps_trained": 165480, "num_agent_steps_sampled": 165480, "num_agent_steps_trained": 165480}, "sampler_results": {"episode_reward_max": 6649.952851613771, "episode_reward_min": 5822.434483329361, "episode_reward_mean": 6260.608950669832, "episode_len_mean": 3600.0, "episode_media": {}, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [6472.9208637880565, 6339.812419465837, 6334.258679034131, 6211.571156794661, 6418.300181429795, 5875.440605207955, 6117.037586622728, 6524.779609310018, 6229.074338156758, 6118.273628943209, 6419.584446941989, 6321.320624760528, 6077.574408109293, 6162.265795993462, 6284.736884948364, 5822.434483329361, 6148.113382034317, 6105.12899024897, 6478.019835129416, 6649.952851613771, 6196.126866374364, 6507.234394001286, 6420.098054004528, 6497.099697449449, 6273.645648477113, 6301.745981408095, 5883.384315134592, 6026.025764365394, 6436.971932561103, 6489.231440066342, 6260.451966543025, 5972.368183961365, 6298.574182194228, 6281.572690372666, 5989.062468186445, 6434.226580963533, 6327.710311238441, 6410.510491438744, 5867.305940846087, 6353.0345067335265, 6375.566268329367, 6233.027471620641], "episode_lengths": [3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5344371393515918, "mean_inference_ms": 0.2480097148767117, "mean_action_processing_ms": 0.05858871157072461, "mean_env_wait_ms": 0.99719031049542, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0031056858244396393, "StateBufferConnector_ms": 0.0018982660202752975, "ViewRequirementAgentConnector_ms": 0.04762070519583566}}, "episode_reward_max": 6649.952851613771, "episode_reward_min": 5822.434483329361, "episode_reward_mean": 6260.608950669832, "episode_len_mean": 3600.0, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [6472.9208637880565, 6339.812419465837, 6334.258679034131, 6211.571156794661, 6418.300181429795, 5875.440605207955, 6117.037586622728, 6524.779609310018, 6229.074338156758, 6118.273628943209, 6419.584446941989, 6321.320624760528, 6077.574408109293, 6162.265795993462, 6284.736884948364, 5822.434483329361, 6148.113382034317, 6105.12899024897, 6478.019835129416, 6649.952851613771, 6196.126866374364, 6507.234394001286, 6420.098054004528, 6497.099697449449, 6273.645648477113, 6301.745981408095, 5883.384315134592, 6026.025764365394, 6436.971932561103, 6489.231440066342, 6260.451966543025, 5972.368183961365, 6298.574182194228, 6281.572690372666, 5989.062468186445, 6434.226580963533, 6327.710311238441, 6410.510491438744, 5867.305940846087, 6353.0345067335265, 6375.566268329367, 6233.027471620641], "episode_lengths": [3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5344371393515918, "mean_inference_ms": 0.2480097148767117, "mean_action_processing_ms": 0.05858871157072461, "mean_env_wait_ms": 0.99719031049542, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0031056858244396393, "StateBufferConnector_ms": 0.0018982660202752975, "ViewRequirementAgentConnector_ms": 0.04762070519583566}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 165480, "num_agent_steps_trained": 165480, "num_env_steps_sampled": 165480, "num_env_steps_trained": 165480, "num_env_steps_sampled_this_iter": 7200, "num_env_steps_trained_this_iter": 7200, "num_env_steps_sampled_throughput_per_sec": 551.140855057968, "num_env_steps_trained_throughput_per_sec": 551.140855057968, "timesteps_total": 165480, "num_steps_trained_this_iter": 7200, "agent_timesteps_total": 165480, "timers": {"training_iteration_time_ms": 6574.965, "sample_time_ms": 6511.46, "load_time_ms": 1.177, "load_throughput": 3058187.386, "learn_time_ms": 61.704, "learn_throughput": 58342.682, "synch_weights_time_ms": 0.578}, "counters": {"num_env_steps_sampled": 165480, "num_env_steps_trained": 165480, "num_agent_steps_sampled": 165480, "num_agent_steps_trained": 165480}, "done": false, "episodes_total": 161, "training_iteration": 41, "trial_id": "30366_00000", "date": "2023-07-24_23-22-43", "timestamp": 1690230163, "time_this_iter_s": 13.06612515449524, "time_total_s": 491.60216903686523, "pid": 49740, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 30, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[299400, 0.0005], [342600, 0.00025], [385800, 0.0001], [429000, 5e-05], [472200, 2.5e-05], [515400, 1e-05], [558600, 7.5e-06], [601800, 5e-06], [645000, 2.5e-06], [688200, 1e-06], [731400, 7.5e-07], [774600, 5e-07], [817800, 2.5e-07], [861000, 1e-07]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 3600, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x1590ec430>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 277.98936104774475, "iterations_since_restore": 21, "perf": {"cpu_util_percent": 22.236842105263158, "ram_util_percent": 78.66315789473684}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-07, "entropy_coeff": 0.09999999999999999, "policy_entropy": 68.68762316022601, "policy_loss": 11522.337559291294, "vf_loss": 933360.2522321428}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 2436.5, "diff_num_grad_updates_vs_sampler_policy": 2435.5}}, "num_env_steps_sampled": 172680, "num_env_steps_trained": 172680, "num_agent_steps_sampled": 172680, "num_agent_steps_trained": 172680}, "sampler_results": {"episode_reward_max": 6649.952851613771, "episode_reward_min": 5822.434483329361, "episode_reward_mean": 6265.492648912423, "episode_len_mean": 3600.0, "episode_media": {}, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [6472.9208637880565, 6339.812419465837, 6334.258679034131, 6211.571156794661, 6418.300181429795, 5875.440605207955, 6117.037586622728, 6524.779609310018, 6229.074338156758, 6118.273628943209, 6419.584446941989, 6321.320624760528, 6077.574408109293, 6162.265795993462, 6284.736884948364, 5822.434483329361, 6148.113382034317, 6105.12899024897, 6478.019835129416, 6649.952851613771, 6196.126866374364, 6507.234394001286, 6420.098054004528, 6497.099697449449, 6273.645648477113, 6301.745981408095, 5883.384315134592, 6026.025764365394, 6436.971932561103, 6489.231440066342, 6260.451966543025, 5972.368183961365, 6298.574182194228, 6281.572690372666, 5989.062468186445, 6434.226580963533, 6327.710311238441, 6410.510491438744, 5867.305940846087, 6353.0345067335265, 6375.566268329367, 6233.027471620641, 6448.014165047721, 6288.086458965973], "episode_lengths": [3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5344243669426401, "mean_inference_ms": 0.24802474740785432, "mean_action_processing_ms": 0.05859372235772798, "mean_env_wait_ms": 0.995749708855712, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0030994415283203125, "StateBufferConnector_ms": 0.001903013749556108, "ViewRequirementAgentConnector_ms": 0.047769871625033294}}, "episode_reward_max": 6649.952851613771, "episode_reward_min": 5822.434483329361, "episode_reward_mean": 6265.492648912423, "episode_len_mean": 3600.0, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [6472.9208637880565, 6339.812419465837, 6334.258679034131, 6211.571156794661, 6418.300181429795, 5875.440605207955, 6117.037586622728, 6524.779609310018, 6229.074338156758, 6118.273628943209, 6419.584446941989, 6321.320624760528, 6077.574408109293, 6162.265795993462, 6284.736884948364, 5822.434483329361, 6148.113382034317, 6105.12899024897, 6478.019835129416, 6649.952851613771, 6196.126866374364, 6507.234394001286, 6420.098054004528, 6497.099697449449, 6273.645648477113, 6301.745981408095, 5883.384315134592, 6026.025764365394, 6436.971932561103, 6489.231440066342, 6260.451966543025, 5972.368183961365, 6298.574182194228, 6281.572690372666, 5989.062468186445, 6434.226580963533, 6327.710311238441, 6410.510491438744, 5867.305940846087, 6353.0345067335265, 6375.566268329367, 6233.027471620641, 6448.014165047721, 6288.086458965973], "episode_lengths": [3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5344243669426401, "mean_inference_ms": 0.24802474740785432, "mean_action_processing_ms": 0.05859372235772798, "mean_env_wait_ms": 0.995749708855712, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0030994415283203125, "StateBufferConnector_ms": 0.001903013749556108, "ViewRequirementAgentConnector_ms": 0.047769871625033294}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 172680, "num_agent_steps_trained": 172680, "num_env_steps_sampled": 172680, "num_env_steps_trained": 172680, "num_env_steps_sampled_this_iter": 7200, "num_env_steps_trained_this_iter": 7200, "num_env_steps_sampled_throughput_per_sec": 547.3766115615176, "num_env_steps_trained_throughput_per_sec": 547.3766115615176, "timesteps_total": 172680, "num_steps_trained_this_iter": 7200, "agent_timesteps_total": 172680, "timers": {"training_iteration_time_ms": 6572.862, "sample_time_ms": 6509.033, "load_time_ms": 1.1, "load_throughput": 3272397.035, "learn_time_ms": 62.093, "learn_throughput": 57977.198, "synch_weights_time_ms": 0.591}, "counters": {"num_env_steps_sampled": 172680, "num_env_steps_trained": 172680, "num_agent_steps_sampled": 172680, "num_agent_steps_trained": 172680}, "done": false, "episodes_total": 163, "training_iteration": 42, "trial_id": "30366_00000", "date": "2023-07-24_23-22-57", "timestamp": 1690230177, "time_this_iter_s": 13.155767917633057, "time_total_s": 504.7579369544983, "pid": 49740, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 30, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[299400, 0.0005], [342600, 0.00025], [385800, 0.0001], [429000, 5e-05], [472200, 2.5e-05], [515400, 1e-05], [558600, 7.5e-06], [601800, 5e-06], [645000, 2.5e-06], [688200, 1e-06], [731400, 7.5e-07], [774600, 5e-07], [817800, 2.5e-07], [861000, 1e-07]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 3600, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x1590ec430>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 291.1451289653778, "iterations_since_restore": 22, "perf": {"cpu_util_percent": 23.86842105263158, "ram_util_percent": 78.56842105263158}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-07, "entropy_coeff": 0.09999999999999999, "policy_entropy": 68.35258000237602, "policy_loss": 11685.83606828962, "vf_loss": 987114.9534040178}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 2548.5, "diff_num_grad_updates_vs_sampler_policy": 2547.5}}, "num_env_steps_sampled": 179880, "num_env_steps_trained": 179880, "num_agent_steps_sampled": 179880, "num_agent_steps_trained": 179880}, "sampler_results": {"episode_reward_max": 6649.952851613771, "episode_reward_min": 5822.434483329361, "episode_reward_mean": 6271.2883281241075, "episode_len_mean": 3600.0, "episode_media": {}, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [6472.9208637880565, 6339.812419465837, 6334.258679034131, 6211.571156794661, 6418.300181429795, 5875.440605207955, 6117.037586622728, 6524.779609310018, 6229.074338156758, 6118.273628943209, 6419.584446941989, 6321.320624760528, 6077.574408109293, 6162.265795993462, 6284.736884948364, 5822.434483329361, 6148.113382034317, 6105.12899024897, 6478.019835129416, 6649.952851613771, 6196.126866374364, 6507.234394001286, 6420.098054004528, 6497.099697449449, 6273.645648477113, 6301.745981408095, 5883.384315134592, 6026.025764365394, 6436.971932561103, 6489.231440066342, 6260.451966543025, 5972.368183961365, 6298.574182194228, 6281.572690372666, 5989.062468186445, 6434.226580963533, 6327.710311238441, 6410.510491438744, 5867.305940846087, 6353.0345067335265, 6375.566268329367, 6233.027471620641, 6448.014165047721, 6288.086458965973, 6346.356372628611, 6451.23016893374], "episode_lengths": [3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5344836140907513, "mean_inference_ms": 0.2481581415481863, "mean_action_processing_ms": 0.058605603243132055, "mean_env_wait_ms": 0.9949654440698995, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003063678741455078, "StateBufferConnector_ms": 0.0018969826076341712, "ViewRequirementAgentConnector_ms": 0.04766039226366126}}, "episode_reward_max": 6649.952851613771, "episode_reward_min": 5822.434483329361, "episode_reward_mean": 6271.2883281241075, "episode_len_mean": 3600.0, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [6472.9208637880565, 6339.812419465837, 6334.258679034131, 6211.571156794661, 6418.300181429795, 5875.440605207955, 6117.037586622728, 6524.779609310018, 6229.074338156758, 6118.273628943209, 6419.584446941989, 6321.320624760528, 6077.574408109293, 6162.265795993462, 6284.736884948364, 5822.434483329361, 6148.113382034317, 6105.12899024897, 6478.019835129416, 6649.952851613771, 6196.126866374364, 6507.234394001286, 6420.098054004528, 6497.099697449449, 6273.645648477113, 6301.745981408095, 5883.384315134592, 6026.025764365394, 6436.971932561103, 6489.231440066342, 6260.451966543025, 5972.368183961365, 6298.574182194228, 6281.572690372666, 5989.062468186445, 6434.226580963533, 6327.710311238441, 6410.510491438744, 5867.305940846087, 6353.0345067335265, 6375.566268329367, 6233.027471620641, 6448.014165047721, 6288.086458965973, 6346.356372628611, 6451.23016893374], "episode_lengths": [3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5344836140907513, "mean_inference_ms": 0.2481581415481863, "mean_action_processing_ms": 0.058605603243132055, "mean_env_wait_ms": 0.9949654440698995, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003063678741455078, "StateBufferConnector_ms": 0.0018969826076341712, "ViewRequirementAgentConnector_ms": 0.04766039226366126}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 179880, "num_agent_steps_trained": 179880, "num_env_steps_sampled": 179880, "num_env_steps_trained": 179880, "num_env_steps_sampled_this_iter": 7200, "num_env_steps_trained_this_iter": 7200, "num_env_steps_sampled_throughput_per_sec": 449.3998257817944, "num_env_steps_trained_throughput_per_sec": 449.3998257817944, "timesteps_total": 179880, "num_steps_trained_this_iter": 7200, "agent_timesteps_total": 179880, "timers": {"training_iteration_time_ms": 6864.426, "sample_time_ms": 6800.08, "load_time_ms": 1.503, "load_throughput": 2394958.428, "learn_time_ms": 62.188, "learn_throughput": 57889.332, "synch_weights_time_ms": 0.603}, "counters": {"num_env_steps_sampled": 179880, "num_env_steps_trained": 179880, "num_agent_steps_sampled": 179880, "num_agent_steps_trained": 179880}, "done": false, "episodes_total": 165, "training_iteration": 43, "trial_id": "30366_00000", "date": "2023-07-24_23-23-13", "timestamp": 1690230193, "time_this_iter_s": 16.023298025131226, "time_total_s": 520.7812349796295, "pid": 49740, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 30, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[299400, 0.0005], [342600, 0.00025], [385800, 0.0001], [429000, 5e-05], [472200, 2.5e-05], [515400, 1e-05], [558600, 7.5e-06], [601800, 5e-06], [645000, 2.5e-06], [688200, 1e-06], [731400, 7.5e-07], [774600, 5e-07], [817800, 2.5e-07], [861000, 1e-07]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 3600, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x1590ec430>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 307.16842699050903, "iterations_since_restore": 23, "perf": {"cpu_util_percent": 37.86818181818182, "ram_util_percent": 80.12727272727273}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-07, "entropy_coeff": 0.09999999999999999, "policy_entropy": 67.9078540802002, "policy_loss": 11456.62750680106, "vf_loss": 989736.6081891741}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 2660.5, "diff_num_grad_updates_vs_sampler_policy": 2659.5}}, "num_env_steps_sampled": 187080, "num_env_steps_trained": 187080, "num_agent_steps_sampled": 187080, "num_agent_steps_trained": 187080}, "sampler_results": {"episode_reward_max": 6649.952851613771, "episode_reward_min": 5822.434483329361, "episode_reward_mean": 6278.88107936824, "episode_len_mean": 3600.0, "episode_media": {}, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [6472.9208637880565, 6339.812419465837, 6334.258679034131, 6211.571156794661, 6418.300181429795, 5875.440605207955, 6117.037586622728, 6524.779609310018, 6229.074338156758, 6118.273628943209, 6419.584446941989, 6321.320624760528, 6077.574408109293, 6162.265795993462, 6284.736884948364, 5822.434483329361, 6148.113382034317, 6105.12899024897, 6478.019835129416, 6649.952851613771, 6196.126866374364, 6507.234394001286, 6420.098054004528, 6497.099697449449, 6273.645648477113, 6301.745981408095, 5883.384315134592, 6026.025764365394, 6436.971932561103, 6489.231440066342, 6260.451966543025, 5972.368183961365, 6298.574182194228, 6281.572690372666, 5989.062468186445, 6434.226580963533, 6327.710311238441, 6410.510491438744, 5867.305940846087, 6353.0345067335265, 6375.566268329367, 6233.027471620641, 6448.014165047721, 6288.086458965973, 6346.356372628611, 6451.23016893374, 6521.694038416486, 6385.334677549981], "episode_lengths": [3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5345366623198139, "mean_inference_ms": 0.24827822757832627, "mean_action_processing_ms": 0.05861642407075516, "mean_env_wait_ms": 0.9942061952984617, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0030368566513061523, "StateBufferConnector_ms": 0.001899401346842448, "ViewRequirementAgentConnector_ms": 0.04762957493464152}}, "episode_reward_max": 6649.952851613771, "episode_reward_min": 5822.434483329361, "episode_reward_mean": 6278.88107936824, "episode_len_mean": 3600.0, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [6472.9208637880565, 6339.812419465837, 6334.258679034131, 6211.571156794661, 6418.300181429795, 5875.440605207955, 6117.037586622728, 6524.779609310018, 6229.074338156758, 6118.273628943209, 6419.584446941989, 6321.320624760528, 6077.574408109293, 6162.265795993462, 6284.736884948364, 5822.434483329361, 6148.113382034317, 6105.12899024897, 6478.019835129416, 6649.952851613771, 6196.126866374364, 6507.234394001286, 6420.098054004528, 6497.099697449449, 6273.645648477113, 6301.745981408095, 5883.384315134592, 6026.025764365394, 6436.971932561103, 6489.231440066342, 6260.451966543025, 5972.368183961365, 6298.574182194228, 6281.572690372666, 5989.062468186445, 6434.226580963533, 6327.710311238441, 6410.510491438744, 5867.305940846087, 6353.0345067335265, 6375.566268329367, 6233.027471620641, 6448.014165047721, 6288.086458965973, 6346.356372628611, 6451.23016893374, 6521.694038416486, 6385.334677549981], "episode_lengths": [3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5345366623198139, "mean_inference_ms": 0.24827822757832627, "mean_action_processing_ms": 0.05861642407075516, "mean_env_wait_ms": 0.9942061952984617, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0030368566513061523, "StateBufferConnector_ms": 0.001899401346842448, "ViewRequirementAgentConnector_ms": 0.04762957493464152}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 187080, "num_agent_steps_trained": 187080, "num_env_steps_sampled": 187080, "num_env_steps_trained": 187080, "num_env_steps_sampled_this_iter": 7200, "num_env_steps_trained_this_iter": 7200, "num_env_steps_sampled_throughput_per_sec": 546.7691541911313, "num_env_steps_trained_throughput_per_sec": 546.7691541911313, "timesteps_total": 187080, "num_steps_trained_this_iter": 7200, "agent_timesteps_total": 187080, "timers": {"training_iteration_time_ms": 6860.063, "sample_time_ms": 6795.783, "load_time_ms": 1.507, "load_throughput": 2388669.166, "learn_time_ms": 62.111, "learn_throughput": 57960.862, "synch_weights_time_ms": 0.609}, "counters": {"num_env_steps_sampled": 187080, "num_env_steps_trained": 187080, "num_agent_steps_sampled": 187080, "num_agent_steps_trained": 187080}, "done": false, "episodes_total": 167, "training_iteration": 44, "trial_id": "30366_00000", "date": "2023-07-24_23-23-26", "timestamp": 1690230206, "time_this_iter_s": 13.170248746871948, "time_total_s": 533.9514837265015, "pid": 49740, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 30, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[299400, 0.0005], [342600, 0.00025], [385800, 0.0001], [429000, 5e-05], [472200, 2.5e-05], [515400, 1e-05], [558600, 7.5e-06], [601800, 5e-06], [645000, 2.5e-06], [688200, 1e-06], [731400, 7.5e-07], [774600, 5e-07], [817800, 2.5e-07], [861000, 1e-07]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 3600, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x1590ec430>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 320.338675737381, "iterations_since_restore": 24, "perf": {"cpu_util_percent": 26.40526315789474, "ram_util_percent": 79.86842105263158}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-07, "entropy_coeff": 0.09999999999999999, "policy_entropy": 68.24454852512905, "policy_loss": 11924.377772739956, "vf_loss": 1000820.26171875}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 2772.5, "diff_num_grad_updates_vs_sampler_policy": 2771.5}}, "num_env_steps_sampled": 194280, "num_env_steps_trained": 194280, "num_agent_steps_sampled": 194280, "num_agent_steps_trained": 194280}, "sampler_results": {"episode_reward_max": 6649.952851613771, "episode_reward_min": 5822.434483329361, "episode_reward_mean": 6280.838125861981, "episode_len_mean": 3600.0, "episode_media": {}, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [6472.9208637880565, 6339.812419465837, 6334.258679034131, 6211.571156794661, 6418.300181429795, 5875.440605207955, 6117.037586622728, 6524.779609310018, 6229.074338156758, 6118.273628943209, 6419.584446941989, 6321.320624760528, 6077.574408109293, 6162.265795993462, 6284.736884948364, 5822.434483329361, 6148.113382034317, 6105.12899024897, 6478.019835129416, 6649.952851613771, 6196.126866374364, 6507.234394001286, 6420.098054004528, 6497.099697449449, 6273.645648477113, 6301.745981408095, 5883.384315134592, 6026.025764365394, 6436.971932561103, 6489.231440066342, 6260.451966543025, 5972.368183961365, 6298.574182194228, 6281.572690372666, 5989.062468186445, 6434.226580963533, 6327.710311238441, 6410.510491438744, 5867.305940846087, 6353.0345067335265, 6375.566268329367, 6233.027471620641, 6448.014165047721, 6288.086458965973, 6346.356372628611, 6451.23016893374, 6521.694038416486, 6385.334677549981, 6171.955278688882, 6483.65920473466], "episode_lengths": [3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5345836445604726, "mean_inference_ms": 0.2483825522560245, "mean_action_processing_ms": 0.058625531122166626, "mean_env_wait_ms": 0.9934630522169797, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002997875213623047, "StateBufferConnector_ms": 0.0018887519836425781, "ViewRequirementAgentConnector_ms": 0.047514915466308594}}, "episode_reward_max": 6649.952851613771, "episode_reward_min": 5822.434483329361, "episode_reward_mean": 6280.838125861981, "episode_len_mean": 3600.0, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [6472.9208637880565, 6339.812419465837, 6334.258679034131, 6211.571156794661, 6418.300181429795, 5875.440605207955, 6117.037586622728, 6524.779609310018, 6229.074338156758, 6118.273628943209, 6419.584446941989, 6321.320624760528, 6077.574408109293, 6162.265795993462, 6284.736884948364, 5822.434483329361, 6148.113382034317, 6105.12899024897, 6478.019835129416, 6649.952851613771, 6196.126866374364, 6507.234394001286, 6420.098054004528, 6497.099697449449, 6273.645648477113, 6301.745981408095, 5883.384315134592, 6026.025764365394, 6436.971932561103, 6489.231440066342, 6260.451966543025, 5972.368183961365, 6298.574182194228, 6281.572690372666, 5989.062468186445, 6434.226580963533, 6327.710311238441, 6410.510491438744, 5867.305940846087, 6353.0345067335265, 6375.566268329367, 6233.027471620641, 6448.014165047721, 6288.086458965973, 6346.356372628611, 6451.23016893374, 6521.694038416486, 6385.334677549981, 6171.955278688882, 6483.65920473466], "episode_lengths": [3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5345836445604726, "mean_inference_ms": 0.2483825522560245, "mean_action_processing_ms": 0.058625531122166626, "mean_env_wait_ms": 0.9934630522169797, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002997875213623047, "StateBufferConnector_ms": 0.0018887519836425781, "ViewRequirementAgentConnector_ms": 0.047514915466308594}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 194280, "num_agent_steps_trained": 194280, "num_env_steps_sampled": 194280, "num_env_steps_trained": 194280, "num_env_steps_sampled_this_iter": 7200, "num_env_steps_trained_this_iter": 7200, "num_env_steps_sampled_throughput_per_sec": 549.6119827868866, "num_env_steps_trained_throughput_per_sec": 549.6119827868866, "timesteps_total": 194280, "num_steps_trained_this_iter": 7200, "agent_timesteps_total": 194280, "timers": {"training_iteration_time_ms": 6850.711, "sample_time_ms": 6786.599, "load_time_ms": 1.521, "load_throughput": 2367285.589, "learn_time_ms": 61.927, "learn_throughput": 58132.664, "synch_weights_time_ms": 0.613}, "counters": {"num_env_steps_sampled": 194280, "num_env_steps_trained": 194280, "num_agent_steps_sampled": 194280, "num_agent_steps_trained": 194280}, "done": false, "episodes_total": 169, "training_iteration": 45, "trial_id": "30366_00000", "date": "2023-07-24_23-23-39", "timestamp": 1690230219, "time_this_iter_s": 13.102551937103271, "time_total_s": 547.0540356636047, "pid": 49740, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 30, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[299400, 0.0005], [342600, 0.00025], [385800, 0.0001], [429000, 5e-05], [472200, 2.5e-05], [515400, 1e-05], [558600, 7.5e-06], [601800, 5e-06], [645000, 2.5e-06], [688200, 1e-06], [731400, 7.5e-07], [774600, 5e-07], [817800, 2.5e-07], [861000, 1e-07]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 3600, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x1590ec430>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 333.44122767448425, "iterations_since_restore": 25, "perf": {"cpu_util_percent": 21.936842105263157, "ram_util_percent": 79.67368421052632}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-07, "entropy_coeff": 0.09999999999999999, "policy_entropy": 68.46931954792568, "policy_loss": 11377.519927978516, "vf_loss": 923391.2494419643}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 2884.5, "diff_num_grad_updates_vs_sampler_policy": 2883.5}}, "num_env_steps_sampled": 201480, "num_env_steps_trained": 201480, "num_agent_steps_sampled": 201480, "num_agent_steps_trained": 201480}, "sampler_results": {"episode_reward_max": 6649.952851613771, "episode_reward_min": 5822.434483329361, "episode_reward_mean": 6283.47946002553, "episode_len_mean": 3600.0, "episode_media": {}, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [6472.9208637880565, 6339.812419465837, 6334.258679034131, 6211.571156794661, 6418.300181429795, 5875.440605207955, 6117.037586622728, 6524.779609310018, 6229.074338156758, 6118.273628943209, 6419.584446941989, 6321.320624760528, 6077.574408109293, 6162.265795993462, 6284.736884948364, 5822.434483329361, 6148.113382034317, 6105.12899024897, 6478.019835129416, 6649.952851613771, 6196.126866374364, 6507.234394001286, 6420.098054004528, 6497.099697449449, 6273.645648477113, 6301.745981408095, 5883.384315134592, 6026.025764365394, 6436.971932561103, 6489.231440066342, 6260.451966543025, 5972.368183961365, 6298.574182194228, 6281.572690372666, 5989.062468186445, 6434.226580963533, 6327.710311238441, 6410.510491438744, 5867.305940846087, 6353.0345067335265, 6375.566268329367, 6233.027471620641, 6448.014165047721, 6288.086458965973, 6346.356372628611, 6451.23016893374, 6521.694038416486, 6385.334677549981, 6171.955278688882, 6483.65920473466, 6478.941618378691, 6220.08400984982], "episode_lengths": [3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5346249313296622, "mean_inference_ms": 0.24847580728310273, "mean_action_processing_ms": 0.058633843466926475, "mean_env_wait_ms": 0.9927444848269048, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0029738132770244893, "StateBufferConnector_ms": 0.0018853407639723558, "ViewRequirementAgentConnector_ms": 0.0474090759570782}}, "episode_reward_max": 6649.952851613771, "episode_reward_min": 5822.434483329361, "episode_reward_mean": 6283.47946002553, "episode_len_mean": 3600.0, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [6472.9208637880565, 6339.812419465837, 6334.258679034131, 6211.571156794661, 6418.300181429795, 5875.440605207955, 6117.037586622728, 6524.779609310018, 6229.074338156758, 6118.273628943209, 6419.584446941989, 6321.320624760528, 6077.574408109293, 6162.265795993462, 6284.736884948364, 5822.434483329361, 6148.113382034317, 6105.12899024897, 6478.019835129416, 6649.952851613771, 6196.126866374364, 6507.234394001286, 6420.098054004528, 6497.099697449449, 6273.645648477113, 6301.745981408095, 5883.384315134592, 6026.025764365394, 6436.971932561103, 6489.231440066342, 6260.451966543025, 5972.368183961365, 6298.574182194228, 6281.572690372666, 5989.062468186445, 6434.226580963533, 6327.710311238441, 6410.510491438744, 5867.305940846087, 6353.0345067335265, 6375.566268329367, 6233.027471620641, 6448.014165047721, 6288.086458965973, 6346.356372628611, 6451.23016893374, 6521.694038416486, 6385.334677549981, 6171.955278688882, 6483.65920473466, 6478.941618378691, 6220.08400984982], "episode_lengths": [3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5346249313296622, "mean_inference_ms": 0.24847580728310273, "mean_action_processing_ms": 0.058633843466926475, "mean_env_wait_ms": 0.9927444848269048, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0029738132770244893, "StateBufferConnector_ms": 0.0018853407639723558, "ViewRequirementAgentConnector_ms": 0.0474090759570782}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 201480, "num_agent_steps_trained": 201480, "num_env_steps_sampled": 201480, "num_env_steps_trained": 201480, "num_env_steps_sampled_this_iter": 7200, "num_env_steps_trained_this_iter": 7200, "num_env_steps_sampled_throughput_per_sec": 547.6395500754707, "num_env_steps_trained_throughput_per_sec": 547.6395500754707, "timesteps_total": 201480, "num_steps_trained_this_iter": 7200, "agent_timesteps_total": 201480, "timers": {"training_iteration_time_ms": 6859.064, "sample_time_ms": 6795.786, "load_time_ms": 1.484, "load_throughput": 2425076.192, "learn_time_ms": 61.119, "learn_throughput": 58901.365, "synch_weights_time_ms": 0.622}, "counters": {"num_env_steps_sampled": 201480, "num_env_steps_trained": 201480, "num_agent_steps_sampled": 201480, "num_agent_steps_trained": 201480}, "done": false, "episodes_total": 171, "training_iteration": 46, "trial_id": "30366_00000", "date": "2023-07-24_23-23-52", "timestamp": 1690230232, "time_this_iter_s": 13.14940094947815, "time_total_s": 560.2034366130829, "pid": 49740, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 30, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[299400, 0.0005], [342600, 0.00025], [385800, 0.0001], [429000, 5e-05], [472200, 2.5e-05], [515400, 1e-05], [558600, 7.5e-06], [601800, 5e-06], [645000, 2.5e-06], [688200, 1e-06], [731400, 7.5e-07], [774600, 5e-07], [817800, 2.5e-07], [861000, 1e-07]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 3600, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x1590ec430>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 346.5906286239624, "iterations_since_restore": 26, "perf": {"cpu_util_percent": 22.25, "ram_util_percent": 79.46666666666667}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-07, "entropy_coeff": 0.09999999999999999, "policy_entropy": 68.11734628677368, "policy_loss": 11581.14155796596, "vf_loss": 1011986.220703125}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 2996.5, "diff_num_grad_updates_vs_sampler_policy": 2995.5}}, "num_env_steps_sampled": 208680, "num_env_steps_trained": 208680, "num_agent_steps_sampled": 208680, "num_agent_steps_trained": 208680}, "sampler_results": {"episode_reward_max": 6649.952851613771, "episode_reward_min": 5822.434483329361, "episode_reward_mean": 6291.1596447156835, "episode_len_mean": 3600.0, "episode_media": {}, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [6472.9208637880565, 6339.812419465837, 6334.258679034131, 6211.571156794661, 6418.300181429795, 5875.440605207955, 6117.037586622728, 6524.779609310018, 6229.074338156758, 6118.273628943209, 6419.584446941989, 6321.320624760528, 6077.574408109293, 6162.265795993462, 6284.736884948364, 5822.434483329361, 6148.113382034317, 6105.12899024897, 6478.019835129416, 6649.952851613771, 6196.126866374364, 6507.234394001286, 6420.098054004528, 6497.099697449449, 6273.645648477113, 6301.745981408095, 5883.384315134592, 6026.025764365394, 6436.971932561103, 6489.231440066342, 6260.451966543025, 5972.368183961365, 6298.574182194228, 6281.572690372666, 5989.062468186445, 6434.226580963533, 6327.710311238441, 6410.510491438744, 5867.305940846087, 6353.0345067335265, 6375.566268329367, 6233.027471620641, 6448.014165047721, 6288.086458965973, 6346.356372628611, 6451.23016893374, 6521.694038416486, 6385.334677549981, 6171.955278688882, 6483.65920473466, 6478.941618378691, 6220.08400984982, 6480.008668075746, 6501.6802252436], "episode_lengths": [3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5346562689921673, "mean_inference_ms": 0.248554059600404, "mean_action_processing_ms": 0.058640631645817225, "mean_env_wait_ms": 0.992044342777802, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002945793999565972, "StateBufferConnector_ms": 0.0018812991954662182, "ViewRequirementAgentConnector_ms": 0.04728944213302047}}, "episode_reward_max": 6649.952851613771, "episode_reward_min": 5822.434483329361, "episode_reward_mean": 6291.1596447156835, "episode_len_mean": 3600.0, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [6472.9208637880565, 6339.812419465837, 6334.258679034131, 6211.571156794661, 6418.300181429795, 5875.440605207955, 6117.037586622728, 6524.779609310018, 6229.074338156758, 6118.273628943209, 6419.584446941989, 6321.320624760528, 6077.574408109293, 6162.265795993462, 6284.736884948364, 5822.434483329361, 6148.113382034317, 6105.12899024897, 6478.019835129416, 6649.952851613771, 6196.126866374364, 6507.234394001286, 6420.098054004528, 6497.099697449449, 6273.645648477113, 6301.745981408095, 5883.384315134592, 6026.025764365394, 6436.971932561103, 6489.231440066342, 6260.451966543025, 5972.368183961365, 6298.574182194228, 6281.572690372666, 5989.062468186445, 6434.226580963533, 6327.710311238441, 6410.510491438744, 5867.305940846087, 6353.0345067335265, 6375.566268329367, 6233.027471620641, 6448.014165047721, 6288.086458965973, 6346.356372628611, 6451.23016893374, 6521.694038416486, 6385.334677549981, 6171.955278688882, 6483.65920473466, 6478.941618378691, 6220.08400984982, 6480.008668075746, 6501.6802252436], "episode_lengths": [3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5346562689921673, "mean_inference_ms": 0.248554059600404, "mean_action_processing_ms": 0.058640631645817225, "mean_env_wait_ms": 0.992044342777802, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002945793999565972, "StateBufferConnector_ms": 0.0018812991954662182, "ViewRequirementAgentConnector_ms": 0.04728944213302047}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 208680, "num_agent_steps_trained": 208680, "num_env_steps_sampled": 208680, "num_env_steps_trained": 208680, "num_env_steps_sampled_this_iter": 7200, "num_env_steps_trained_this_iter": 7200, "num_env_steps_sampled_throughput_per_sec": 551.3737571993657, "num_env_steps_trained_throughput_per_sec": 551.3737571993657, "timesteps_total": 208680, "num_steps_trained_this_iter": 7200, "agent_timesteps_total": 208680, "timers": {"training_iteration_time_ms": 6849.528, "sample_time_ms": 6786.263, "load_time_ms": 1.522, "load_throughput": 2364542.328, "learn_time_ms": 61.075, "learn_throughput": 58943.856, "synch_weights_time_ms": 0.616}, "counters": {"num_env_steps_sampled": 208680, "num_env_steps_trained": 208680, "num_agent_steps_sampled": 208680, "num_agent_steps_trained": 208680}, "done": false, "episodes_total": 173, "training_iteration": 47, "trial_id": "30366_00000", "date": "2023-07-24_23-24-05", "timestamp": 1690230245, "time_this_iter_s": 13.060312032699585, "time_total_s": 573.2637486457825, "pid": 49740, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 30, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[299400, 0.0005], [342600, 0.00025], [385800, 0.0001], [429000, 5e-05], [472200, 2.5e-05], [515400, 1e-05], [558600, 7.5e-06], [601800, 5e-06], [645000, 2.5e-06], [688200, 1e-06], [731400, 7.5e-07], [774600, 5e-07], [817800, 2.5e-07], [861000, 1e-07]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 3600, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x1590ec430>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 359.650940656662, "iterations_since_restore": 27, "perf": {"cpu_util_percent": 24.95263157894737, "ram_util_percent": 79.23157894736842}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-07, "entropy_coeff": 0.09999999999999999, "policy_entropy": 68.23474754605975, "policy_loss": 12049.35777064732, "vf_loss": 1006615.7745535715}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 3108.5, "diff_num_grad_updates_vs_sampler_policy": 3107.5}}, "num_env_steps_sampled": 215880, "num_env_steps_trained": 215880, "num_agent_steps_sampled": 215880, "num_agent_steps_trained": 215880}, "sampler_results": {"episode_reward_max": 6649.952851613771, "episode_reward_min": 5822.434483329361, "episode_reward_mean": 6294.34977480678, "episode_len_mean": 3600.0, "episode_media": {}, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [6472.9208637880565, 6339.812419465837, 6334.258679034131, 6211.571156794661, 6418.300181429795, 5875.440605207955, 6117.037586622728, 6524.779609310018, 6229.074338156758, 6118.273628943209, 6419.584446941989, 6321.320624760528, 6077.574408109293, 6162.265795993462, 6284.736884948364, 5822.434483329361, 6148.113382034317, 6105.12899024897, 6478.019835129416, 6649.952851613771, 6196.126866374364, 6507.234394001286, 6420.098054004528, 6497.099697449449, 6273.645648477113, 6301.745981408095, 5883.384315134592, 6026.025764365394, 6436.971932561103, 6489.231440066342, 6260.451966543025, 5972.368183961365, 6298.574182194228, 6281.572690372666, 5989.062468186445, 6434.226580963533, 6327.710311238441, 6410.510491438744, 5867.305940846087, 6353.0345067335265, 6375.566268329367, 6233.027471620641, 6448.014165047721, 6288.086458965973, 6346.356372628611, 6451.23016893374, 6521.694038416486, 6385.334677549981, 6171.955278688882, 6483.65920473466, 6478.941618378691, 6220.08400984982, 6480.008668075746, 6501.6802252436, 6298.887719184532, 6462.078855348306], "episode_lengths": [3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5346835703551365, "mean_inference_ms": 0.2486245524354783, "mean_action_processing_ms": 0.05864693615101791, "mean_env_wait_ms": 0.9913818095690436, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0029189246041434152, "StateBufferConnector_ms": 0.0018724373408726283, "ViewRequirementAgentConnector_ms": 0.047210284641810825}}, "episode_reward_max": 6649.952851613771, "episode_reward_min": 5822.434483329361, "episode_reward_mean": 6294.34977480678, "episode_len_mean": 3600.0, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [6472.9208637880565, 6339.812419465837, 6334.258679034131, 6211.571156794661, 6418.300181429795, 5875.440605207955, 6117.037586622728, 6524.779609310018, 6229.074338156758, 6118.273628943209, 6419.584446941989, 6321.320624760528, 6077.574408109293, 6162.265795993462, 6284.736884948364, 5822.434483329361, 6148.113382034317, 6105.12899024897, 6478.019835129416, 6649.952851613771, 6196.126866374364, 6507.234394001286, 6420.098054004528, 6497.099697449449, 6273.645648477113, 6301.745981408095, 5883.384315134592, 6026.025764365394, 6436.971932561103, 6489.231440066342, 6260.451966543025, 5972.368183961365, 6298.574182194228, 6281.572690372666, 5989.062468186445, 6434.226580963533, 6327.710311238441, 6410.510491438744, 5867.305940846087, 6353.0345067335265, 6375.566268329367, 6233.027471620641, 6448.014165047721, 6288.086458965973, 6346.356372628611, 6451.23016893374, 6521.694038416486, 6385.334677549981, 6171.955278688882, 6483.65920473466, 6478.941618378691, 6220.08400984982, 6480.008668075746, 6501.6802252436, 6298.887719184532, 6462.078855348306], "episode_lengths": [3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5346835703551365, "mean_inference_ms": 0.2486245524354783, "mean_action_processing_ms": 0.05864693615101791, "mean_env_wait_ms": 0.9913818095690436, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0029189246041434152, "StateBufferConnector_ms": 0.0018724373408726283, "ViewRequirementAgentConnector_ms": 0.047210284641810825}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 215880, "num_agent_steps_trained": 215880, "num_env_steps_sampled": 215880, "num_env_steps_trained": 215880, "num_env_steps_sampled_this_iter": 7200, "num_env_steps_trained_this_iter": 7200, "num_env_steps_sampled_throughput_per_sec": 544.2678752701718, "num_env_steps_trained_throughput_per_sec": 544.2678752701718, "timesteps_total": 215880, "num_steps_trained_this_iter": 7200, "agent_timesteps_total": 215880, "timers": {"training_iteration_time_ms": 6570.27, "sample_time_ms": 6507.002, "load_time_ms": 1.127, "load_throughput": 3194172.957, "learn_time_ms": 61.492, "learn_throughput": 58543.779, "synch_weights_time_ms": 0.603}, "counters": {"num_env_steps_sampled": 215880, "num_env_steps_trained": 215880, "num_agent_steps_sampled": 215880, "num_agent_steps_trained": 215880}, "done": false, "episodes_total": 175, "training_iteration": 48, "trial_id": "30366_00000", "date": "2023-07-24_23-24-18", "timestamp": 1690230258, "time_this_iter_s": 13.230906963348389, "time_total_s": 586.4946556091309, "pid": 49740, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 30, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[299400, 0.0005], [342600, 0.00025], [385800, 0.0001], [429000, 5e-05], [472200, 2.5e-05], [515400, 1e-05], [558600, 7.5e-06], [601800, 5e-06], [645000, 2.5e-06], [688200, 1e-06], [731400, 7.5e-07], [774600, 5e-07], [817800, 2.5e-07], [861000, 1e-07]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 3600, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x1590ec430>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 372.8818476200104, "iterations_since_restore": 28, "perf": {"cpu_util_percent": 21.01111111111111, "ram_util_percent": 79.18333333333334}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-07, "entropy_coeff": 0.09999999999999999, "policy_entropy": 67.80045509338379, "policy_loss": 12044.012276785714, "vf_loss": 1007153.9266183035}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 3220.5, "diff_num_grad_updates_vs_sampler_policy": 3219.5}}, "num_env_steps_sampled": 223080, "num_env_steps_trained": 223080, "num_agent_steps_sampled": 223080, "num_agent_steps_trained": 223080}, "sampler_results": {"episode_reward_max": 6649.952851613771, "episode_reward_min": 5822.434483329361, "episode_reward_mean": 6298.477058460566, "episode_len_mean": 3600.0, "episode_media": {}, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [6472.9208637880565, 6339.812419465837, 6334.258679034131, 6211.571156794661, 6418.300181429795, 5875.440605207955, 6117.037586622728, 6524.779609310018, 6229.074338156758, 6118.273628943209, 6419.584446941989, 6321.320624760528, 6077.574408109293, 6162.265795993462, 6284.736884948364, 5822.434483329361, 6148.113382034317, 6105.12899024897, 6478.019835129416, 6649.952851613771, 6196.126866374364, 6507.234394001286, 6420.098054004528, 6497.099697449449, 6273.645648477113, 6301.745981408095, 5883.384315134592, 6026.025764365394, 6436.971932561103, 6489.231440066342, 6260.451966543025, 5972.368183961365, 6298.574182194228, 6281.572690372666, 5989.062468186445, 6434.226580963533, 6327.710311238441, 6410.510491438744, 5867.305940846087, 6353.0345067335265, 6375.566268329367, 6233.027471620641, 6448.014165047721, 6288.086458965973, 6346.356372628611, 6451.23016893374, 6521.694038416486, 6385.334677549981, 6171.955278688882, 6483.65920473466, 6478.941618378691, 6220.08400984982, 6480.008668075746, 6501.6802252436, 6298.887719184532, 6462.078855348306, 6313.558858238497, 6514.523143294627], "episode_lengths": [3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5347055528171525, "mean_inference_ms": 0.24868221085441683, "mean_action_processing_ms": 0.058651970161862826, "mean_env_wait_ms": 0.9907395100359334, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0029037738668507545, "StateBufferConnector_ms": 0.0018699415798844963, "ViewRequirementAgentConnector_ms": 0.047189613868450296}}, "episode_reward_max": 6649.952851613771, "episode_reward_min": 5822.434483329361, "episode_reward_mean": 6298.477058460566, "episode_len_mean": 3600.0, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [6472.9208637880565, 6339.812419465837, 6334.258679034131, 6211.571156794661, 6418.300181429795, 5875.440605207955, 6117.037586622728, 6524.779609310018, 6229.074338156758, 6118.273628943209, 6419.584446941989, 6321.320624760528, 6077.574408109293, 6162.265795993462, 6284.736884948364, 5822.434483329361, 6148.113382034317, 6105.12899024897, 6478.019835129416, 6649.952851613771, 6196.126866374364, 6507.234394001286, 6420.098054004528, 6497.099697449449, 6273.645648477113, 6301.745981408095, 5883.384315134592, 6026.025764365394, 6436.971932561103, 6489.231440066342, 6260.451966543025, 5972.368183961365, 6298.574182194228, 6281.572690372666, 5989.062468186445, 6434.226580963533, 6327.710311238441, 6410.510491438744, 5867.305940846087, 6353.0345067335265, 6375.566268329367, 6233.027471620641, 6448.014165047721, 6288.086458965973, 6346.356372628611, 6451.23016893374, 6521.694038416486, 6385.334677549981, 6171.955278688882, 6483.65920473466, 6478.941618378691, 6220.08400984982, 6480.008668075746, 6501.6802252436, 6298.887719184532, 6462.078855348306, 6313.558858238497, 6514.523143294627], "episode_lengths": [3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5347055528171525, "mean_inference_ms": 0.24868221085441683, "mean_action_processing_ms": 0.058651970161862826, "mean_env_wait_ms": 0.9907395100359334, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0029037738668507545, "StateBufferConnector_ms": 0.0018699415798844963, "ViewRequirementAgentConnector_ms": 0.047189613868450296}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 223080, "num_agent_steps_trained": 223080, "num_env_steps_sampled": 223080, "num_env_steps_trained": 223080, "num_env_steps_sampled_this_iter": 7200, "num_env_steps_trained_this_iter": 7200, "num_env_steps_sampled_throughput_per_sec": 550.3715907188277, "num_env_steps_trained_throughput_per_sec": 550.3715907188277, "timesteps_total": 223080, "num_steps_trained_this_iter": 7200, "agent_timesteps_total": 223080, "timers": {"training_iteration_time_ms": 6561.651, "sample_time_ms": 6498.639, "load_time_ms": 1.116, "load_throughput": 3226249.818, "learn_time_ms": 61.249, "learn_throughput": 58776.75, "synch_weights_time_ms": 0.602}, "counters": {"num_env_steps_sampled": 223080, "num_env_steps_trained": 223080, "num_agent_steps_sampled": 223080, "num_agent_steps_trained": 223080}, "done": false, "episodes_total": 177, "training_iteration": 49, "trial_id": "30366_00000", "date": "2023-07-24_23-24-31", "timestamp": 1690230271, "time_this_iter_s": 13.084019899368286, "time_total_s": 599.5786755084991, "pid": 49740, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 30, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[299400, 0.0005], [342600, 0.00025], [385800, 0.0001], [429000, 5e-05], [472200, 2.5e-05], [515400, 1e-05], [558600, 7.5e-06], [601800, 5e-06], [645000, 2.5e-06], [688200, 1e-06], [731400, 7.5e-07], [774600, 5e-07], [817800, 2.5e-07], [861000, 1e-07]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 3600, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x1590ec430>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 385.96586751937866, "iterations_since_restore": 29, "perf": {"cpu_util_percent": 21.53157894736842, "ram_util_percent": 78.9736842105263}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-07, "entropy_coeff": 0.09999999999999999, "policy_entropy": 67.71429443359375, "policy_loss": 12026.47210257394, "vf_loss": 1039596.9408482143}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 3332.5, "diff_num_grad_updates_vs_sampler_policy": 3331.5}}, "num_env_steps_sampled": 230280, "num_env_steps_trained": 230280, "num_agent_steps_sampled": 230280, "num_agent_steps_trained": 230280}, "sampler_results": {"episode_reward_max": 6649.952851613771, "episode_reward_min": 5822.434483329361, "episode_reward_mean": 6303.912096658521, "episode_len_mean": 3600.0, "episode_media": {}, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [6472.9208637880565, 6339.812419465837, 6334.258679034131, 6211.571156794661, 6418.300181429795, 5875.440605207955, 6117.037586622728, 6524.779609310018, 6229.074338156758, 6118.273628943209, 6419.584446941989, 6321.320624760528, 6077.574408109293, 6162.265795993462, 6284.736884948364, 5822.434483329361, 6148.113382034317, 6105.12899024897, 6478.019835129416, 6649.952851613771, 6196.126866374364, 6507.234394001286, 6420.098054004528, 6497.099697449449, 6273.645648477113, 6301.745981408095, 5883.384315134592, 6026.025764365394, 6436.971932561103, 6489.231440066342, 6260.451966543025, 5972.368183961365, 6298.574182194228, 6281.572690372666, 5989.062468186445, 6434.226580963533, 6327.710311238441, 6410.510491438744, 5867.305940846087, 6353.0345067335265, 6375.566268329367, 6233.027471620641, 6448.014165047721, 6288.086458965973, 6346.356372628611, 6451.23016893374, 6521.694038416486, 6385.334677549981, 6171.955278688882, 6483.65920473466, 6478.941618378691, 6220.08400984982, 6480.008668075746, 6501.6802252436, 6298.887719184532, 6462.078855348306, 6313.558858238497, 6514.523143294627, 6322.551405610618, 6600.505003187828], "episode_lengths": [3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5347274313092752, "mean_inference_ms": 0.2487303479659778, "mean_action_processing_ms": 0.05865594037558503, "mean_env_wait_ms": 0.990105974556455, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002886056900024414, "StateBufferConnector_ms": 0.0018688042958577473, "ViewRequirementAgentConnector_ms": 0.0471182664235433}}, "episode_reward_max": 6649.952851613771, "episode_reward_min": 5822.434483329361, "episode_reward_mean": 6303.912096658521, "episode_len_mean": 3600.0, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [6472.9208637880565, 6339.812419465837, 6334.258679034131, 6211.571156794661, 6418.300181429795, 5875.440605207955, 6117.037586622728, 6524.779609310018, 6229.074338156758, 6118.273628943209, 6419.584446941989, 6321.320624760528, 6077.574408109293, 6162.265795993462, 6284.736884948364, 5822.434483329361, 6148.113382034317, 6105.12899024897, 6478.019835129416, 6649.952851613771, 6196.126866374364, 6507.234394001286, 6420.098054004528, 6497.099697449449, 6273.645648477113, 6301.745981408095, 5883.384315134592, 6026.025764365394, 6436.971932561103, 6489.231440066342, 6260.451966543025, 5972.368183961365, 6298.574182194228, 6281.572690372666, 5989.062468186445, 6434.226580963533, 6327.710311238441, 6410.510491438744, 5867.305940846087, 6353.0345067335265, 6375.566268329367, 6233.027471620641, 6448.014165047721, 6288.086458965973, 6346.356372628611, 6451.23016893374, 6521.694038416486, 6385.334677549981, 6171.955278688882, 6483.65920473466, 6478.941618378691, 6220.08400984982, 6480.008668075746, 6501.6802252436, 6298.887719184532, 6462.078855348306, 6313.558858238497, 6514.523143294627, 6322.551405610618, 6600.505003187828], "episode_lengths": [3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5347274313092752, "mean_inference_ms": 0.2487303479659778, "mean_action_processing_ms": 0.05865594037558503, "mean_env_wait_ms": 0.990105974556455, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002886056900024414, "StateBufferConnector_ms": 0.0018688042958577473, "ViewRequirementAgentConnector_ms": 0.0471182664235433}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 230280, "num_agent_steps_trained": 230280, "num_env_steps_sampled": 230280, "num_env_steps_trained": 230280, "num_env_steps_sampled_this_iter": 7200, "num_env_steps_trained_this_iter": 7200, "num_env_steps_sampled_throughput_per_sec": 551.6987601982054, "num_env_steps_trained_throughput_per_sec": 551.6987601982054, "timesteps_total": 230280, "num_steps_trained_this_iter": 7200, "agent_timesteps_total": 230280, "timers": {"training_iteration_time_ms": 6556.696, "sample_time_ms": 6493.579, "load_time_ms": 1.072, "load_throughput": 3357830.991, "learn_time_ms": 61.399, "learn_throughput": 58632.802, "synch_weights_time_ms": 0.6}, "counters": {"num_env_steps_sampled": 230280, "num_env_steps_trained": 230280, "num_agent_steps_sampled": 230280, "num_agent_steps_trained": 230280}, "done": false, "episodes_total": 179, "training_iteration": 50, "trial_id": "30366_00000", "date": "2023-07-24_23-24-45", "timestamp": 1690230285, "time_this_iter_s": 13.052637338638306, "time_total_s": 612.6313128471375, "pid": 49740, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 30, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[299400, 0.0005], [342600, 0.00025], [385800, 0.0001], [429000, 5e-05], [472200, 2.5e-05], [515400, 1e-05], [558600, 7.5e-06], [601800, 5e-06], [645000, 2.5e-06], [688200, 1e-06], [731400, 7.5e-07], [774600, 5e-07], [817800, 2.5e-07], [861000, 1e-07]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 3600, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x1590ec430>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 399.01850485801697, "iterations_since_restore": 30, "perf": {"cpu_util_percent": 21.733333333333334, "ram_util_percent": 78.67222222222222}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-07, "entropy_coeff": 0.09999999999999999, "policy_entropy": 67.56531688145229, "policy_loss": 11741.048366001674, "vf_loss": 937713.458984375}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 3444.5, "diff_num_grad_updates_vs_sampler_policy": 3443.5}}, "num_env_steps_sampled": 237480, "num_env_steps_trained": 237480, "num_agent_steps_sampled": 237480, "num_agent_steps_trained": 237480}, "sampler_results": {"episode_reward_max": 6649.952851613771, "episode_reward_min": 5822.434483329361, "episode_reward_mean": 6304.183931681295, "episode_len_mean": 3600.0, "episode_media": {}, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [6472.9208637880565, 6339.812419465837, 6334.258679034131, 6211.571156794661, 6418.300181429795, 5875.440605207955, 6117.037586622728, 6524.779609310018, 6229.074338156758, 6118.273628943209, 6419.584446941989, 6321.320624760528, 6077.574408109293, 6162.265795993462, 6284.736884948364, 5822.434483329361, 6148.113382034317, 6105.12899024897, 6478.019835129416, 6649.952851613771, 6196.126866374364, 6507.234394001286, 6420.098054004528, 6497.099697449449, 6273.645648477113, 6301.745981408095, 5883.384315134592, 6026.025764365394, 6436.971932561103, 6489.231440066342, 6260.451966543025, 5972.368183961365, 6298.574182194228, 6281.572690372666, 5989.062468186445, 6434.226580963533, 6327.710311238441, 6410.510491438744, 5867.305940846087, 6353.0345067335265, 6375.566268329367, 6233.027471620641, 6448.014165047721, 6288.086458965973, 6346.356372628611, 6451.23016893374, 6521.694038416486, 6385.334677549981, 6171.955278688882, 6483.65920473466, 6478.941618378691, 6220.08400984982, 6480.008668075746, 6501.6802252436, 6298.887719184532, 6462.078855348306, 6313.558858238497, 6514.523143294627, 6322.551405610618, 6600.505003187828, 6360.966009872357, 6263.711954856654], "episode_lengths": [3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5347516718772143, "mean_inference_ms": 0.2487754957144661, "mean_action_processing_ms": 0.058659735246177874, "mean_env_wait_ms": 0.9894964396416318, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002875635700841104, "StateBufferConnector_ms": 0.001865048562326739, "ViewRequirementAgentConnector_ms": 0.0471199712445659}}, "episode_reward_max": 6649.952851613771, "episode_reward_min": 5822.434483329361, "episode_reward_mean": 6304.183931681295, "episode_len_mean": 3600.0, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [6472.9208637880565, 6339.812419465837, 6334.258679034131, 6211.571156794661, 6418.300181429795, 5875.440605207955, 6117.037586622728, 6524.779609310018, 6229.074338156758, 6118.273628943209, 6419.584446941989, 6321.320624760528, 6077.574408109293, 6162.265795993462, 6284.736884948364, 5822.434483329361, 6148.113382034317, 6105.12899024897, 6478.019835129416, 6649.952851613771, 6196.126866374364, 6507.234394001286, 6420.098054004528, 6497.099697449449, 6273.645648477113, 6301.745981408095, 5883.384315134592, 6026.025764365394, 6436.971932561103, 6489.231440066342, 6260.451966543025, 5972.368183961365, 6298.574182194228, 6281.572690372666, 5989.062468186445, 6434.226580963533, 6327.710311238441, 6410.510491438744, 5867.305940846087, 6353.0345067335265, 6375.566268329367, 6233.027471620641, 6448.014165047721, 6288.086458965973, 6346.356372628611, 6451.23016893374, 6521.694038416486, 6385.334677549981, 6171.955278688882, 6483.65920473466, 6478.941618378691, 6220.08400984982, 6480.008668075746, 6501.6802252436, 6298.887719184532, 6462.078855348306, 6313.558858238497, 6514.523143294627, 6322.551405610618, 6600.505003187828, 6360.966009872357, 6263.711954856654], "episode_lengths": [3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5347516718772143, "mean_inference_ms": 0.2487754957144661, "mean_action_processing_ms": 0.058659735246177874, "mean_env_wait_ms": 0.9894964396416318, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002875635700841104, "StateBufferConnector_ms": 0.001865048562326739, "ViewRequirementAgentConnector_ms": 0.0471199712445659}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 237480, "num_agent_steps_trained": 237480, "num_env_steps_sampled": 237480, "num_env_steps_trained": 237480, "num_env_steps_sampled_this_iter": 7200, "num_env_steps_trained_this_iter": 7200, "num_env_steps_sampled_throughput_per_sec": 545.1911984563135, "num_env_steps_trained_throughput_per_sec": 545.1911984563135, "timesteps_total": 237480, "num_steps_trained_this_iter": 7200, "agent_timesteps_total": 237480, "timers": {"training_iteration_time_ms": 6562.6, "sample_time_ms": 6499.336, "load_time_ms": 1.066, "load_throughput": 3377207.426, "learn_time_ms": 61.564, "learn_throughput": 58475.762, "synch_weights_time_ms": 0.588}, "counters": {"num_env_steps_sampled": 237480, "num_env_steps_trained": 237480, "num_agent_steps_sampled": 237480, "num_agent_steps_trained": 237480}, "done": false, "episodes_total": 181, "training_iteration": 51, "trial_id": "30366_00000", "date": "2023-07-24_23-24-58", "timestamp": 1690230298, "time_this_iter_s": 13.208579063415527, "time_total_s": 625.839891910553, "pid": 49740, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 30, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[299400, 0.0005], [342600, 0.00025], [385800, 0.0001], [429000, 5e-05], [472200, 2.5e-05], [515400, 1e-05], [558600, 7.5e-06], [601800, 5e-06], [645000, 2.5e-06], [688200, 1e-06], [731400, 7.5e-07], [774600, 5e-07], [817800, 2.5e-07], [861000, 1e-07]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 3600, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x1590ec430>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 412.2270839214325, "iterations_since_restore": 31, "perf": {"cpu_util_percent": 24.099999999999998, "ram_util_percent": 78.89473684210527}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-07, "entropy_coeff": 0.09999999999999999, "policy_entropy": 68.26018558229718, "policy_loss": 11817.404994419643, "vf_loss": 1000273.1467633928}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 3556.5, "diff_num_grad_updates_vs_sampler_policy": 3555.5}}, "num_env_steps_sampled": 244680, "num_env_steps_trained": 244680, "num_agent_steps_sampled": 244680, "num_agent_steps_trained": 244680}, "sampler_results": {"episode_reward_max": 6649.952851613771, "episode_reward_min": 5822.434483329361, "episode_reward_mean": 6306.592828265392, "episode_len_mean": 3600.0, "episode_media": {}, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [6472.9208637880565, 6339.812419465837, 6334.258679034131, 6211.571156794661, 6418.300181429795, 5875.440605207955, 6117.037586622728, 6524.779609310018, 6229.074338156758, 6118.273628943209, 6419.584446941989, 6321.320624760528, 6077.574408109293, 6162.265795993462, 6284.736884948364, 5822.434483329361, 6148.113382034317, 6105.12899024897, 6478.019835129416, 6649.952851613771, 6196.126866374364, 6507.234394001286, 6420.098054004528, 6497.099697449449, 6273.645648477113, 6301.745981408095, 5883.384315134592, 6026.025764365394, 6436.971932561103, 6489.231440066342, 6260.451966543025, 5972.368183961365, 6298.574182194228, 6281.572690372666, 5989.062468186445, 6434.226580963533, 6327.710311238441, 6410.510491438744, 5867.305940846087, 6353.0345067335265, 6375.566268329367, 6233.027471620641, 6448.014165047721, 6288.086458965973, 6346.356372628611, 6451.23016893374, 6521.694038416486, 6385.334677549981, 6171.955278688882, 6483.65920473466, 6478.941618378691, 6220.08400984982, 6480.008668075746, 6501.6802252436, 6298.887719184532, 6462.078855348306, 6313.558858238497, 6514.523143294627, 6322.551405610618, 6600.505003187828, 6360.966009872357, 6263.711954856654, 6291.926225828147, 6470.611018916694], "episode_lengths": [3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5347743230668642, "mean_inference_ms": 0.24881493024658588, "mean_action_processing_ms": 0.05866302881395649, "mean_env_wait_ms": 0.9889029330095617, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002855435013771057, "StateBufferConnector_ms": 0.0018600374460220337, "ViewRequirementAgentConnector_ms": 0.047064945101737976}}, "episode_reward_max": 6649.952851613771, "episode_reward_min": 5822.434483329361, "episode_reward_mean": 6306.592828265392, "episode_len_mean": 3600.0, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [6472.9208637880565, 6339.812419465837, 6334.258679034131, 6211.571156794661, 6418.300181429795, 5875.440605207955, 6117.037586622728, 6524.779609310018, 6229.074338156758, 6118.273628943209, 6419.584446941989, 6321.320624760528, 6077.574408109293, 6162.265795993462, 6284.736884948364, 5822.434483329361, 6148.113382034317, 6105.12899024897, 6478.019835129416, 6649.952851613771, 6196.126866374364, 6507.234394001286, 6420.098054004528, 6497.099697449449, 6273.645648477113, 6301.745981408095, 5883.384315134592, 6026.025764365394, 6436.971932561103, 6489.231440066342, 6260.451966543025, 5972.368183961365, 6298.574182194228, 6281.572690372666, 5989.062468186445, 6434.226580963533, 6327.710311238441, 6410.510491438744, 5867.305940846087, 6353.0345067335265, 6375.566268329367, 6233.027471620641, 6448.014165047721, 6288.086458965973, 6346.356372628611, 6451.23016893374, 6521.694038416486, 6385.334677549981, 6171.955278688882, 6483.65920473466, 6478.941618378691, 6220.08400984982, 6480.008668075746, 6501.6802252436, 6298.887719184532, 6462.078855348306, 6313.558858238497, 6514.523143294627, 6322.551405610618, 6600.505003187828, 6360.966009872357, 6263.711954856654, 6291.926225828147, 6470.611018916694], "episode_lengths": [3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5347743230668642, "mean_inference_ms": 0.24881493024658588, "mean_action_processing_ms": 0.05866302881395649, "mean_env_wait_ms": 0.9889029330095617, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002855435013771057, "StateBufferConnector_ms": 0.0018600374460220337, "ViewRequirementAgentConnector_ms": 0.047064945101737976}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 244680, "num_agent_steps_trained": 244680, "num_env_steps_sampled": 244680, "num_env_steps_trained": 244680, "num_env_steps_sampled_this_iter": 7200, "num_env_steps_trained_this_iter": 7200, "num_env_steps_sampled_throughput_per_sec": 549.4053134184825, "num_env_steps_trained_throughput_per_sec": 549.4053134184825, "timesteps_total": 244680, "num_steps_trained_this_iter": 7200, "agent_timesteps_total": 244680, "timers": {"training_iteration_time_ms": 6567.279, "sample_time_ms": 6504.218, "load_time_ms": 1.041, "load_throughput": 3458744.365, "learn_time_ms": 61.383, "learn_throughput": 58648.447, "synch_weights_time_ms": 0.591}, "counters": {"num_env_steps_sampled": 244680, "num_env_steps_trained": 244680, "num_agent_steps_sampled": 244680, "num_agent_steps_trained": 244680}, "done": false, "episodes_total": 183, "training_iteration": 52, "trial_id": "30366_00000", "date": "2023-07-24_23-25-11", "timestamp": 1690230311, "time_this_iter_s": 13.107136964797974, "time_total_s": 638.947028875351, "pid": 49740, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 30, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[299400, 0.0005], [342600, 0.00025], [385800, 0.0001], [429000, 5e-05], [472200, 2.5e-05], [515400, 1e-05], [558600, 7.5e-06], [601800, 5e-06], [645000, 2.5e-06], [688200, 1e-06], [731400, 7.5e-07], [774600, 5e-07], [817800, 2.5e-07], [861000, 1e-07]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 3600, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x1590ec430>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 425.33422088623047, "iterations_since_restore": 32, "perf": {"cpu_util_percent": 21.826315789473686, "ram_util_percent": 78.89999999999999}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-07, "entropy_coeff": 0.09999999999999999, "policy_entropy": 67.8856532233102, "policy_loss": 11433.880405970982, "vf_loss": 950227.0728236607}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 3668.5, "diff_num_grad_updates_vs_sampler_policy": 3667.5}}, "num_env_steps_sampled": 251880, "num_env_steps_trained": 251880, "num_agent_steps_sampled": 251880, "num_agent_steps_trained": 251880}, "sampler_results": {"episode_reward_max": 6649.952851613771, "episode_reward_min": 5822.434483329361, "episode_reward_mean": 6302.4433715308005, "episode_len_mean": 3600.0, "episode_media": {}, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [6472.9208637880565, 6339.812419465837, 6334.258679034131, 6211.571156794661, 6418.300181429795, 5875.440605207955, 6117.037586622728, 6524.779609310018, 6229.074338156758, 6118.273628943209, 6419.584446941989, 6321.320624760528, 6077.574408109293, 6162.265795993462, 6284.736884948364, 5822.434483329361, 6148.113382034317, 6105.12899024897, 6478.019835129416, 6649.952851613771, 6196.126866374364, 6507.234394001286, 6420.098054004528, 6497.099697449449, 6273.645648477113, 6301.745981408095, 5883.384315134592, 6026.025764365394, 6436.971932561103, 6489.231440066342, 6260.451966543025, 5972.368183961365, 6298.574182194228, 6281.572690372666, 5989.062468186445, 6434.226580963533, 6327.710311238441, 6410.510491438744, 5867.305940846087, 6353.0345067335265, 6375.566268329367, 6233.027471620641, 6448.014165047721, 6288.086458965973, 6346.356372628611, 6451.23016893374, 6521.694038416486, 6385.334677549981, 6171.955278688882, 6483.65920473466, 6478.941618378691, 6220.08400984982, 6480.008668075746, 6501.6802252436, 6298.887719184532, 6462.078855348306, 6313.558858238497, 6514.523143294627, 6322.551405610618, 6600.505003187828, 6360.966009872357, 6263.711954856654, 6291.926225828147, 6470.611018916694, 6027.525901125601, 6311.795610922072], "episode_lengths": [3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5347969371852686, "mean_inference_ms": 0.24884854064694936, "mean_action_processing_ms": 0.05866559561582584, "mean_env_wait_ms": 0.988327823540148, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002834652409409032, "StateBufferConnector_ms": 0.0018567749948212595, "ViewRequirementAgentConnector_ms": 0.04696484768029415}}, "episode_reward_max": 6649.952851613771, "episode_reward_min": 5822.434483329361, "episode_reward_mean": 6302.4433715308005, "episode_len_mean": 3600.0, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [6472.9208637880565, 6339.812419465837, 6334.258679034131, 6211.571156794661, 6418.300181429795, 5875.440605207955, 6117.037586622728, 6524.779609310018, 6229.074338156758, 6118.273628943209, 6419.584446941989, 6321.320624760528, 6077.574408109293, 6162.265795993462, 6284.736884948364, 5822.434483329361, 6148.113382034317, 6105.12899024897, 6478.019835129416, 6649.952851613771, 6196.126866374364, 6507.234394001286, 6420.098054004528, 6497.099697449449, 6273.645648477113, 6301.745981408095, 5883.384315134592, 6026.025764365394, 6436.971932561103, 6489.231440066342, 6260.451966543025, 5972.368183961365, 6298.574182194228, 6281.572690372666, 5989.062468186445, 6434.226580963533, 6327.710311238441, 6410.510491438744, 5867.305940846087, 6353.0345067335265, 6375.566268329367, 6233.027471620641, 6448.014165047721, 6288.086458965973, 6346.356372628611, 6451.23016893374, 6521.694038416486, 6385.334677549981, 6171.955278688882, 6483.65920473466, 6478.941618378691, 6220.08400984982, 6480.008668075746, 6501.6802252436, 6298.887719184532, 6462.078855348306, 6313.558858238497, 6514.523143294627, 6322.551405610618, 6600.505003187828, 6360.966009872357, 6263.711954856654, 6291.926225828147, 6470.611018916694, 6027.525901125601, 6311.795610922072], "episode_lengths": [3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5347969371852686, "mean_inference_ms": 0.24884854064694936, "mean_action_processing_ms": 0.05866559561582584, "mean_env_wait_ms": 0.988327823540148, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002834652409409032, "StateBufferConnector_ms": 0.0018567749948212595, "ViewRequirementAgentConnector_ms": 0.04696484768029415}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 251880, "num_agent_steps_trained": 251880, "num_env_steps_sampled": 251880, "num_env_steps_trained": 251880, "num_env_steps_sampled_this_iter": 7200, "num_env_steps_trained_this_iter": 7200, "num_env_steps_sampled_throughput_per_sec": 548.5280945426729, "num_env_steps_trained_throughput_per_sec": 548.5280945426729, "timesteps_total": 251880, "num_steps_trained_this_iter": 7200, "agent_timesteps_total": 251880, "timers": {"training_iteration_time_ms": 6557.004, "sample_time_ms": 6494.528, "load_time_ms": 1.055, "load_throughput": 3413472.228, "learn_time_ms": 60.789, "learn_throughput": 59221.042, "synch_weights_time_ms": 0.586}, "counters": {"num_env_steps_sampled": 251880, "num_env_steps_trained": 251880, "num_agent_steps_sampled": 251880, "num_agent_steps_trained": 251880}, "done": false, "episodes_total": 185, "training_iteration": 53, "trial_id": "30366_00000", "date": "2023-07-24_23-25-24", "timestamp": 1690230324, "time_this_iter_s": 13.128047227859497, "time_total_s": 652.0750761032104, "pid": 49740, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 30, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[299400, 0.0005], [342600, 0.00025], [385800, 0.0001], [429000, 5e-05], [472200, 2.5e-05], [515400, 1e-05], [558600, 7.5e-06], [601800, 5e-06], [645000, 2.5e-06], [688200, 1e-06], [731400, 7.5e-07], [774600, 5e-07], [817800, 2.5e-07], [861000, 1e-07]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 3600, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x1590ec430>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 438.46226811408997, "iterations_since_restore": 33, "perf": {"cpu_util_percent": 21.4, "ram_util_percent": 78.86666666666667}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-07, "entropy_coeff": 0.09999999999999999, "policy_entropy": 68.40440034866333, "policy_loss": 11615.473946707589, "vf_loss": 930201.1050502232}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 3780.5, "diff_num_grad_updates_vs_sampler_policy": 3779.5}}, "num_env_steps_sampled": 259080, "num_env_steps_trained": 259080, "num_agent_steps_sampled": 259080, "num_agent_steps_trained": 259080}, "sampler_results": {"episode_reward_max": 6649.952851613771, "episode_reward_min": 5822.434483329361, "episode_reward_mean": 6302.077099313356, "episode_len_mean": 3600.0, "episode_media": {}, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [6472.9208637880565, 6339.812419465837, 6334.258679034131, 6211.571156794661, 6418.300181429795, 5875.440605207955, 6117.037586622728, 6524.779609310018, 6229.074338156758, 6118.273628943209, 6419.584446941989, 6321.320624760528, 6077.574408109293, 6162.265795993462, 6284.736884948364, 5822.434483329361, 6148.113382034317, 6105.12899024897, 6478.019835129416, 6649.952851613771, 6196.126866374364, 6507.234394001286, 6420.098054004528, 6497.099697449449, 6273.645648477113, 6301.745981408095, 5883.384315134592, 6026.025764365394, 6436.971932561103, 6489.231440066342, 6260.451966543025, 5972.368183961365, 6298.574182194228, 6281.572690372666, 5989.062468186445, 6434.226580963533, 6327.710311238441, 6410.510491438744, 5867.305940846087, 6353.0345067335265, 6375.566268329367, 6233.027471620641, 6448.014165047721, 6288.086458965973, 6346.356372628611, 6451.23016893374, 6521.694038416486, 6385.334677549981, 6171.955278688882, 6483.65920473466, 6478.941618378691, 6220.08400984982, 6480.008668075746, 6501.6802252436, 6298.887719184532, 6462.078855348306, 6313.558858238497, 6514.523143294627, 6322.551405610618, 6600.505003187828, 6360.966009872357, 6263.711954856654, 6291.926225828147, 6470.611018916694, 6027.525901125601, 6311.795610922072, 6348.143747408556, 6231.836484866772], "episode_lengths": [3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5348185670273641, "mean_inference_ms": 0.24887612298837775, "mean_action_processing_ms": 0.058667411141897295, "mean_env_wait_ms": 0.987762140159425, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0028182478512034695, "StateBufferConnector_ms": 0.001857911839204676, "ViewRequirementAgentConnector_ms": 0.04694637130288517}}, "episode_reward_max": 6649.952851613771, "episode_reward_min": 5822.434483329361, "episode_reward_mean": 6302.077099313356, "episode_len_mean": 3600.0, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [6472.9208637880565, 6339.812419465837, 6334.258679034131, 6211.571156794661, 6418.300181429795, 5875.440605207955, 6117.037586622728, 6524.779609310018, 6229.074338156758, 6118.273628943209, 6419.584446941989, 6321.320624760528, 6077.574408109293, 6162.265795993462, 6284.736884948364, 5822.434483329361, 6148.113382034317, 6105.12899024897, 6478.019835129416, 6649.952851613771, 6196.126866374364, 6507.234394001286, 6420.098054004528, 6497.099697449449, 6273.645648477113, 6301.745981408095, 5883.384315134592, 6026.025764365394, 6436.971932561103, 6489.231440066342, 6260.451966543025, 5972.368183961365, 6298.574182194228, 6281.572690372666, 5989.062468186445, 6434.226580963533, 6327.710311238441, 6410.510491438744, 5867.305940846087, 6353.0345067335265, 6375.566268329367, 6233.027471620641, 6448.014165047721, 6288.086458965973, 6346.356372628611, 6451.23016893374, 6521.694038416486, 6385.334677549981, 6171.955278688882, 6483.65920473466, 6478.941618378691, 6220.08400984982, 6480.008668075746, 6501.6802252436, 6298.887719184532, 6462.078855348306, 6313.558858238497, 6514.523143294627, 6322.551405610618, 6600.505003187828, 6360.966009872357, 6263.711954856654, 6291.926225828147, 6470.611018916694, 6027.525901125601, 6311.795610922072, 6348.143747408556, 6231.836484866772], "episode_lengths": [3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5348185670273641, "mean_inference_ms": 0.24887612298837775, "mean_action_processing_ms": 0.058667411141897295, "mean_env_wait_ms": 0.987762140159425, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0028182478512034695, "StateBufferConnector_ms": 0.001857911839204676, "ViewRequirementAgentConnector_ms": 0.04694637130288517}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 259080, "num_agent_steps_trained": 259080, "num_env_steps_sampled": 259080, "num_env_steps_trained": 259080, "num_env_steps_sampled_this_iter": 7200, "num_env_steps_trained_this_iter": 7200, "num_env_steps_sampled_throughput_per_sec": 551.9256279072445, "num_env_steps_trained_throughput_per_sec": 551.9256279072445, "timesteps_total": 259080, "num_steps_trained_this_iter": 7200, "agent_timesteps_total": 259080, "timers": {"training_iteration_time_ms": 6553.32, "sample_time_ms": 6490.393, "load_time_ms": 1.042, "load_throughput": 3454787.535, "learn_time_ms": 61.251, "learn_throughput": 58774.096, "synch_weights_time_ms": 0.588}, "counters": {"num_env_steps_sampled": 259080, "num_env_steps_trained": 259080, "num_agent_steps_sampled": 259080, "num_agent_steps_trained": 259080}, "done": false, "episodes_total": 187, "training_iteration": 54, "trial_id": "30366_00000", "date": "2023-07-24_23-25-37", "timestamp": 1690230337, "time_this_iter_s": 13.047402143478394, "time_total_s": 665.1224782466888, "pid": 49740, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 30, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[299400, 0.0005], [342600, 0.00025], [385800, 0.0001], [429000, 5e-05], [472200, 2.5e-05], [515400, 1e-05], [558600, 7.5e-06], [601800, 5e-06], [645000, 2.5e-06], [688200, 1e-06], [731400, 7.5e-07], [774600, 5e-07], [817800, 2.5e-07], [861000, 1e-07]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 3600, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x1590ec430>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 451.50967025756836, "iterations_since_restore": 34, "perf": {"cpu_util_percent": 24.105263157894736, "ram_util_percent": 78.91578947368421}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-07, "entropy_coeff": 0.09999999999999999, "policy_entropy": 68.0388137953622, "policy_loss": 11231.318690708706, "vf_loss": 935661.333984375}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 3892.5, "diff_num_grad_updates_vs_sampler_policy": 3891.5}}, "num_env_steps_sampled": 266280, "num_env_steps_trained": 266280, "num_agent_steps_sampled": 266280, "num_agent_steps_trained": 266280}, "sampler_results": {"episode_reward_max": 6649.952851613771, "episode_reward_min": 5822.434483329361, "episode_reward_mean": 6302.15609850254, "episode_len_mean": 3600.0, "episode_media": {}, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [6472.9208637880565, 6339.812419465837, 6334.258679034131, 6211.571156794661, 6418.300181429795, 5875.440605207955, 6117.037586622728, 6524.779609310018, 6229.074338156758, 6118.273628943209, 6419.584446941989, 6321.320624760528, 6077.574408109293, 6162.265795993462, 6284.736884948364, 5822.434483329361, 6148.113382034317, 6105.12899024897, 6478.019835129416, 6649.952851613771, 6196.126866374364, 6507.234394001286, 6420.098054004528, 6497.099697449449, 6273.645648477113, 6301.745981408095, 5883.384315134592, 6026.025764365394, 6436.971932561103, 6489.231440066342, 6260.451966543025, 5972.368183961365, 6298.574182194228, 6281.572690372666, 5989.062468186445, 6434.226580963533, 6327.710311238441, 6410.510491438744, 5867.305940846087, 6353.0345067335265, 6375.566268329367, 6233.027471620641, 6448.014165047721, 6288.086458965973, 6346.356372628611, 6451.23016893374, 6521.694038416486, 6385.334677549981, 6171.955278688882, 6483.65920473466, 6478.941618378691, 6220.08400984982, 6480.008668075746, 6501.6802252436, 6298.887719184532, 6462.078855348306, 6313.558858238497, 6514.523143294627, 6322.551405610618, 6600.505003187828, 6360.966009872357, 6263.711954856654, 6291.926225828147, 6470.611018916694, 6027.525901125601, 6311.795610922072, 6348.143747408556, 6231.836484866772, 6364.348750071695, 6245.335391797904], "episode_lengths": [3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5348396883092097, "mean_inference_ms": 0.24890190829770034, "mean_action_processing_ms": 0.05866935556233851, "mean_env_wait_ms": 0.9872218280301422, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0028051648821149555, "StateBufferConnector_ms": 0.0018572807312011719, "ViewRequirementAgentConnector_ms": 0.04696573529924665}}, "episode_reward_max": 6649.952851613771, "episode_reward_min": 5822.434483329361, "episode_reward_mean": 6302.15609850254, "episode_len_mean": 3600.0, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [6472.9208637880565, 6339.812419465837, 6334.258679034131, 6211.571156794661, 6418.300181429795, 5875.440605207955, 6117.037586622728, 6524.779609310018, 6229.074338156758, 6118.273628943209, 6419.584446941989, 6321.320624760528, 6077.574408109293, 6162.265795993462, 6284.736884948364, 5822.434483329361, 6148.113382034317, 6105.12899024897, 6478.019835129416, 6649.952851613771, 6196.126866374364, 6507.234394001286, 6420.098054004528, 6497.099697449449, 6273.645648477113, 6301.745981408095, 5883.384315134592, 6026.025764365394, 6436.971932561103, 6489.231440066342, 6260.451966543025, 5972.368183961365, 6298.574182194228, 6281.572690372666, 5989.062468186445, 6434.226580963533, 6327.710311238441, 6410.510491438744, 5867.305940846087, 6353.0345067335265, 6375.566268329367, 6233.027471620641, 6448.014165047721, 6288.086458965973, 6346.356372628611, 6451.23016893374, 6521.694038416486, 6385.334677549981, 6171.955278688882, 6483.65920473466, 6478.941618378691, 6220.08400984982, 6480.008668075746, 6501.6802252436, 6298.887719184532, 6462.078855348306, 6313.558858238497, 6514.523143294627, 6322.551405610618, 6600.505003187828, 6360.966009872357, 6263.711954856654, 6291.926225828147, 6470.611018916694, 6027.525901125601, 6311.795610922072, 6348.143747408556, 6231.836484866772, 6364.348750071695, 6245.335391797904], "episode_lengths": [3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5348396883092097, "mean_inference_ms": 0.24890190829770034, "mean_action_processing_ms": 0.05866935556233851, "mean_env_wait_ms": 0.9872218280301422, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0028051648821149555, "StateBufferConnector_ms": 0.0018572807312011719, "ViewRequirementAgentConnector_ms": 0.04696573529924665}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 266280, "num_agent_steps_trained": 266280, "num_env_steps_sampled": 266280, "num_env_steps_trained": 266280, "num_env_steps_sampled_this_iter": 7200, "num_env_steps_trained_this_iter": 7200, "num_env_steps_sampled_throughput_per_sec": 544.6433158475934, "num_env_steps_trained_throughput_per_sec": 544.6433158475934, "timesteps_total": 266280, "num_steps_trained_this_iter": 7200, "agent_timesteps_total": 266280, "timers": {"training_iteration_time_ms": 6570.227, "sample_time_ms": 6507.241, "load_time_ms": 1.055, "load_throughput": 3411544.148, "learn_time_ms": 61.297, "learn_throughput": 58730.044, "synch_weights_time_ms": 0.587}, "counters": {"num_env_steps_sampled": 266280, "num_env_steps_trained": 266280, "num_agent_steps_sampled": 266280, "num_agent_steps_trained": 266280}, "done": false, "episodes_total": 189, "training_iteration": 55, "trial_id": "30366_00000", "date": "2023-07-24_23-25-50", "timestamp": 1690230350, "time_this_iter_s": 13.22167706489563, "time_total_s": 678.3441553115845, "pid": 49740, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 30, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[299400, 0.0005], [342600, 0.00025], [385800, 0.0001], [429000, 5e-05], [472200, 2.5e-05], [515400, 1e-05], [558600, 7.5e-06], [601800, 5e-06], [645000, 2.5e-06], [688200, 1e-06], [731400, 7.5e-07], [774600, 5e-07], [817800, 2.5e-07], [861000, 1e-07]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 3600, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x1590ec430>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 464.731347322464, "iterations_since_restore": 35, "perf": {"cpu_util_percent": 21.66111111111111, "ram_util_percent": 78.81111111111112}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-07, "entropy_coeff": 0.09999999999999999, "policy_entropy": 68.32277025495257, "policy_loss": 11004.858956473214, "vf_loss": 885381.5166015625}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 4004.5, "diff_num_grad_updates_vs_sampler_policy": 4003.5}}, "num_env_steps_sampled": 273480, "num_env_steps_trained": 273480, "num_agent_steps_sampled": 273480, "num_agent_steps_trained": 273480}, "sampler_results": {"episode_reward_max": 6649.952851613771, "episode_reward_min": 5822.434483329361, "episode_reward_mean": 6299.80786742784, "episode_len_mean": 3600.0, "episode_media": {}, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [6472.9208637880565, 6339.812419465837, 6334.258679034131, 6211.571156794661, 6418.300181429795, 5875.440605207955, 6117.037586622728, 6524.779609310018, 6229.074338156758, 6118.273628943209, 6419.584446941989, 6321.320624760528, 6077.574408109293, 6162.265795993462, 6284.736884948364, 5822.434483329361, 6148.113382034317, 6105.12899024897, 6478.019835129416, 6649.952851613771, 6196.126866374364, 6507.234394001286, 6420.098054004528, 6497.099697449449, 6273.645648477113, 6301.745981408095, 5883.384315134592, 6026.025764365394, 6436.971932561103, 6489.231440066342, 6260.451966543025, 5972.368183961365, 6298.574182194228, 6281.572690372666, 5989.062468186445, 6434.226580963533, 6327.710311238441, 6410.510491438744, 5867.305940846087, 6353.0345067335265, 6375.566268329367, 6233.027471620641, 6448.014165047721, 6288.086458965973, 6346.356372628611, 6451.23016893374, 6521.694038416486, 6385.334677549981, 6171.955278688882, 6483.65920473466, 6478.941618378691, 6220.08400984982, 6480.008668075746, 6501.6802252436, 6298.887719184532, 6462.078855348306, 6313.558858238497, 6514.523143294627, 6322.551405610618, 6600.505003187828, 6360.966009872357, 6263.711954856654, 6291.926225828147, 6470.611018916694, 6027.525901125601, 6311.795610922072, 6348.143747408556, 6231.836484866772, 6364.348750071695, 6245.335391797904, 6362.424440331266, 6072.815119295503], "episode_lengths": [3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5348586210523172, "mean_inference_ms": 0.24892493605134794, "mean_action_processing_ms": 0.05867114922157482, "mean_env_wait_ms": 0.986696407419986, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002788503964742025, "StateBufferConnector_ms": 0.0018580092324150933, "ViewRequirementAgentConnector_ms": 0.04687474833594428}}, "episode_reward_max": 6649.952851613771, "episode_reward_min": 5822.434483329361, "episode_reward_mean": 6299.80786742784, "episode_len_mean": 3600.0, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [6472.9208637880565, 6339.812419465837, 6334.258679034131, 6211.571156794661, 6418.300181429795, 5875.440605207955, 6117.037586622728, 6524.779609310018, 6229.074338156758, 6118.273628943209, 6419.584446941989, 6321.320624760528, 6077.574408109293, 6162.265795993462, 6284.736884948364, 5822.434483329361, 6148.113382034317, 6105.12899024897, 6478.019835129416, 6649.952851613771, 6196.126866374364, 6507.234394001286, 6420.098054004528, 6497.099697449449, 6273.645648477113, 6301.745981408095, 5883.384315134592, 6026.025764365394, 6436.971932561103, 6489.231440066342, 6260.451966543025, 5972.368183961365, 6298.574182194228, 6281.572690372666, 5989.062468186445, 6434.226580963533, 6327.710311238441, 6410.510491438744, 5867.305940846087, 6353.0345067335265, 6375.566268329367, 6233.027471620641, 6448.014165047721, 6288.086458965973, 6346.356372628611, 6451.23016893374, 6521.694038416486, 6385.334677549981, 6171.955278688882, 6483.65920473466, 6478.941618378691, 6220.08400984982, 6480.008668075746, 6501.6802252436, 6298.887719184532, 6462.078855348306, 6313.558858238497, 6514.523143294627, 6322.551405610618, 6600.505003187828, 6360.966009872357, 6263.711954856654, 6291.926225828147, 6470.611018916694, 6027.525901125601, 6311.795610922072, 6348.143747408556, 6231.836484866772, 6364.348750071695, 6245.335391797904, 6362.424440331266, 6072.815119295503], "episode_lengths": [3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5348586210523172, "mean_inference_ms": 0.24892493605134794, "mean_action_processing_ms": 0.05867114922157482, "mean_env_wait_ms": 0.986696407419986, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002788503964742025, "StateBufferConnector_ms": 0.0018580092324150933, "ViewRequirementAgentConnector_ms": 0.04687474833594428}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 273480, "num_agent_steps_trained": 273480, "num_env_steps_sampled": 273480, "num_env_steps_trained": 273480, "num_env_steps_sampled_this_iter": 7200, "num_env_steps_trained_this_iter": 7200, "num_env_steps_sampled_throughput_per_sec": 549.1173615649234, "num_env_steps_trained_throughput_per_sec": 549.1173615649234, "timesteps_total": 273480, "num_steps_trained_this_iter": 7200, "agent_timesteps_total": 273480, "timers": {"training_iteration_time_ms": 6560.784, "sample_time_ms": 6497.752, "load_time_ms": 1.041, "load_throughput": 3459378.299, "learn_time_ms": 61.351, "learn_throughput": 58678.555, "synch_weights_time_ms": 0.595}, "counters": {"num_env_steps_sampled": 273480, "num_env_steps_trained": 273480, "num_agent_steps_sampled": 273480, "num_agent_steps_trained": 273480}, "done": false, "episodes_total": 191, "training_iteration": 56, "trial_id": "30366_00000", "date": "2023-07-24_23-26-03", "timestamp": 1690230363, "time_this_iter_s": 13.114032983779907, "time_total_s": 691.4581882953644, "pid": 49740, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 30, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[299400, 0.0005], [342600, 0.00025], [385800, 0.0001], [429000, 5e-05], [472200, 2.5e-05], [515400, 1e-05], [558600, 7.5e-06], [601800, 5e-06], [645000, 2.5e-06], [688200, 1e-06], [731400, 7.5e-07], [774600, 5e-07], [817800, 2.5e-07], [861000, 1e-07]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 3600, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x1590ec430>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 477.8453803062439, "iterations_since_restore": 36, "perf": {"cpu_util_percent": 23.98421052631579, "ram_util_percent": 78.78421052631579}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-07, "entropy_coeff": 0.09999999999999999, "policy_entropy": 67.66202756336757, "policy_loss": 11705.286778041294, "vf_loss": 997478.0043247768}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 4116.5, "diff_num_grad_updates_vs_sampler_policy": 4115.5}}, "num_env_steps_sampled": 280680, "num_env_steps_trained": 280680, "num_agent_steps_sampled": 280680, "num_agent_steps_trained": 280680}, "sampler_results": {"episode_reward_max": 6649.952851613771, "episode_reward_min": 5822.434483329361, "episode_reward_mean": 6299.553044454989, "episode_len_mean": 3600.0, "episode_media": {}, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [6472.9208637880565, 6339.812419465837, 6334.258679034131, 6211.571156794661, 6418.300181429795, 5875.440605207955, 6117.037586622728, 6524.779609310018, 6229.074338156758, 6118.273628943209, 6419.584446941989, 6321.320624760528, 6077.574408109293, 6162.265795993462, 6284.736884948364, 5822.434483329361, 6148.113382034317, 6105.12899024897, 6478.019835129416, 6649.952851613771, 6196.126866374364, 6507.234394001286, 6420.098054004528, 6497.099697449449, 6273.645648477113, 6301.745981408095, 5883.384315134592, 6026.025764365394, 6436.971932561103, 6489.231440066342, 6260.451966543025, 5972.368183961365, 6298.574182194228, 6281.572690372666, 5989.062468186445, 6434.226580963533, 6327.710311238441, 6410.510491438744, 5867.305940846087, 6353.0345067335265, 6375.566268329367, 6233.027471620641, 6448.014165047721, 6288.086458965973, 6346.356372628611, 6451.23016893374, 6521.694038416486, 6385.334677549981, 6171.955278688882, 6483.65920473466, 6478.941618378691, 6220.08400984982, 6480.008668075746, 6501.6802252436, 6298.887719184532, 6462.078855348306, 6313.558858238497, 6514.523143294627, 6322.551405610618, 6600.505003187828, 6360.966009872357, 6263.711954856654, 6291.926225828147, 6470.611018916694, 6027.525901125601, 6311.795610922072, 6348.143747408556, 6231.836484866772, 6364.348750071695, 6245.335391797904, 6362.424440331266, 6072.815119295503, 6115.514259081299, 6465.2445757833675], "episode_lengths": [3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.53487616415319, "mean_inference_ms": 0.24894516137234698, "mean_action_processing_ms": 0.05867269438240296, "mean_env_wait_ms": 0.9861821218769912, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0027782208210713156, "StateBufferConnector_ms": 0.0018545099206872888, "ViewRequirementAgentConnector_ms": 0.046880825145824534}}, "episode_reward_max": 6649.952851613771, "episode_reward_min": 5822.434483329361, "episode_reward_mean": 6299.553044454989, "episode_len_mean": 3600.0, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [6472.9208637880565, 6339.812419465837, 6334.258679034131, 6211.571156794661, 6418.300181429795, 5875.440605207955, 6117.037586622728, 6524.779609310018, 6229.074338156758, 6118.273628943209, 6419.584446941989, 6321.320624760528, 6077.574408109293, 6162.265795993462, 6284.736884948364, 5822.434483329361, 6148.113382034317, 6105.12899024897, 6478.019835129416, 6649.952851613771, 6196.126866374364, 6507.234394001286, 6420.098054004528, 6497.099697449449, 6273.645648477113, 6301.745981408095, 5883.384315134592, 6026.025764365394, 6436.971932561103, 6489.231440066342, 6260.451966543025, 5972.368183961365, 6298.574182194228, 6281.572690372666, 5989.062468186445, 6434.226580963533, 6327.710311238441, 6410.510491438744, 5867.305940846087, 6353.0345067335265, 6375.566268329367, 6233.027471620641, 6448.014165047721, 6288.086458965973, 6346.356372628611, 6451.23016893374, 6521.694038416486, 6385.334677549981, 6171.955278688882, 6483.65920473466, 6478.941618378691, 6220.08400984982, 6480.008668075746, 6501.6802252436, 6298.887719184532, 6462.078855348306, 6313.558858238497, 6514.523143294627, 6322.551405610618, 6600.505003187828, 6360.966009872357, 6263.711954856654, 6291.926225828147, 6470.611018916694, 6027.525901125601, 6311.795610922072, 6348.143747408556, 6231.836484866772, 6364.348750071695, 6245.335391797904, 6362.424440331266, 6072.815119295503, 6115.514259081299, 6465.2445757833675], "episode_lengths": [3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.53487616415319, "mean_inference_ms": 0.24894516137234698, "mean_action_processing_ms": 0.05867269438240296, "mean_env_wait_ms": 0.9861821218769912, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0027782208210713156, "StateBufferConnector_ms": 0.0018545099206872888, "ViewRequirementAgentConnector_ms": 0.046880825145824534}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 280680, "num_agent_steps_trained": 280680, "num_env_steps_sampled": 280680, "num_env_steps_trained": 280680, "num_env_steps_sampled_this_iter": 7200, "num_env_steps_trained_this_iter": 7200, "num_env_steps_sampled_throughput_per_sec": 550.5568750220481, "num_env_steps_trained_throughput_per_sec": 550.5568750220481, "timesteps_total": 280680, "num_steps_trained_this_iter": 7200, "agent_timesteps_total": 280680, "timers": {"training_iteration_time_ms": 6558.043, "sample_time_ms": 6495.001, "load_time_ms": 1.048, "load_throughput": 3435294.717, "learn_time_ms": 61.359, "learn_throughput": 58671.008, "synch_weights_time_ms": 0.59}, "counters": {"num_env_steps_sampled": 280680, "num_env_steps_trained": 280680, "num_agent_steps_sampled": 280680, "num_agent_steps_trained": 280680}, "done": false, "episodes_total": 193, "training_iteration": 57, "trial_id": "30366_00000", "date": "2023-07-24_23-26-17", "timestamp": 1690230377, "time_this_iter_s": 13.07996916770935, "time_total_s": 704.5381574630737, "pid": 49740, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 30, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[299400, 0.0005], [342600, 0.00025], [385800, 0.0001], [429000, 5e-05], [472200, 2.5e-05], [515400, 1e-05], [558600, 7.5e-06], [601800, 5e-06], [645000, 2.5e-06], [688200, 1e-06], [731400, 7.5e-07], [774600, 5e-07], [817800, 2.5e-07], [861000, 1e-07]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 3600, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x1590ec430>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 490.92534947395325, "iterations_since_restore": 37, "perf": {"cpu_util_percent": 24.115789473684213, "ram_util_percent": 78.76315789473684}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-07, "entropy_coeff": 0.09999999999999999, "policy_entropy": 67.65229545320783, "policy_loss": 11377.069632393974, "vf_loss": 953402.396484375}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 4228.5, "diff_num_grad_updates_vs_sampler_policy": 4227.5}}, "num_env_steps_sampled": 287880, "num_env_steps_trained": 287880, "num_agent_steps_sampled": 287880, "num_agent_steps_trained": 287880}, "sampler_results": {"episode_reward_max": 6649.952851613771, "episode_reward_min": 5822.434483329361, "episode_reward_mean": 6304.439541529475, "episode_len_mean": 3600.0, "episode_media": {}, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [6472.9208637880565, 6339.812419465837, 6334.258679034131, 6211.571156794661, 6418.300181429795, 5875.440605207955, 6117.037586622728, 6524.779609310018, 6229.074338156758, 6118.273628943209, 6419.584446941989, 6321.320624760528, 6077.574408109293, 6162.265795993462, 6284.736884948364, 5822.434483329361, 6148.113382034317, 6105.12899024897, 6478.019835129416, 6649.952851613771, 6196.126866374364, 6507.234394001286, 6420.098054004528, 6497.099697449449, 6273.645648477113, 6301.745981408095, 5883.384315134592, 6026.025764365394, 6436.971932561103, 6489.231440066342, 6260.451966543025, 5972.368183961365, 6298.574182194228, 6281.572690372666, 5989.062468186445, 6434.226580963533, 6327.710311238441, 6410.510491438744, 5867.305940846087, 6353.0345067335265, 6375.566268329367, 6233.027471620641, 6448.014165047721, 6288.086458965973, 6346.356372628611, 6451.23016893374, 6521.694038416486, 6385.334677549981, 6171.955278688882, 6483.65920473466, 6478.941618378691, 6220.08400984982, 6480.008668075746, 6501.6802252436, 6298.887719184532, 6462.078855348306, 6313.558858238497, 6514.523143294627, 6322.551405610618, 6600.505003187828, 6360.966009872357, 6263.711954856654, 6291.926225828147, 6470.611018916694, 6027.525901125601, 6311.795610922072, 6348.143747408556, 6231.836484866772, 6364.348750071695, 6245.335391797904, 6362.424440331266, 6072.815119295503, 6115.514259081299, 6465.2445757833675, 6644.530626206887, 6325.949240364052], "episode_lengths": [3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.53489021018961, "mean_inference_ms": 0.24896266786867033, "mean_action_processing_ms": 0.05867406344438092, "mean_env_wait_ms": 0.9856891422481887, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002771929690712377, "StateBufferConnector_ms": 0.001851822200574373, "ViewRequirementAgentConnector_ms": 0.046940853721217105}}, "episode_reward_max": 6649.952851613771, "episode_reward_min": 5822.434483329361, "episode_reward_mean": 6304.439541529475, "episode_len_mean": 3600.0, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [6472.9208637880565, 6339.812419465837, 6334.258679034131, 6211.571156794661, 6418.300181429795, 5875.440605207955, 6117.037586622728, 6524.779609310018, 6229.074338156758, 6118.273628943209, 6419.584446941989, 6321.320624760528, 6077.574408109293, 6162.265795993462, 6284.736884948364, 5822.434483329361, 6148.113382034317, 6105.12899024897, 6478.019835129416, 6649.952851613771, 6196.126866374364, 6507.234394001286, 6420.098054004528, 6497.099697449449, 6273.645648477113, 6301.745981408095, 5883.384315134592, 6026.025764365394, 6436.971932561103, 6489.231440066342, 6260.451966543025, 5972.368183961365, 6298.574182194228, 6281.572690372666, 5989.062468186445, 6434.226580963533, 6327.710311238441, 6410.510491438744, 5867.305940846087, 6353.0345067335265, 6375.566268329367, 6233.027471620641, 6448.014165047721, 6288.086458965973, 6346.356372628611, 6451.23016893374, 6521.694038416486, 6385.334677549981, 6171.955278688882, 6483.65920473466, 6478.941618378691, 6220.08400984982, 6480.008668075746, 6501.6802252436, 6298.887719184532, 6462.078855348306, 6313.558858238497, 6514.523143294627, 6322.551405610618, 6600.505003187828, 6360.966009872357, 6263.711954856654, 6291.926225828147, 6470.611018916694, 6027.525901125601, 6311.795610922072, 6348.143747408556, 6231.836484866772, 6364.348750071695, 6245.335391797904, 6362.424440331266, 6072.815119295503, 6115.514259081299, 6465.2445757833675, 6644.530626206887, 6325.949240364052], "episode_lengths": [3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.53489021018961, "mean_inference_ms": 0.24896266786867033, "mean_action_processing_ms": 0.05867406344438092, "mean_env_wait_ms": 0.9856891422481887, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002771929690712377, "StateBufferConnector_ms": 0.001851822200574373, "ViewRequirementAgentConnector_ms": 0.046940853721217105}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 287880, "num_agent_steps_trained": 287880, "num_env_steps_sampled": 287880, "num_env_steps_trained": 287880, "num_env_steps_sampled_this_iter": 7200, "num_env_steps_trained_this_iter": 7200, "num_env_steps_sampled_throughput_per_sec": 547.1991624310916, "num_env_steps_trained_throughput_per_sec": 547.1991624310916, "timesteps_total": 287880, "num_steps_trained_this_iter": 7200, "agent_timesteps_total": 287880, "timers": {"training_iteration_time_ms": 6561.231, "sample_time_ms": 6498.117, "load_time_ms": 1.032, "load_throughput": 3489276.332, "learn_time_ms": 61.438, "learn_throughput": 58595.782, "synch_weights_time_ms": 0.599}, "counters": {"num_env_steps_sampled": 287880, "num_env_steps_trained": 287880, "num_agent_steps_sampled": 287880, "num_agent_steps_trained": 287880}, "done": false, "episodes_total": 195, "training_iteration": 58, "trial_id": "30366_00000", "date": "2023-07-24_23-26-30", "timestamp": 1690230390, "time_this_iter_s": 13.159976959228516, "time_total_s": 717.6981344223022, "pid": 49740, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 30, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[299400, 0.0005], [342600, 0.00025], [385800, 0.0001], [429000, 5e-05], [472200, 2.5e-05], [515400, 1e-05], [558600, 7.5e-06], [601800, 5e-06], [645000, 2.5e-06], [688200, 1e-06], [731400, 7.5e-07], [774600, 5e-07], [817800, 2.5e-07], [861000, 1e-07]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 3600, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x1590ec430>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 504.08532643318176, "iterations_since_restore": 38, "perf": {"cpu_util_percent": 21.62222222222222, "ram_util_percent": 78.8}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-07, "entropy_coeff": 0.09999999999999999, "policy_entropy": 67.47317266464233, "policy_loss": 11427.474705287388, "vf_loss": 916173.8783482143}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 4340.5, "diff_num_grad_updates_vs_sampler_policy": 4339.5}}, "num_env_steps_sampled": 295080, "num_env_steps_trained": 295080, "num_agent_steps_sampled": 295080, "num_agent_steps_trained": 295080}, "sampler_results": {"episode_reward_max": 6649.952851613771, "episode_reward_min": 5822.434483329361, "episode_reward_mean": 6307.282682501134, "episode_len_mean": 3600.0, "episode_media": {}, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [6472.9208637880565, 6339.812419465837, 6334.258679034131, 6211.571156794661, 6418.300181429795, 5875.440605207955, 6117.037586622728, 6524.779609310018, 6229.074338156758, 6118.273628943209, 6419.584446941989, 6321.320624760528, 6077.574408109293, 6162.265795993462, 6284.736884948364, 5822.434483329361, 6148.113382034317, 6105.12899024897, 6478.019835129416, 6649.952851613771, 6196.126866374364, 6507.234394001286, 6420.098054004528, 6497.099697449449, 6273.645648477113, 6301.745981408095, 5883.384315134592, 6026.025764365394, 6436.971932561103, 6489.231440066342, 6260.451966543025, 5972.368183961365, 6298.574182194228, 6281.572690372666, 5989.062468186445, 6434.226580963533, 6327.710311238441, 6410.510491438744, 5867.305940846087, 6353.0345067335265, 6375.566268329367, 6233.027471620641, 6448.014165047721, 6288.086458965973, 6346.356372628611, 6451.23016893374, 6521.694038416486, 6385.334677549981, 6171.955278688882, 6483.65920473466, 6478.941618378691, 6220.08400984982, 6480.008668075746, 6501.6802252436, 6298.887719184532, 6462.078855348306, 6313.558858238497, 6514.523143294627, 6322.551405610618, 6600.505003187828, 6360.966009872357, 6263.711954856654, 6291.926225828147, 6470.611018916694, 6027.525901125601, 6311.795610922072, 6348.143747408556, 6231.836484866772, 6364.348750071695, 6245.335391797904, 6362.424440331266, 6072.815119295503, 6115.514259081299, 6465.2445757833675, 6644.530626206887, 6325.949240364052, 6627.898165802274, 6202.745913046074], "episode_lengths": [3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.534900498263535, "mean_inference_ms": 0.24897595383231172, "mean_action_processing_ms": 0.05867506004964335, "mean_env_wait_ms": 0.9852101834353061, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002761681874593099, "StateBufferConnector_ms": 0.0018624159005972056, "ViewRequirementAgentConnector_ms": 0.0469819093361879}}, "episode_reward_max": 6649.952851613771, "episode_reward_min": 5822.434483329361, "episode_reward_mean": 6307.282682501134, "episode_len_mean": 3600.0, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [6472.9208637880565, 6339.812419465837, 6334.258679034131, 6211.571156794661, 6418.300181429795, 5875.440605207955, 6117.037586622728, 6524.779609310018, 6229.074338156758, 6118.273628943209, 6419.584446941989, 6321.320624760528, 6077.574408109293, 6162.265795993462, 6284.736884948364, 5822.434483329361, 6148.113382034317, 6105.12899024897, 6478.019835129416, 6649.952851613771, 6196.126866374364, 6507.234394001286, 6420.098054004528, 6497.099697449449, 6273.645648477113, 6301.745981408095, 5883.384315134592, 6026.025764365394, 6436.971932561103, 6489.231440066342, 6260.451966543025, 5972.368183961365, 6298.574182194228, 6281.572690372666, 5989.062468186445, 6434.226580963533, 6327.710311238441, 6410.510491438744, 5867.305940846087, 6353.0345067335265, 6375.566268329367, 6233.027471620641, 6448.014165047721, 6288.086458965973, 6346.356372628611, 6451.23016893374, 6521.694038416486, 6385.334677549981, 6171.955278688882, 6483.65920473466, 6478.941618378691, 6220.08400984982, 6480.008668075746, 6501.6802252436, 6298.887719184532, 6462.078855348306, 6313.558858238497, 6514.523143294627, 6322.551405610618, 6600.505003187828, 6360.966009872357, 6263.711954856654, 6291.926225828147, 6470.611018916694, 6027.525901125601, 6311.795610922072, 6348.143747408556, 6231.836484866772, 6364.348750071695, 6245.335391797904, 6362.424440331266, 6072.815119295503, 6115.514259081299, 6465.2445757833675, 6644.530626206887, 6325.949240364052, 6627.898165802274, 6202.745913046074], "episode_lengths": [3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.534900498263535, "mean_inference_ms": 0.24897595383231172, "mean_action_processing_ms": 0.05867506004964335, "mean_env_wait_ms": 0.9852101834353061, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002761681874593099, "StateBufferConnector_ms": 0.0018624159005972056, "ViewRequirementAgentConnector_ms": 0.0469819093361879}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 295080, "num_agent_steps_trained": 295080, "num_env_steps_sampled": 295080, "num_env_steps_trained": 295080, "num_env_steps_sampled_this_iter": 7200, "num_env_steps_trained_this_iter": 7200, "num_env_steps_sampled_throughput_per_sec": 551.2077823215612, "num_env_steps_trained_throughput_per_sec": 551.2077823215612, "timesteps_total": 295080, "num_steps_trained_this_iter": 7200, "agent_timesteps_total": 295080, "timers": {"training_iteration_time_ms": 6562.929, "sample_time_ms": 6500.214, "load_time_ms": 1.047, "load_throughput": 3438267.237, "learn_time_ms": 61.03, "learn_throughput": 58987.285, "synch_weights_time_ms": 0.594}, "counters": {"num_env_steps_sampled": 295080, "num_env_steps_trained": 295080, "num_agent_steps_sampled": 295080, "num_agent_steps_trained": 295080}, "done": false, "episodes_total": 197, "training_iteration": 59, "trial_id": "30366_00000", "date": "2023-07-24_23-26-43", "timestamp": 1690230403, "time_this_iter_s": 13.064411163330078, "time_total_s": 730.7625455856323, "pid": 49740, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 30, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[299400, 0.0005], [342600, 0.00025], [385800, 0.0001], [429000, 5e-05], [472200, 2.5e-05], [515400, 1e-05], [558600, 7.5e-06], [601800, 5e-06], [645000, 2.5e-06], [688200, 1e-06], [731400, 7.5e-07], [774600, 5e-07], [817800, 2.5e-07], [861000, 1e-07]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 3600, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x1590ec430>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 517.1497375965118, "iterations_since_restore": 39, "perf": {"cpu_util_percent": 20.77894736842105, "ram_util_percent": 78.45263157894736}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-07, "entropy_coeff": 0.09999999999999999, "policy_entropy": 67.56316655022758, "policy_loss": 11770.714146205357, "vf_loss": 986794.2689732143}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 4452.5, "diff_num_grad_updates_vs_sampler_policy": 4451.5}}, "num_env_steps_sampled": 302280, "num_env_steps_trained": 302280, "num_agent_steps_sampled": 302280, "num_agent_steps_trained": 302280}, "sampler_results": {"episode_reward_max": 6649.952851613771, "episode_reward_min": 5822.434483329361, "episode_reward_mean": 6310.021853684295, "episode_len_mean": 3600.0, "episode_media": {}, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [6472.9208637880565, 6339.812419465837, 6334.258679034131, 6211.571156794661, 6418.300181429795, 5875.440605207955, 6117.037586622728, 6524.779609310018, 6229.074338156758, 6118.273628943209, 6419.584446941989, 6321.320624760528, 6077.574408109293, 6162.265795993462, 6284.736884948364, 5822.434483329361, 6148.113382034317, 6105.12899024897, 6478.019835129416, 6649.952851613771, 6196.126866374364, 6507.234394001286, 6420.098054004528, 6497.099697449449, 6273.645648477113, 6301.745981408095, 5883.384315134592, 6026.025764365394, 6436.971932561103, 6489.231440066342, 6260.451966543025, 5972.368183961365, 6298.574182194228, 6281.572690372666, 5989.062468186445, 6434.226580963533, 6327.710311238441, 6410.510491438744, 5867.305940846087, 6353.0345067335265, 6375.566268329367, 6233.027471620641, 6448.014165047721, 6288.086458965973, 6346.356372628611, 6451.23016893374, 6521.694038416486, 6385.334677549981, 6171.955278688882, 6483.65920473466, 6478.941618378691, 6220.08400984982, 6480.008668075746, 6501.6802252436, 6298.887719184532, 6462.078855348306, 6313.558858238497, 6514.523143294627, 6322.551405610618, 6600.505003187828, 6360.966009872357, 6263.711954856654, 6291.926225828147, 6470.611018916694, 6027.525901125601, 6311.795610922072, 6348.143747408556, 6231.836484866772, 6364.348750071695, 6245.335391797904, 6362.424440331266, 6072.815119295503, 6115.514259081299, 6465.2445757833675, 6644.530626206887, 6325.949240364052, 6627.898165802274, 6202.745913046074, 6383.6364954107175, 6450.0625642444065], "episode_lengths": [3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5349089850293622, "mean_inference_ms": 0.24898693110854886, "mean_action_processing_ms": 0.058675800110094864, "mean_env_wait_ms": 0.9847441394387817, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0027498602867126465, "StateBufferConnector_ms": 0.0018605589866638184, "ViewRequirementAgentConnector_ms": 0.04697352647781372}}, "episode_reward_max": 6649.952851613771, "episode_reward_min": 5822.434483329361, "episode_reward_mean": 6310.021853684295, "episode_len_mean": 3600.0, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [6472.9208637880565, 6339.812419465837, 6334.258679034131, 6211.571156794661, 6418.300181429795, 5875.440605207955, 6117.037586622728, 6524.779609310018, 6229.074338156758, 6118.273628943209, 6419.584446941989, 6321.320624760528, 6077.574408109293, 6162.265795993462, 6284.736884948364, 5822.434483329361, 6148.113382034317, 6105.12899024897, 6478.019835129416, 6649.952851613771, 6196.126866374364, 6507.234394001286, 6420.098054004528, 6497.099697449449, 6273.645648477113, 6301.745981408095, 5883.384315134592, 6026.025764365394, 6436.971932561103, 6489.231440066342, 6260.451966543025, 5972.368183961365, 6298.574182194228, 6281.572690372666, 5989.062468186445, 6434.226580963533, 6327.710311238441, 6410.510491438744, 5867.305940846087, 6353.0345067335265, 6375.566268329367, 6233.027471620641, 6448.014165047721, 6288.086458965973, 6346.356372628611, 6451.23016893374, 6521.694038416486, 6385.334677549981, 6171.955278688882, 6483.65920473466, 6478.941618378691, 6220.08400984982, 6480.008668075746, 6501.6802252436, 6298.887719184532, 6462.078855348306, 6313.558858238497, 6514.523143294627, 6322.551405610618, 6600.505003187828, 6360.966009872357, 6263.711954856654, 6291.926225828147, 6470.611018916694, 6027.525901125601, 6311.795610922072, 6348.143747408556, 6231.836484866772, 6364.348750071695, 6245.335391797904, 6362.424440331266, 6072.815119295503, 6115.514259081299, 6465.2445757833675, 6644.530626206887, 6325.949240364052, 6627.898165802274, 6202.745913046074, 6383.6364954107175, 6450.0625642444065], "episode_lengths": [3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5349089850293622, "mean_inference_ms": 0.24898693110854886, "mean_action_processing_ms": 0.058675800110094864, "mean_env_wait_ms": 0.9847441394387817, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0027498602867126465, "StateBufferConnector_ms": 0.0018605589866638184, "ViewRequirementAgentConnector_ms": 0.04697352647781372}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 302280, "num_agent_steps_trained": 302280, "num_env_steps_sampled": 302280, "num_env_steps_trained": 302280, "num_env_steps_sampled_this_iter": 7200, "num_env_steps_trained_this_iter": 7200, "num_env_steps_sampled_throughput_per_sec": 549.7727541995853, "num_env_steps_trained_throughput_per_sec": 549.7727541995853, "timesteps_total": 302280, "num_steps_trained_this_iter": 7200, "agent_timesteps_total": 302280, "timers": {"training_iteration_time_ms": 6550.595, "sample_time_ms": 6487.574, "load_time_ms": 1.045, "load_throughput": 3445563.836, "learn_time_ms": 61.328, "learn_throughput": 58701.025, "synch_weights_time_ms": 0.604}, "counters": {"num_env_steps_sampled": 302280, "num_env_steps_trained": 302280, "num_agent_steps_sampled": 302280, "num_agent_steps_trained": 302280}, "done": false, "episodes_total": 199, "training_iteration": 60, "trial_id": "30366_00000", "date": "2023-07-24_23-26-56", "timestamp": 1690230416, "time_this_iter_s": 13.098353147506714, "time_total_s": 743.860898733139, "pid": 49740, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 30, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[299400, 0.0005], [342600, 0.00025], [385800, 0.0001], [429000, 5e-05], [472200, 2.5e-05], [515400, 1e-05], [558600, 7.5e-06], [601800, 5e-06], [645000, 2.5e-06], [688200, 1e-06], [731400, 7.5e-07], [774600, 5e-07], [817800, 2.5e-07], [861000, 1e-07]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 3600, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x1590ec430>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 530.2480907440186, "iterations_since_restore": 40, "perf": {"cpu_util_percent": 23.05, "ram_util_percent": 78.35000000000001}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 0.00046250000000000013, "entropy_coeff": 0.09999999999999999, "policy_entropy": 59.24076502663748, "policy_loss": 9610.85659790039, "vf_loss": 755725.3563058035}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 4564.5, "diff_num_grad_updates_vs_sampler_policy": 4563.5}}, "num_env_steps_sampled": 309480, "num_env_steps_trained": 309480, "num_agent_steps_sampled": 309480, "num_agent_steps_trained": 309480}, "sampler_results": {"episode_reward_max": 6649.952851613771, "episode_reward_min": 5822.434483329361, "episode_reward_mean": 6307.433455235132, "episode_len_mean": 3600.0, "episode_media": {}, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [6472.9208637880565, 6339.812419465837, 6334.258679034131, 6211.571156794661, 6418.300181429795, 5875.440605207955, 6117.037586622728, 6524.779609310018, 6229.074338156758, 6118.273628943209, 6419.584446941989, 6321.320624760528, 6077.574408109293, 6162.265795993462, 6284.736884948364, 5822.434483329361, 6148.113382034317, 6105.12899024897, 6478.019835129416, 6649.952851613771, 6196.126866374364, 6507.234394001286, 6420.098054004528, 6497.099697449449, 6273.645648477113, 6301.745981408095, 5883.384315134592, 6026.025764365394, 6436.971932561103, 6489.231440066342, 6260.451966543025, 5972.368183961365, 6298.574182194228, 6281.572690372666, 5989.062468186445, 6434.226580963533, 6327.710311238441, 6410.510491438744, 5867.305940846087, 6353.0345067335265, 6375.566268329367, 6233.027471620641, 6448.014165047721, 6288.086458965973, 6346.356372628611, 6451.23016893374, 6521.694038416486, 6385.334677549981, 6171.955278688882, 6483.65920473466, 6478.941618378691, 6220.08400984982, 6480.008668075746, 6501.6802252436, 6298.887719184532, 6462.078855348306, 6313.558858238497, 6514.523143294627, 6322.551405610618, 6600.505003187828, 6360.966009872357, 6263.711954856654, 6291.926225828147, 6470.611018916694, 6027.525901125601, 6311.795610922072, 6348.143747408556, 6231.836484866772, 6364.348750071695, 6245.335391797904, 6362.424440331266, 6072.815119295503, 6115.514259081299, 6465.2445757833675, 6644.530626206887, 6325.949240364052, 6627.898165802274, 6202.745913046074, 6383.6364954107175, 6450.0625642444065, 6498.236676861806, 5909.558357675459], "episode_lengths": [3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5349166732315686, "mean_inference_ms": 0.2490036094468067, "mean_action_processing_ms": 0.058676526990614604, "mean_env_wait_ms": 0.9842768439345365, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0027386153616556306, "StateBufferConnector_ms": 0.0018579203908036396, "ViewRequirementAgentConnector_ms": 0.04693095276995403}}, "episode_reward_max": 6649.952851613771, "episode_reward_min": 5822.434483329361, "episode_reward_mean": 6307.433455235132, "episode_len_mean": 3600.0, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [6472.9208637880565, 6339.812419465837, 6334.258679034131, 6211.571156794661, 6418.300181429795, 5875.440605207955, 6117.037586622728, 6524.779609310018, 6229.074338156758, 6118.273628943209, 6419.584446941989, 6321.320624760528, 6077.574408109293, 6162.265795993462, 6284.736884948364, 5822.434483329361, 6148.113382034317, 6105.12899024897, 6478.019835129416, 6649.952851613771, 6196.126866374364, 6507.234394001286, 6420.098054004528, 6497.099697449449, 6273.645648477113, 6301.745981408095, 5883.384315134592, 6026.025764365394, 6436.971932561103, 6489.231440066342, 6260.451966543025, 5972.368183961365, 6298.574182194228, 6281.572690372666, 5989.062468186445, 6434.226580963533, 6327.710311238441, 6410.510491438744, 5867.305940846087, 6353.0345067335265, 6375.566268329367, 6233.027471620641, 6448.014165047721, 6288.086458965973, 6346.356372628611, 6451.23016893374, 6521.694038416486, 6385.334677549981, 6171.955278688882, 6483.65920473466, 6478.941618378691, 6220.08400984982, 6480.008668075746, 6501.6802252436, 6298.887719184532, 6462.078855348306, 6313.558858238497, 6514.523143294627, 6322.551405610618, 6600.505003187828, 6360.966009872357, 6263.711954856654, 6291.926225828147, 6470.611018916694, 6027.525901125601, 6311.795610922072, 6348.143747408556, 6231.836484866772, 6364.348750071695, 6245.335391797904, 6362.424440331266, 6072.815119295503, 6115.514259081299, 6465.2445757833675, 6644.530626206887, 6325.949240364052, 6627.898165802274, 6202.745913046074, 6383.6364954107175, 6450.0625642444065, 6498.236676861806, 5909.558357675459], "episode_lengths": [3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5349166732315686, "mean_inference_ms": 0.2490036094468067, "mean_action_processing_ms": 0.058676526990614604, "mean_env_wait_ms": 0.9842768439345365, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0027386153616556306, "StateBufferConnector_ms": 0.0018579203908036396, "ViewRequirementAgentConnector_ms": 0.04693095276995403}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 309480, "num_agent_steps_trained": 309480, "num_env_steps_sampled": 309480, "num_env_steps_trained": 309480, "num_env_steps_sampled_this_iter": 7200, "num_env_steps_trained_this_iter": 7200, "num_env_steps_sampled_throughput_per_sec": 552.5312183730466, "num_env_steps_trained_throughput_per_sec": 552.5312183730466, "timesteps_total": 309480, "num_steps_trained_this_iter": 7200, "agent_timesteps_total": 309480, "timers": {"training_iteration_time_ms": 6542.494, "sample_time_ms": 6479.766, "load_time_ms": 1.043, "load_throughput": 3452023.136, "learn_time_ms": 61.044, "learn_throughput": 58974.314, "synch_weights_time_ms": 0.597}, "counters": {"num_env_steps_sampled": 309480, "num_env_steps_trained": 309480, "num_agent_steps_sampled": 309480, "num_agent_steps_trained": 309480}, "done": false, "episodes_total": 201, "training_iteration": 61, "trial_id": "30366_00000", "date": "2023-07-24_23-27-09", "timestamp": 1690230429, "time_this_iter_s": 13.03306794166565, "time_total_s": 756.8939666748047, "pid": 49740, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 30, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[299400, 0.0005], [342600, 0.00025], [385800, 0.0001], [429000, 5e-05], [472200, 2.5e-05], [515400, 1e-05], [558600, 7.5e-06], [601800, 5e-06], [645000, 2.5e-06], [688200, 1e-06], [731400, 7.5e-07], [774600, 5e-07], [817800, 2.5e-07], [861000, 1e-07]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 3600, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x1590ec430>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 543.2811586856842, "iterations_since_restore": 41, "perf": {"cpu_util_percent": 22.77368421052632, "ram_util_percent": 78.37368421052632}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 0.00042083333333333333, "entropy_coeff": 0.09999999999999999, "policy_entropy": 67.41897603443691, "policy_loss": 8088.372305733817, "vf_loss": 460330.58830915176}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 4676.5, "diff_num_grad_updates_vs_sampler_policy": 4675.5}}, "num_env_steps_sampled": 316680, "num_env_steps_trained": 316680, "num_agent_steps_sampled": 316680, "num_agent_steps_trained": 316680}, "sampler_results": {"episode_reward_max": 6649.952851613771, "episode_reward_min": 5032.768184592592, "episode_reward_mean": 6282.334385835552, "episode_len_mean": 3600.0, "episode_media": {}, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [6472.9208637880565, 6339.812419465837, 6334.258679034131, 6211.571156794661, 6418.300181429795, 5875.440605207955, 6117.037586622728, 6524.779609310018, 6229.074338156758, 6118.273628943209, 6419.584446941989, 6321.320624760528, 6077.574408109293, 6162.265795993462, 6284.736884948364, 5822.434483329361, 6148.113382034317, 6105.12899024897, 6478.019835129416, 6649.952851613771, 6196.126866374364, 6507.234394001286, 6420.098054004528, 6497.099697449449, 6273.645648477113, 6301.745981408095, 5883.384315134592, 6026.025764365394, 6436.971932561103, 6489.231440066342, 6260.451966543025, 5972.368183961365, 6298.574182194228, 6281.572690372666, 5989.062468186445, 6434.226580963533, 6327.710311238441, 6410.510491438744, 5867.305940846087, 6353.0345067335265, 6375.566268329367, 6233.027471620641, 6448.014165047721, 6288.086458965973, 6346.356372628611, 6451.23016893374, 6521.694038416486, 6385.334677549981, 6171.955278688882, 6483.65920473466, 6478.941618378691, 6220.08400984982, 6480.008668075746, 6501.6802252436, 6298.887719184532, 6462.078855348306, 6313.558858238497, 6514.523143294627, 6322.551405610618, 6600.505003187828, 6360.966009872357, 6263.711954856654, 6291.926225828147, 6470.611018916694, 6027.525901125601, 6311.795610922072, 6348.143747408556, 6231.836484866772, 6364.348750071695, 6245.335391797904, 6362.424440331266, 6072.815119295503, 6115.514259081299, 6465.2445757833675, 6644.530626206887, 6325.949240364052, 6627.898165802274, 6202.745913046074, 6383.6364954107175, 6450.0625642444065, 6498.236676861806, 5909.558357675459, 5473.7768963128965, 5032.768184592592], "episode_lengths": [3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5349236884151631, "mean_inference_ms": 0.24901803971632083, "mean_action_processing_ms": 0.058677197936239656, "mean_env_wait_ms": 0.9837872910374692, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0027239322662353516, "StateBufferConnector_ms": 0.0018525691259474982, "ViewRequirementAgentConnector_ms": 0.04693468411763509}}, "episode_reward_max": 6649.952851613771, "episode_reward_min": 5032.768184592592, "episode_reward_mean": 6282.334385835552, "episode_len_mean": 3600.0, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [6472.9208637880565, 6339.812419465837, 6334.258679034131, 6211.571156794661, 6418.300181429795, 5875.440605207955, 6117.037586622728, 6524.779609310018, 6229.074338156758, 6118.273628943209, 6419.584446941989, 6321.320624760528, 6077.574408109293, 6162.265795993462, 6284.736884948364, 5822.434483329361, 6148.113382034317, 6105.12899024897, 6478.019835129416, 6649.952851613771, 6196.126866374364, 6507.234394001286, 6420.098054004528, 6497.099697449449, 6273.645648477113, 6301.745981408095, 5883.384315134592, 6026.025764365394, 6436.971932561103, 6489.231440066342, 6260.451966543025, 5972.368183961365, 6298.574182194228, 6281.572690372666, 5989.062468186445, 6434.226580963533, 6327.710311238441, 6410.510491438744, 5867.305940846087, 6353.0345067335265, 6375.566268329367, 6233.027471620641, 6448.014165047721, 6288.086458965973, 6346.356372628611, 6451.23016893374, 6521.694038416486, 6385.334677549981, 6171.955278688882, 6483.65920473466, 6478.941618378691, 6220.08400984982, 6480.008668075746, 6501.6802252436, 6298.887719184532, 6462.078855348306, 6313.558858238497, 6514.523143294627, 6322.551405610618, 6600.505003187828, 6360.966009872357, 6263.711954856654, 6291.926225828147, 6470.611018916694, 6027.525901125601, 6311.795610922072, 6348.143747408556, 6231.836484866772, 6364.348750071695, 6245.335391797904, 6362.424440331266, 6072.815119295503, 6115.514259081299, 6465.2445757833675, 6644.530626206887, 6325.949240364052, 6627.898165802274, 6202.745913046074, 6383.6364954107175, 6450.0625642444065, 6498.236676861806, 5909.558357675459, 5473.7768963128965, 5032.768184592592], "episode_lengths": [3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5349236884151631, "mean_inference_ms": 0.24901803971632083, "mean_action_processing_ms": 0.058677197936239656, "mean_env_wait_ms": 0.9837872910374692, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0027239322662353516, "StateBufferConnector_ms": 0.0018525691259474982, "ViewRequirementAgentConnector_ms": 0.04693468411763509}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 316680, "num_agent_steps_trained": 316680, "num_env_steps_sampled": 316680, "num_env_steps_trained": 316680, "num_env_steps_sampled_this_iter": 7200, "num_env_steps_trained_this_iter": 7200, "num_env_steps_sampled_throughput_per_sec": 568.9280505351626, "num_env_steps_trained_throughput_per_sec": 568.9280505351626, "timesteps_total": 316680, "num_steps_trained_this_iter": 7200, "agent_timesteps_total": 316680, "timers": {"training_iteration_time_ms": 6500.265, "sample_time_ms": 6437.635, "load_time_ms": 1.025, "load_throughput": 3513634.849, "learn_time_ms": 60.965, "learn_throughput": 59050.677, "synch_weights_time_ms": 0.596}, "counters": {"num_env_steps_sampled": 316680, "num_env_steps_trained": 316680, "num_agent_steps_sampled": 316680, "num_agent_steps_trained": 316680}, "done": false, "episodes_total": 203, "training_iteration": 62, "trial_id": "30366_00000", "date": "2023-07-24_23-27-22", "timestamp": 1690230442, "time_this_iter_s": 12.657522916793823, "time_total_s": 769.5514895915985, "pid": 49740, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 30, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[299400, 0.0005], [342600, 0.00025], [385800, 0.0001], [429000, 5e-05], [472200, 2.5e-05], [515400, 1e-05], [558600, 7.5e-06], [601800, 5e-06], [645000, 2.5e-06], [688200, 1e-06], [731400, 7.5e-07], [774600, 5e-07], [817800, 2.5e-07], [861000, 1e-07]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 3600, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x1590ec430>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 555.938681602478, "iterations_since_restore": 42, "perf": {"cpu_util_percent": 22.505555555555556, "ram_util_percent": 78.30000000000001}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 0.0003791666666666666, "entropy_coeff": 0.09999999999999999, "policy_entropy": 76.38416058676583, "policy_loss": 8844.43931361607, "vf_loss": 437864.56710379466}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 4788.5, "diff_num_grad_updates_vs_sampler_policy": 4787.5}}, "num_env_steps_sampled": 323880, "num_env_steps_trained": 323880, "num_agent_steps_sampled": 323880, "num_agent_steps_trained": 323880}, "sampler_results": {"episode_reward_max": 6649.952851613771, "episode_reward_min": 5032.768184592592, "episode_reward_mean": 6267.333371574338, "episode_len_mean": 3600.0, "episode_media": {}, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [6472.9208637880565, 6339.812419465837, 6334.258679034131, 6211.571156794661, 6418.300181429795, 5875.440605207955, 6117.037586622728, 6524.779609310018, 6229.074338156758, 6118.273628943209, 6419.584446941989, 6321.320624760528, 6077.574408109293, 6162.265795993462, 6284.736884948364, 5822.434483329361, 6148.113382034317, 6105.12899024897, 6478.019835129416, 6649.952851613771, 6196.126866374364, 6507.234394001286, 6420.098054004528, 6497.099697449449, 6273.645648477113, 6301.745981408095, 5883.384315134592, 6026.025764365394, 6436.971932561103, 6489.231440066342, 6260.451966543025, 5972.368183961365, 6298.574182194228, 6281.572690372666, 5989.062468186445, 6434.226580963533, 6327.710311238441, 6410.510491438744, 5867.305940846087, 6353.0345067335265, 6375.566268329367, 6233.027471620641, 6448.014165047721, 6288.086458965973, 6346.356372628611, 6451.23016893374, 6521.694038416486, 6385.334677549981, 6171.955278688882, 6483.65920473466, 6478.941618378691, 6220.08400984982, 6480.008668075746, 6501.6802252436, 6298.887719184532, 6462.078855348306, 6313.558858238497, 6514.523143294627, 6322.551405610618, 6600.505003187828, 6360.966009872357, 6263.711954856654, 6291.926225828147, 6470.611018916694, 6027.525901125601, 6311.795610922072, 6348.143747408556, 6231.836484866772, 6364.348750071695, 6245.335391797904, 6362.424440331266, 6072.815119295503, 6115.514259081299, 6465.2445757833675, 6644.530626206887, 6325.949240364052, 6627.898165802274, 6202.745913046074, 6383.6364954107175, 6450.0625642444065, 6498.236676861806, 5909.558357675459, 5473.7768963128965, 5032.768184592592, 6072.898128595337, 5201.683416611353], "episode_lengths": [3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5349318678811957, "mean_inference_ms": 0.2490291320126513, "mean_action_processing_ms": 0.058677571713722475, "mean_env_wait_ms": 0.9833078652924196, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0027221302653467933, "StateBufferConnector_ms": 0.001851347989814226, "ViewRequirementAgentConnector_ms": 0.046979272088339165}}, "episode_reward_max": 6649.952851613771, "episode_reward_min": 5032.768184592592, "episode_reward_mean": 6267.333371574338, "episode_len_mean": 3600.0, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [6472.9208637880565, 6339.812419465837, 6334.258679034131, 6211.571156794661, 6418.300181429795, 5875.440605207955, 6117.037586622728, 6524.779609310018, 6229.074338156758, 6118.273628943209, 6419.584446941989, 6321.320624760528, 6077.574408109293, 6162.265795993462, 6284.736884948364, 5822.434483329361, 6148.113382034317, 6105.12899024897, 6478.019835129416, 6649.952851613771, 6196.126866374364, 6507.234394001286, 6420.098054004528, 6497.099697449449, 6273.645648477113, 6301.745981408095, 5883.384315134592, 6026.025764365394, 6436.971932561103, 6489.231440066342, 6260.451966543025, 5972.368183961365, 6298.574182194228, 6281.572690372666, 5989.062468186445, 6434.226580963533, 6327.710311238441, 6410.510491438744, 5867.305940846087, 6353.0345067335265, 6375.566268329367, 6233.027471620641, 6448.014165047721, 6288.086458965973, 6346.356372628611, 6451.23016893374, 6521.694038416486, 6385.334677549981, 6171.955278688882, 6483.65920473466, 6478.941618378691, 6220.08400984982, 6480.008668075746, 6501.6802252436, 6298.887719184532, 6462.078855348306, 6313.558858238497, 6514.523143294627, 6322.551405610618, 6600.505003187828, 6360.966009872357, 6263.711954856654, 6291.926225828147, 6470.611018916694, 6027.525901125601, 6311.795610922072, 6348.143747408556, 6231.836484866772, 6364.348750071695, 6245.335391797904, 6362.424440331266, 6072.815119295503, 6115.514259081299, 6465.2445757833675, 6644.530626206887, 6325.949240364052, 6627.898165802274, 6202.745913046074, 6383.6364954107175, 6450.0625642444065, 6498.236676861806, 5909.558357675459, 5473.7768963128965, 5032.768184592592, 6072.898128595337, 5201.683416611353], "episode_lengths": [3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5349318678811957, "mean_inference_ms": 0.2490291320126513, "mean_action_processing_ms": 0.058677571713722475, "mean_env_wait_ms": 0.9833078652924196, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0027221302653467933, "StateBufferConnector_ms": 0.001851347989814226, "ViewRequirementAgentConnector_ms": 0.046979272088339165}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 323880, "num_agent_steps_trained": 323880, "num_env_steps_sampled": 323880, "num_env_steps_trained": 323880, "num_env_steps_sampled_this_iter": 7200, "num_env_steps_trained_this_iter": 7200, "num_env_steps_sampled_throughput_per_sec": 551.8992209974056, "num_env_steps_trained_throughput_per_sec": 551.8992209974056, "timesteps_total": 323880, "num_steps_trained_this_iter": 7200, "agent_timesteps_total": 323880, "timers": {"training_iteration_time_ms": 6489.06, "sample_time_ms": 6426.212, "load_time_ms": 1.008, "load_throughput": 3570717.809, "learn_time_ms": 61.198, "learn_throughput": 58825.112, "synch_weights_time_ms": 0.596}, "counters": {"num_env_steps_sampled": 323880, "num_env_steps_trained": 323880, "num_agent_steps_sampled": 323880, "num_agent_steps_trained": 323880}, "done": false, "episodes_total": 205, "training_iteration": 63, "trial_id": "30366_00000", "date": "2023-07-24_23-27-35", "timestamp": 1690230455, "time_this_iter_s": 13.048105001449585, "time_total_s": 782.5995945930481, "pid": 49740, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 30, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[299400, 0.0005], [342600, 0.00025], [385800, 0.0001], [429000, 5e-05], [472200, 2.5e-05], [515400, 1e-05], [558600, 7.5e-06], [601800, 5e-06], [645000, 2.5e-06], [688200, 1e-06], [731400, 7.5e-07], [774600, 5e-07], [817800, 2.5e-07], [861000, 1e-07]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 3600, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x1590ec430>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 568.9867866039276, "iterations_since_restore": 43, "perf": {"cpu_util_percent": 21.705555555555556, "ram_util_percent": 78.33333333333333}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 0.00033750000000000007, "entropy_coeff": 0.09999999999999999, "policy_entropy": 68.42993674959455, "policy_loss": 5756.2661383492605, "vf_loss": 245629.85051618304}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 4900.5, "diff_num_grad_updates_vs_sampler_policy": 4899.5}}, "num_env_steps_sampled": 331080, "num_env_steps_trained": 331080, "num_agent_steps_sampled": 331080, "num_agent_steps_trained": 331080}, "sampler_results": {"episode_reward_max": 6649.952851613771, "episode_reward_min": 4406.201648645975, "episode_reward_mean": 6234.121221925903, "episode_len_mean": 3600.0, "episode_media": {}, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [6472.9208637880565, 6339.812419465837, 6334.258679034131, 6211.571156794661, 6418.300181429795, 5875.440605207955, 6117.037586622728, 6524.779609310018, 6229.074338156758, 6118.273628943209, 6419.584446941989, 6321.320624760528, 6077.574408109293, 6162.265795993462, 6284.736884948364, 5822.434483329361, 6148.113382034317, 6105.12899024897, 6478.019835129416, 6649.952851613771, 6196.126866374364, 6507.234394001286, 6420.098054004528, 6497.099697449449, 6273.645648477113, 6301.745981408095, 5883.384315134592, 6026.025764365394, 6436.971932561103, 6489.231440066342, 6260.451966543025, 5972.368183961365, 6298.574182194228, 6281.572690372666, 5989.062468186445, 6434.226580963533, 6327.710311238441, 6410.510491438744, 5867.305940846087, 6353.0345067335265, 6375.566268329367, 6233.027471620641, 6448.014165047721, 6288.086458965973, 6346.356372628611, 6451.23016893374, 6521.694038416486, 6385.334677549981, 6171.955278688882, 6483.65920473466, 6478.941618378691, 6220.08400984982, 6480.008668075746, 6501.6802252436, 6298.887719184532, 6462.078855348306, 6313.558858238497, 6514.523143294627, 6322.551405610618, 6600.505003187828, 6360.966009872357, 6263.711954856654, 6291.926225828147, 6470.611018916694, 6027.525901125601, 6311.795610922072, 6348.143747408556, 6231.836484866772, 6364.348750071695, 6245.335391797904, 6362.424440331266, 6072.815119295503, 6115.514259081299, 6465.2445757833675, 6644.530626206887, 6325.949240364052, 6627.898165802274, 6202.745913046074, 6383.6364954107175, 6450.0625642444065, 6498.236676861806, 5909.558357675459, 5473.7768963128965, 5032.768184592592, 6072.898128595337, 5201.683416611353, 5205.795925440541, 4406.201648645975], "episode_lengths": [3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5349397959496979, "mean_inference_ms": 0.2490393739609816, "mean_action_processing_ms": 0.05867803725936464, "mean_env_wait_ms": 0.9828047886341438, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002705238082192161, "StateBufferConnector_ms": 0.0018469311974265358, "ViewRequirementAgentConnector_ms": 0.04690424962477251}}, "episode_reward_max": 6649.952851613771, "episode_reward_min": 4406.201648645975, "episode_reward_mean": 6234.121221925903, "episode_len_mean": 3600.0, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [6472.9208637880565, 6339.812419465837, 6334.258679034131, 6211.571156794661, 6418.300181429795, 5875.440605207955, 6117.037586622728, 6524.779609310018, 6229.074338156758, 6118.273628943209, 6419.584446941989, 6321.320624760528, 6077.574408109293, 6162.265795993462, 6284.736884948364, 5822.434483329361, 6148.113382034317, 6105.12899024897, 6478.019835129416, 6649.952851613771, 6196.126866374364, 6507.234394001286, 6420.098054004528, 6497.099697449449, 6273.645648477113, 6301.745981408095, 5883.384315134592, 6026.025764365394, 6436.971932561103, 6489.231440066342, 6260.451966543025, 5972.368183961365, 6298.574182194228, 6281.572690372666, 5989.062468186445, 6434.226580963533, 6327.710311238441, 6410.510491438744, 5867.305940846087, 6353.0345067335265, 6375.566268329367, 6233.027471620641, 6448.014165047721, 6288.086458965973, 6346.356372628611, 6451.23016893374, 6521.694038416486, 6385.334677549981, 6171.955278688882, 6483.65920473466, 6478.941618378691, 6220.08400984982, 6480.008668075746, 6501.6802252436, 6298.887719184532, 6462.078855348306, 6313.558858238497, 6514.523143294627, 6322.551405610618, 6600.505003187828, 6360.966009872357, 6263.711954856654, 6291.926225828147, 6470.611018916694, 6027.525901125601, 6311.795610922072, 6348.143747408556, 6231.836484866772, 6364.348750071695, 6245.335391797904, 6362.424440331266, 6072.815119295503, 6115.514259081299, 6465.2445757833675, 6644.530626206887, 6325.949240364052, 6627.898165802274, 6202.745913046074, 6383.6364954107175, 6450.0625642444065, 6498.236676861806, 5909.558357675459, 5473.7768963128965, 5032.768184592592, 6072.898128595337, 5201.683416611353, 5205.795925440541, 4406.201648645975], "episode_lengths": [3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5349397959496979, "mean_inference_ms": 0.2490393739609816, "mean_action_processing_ms": 0.05867803725936464, "mean_env_wait_ms": 0.9828047886341438, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002705238082192161, "StateBufferConnector_ms": 0.0018469311974265358, "ViewRequirementAgentConnector_ms": 0.04690424962477251}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 331080, "num_agent_steps_trained": 331080, "num_env_steps_sampled": 331080, "num_env_steps_trained": 331080, "num_env_steps_sampled_this_iter": 7200, "num_env_steps_trained_this_iter": 7200, "num_env_steps_sampled_throughput_per_sec": 571.8021151554864, "num_env_steps_trained_throughput_per_sec": 571.8021151554864, "timesteps_total": 331080, "num_steps_trained_this_iter": 7200, "agent_timesteps_total": 331080, "timers": {"training_iteration_time_ms": 6442.015, "sample_time_ms": 6379.263, "load_time_ms": 1.016, "load_throughput": 3544149.47, "learn_time_ms": 61.073, "learn_throughput": 58945.605, "synch_weights_time_ms": 0.617}, "counters": {"num_env_steps_sampled": 331080, "num_env_steps_trained": 331080, "num_agent_steps_sampled": 331080, "num_agent_steps_trained": 331080}, "done": false, "episodes_total": 207, "training_iteration": 64, "trial_id": "30366_00000", "date": "2023-07-24_23-27-47", "timestamp": 1690230467, "time_this_iter_s": 12.594337940216064, "time_total_s": 795.1939325332642, "pid": 49740, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 30, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[299400, 0.0005], [342600, 0.00025], [385800, 0.0001], [429000, 5e-05], [472200, 2.5e-05], [515400, 1e-05], [558600, 7.5e-06], [601800, 5e-06], [645000, 2.5e-06], [688200, 1e-06], [731400, 7.5e-07], [774600, 5e-07], [817800, 2.5e-07], [861000, 1e-07]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 3600, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x1590ec430>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 581.5811245441437, "iterations_since_restore": 44, "perf": {"cpu_util_percent": 24.944444444444443, "ram_util_percent": 78.36111111111113}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 0.00029583333333333333, "entropy_coeff": 0.09999999999999999, "policy_entropy": 60.13936751229422, "policy_loss": 7323.438681466238, "vf_loss": 452301.8204520089}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 5012.5, "diff_num_grad_updates_vs_sampler_policy": 5011.5}}, "num_env_steps_sampled": 338280, "num_env_steps_trained": 338280, "num_agent_steps_sampled": 338280, "num_agent_steps_trained": 338280}, "sampler_results": {"episode_reward_max": 6649.952851613771, "episode_reward_min": 4406.201648645975, "episode_reward_mean": 6214.085893435189, "episode_len_mean": 3600.0, "episode_media": {}, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [6472.9208637880565, 6339.812419465837, 6334.258679034131, 6211.571156794661, 6418.300181429795, 5875.440605207955, 6117.037586622728, 6524.779609310018, 6229.074338156758, 6118.273628943209, 6419.584446941989, 6321.320624760528, 6077.574408109293, 6162.265795993462, 6284.736884948364, 5822.434483329361, 6148.113382034317, 6105.12899024897, 6478.019835129416, 6649.952851613771, 6196.126866374364, 6507.234394001286, 6420.098054004528, 6497.099697449449, 6273.645648477113, 6301.745981408095, 5883.384315134592, 6026.025764365394, 6436.971932561103, 6489.231440066342, 6260.451966543025, 5972.368183961365, 6298.574182194228, 6281.572690372666, 5989.062468186445, 6434.226580963533, 6327.710311238441, 6410.510491438744, 5867.305940846087, 6353.0345067335265, 6375.566268329367, 6233.027471620641, 6448.014165047721, 6288.086458965973, 6346.356372628611, 6451.23016893374, 6521.694038416486, 6385.334677549981, 6171.955278688882, 6483.65920473466, 6478.941618378691, 6220.08400984982, 6480.008668075746, 6501.6802252436, 6298.887719184532, 6462.078855348306, 6313.558858238497, 6514.523143294627, 6322.551405610618, 6600.505003187828, 6360.966009872357, 6263.711954856654, 6291.926225828147, 6470.611018916694, 6027.525901125601, 6311.795610922072, 6348.143747408556, 6231.836484866772, 6364.348750071695, 6245.335391797904, 6362.424440331266, 6072.815119295503, 6115.514259081299, 6465.2445757833675, 6644.530626206887, 6325.949240364052, 6627.898165802274, 6202.745913046074, 6383.6364954107175, 6450.0625642444065, 6498.236676861806, 5909.558357675459, 5473.7768963128965, 5032.768184592592, 6072.898128595337, 5201.683416611353, 5205.795925440541, 4406.201648645975, 4657.323430377689, 6007.739449309893], "episode_lengths": [3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5349554158587997, "mean_inference_ms": 0.2490496846255998, "mean_action_processing_ms": 0.05867869572654562, "mean_env_wait_ms": 0.9822876289455871, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0026988983154296875, "StateBufferConnector_ms": 0.0018466843499077691, "ViewRequirementAgentConnector_ms": 0.046885543399386935}}, "episode_reward_max": 6649.952851613771, "episode_reward_min": 4406.201648645975, "episode_reward_mean": 6214.085893435189, "episode_len_mean": 3600.0, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [6472.9208637880565, 6339.812419465837, 6334.258679034131, 6211.571156794661, 6418.300181429795, 5875.440605207955, 6117.037586622728, 6524.779609310018, 6229.074338156758, 6118.273628943209, 6419.584446941989, 6321.320624760528, 6077.574408109293, 6162.265795993462, 6284.736884948364, 5822.434483329361, 6148.113382034317, 6105.12899024897, 6478.019835129416, 6649.952851613771, 6196.126866374364, 6507.234394001286, 6420.098054004528, 6497.099697449449, 6273.645648477113, 6301.745981408095, 5883.384315134592, 6026.025764365394, 6436.971932561103, 6489.231440066342, 6260.451966543025, 5972.368183961365, 6298.574182194228, 6281.572690372666, 5989.062468186445, 6434.226580963533, 6327.710311238441, 6410.510491438744, 5867.305940846087, 6353.0345067335265, 6375.566268329367, 6233.027471620641, 6448.014165047721, 6288.086458965973, 6346.356372628611, 6451.23016893374, 6521.694038416486, 6385.334677549981, 6171.955278688882, 6483.65920473466, 6478.941618378691, 6220.08400984982, 6480.008668075746, 6501.6802252436, 6298.887719184532, 6462.078855348306, 6313.558858238497, 6514.523143294627, 6322.551405610618, 6600.505003187828, 6360.966009872357, 6263.711954856654, 6291.926225828147, 6470.611018916694, 6027.525901125601, 6311.795610922072, 6348.143747408556, 6231.836484866772, 6364.348750071695, 6245.335391797904, 6362.424440331266, 6072.815119295503, 6115.514259081299, 6465.2445757833675, 6644.530626206887, 6325.949240364052, 6627.898165802274, 6202.745913046074, 6383.6364954107175, 6450.0625642444065, 6498.236676861806, 5909.558357675459, 5473.7768963128965, 5032.768184592592, 6072.898128595337, 5201.683416611353, 5205.795925440541, 4406.201648645975, 4657.323430377689, 6007.739449309893], "episode_lengths": [3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5349554158587997, "mean_inference_ms": 0.2490496846255998, "mean_action_processing_ms": 0.05867869572654562, "mean_env_wait_ms": 0.9822876289455871, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0026988983154296875, "StateBufferConnector_ms": 0.0018466843499077691, "ViewRequirementAgentConnector_ms": 0.046885543399386935}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 338280, "num_agent_steps_trained": 338280, "num_env_steps_sampled": 338280, "num_env_steps_trained": 338280, "num_env_steps_sampled_this_iter": 7200, "num_env_steps_trained_this_iter": 7200, "num_env_steps_sampled_throughput_per_sec": 562.0749314897055, "num_env_steps_trained_throughput_per_sec": 562.0749314897055, "timesteps_total": 338280, "num_steps_trained_this_iter": 7200, "agent_timesteps_total": 338280, "timers": {"training_iteration_time_ms": 6413.35, "sample_time_ms": 6351.012, "load_time_ms": 1.041, "load_throughput": 3457635.539, "learn_time_ms": 60.644, "learn_throughput": 59362.996, "synch_weights_time_ms": 0.609}, "counters": {"num_env_steps_sampled": 338280, "num_env_steps_trained": 338280, "num_agent_steps_sampled": 338280, "num_agent_steps_trained": 338280}, "done": false, "episodes_total": 209, "training_iteration": 65, "trial_id": "30366_00000", "date": "2023-07-24_23-28-00", "timestamp": 1690230480, "time_this_iter_s": 12.811600923538208, "time_total_s": 808.0055334568024, "pid": 49740, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 30, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[299400, 0.0005], [342600, 0.00025], [385800, 0.0001], [429000, 5e-05], [472200, 2.5e-05], [515400, 1e-05], [558600, 7.5e-06], [601800, 5e-06], [645000, 2.5e-06], [688200, 1e-06], [731400, 7.5e-07], [774600, 5e-07], [817800, 2.5e-07], [861000, 1e-07]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 3600, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x1590ec430>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 594.3927254676819, "iterations_since_restore": 45, "perf": {"cpu_util_percent": 24.394444444444446, "ram_util_percent": 78.55000000000001}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 0.0002541666666666667, "entropy_coeff": 0.09999999999999999, "policy_entropy": 73.43160888126918, "policy_loss": 8870.189966474261, "vf_loss": 460197.3016183036}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 5124.5, "diff_num_grad_updates_vs_sampler_policy": 5123.5}}, "num_env_steps_sampled": 345480, "num_env_steps_trained": 345480, "num_agent_steps_sampled": 345480, "num_agent_steps_trained": 345480}, "sampler_results": {"episode_reward_max": 6649.952851613771, "episode_reward_min": 4406.201648645975, "episode_reward_mean": 6217.872540901212, "episode_len_mean": 3600.0, "episode_media": {}, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [6472.9208637880565, 6339.812419465837, 6334.258679034131, 6211.571156794661, 6418.300181429795, 5875.440605207955, 6117.037586622728, 6524.779609310018, 6229.074338156758, 6118.273628943209, 6419.584446941989, 6321.320624760528, 6077.574408109293, 6162.265795993462, 6284.736884948364, 5822.434483329361, 6148.113382034317, 6105.12899024897, 6478.019835129416, 6649.952851613771, 6196.126866374364, 6507.234394001286, 6420.098054004528, 6497.099697449449, 6273.645648477113, 6301.745981408095, 5883.384315134592, 6026.025764365394, 6436.971932561103, 6489.231440066342, 6260.451966543025, 5972.368183961365, 6298.574182194228, 6281.572690372666, 5989.062468186445, 6434.226580963533, 6327.710311238441, 6410.510491438744, 5867.305940846087, 6353.0345067335265, 6375.566268329367, 6233.027471620641, 6448.014165047721, 6288.086458965973, 6346.356372628611, 6451.23016893374, 6521.694038416486, 6385.334677549981, 6171.955278688882, 6483.65920473466, 6478.941618378691, 6220.08400984982, 6480.008668075746, 6501.6802252436, 6298.887719184532, 6462.078855348306, 6313.558858238497, 6514.523143294627, 6322.551405610618, 6600.505003187828, 6360.966009872357, 6263.711954856654, 6291.926225828147, 6470.611018916694, 6027.525901125601, 6311.795610922072, 6348.143747408556, 6231.836484866772, 6364.348750071695, 6245.335391797904, 6362.424440331266, 6072.815119295503, 6115.514259081299, 6465.2445757833675, 6644.530626206887, 6325.949240364052, 6627.898165802274, 6202.745913046074, 6383.6364954107175, 6450.0625642444065, 6498.236676861806, 5909.558357675459, 5473.7768963128965, 5032.768184592592, 6072.898128595337, 5201.683416611353, 5205.795925440541, 4406.201648645975, 4657.323430377689, 6007.739449309893, 6514.099217317355, 6262.444136427217], "episode_lengths": [3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5349710916246212, "mean_inference_ms": 0.2490630629254075, "mean_action_processing_ms": 0.05868017460570482, "mean_env_wait_ms": 0.9818139569391006, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0026920567388119903, "StateBufferConnector_ms": 0.00184618908426036, "ViewRequirementAgentConnector_ms": 0.046851583149122154}}, "episode_reward_max": 6649.952851613771, "episode_reward_min": 4406.201648645975, "episode_reward_mean": 6217.872540901212, "episode_len_mean": 3600.0, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [6472.9208637880565, 6339.812419465837, 6334.258679034131, 6211.571156794661, 6418.300181429795, 5875.440605207955, 6117.037586622728, 6524.779609310018, 6229.074338156758, 6118.273628943209, 6419.584446941989, 6321.320624760528, 6077.574408109293, 6162.265795993462, 6284.736884948364, 5822.434483329361, 6148.113382034317, 6105.12899024897, 6478.019835129416, 6649.952851613771, 6196.126866374364, 6507.234394001286, 6420.098054004528, 6497.099697449449, 6273.645648477113, 6301.745981408095, 5883.384315134592, 6026.025764365394, 6436.971932561103, 6489.231440066342, 6260.451966543025, 5972.368183961365, 6298.574182194228, 6281.572690372666, 5989.062468186445, 6434.226580963533, 6327.710311238441, 6410.510491438744, 5867.305940846087, 6353.0345067335265, 6375.566268329367, 6233.027471620641, 6448.014165047721, 6288.086458965973, 6346.356372628611, 6451.23016893374, 6521.694038416486, 6385.334677549981, 6171.955278688882, 6483.65920473466, 6478.941618378691, 6220.08400984982, 6480.008668075746, 6501.6802252436, 6298.887719184532, 6462.078855348306, 6313.558858238497, 6514.523143294627, 6322.551405610618, 6600.505003187828, 6360.966009872357, 6263.711954856654, 6291.926225828147, 6470.611018916694, 6027.525901125601, 6311.795610922072, 6348.143747408556, 6231.836484866772, 6364.348750071695, 6245.335391797904, 6362.424440331266, 6072.815119295503, 6115.514259081299, 6465.2445757833675, 6644.530626206887, 6325.949240364052, 6627.898165802274, 6202.745913046074, 6383.6364954107175, 6450.0625642444065, 6498.236676861806, 5909.558357675459, 5473.7768963128965, 5032.768184592592, 6072.898128595337, 5201.683416611353, 5205.795925440541, 4406.201648645975, 4657.323430377689, 6007.739449309893, 6514.099217317355, 6262.444136427217], "episode_lengths": [3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5349710916246212, "mean_inference_ms": 0.2490630629254075, "mean_action_processing_ms": 0.05868017460570482, "mean_env_wait_ms": 0.9818139569391006, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0026920567388119903, "StateBufferConnector_ms": 0.00184618908426036, "ViewRequirementAgentConnector_ms": 0.046851583149122154}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 345480, "num_agent_steps_trained": 345480, "num_env_steps_sampled": 345480, "num_env_steps_trained": 345480, "num_env_steps_sampled_this_iter": 7200, "num_env_steps_trained_this_iter": 7200, "num_env_steps_sampled_throughput_per_sec": 529.3772731883819, "num_env_steps_trained_throughput_per_sec": 529.3772731883819, "timesteps_total": 345480, "num_steps_trained_this_iter": 7200, "agent_timesteps_total": 345480, "timers": {"training_iteration_time_ms": 6470.345, "sample_time_ms": 6408.099, "load_time_ms": 1.051, "load_throughput": 3424620.535, "learn_time_ms": 60.539, "learn_throughput": 59466.143, "synch_weights_time_ms": 0.61}, "counters": {"num_env_steps_sampled": 345480, "num_env_steps_trained": 345480, "num_agent_steps_sampled": 345480, "num_agent_steps_trained": 345480}, "done": false, "episodes_total": 211, "training_iteration": 66, "trial_id": "30366_00000", "date": "2023-07-24_23-28-14", "timestamp": 1690230494, "time_this_iter_s": 13.603099822998047, "time_total_s": 821.6086332798004, "pid": 49740, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 30, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[299400, 0.0005], [342600, 0.00025], [385800, 0.0001], [429000, 5e-05], [472200, 2.5e-05], [515400, 1e-05], [558600, 7.5e-06], [601800, 5e-06], [645000, 2.5e-06], [688200, 1e-06], [731400, 7.5e-07], [774600, 5e-07], [817800, 2.5e-07], [861000, 1e-07]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 3600, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x1590ec430>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 607.9958252906799, "iterations_since_restore": 46, "perf": {"cpu_util_percent": 23.61578947368421, "ram_util_percent": 78.08421052631577}}
