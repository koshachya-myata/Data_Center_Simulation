{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-09, "entropy_coeff": 0.049999999999999996, "policy_entropy": -1561.2842967753509, "policy_loss": -4.0033537402496737e+18, "vf_loss": 310920912.84548104}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 343.5, "diff_num_grad_updates_vs_sampler_policy": 342.5}}, "num_env_steps_sampled": 1291920, "num_env_steps_trained": 1291920, "num_agent_steps_sampled": 1291920, "num_agent_steps_trained": 1291920}, "sampler_results": {"episode_reward_max": -1369366.2314788997, "episode_reward_min": -1369366.2314788997, "episode_reward_mean": -1369366.2314788997, "episode_len_mean": 43920.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1369366.2314788997], "episode_lengths": [43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.16105634528174187, "mean_inference_ms": 0.3010331193366307, "mean_action_processing_ms": 0.06770017718615226, "mean_env_wait_ms": 0.6067739484392716, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0023603439331054688, "StateBufferConnector_ms": 0.0017881393432617188, "ViewRequirementAgentConnector_ms": 0.046563148498535156}}, "episode_reward_max": -1369366.2314788997, "episode_reward_min": -1369366.2314788997, "episode_reward_mean": -1369366.2314788997, "episode_len_mean": 43920.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1369366.2314788997], "episode_lengths": [43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.16105634528174187, "mean_inference_ms": 0.3010331193366307, "mean_action_processing_ms": 0.06770017718615226, "mean_env_wait_ms": 0.6067739484392716, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0023603439331054688, "StateBufferConnector_ms": 0.0017881393432617188, "ViewRequirementAgentConnector_ms": 0.046563148498535156}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1291920, "num_agent_steps_trained": 1291920, "num_env_steps_sampled": 1291920, "num_env_steps_trained": 1291920, "num_env_steps_sampled_this_iter": 43920, "num_env_steps_trained_this_iter": 43920, "num_env_steps_sampled_throughput_per_sec": 855.1149503621922, "num_env_steps_trained_throughput_per_sec": 855.1149503621922, "timesteps_total": 1291920, "num_steps_trained_this_iter": 43920, "agent_timesteps_total": 1291920, "timers": {"training_iteration_time_ms": 51361.483, "sample_time_ms": 50538.847, "load_time_ms": 0.469, "load_throughput": 93652176.756, "learn_time_ms": 821.229, "learn_throughput": 53480.821, "synch_weights_time_ms": 0.724}, "counters": {"num_env_steps_sampled": 1291920, "num_env_steps_trained": 1291920, "num_agent_steps_sampled": 1291920, "num_agent_steps_trained": 1291920}, "done": false, "episodes_total": 1220, "training_iteration": 341, "trial_id": "d8b7e_00000", "date": "2023-07-27_05-12-03", "timestamp": 1690423923, "time_this_iter_s": 51.36338520050049, "time_total_s": 4718.908143043518, "pid": 18921, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 366, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[1291920, 5e-05], [1731120, 8e-05], [2170320, 2.5e-05], [2609520, 2.5e-05], [3048720, 2.5e-05], [3487920, 2.5e-05], [3927120, 1e-05], [4366320, 1e-05], [4805520, 1e-05], [5244720, 5e-06], [5683920, 5e-06], [6123120, 5e-06], [6562320, 5e-06], [7001520, 1e-06], [7440720, 1e-06], [7879920, 1e-06], [8319120, 1e-06], [8758320, 5e-07], [9197520, 5e-07], [9636720, 2.5e-07], [10075920, 2.5e-07], [10515120, 1e-08], [10954320, 1e-08], [11393520, 5e-09], [11832720, 5e-09], [12271920, 1e-09]], "grad_clip": 0.5, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.1, "final_epsilon": 0.01, "epsilon_timesteps": 1387080}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 43920, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x16b7b79d0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 51.36338520050049, "iterations_since_restore": 1, "perf": {"cpu_util_percent": 36.51756756756756, "ram_util_percent": 64.10945945945946}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 5.000000000000001e-05, "entropy_coeff": 0.049999999999999996, "policy_entropy": -1621.1790202060176, "policy_loss": -2.4795422542245847e+19, "vf_loss": 307244034.9504373}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 1029.5, "diff_num_grad_updates_vs_sampler_policy": 1028.5}}, "num_env_steps_sampled": 1335840, "num_env_steps_trained": 1335840, "num_agent_steps_sampled": 1335840, "num_agent_steps_trained": 1335840}, "sampler_results": {"episode_reward_max": -1361335.2082701626, "episode_reward_min": -1369366.2314788997, "episode_reward_mean": -1365350.719874531, "episode_len_mean": 43920.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1369366.2314788997, -1361335.2082701626], "episode_lengths": [43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.16202452773452514, "mean_inference_ms": 0.29878133201006263, "mean_action_processing_ms": 0.06749774213368176, "mean_env_wait_ms": 0.5865723077614227, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0025391578674316406, "StateBufferConnector_ms": 0.0018000602722167969, "ViewRequirementAgentConnector_ms": 0.04965066909790039}}, "episode_reward_max": -1361335.2082701626, "episode_reward_min": -1369366.2314788997, "episode_reward_mean": -1365350.719874531, "episode_len_mean": 43920.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1369366.2314788997, -1361335.2082701626], "episode_lengths": [43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.16202452773452514, "mean_inference_ms": 0.29878133201006263, "mean_action_processing_ms": 0.06749774213368176, "mean_env_wait_ms": 0.5865723077614227, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0025391578674316406, "StateBufferConnector_ms": 0.0018000602722167969, "ViewRequirementAgentConnector_ms": 0.04965066909790039}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1335840, "num_agent_steps_trained": 1335840, "num_env_steps_sampled": 1335840, "num_env_steps_trained": 1335840, "num_env_steps_sampled_this_iter": 43920, "num_env_steps_trained_this_iter": 43920, "num_env_steps_sampled_throughput_per_sec": 923.1880457547957, "num_env_steps_trained_throughput_per_sec": 923.1880457547957, "timesteps_total": 1335840, "num_steps_trained_this_iter": 43920, "agent_timesteps_total": 1335840, "timers": {"training_iteration_time_ms": 49467.87, "sample_time_ms": 48662.109, "load_time_ms": 7.691, "load_throughput": 5710640.203, "learn_time_ms": 797.147, "learn_throughput": 55096.461, "synch_weights_time_ms": 0.74}, "counters": {"num_env_steps_sampled": 1335840, "num_env_steps_trained": 1335840, "num_agent_steps_sampled": 1335840, "num_agent_steps_trained": 1335840}, "done": false, "episodes_total": 1221, "training_iteration": 342, "trial_id": "d8b7e_00000", "date": "2023-07-27_05-12-50", "timestamp": 1690423970, "time_this_iter_s": 47.576419830322266, "time_total_s": 4766.48456287384, "pid": 18921, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 366, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[1291920, 5e-05], [1731120, 8e-05], [2170320, 2.5e-05], [2609520, 2.5e-05], [3048720, 2.5e-05], [3487920, 2.5e-05], [3927120, 1e-05], [4366320, 1e-05], [4805520, 1e-05], [5244720, 5e-06], [5683920, 5e-06], [6123120, 5e-06], [6562320, 5e-06], [7001520, 1e-06], [7440720, 1e-06], [7879920, 1e-06], [8319120, 1e-06], [8758320, 5e-07], [9197520, 5e-07], [9636720, 2.5e-07], [10075920, 2.5e-07], [10515120, 1e-08], [10954320, 1e-08], [11393520, 5e-09], [11832720, 5e-09], [12271920, 1e-09]], "grad_clip": 0.5, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.1, "final_epsilon": 0.01, "epsilon_timesteps": 1387080}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 43920, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x16b7b79d0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 98.93980503082275, "iterations_since_restore": 2, "perf": {"cpu_util_percent": 36.220895522388055, "ram_util_percent": 65.67910447761194}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 5.2999999999999994e-05, "entropy_coeff": 0.049999999999999996, "policy_entropy": -1634.8516849262026, "policy_loss": -2.6459288926029804e+19, "vf_loss": 304354664.7113703}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 1715.5, "diff_num_grad_updates_vs_sampler_policy": 1714.5}}, "num_env_steps_sampled": 1379760, "num_env_steps_trained": 1379760, "num_agent_steps_sampled": 1379760, "num_agent_steps_trained": 1379760}, "sampler_results": {"episode_reward_max": -1354747.2510403998, "episode_reward_min": -1369366.2314788997, "episode_reward_mean": -1361816.230263154, "episode_len_mean": 43920.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1369366.2314788997, -1361335.2082701626, -1354747.2510403998], "episode_lengths": [43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.16228133433335623, "mean_inference_ms": 0.2980955706420698, "mean_action_processing_ms": 0.06752816112264119, "mean_env_wait_ms": 0.5760764682579557, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0025351842244466147, "StateBufferConnector_ms": 0.0018517176310221355, "ViewRequirementAgentConnector_ms": 0.050608317057291664}}, "episode_reward_max": -1354747.2510403998, "episode_reward_min": -1369366.2314788997, "episode_reward_mean": -1361816.230263154, "episode_len_mean": 43920.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1369366.2314788997, -1361335.2082701626, -1354747.2510403998], "episode_lengths": [43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.16228133433335623, "mean_inference_ms": 0.2980955706420698, "mean_action_processing_ms": 0.06752816112264119, "mean_env_wait_ms": 0.5760764682579557, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0025351842244466147, "StateBufferConnector_ms": 0.0018517176310221355, "ViewRequirementAgentConnector_ms": 0.050608317057291664}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1379760, "num_agent_steps_trained": 1379760, "num_env_steps_sampled": 1379760, "num_env_steps_trained": 1379760, "num_env_steps_sampled_this_iter": 43920, "num_env_steps_trained_this_iter": 43920, "num_env_steps_sampled_throughput_per_sec": 914.0806462273335, "num_env_steps_trained_throughput_per_sec": 914.0806462273335, "timesteps_total": 1379760, "num_steps_trained_this_iter": 43920, "agent_timesteps_total": 1379760, "timers": {"training_iteration_time_ms": 48994.667, "sample_time_ms": 48185.086, "load_time_ms": 13.755, "load_throughput": 3192964.537, "learn_time_ms": 794.896, "learn_throughput": 55252.497, "synch_weights_time_ms": 0.747}, "counters": {"num_env_steps_sampled": 1379760, "num_env_steps_trained": 1379760, "num_agent_steps_sampled": 1379760, "num_agent_steps_trained": 1379760}, "done": false, "episodes_total": 1222, "training_iteration": 343, "trial_id": "d8b7e_00000", "date": "2023-07-27_05-13-38", "timestamp": 1690424018, "time_this_iter_s": 48.05043005943298, "time_total_s": 4814.534992933273, "pid": 18921, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 366, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[1291920, 5e-05], [1731120, 8e-05], [2170320, 2.5e-05], [2609520, 2.5e-05], [3048720, 2.5e-05], [3487920, 2.5e-05], [3927120, 1e-05], [4366320, 1e-05], [4805520, 1e-05], [5244720, 5e-06], [5683920, 5e-06], [6123120, 5e-06], [6562320, 5e-06], [7001520, 1e-06], [7440720, 1e-06], [7879920, 1e-06], [8319120, 1e-06], [8758320, 5e-07], [9197520, 5e-07], [9636720, 2.5e-07], [10075920, 2.5e-07], [10515120, 1e-08], [10954320, 1e-08], [11393520, 5e-09], [11832720, 5e-09], [12271920, 1e-09]], "grad_clip": 0.5, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.1, "final_epsilon": 0.01, "epsilon_timesteps": 1387080}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 43920, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x16b7b79d0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 146.99023509025574, "iterations_since_restore": 3, "perf": {"cpu_util_percent": 35.72608695652174, "ram_util_percent": 65.32463768115943}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 5.600000000000002e-05, "entropy_coeff": 0.049999999999999996, "policy_entropy": -1640.341477997449, "policy_loss": -2.613038352120209e+19, "vf_loss": 302805566.8862974}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 2401.5, "diff_num_grad_updates_vs_sampler_policy": 2400.5}}, "num_env_steps_sampled": 1423680, "num_env_steps_trained": 1423680, "num_agent_steps_sampled": 1423680, "num_agent_steps_trained": 1423680}, "sampler_results": {"episode_reward_max": -1351385.668151872, "episode_reward_min": -1369366.2314788997, "episode_reward_mean": -1359208.5897353336, "episode_len_mean": 43920.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1369366.2314788997, -1361335.2082701626, -1354747.2510403998, -1351385.668151872], "episode_lengths": [43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.16205416508707915, "mean_inference_ms": 0.29767145404758166, "mean_action_processing_ms": 0.06759437236575165, "mean_env_wait_ms": 0.5689741329835659, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002491474151611328, "StateBufferConnector_ms": 0.0018537044525146484, "ViewRequirementAgentConnector_ms": 0.05017518997192383}}, "episode_reward_max": -1351385.668151872, "episode_reward_min": -1369366.2314788997, "episode_reward_mean": -1359208.5897353336, "episode_len_mean": 43920.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1369366.2314788997, -1361335.2082701626, -1354747.2510403998, -1351385.668151872], "episode_lengths": [43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.16205416508707915, "mean_inference_ms": 0.29767145404758166, "mean_action_processing_ms": 0.06759437236575165, "mean_env_wait_ms": 0.5689741329835659, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002491474151611328, "StateBufferConnector_ms": 0.0018537044525146484, "ViewRequirementAgentConnector_ms": 0.05017518997192383}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1423680, "num_agent_steps_trained": 1423680, "num_env_steps_sampled": 1423680, "num_env_steps_trained": 1423680, "num_env_steps_sampled_this_iter": 43920, "num_env_steps_trained_this_iter": 43920, "num_env_steps_sampled_throughput_per_sec": 928.2021459178097, "num_env_steps_trained_throughput_per_sec": 928.2021459178097, "timesteps_total": 1423680, "num_steps_trained_this_iter": 43920, "agent_timesteps_total": 1423680, "timers": {"training_iteration_time_ms": 48575.317, "sample_time_ms": 47785.169, "load_time_ms": 14.029, "load_throughput": 3130612.211, "learn_time_ms": 775.216, "learn_throughput": 56655.183, "synch_weights_time_ms": 0.738}, "counters": {"num_env_steps_sampled": 1423680, "num_env_steps_trained": 1423680, "num_agent_steps_sampled": 1423680, "num_agent_steps_trained": 1423680}, "done": false, "episodes_total": 1223, "training_iteration": 344, "trial_id": "d8b7e_00000", "date": "2023-07-27_05-14-26", "timestamp": 1690424066, "time_this_iter_s": 47.31941103935242, "time_total_s": 4861.854403972626, "pid": 18921, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 366, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[1291920, 5e-05], [1731120, 8e-05], [2170320, 2.5e-05], [2609520, 2.5e-05], [3048720, 2.5e-05], [3487920, 2.5e-05], [3927120, 1e-05], [4366320, 1e-05], [4805520, 1e-05], [5244720, 5e-06], [5683920, 5e-06], [6123120, 5e-06], [6562320, 5e-06], [7001520, 1e-06], [7440720, 1e-06], [7879920, 1e-06], [8319120, 1e-06], [8758320, 5e-07], [9197520, 5e-07], [9636720, 2.5e-07], [10075920, 2.5e-07], [10515120, 1e-08], [10954320, 1e-08], [11393520, 5e-09], [11832720, 5e-09], [12271920, 1e-09]], "grad_clip": 0.5, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.1, "final_epsilon": 0.01, "epsilon_timesteps": 1387080}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 43920, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x16b7b79d0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 194.30964612960815, "iterations_since_restore": 4, "perf": {"cpu_util_percent": 33.883582089552235, "ram_util_percent": 66.83283582089553}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 5.900000000000002e-05, "entropy_coeff": 0.049999999999999996, "policy_entropy": -1645.0338042234193, "policy_loss": -3.3365896659175006e+19, "vf_loss": 303993203.8367347}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 3087.5, "diff_num_grad_updates_vs_sampler_policy": 3086.5}}, "num_env_steps_sampled": 1467600, "num_env_steps_trained": 1467600, "num_agent_steps_sampled": 1467600, "num_agent_steps_trained": 1467600}, "sampler_results": {"episode_reward_max": -1351385.668151872, "episode_reward_min": -1369366.2314788997, "episode_reward_mean": -1358142.4725096677, "episode_len_mean": 43920.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1369366.2314788997, -1361335.2082701626, -1354747.2510403998, -1351385.668151872, -1353878.0036070035], "episode_lengths": [43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1608820686106027, "mean_inference_ms": 0.2949554659784098, "mean_action_processing_ms": 0.0672060319206405, "mean_env_wait_ms": 0.5608087535034998, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002918243408203125, "StateBufferConnector_ms": 0.0017976760864257812, "ViewRequirementAgentConnector_ms": 0.049118995666503906}}, "episode_reward_max": -1351385.668151872, "episode_reward_min": -1369366.2314788997, "episode_reward_mean": -1358142.4725096677, "episode_len_mean": 43920.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1369366.2314788997, -1361335.2082701626, -1354747.2510403998, -1351385.668151872, -1353878.0036070035], "episode_lengths": [43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1608820686106027, "mean_inference_ms": 0.2949554659784098, "mean_action_processing_ms": 0.0672060319206405, "mean_env_wait_ms": 0.5608087535034998, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002918243408203125, "StateBufferConnector_ms": 0.0017976760864257812, "ViewRequirementAgentConnector_ms": 0.049118995666503906}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1467600, "num_agent_steps_trained": 1467600, "num_env_steps_sampled": 1467600, "num_env_steps_trained": 1467600, "num_env_steps_sampled_this_iter": 43920, "num_env_steps_trained_this_iter": 43920, "num_env_steps_sampled_throughput_per_sec": 1102.5875912234442, "num_env_steps_trained_throughput_per_sec": 1102.5875912234442, "timesteps_total": 1467600, "num_steps_trained_this_iter": 43920, "agent_timesteps_total": 1467600, "timers": {"training_iteration_time_ms": 46826.964, "sample_time_ms": 46048.2, "load_time_ms": 13.87, "load_throughput": 3166600.744, "learn_time_ms": 764.013, "learn_throughput": 57485.94, "synch_weights_time_ms": 0.727}, "counters": {"num_env_steps_sampled": 1467600, "num_env_steps_trained": 1467600, "num_agent_steps_sampled": 1467600, "num_agent_steps_trained": 1467600}, "done": false, "episodes_total": 1224, "training_iteration": 345, "trial_id": "d8b7e_00000", "date": "2023-07-27_05-15-06", "timestamp": 1690424106, "time_this_iter_s": 39.83544325828552, "time_total_s": 4901.689847230911, "pid": 18921, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 366, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[1291920, 5e-05], [1731120, 8e-05], [2170320, 2.5e-05], [2609520, 2.5e-05], [3048720, 2.5e-05], [3487920, 2.5e-05], [3927120, 1e-05], [4366320, 1e-05], [4805520, 1e-05], [5244720, 5e-06], [5683920, 5e-06], [6123120, 5e-06], [6562320, 5e-06], [7001520, 1e-06], [7440720, 1e-06], [7879920, 1e-06], [8319120, 1e-06], [8758320, 5e-07], [9197520, 5e-07], [9636720, 2.5e-07], [10075920, 2.5e-07], [10515120, 1e-08], [10954320, 1e-08], [11393520, 5e-09], [11832720, 5e-09], [12271920, 1e-09]], "grad_clip": 0.5, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.1, "final_epsilon": 0.01, "epsilon_timesteps": 1387080}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 43920, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x16b7b79d0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 234.14508938789368, "iterations_since_restore": 5, "perf": {"cpu_util_percent": 18.232142857142858, "ram_util_percent": 68.14107142857144}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 6.2e-05, "entropy_coeff": 0.049999999999999996, "policy_entropy": -1652.7494919668482, "policy_loss": -4.019913186185829e+19, "vf_loss": 303992275.16618073}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 3773.5, "diff_num_grad_updates_vs_sampler_policy": 3772.5}}, "num_env_steps_sampled": 1511520, "num_env_steps_trained": 1511520, "num_agent_steps_sampled": 1511520, "num_agent_steps_trained": 1511520}, "sampler_results": {"episode_reward_max": -1351385.668151872, "episode_reward_min": -1369366.2314788997, "episode_reward_mean": -1357441.1344291086, "episode_len_mean": 43920.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1369366.2314788997, -1361335.2082701626, -1354747.2510403998, -1351385.668151872, -1353878.0036070035, -1353934.4440263135], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15950858399936674, "mean_inference_ms": 0.2917234663658849, "mean_action_processing_ms": 0.06669817253911951, "mean_env_wait_ms": 0.5529748856979517, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0027259190877278647, "StateBufferConnector_ms": 0.0017325083414713542, "ViewRequirementAgentConnector_ms": 0.048057238260904946}}, "episode_reward_max": -1351385.668151872, "episode_reward_min": -1369366.2314788997, "episode_reward_mean": -1357441.1344291086, "episode_len_mean": 43920.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1369366.2314788997, -1361335.2082701626, -1354747.2510403998, -1351385.668151872, -1353878.0036070035, -1353934.4440263135], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15950858399936674, "mean_inference_ms": 0.2917234663658849, "mean_action_processing_ms": 0.06669817253911951, "mean_env_wait_ms": 0.5529748856979517, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0027259190877278647, "StateBufferConnector_ms": 0.0017325083414713542, "ViewRequirementAgentConnector_ms": 0.048057238260904946}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1511520, "num_agent_steps_trained": 1511520, "num_env_steps_sampled": 1511520, "num_env_steps_trained": 1511520, "num_env_steps_sampled_this_iter": 43920, "num_env_steps_trained_this_iter": 43920, "num_env_steps_sampled_throughput_per_sec": 1116.5538621598469, "num_env_steps_trained_throughput_per_sec": 1116.5538621598469, "timesteps_total": 1511520, "num_steps_trained_this_iter": 43920, "agent_timesteps_total": 1511520, "timers": {"training_iteration_time_ms": 45578.354, "sample_time_ms": 44809.375, "load_time_ms": 13.479, "load_throughput": 3258412.926, "learn_time_ms": 754.639, "learn_throughput": 58199.996, "synch_weights_time_ms": 0.713}, "counters": {"num_env_steps_sampled": 1511520, "num_env_steps_trained": 1511520, "num_agent_steps_sampled": 1511520, "num_agent_steps_trained": 1511520}, "done": false, "episodes_total": 1225, "training_iteration": 346, "trial_id": "d8b7e_00000", "date": "2023-07-27_05-15-45", "timestamp": 1690424145, "time_this_iter_s": 39.337522983551025, "time_total_s": 4941.027370214462, "pid": 18921, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 366, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[1291920, 5e-05], [1731120, 8e-05], [2170320, 2.5e-05], [2609520, 2.5e-05], [3048720, 2.5e-05], [3487920, 2.5e-05], [3927120, 1e-05], [4366320, 1e-05], [4805520, 1e-05], [5244720, 5e-06], [5683920, 5e-06], [6123120, 5e-06], [6562320, 5e-06], [7001520, 1e-06], [7440720, 1e-06], [7879920, 1e-06], [8319120, 1e-06], [8758320, 5e-07], [9197520, 5e-07], [9636720, 2.5e-07], [10075920, 2.5e-07], [10515120, 1e-08], [10954320, 1e-08], [11393520, 5e-09], [11832720, 5e-09], [12271920, 1e-09]], "grad_clip": 0.5, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.1, "final_epsilon": 0.01, "epsilon_timesteps": 1387080}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 43920, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x16b7b79d0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 273.4826123714447, "iterations_since_restore": 6, "perf": {"cpu_util_percent": 20.348214285714285, "ram_util_percent": 68.48392857142856}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 6.5e-05, "entropy_coeff": 0.049999999999999996, "policy_entropy": -1652.5475830434016, "policy_loss": -3.676962480550141e+19, "vf_loss": 301874423.0670554}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 4459.5, "diff_num_grad_updates_vs_sampler_policy": 4458.5}}, "num_env_steps_sampled": 1555440, "num_env_steps_trained": 1555440, "num_agent_steps_sampled": 1555440, "num_agent_steps_trained": 1555440}, "sampler_results": {"episode_reward_max": -1349299.1822382265, "episode_reward_min": -1369366.2314788997, "episode_reward_mean": -1356277.9984018398, "episode_len_mean": 43920.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1369366.2314788997, -1361335.2082701626, -1354747.2510403998, -1351385.668151872, -1353878.0036070035, -1353934.4440263135, -1349299.1822382265], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1581603187195078, "mean_inference_ms": 0.28852596793942065, "mean_action_processing_ms": 0.06618046572289575, "mean_env_wait_ms": 0.5458561583580298, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0026328223092215402, "StateBufferConnector_ms": 0.0017302376883370535, "ViewRequirementAgentConnector_ms": 0.0472954341343471}}, "episode_reward_max": -1349299.1822382265, "episode_reward_min": -1369366.2314788997, "episode_reward_mean": -1356277.9984018398, "episode_len_mean": 43920.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1369366.2314788997, -1361335.2082701626, -1354747.2510403998, -1351385.668151872, -1353878.0036070035, -1353934.4440263135, -1349299.1822382265], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1581603187195078, "mean_inference_ms": 0.28852596793942065, "mean_action_processing_ms": 0.06618046572289575, "mean_env_wait_ms": 0.5458561583580298, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0026328223092215402, "StateBufferConnector_ms": 0.0017302376883370535, "ViewRequirementAgentConnector_ms": 0.0472954341343471}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1555440, "num_agent_steps_trained": 1555440, "num_env_steps_sampled": 1555440, "num_env_steps_trained": 1555440, "num_env_steps_sampled_this_iter": 43920, "num_env_steps_trained_this_iter": 43920, "num_env_steps_sampled_throughput_per_sec": 1121.484076904142, "num_env_steps_trained_throughput_per_sec": 1121.484076904142, "timesteps_total": 1555440, "num_steps_trained_this_iter": 43920, "agent_timesteps_total": 1555440, "timers": {"training_iteration_time_ms": 44661.786, "sample_time_ms": 43897.731, "load_time_ms": 13.187, "load_throughput": 3330595.897, "learn_time_ms": 750.006, "learn_throughput": 58559.508, "synch_weights_time_ms": 0.717}, "counters": {"num_env_steps_sampled": 1555440, "num_env_steps_trained": 1555440, "num_agent_steps_sampled": 1555440, "num_agent_steps_trained": 1555440}, "done": false, "episodes_total": 1226, "training_iteration": 347, "trial_id": "d8b7e_00000", "date": "2023-07-27_05-16-24", "timestamp": 1690424184, "time_this_iter_s": 39.16444730758667, "time_total_s": 4980.191817522049, "pid": 18921, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 366, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[1291920, 5e-05], [1731120, 8e-05], [2170320, 2.5e-05], [2609520, 2.5e-05], [3048720, 2.5e-05], [3487920, 2.5e-05], [3927120, 1e-05], [4366320, 1e-05], [4805520, 1e-05], [5244720, 5e-06], [5683920, 5e-06], [6123120, 5e-06], [6562320, 5e-06], [7001520, 1e-06], [7440720, 1e-06], [7879920, 1e-06], [8319120, 1e-06], [8758320, 5e-07], [9197520, 5e-07], [9636720, 2.5e-07], [10075920, 2.5e-07], [10515120, 1e-08], [10954320, 1e-08], [11393520, 5e-09], [11832720, 5e-09], [12271920, 1e-09]], "grad_clip": 0.5, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.1, "final_epsilon": 0.01, "epsilon_timesteps": 1387080}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 43920, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x16b7b79d0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 312.6470596790314, "iterations_since_restore": 7, "perf": {"cpu_util_percent": 18.958928571428572, "ram_util_percent": 68.43214285714285}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 6.800000000000003e-05, "entropy_coeff": 0.049999999999999996, "policy_entropy": -1651.9653396828876, "policy_loss": -3.676117156315197e+19, "vf_loss": 303529786.96209913}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 5145.5, "diff_num_grad_updates_vs_sampler_policy": 5144.5}}, "num_env_steps_sampled": 1599360, "num_env_steps_trained": 1599360, "num_agent_steps_sampled": 1599360, "num_agent_steps_trained": 1599360}, "sampler_results": {"episode_reward_max": -1349299.1822382265, "episode_reward_min": -1369366.2314788997, "episode_reward_mean": -1355849.370750701, "episode_len_mean": 43920.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1369366.2314788997, -1361335.2082701626, -1354747.2510403998, -1351385.668151872, -1353878.0036070035, -1353934.4440263135, -1349299.1822382265, -1352848.977192731], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15691027948672961, "mean_inference_ms": 0.2855494732018402, "mean_action_processing_ms": 0.06569020916348633, "mean_env_wait_ms": 0.5395581702823181, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002524256706237793, "StateBufferConnector_ms": 0.0016987323760986328, "ViewRequirementAgentConnector_ms": 0.04677772521972656}}, "episode_reward_max": -1349299.1822382265, "episode_reward_min": -1369366.2314788997, "episode_reward_mean": -1355849.370750701, "episode_len_mean": 43920.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1369366.2314788997, -1361335.2082701626, -1354747.2510403998, -1351385.668151872, -1353878.0036070035, -1353934.4440263135, -1349299.1822382265, -1352848.977192731], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15691027948672961, "mean_inference_ms": 0.2855494732018402, "mean_action_processing_ms": 0.06569020916348633, "mean_env_wait_ms": 0.5395581702823181, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002524256706237793, "StateBufferConnector_ms": 0.0016987323760986328, "ViewRequirementAgentConnector_ms": 0.04677772521972656}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1599360, "num_agent_steps_trained": 1599360, "num_env_steps_sampled": 1599360, "num_env_steps_trained": 1599360, "num_env_steps_sampled_this_iter": 43920, "num_env_steps_trained_this_iter": 43920, "num_env_steps_sampled_throughput_per_sec": 1116.1647232912762, "num_env_steps_trained_throughput_per_sec": 1116.1647232912762, "timesteps_total": 1599360, "num_steps_trained_this_iter": 43920, "agent_timesteps_total": 1599360, "timers": {"training_iteration_time_ms": 43997.69, "sample_time_ms": 43231.171, "load_time_ms": 13.39, "load_throughput": 3280036.709, "learn_time_ms": 752.279, "learn_throughput": 58382.594, "synch_weights_time_ms": 0.708}, "counters": {"num_env_steps_sampled": 1599360, "num_env_steps_trained": 1599360, "num_agent_steps_sampled": 1599360, "num_agent_steps_trained": 1599360}, "done": false, "episodes_total": 1227, "training_iteration": 348, "trial_id": "d8b7e_00000", "date": "2023-07-27_05-17-03", "timestamp": 1690424223, "time_this_iter_s": 39.35096311569214, "time_total_s": 5019.542780637741, "pid": 18921, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 366, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[1291920, 5e-05], [1731120, 8e-05], [2170320, 2.5e-05], [2609520, 2.5e-05], [3048720, 2.5e-05], [3487920, 2.5e-05], [3927120, 1e-05], [4366320, 1e-05], [4805520, 1e-05], [5244720, 5e-06], [5683920, 5e-06], [6123120, 5e-06], [6562320, 5e-06], [7001520, 1e-06], [7440720, 1e-06], [7879920, 1e-06], [8319120, 1e-06], [8758320, 5e-07], [9197520, 5e-07], [9636720, 2.5e-07], [10075920, 2.5e-07], [10515120, 1e-08], [10954320, 1e-08], [11393520, 5e-09], [11832720, 5e-09], [12271920, 1e-09]], "grad_clip": 0.5, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.1, "final_epsilon": 0.01, "epsilon_timesteps": 1387080}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 43920, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x16b7b79d0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 351.9980227947235, "iterations_since_restore": 8, "perf": {"cpu_util_percent": 18.62857142857143, "ram_util_percent": 68.64285714285714}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 7.1e-05, "entropy_coeff": 0.049999999999999996, "policy_entropy": -1650.4429461865661, "policy_loss": -3.7241039782083265e+19, "vf_loss": 304380075.88921285}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 5831.5, "diff_num_grad_updates_vs_sampler_policy": 5830.5}}, "num_env_steps_sampled": 1643280, "num_env_steps_trained": 1643280, "num_agent_steps_sampled": 1643280, "num_agent_steps_trained": 1643280}, "sampler_results": {"episode_reward_max": -1349299.1822382265, "episode_reward_min": -1369366.2314788997, "episode_reward_mean": -1355741.8700912385, "episode_len_mean": 43920.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1369366.2314788997, -1361335.2082701626, -1354747.2510403998, -1351385.668151872, -1353878.0036070035, -1353934.4440263135, -1349299.1822382265, -1352848.977192731, -1354881.8648155385], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1557562351078613, "mean_inference_ms": 0.282845897179783, "mean_action_processing_ms": 0.06523921471125727, "mean_env_wait_ms": 0.5340154244349095, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0024504131740993923, "StateBufferConnector_ms": 0.001690122816297743, "ViewRequirementAgentConnector_ms": 0.04632208082411024}}, "episode_reward_max": -1349299.1822382265, "episode_reward_min": -1369366.2314788997, "episode_reward_mean": -1355741.8700912385, "episode_len_mean": 43920.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1369366.2314788997, -1361335.2082701626, -1354747.2510403998, -1351385.668151872, -1353878.0036070035, -1353934.4440263135, -1349299.1822382265, -1352848.977192731, -1354881.8648155385], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1557562351078613, "mean_inference_ms": 0.282845897179783, "mean_action_processing_ms": 0.06523921471125727, "mean_env_wait_ms": 0.5340154244349095, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0024504131740993923, "StateBufferConnector_ms": 0.001690122816297743, "ViewRequirementAgentConnector_ms": 0.04632208082411024}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1643280, "num_agent_steps_trained": 1643280, "num_env_steps_sampled": 1643280, "num_env_steps_trained": 1643280, "num_env_steps_sampled_this_iter": 43920, "num_env_steps_trained_this_iter": 43920, "num_env_steps_sampled_throughput_per_sec": 1116.2873823512655, "num_env_steps_trained_throughput_per_sec": 1116.2873823512655, "timesteps_total": 1643280, "num_steps_trained_this_iter": 43920, "agent_timesteps_total": 1643280, "timers": {"training_iteration_time_ms": 43480.688, "sample_time_ms": 42718.393, "load_time_ms": 13.219, "load_throughput": 3322513.933, "learn_time_ms": 748.224, "learn_throughput": 58699.025, "synch_weights_time_ms": 0.711}, "counters": {"num_env_steps_sampled": 1643280, "num_env_steps_trained": 1643280, "num_agent_steps_sampled": 1643280, "num_agent_steps_trained": 1643280}, "done": false, "episodes_total": 1228, "training_iteration": 349, "trial_id": "d8b7e_00000", "date": "2023-07-27_05-17-43", "timestamp": 1690424263, "time_this_iter_s": 39.34677577018738, "time_total_s": 5058.8895564079285, "pid": 18921, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 366, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[1291920, 5e-05], [1731120, 8e-05], [2170320, 2.5e-05], [2609520, 2.5e-05], [3048720, 2.5e-05], [3487920, 2.5e-05], [3927120, 1e-05], [4366320, 1e-05], [4805520, 1e-05], [5244720, 5e-06], [5683920, 5e-06], [6123120, 5e-06], [6562320, 5e-06], [7001520, 1e-06], [7440720, 1e-06], [7879920, 1e-06], [8319120, 1e-06], [8758320, 5e-07], [9197520, 5e-07], [9636720, 2.5e-07], [10075920, 2.5e-07], [10515120, 1e-08], [10954320, 1e-08], [11393520, 5e-09], [11832720, 5e-09], [12271920, 1e-09]], "grad_clip": 0.5, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.1, "final_epsilon": 0.01, "epsilon_timesteps": 1387080}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 43920, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x16b7b79d0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 391.3447985649109, "iterations_since_restore": 9, "perf": {"cpu_util_percent": 17.759999999999998, "ram_util_percent": 68.81272727272727}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 7.400000000000002e-05, "entropy_coeff": 0.049999999999999996, "policy_entropy": -1643.9653834573728, "policy_loss": -2.9983498628461752e+19, "vf_loss": 302280103.5685131}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 6517.5, "diff_num_grad_updates_vs_sampler_policy": 6516.5}}, "num_env_steps_sampled": 1687200, "num_env_steps_trained": 1687200, "num_agent_steps_sampled": 1687200, "num_agent_steps_trained": 1687200}, "sampler_results": {"episode_reward_max": -1349299.1822382265, "episode_reward_min": -1369366.2314788997, "episode_reward_mean": -1355197.0212223718, "episode_len_mean": 43920.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1369366.2314788997, -1361335.2082701626, -1354747.2510403998, -1351385.668151872, -1353878.0036070035, -1353934.4440263135, -1349299.1822382265, -1352848.977192731, -1354881.8648155385, -1350293.381402571], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15471066409771414, "mean_inference_ms": 0.2803972900815625, "mean_action_processing_ms": 0.0648299350944414, "mean_env_wait_ms": 0.5290905499808466, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0025916099548339844, "StateBufferConnector_ms": 0.001697540283203125, "ViewRequirementAgentConnector_ms": 0.046057701110839844}}, "episode_reward_max": -1349299.1822382265, "episode_reward_min": -1369366.2314788997, "episode_reward_mean": -1355197.0212223718, "episode_len_mean": 43920.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1369366.2314788997, -1361335.2082701626, -1354747.2510403998, -1351385.668151872, -1353878.0036070035, -1353934.4440263135, -1349299.1822382265, -1352848.977192731, -1354881.8648155385, -1350293.381402571], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15471066409771414, "mean_inference_ms": 0.2803972900815625, "mean_action_processing_ms": 0.0648299350944414, "mean_env_wait_ms": 0.5290905499808466, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0025916099548339844, "StateBufferConnector_ms": 0.001697540283203125, "ViewRequirementAgentConnector_ms": 0.046057701110839844}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1687200, "num_agent_steps_trained": 1687200, "num_env_steps_sampled": 1687200, "num_env_steps_trained": 1687200, "num_env_steps_sampled_this_iter": 43920, "num_env_steps_trained_this_iter": 43920, "num_env_steps_sampled_throughput_per_sec": 1119.277724649833, "num_env_steps_trained_throughput_per_sec": 1119.277724649833, "timesteps_total": 1687200, "num_steps_trained_this_iter": 43920, "agent_timesteps_total": 1687200, "timers": {"training_iteration_time_ms": 43056.577, "sample_time_ms": 42297.656, "load_time_ms": 13.112, "load_throughput": 3349579.91, "learn_time_ms": 744.953, "learn_throughput": 58956.773, "synch_weights_time_ms": 0.717}, "counters": {"num_env_steps_sampled": 1687200, "num_env_steps_trained": 1687200, "num_agent_steps_sampled": 1687200, "num_agent_steps_trained": 1687200}, "done": false, "episodes_total": 1229, "training_iteration": 350, "trial_id": "d8b7e_00000", "date": "2023-07-27_05-18-22", "timestamp": 1690424302, "time_this_iter_s": 39.24151682853699, "time_total_s": 5098.131073236465, "pid": 18921, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 366, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[1291920, 5e-05], [1731120, 8e-05], [2170320, 2.5e-05], [2609520, 2.5e-05], [3048720, 2.5e-05], [3487920, 2.5e-05], [3927120, 1e-05], [4366320, 1e-05], [4805520, 1e-05], [5244720, 5e-06], [5683920, 5e-06], [6123120, 5e-06], [6562320, 5e-06], [7001520, 1e-06], [7440720, 1e-06], [7879920, 1e-06], [8319120, 1e-06], [8758320, 5e-07], [9197520, 5e-07], [9636720, 2.5e-07], [10075920, 2.5e-07], [10515120, 1e-08], [10954320, 1e-08], [11393520, 5e-09], [11832720, 5e-09], [12271920, 1e-09]], "grad_clip": 0.5, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.1, "final_epsilon": 0.01, "epsilon_timesteps": 1387080}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 43920, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x16b7b79d0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 430.5863153934479, "iterations_since_restore": 10, "perf": {"cpu_util_percent": 17.839285714285715, "ram_util_percent": 68.58571428571427}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 7.700000000000001e-05, "entropy_coeff": 0.049999999999999996, "policy_entropy": -1631.7250485434129, "policy_loss": -2.3272070105552863e+19, "vf_loss": 303085741.4460641}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 7203.5, "diff_num_grad_updates_vs_sampler_policy": 7202.5}}, "num_env_steps_sampled": 1731120, "num_env_steps_trained": 1731120, "num_agent_steps_sampled": 1731120, "num_agent_steps_trained": 1731120}, "sampler_results": {"episode_reward_max": -1349299.1822382265, "episode_reward_min": -1369366.2314788997, "episode_reward_mean": -1354904.8019858731, "episode_len_mean": 43920.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1369366.2314788997, -1361335.2082701626, -1354747.2510403998, -1351385.668151872, -1353878.0036070035, -1353934.4440263135, -1349299.1822382265, -1352848.977192731, -1354881.8648155385, -1350293.381402571, -1351982.609620888], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15377023807974552, "mean_inference_ms": 0.27818256105767075, "mean_action_processing_ms": 0.06446044595918886, "mean_env_wait_ms": 0.5246994868515052, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0025510787963867188, "StateBufferConnector_ms": 0.0016797672618519175, "ViewRequirementAgentConnector_ms": 0.045871734619140625}}, "episode_reward_max": -1349299.1822382265, "episode_reward_min": -1369366.2314788997, "episode_reward_mean": -1354904.8019858731, "episode_len_mean": 43920.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1369366.2314788997, -1361335.2082701626, -1354747.2510403998, -1351385.668151872, -1353878.0036070035, -1353934.4440263135, -1349299.1822382265, -1352848.977192731, -1354881.8648155385, -1350293.381402571, -1351982.609620888], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15377023807974552, "mean_inference_ms": 0.27818256105767075, "mean_action_processing_ms": 0.06446044595918886, "mean_env_wait_ms": 0.5246994868515052, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0025510787963867188, "StateBufferConnector_ms": 0.0016797672618519175, "ViewRequirementAgentConnector_ms": 0.045871734619140625}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1731120, "num_agent_steps_trained": 1731120, "num_env_steps_sampled": 1731120, "num_env_steps_trained": 1731120, "num_env_steps_sampled_this_iter": 43920, "num_env_steps_trained_this_iter": 43920, "num_env_steps_sampled_throughput_per_sec": 1117.2238472774334, "num_env_steps_trained_throughput_per_sec": 1117.2238472774334, "timesteps_total": 1731120, "num_steps_trained_this_iter": 43920, "agent_timesteps_total": 1731120, "timers": {"training_iteration_time_ms": 41851.6, "sample_time_ms": 41102.241, "load_time_ms": 14.289, "load_throughput": 3073755.101, "learn_time_ms": 734.229, "learn_throughput": 59817.835, "synch_weights_time_ms": 0.713}, "counters": {"num_env_steps_sampled": 1731120, "num_env_steps_trained": 1731120, "num_agent_steps_sampled": 1731120, "num_agent_steps_trained": 1731120}, "done": false, "episodes_total": 1230, "training_iteration": 351, "trial_id": "d8b7e_00000", "date": "2023-07-27_05-19-01", "timestamp": 1690424341, "time_this_iter_s": 39.313709020614624, "time_total_s": 5137.44478225708, "pid": 18921, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 366, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[1291920, 5e-05], [1731120, 8e-05], [2170320, 2.5e-05], [2609520, 2.5e-05], [3048720, 2.5e-05], [3487920, 2.5e-05], [3927120, 1e-05], [4366320, 1e-05], [4805520, 1e-05], [5244720, 5e-06], [5683920, 5e-06], [6123120, 5e-06], [6562320, 5e-06], [7001520, 1e-06], [7440720, 1e-06], [7879920, 1e-06], [8319120, 1e-06], [8758320, 5e-07], [9197520, 5e-07], [9636720, 2.5e-07], [10075920, 2.5e-07], [10515120, 1e-08], [10954320, 1e-08], [11393520, 5e-09], [11832720, 5e-09], [12271920, 1e-09]], "grad_clip": 0.5, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.1, "final_epsilon": 0.01, "epsilon_timesteps": 1387080}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 43920, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x16b7b79d0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 469.9000244140625, "iterations_since_restore": 11, "perf": {"cpu_util_percent": 19.014285714285712, "ram_util_percent": 68.6125}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 8e-05, "entropy_coeff": 0.049999999999999996, "policy_entropy": -1640.5717606169142, "policy_loss": -3.128555516803026e+19, "vf_loss": 304522084.3381924}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 7889.5, "diff_num_grad_updates_vs_sampler_policy": 7888.5}}, "num_env_steps_sampled": 1775040, "num_env_steps_trained": 1775040, "num_agent_steps_sampled": 1775040, "num_agent_steps_trained": 1775040}, "sampler_results": {"episode_reward_max": -1349299.1822382265, "episode_reward_min": -1369366.2314788997, "episode_reward_mean": -1354925.1443757433, "episode_len_mean": 43920.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1369366.2314788997, -1361335.2082701626, -1354747.2510403998, -1351385.668151872, -1353878.0036070035, -1353934.4440263135, -1349299.1822382265, -1352848.977192731, -1354881.8648155385, -1350293.381402571, -1351982.609620888, -1355148.9106643137], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15291575302874091, "mean_inference_ms": 0.27617001073819486, "mean_action_processing_ms": 0.06412466346240267, "mean_env_wait_ms": 0.5207152788625667, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0025451183319091797, "StateBufferConnector_ms": 0.0017046928405761719, "ViewRequirementAgentConnector_ms": 0.04573663075764974}}, "episode_reward_max": -1349299.1822382265, "episode_reward_min": -1369366.2314788997, "episode_reward_mean": -1354925.1443757433, "episode_len_mean": 43920.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1369366.2314788997, -1361335.2082701626, -1354747.2510403998, -1351385.668151872, -1353878.0036070035, -1353934.4440263135, -1349299.1822382265, -1352848.977192731, -1354881.8648155385, -1350293.381402571, -1351982.609620888, -1355148.9106643137], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15291575302874091, "mean_inference_ms": 0.27617001073819486, "mean_action_processing_ms": 0.06412466346240267, "mean_env_wait_ms": 0.5207152788625667, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0025451183319091797, "StateBufferConnector_ms": 0.0017046928405761719, "ViewRequirementAgentConnector_ms": 0.04573663075764974}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1775040, "num_agent_steps_trained": 1775040, "num_env_steps_sampled": 1775040, "num_env_steps_trained": 1775040, "num_env_steps_sampled_this_iter": 43920, "num_env_steps_trained_this_iter": 43920, "num_env_steps_sampled_throughput_per_sec": 1128.5551239159731, "num_env_steps_trained_throughput_per_sec": 1128.5551239159731, "timesteps_total": 1775040, "num_steps_trained_this_iter": 43920, "agent_timesteps_total": 1775040, "timers": {"training_iteration_time_ms": 40985.874, "sample_time_ms": 40242.909, "load_time_ms": 14.109, "load_throughput": 3112834.861, "learn_time_ms": 728.026, "learn_throughput": 60327.531, "synch_weights_time_ms": 0.705}, "counters": {"num_env_steps_sampled": 1775040, "num_env_steps_trained": 1775040, "num_agent_steps_sampled": 1775040, "num_agent_steps_trained": 1775040}, "done": false, "episodes_total": 1231, "training_iteration": 352, "trial_id": "d8b7e_00000", "date": "2023-07-27_05-19-40", "timestamp": 1690424380, "time_this_iter_s": 38.91895294189453, "time_total_s": 5176.363735198975, "pid": 18921, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 366, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[1291920, 5e-05], [1731120, 8e-05], [2170320, 2.5e-05], [2609520, 2.5e-05], [3048720, 2.5e-05], [3487920, 2.5e-05], [3927120, 1e-05], [4366320, 1e-05], [4805520, 1e-05], [5244720, 5e-06], [5683920, 5e-06], [6123120, 5e-06], [6562320, 5e-06], [7001520, 1e-06], [7440720, 1e-06], [7879920, 1e-06], [8319120, 1e-06], [8758320, 5e-07], [9197520, 5e-07], [9636720, 2.5e-07], [10075920, 2.5e-07], [10515120, 1e-08], [10954320, 1e-08], [11393520, 5e-09], [11832720, 5e-09], [12271920, 1e-09]], "grad_clip": 0.5, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.1, "final_epsilon": 0.01, "epsilon_timesteps": 1387080}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 43920, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x16b7b79d0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 508.81897735595703, "iterations_since_restore": 12, "perf": {"cpu_util_percent": 21.209090909090914, "ram_util_percent": 68.48545454545454}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 7.450000000000002e-05, "entropy_coeff": 0.049999999999999996, "policy_entropy": -1629.280537507972, "policy_loss": -2.5744963124387406e+19, "vf_loss": 303660010.66472304}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 8575.5, "diff_num_grad_updates_vs_sampler_policy": 8574.5}}, "num_env_steps_sampled": 1818960, "num_env_steps_trained": 1818960, "num_agent_steps_sampled": 1818960, "num_agent_steps_trained": 1818960}, "sampler_results": {"episode_reward_max": -1349299.1822382265, "episode_reward_min": -1369366.2314788997, "episode_reward_mean": -1354804.4225558245, "episode_len_mean": 43920.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1369366.2314788997, -1361335.2082701626, -1354747.2510403998, -1351385.668151872, -1353878.0036070035, -1353934.4440263135, -1349299.1822382265, -1352848.977192731, -1354881.8648155385, -1350293.381402571, -1351982.609620888, -1355148.9106643137, -1353355.7607168008], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1521433030008406, "mean_inference_ms": 0.27433792408184526, "mean_action_processing_ms": 0.06382003099595775, "mean_env_wait_ms": 0.5171394606776706, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0025199009821965145, "StateBufferConnector_ms": 0.001722115736741286, "ViewRequirementAgentConnector_ms": 0.04564982194166917}}, "episode_reward_max": -1349299.1822382265, "episode_reward_min": -1369366.2314788997, "episode_reward_mean": -1354804.4225558245, "episode_len_mean": 43920.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1369366.2314788997, -1361335.2082701626, -1354747.2510403998, -1351385.668151872, -1353878.0036070035, -1353934.4440263135, -1349299.1822382265, -1352848.977192731, -1354881.8648155385, -1350293.381402571, -1351982.609620888, -1355148.9106643137, -1353355.7607168008], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1521433030008406, "mean_inference_ms": 0.27433792408184526, "mean_action_processing_ms": 0.06382003099595775, "mean_env_wait_ms": 0.5171394606776706, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0025199009821965145, "StateBufferConnector_ms": 0.001722115736741286, "ViewRequirementAgentConnector_ms": 0.04564982194166917}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1818960, "num_agent_steps_trained": 1818960, "num_env_steps_sampled": 1818960, "num_env_steps_trained": 1818960, "num_env_steps_sampled_this_iter": 43920, "num_env_steps_trained_this_iter": 43920, "num_env_steps_sampled_throughput_per_sec": 1116.078888129611, "num_env_steps_trained_throughput_per_sec": 1116.078888129611, "timesteps_total": 1818960, "num_steps_trained_this_iter": 43920, "agent_timesteps_total": 1818960, "timers": {"training_iteration_time_ms": 40116.252, "sample_time_ms": 39381.639, "load_time_ms": 12.726, "load_throughput": 3451138.428, "learn_time_ms": 721.07, "learn_throughput": 60909.514, "synch_weights_time_ms": 0.699}, "counters": {"num_env_steps_sampled": 1818960, "num_env_steps_trained": 1818960, "num_agent_steps_sampled": 1818960, "num_agent_steps_trained": 1818960}, "done": false, "episodes_total": 1232, "training_iteration": 353, "trial_id": "d8b7e_00000", "date": "2023-07-27_05-20-20", "timestamp": 1690424420, "time_this_iter_s": 39.35409998893738, "time_total_s": 5215.717835187912, "pid": 18921, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 366, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[1291920, 5e-05], [1731120, 8e-05], [2170320, 2.5e-05], [2609520, 2.5e-05], [3048720, 2.5e-05], [3487920, 2.5e-05], [3927120, 1e-05], [4366320, 1e-05], [4805520, 1e-05], [5244720, 5e-06], [5683920, 5e-06], [6123120, 5e-06], [6562320, 5e-06], [7001520, 1e-06], [7440720, 1e-06], [7879920, 1e-06], [8319120, 1e-06], [8758320, 5e-07], [9197520, 5e-07], [9636720, 2.5e-07], [10075920, 2.5e-07], [10515120, 1e-08], [10954320, 1e-08], [11393520, 5e-09], [11832720, 5e-09], [12271920, 1e-09]], "grad_clip": 0.5, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.1, "final_epsilon": 0.01, "epsilon_timesteps": 1387080}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 43920, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x16b7b79d0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 548.1730773448944, "iterations_since_restore": 13, "perf": {"cpu_util_percent": 19.51818181818182, "ram_util_percent": 68.72363636363637}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 6.9e-05, "entropy_coeff": 0.049999999999999996, "policy_entropy": -1643.593953569151, "policy_loss": -3.0885003124974907e+19, "vf_loss": 302762291.47521865}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 9261.5, "diff_num_grad_updates_vs_sampler_policy": 9260.5}}, "num_env_steps_sampled": 1862880, "num_env_steps_trained": 1862880, "num_agent_steps_sampled": 1862880, "num_agent_steps_trained": 1862880}, "sampler_results": {"episode_reward_max": -1349299.1822382265, "episode_reward_min": -1369366.2314788997, "episode_reward_mean": -1354555.2542354066, "episode_len_mean": 43920.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1369366.2314788997, -1361335.2082701626, -1354747.2510403998, -1351385.668151872, -1353878.0036070035, -1353934.4440263135, -1349299.1822382265, -1352848.977192731, -1354881.8648155385, -1350293.381402571, -1351982.609620888, -1355148.9106643137, -1353355.7607168008, -1351316.0660699722], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15143941553655296, "mean_inference_ms": 0.27266014432702956, "mean_action_processing_ms": 0.06354075873090106, "mean_env_wait_ms": 0.5139031874016313, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0025033950805664062, "StateBufferConnector_ms": 0.0017149107796805246, "ViewRequirementAgentConnector_ms": 0.045740604400634766}}, "episode_reward_max": -1349299.1822382265, "episode_reward_min": -1369366.2314788997, "episode_reward_mean": -1354555.2542354066, "episode_len_mean": 43920.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1369366.2314788997, -1361335.2082701626, -1354747.2510403998, -1351385.668151872, -1353878.0036070035, -1353934.4440263135, -1349299.1822382265, -1352848.977192731, -1354881.8648155385, -1350293.381402571, -1351982.609620888, -1355148.9106643137, -1353355.7607168008, -1351316.0660699722], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15143941553655296, "mean_inference_ms": 0.27266014432702956, "mean_action_processing_ms": 0.06354075873090106, "mean_env_wait_ms": 0.5139031874016313, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0025033950805664062, "StateBufferConnector_ms": 0.0017149107796805246, "ViewRequirementAgentConnector_ms": 0.045740604400634766}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1862880, "num_agent_steps_trained": 1862880, "num_env_steps_sampled": 1862880, "num_env_steps_trained": 1862880, "num_env_steps_sampled_this_iter": 43920, "num_env_steps_trained_this_iter": 43920, "num_env_steps_sampled_throughput_per_sec": 1120.297308716391, "num_env_steps_trained_throughput_per_sec": 1120.297308716391, "timesteps_total": 1862880, "num_steps_trained_this_iter": 43920, "agent_timesteps_total": 1862880, "timers": {"training_iteration_time_ms": 39304.912, "sample_time_ms": 38570.69, "load_time_ms": 12.417, "load_throughput": 3537050.446, "learn_time_ms": 720.985, "learn_throughput": 60916.664, "synch_weights_time_ms": 0.702}, "counters": {"num_env_steps_sampled": 1862880, "num_env_steps_trained": 1862880, "num_agent_steps_sampled": 1862880, "num_agent_steps_trained": 1862880}, "done": false, "episodes_total": 1233, "training_iteration": 354, "trial_id": "d8b7e_00000", "date": "2023-07-27_05-20-59", "timestamp": 1690424459, "time_this_iter_s": 39.20580983161926, "time_total_s": 5254.923645019531, "pid": 18921, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 366, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[1291920, 5e-05], [1731120, 8e-05], [2170320, 2.5e-05], [2609520, 2.5e-05], [3048720, 2.5e-05], [3487920, 2.5e-05], [3927120, 1e-05], [4366320, 1e-05], [4805520, 1e-05], [5244720, 5e-06], [5683920, 5e-06], [6123120, 5e-06], [6562320, 5e-06], [7001520, 1e-06], [7440720, 1e-06], [7879920, 1e-06], [8319120, 1e-06], [8758320, 5e-07], [9197520, 5e-07], [9636720, 2.5e-07], [10075920, 2.5e-07], [10515120, 1e-08], [10954320, 1e-08], [11393520, 5e-09], [11832720, 5e-09], [12271920, 1e-09]], "grad_clip": 0.5, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.1, "final_epsilon": 0.01, "epsilon_timesteps": 1387080}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 43920, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x16b7b79d0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 587.3788871765137, "iterations_since_restore": 14, "perf": {"cpu_util_percent": 17.705357142857142, "ram_util_percent": 68.90892857142856}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 6.349999999999998e-05, "entropy_coeff": 0.049999999999999996, "policy_entropy": -1638.8733129028676, "policy_loss": -2.689260594267671e+19, "vf_loss": 301670328.909621}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 9947.5, "diff_num_grad_updates_vs_sampler_policy": 9946.5}}, "num_env_steps_sampled": 1906800, "num_env_steps_trained": 1906800, "num_agent_steps_sampled": 1906800, "num_agent_steps_trained": 1906800}, "sampler_results": {"episode_reward_max": -1348824.8954038802, "episode_reward_min": -1369366.2314788997, "episode_reward_mean": -1354173.2303133048, "episode_len_mean": 43920.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1369366.2314788997, -1361335.2082701626, -1354747.2510403998, -1351385.668151872, -1353878.0036070035, -1353934.4440263135, -1349299.1822382265, -1352848.977192731, -1354881.8648155385, -1350293.381402571, -1351982.609620888, -1355148.9106643137, -1353355.7607168008, -1351316.0660699722, -1348824.8954038802], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1507996874856498, "mean_inference_ms": 0.27112452548379373, "mean_action_processing_ms": 0.06328515148152312, "mean_env_wait_ms": 0.5109838617787482, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002495447794596354, "StateBufferConnector_ms": 0.0017213821411132812, "ViewRequirementAgentConnector_ms": 0.045598347981770836}}, "episode_reward_max": -1348824.8954038802, "episode_reward_min": -1369366.2314788997, "episode_reward_mean": -1354173.2303133048, "episode_len_mean": 43920.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1369366.2314788997, -1361335.2082701626, -1354747.2510403998, -1351385.668151872, -1353878.0036070035, -1353934.4440263135, -1349299.1822382265, -1352848.977192731, -1354881.8648155385, -1350293.381402571, -1351982.609620888, -1355148.9106643137, -1353355.7607168008, -1351316.0660699722, -1348824.8954038802], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1507996874856498, "mean_inference_ms": 0.27112452548379373, "mean_action_processing_ms": 0.06328515148152312, "mean_env_wait_ms": 0.5109838617787482, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002495447794596354, "StateBufferConnector_ms": 0.0017213821411132812, "ViewRequirementAgentConnector_ms": 0.045598347981770836}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1906800, "num_agent_steps_trained": 1906800, "num_env_steps_sampled": 1906800, "num_env_steps_trained": 1906800, "num_env_steps_sampled_this_iter": 43920, "num_env_steps_trained_this_iter": 43920, "num_env_steps_sampled_throughput_per_sec": 1110.6994068146832, "num_env_steps_trained_throughput_per_sec": 1110.6994068146832, "timesteps_total": 1906800, "num_steps_trained_this_iter": 43920, "agent_timesteps_total": 1906800, "timers": {"training_iteration_time_ms": 39275.821, "sample_time_ms": 38542.304, "load_time_ms": 12.411, "load_throughput": 3538762.711, "learn_time_ms": 720.286, "learn_throughput": 60975.788, "synch_weights_time_ms": 0.702}, "counters": {"num_env_steps_sampled": 1906800, "num_env_steps_trained": 1906800, "num_agent_steps_sampled": 1906800, "num_agent_steps_trained": 1906800}, "done": false, "episodes_total": 1234, "training_iteration": 355, "trial_id": "d8b7e_00000", "date": "2023-07-27_05-21-38", "timestamp": 1690424498, "time_this_iter_s": 39.54454684257507, "time_total_s": 5294.468191862106, "pid": 18921, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 366, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[1291920, 5e-05], [1731120, 8e-05], [2170320, 2.5e-05], [2609520, 2.5e-05], [3048720, 2.5e-05], [3487920, 2.5e-05], [3927120, 1e-05], [4366320, 1e-05], [4805520, 1e-05], [5244720, 5e-06], [5683920, 5e-06], [6123120, 5e-06], [6562320, 5e-06], [7001520, 1e-06], [7440720, 1e-06], [7879920, 1e-06], [8319120, 1e-06], [8758320, 5e-07], [9197520, 5e-07], [9636720, 2.5e-07], [10075920, 2.5e-07], [10515120, 1e-08], [10954320, 1e-08], [11393520, 5e-09], [11832720, 5e-09], [12271920, 1e-09]], "grad_clip": 0.5, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.1, "final_epsilon": 0.01, "epsilon_timesteps": 1387080}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 43920, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x16b7b79d0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 626.9234340190887, "iterations_since_restore": 15, "perf": {"cpu_util_percent": 17.775, "ram_util_percent": 68.50178571428572}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 5.7999999999999994e-05, "entropy_coeff": 0.049999999999999996, "policy_entropy": -1651.5560708449116, "policy_loss": -6.037748971356848e+19, "vf_loss": 303775610.851312}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 10633.5, "diff_num_grad_updates_vs_sampler_policy": 10632.5}}, "num_env_steps_sampled": 1950720, "num_env_steps_trained": 1950720, "num_agent_steps_sampled": 1950720, "num_agent_steps_trained": 1950720}, "sampler_results": {"episode_reward_max": -1348824.8954038802, "episode_reward_min": -1369366.2314788997, "episode_reward_mean": -1354128.900575296, "episode_len_mean": 43920.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1369366.2314788997, -1361335.2082701626, -1354747.2510403998, -1351385.668151872, -1353878.0036070035, -1353934.4440263135, -1349299.1822382265, -1352848.977192731, -1354881.8648155385, -1350293.381402571, -1351982.609620888, -1355148.9106643137, -1353355.7607168008, -1351316.0660699722, -1348824.8954038802, -1353463.9545051646], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15021594284446374, "mean_inference_ms": 0.2697191883221606, "mean_action_processing_ms": 0.06305088509975842, "mean_env_wait_ms": 0.5083476943452918, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0024557113647460938, "StateBufferConnector_ms": 0.0017270445823669434, "ViewRequirementAgentConnector_ms": 0.04552900791168213}}, "episode_reward_max": -1348824.8954038802, "episode_reward_min": -1369366.2314788997, "episode_reward_mean": -1354128.900575296, "episode_len_mean": 43920.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1369366.2314788997, -1361335.2082701626, -1354747.2510403998, -1351385.668151872, -1353878.0036070035, -1353934.4440263135, -1349299.1822382265, -1352848.977192731, -1354881.8648155385, -1350293.381402571, -1351982.609620888, -1355148.9106643137, -1353355.7607168008, -1351316.0660699722, -1348824.8954038802, -1353463.9545051646], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15021594284446374, "mean_inference_ms": 0.2697191883221606, "mean_action_processing_ms": 0.06305088509975842, "mean_env_wait_ms": 0.5083476943452918, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0024557113647460938, "StateBufferConnector_ms": 0.0017270445823669434, "ViewRequirementAgentConnector_ms": 0.04552900791168213}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1950720, "num_agent_steps_trained": 1950720, "num_env_steps_sampled": 1950720, "num_env_steps_trained": 1950720, "num_env_steps_sampled_this_iter": 43920, "num_env_steps_trained_this_iter": 43920, "num_env_steps_sampled_throughput_per_sec": 1104.4108258067522, "num_env_steps_trained_throughput_per_sec": 1104.4108258067522, "timesteps_total": 1950720, "num_steps_trained_this_iter": 43920, "agent_timesteps_total": 1950720, "timers": {"training_iteration_time_ms": 39319.07, "sample_time_ms": 38583.577, "load_time_ms": 12.652, "load_throughput": 3471409.786, "learn_time_ms": 722.019, "learn_throughput": 60829.398, "synch_weights_time_ms": 0.703}, "counters": {"num_env_steps_sampled": 1950720, "num_env_steps_trained": 1950720, "num_agent_steps_sampled": 1950720, "num_agent_steps_trained": 1950720}, "done": false, "episodes_total": 1235, "training_iteration": 356, "trial_id": "d8b7e_00000", "date": "2023-07-27_05-22-18", "timestamp": 1690424538, "time_this_iter_s": 39.769757986068726, "time_total_s": 5334.237949848175, "pid": 18921, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 366, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[1291920, 5e-05], [1731120, 8e-05], [2170320, 2.5e-05], [2609520, 2.5e-05], [3048720, 2.5e-05], [3487920, 2.5e-05], [3927120, 1e-05], [4366320, 1e-05], [4805520, 1e-05], [5244720, 5e-06], [5683920, 5e-06], [6123120, 5e-06], [6562320, 5e-06], [7001520, 1e-06], [7440720, 1e-06], [7879920, 1e-06], [8319120, 1e-06], [8758320, 5e-07], [9197520, 5e-07], [9636720, 2.5e-07], [10075920, 2.5e-07], [10515120, 1e-08], [10954320, 1e-08], [11393520, 5e-09], [11832720, 5e-09], [12271920, 1e-09]], "grad_clip": 0.5, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.1, "final_epsilon": 0.01, "epsilon_timesteps": 1387080}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 43920, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x16b7b79d0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 666.6931920051575, "iterations_since_restore": 16, "perf": {"cpu_util_percent": 18.8375, "ram_util_percent": 68.5125}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 5.250000000000001e-05, "entropy_coeff": 0.049999999999999996, "policy_entropy": -1636.6456832663312, "policy_loss": -3.6270112798904574e+19, "vf_loss": 302305284.1924198}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 11319.5, "diff_num_grad_updates_vs_sampler_policy": 11318.5}}, "num_env_steps_sampled": 1994640, "num_env_steps_trained": 1994640, "num_agent_steps_sampled": 1994640, "num_agent_steps_trained": 1994640}, "sampler_results": {"episode_reward_max": -1348824.8954038802, "episode_reward_min": -1369366.2314788997, "episode_reward_mean": -1353897.8581623326, "episode_len_mean": 43920.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1369366.2314788997, -1361335.2082701626, -1354747.2510403998, -1351385.668151872, -1353878.0036070035, -1353934.4440263135, -1349299.1822382265, -1352848.977192731, -1354881.8648155385, -1350293.381402571, -1351982.609620888, -1355148.9106643137, -1353355.7607168008, -1351316.0660699722, -1348824.8954038802, -1353463.9545051646, -1350201.1795549188], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.14967699499103027, "mean_inference_ms": 0.26842289471168057, "mean_action_processing_ms": 0.06283445277366057, "mean_env_wait_ms": 0.5059151097275132, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0024430892046760112, "StateBufferConnector_ms": 0.0017208211562212777, "ViewRequirementAgentConnector_ms": 0.04546782549689798}}, "episode_reward_max": -1348824.8954038802, "episode_reward_min": -1369366.2314788997, "episode_reward_mean": -1353897.8581623326, "episode_len_mean": 43920.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1369366.2314788997, -1361335.2082701626, -1354747.2510403998, -1351385.668151872, -1353878.0036070035, -1353934.4440263135, -1349299.1822382265, -1352848.977192731, -1354881.8648155385, -1350293.381402571, -1351982.609620888, -1355148.9106643137, -1353355.7607168008, -1351316.0660699722, -1348824.8954038802, -1353463.9545051646, -1350201.1795549188], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.14967699499103027, "mean_inference_ms": 0.26842289471168057, "mean_action_processing_ms": 0.06283445277366057, "mean_env_wait_ms": 0.5059151097275132, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0024430892046760112, "StateBufferConnector_ms": 0.0017208211562212777, "ViewRequirementAgentConnector_ms": 0.04546782549689798}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1994640, "num_agent_steps_trained": 1994640, "num_env_steps_sampled": 1994640, "num_env_steps_trained": 1994640, "num_env_steps_sampled_this_iter": 43920, "num_env_steps_trained_this_iter": 43920, "num_env_steps_sampled_throughput_per_sec": 1122.1437110358459, "num_env_steps_trained_throughput_per_sec": 1122.1437110358459, "timesteps_total": 1994640, "num_steps_trained_this_iter": 43920, "agent_timesteps_total": 1994640, "timers": {"training_iteration_time_ms": 39316.768, "sample_time_ms": 38580.801, "load_time_ms": 12.833, "load_throughput": 3422471.271, "learn_time_ms": 722.322, "learn_throughput": 60803.921, "synch_weights_time_ms": 0.695}, "counters": {"num_env_steps_sampled": 1994640, "num_env_steps_trained": 1994640, "num_agent_steps_sampled": 1994640, "num_agent_steps_trained": 1994640}, "done": false, "episodes_total": 1236, "training_iteration": 357, "trial_id": "d8b7e_00000", "date": "2023-07-27_05-22-57", "timestamp": 1690424577, "time_this_iter_s": 39.14162611961365, "time_total_s": 5373.379575967789, "pid": 18921, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 366, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[1291920, 5e-05], [1731120, 8e-05], [2170320, 2.5e-05], [2609520, 2.5e-05], [3048720, 2.5e-05], [3487920, 2.5e-05], [3927120, 1e-05], [4366320, 1e-05], [4805520, 1e-05], [5244720, 5e-06], [5683920, 5e-06], [6123120, 5e-06], [6562320, 5e-06], [7001520, 1e-06], [7440720, 1e-06], [7879920, 1e-06], [8319120, 1e-06], [8758320, 5e-07], [9197520, 5e-07], [9636720, 2.5e-07], [10075920, 2.5e-07], [10515120, 1e-08], [10954320, 1e-08], [11393520, 5e-09], [11832720, 5e-09], [12271920, 1e-09]], "grad_clip": 0.5, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.1, "final_epsilon": 0.01, "epsilon_timesteps": 1387080}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 43920, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x16b7b79d0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 705.8348181247711, "iterations_since_restore": 17, "perf": {"cpu_util_percent": 18.939285714285713, "ram_util_percent": 68.59642857142856}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 4.700000000000001e-05, "entropy_coeff": 0.049999999999999996, "policy_entropy": -1656.0844865359647, "policy_loss": -4.8922074087137075e+19, "vf_loss": 303528772.0349854}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 12005.5, "diff_num_grad_updates_vs_sampler_policy": 12004.5}}, "num_env_steps_sampled": 2038560, "num_env_steps_trained": 2038560, "num_agent_steps_sampled": 2038560, "num_agent_steps_trained": 2038560}, "sampler_results": {"episode_reward_max": -1348824.8954038802, "episode_reward_min": -1369366.2314788997, "episode_reward_mean": -1353836.1260091753, "episode_len_mean": 43920.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1369366.2314788997, -1361335.2082701626, -1354747.2510403998, -1351385.668151872, -1353878.0036070035, -1353934.4440263135, -1349299.1822382265, -1352848.977192731, -1354881.8648155385, -1350293.381402571, -1351982.609620888, -1355148.9106643137, -1353355.7607168008, -1351316.0660699722, -1348824.8954038802, -1353463.9545051646, -1350201.1795549188, -1352786.6794055027], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.14917955439568542, "mean_inference_ms": 0.2672252361986965, "mean_action_processing_ms": 0.0626343508444792, "mean_env_wait_ms": 0.5036680734457925, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002426571316189236, "StateBufferConnector_ms": 0.0017113155788845485, "ViewRequirementAgentConnector_ms": 0.04537238015068902}}, "episode_reward_max": -1348824.8954038802, "episode_reward_min": -1369366.2314788997, "episode_reward_mean": -1353836.1260091753, "episode_len_mean": 43920.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1369366.2314788997, -1361335.2082701626, -1354747.2510403998, -1351385.668151872, -1353878.0036070035, -1353934.4440263135, -1349299.1822382265, -1352848.977192731, -1354881.8648155385, -1350293.381402571, -1351982.609620888, -1355148.9106643137, -1353355.7607168008, -1351316.0660699722, -1348824.8954038802, -1353463.9545051646, -1350201.1795549188, -1352786.6794055027], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.14917955439568542, "mean_inference_ms": 0.2672252361986965, "mean_action_processing_ms": 0.0626343508444792, "mean_env_wait_ms": 0.5036680734457925, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002426571316189236, "StateBufferConnector_ms": 0.0017113155788845485, "ViewRequirementAgentConnector_ms": 0.04537238015068902}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2038560, "num_agent_steps_trained": 2038560, "num_env_steps_sampled": 2038560, "num_env_steps_trained": 2038560, "num_env_steps_sampled_this_iter": 43920, "num_env_steps_trained_this_iter": 43920, "num_env_steps_sampled_throughput_per_sec": 1118.5768078765066, "num_env_steps_trained_throughput_per_sec": 1118.5768078765066, "timesteps_total": 2038560, "num_steps_trained_this_iter": 43920, "agent_timesteps_total": 2038560, "timers": {"training_iteration_time_ms": 39308.283, "sample_time_ms": 38576.826, "load_time_ms": 12.564, "load_throughput": 3495710.991, "learn_time_ms": 718.077, "learn_throughput": 61163.388, "synch_weights_time_ms": 0.7}, "counters": {"num_env_steps_sampled": 2038560, "num_env_steps_trained": 2038560, "num_agent_steps_sampled": 2038560, "num_agent_steps_trained": 2038560}, "done": false, "episodes_total": 1237, "training_iteration": 358, "trial_id": "d8b7e_00000", "date": "2023-07-27_05-23-37", "timestamp": 1690424617, "time_this_iter_s": 39.26612997055054, "time_total_s": 5412.645705938339, "pid": 18921, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 366, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[1291920, 5e-05], [1731120, 8e-05], [2170320, 2.5e-05], [2609520, 2.5e-05], [3048720, 2.5e-05], [3487920, 2.5e-05], [3927120, 1e-05], [4366320, 1e-05], [4805520, 1e-05], [5244720, 5e-06], [5683920, 5e-06], [6123120, 5e-06], [6562320, 5e-06], [7001520, 1e-06], [7440720, 1e-06], [7879920, 1e-06], [8319120, 1e-06], [8758320, 5e-07], [9197520, 5e-07], [9636720, 2.5e-07], [10075920, 2.5e-07], [10515120, 1e-08], [10954320, 1e-08], [11393520, 5e-09], [11832720, 5e-09], [12271920, 1e-09]], "grad_clip": 0.5, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.1, "final_epsilon": 0.01, "epsilon_timesteps": 1387080}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 43920, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x16b7b79d0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 745.1009480953217, "iterations_since_restore": 18, "perf": {"cpu_util_percent": 18.020000000000003, "ram_util_percent": 68.63454545454545}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 4.15e-05, "entropy_coeff": 0.049999999999999996, "policy_entropy": -1647.7261914845458, "policy_loss": -4.4593636200987206e+19, "vf_loss": 303162230.68221575}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 12691.5, "diff_num_grad_updates_vs_sampler_policy": 12690.5}}, "num_env_steps_sampled": 2082480, "num_env_steps_trained": 2082480, "num_agent_steps_sampled": 2082480, "num_agent_steps_trained": 2082480}, "sampler_results": {"episode_reward_max": -1348824.8954038802, "episode_reward_min": -1369366.2314788997, "episode_reward_mean": -1353742.2908112265, "episode_len_mean": 43920.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1369366.2314788997, -1361335.2082701626, -1354747.2510403998, -1351385.668151872, -1353878.0036070035, -1353934.4440263135, -1349299.1822382265, -1352848.977192731, -1354881.8648155385, -1350293.381402571, -1351982.609620888, -1355148.9106643137, -1353355.7607168008, -1351316.0660699722, -1348824.8954038802, -1353463.9545051646, -1350201.1795549188, -1352786.6794055027, -1352053.2572481462], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.14871662301864313, "mean_inference_ms": 0.2661156116377226, "mean_action_processing_ms": 0.06244886296315723, "mean_env_wait_ms": 0.5016060766616516, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00240300831041838, "StateBufferConnector_ms": 0.001712849265650699, "ViewRequirementAgentConnector_ms": 0.045221730282432156}}, "episode_reward_max": -1348824.8954038802, "episode_reward_min": -1369366.2314788997, "episode_reward_mean": -1353742.2908112265, "episode_len_mean": 43920.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1369366.2314788997, -1361335.2082701626, -1354747.2510403998, -1351385.668151872, -1353878.0036070035, -1353934.4440263135, -1349299.1822382265, -1352848.977192731, -1354881.8648155385, -1350293.381402571, -1351982.609620888, -1355148.9106643137, -1353355.7607168008, -1351316.0660699722, -1348824.8954038802, -1353463.9545051646, -1350201.1795549188, -1352786.6794055027, -1352053.2572481462], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.14871662301864313, "mean_inference_ms": 0.2661156116377226, "mean_action_processing_ms": 0.06244886296315723, "mean_env_wait_ms": 0.5016060766616516, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00240300831041838, "StateBufferConnector_ms": 0.001712849265650699, "ViewRequirementAgentConnector_ms": 0.045221730282432156}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2082480, "num_agent_steps_trained": 2082480, "num_env_steps_sampled": 2082480, "num_env_steps_trained": 2082480, "num_env_steps_sampled_this_iter": 43920, "num_env_steps_trained_this_iter": 43920, "num_env_steps_sampled_throughput_per_sec": 1110.4665457526512, "num_env_steps_trained_throughput_per_sec": 1110.4665457526512, "timesteps_total": 2082480, "num_steps_trained_this_iter": 43920, "agent_timesteps_total": 2082480, "timers": {"training_iteration_time_ms": 39328.909, "sample_time_ms": 38597.139, "load_time_ms": 12.632, "load_throughput": 3477011.951, "learn_time_ms": 718.328, "learn_throughput": 61142.0, "synch_weights_time_ms": 0.697}, "counters": {"num_env_steps_sampled": 2082480, "num_env_steps_trained": 2082480, "num_agent_steps_sampled": 2082480, "num_agent_steps_trained": 2082480}, "done": false, "episodes_total": 1238, "training_iteration": 359, "trial_id": "d8b7e_00000", "date": "2023-07-27_05-24-16", "timestamp": 1690424656, "time_this_iter_s": 39.55295205116272, "time_total_s": 5452.198657989502, "pid": 18921, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 366, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[1291920, 5e-05], [1731120, 8e-05], [2170320, 2.5e-05], [2609520, 2.5e-05], [3048720, 2.5e-05], [3487920, 2.5e-05], [3927120, 1e-05], [4366320, 1e-05], [4805520, 1e-05], [5244720, 5e-06], [5683920, 5e-06], [6123120, 5e-06], [6562320, 5e-06], [7001520, 1e-06], [7440720, 1e-06], [7879920, 1e-06], [8319120, 1e-06], [8758320, 5e-07], [9197520, 5e-07], [9636720, 2.5e-07], [10075920, 2.5e-07], [10515120, 1e-08], [10954320, 1e-08], [11393520, 5e-09], [11832720, 5e-09], [12271920, 1e-09]], "grad_clip": 0.5, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.1, "final_epsilon": 0.01, "epsilon_timesteps": 1387080}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 43920, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x16b7b79d0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 784.6539001464844, "iterations_since_restore": 19, "perf": {"cpu_util_percent": 17.864285714285717, "ram_util_percent": 68.61785714285715}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 3.6e-05, "entropy_coeff": 0.049999999999999996, "policy_entropy": -1637.368543619317, "policy_loss": -3.6106182437990363e+19, "vf_loss": 303388796.7172012}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 13377.5, "diff_num_grad_updates_vs_sampler_policy": 13376.5}}, "num_env_steps_sampled": 2126400, "num_env_steps_trained": 2126400, "num_agent_steps_sampled": 2126400, "num_agent_steps_trained": 2126400}, "sampler_results": {"episode_reward_max": -1348824.8954038802, "episode_reward_min": -1369366.2314788997, "episode_reward_mean": -1353683.091946884, "episode_len_mean": 43920.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1369366.2314788997, -1361335.2082701626, -1354747.2510403998, -1351385.668151872, -1353878.0036070035, -1353934.4440263135, -1349299.1822382265, -1352848.977192731, -1354881.8648155385, -1350293.381402571, -1351982.609620888, -1355148.9106643137, -1353355.7607168008, -1351316.0660699722, -1348824.8954038802, -1353463.9545051646, -1350201.1795549188, -1352786.6794055027, -1352053.2572481462, -1352558.3135243794], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.14828461053825462, "mean_inference_ms": 0.2650823466191311, "mean_action_processing_ms": 0.06227581382364825, "mean_env_wait_ms": 0.4996973170424142, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0023877620697021484, "StateBufferConnector_ms": 0.0017273426055908203, "ViewRequirementAgentConnector_ms": 0.045146942138671875}}, "episode_reward_max": -1348824.8954038802, "episode_reward_min": -1369366.2314788997, "episode_reward_mean": -1353683.091946884, "episode_len_mean": 43920.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1369366.2314788997, -1361335.2082701626, -1354747.2510403998, -1351385.668151872, -1353878.0036070035, -1353934.4440263135, -1349299.1822382265, -1352848.977192731, -1354881.8648155385, -1350293.381402571, -1351982.609620888, -1355148.9106643137, -1353355.7607168008, -1351316.0660699722, -1348824.8954038802, -1353463.9545051646, -1350201.1795549188, -1352786.6794055027, -1352053.2572481462, -1352558.3135243794], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.14828461053825462, "mean_inference_ms": 0.2650823466191311, "mean_action_processing_ms": 0.06227581382364825, "mean_env_wait_ms": 0.4996973170424142, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0023877620697021484, "StateBufferConnector_ms": 0.0017273426055908203, "ViewRequirementAgentConnector_ms": 0.045146942138671875}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2126400, "num_agent_steps_trained": 2126400, "num_env_steps_sampled": 2126400, "num_env_steps_trained": 2126400, "num_env_steps_sampled_this_iter": 43920, "num_env_steps_trained_this_iter": 43920, "num_env_steps_sampled_throughput_per_sec": 1116.0074737080022, "num_env_steps_trained_throughput_per_sec": 1116.0074737080022, "timesteps_total": 2126400, "num_steps_trained_this_iter": 43920, "agent_timesteps_total": 2126400, "timers": {"training_iteration_time_ms": 39340.407, "sample_time_ms": 38607.374, "load_time_ms": 12.715, "load_throughput": 3454225.233, "learn_time_ms": 719.52, "learn_throughput": 61040.654, "synch_weights_time_ms": 0.684}, "counters": {"num_env_steps_sampled": 2126400, "num_env_steps_trained": 2126400, "num_agent_steps_sampled": 2126400, "num_agent_steps_trained": 2126400}, "done": false, "episodes_total": 1239, "training_iteration": 360, "trial_id": "d8b7e_00000", "date": "2023-07-27_05-24-56", "timestamp": 1690424696, "time_this_iter_s": 39.35658597946167, "time_total_s": 5491.555243968964, "pid": 18921, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 366, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[1291920, 5e-05], [1731120, 8e-05], [2170320, 2.5e-05], [2609520, 2.5e-05], [3048720, 2.5e-05], [3487920, 2.5e-05], [3927120, 1e-05], [4366320, 1e-05], [4805520, 1e-05], [5244720, 5e-06], [5683920, 5e-06], [6123120, 5e-06], [6562320, 5e-06], [7001520, 1e-06], [7440720, 1e-06], [7879920, 1e-06], [8319120, 1e-06], [8758320, 5e-07], [9197520, 5e-07], [9636720, 2.5e-07], [10075920, 2.5e-07], [10515120, 1e-08], [10954320, 1e-08], [11393520, 5e-09], [11832720, 5e-09], [12271920, 1e-09]], "grad_clip": 0.5, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.1, "final_epsilon": 0.01, "epsilon_timesteps": 1387080}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 43920, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x16b7b79d0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 824.010486125946, "iterations_since_restore": 20, "perf": {"cpu_util_percent": 18.519642857142856, "ram_util_percent": 68.64999999999999}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 3.049999999999999e-05, "entropy_coeff": 0.049999999999999996, "policy_entropy": -1645.855790474672, "policy_loss": -4.387572056899825e+19, "vf_loss": 306072775.7609329}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 14063.5, "diff_num_grad_updates_vs_sampler_policy": 14062.5}}, "num_env_steps_sampled": 2170320, "num_env_steps_trained": 2170320, "num_agent_steps_sampled": 2170320, "num_agent_steps_trained": 2170320}, "sampler_results": {"episode_reward_max": -1348824.8954038802, "episode_reward_min": -1369366.2314788997, "episode_reward_mean": -1353910.87413944, "episode_len_mean": 43920.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1369366.2314788997, -1361335.2082701626, -1354747.2510403998, -1351385.668151872, -1353878.0036070035, -1353934.4440263135, -1349299.1822382265, -1352848.977192731, -1354881.8648155385, -1350293.381402571, -1351982.609620888, -1355148.9106643137, -1353355.7607168008, -1351316.0660699722, -1348824.8954038802, -1353463.9545051646, -1350201.1795549188, -1352786.6794055027, -1352053.2572481462, -1352558.3135243794, -1358466.517990561], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.14788172831925175, "mean_inference_ms": 0.2641188201224038, "mean_action_processing_ms": 0.062114426226665964, "mean_env_wait_ms": 0.4979296822064061, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0023716971987769717, "StateBufferConnector_ms": 0.0017222904023670015, "ViewRequirementAgentConnector_ms": 0.04508381798153832}}, "episode_reward_max": -1348824.8954038802, "episode_reward_min": -1369366.2314788997, "episode_reward_mean": -1353910.87413944, "episode_len_mean": 43920.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1369366.2314788997, -1361335.2082701626, -1354747.2510403998, -1351385.668151872, -1353878.0036070035, -1353934.4440263135, -1349299.1822382265, -1352848.977192731, -1354881.8648155385, -1350293.381402571, -1351982.609620888, -1355148.9106643137, -1353355.7607168008, -1351316.0660699722, -1348824.8954038802, -1353463.9545051646, -1350201.1795549188, -1352786.6794055027, -1352053.2572481462, -1352558.3135243794, -1358466.517990561], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.14788172831925175, "mean_inference_ms": 0.2641188201224038, "mean_action_processing_ms": 0.062114426226665964, "mean_env_wait_ms": 0.4979296822064061, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0023716971987769717, "StateBufferConnector_ms": 0.0017222904023670015, "ViewRequirementAgentConnector_ms": 0.04508381798153832}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2170320, "num_agent_steps_trained": 2170320, "num_env_steps_sampled": 2170320, "num_env_steps_trained": 2170320, "num_env_steps_sampled_this_iter": 43920, "num_env_steps_trained_this_iter": 43920, "num_env_steps_sampled_throughput_per_sec": 1111.7389269566506, "num_env_steps_trained_throughput_per_sec": 1111.7389269566506, "timesteps_total": 2170320, "num_steps_trained_this_iter": 43920, "agent_timesteps_total": 2170320, "timers": {"training_iteration_time_ms": 39359.802, "sample_time_ms": 38625.498, "load_time_ms": 12.84, "load_throughput": 3420494.907, "learn_time_ms": 720.661, "learn_throughput": 60944.087, "synch_weights_time_ms": 0.688}, "counters": {"num_env_steps_sampled": 2170320, "num_env_steps_trained": 2170320, "num_agent_steps_sampled": 2170320, "num_agent_steps_trained": 2170320}, "done": false, "episodes_total": 1240, "training_iteration": 361, "trial_id": "d8b7e_00000", "date": "2023-07-27_05-25-35", "timestamp": 1690424735, "time_this_iter_s": 39.50770592689514, "time_total_s": 5531.062949895859, "pid": 18921, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 366, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[1291920, 5e-05], [1731120, 8e-05], [2170320, 2.5e-05], [2609520, 2.5e-05], [3048720, 2.5e-05], [3487920, 2.5e-05], [3927120, 1e-05], [4366320, 1e-05], [4805520, 1e-05], [5244720, 5e-06], [5683920, 5e-06], [6123120, 5e-06], [6562320, 5e-06], [7001520, 1e-06], [7440720, 1e-06], [7879920, 1e-06], [8319120, 1e-06], [8758320, 5e-07], [9197520, 5e-07], [9636720, 2.5e-07], [10075920, 2.5e-07], [10515120, 1e-08], [10954320, 1e-08], [11393520, 5e-09], [11832720, 5e-09], [12271920, 1e-09]], "grad_clip": 0.5, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.1, "final_epsilon": 0.01, "epsilon_timesteps": 1387080}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 43920, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x16b7b79d0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 863.5181920528412, "iterations_since_restore": 21, "perf": {"cpu_util_percent": 19.146428571428572, "ram_util_percent": 68.64107142857142}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 2.5000000000000005e-05, "entropy_coeff": 0.049999999999999996, "policy_entropy": -1645.5645294634317, "policy_loss": -4.911188834098956e+19, "vf_loss": 302690836.0174927}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 14749.5, "diff_num_grad_updates_vs_sampler_policy": 14748.5}}, "num_env_steps_sampled": 2214240, "num_env_steps_trained": 2214240, "num_agent_steps_sampled": 2214240, "num_agent_steps_trained": 2214240}, "sampler_results": {"episode_reward_max": -1348824.8954038802, "episode_reward_min": -1369366.2314788997, "episode_reward_mean": -1353794.3050465866, "episode_len_mean": 43920.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1369366.2314788997, -1361335.2082701626, -1354747.2510403998, -1351385.668151872, -1353878.0036070035, -1353934.4440263135, -1349299.1822382265, -1352848.977192731, -1354881.8648155385, -1350293.381402571, -1351982.609620888, -1355148.9106643137, -1353355.7607168008, -1351316.0660699722, -1348824.8954038802, -1353463.9545051646, -1350201.1795549188, -1352786.6794055027, -1352053.2572481462, -1352558.3135243794, -1358466.517990561, -1351346.3540966634], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.14750440178301794, "mean_inference_ms": 0.2632178532730861, "mean_action_processing_ms": 0.06196353652337696, "mean_env_wait_ms": 0.49628727513193255, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002363595095547763, "StateBufferConnector_ms": 0.0017176974903453481, "ViewRequirementAgentConnector_ms": 0.04503293470902876}}, "episode_reward_max": -1348824.8954038802, "episode_reward_min": -1369366.2314788997, "episode_reward_mean": -1353794.3050465866, "episode_len_mean": 43920.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1369366.2314788997, -1361335.2082701626, -1354747.2510403998, -1351385.668151872, -1353878.0036070035, -1353934.4440263135, -1349299.1822382265, -1352848.977192731, -1354881.8648155385, -1350293.381402571, -1351982.609620888, -1355148.9106643137, -1353355.7607168008, -1351316.0660699722, -1348824.8954038802, -1353463.9545051646, -1350201.1795549188, -1352786.6794055027, -1352053.2572481462, -1352558.3135243794, -1358466.517990561, -1351346.3540966634], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.14750440178301794, "mean_inference_ms": 0.2632178532730861, "mean_action_processing_ms": 0.06196353652337696, "mean_env_wait_ms": 0.49628727513193255, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002363595095547763, "StateBufferConnector_ms": 0.0017176974903453481, "ViewRequirementAgentConnector_ms": 0.04503293470902876}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2214240, "num_agent_steps_trained": 2214240, "num_env_steps_sampled": 2214240, "num_env_steps_trained": 2214240, "num_env_steps_sampled_this_iter": 43920, "num_env_steps_trained_this_iter": 43920, "num_env_steps_sampled_throughput_per_sec": 1112.803962458988, "num_env_steps_trained_throughput_per_sec": 1112.803962458988, "timesteps_total": 2214240, "num_steps_trained_this_iter": 43920, "agent_timesteps_total": 2214240, "timers": {"training_iteration_time_ms": 39414.887, "sample_time_ms": 38680.484, "load_time_ms": 12.754, "load_throughput": 3443641.83, "learn_time_ms": 720.847, "learn_throughput": 60928.336, "synch_weights_time_ms": 0.687}, "counters": {"num_env_steps_sampled": 2214240, "num_env_steps_trained": 2214240, "num_agent_steps_sampled": 2214240, "num_agent_steps_trained": 2214240}, "done": false, "episodes_total": 1241, "training_iteration": 362, "trial_id": "d8b7e_00000", "date": "2023-07-27_05-26-15", "timestamp": 1690424775, "time_this_iter_s": 39.46988296508789, "time_total_s": 5570.532832860947, "pid": 18921, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 366, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[1291920, 5e-05], [1731120, 8e-05], [2170320, 2.5e-05], [2609520, 2.5e-05], [3048720, 2.5e-05], [3487920, 2.5e-05], [3927120, 1e-05], [4366320, 1e-05], [4805520, 1e-05], [5244720, 5e-06], [5683920, 5e-06], [6123120, 5e-06], [6562320, 5e-06], [7001520, 1e-06], [7440720, 1e-06], [7879920, 1e-06], [8319120, 1e-06], [8758320, 5e-07], [9197520, 5e-07], [9636720, 2.5e-07], [10075920, 2.5e-07], [10515120, 1e-08], [10954320, 1e-08], [11393520, 5e-09], [11832720, 5e-09], [12271920, 1e-09]], "grad_clip": 0.5, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.1, "final_epsilon": 0.01, "epsilon_timesteps": 1387080}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 43920, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x16b7b79d0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 902.9880750179291, "iterations_since_restore": 22, "perf": {"cpu_util_percent": 17.94464285714286, "ram_util_percent": 68.65357142857142}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 2.5000000000000005e-05, "entropy_coeff": 0.049999999999999996, "policy_entropy": -1654.2490978185358, "policy_loss": -5.876330184556746e+19, "vf_loss": 302882091.9183673}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 15435.5, "diff_num_grad_updates_vs_sampler_policy": 15434.5}}, "num_env_steps_sampled": 2258160, "num_env_steps_trained": 2258160, "num_agent_steps_sampled": 2258160, "num_agent_steps_trained": 2258160}, "sampler_results": {"episode_reward_max": -1348824.8954038802, "episode_reward_min": -1369366.2314788997, "episode_reward_mean": -1353694.7991485593, "episode_len_mean": 43920.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1369366.2314788997, -1361335.2082701626, -1354747.2510403998, -1351385.668151872, -1353878.0036070035, -1353934.4440263135, -1349299.1822382265, -1352848.977192731, -1354881.8648155385, -1350293.381402571, -1351982.609620888, -1355148.9106643137, -1353355.7607168008, -1351316.0660699722, -1348824.8954038802, -1353463.9545051646, -1350201.1795549188, -1352786.6794055027, -1352053.2572481462, -1352558.3135243794, -1358466.517990561, -1351346.3540966634, -1351505.6693919636], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.14714990654973836, "mean_inference_ms": 0.26237306027338475, "mean_action_processing_ms": 0.061822277834668676, "mean_env_wait_ms": 0.49475575852600073, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0023447948953379755, "StateBufferConnector_ms": 0.001717650372049083, "ViewRequirementAgentConnector_ms": 0.04521556522535241}}, "episode_reward_max": -1348824.8954038802, "episode_reward_min": -1369366.2314788997, "episode_reward_mean": -1353694.7991485593, "episode_len_mean": 43920.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1369366.2314788997, -1361335.2082701626, -1354747.2510403998, -1351385.668151872, -1353878.0036070035, -1353934.4440263135, -1349299.1822382265, -1352848.977192731, -1354881.8648155385, -1350293.381402571, -1351982.609620888, -1355148.9106643137, -1353355.7607168008, -1351316.0660699722, -1348824.8954038802, -1353463.9545051646, -1350201.1795549188, -1352786.6794055027, -1352053.2572481462, -1352558.3135243794, -1358466.517990561, -1351346.3540966634, -1351505.6693919636], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.14714990654973836, "mean_inference_ms": 0.26237306027338475, "mean_action_processing_ms": 0.061822277834668676, "mean_env_wait_ms": 0.49475575852600073, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0023447948953379755, "StateBufferConnector_ms": 0.001717650372049083, "ViewRequirementAgentConnector_ms": 0.04521556522535241}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2258160, "num_agent_steps_trained": 2258160, "num_env_steps_sampled": 2258160, "num_env_steps_trained": 2258160, "num_env_steps_sampled_this_iter": 43920, "num_env_steps_trained_this_iter": 43920, "num_env_steps_sampled_throughput_per_sec": 1113.521797556373, "num_env_steps_trained_throughput_per_sec": 1113.521797556373, "timesteps_total": 2258160, "num_steps_trained_this_iter": 43920, "agent_timesteps_total": 2258160, "timers": {"training_iteration_time_ms": 39423.924, "sample_time_ms": 38689.776, "load_time_ms": 12.717, "load_throughput": 3453558.223, "learn_time_ms": 720.626, "learn_throughput": 60947.034, "synch_weights_time_ms": 0.691}, "counters": {"num_env_steps_sampled": 2258160, "num_env_steps_trained": 2258160, "num_agent_steps_sampled": 2258160, "num_agent_steps_trained": 2258160}, "done": false, "episodes_total": 1242, "training_iteration": 363, "trial_id": "d8b7e_00000", "date": "2023-07-27_05-26-54", "timestamp": 1690424814, "time_this_iter_s": 39.44440007209778, "time_total_s": 5609.977232933044, "pid": 18921, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 366, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[1291920, 5e-05], [1731120, 8e-05], [2170320, 2.5e-05], [2609520, 2.5e-05], [3048720, 2.5e-05], [3487920, 2.5e-05], [3927120, 1e-05], [4366320, 1e-05], [4805520, 1e-05], [5244720, 5e-06], [5683920, 5e-06], [6123120, 5e-06], [6562320, 5e-06], [7001520, 1e-06], [7440720, 1e-06], [7879920, 1e-06], [8319120, 1e-06], [8758320, 5e-07], [9197520, 5e-07], [9636720, 2.5e-07], [10075920, 2.5e-07], [10515120, 1e-08], [10954320, 1e-08], [11393520, 5e-09], [11832720, 5e-09], [12271920, 1e-09]], "grad_clip": 0.5, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.1, "final_epsilon": 0.01, "epsilon_timesteps": 1387080}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 43920, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x16b7b79d0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 942.4324750900269, "iterations_since_restore": 23, "perf": {"cpu_util_percent": 17.807142857142857, "ram_util_percent": 68.74107142857143}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 2.5000000000000005e-05, "entropy_coeff": 0.049999999999999996, "policy_entropy": -1650.9068776122335, "policy_loss": -5.956900423172508e+19, "vf_loss": 303687441.9650146}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 16121.5, "diff_num_grad_updates_vs_sampler_policy": 16120.5}}, "num_env_steps_sampled": 2302080, "num_env_steps_trained": 2302080, "num_agent_steps_sampled": 2302080, "num_agent_steps_trained": 2302080}, "sampler_results": {"episode_reward_max": -1348824.8954038802, "episode_reward_min": -1369366.2314788997, "episode_reward_mean": -1353679.608848551, "episode_len_mean": 43920.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1369366.2314788997, -1361335.2082701626, -1354747.2510403998, -1351385.668151872, -1353878.0036070035, -1353934.4440263135, -1349299.1822382265, -1352848.977192731, -1354881.8648155385, -1350293.381402571, -1351982.609620888, -1355148.9106643137, -1353355.7607168008, -1351316.0660699722, -1348824.8954038802, -1353463.9545051646, -1350201.1795549188, -1352786.6794055027, -1352053.2572481462, -1352558.3135243794, -1358466.517990561, -1351346.3540966634, -1351505.6693919636, -1353330.2319483531], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.14681684730922664, "mean_inference_ms": 0.2615812747379882, "mean_action_processing_ms": 0.06168956580654993, "mean_env_wait_ms": 0.49331380980723355, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002422928810119629, "StateBufferConnector_ms": 0.0017195940017700195, "ViewRequirementAgentConnector_ms": 0.04525383313496908}}, "episode_reward_max": -1348824.8954038802, "episode_reward_min": -1369366.2314788997, "episode_reward_mean": -1353679.608848551, "episode_len_mean": 43920.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1369366.2314788997, -1361335.2082701626, -1354747.2510403998, -1351385.668151872, -1353878.0036070035, -1353934.4440263135, -1349299.1822382265, -1352848.977192731, -1354881.8648155385, -1350293.381402571, -1351982.609620888, -1355148.9106643137, -1353355.7607168008, -1351316.0660699722, -1348824.8954038802, -1353463.9545051646, -1350201.1795549188, -1352786.6794055027, -1352053.2572481462, -1352558.3135243794, -1358466.517990561, -1351346.3540966634, -1351505.6693919636, -1353330.2319483531], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.14681684730922664, "mean_inference_ms": 0.2615812747379882, "mean_action_processing_ms": 0.06168956580654993, "mean_env_wait_ms": 0.49331380980723355, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002422928810119629, "StateBufferConnector_ms": 0.0017195940017700195, "ViewRequirementAgentConnector_ms": 0.04525383313496908}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2302080, "num_agent_steps_trained": 2302080, "num_env_steps_sampled": 2302080, "num_env_steps_trained": 2302080, "num_env_steps_sampled_this_iter": 43920, "num_env_steps_trained_this_iter": 43920, "num_env_steps_sampled_throughput_per_sec": 1117.2699175846044, "num_env_steps_trained_throughput_per_sec": 1117.2699175846044, "timesteps_total": 2302080, "num_steps_trained_this_iter": 43920, "agent_timesteps_total": 2302080, "timers": {"training_iteration_time_ms": 39434.546, "sample_time_ms": 38694.595, "load_time_ms": 12.802, "load_throughput": 3430795.722, "learn_time_ms": 726.346, "learn_throughput": 60467.089, "synch_weights_time_ms": 0.688}, "counters": {"num_env_steps_sampled": 2302080, "num_env_steps_trained": 2302080, "num_agent_steps_sampled": 2302080, "num_agent_steps_trained": 2302080}, "done": false, "episodes_total": 1243, "training_iteration": 364, "trial_id": "d8b7e_00000", "date": "2023-07-27_05-27-33", "timestamp": 1690424853, "time_this_iter_s": 39.31209087371826, "time_total_s": 5649.289323806763, "pid": 18921, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 366, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[1291920, 5e-05], [1731120, 8e-05], [2170320, 2.5e-05], [2609520, 2.5e-05], [3048720, 2.5e-05], [3487920, 2.5e-05], [3927120, 1e-05], [4366320, 1e-05], [4805520, 1e-05], [5244720, 5e-06], [5683920, 5e-06], [6123120, 5e-06], [6562320, 5e-06], [7001520, 1e-06], [7440720, 1e-06], [7879920, 1e-06], [8319120, 1e-06], [8758320, 5e-07], [9197520, 5e-07], [9636720, 2.5e-07], [10075920, 2.5e-07], [10515120, 1e-08], [10954320, 1e-08], [11393520, 5e-09], [11832720, 5e-09], [12271920, 1e-09]], "grad_clip": 0.5, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.1, "final_epsilon": 0.01, "epsilon_timesteps": 1387080}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 43920, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x16b7b79d0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 981.7445659637451, "iterations_since_restore": 24, "perf": {"cpu_util_percent": 18.48, "ram_util_percent": 68.8490909090909}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 2.5000000000000005e-05, "entropy_coeff": 0.049999999999999996, "policy_entropy": -1637.8451586131105, "policy_loss": -4.737032032701151e+19, "vf_loss": 303000967.11953354}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 16807.5, "diff_num_grad_updates_vs_sampler_policy": 16806.5}}, "num_env_steps_sampled": 2346000, "num_env_steps_trained": 2346000, "num_agent_steps_sampled": 2346000, "num_agent_steps_trained": 2346000}, "sampler_results": {"episode_reward_max": -1348824.8954038802, "episode_reward_min": -1369366.2314788997, "episode_reward_mean": -1353602.7189802793, "episode_len_mean": 43920.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1369366.2314788997, -1361335.2082701626, -1354747.2510403998, -1351385.668151872, -1353878.0036070035, -1353934.4440263135, -1349299.1822382265, -1352848.977192731, -1354881.8648155385, -1350293.381402571, -1351982.609620888, -1355148.9106643137, -1353355.7607168008, -1351316.0660699722, -1348824.8954038802, -1353463.9545051646, -1350201.1795549188, -1352786.6794055027, -1352053.2572481462, -1352558.3135243794, -1358466.517990561, -1351346.3540966634, -1351505.6693919636, -1353330.2319483531, -1351757.3621417605], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.14650072669426376, "mean_inference_ms": 0.26083462250710343, "mean_action_processing_ms": 0.06156453964276126, "mean_env_wait_ms": 0.49195635681274574, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0024051666259765625, "StateBufferConnector_ms": 0.001720428466796875, "ViewRequirementAgentConnector_ms": 0.04523658752441406}}, "episode_reward_max": -1348824.8954038802, "episode_reward_min": -1369366.2314788997, "episode_reward_mean": -1353602.7189802793, "episode_len_mean": 43920.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1369366.2314788997, -1361335.2082701626, -1354747.2510403998, -1351385.668151872, -1353878.0036070035, -1353934.4440263135, -1349299.1822382265, -1352848.977192731, -1354881.8648155385, -1350293.381402571, -1351982.609620888, -1355148.9106643137, -1353355.7607168008, -1351316.0660699722, -1348824.8954038802, -1353463.9545051646, -1350201.1795549188, -1352786.6794055027, -1352053.2572481462, -1352558.3135243794, -1358466.517990561, -1351346.3540966634, -1351505.6693919636, -1353330.2319483531, -1351757.3621417605], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.14650072669426376, "mean_inference_ms": 0.26083462250710343, "mean_action_processing_ms": 0.06156453964276126, "mean_env_wait_ms": 0.49195635681274574, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0024051666259765625, "StateBufferConnector_ms": 0.001720428466796875, "ViewRequirementAgentConnector_ms": 0.04523658752441406}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2346000, "num_agent_steps_trained": 2346000, "num_env_steps_sampled": 2346000, "num_env_steps_trained": 2346000, "num_env_steps_sampled_this_iter": 43920, "num_env_steps_trained_this_iter": 43920, "num_env_steps_sampled_throughput_per_sec": 1120.7282867913052, "num_env_steps_trained_throughput_per_sec": 1120.7282867913052, "timesteps_total": 2346000, "num_steps_trained_this_iter": 43920, "agent_timesteps_total": 2346000, "timers": {"training_iteration_time_ms": 39399.161, "sample_time_ms": 38657.696, "load_time_ms": 12.827, "load_throughput": 3423947.089, "learn_time_ms": 727.829, "learn_throughput": 60343.815, "synch_weights_time_ms": 0.692}, "counters": {"num_env_steps_sampled": 2346000, "num_env_steps_trained": 2346000, "num_agent_steps_sampled": 2346000, "num_agent_steps_trained": 2346000}, "done": false, "episodes_total": 1244, "training_iteration": 365, "trial_id": "d8b7e_00000", "date": "2023-07-27_05-28-13", "timestamp": 1690424893, "time_this_iter_s": 39.19123101234436, "time_total_s": 5688.480554819107, "pid": 18921, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 366, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[1291920, 5e-05], [1731120, 8e-05], [2170320, 2.5e-05], [2609520, 2.5e-05], [3048720, 2.5e-05], [3487920, 2.5e-05], [3927120, 1e-05], [4366320, 1e-05], [4805520, 1e-05], [5244720, 5e-06], [5683920, 5e-06], [6123120, 5e-06], [6562320, 5e-06], [7001520, 1e-06], [7440720, 1e-06], [7879920, 1e-06], [8319120, 1e-06], [8758320, 5e-07], [9197520, 5e-07], [9636720, 2.5e-07], [10075920, 2.5e-07], [10515120, 1e-08], [10954320, 1e-08], [11393520, 5e-09], [11832720, 5e-09], [12271920, 1e-09]], "grad_clip": 0.5, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.1, "final_epsilon": 0.01, "epsilon_timesteps": 1387080}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 43920, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x16b7b79d0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1020.9357969760895, "iterations_since_restore": 25, "perf": {"cpu_util_percent": 19.28928571428571, "ram_util_percent": 68.85}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 2.5000000000000005e-05, "entropy_coeff": 0.049999999999999996, "policy_entropy": -1651.0821965609625, "policy_loss": -6.338721829275569e+19, "vf_loss": 302597970.1574344}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 17493.5, "diff_num_grad_updates_vs_sampler_policy": 17492.5}}, "num_env_steps_sampled": 2389920, "num_env_steps_trained": 2389920, "num_agent_steps_sampled": 2389920, "num_agent_steps_trained": 2389920}, "sampler_results": {"episode_reward_max": -1348824.8954038802, "episode_reward_min": -1369366.2314788997, "episode_reward_mean": -1353506.8888074507, "episode_len_mean": 43920.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1369366.2314788997, -1361335.2082701626, -1354747.2510403998, -1351385.668151872, -1353878.0036070035, -1353934.4440263135, -1349299.1822382265, -1352848.977192731, -1354881.8648155385, -1350293.381402571, -1351982.609620888, -1355148.9106643137, -1353355.7607168008, -1351316.0660699722, -1348824.8954038802, -1353463.9545051646, -1350201.1795549188, -1352786.6794055027, -1352053.2572481462, -1352558.3135243794, -1358466.517990561, -1351346.3540966634, -1351505.6693919636, -1353330.2319483531, -1351757.3621417605, -1351111.1344867356], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1462009485861337, "mean_inference_ms": 0.2601309566043874, "mean_action_processing_ms": 0.06144669890127959, "mean_env_wait_ms": 0.4906811310891931, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002392438741830679, "StateBufferConnector_ms": 0.001727617703951322, "ViewRequirementAgentConnector_ms": 0.04528210713313176}}, "episode_reward_max": -1348824.8954038802, "episode_reward_min": -1369366.2314788997, "episode_reward_mean": -1353506.8888074507, "episode_len_mean": 43920.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1369366.2314788997, -1361335.2082701626, -1354747.2510403998, -1351385.668151872, -1353878.0036070035, -1353934.4440263135, -1349299.1822382265, -1352848.977192731, -1354881.8648155385, -1350293.381402571, -1351982.609620888, -1355148.9106643137, -1353355.7607168008, -1351316.0660699722, -1348824.8954038802, -1353463.9545051646, -1350201.1795549188, -1352786.6794055027, -1352053.2572481462, -1352558.3135243794, -1358466.517990561, -1351346.3540966634, -1351505.6693919636, -1353330.2319483531, -1351757.3621417605, -1351111.1344867356], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1462009485861337, "mean_inference_ms": 0.2601309566043874, "mean_action_processing_ms": 0.06144669890127959, "mean_env_wait_ms": 0.4906811310891931, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002392438741830679, "StateBufferConnector_ms": 0.001727617703951322, "ViewRequirementAgentConnector_ms": 0.04528210713313176}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2389920, "num_agent_steps_trained": 2389920, "num_env_steps_sampled": 2389920, "num_env_steps_trained": 2389920, "num_env_steps_sampled_this_iter": 43920, "num_env_steps_trained_this_iter": 43920, "num_env_steps_sampled_throughput_per_sec": 1114.327574702659, "num_env_steps_trained_throughput_per_sec": 1114.327574702659, "timesteps_total": 2389920, "num_steps_trained_this_iter": 43920, "agent_timesteps_total": 2389920, "timers": {"training_iteration_time_ms": 39363.771, "sample_time_ms": 38622.64, "load_time_ms": 12.668, "load_throughput": 3466921.46, "learn_time_ms": 727.645, "learn_throughput": 60359.067, "synch_weights_time_ms": 0.7}, "counters": {"num_env_steps_sampled": 2389920, "num_env_steps_trained": 2389920, "num_agent_steps_sampled": 2389920, "num_agent_steps_trained": 2389920}, "done": false, "episodes_total": 1245, "training_iteration": 366, "trial_id": "d8b7e_00000", "date": "2023-07-27_05-28-52", "timestamp": 1690424932, "time_this_iter_s": 39.41590404510498, "time_total_s": 5727.896458864212, "pid": 18921, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 366, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[1291920, 5e-05], [1731120, 8e-05], [2170320, 2.5e-05], [2609520, 2.5e-05], [3048720, 2.5e-05], [3487920, 2.5e-05], [3927120, 1e-05], [4366320, 1e-05], [4805520, 1e-05], [5244720, 5e-06], [5683920, 5e-06], [6123120, 5e-06], [6562320, 5e-06], [7001520, 1e-06], [7440720, 1e-06], [7879920, 1e-06], [8319120, 1e-06], [8758320, 5e-07], [9197520, 5e-07], [9636720, 2.5e-07], [10075920, 2.5e-07], [10515120, 1e-08], [10954320, 1e-08], [11393520, 5e-09], [11832720, 5e-09], [12271920, 1e-09]], "grad_clip": 0.5, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.1, "final_epsilon": 0.01, "epsilon_timesteps": 1387080}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 43920, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x16b7b79d0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1060.3517010211945, "iterations_since_restore": 26, "perf": {"cpu_util_percent": 17.88392857142857, "ram_util_percent": 68.89642857142857}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 2.5000000000000005e-05, "entropy_coeff": 0.049999999999999996, "policy_entropy": -1639.2443669711188, "policy_loss": -5.1498220082098225e+19, "vf_loss": 303512411.18367344}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 18179.5, "diff_num_grad_updates_vs_sampler_policy": 18178.5}}, "num_env_steps_sampled": 2433840, "num_env_steps_trained": 2433840, "num_agent_steps_sampled": 2433840, "num_agent_steps_trained": 2433840}, "sampler_results": {"episode_reward_max": -1348824.8954038802, "episode_reward_min": -1369366.2314788997, "episode_reward_mean": -1353486.6394368366, "episode_len_mean": 43920.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1369366.2314788997, -1361335.2082701626, -1354747.2510403998, -1351385.668151872, -1353878.0036070035, -1353934.4440263135, -1349299.1822382265, -1352848.977192731, -1354881.8648155385, -1350293.381402571, -1351982.609620888, -1355148.9106643137, -1353355.7607168008, -1351316.0660699722, -1348824.8954038802, -1353463.9545051646, -1350201.1795549188, -1352786.6794055027, -1352053.2572481462, -1352558.3135243794, -1358466.517990561, -1351346.3540966634, -1351505.6693919636, -1353330.2319483531, -1351757.3621417605, -1351111.1344867356, -1352960.1558008753], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.14591746584391543, "mean_inference_ms": 0.2594662408488404, "mean_action_processing_ms": 0.06133504413385457, "mean_env_wait_ms": 0.4894771047876405, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0023859518545645254, "StateBufferConnector_ms": 0.00171661376953125, "ViewRequirementAgentConnector_ms": 0.04523330264621311}}, "episode_reward_max": -1348824.8954038802, "episode_reward_min": -1369366.2314788997, "episode_reward_mean": -1353486.6394368366, "episode_len_mean": 43920.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1369366.2314788997, -1361335.2082701626, -1354747.2510403998, -1351385.668151872, -1353878.0036070035, -1353934.4440263135, -1349299.1822382265, -1352848.977192731, -1354881.8648155385, -1350293.381402571, -1351982.609620888, -1355148.9106643137, -1353355.7607168008, -1351316.0660699722, -1348824.8954038802, -1353463.9545051646, -1350201.1795549188, -1352786.6794055027, -1352053.2572481462, -1352558.3135243794, -1358466.517990561, -1351346.3540966634, -1351505.6693919636, -1353330.2319483531, -1351757.3621417605, -1351111.1344867356, -1352960.1558008753], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.14591746584391543, "mean_inference_ms": 0.2594662408488404, "mean_action_processing_ms": 0.06133504413385457, "mean_env_wait_ms": 0.4894771047876405, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0023859518545645254, "StateBufferConnector_ms": 0.00171661376953125, "ViewRequirementAgentConnector_ms": 0.04523330264621311}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2433840, "num_agent_steps_trained": 2433840, "num_env_steps_sampled": 2433840, "num_env_steps_trained": 2433840, "num_env_steps_sampled_this_iter": 43920, "num_env_steps_trained_this_iter": 43920, "num_env_steps_sampled_throughput_per_sec": 1117.1561818383875, "num_env_steps_trained_throughput_per_sec": 1117.1561818383875, "timesteps_total": 2433840, "num_steps_trained_this_iter": 43920, "agent_timesteps_total": 2433840, "timers": {"training_iteration_time_ms": 39381.244, "sample_time_ms": 38641.057, "load_time_ms": 12.557, "load_throughput": 3497742.05, "learn_time_ms": 726.81, "learn_throughput": 60428.485, "synch_weights_time_ms": 0.703}, "counters": {"num_env_steps_sampled": 2433840, "num_env_steps_trained": 2433840, "num_agent_steps_sampled": 2433840, "num_agent_steps_trained": 2433840}, "done": false, "episodes_total": 1246, "training_iteration": 367, "trial_id": "d8b7e_00000", "date": "2023-07-27_05-29-31", "timestamp": 1690424971, "time_this_iter_s": 39.31621980667114, "time_total_s": 5767.212678670883, "pid": 18921, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 366, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[1291920, 5e-05], [1731120, 8e-05], [2170320, 2.5e-05], [2609520, 2.5e-05], [3048720, 2.5e-05], [3487920, 2.5e-05], [3927120, 1e-05], [4366320, 1e-05], [4805520, 1e-05], [5244720, 5e-06], [5683920, 5e-06], [6123120, 5e-06], [6562320, 5e-06], [7001520, 1e-06], [7440720, 1e-06], [7879920, 1e-06], [8319120, 1e-06], [8758320, 5e-07], [9197520, 5e-07], [9636720, 2.5e-07], [10075920, 2.5e-07], [10515120, 1e-08], [10954320, 1e-08], [11393520, 5e-09], [11832720, 5e-09], [12271920, 1e-09]], "grad_clip": 0.5, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.1, "final_epsilon": 0.01, "epsilon_timesteps": 1387080}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 43920, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x16b7b79d0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1099.6679208278656, "iterations_since_restore": 27, "perf": {"cpu_util_percent": 18.60363636363636, "ram_util_percent": 68.89636363636365}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 2.5000000000000005e-05, "entropy_coeff": 0.049999999999999996, "policy_entropy": -1652.1421754353248, "policy_loss": -6.345838194518252e+19, "vf_loss": 303953997.06122446}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 18865.5, "diff_num_grad_updates_vs_sampler_policy": 18864.5}}, "num_env_steps_sampled": 2477760, "num_env_steps_trained": 2477760, "num_agent_steps_sampled": 2477760, "num_agent_steps_trained": 2477760}, "sampler_results": {"episode_reward_max": -1348824.8954038802, "episode_reward_min": -1369366.2314788997, "episode_reward_mean": -1353498.9033533528, "episode_len_mean": 43920.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1369366.2314788997, -1361335.2082701626, -1354747.2510403998, -1351385.668151872, -1353878.0036070035, -1353934.4440263135, -1349299.1822382265, -1352848.977192731, -1354881.8648155385, -1350293.381402571, -1351982.609620888, -1355148.9106643137, -1353355.7607168008, -1351316.0660699722, -1348824.8954038802, -1353463.9545051646, -1350201.1795549188, -1352786.6794055027, -1352053.2572481462, -1352558.3135243794, -1358466.517990561, -1351346.3540966634, -1351505.6693919636, -1353330.2319483531, -1351757.3621417605, -1351111.1344867356, -1352960.1558008753, -1353830.0290992912], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.14564898466460321, "mean_inference_ms": 0.25883696311735893, "mean_action_processing_ms": 0.06122927855903504, "mean_env_wait_ms": 0.4883396629627853, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0023739678519112723, "StateBufferConnector_ms": 0.001710653305053711, "ViewRequirementAgentConnector_ms": 0.045234816414969306}}, "episode_reward_max": -1348824.8954038802, "episode_reward_min": -1369366.2314788997, "episode_reward_mean": -1353498.9033533528, "episode_len_mean": 43920.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1369366.2314788997, -1361335.2082701626, -1354747.2510403998, -1351385.668151872, -1353878.0036070035, -1353934.4440263135, -1349299.1822382265, -1352848.977192731, -1354881.8648155385, -1350293.381402571, -1351982.609620888, -1355148.9106643137, -1353355.7607168008, -1351316.0660699722, -1348824.8954038802, -1353463.9545051646, -1350201.1795549188, -1352786.6794055027, -1352053.2572481462, -1352558.3135243794, -1358466.517990561, -1351346.3540966634, -1351505.6693919636, -1353330.2319483531, -1351757.3621417605, -1351111.1344867356, -1352960.1558008753, -1353830.0290992912], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.14564898466460321, "mean_inference_ms": 0.25883696311735893, "mean_action_processing_ms": 0.06122927855903504, "mean_env_wait_ms": 0.4883396629627853, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0023739678519112723, "StateBufferConnector_ms": 0.001710653305053711, "ViewRequirementAgentConnector_ms": 0.045234816414969306}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2477760, "num_agent_steps_trained": 2477760, "num_env_steps_sampled": 2477760, "num_env_steps_trained": 2477760, "num_env_steps_sampled_this_iter": 43920, "num_env_steps_trained_this_iter": 43920, "num_env_steps_sampled_throughput_per_sec": 1115.8125538591262, "num_env_steps_trained_throughput_per_sec": 1115.8125538591262, "timesteps_total": 2477760, "num_steps_trained_this_iter": 43920, "agent_timesteps_total": 2477760, "timers": {"training_iteration_time_ms": 39390.971, "sample_time_ms": 38651.719, "load_time_ms": 12.669, "load_throughput": 3466693.107, "learn_time_ms": 725.769, "learn_throughput": 60515.151, "synch_weights_time_ms": 0.697}, "counters": {"num_env_steps_sampled": 2477760, "num_env_steps_trained": 2477760, "num_agent_steps_sampled": 2477760, "num_agent_steps_trained": 2477760}, "done": false, "episodes_total": 1247, "training_iteration": 368, "trial_id": "d8b7e_00000", "date": "2023-07-27_05-30-11", "timestamp": 1690425011, "time_this_iter_s": 39.3635778427124, "time_total_s": 5806.576256513596, "pid": 18921, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 366, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[1291920, 5e-05], [1731120, 8e-05], [2170320, 2.5e-05], [2609520, 2.5e-05], [3048720, 2.5e-05], [3487920, 2.5e-05], [3927120, 1e-05], [4366320, 1e-05], [4805520, 1e-05], [5244720, 5e-06], [5683920, 5e-06], [6123120, 5e-06], [6562320, 5e-06], [7001520, 1e-06], [7440720, 1e-06], [7879920, 1e-06], [8319120, 1e-06], [8758320, 5e-07], [9197520, 5e-07], [9636720, 2.5e-07], [10075920, 2.5e-07], [10515120, 1e-08], [10954320, 1e-08], [11393520, 5e-09], [11832720, 5e-09], [12271920, 1e-09]], "grad_clip": 0.5, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.1, "final_epsilon": 0.01, "epsilon_timesteps": 1387080}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 43920, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x16b7b79d0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1139.031498670578, "iterations_since_restore": 28, "perf": {"cpu_util_percent": 18.071428571428573, "ram_util_percent": 68.90178571428572}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 2.5000000000000005e-05, "entropy_coeff": 0.049999999999999996, "policy_entropy": -1662.437163683833, "policy_loss": -7.40024919715488e+19, "vf_loss": 303458928.8921283}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 19551.5, "diff_num_grad_updates_vs_sampler_policy": 19550.5}}, "num_env_steps_sampled": 2521680, "num_env_steps_trained": 2521680, "num_agent_steps_sampled": 2521680, "num_agent_steps_trained": 2521680}, "sampler_results": {"episode_reward_max": -1348824.8954038802, "episode_reward_min": -1369366.2314788997, "episode_reward_mean": -1353473.920582791, "episode_len_mean": 43920.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1369366.2314788997, -1361335.2082701626, -1354747.2510403998, -1351385.668151872, -1353878.0036070035, -1353934.4440263135, -1349299.1822382265, -1352848.977192731, -1354881.8648155385, -1350293.381402571, -1351982.609620888, -1355148.9106643137, -1353355.7607168008, -1351316.0660699722, -1348824.8954038802, -1353463.9545051646, -1350201.1795549188, -1352786.6794055027, -1352053.2572481462, -1352558.3135243794, -1358466.517990561, -1351346.3540966634, -1351505.6693919636, -1353330.2319483531, -1351757.3621417605, -1351111.1344867356, -1352960.1558008753, -1353830.0290992912, -1352774.403007062], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.14539470120697834, "mean_inference_ms": 0.2582409856836417, "mean_action_processing_ms": 0.06112914473322961, "mean_env_wait_ms": 0.48725243442512695, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002441735103212554, "StateBufferConnector_ms": 0.0017133252374057111, "ViewRequirementAgentConnector_ms": 0.045181142872777476}}, "episode_reward_max": -1348824.8954038802, "episode_reward_min": -1369366.2314788997, "episode_reward_mean": -1353473.920582791, "episode_len_mean": 43920.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1369366.2314788997, -1361335.2082701626, -1354747.2510403998, -1351385.668151872, -1353878.0036070035, -1353934.4440263135, -1349299.1822382265, -1352848.977192731, -1354881.8648155385, -1350293.381402571, -1351982.609620888, -1355148.9106643137, -1353355.7607168008, -1351316.0660699722, -1348824.8954038802, -1353463.9545051646, -1350201.1795549188, -1352786.6794055027, -1352053.2572481462, -1352558.3135243794, -1358466.517990561, -1351346.3540966634, -1351505.6693919636, -1353330.2319483531, -1351757.3621417605, -1351111.1344867356, -1352960.1558008753, -1353830.0290992912, -1352774.403007062], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.14539470120697834, "mean_inference_ms": 0.2582409856836417, "mean_action_processing_ms": 0.06112914473322961, "mean_env_wait_ms": 0.48725243442512695, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002441735103212554, "StateBufferConnector_ms": 0.0017133252374057111, "ViewRequirementAgentConnector_ms": 0.045181142872777476}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2521680, "num_agent_steps_trained": 2521680, "num_env_steps_sampled": 2521680, "num_env_steps_trained": 2521680, "num_env_steps_sampled_this_iter": 43920, "num_env_steps_trained_this_iter": 43920, "num_env_steps_sampled_throughput_per_sec": 1125.8783471730899, "num_env_steps_trained_throughput_per_sec": 1125.8783471730899, "timesteps_total": 2521680, "num_steps_trained_this_iter": 43920, "agent_timesteps_total": 2521680, "timers": {"training_iteration_time_ms": 39336.831, "sample_time_ms": 38598.169, "load_time_ms": 12.665, "load_throughput": 3467737.249, "learn_time_ms": 725.185, "learn_throughput": 60563.895, "synch_weights_time_ms": 0.695}, "counters": {"num_env_steps_sampled": 2521680, "num_env_steps_trained": 2521680, "num_agent_steps_sampled": 2521680, "num_agent_steps_trained": 2521680}, "done": false, "episodes_total": 1248, "training_iteration": 369, "trial_id": "d8b7e_00000", "date": "2023-07-27_05-30-50", "timestamp": 1690425050, "time_this_iter_s": 39.01164197921753, "time_total_s": 5845.587898492813, "pid": 18921, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 366, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[1291920, 5e-05], [1731120, 8e-05], [2170320, 2.5e-05], [2609520, 2.5e-05], [3048720, 2.5e-05], [3487920, 2.5e-05], [3927120, 1e-05], [4366320, 1e-05], [4805520, 1e-05], [5244720, 5e-06], [5683920, 5e-06], [6123120, 5e-06], [6562320, 5e-06], [7001520, 1e-06], [7440720, 1e-06], [7879920, 1e-06], [8319120, 1e-06], [8758320, 5e-07], [9197520, 5e-07], [9636720, 2.5e-07], [10075920, 2.5e-07], [10515120, 1e-08], [10954320, 1e-08], [11393520, 5e-09], [11832720, 5e-09], [12271920, 1e-09]], "grad_clip": 0.5, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.1, "final_epsilon": 0.01, "epsilon_timesteps": 1387080}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 43920, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x16b7b79d0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1178.0431406497955, "iterations_since_restore": 29, "perf": {"cpu_util_percent": 20.429090909090906, "ram_util_percent": 68.96363636363637}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 2.5000000000000005e-05, "entropy_coeff": 0.049999999999999996, "policy_entropy": -1653.0965305695381, "policy_loss": -5.9332303607471866e+19, "vf_loss": 303668298.04664725}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 20237.5, "diff_num_grad_updates_vs_sampler_policy": 20236.5}}, "num_env_steps_sampled": 2565600, "num_env_steps_trained": 2565600, "num_agent_steps_sampled": 2565600, "num_agent_steps_trained": 2565600}, "sampler_results": {"episode_reward_max": -1348824.8954038802, "episode_reward_min": -1369366.2314788997, "episode_reward_mean": -1353466.0964962558, "episode_len_mean": 43920.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1369366.2314788997, -1361335.2082701626, -1354747.2510403998, -1351385.668151872, -1353878.0036070035, -1353934.4440263135, -1349299.1822382265, -1352848.977192731, -1354881.8648155385, -1350293.381402571, -1351982.609620888, -1355148.9106643137, -1353355.7607168008, -1351316.0660699722, -1348824.8954038802, -1353463.9545051646, -1350201.1795549188, -1352786.6794055027, -1352053.2572481462, -1352558.3135243794, -1358466.517990561, -1351346.3540966634, -1351505.6693919636, -1353330.2319483531, -1351757.3621417605, -1351111.1344867356, -1352960.1558008753, -1353830.0290992912, -1352774.403007062, -1353239.1979867364], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.14515311810563658, "mean_inference_ms": 0.25767514722795615, "mean_action_processing_ms": 0.06103405688134147, "mean_env_wait_ms": 0.4862237907926337, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0024286905924479165, "StateBufferConnector_ms": 0.0017158190409342449, "ViewRequirementAgentConnector_ms": 0.04523754119873047}}, "episode_reward_max": -1348824.8954038802, "episode_reward_min": -1369366.2314788997, "episode_reward_mean": -1353466.0964962558, "episode_len_mean": 43920.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1369366.2314788997, -1361335.2082701626, -1354747.2510403998, -1351385.668151872, -1353878.0036070035, -1353934.4440263135, -1349299.1822382265, -1352848.977192731, -1354881.8648155385, -1350293.381402571, -1351982.609620888, -1355148.9106643137, -1353355.7607168008, -1351316.0660699722, -1348824.8954038802, -1353463.9545051646, -1350201.1795549188, -1352786.6794055027, -1352053.2572481462, -1352558.3135243794, -1358466.517990561, -1351346.3540966634, -1351505.6693919636, -1353330.2319483531, -1351757.3621417605, -1351111.1344867356, -1352960.1558008753, -1353830.0290992912, -1352774.403007062, -1353239.1979867364], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.14515311810563658, "mean_inference_ms": 0.25767514722795615, "mean_action_processing_ms": 0.06103405688134147, "mean_env_wait_ms": 0.4862237907926337, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0024286905924479165, "StateBufferConnector_ms": 0.0017158190409342449, "ViewRequirementAgentConnector_ms": 0.04523754119873047}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2565600, "num_agent_steps_trained": 2565600, "num_env_steps_sampled": 2565600, "num_env_steps_trained": 2565600, "num_env_steps_sampled_this_iter": 43920, "num_env_steps_trained_this_iter": 43920, "num_env_steps_sampled_throughput_per_sec": 1113.5904842241798, "num_env_steps_trained_throughput_per_sec": 1113.5904842241798, "timesteps_total": 2565600, "num_steps_trained_this_iter": 43920, "agent_timesteps_total": 2565600, "timers": {"training_iteration_time_ms": 39345.373, "sample_time_ms": 38607.072, "load_time_ms": 12.553, "load_throughput": 3498878.082, "learn_time_ms": 724.935, "learn_throughput": 60584.739, "synch_weights_time_ms": 0.695}, "counters": {"num_env_steps_sampled": 2565600, "num_env_steps_trained": 2565600, "num_agent_steps_sampled": 2565600, "num_agent_steps_trained": 2565600}, "done": false, "episodes_total": 1249, "training_iteration": 370, "trial_id": "d8b7e_00000", "date": "2023-07-27_05-31-29", "timestamp": 1690425089, "time_this_iter_s": 39.44201612472534, "time_total_s": 5885.029914617538, "pid": 18921, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 366, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[1291920, 5e-05], [1731120, 8e-05], [2170320, 2.5e-05], [2609520, 2.5e-05], [3048720, 2.5e-05], [3487920, 2.5e-05], [3927120, 1e-05], [4366320, 1e-05], [4805520, 1e-05], [5244720, 5e-06], [5683920, 5e-06], [6123120, 5e-06], [6562320, 5e-06], [7001520, 1e-06], [7440720, 1e-06], [7879920, 1e-06], [8319120, 1e-06], [8758320, 5e-07], [9197520, 5e-07], [9636720, 2.5e-07], [10075920, 2.5e-07], [10515120, 1e-08], [10954320, 1e-08], [11393520, 5e-09], [11832720, 5e-09], [12271920, 1e-09]], "grad_clip": 0.5, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.1, "final_epsilon": 0.01, "epsilon_timesteps": 1387080}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 43920, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x16b7b79d0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1217.4851567745209, "iterations_since_restore": 30, "perf": {"cpu_util_percent": 17.358928571428574, "ram_util_percent": 69.03035714285714}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 2.5000000000000005e-05, "entropy_coeff": 0.049999999999999996, "policy_entropy": -1639.5567817354342, "policy_loss": -4.705150480340656e+19, "vf_loss": 302996523.2069971}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 20923.5, "diff_num_grad_updates_vs_sampler_policy": 20922.5}}, "num_env_steps_sampled": 2609520, "num_env_steps_trained": 2609520, "num_agent_steps_sampled": 2609520, "num_agent_steps_trained": 2609520}, "sampler_results": {"episode_reward_max": -1348824.8954038802, "episode_reward_min": -1369366.2314788997, "episode_reward_mean": -1353415.6798176444, "episode_len_mean": 43920.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1369366.2314788997, -1361335.2082701626, -1354747.2510403998, -1351385.668151872, -1353878.0036070035, -1353934.4440263135, -1349299.1822382265, -1352848.977192731, -1354881.8648155385, -1350293.381402571, -1351982.609620888, -1355148.9106643137, -1353355.7607168008, -1351316.0660699722, -1348824.8954038802, -1353463.9545051646, -1350201.1795549188, -1352786.6794055027, -1352053.2572481462, -1352558.3135243794, -1358466.517990561, -1351346.3540966634, -1351505.6693919636, -1353330.2319483531, -1351757.3621417605, -1351111.1344867356, -1352960.1558008753, -1353830.0290992912, -1352774.403007062, -1353239.1979867364, -1351903.1794592983], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1449239444432898, "mean_inference_ms": 0.25713702393122106, "mean_action_processing_ms": 0.0609435992691976, "mean_env_wait_ms": 0.48524333446911416, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0024126422020696826, "StateBufferConnector_ms": 0.0017043082944808467, "ViewRequirementAgentConnector_ms": 0.04519647167574975}}, "episode_reward_max": -1348824.8954038802, "episode_reward_min": -1369366.2314788997, "episode_reward_mean": -1353415.6798176444, "episode_len_mean": 43920.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1369366.2314788997, -1361335.2082701626, -1354747.2510403998, -1351385.668151872, -1353878.0036070035, -1353934.4440263135, -1349299.1822382265, -1352848.977192731, -1354881.8648155385, -1350293.381402571, -1351982.609620888, -1355148.9106643137, -1353355.7607168008, -1351316.0660699722, -1348824.8954038802, -1353463.9545051646, -1350201.1795549188, -1352786.6794055027, -1352053.2572481462, -1352558.3135243794, -1358466.517990561, -1351346.3540966634, -1351505.6693919636, -1353330.2319483531, -1351757.3621417605, -1351111.1344867356, -1352960.1558008753, -1353830.0290992912, -1352774.403007062, -1353239.1979867364, -1351903.1794592983], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1449239444432898, "mean_inference_ms": 0.25713702393122106, "mean_action_processing_ms": 0.0609435992691976, "mean_env_wait_ms": 0.48524333446911416, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0024126422020696826, "StateBufferConnector_ms": 0.0017043082944808467, "ViewRequirementAgentConnector_ms": 0.04519647167574975}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2609520, "num_agent_steps_trained": 2609520, "num_env_steps_sampled": 2609520, "num_env_steps_trained": 2609520, "num_env_steps_sampled_this_iter": 43920, "num_env_steps_trained_this_iter": 43920, "num_env_steps_sampled_throughput_per_sec": 1119.6692689404656, "num_env_steps_trained_throughput_per_sec": 1119.6692689404656, "timesteps_total": 2609520, "num_steps_trained_this_iter": 43920, "agent_timesteps_total": 2609520, "timers": {"training_iteration_time_ms": 39317.392, "sample_time_ms": 38579.814, "load_time_ms": 12.452, "load_throughput": 3527142.438, "learn_time_ms": 724.317, "learn_throughput": 60636.414, "synch_weights_time_ms": 0.691}, "counters": {"num_env_steps_sampled": 2609520, "num_env_steps_trained": 2609520, "num_agent_steps_sampled": 2609520, "num_agent_steps_trained": 2609520}, "done": false, "episodes_total": 1250, "training_iteration": 371, "trial_id": "d8b7e_00000", "date": "2023-07-27_05-32-08", "timestamp": 1690425128, "time_this_iter_s": 39.228018045425415, "time_total_s": 5924.257932662964, "pid": 18921, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 366, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[1291920, 5e-05], [1731120, 8e-05], [2170320, 2.5e-05], [2609520, 2.5e-05], [3048720, 2.5e-05], [3487920, 2.5e-05], [3927120, 1e-05], [4366320, 1e-05], [4805520, 1e-05], [5244720, 5e-06], [5683920, 5e-06], [6123120, 5e-06], [6562320, 5e-06], [7001520, 1e-06], [7440720, 1e-06], [7879920, 1e-06], [8319120, 1e-06], [8758320, 5e-07], [9197520, 5e-07], [9636720, 2.5e-07], [10075920, 2.5e-07], [10515120, 1e-08], [10954320, 1e-08], [11393520, 5e-09], [11832720, 5e-09], [12271920, 1e-09]], "grad_clip": 0.5, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.1, "final_epsilon": 0.01, "epsilon_timesteps": 1387080}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 43920, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x16b7b79d0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1256.7131748199463, "iterations_since_restore": 31, "perf": {"cpu_util_percent": 18.182142857142857, "ram_util_percent": 69.1}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 2.5000000000000005e-05, "entropy_coeff": 0.049999999999999996, "policy_entropy": -1620.1082338383178, "policy_loss": -3.234382154797982e+19, "vf_loss": 303647874.08746356}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 21609.5, "diff_num_grad_updates_vs_sampler_policy": 21608.5}}, "num_env_steps_sampled": 2653440, "num_env_steps_trained": 2653440, "num_agent_steps_sampled": 2653440, "num_agent_steps_trained": 2653440}, "sampler_results": {"episode_reward_max": -1348824.8954038802, "episode_reward_min": -1369366.2314788997, "episode_reward_mean": -1353408.7873391937, "episode_len_mean": 43920.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1369366.2314788997, -1361335.2082701626, -1354747.2510403998, -1351385.668151872, -1353878.0036070035, -1353934.4440263135, -1349299.1822382265, -1352848.977192731, -1354881.8648155385, -1350293.381402571, -1351982.609620888, -1355148.9106643137, -1353355.7607168008, -1351316.0660699722, -1348824.8954038802, -1353463.9545051646, -1350201.1795549188, -1352786.6794055027, -1352053.2572481462, -1352558.3135243794, -1358466.517990561, -1351346.3540966634, -1351505.6693919636, -1353330.2319483531, -1351757.3621417605, -1351111.1344867356, -1352960.1558008753, -1353830.0290992912, -1352774.403007062, -1353239.1979867364, -1351903.1794592983, -1353195.1205072168], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1447058469058711, "mean_inference_ms": 0.2566237762490273, "mean_action_processing_ms": 0.060857175911036406, "mean_env_wait_ms": 0.48431068947713085, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002402067184448242, "StateBufferConnector_ms": 0.0016920268535614014, "ViewRequirementAgentConnector_ms": 0.045168399810791016}}, "episode_reward_max": -1348824.8954038802, "episode_reward_min": -1369366.2314788997, "episode_reward_mean": -1353408.7873391937, "episode_len_mean": 43920.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1369366.2314788997, -1361335.2082701626, -1354747.2510403998, -1351385.668151872, -1353878.0036070035, -1353934.4440263135, -1349299.1822382265, -1352848.977192731, -1354881.8648155385, -1350293.381402571, -1351982.609620888, -1355148.9106643137, -1353355.7607168008, -1351316.0660699722, -1348824.8954038802, -1353463.9545051646, -1350201.1795549188, -1352786.6794055027, -1352053.2572481462, -1352558.3135243794, -1358466.517990561, -1351346.3540966634, -1351505.6693919636, -1353330.2319483531, -1351757.3621417605, -1351111.1344867356, -1352960.1558008753, -1353830.0290992912, -1352774.403007062, -1353239.1979867364, -1351903.1794592983, -1353195.1205072168], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1447058469058711, "mean_inference_ms": 0.2566237762490273, "mean_action_processing_ms": 0.060857175911036406, "mean_env_wait_ms": 0.48431068947713085, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002402067184448242, "StateBufferConnector_ms": 0.0016920268535614014, "ViewRequirementAgentConnector_ms": 0.045168399810791016}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2653440, "num_agent_steps_trained": 2653440, "num_env_steps_sampled": 2653440, "num_env_steps_trained": 2653440, "num_env_steps_sampled_this_iter": 43920, "num_env_steps_trained_this_iter": 43920, "num_env_steps_sampled_throughput_per_sec": 1117.5975471097518, "num_env_steps_trained_throughput_per_sec": 1117.5975471097518, "timesteps_total": 2653440, "num_steps_trained_this_iter": 43920, "agent_timesteps_total": 2653440, "timers": {"training_iteration_time_ms": 39300.463, "sample_time_ms": 38562.104, "load_time_ms": 12.484, "load_throughput": 3518042.108, "learn_time_ms": 725.065, "learn_throughput": 60573.896, "synch_weights_time_ms": 0.693}, "counters": {"num_env_steps_sampled": 2653440, "num_env_steps_trained": 2653440, "num_agent_steps_sampled": 2653440, "num_agent_steps_trained": 2653440}, "done": false, "episodes_total": 1251, "training_iteration": 372, "trial_id": "d8b7e_00000", "date": "2023-07-27_05-32-48", "timestamp": 1690425168, "time_this_iter_s": 39.300556898117065, "time_total_s": 5963.558489561081, "pid": 18921, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 366, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[1291920, 5e-05], [1731120, 8e-05], [2170320, 2.5e-05], [2609520, 2.5e-05], [3048720, 2.5e-05], [3487920, 2.5e-05], [3927120, 1e-05], [4366320, 1e-05], [4805520, 1e-05], [5244720, 5e-06], [5683920, 5e-06], [6123120, 5e-06], [6562320, 5e-06], [7001520, 1e-06], [7440720, 1e-06], [7879920, 1e-06], [8319120, 1e-06], [8758320, 5e-07], [9197520, 5e-07], [9636720, 2.5e-07], [10075920, 2.5e-07], [10515120, 1e-08], [10954320, 1e-08], [11393520, 5e-09], [11832720, 5e-09], [12271920, 1e-09]], "grad_clip": 0.5, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.1, "final_epsilon": 0.01, "epsilon_timesteps": 1387080}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 43920, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x16b7b79d0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1296.0137317180634, "iterations_since_restore": 32, "perf": {"cpu_util_percent": 18.10181818181818, "ram_util_percent": 69.1090909090909}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 2.5000000000000005e-05, "entropy_coeff": 0.049999999999999996, "policy_entropy": -1658.5942418401512, "policy_loss": -8.811419305385225e+19, "vf_loss": 302405341.819242}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 22295.5, "diff_num_grad_updates_vs_sampler_policy": 22294.5}}, "num_env_steps_sampled": 2697360, "num_env_steps_trained": 2697360, "num_agent_steps_sampled": 2697360, "num_agent_steps_trained": 2697360}, "sampler_results": {"episode_reward_max": -1348824.8954038802, "episode_reward_min": -1369366.2314788997, "episode_reward_mean": -1353321.9994343268, "episode_len_mean": 43920.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1369366.2314788997, -1361335.2082701626, -1354747.2510403998, -1351385.668151872, -1353878.0036070035, -1353934.4440263135, -1349299.1822382265, -1352848.977192731, -1354881.8648155385, -1350293.381402571, -1351982.609620888, -1355148.9106643137, -1353355.7607168008, -1351316.0660699722, -1348824.8954038802, -1353463.9545051646, -1350201.1795549188, -1352786.6794055027, -1352053.2572481462, -1352558.3135243794, -1358466.517990561, -1351346.3540966634, -1351505.6693919636, -1353330.2319483531, -1351757.3621417605, -1351111.1344867356, -1352960.1558008753, -1353830.0290992912, -1352774.403007062, -1353239.1979867364, -1351903.1794592983, -1353195.1205072168, -1350544.7864785872], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1444981899062575, "mean_inference_ms": 0.2561333337869604, "mean_action_processing_ms": 0.060774770607011364, "mean_env_wait_ms": 0.4834201463917368, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002394300518613873, "StateBufferConnector_ms": 0.0016927719116210938, "ViewRequirementAgentConnector_ms": 0.04520055019494259}}, "episode_reward_max": -1348824.8954038802, "episode_reward_min": -1369366.2314788997, "episode_reward_mean": -1353321.9994343268, "episode_len_mean": 43920.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1369366.2314788997, -1361335.2082701626, -1354747.2510403998, -1351385.668151872, -1353878.0036070035, -1353934.4440263135, -1349299.1822382265, -1352848.977192731, -1354881.8648155385, -1350293.381402571, -1351982.609620888, -1355148.9106643137, -1353355.7607168008, -1351316.0660699722, -1348824.8954038802, -1353463.9545051646, -1350201.1795549188, -1352786.6794055027, -1352053.2572481462, -1352558.3135243794, -1358466.517990561, -1351346.3540966634, -1351505.6693919636, -1353330.2319483531, -1351757.3621417605, -1351111.1344867356, -1352960.1558008753, -1353830.0290992912, -1352774.403007062, -1353239.1979867364, -1351903.1794592983, -1353195.1205072168, -1350544.7864785872], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1444981899062575, "mean_inference_ms": 0.2561333337869604, "mean_action_processing_ms": 0.060774770607011364, "mean_env_wait_ms": 0.4834201463917368, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002394300518613873, "StateBufferConnector_ms": 0.0016927719116210938, "ViewRequirementAgentConnector_ms": 0.04520055019494259}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2697360, "num_agent_steps_trained": 2697360, "num_env_steps_sampled": 2697360, "num_env_steps_trained": 2697360, "num_env_steps_sampled_this_iter": 43920, "num_env_steps_trained_this_iter": 43920, "num_env_steps_sampled_throughput_per_sec": 1120.0735705395634, "num_env_steps_trained_throughput_per_sec": 1120.0735705395634, "timesteps_total": 2697360, "num_steps_trained_this_iter": 43920, "agent_timesteps_total": 2697360, "timers": {"training_iteration_time_ms": 39277.392, "sample_time_ms": 38537.556, "load_time_ms": 12.585, "load_throughput": 3489969.113, "learn_time_ms": 726.448, "learn_throughput": 60458.529, "synch_weights_time_ms": 0.685}, "counters": {"num_env_steps_sampled": 2697360, "num_env_steps_trained": 2697360, "num_agent_steps_sampled": 2697360, "num_agent_steps_trained": 2697360}, "done": false, "episodes_total": 1252, "training_iteration": 373, "trial_id": "d8b7e_00000", "date": "2023-07-27_05-33-27", "timestamp": 1690425207, "time_this_iter_s": 39.21371531486511, "time_total_s": 6002.772204875946, "pid": 18921, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 366, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[1291920, 5e-05], [1731120, 8e-05], [2170320, 2.5e-05], [2609520, 2.5e-05], [3048720, 2.5e-05], [3487920, 2.5e-05], [3927120, 1e-05], [4366320, 1e-05], [4805520, 1e-05], [5244720, 5e-06], [5683920, 5e-06], [6123120, 5e-06], [6562320, 5e-06], [7001520, 1e-06], [7440720, 1e-06], [7879920, 1e-06], [8319120, 1e-06], [8758320, 5e-07], [9197520, 5e-07], [9636720, 2.5e-07], [10075920, 2.5e-07], [10515120, 1e-08], [10954320, 1e-08], [11393520, 5e-09], [11832720, 5e-09], [12271920, 1e-09]], "grad_clip": 0.5, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.1, "final_epsilon": 0.01, "epsilon_timesteps": 1387080}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 43920, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x16b7b79d0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1335.2274470329285, "iterations_since_restore": 33, "perf": {"cpu_util_percent": 19.166071428571428, "ram_util_percent": 69.17321428571428}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 2.5000000000000005e-05, "entropy_coeff": 0.049999999999999996, "policy_entropy": -1647.6359452228157, "policy_loss": -7.1350035966101135e+19, "vf_loss": 302848900.5947522}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 22981.5, "diff_num_grad_updates_vs_sampler_policy": 22980.5}}, "num_env_steps_sampled": 2741280, "num_env_steps_trained": 2741280, "num_agent_steps_sampled": 2741280, "num_agent_steps_trained": 2741280}, "sampler_results": {"episode_reward_max": -1348824.8954038802, "episode_reward_min": -1369366.2314788997, "episode_reward_mean": -1353274.7261478323, "episode_len_mean": 43920.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1369366.2314788997, -1361335.2082701626, -1354747.2510403998, -1351385.668151872, -1353878.0036070035, -1353934.4440263135, -1349299.1822382265, -1352848.977192731, -1354881.8648155385, -1350293.381402571, -1351982.609620888, -1355148.9106643137, -1353355.7607168008, -1351316.0660699722, -1348824.8954038802, -1353463.9545051646, -1350201.1795549188, -1352786.6794055027, -1352053.2572481462, -1352558.3135243794, -1358466.517990561, -1351346.3540966634, -1351505.6693919636, -1353330.2319483531, -1351757.3621417605, -1351111.1344867356, -1352960.1558008753, -1353830.0290992912, -1352774.403007062, -1353239.1979867364, -1351903.1794592983, -1353195.1205072168, -1350544.7864785872, -1351714.7076935158], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.14429974134242696, "mean_inference_ms": 0.2556655666598907, "mean_action_processing_ms": 0.06069614364051129, "mean_env_wait_ms": 0.4825730769127662, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002389795639935662, "StateBufferConnector_ms": 0.0017018879161161534, "ViewRequirementAgentConnector_ms": 0.04517050350413603}}, "episode_reward_max": -1348824.8954038802, "episode_reward_min": -1369366.2314788997, "episode_reward_mean": -1353274.7261478323, "episode_len_mean": 43920.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1369366.2314788997, -1361335.2082701626, -1354747.2510403998, -1351385.668151872, -1353878.0036070035, -1353934.4440263135, -1349299.1822382265, -1352848.977192731, -1354881.8648155385, -1350293.381402571, -1351982.609620888, -1355148.9106643137, -1353355.7607168008, -1351316.0660699722, -1348824.8954038802, -1353463.9545051646, -1350201.1795549188, -1352786.6794055027, -1352053.2572481462, -1352558.3135243794, -1358466.517990561, -1351346.3540966634, -1351505.6693919636, -1353330.2319483531, -1351757.3621417605, -1351111.1344867356, -1352960.1558008753, -1353830.0290992912, -1352774.403007062, -1353239.1979867364, -1351903.1794592983, -1353195.1205072168, -1350544.7864785872, -1351714.7076935158], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.14429974134242696, "mean_inference_ms": 0.2556655666598907, "mean_action_processing_ms": 0.06069614364051129, "mean_env_wait_ms": 0.4825730769127662, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002389795639935662, "StateBufferConnector_ms": 0.0017018879161161534, "ViewRequirementAgentConnector_ms": 0.04517050350413603}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2741280, "num_agent_steps_trained": 2741280, "num_env_steps_sampled": 2741280, "num_env_steps_trained": 2741280, "num_env_steps_sampled_this_iter": 43920, "num_env_steps_trained_this_iter": 43920, "num_env_steps_sampled_throughput_per_sec": 1112.0813390318172, "num_env_steps_trained_throughput_per_sec": 1112.0813390318172, "timesteps_total": 2741280, "num_steps_trained_this_iter": 43920, "agent_timesteps_total": 2741280, "timers": {"training_iteration_time_ms": 39295.733, "sample_time_ms": 38559.165, "load_time_ms": 12.616, "load_throughput": 3481197.496, "learn_time_ms": 723.154, "learn_throughput": 60733.97, "synch_weights_time_ms": 0.68}, "counters": {"num_env_steps_sampled": 2741280, "num_env_steps_trained": 2741280, "num_agent_steps_sampled": 2741280, "num_agent_steps_trained": 2741280}, "done": false, "episodes_total": 1253, "training_iteration": 374, "trial_id": "d8b7e_00000", "date": "2023-07-27_05-34-07", "timestamp": 1690425247, "time_this_iter_s": 39.495463848114014, "time_total_s": 6042.26766872406, "pid": 18921, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 366, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[1291920, 5e-05], [1731120, 8e-05], [2170320, 2.5e-05], [2609520, 2.5e-05], [3048720, 2.5e-05], [3487920, 2.5e-05], [3927120, 1e-05], [4366320, 1e-05], [4805520, 1e-05], [5244720, 5e-06], [5683920, 5e-06], [6123120, 5e-06], [6562320, 5e-06], [7001520, 1e-06], [7440720, 1e-06], [7879920, 1e-06], [8319120, 1e-06], [8758320, 5e-07], [9197520, 5e-07], [9636720, 2.5e-07], [10075920, 2.5e-07], [10515120, 1e-08], [10954320, 1e-08], [11393520, 5e-09], [11832720, 5e-09], [12271920, 1e-09]], "grad_clip": 0.5, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.1, "final_epsilon": 0.01, "epsilon_timesteps": 1387080}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 43920, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x16b7b79d0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1374.7229108810425, "iterations_since_restore": 34, "perf": {"cpu_util_percent": 18.032142857142855, "ram_util_percent": 69.2}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 2.5000000000000005e-05, "entropy_coeff": 0.049999999999999996, "policy_entropy": -1657.842833760876, "policy_loss": -9.385269677564858e+19, "vf_loss": 303913816.79883385}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 23667.5, "diff_num_grad_updates_vs_sampler_policy": 23666.5}}, "num_env_steps_sampled": 2785200, "num_env_steps_trained": 2785200, "num_agent_steps_sampled": 2785200, "num_agent_steps_trained": 2785200}, "sampler_results": {"episode_reward_max": -1348824.8954038802, "episode_reward_min": -1369366.2314788997, "episode_reward_mean": -1353289.9718725435, "episode_len_mean": 43920.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1369366.2314788997, -1361335.2082701626, -1354747.2510403998, -1351385.668151872, -1353878.0036070035, -1353934.4440263135, -1349299.1822382265, -1352848.977192731, -1354881.8648155385, -1350293.381402571, -1351982.609620888, -1355148.9106643137, -1353355.7607168008, -1351316.0660699722, -1348824.8954038802, -1353463.9545051646, -1350201.1795549188, -1352786.6794055027, -1352053.2572481462, -1352558.3135243794, -1358466.517990561, -1351346.3540966634, -1351505.6693919636, -1353330.2319483531, -1351757.3621417605, -1351111.1344867356, -1352960.1558008753, -1353830.0290992912, -1352774.403007062, -1353239.1979867364, -1351903.1794592983, -1353195.1205072168, -1350544.7864785872, -1351714.7076935158, -1353808.3265127144], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1441089741500726, "mean_inference_ms": 0.25521850362296683, "mean_action_processing_ms": 0.06062099818688202, "mean_env_wait_ms": 0.48176848988045484, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002373286655970982, "StateBufferConnector_ms": 0.001693453107561384, "ViewRequirementAgentConnector_ms": 0.045140130179268975}}, "episode_reward_max": -1348824.8954038802, "episode_reward_min": -1369366.2314788997, "episode_reward_mean": -1353289.9718725435, "episode_len_mean": 43920.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1369366.2314788997, -1361335.2082701626, -1354747.2510403998, -1351385.668151872, -1353878.0036070035, -1353934.4440263135, -1349299.1822382265, -1352848.977192731, -1354881.8648155385, -1350293.381402571, -1351982.609620888, -1355148.9106643137, -1353355.7607168008, -1351316.0660699722, -1348824.8954038802, -1353463.9545051646, -1350201.1795549188, -1352786.6794055027, -1352053.2572481462, -1352558.3135243794, -1358466.517990561, -1351346.3540966634, -1351505.6693919636, -1353330.2319483531, -1351757.3621417605, -1351111.1344867356, -1352960.1558008753, -1353830.0290992912, -1352774.403007062, -1353239.1979867364, -1351903.1794592983, -1353195.1205072168, -1350544.7864785872, -1351714.7076935158, -1353808.3265127144], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1441089741500726, "mean_inference_ms": 0.25521850362296683, "mean_action_processing_ms": 0.06062099818688202, "mean_env_wait_ms": 0.48176848988045484, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002373286655970982, "StateBufferConnector_ms": 0.001693453107561384, "ViewRequirementAgentConnector_ms": 0.045140130179268975}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2785200, "num_agent_steps_trained": 2785200, "num_env_steps_sampled": 2785200, "num_env_steps_trained": 2785200, "num_env_steps_sampled_this_iter": 43920, "num_env_steps_trained_this_iter": 43920, "num_env_steps_sampled_throughput_per_sec": 1111.0973960866434, "num_env_steps_trained_throughput_per_sec": 1111.0973960866434, "timesteps_total": 2785200, "num_steps_trained_this_iter": 43920, "agent_timesteps_total": 2785200, "timers": {"training_iteration_time_ms": 39329.701, "sample_time_ms": 38593.049, "load_time_ms": 12.48, "load_throughput": 3519298.938, "learn_time_ms": 723.382, "learn_throughput": 60714.795, "synch_weights_time_ms": 0.674}, "counters": {"num_env_steps_sampled": 2785200, "num_env_steps_trained": 2785200, "num_agent_steps_sampled": 2785200, "num_agent_steps_trained": 2785200}, "done": false, "episodes_total": 1254, "training_iteration": 375, "trial_id": "d8b7e_00000", "date": "2023-07-27_05-34-46", "timestamp": 1690425286, "time_this_iter_s": 39.53076410293579, "time_total_s": 6081.798432826996, "pid": 18921, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 366, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[1291920, 5e-05], [1731120, 8e-05], [2170320, 2.5e-05], [2609520, 2.5e-05], [3048720, 2.5e-05], [3487920, 2.5e-05], [3927120, 1e-05], [4366320, 1e-05], [4805520, 1e-05], [5244720, 5e-06], [5683920, 5e-06], [6123120, 5e-06], [6562320, 5e-06], [7001520, 1e-06], [7440720, 1e-06], [7879920, 1e-06], [8319120, 1e-06], [8758320, 5e-07], [9197520, 5e-07], [9636720, 2.5e-07], [10075920, 2.5e-07], [10515120, 1e-08], [10954320, 1e-08], [11393520, 5e-09], [11832720, 5e-09], [12271920, 1e-09]], "grad_clip": 0.5, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.1, "final_epsilon": 0.01, "epsilon_timesteps": 1387080}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 43920, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x16b7b79d0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1414.2536749839783, "iterations_since_restore": 35, "perf": {"cpu_util_percent": 18.069642857142856, "ram_util_percent": 69.06607142857143}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 2.5000000000000005e-05, "entropy_coeff": 0.049999999999999996, "policy_entropy": -1666.715961067044, "policy_loss": -1.0736507319070197e+20, "vf_loss": 304173826.2623907}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 24353.5, "diff_num_grad_updates_vs_sampler_policy": 24352.5}}, "num_env_steps_sampled": 2829120, "num_env_steps_trained": 2829120, "num_agent_steps_sampled": 2829120, "num_agent_steps_trained": 2829120}, "sampler_results": {"episode_reward_max": -1348824.8954038802, "episode_reward_min": -1369366.2314788997, "episode_reward_mean": -1353322.672081829, "episode_len_mean": 43920.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1369366.2314788997, -1361335.2082701626, -1354747.2510403998, -1351385.668151872, -1353878.0036070035, -1353934.4440263135, -1349299.1822382265, -1352848.977192731, -1354881.8648155385, -1350293.381402571, -1351982.609620888, -1355148.9106643137, -1353355.7607168008, -1351316.0660699722, -1348824.8954038802, -1353463.9545051646, -1350201.1795549188, -1352786.6794055027, -1352053.2572481462, -1352558.3135243794, -1358466.517990561, -1351346.3540966634, -1351505.6693919636, -1353330.2319483531, -1351757.3621417605, -1351111.1344867356, -1352960.1558008753, -1353830.0290992912, -1352774.403007062, -1353239.1979867364, -1351903.1794592983, -1353195.1205072168, -1350544.7864785872, -1351714.7076935158, -1353808.3265127144, -1354467.1794068213], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.14392603693415243, "mean_inference_ms": 0.25479030965642413, "mean_action_processing_ms": 0.06054895255943349, "mean_env_wait_ms": 0.481001270255818, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0023649798499213327, "StateBufferConnector_ms": 0.0017000569237603082, "ViewRequirementAgentConnector_ms": 0.045103496975368924}}, "episode_reward_max": -1348824.8954038802, "episode_reward_min": -1369366.2314788997, "episode_reward_mean": -1353322.672081829, "episode_len_mean": 43920.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1369366.2314788997, -1361335.2082701626, -1354747.2510403998, -1351385.668151872, -1353878.0036070035, -1353934.4440263135, -1349299.1822382265, -1352848.977192731, -1354881.8648155385, -1350293.381402571, -1351982.609620888, -1355148.9106643137, -1353355.7607168008, -1351316.0660699722, -1348824.8954038802, -1353463.9545051646, -1350201.1795549188, -1352786.6794055027, -1352053.2572481462, -1352558.3135243794, -1358466.517990561, -1351346.3540966634, -1351505.6693919636, -1353330.2319483531, -1351757.3621417605, -1351111.1344867356, -1352960.1558008753, -1353830.0290992912, -1352774.403007062, -1353239.1979867364, -1351903.1794592983, -1353195.1205072168, -1350544.7864785872, -1351714.7076935158, -1353808.3265127144, -1354467.1794068213], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.14392603693415243, "mean_inference_ms": 0.25479030965642413, "mean_action_processing_ms": 0.06054895255943349, "mean_env_wait_ms": 0.481001270255818, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0023649798499213327, "StateBufferConnector_ms": 0.0017000569237603082, "ViewRequirementAgentConnector_ms": 0.045103496975368924}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2829120, "num_agent_steps_trained": 2829120, "num_env_steps_sampled": 2829120, "num_env_steps_trained": 2829120, "num_env_steps_sampled_this_iter": 43920, "num_env_steps_trained_this_iter": 43920, "num_env_steps_sampled_throughput_per_sec": 1114.4907634256606, "num_env_steps_trained_throughput_per_sec": 1114.4907634256606, "timesteps_total": 2829120, "num_steps_trained_this_iter": 43920, "agent_timesteps_total": 2829120, "timers": {"training_iteration_time_ms": 39329.124, "sample_time_ms": 38592.859, "load_time_ms": 12.475, "load_throughput": 3520644.135, "learn_time_ms": 723.007, "learn_throughput": 60746.337, "synch_weights_time_ms": 0.668}, "counters": {"num_env_steps_sampled": 2829120, "num_env_steps_trained": 2829120, "num_agent_steps_sampled": 2829120, "num_agent_steps_trained": 2829120}, "done": false, "episodes_total": 1255, "training_iteration": 376, "trial_id": "d8b7e_00000", "date": "2023-07-27_05-35-25", "timestamp": 1690425325, "time_this_iter_s": 39.4104208946228, "time_total_s": 6121.208853721619, "pid": 18921, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 366, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[1291920, 5e-05], [1731120, 8e-05], [2170320, 2.5e-05], [2609520, 2.5e-05], [3048720, 2.5e-05], [3487920, 2.5e-05], [3927120, 1e-05], [4366320, 1e-05], [4805520, 1e-05], [5244720, 5e-06], [5683920, 5e-06], [6123120, 5e-06], [6562320, 5e-06], [7001520, 1e-06], [7440720, 1e-06], [7879920, 1e-06], [8319120, 1e-06], [8758320, 5e-07], [9197520, 5e-07], [9636720, 2.5e-07], [10075920, 2.5e-07], [10515120, 1e-08], [10954320, 1e-08], [11393520, 5e-09], [11832720, 5e-09], [12271920, 1e-09]], "grad_clip": 0.5, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.1, "final_epsilon": 0.01, "epsilon_timesteps": 1387080}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 43920, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x16b7b79d0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1453.664095878601, "iterations_since_restore": 36, "perf": {"cpu_util_percent": 18.007142857142856, "ram_util_percent": 69.00178571428572}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 2.5000000000000005e-05, "entropy_coeff": 0.049999999999999996, "policy_entropy": -1656.6882463015897, "policy_loss": -9.150415431098856e+19, "vf_loss": 304114212.97959185}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 25039.5, "diff_num_grad_updates_vs_sampler_policy": 25038.5}}, "num_env_steps_sampled": 2873040, "num_env_steps_trained": 2873040, "num_agent_steps_sampled": 2873040, "num_agent_steps_trained": 2873040}, "sampler_results": {"episode_reward_max": -1348824.8954038802, "episode_reward_min": -1369366.2314788997, "episode_reward_mean": -1353353.28351228, "episode_len_mean": 43920.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1369366.2314788997, -1361335.2082701626, -1354747.2510403998, -1351385.668151872, -1353878.0036070035, -1353934.4440263135, -1349299.1822382265, -1352848.977192731, -1354881.8648155385, -1350293.381402571, -1351982.609620888, -1355148.9106643137, -1353355.7607168008, -1351316.0660699722, -1348824.8954038802, -1353463.9545051646, -1350201.1795549188, -1352786.6794055027, -1352053.2572481462, -1352558.3135243794, -1358466.517990561, -1351346.3540966634, -1351505.6693919636, -1353330.2319483531, -1351757.3621417605, -1351111.1344867356, -1352960.1558008753, -1353830.0290992912, -1352774.403007062, -1353239.1979867364, -1351903.1794592983, -1353195.1205072168, -1350544.7864785872, -1351714.7076935158, -1353808.3265127144, -1354467.1794068213, -1354455.2950085176], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.14375050805975942, "mean_inference_ms": 0.25438042312107223, "mean_action_processing_ms": 0.06048007615314047, "mean_env_wait_ms": 0.4802723265490881, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0023609883076435812, "StateBufferConnector_ms": 0.0016972825333878801, "ViewRequirementAgentConnector_ms": 0.04515003513645481}}, "episode_reward_max": -1348824.8954038802, "episode_reward_min": -1369366.2314788997, "episode_reward_mean": -1353353.28351228, "episode_len_mean": 43920.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1369366.2314788997, -1361335.2082701626, -1354747.2510403998, -1351385.668151872, -1353878.0036070035, -1353934.4440263135, -1349299.1822382265, -1352848.977192731, -1354881.8648155385, -1350293.381402571, -1351982.609620888, -1355148.9106643137, -1353355.7607168008, -1351316.0660699722, -1348824.8954038802, -1353463.9545051646, -1350201.1795549188, -1352786.6794055027, -1352053.2572481462, -1352558.3135243794, -1358466.517990561, -1351346.3540966634, -1351505.6693919636, -1353330.2319483531, -1351757.3621417605, -1351111.1344867356, -1352960.1558008753, -1353830.0290992912, -1352774.403007062, -1353239.1979867364, -1351903.1794592983, -1353195.1205072168, -1350544.7864785872, -1351714.7076935158, -1353808.3265127144, -1354467.1794068213, -1354455.2950085176], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.14375050805975942, "mean_inference_ms": 0.25438042312107223, "mean_action_processing_ms": 0.06048007615314047, "mean_env_wait_ms": 0.4802723265490881, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0023609883076435812, "StateBufferConnector_ms": 0.0016972825333878801, "ViewRequirementAgentConnector_ms": 0.04515003513645481}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2873040, "num_agent_steps_trained": 2873040, "num_env_steps_sampled": 2873040, "num_env_steps_trained": 2873040, "num_env_steps_sampled_this_iter": 43920, "num_env_steps_trained_this_iter": 43920, "num_env_steps_sampled_throughput_per_sec": 1106.7427394836693, "num_env_steps_trained_throughput_per_sec": 1106.7427394836693, "timesteps_total": 2873040, "num_steps_trained_this_iter": 43920, "agent_timesteps_total": 2873040, "timers": {"training_iteration_time_ms": 39366.115, "sample_time_ms": 38629.719, "load_time_ms": 12.493, "load_throughput": 3515531.139, "learn_time_ms": 723.12, "learn_throughput": 60736.829, "synch_weights_time_ms": 0.667}, "counters": {"num_env_steps_sampled": 2873040, "num_env_steps_trained": 2873040, "num_agent_steps_sampled": 2873040, "num_agent_steps_trained": 2873040}, "done": false, "episodes_total": 1256, "training_iteration": 377, "trial_id": "d8b7e_00000", "date": "2023-07-27_05-36-05", "timestamp": 1690425365, "time_this_iter_s": 39.68606781959534, "time_total_s": 6160.894921541214, "pid": 18921, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 366, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[1291920, 5e-05], [1731120, 8e-05], [2170320, 2.5e-05], [2609520, 2.5e-05], [3048720, 2.5e-05], [3487920, 2.5e-05], [3927120, 1e-05], [4366320, 1e-05], [4805520, 1e-05], [5244720, 5e-06], [5683920, 5e-06], [6123120, 5e-06], [6562320, 5e-06], [7001520, 1e-06], [7440720, 1e-06], [7879920, 1e-06], [8319120, 1e-06], [8758320, 5e-07], [9197520, 5e-07], [9636720, 2.5e-07], [10075920, 2.5e-07], [10515120, 1e-08], [10954320, 1e-08], [11393520, 5e-09], [11832720, 5e-09], [12271920, 1e-09]], "grad_clip": 0.5, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.1, "final_epsilon": 0.01, "epsilon_timesteps": 1387080}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 43920, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x16b7b79d0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1493.3501636981964, "iterations_since_restore": 37, "perf": {"cpu_util_percent": 18.525000000000002, "ram_util_percent": 68.89285714285714}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 2.5000000000000005e-05, "entropy_coeff": 0.049999999999999996, "policy_entropy": -1668.2537058838602, "policy_loss": -1.0647987369747666e+20, "vf_loss": 303519256.16909623}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 25725.5, "diff_num_grad_updates_vs_sampler_policy": 25724.5}}, "num_env_steps_sampled": 2916960, "num_env_steps_trained": 2916960, "num_agent_steps_sampled": 2916960, "num_agent_steps_trained": 2916960}, "sampler_results": {"episode_reward_max": -1348824.8954038802, "episode_reward_min": -1369366.2314788997, "episode_reward_mean": -1353340.7655051893, "episode_len_mean": 43920.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1369366.2314788997, -1361335.2082701626, -1354747.2510403998, -1351385.668151872, -1353878.0036070035, -1353934.4440263135, -1349299.1822382265, -1352848.977192731, -1354881.8648155385, -1350293.381402571, -1351982.609620888, -1355148.9106643137, -1353355.7607168008, -1351316.0660699722, -1348824.8954038802, -1353463.9545051646, -1350201.1795549188, -1352786.6794055027, -1352053.2572481462, -1352558.3135243794, -1358466.517990561, -1351346.3540966634, -1351505.6693919636, -1353330.2319483531, -1351757.3621417605, -1351111.1344867356, -1352960.1558008753, -1353830.0290992912, -1352774.403007062, -1353239.1979867364, -1351903.1794592983, -1353195.1205072168, -1350544.7864785872, -1351714.7076935158, -1353808.3265127144, -1354467.1794068213, -1354455.2950085176, -1352877.5992428334], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1435813957107006, "mean_inference_ms": 0.2539870439493481, "mean_action_processing_ms": 0.06041400176076098, "mean_env_wait_ms": 0.47957049143022273, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0023534423426577918, "StateBufferConnector_ms": 0.0016990460847553454, "ViewRequirementAgentConnector_ms": 0.04513263702392578}}, "episode_reward_max": -1348824.8954038802, "episode_reward_min": -1369366.2314788997, "episode_reward_mean": -1353340.7655051893, "episode_len_mean": 43920.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1369366.2314788997, -1361335.2082701626, -1354747.2510403998, -1351385.668151872, -1353878.0036070035, -1353934.4440263135, -1349299.1822382265, -1352848.977192731, -1354881.8648155385, -1350293.381402571, -1351982.609620888, -1355148.9106643137, -1353355.7607168008, -1351316.0660699722, -1348824.8954038802, -1353463.9545051646, -1350201.1795549188, -1352786.6794055027, -1352053.2572481462, -1352558.3135243794, -1358466.517990561, -1351346.3540966634, -1351505.6693919636, -1353330.2319483531, -1351757.3621417605, -1351111.1344867356, -1352960.1558008753, -1353830.0290992912, -1352774.403007062, -1353239.1979867364, -1351903.1794592983, -1353195.1205072168, -1350544.7864785872, -1351714.7076935158, -1353808.3265127144, -1354467.1794068213, -1354455.2950085176, -1352877.5992428334], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1435813957107006, "mean_inference_ms": 0.2539870439493481, "mean_action_processing_ms": 0.06041400176076098, "mean_env_wait_ms": 0.47957049143022273, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0023534423426577918, "StateBufferConnector_ms": 0.0016990460847553454, "ViewRequirementAgentConnector_ms": 0.04513263702392578}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2916960, "num_agent_steps_trained": 2916960, "num_env_steps_sampled": 2916960, "num_env_steps_trained": 2916960, "num_env_steps_sampled_this_iter": 43920, "num_env_steps_trained_this_iter": 43920, "num_env_steps_sampled_throughput_per_sec": 1124.0439581682022, "num_env_steps_trained_throughput_per_sec": 1124.0439581682022, "timesteps_total": 2916960, "num_steps_trained_this_iter": 43920, "agent_timesteps_total": 2916960, "timers": {"training_iteration_time_ms": 39337.291, "sample_time_ms": 38600.04, "load_time_ms": 12.414, "load_throughput": 3537960.73, "learn_time_ms": 724.049, "learn_throughput": 60658.842, "synch_weights_time_ms": 0.671}, "counters": {"num_env_steps_sampled": 2916960, "num_env_steps_trained": 2916960, "num_agent_steps_sampled": 2916960, "num_agent_steps_trained": 2916960}, "done": false, "episodes_total": 1257, "training_iteration": 378, "trial_id": "d8b7e_00000", "date": "2023-07-27_05-36-44", "timestamp": 1690425404, "time_this_iter_s": 39.07553219795227, "time_total_s": 6199.970453739166, "pid": 18921, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 366, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[1291920, 5e-05], [1731120, 8e-05], [2170320, 2.5e-05], [2609520, 2.5e-05], [3048720, 2.5e-05], [3487920, 2.5e-05], [3927120, 1e-05], [4366320, 1e-05], [4805520, 1e-05], [5244720, 5e-06], [5683920, 5e-06], [6123120, 5e-06], [6562320, 5e-06], [7001520, 1e-06], [7440720, 1e-06], [7879920, 1e-06], [8319120, 1e-06], [8758320, 5e-07], [9197520, 5e-07], [9636720, 2.5e-07], [10075920, 2.5e-07], [10515120, 1e-08], [10954320, 1e-08], [11393520, 5e-09], [11832720, 5e-09], [12271920, 1e-09]], "grad_clip": 0.5, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.1, "final_epsilon": 0.01, "epsilon_timesteps": 1387080}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 43920, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x16b7b79d0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1532.4256958961487, "iterations_since_restore": 38, "perf": {"cpu_util_percent": 19.196363636363635, "ram_util_percent": 68.76909090909089}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 2.5000000000000005e-05, "entropy_coeff": 0.049999999999999996, "policy_entropy": -1658.8507645943423, "policy_loss": -9.126109551977208e+19, "vf_loss": 304230647.87172014}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 26411.5, "diff_num_grad_updates_vs_sampler_policy": 26410.5}}, "num_env_steps_sampled": 2960880, "num_env_steps_trained": 2960880, "num_agent_steps_sampled": 2960880, "num_agent_steps_trained": 2960880}, "sampler_results": {"episode_reward_max": -1348824.8954038802, "episode_reward_min": -1369366.2314788997, "episode_reward_mean": -1353373.4551752827, "episode_len_mean": 43920.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1369366.2314788997, -1361335.2082701626, -1354747.2510403998, -1351385.668151872, -1353878.0036070035, -1353934.4440263135, -1349299.1822382265, -1352848.977192731, -1354881.8648155385, -1350293.381402571, -1351982.609620888, -1355148.9106643137, -1353355.7607168008, -1351316.0660699722, -1348824.8954038802, -1353463.9545051646, -1350201.1795549188, -1352786.6794055027, -1352053.2572481462, -1352558.3135243794, -1358466.517990561, -1351346.3540966634, -1351505.6693919636, -1353330.2319483531, -1351757.3621417605, -1351111.1344867356, -1352960.1558008753, -1353830.0290992912, -1352774.403007062, -1353239.1979867364, -1351903.1794592983, -1353195.1205072168, -1350544.7864785872, -1351714.7076935158, -1353808.3265127144, -1354467.1794068213, -1354455.2950085176, -1352877.5992428334, -1354615.6626388268], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.14341852456931975, "mean_inference_ms": 0.2536094584958473, "mean_action_processing_ms": 0.06035051639834947, "mean_env_wait_ms": 0.4788983448425658, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0023493399986853967, "StateBufferConnector_ms": 0.001714779780461238, "ViewRequirementAgentConnector_ms": 0.04512163308950571}}, "episode_reward_max": -1348824.8954038802, "episode_reward_min": -1369366.2314788997, "episode_reward_mean": -1353373.4551752827, "episode_len_mean": 43920.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1369366.2314788997, -1361335.2082701626, -1354747.2510403998, -1351385.668151872, -1353878.0036070035, -1353934.4440263135, -1349299.1822382265, -1352848.977192731, -1354881.8648155385, -1350293.381402571, -1351982.609620888, -1355148.9106643137, -1353355.7607168008, -1351316.0660699722, -1348824.8954038802, -1353463.9545051646, -1350201.1795549188, -1352786.6794055027, -1352053.2572481462, -1352558.3135243794, -1358466.517990561, -1351346.3540966634, -1351505.6693919636, -1353330.2319483531, -1351757.3621417605, -1351111.1344867356, -1352960.1558008753, -1353830.0290992912, -1352774.403007062, -1353239.1979867364, -1351903.1794592983, -1353195.1205072168, -1350544.7864785872, -1351714.7076935158, -1353808.3265127144, -1354467.1794068213, -1354455.2950085176, -1352877.5992428334, -1354615.6626388268], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.14341852456931975, "mean_inference_ms": 0.2536094584958473, "mean_action_processing_ms": 0.06035051639834947, "mean_env_wait_ms": 0.4788983448425658, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0023493399986853967, "StateBufferConnector_ms": 0.001714779780461238, "ViewRequirementAgentConnector_ms": 0.04512163308950571}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2960880, "num_agent_steps_trained": 2960880, "num_env_steps_sampled": 2960880, "num_env_steps_trained": 2960880, "num_env_steps_sampled_this_iter": 43920, "num_env_steps_trained_this_iter": 43920, "num_env_steps_sampled_throughput_per_sec": 1113.9010194875714, "num_env_steps_trained_throughput_per_sec": 1113.9010194875714, "timesteps_total": 2960880, "num_steps_trained_this_iter": 43920, "agent_timesteps_total": 2960880, "timers": {"training_iteration_time_ms": 39379.236, "sample_time_ms": 38636.199, "load_time_ms": 12.445, "load_throughput": 3529007.367, "learn_time_ms": 729.802, "learn_throughput": 60180.694, "synch_weights_time_ms": 0.674}, "counters": {"num_env_steps_sampled": 2960880, "num_env_steps_trained": 2960880, "num_agent_steps_sampled": 2960880, "num_agent_steps_trained": 2960880}, "done": false, "episodes_total": 1258, "training_iteration": 379, "trial_id": "d8b7e_00000", "date": "2023-07-27_05-37-24", "timestamp": 1690425444, "time_this_iter_s": 39.43126201629639, "time_total_s": 6239.401715755463, "pid": 18921, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 366, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[1291920, 5e-05], [1731120, 8e-05], [2170320, 2.5e-05], [2609520, 2.5e-05], [3048720, 2.5e-05], [3487920, 2.5e-05], [3927120, 1e-05], [4366320, 1e-05], [4805520, 1e-05], [5244720, 5e-06], [5683920, 5e-06], [6123120, 5e-06], [6562320, 5e-06], [7001520, 1e-06], [7440720, 1e-06], [7879920, 1e-06], [8319120, 1e-06], [8758320, 5e-07], [9197520, 5e-07], [9636720, 2.5e-07], [10075920, 2.5e-07], [10515120, 1e-08], [10954320, 1e-08], [11393520, 5e-09], [11832720, 5e-09], [12271920, 1e-09]], "grad_clip": 0.5, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.1, "final_epsilon": 0.01, "epsilon_timesteps": 1387080}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 43920, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x16b7b79d0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1571.856957912445, "iterations_since_restore": 39, "perf": {"cpu_util_percent": 17.998214285714287, "ram_util_percent": 68.86785714285715}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 2.5000000000000005e-05, "entropy_coeff": 0.049999999999999996, "policy_entropy": -1643.9747437235217, "policy_loss": -6.8636248489595036e+19, "vf_loss": 302791028.1166181}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 27097.5, "diff_num_grad_updates_vs_sampler_policy": 27096.5}}, "num_env_steps_sampled": 3004800, "num_env_steps_trained": 3004800, "num_agent_steps_sampled": 3004800, "num_agent_steps_trained": 3004800}, "sampler_results": {"episode_reward_max": -1348824.8954038802, "episode_reward_min": -1369366.2314788997, "episode_reward_mean": -1353327.0669217953, "episode_len_mean": 43920.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1369366.2314788997, -1361335.2082701626, -1354747.2510403998, -1351385.668151872, -1353878.0036070035, -1353934.4440263135, -1349299.1822382265, -1352848.977192731, -1354881.8648155385, -1350293.381402571, -1351982.609620888, -1355148.9106643137, -1353355.7607168008, -1351316.0660699722, -1348824.8954038802, -1353463.9545051646, -1350201.1795549188, -1352786.6794055027, -1352053.2572481462, -1352558.3135243794, -1358466.517990561, -1351346.3540966634, -1351505.6693919636, -1353330.2319483531, -1351757.3621417605, -1351111.1344867356, -1352960.1558008753, -1353830.0290992912, -1352774.403007062, -1353239.1979867364, -1351903.1794592983, -1353195.1205072168, -1350544.7864785872, -1351714.7076935158, -1353808.3265127144, -1354467.1794068213, -1354455.2950085176, -1352877.5992428334, -1354615.6626388268, -1351517.925035784], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.14326119152423114, "mean_inference_ms": 0.253247250243875, "mean_action_processing_ms": 0.060289472313375315, "mean_env_wait_ms": 0.4782536539204134, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002340078353881836, "StateBufferConnector_ms": 0.0017207860946655273, "ViewRequirementAgentConnector_ms": 0.04509449005126953}}, "episode_reward_max": -1348824.8954038802, "episode_reward_min": -1369366.2314788997, "episode_reward_mean": -1353327.0669217953, "episode_len_mean": 43920.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1369366.2314788997, -1361335.2082701626, -1354747.2510403998, -1351385.668151872, -1353878.0036070035, -1353934.4440263135, -1349299.1822382265, -1352848.977192731, -1354881.8648155385, -1350293.381402571, -1351982.609620888, -1355148.9106643137, -1353355.7607168008, -1351316.0660699722, -1348824.8954038802, -1353463.9545051646, -1350201.1795549188, -1352786.6794055027, -1352053.2572481462, -1352558.3135243794, -1358466.517990561, -1351346.3540966634, -1351505.6693919636, -1353330.2319483531, -1351757.3621417605, -1351111.1344867356, -1352960.1558008753, -1353830.0290992912, -1352774.403007062, -1353239.1979867364, -1351903.1794592983, -1353195.1205072168, -1350544.7864785872, -1351714.7076935158, -1353808.3265127144, -1354467.1794068213, -1354455.2950085176, -1352877.5992428334, -1354615.6626388268, -1351517.925035784], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.14326119152423114, "mean_inference_ms": 0.253247250243875, "mean_action_processing_ms": 0.060289472313375315, "mean_env_wait_ms": 0.4782536539204134, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002340078353881836, "StateBufferConnector_ms": 0.0017207860946655273, "ViewRequirementAgentConnector_ms": 0.04509449005126953}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 3004800, "num_agent_steps_trained": 3004800, "num_env_steps_sampled": 3004800, "num_env_steps_trained": 3004800, "num_env_steps_sampled_this_iter": 43920, "num_env_steps_trained_this_iter": 43920, "num_env_steps_sampled_throughput_per_sec": 1115.7253605119774, "num_env_steps_trained_throughput_per_sec": 1115.7253605119774, "timesteps_total": 3004800, "num_steps_trained_this_iter": 43920, "agent_timesteps_total": 3004800, "timers": {"training_iteration_time_ms": 39371.689, "sample_time_ms": 38629.749, "load_time_ms": 12.493, "load_throughput": 3515638.487, "learn_time_ms": 728.641, "learn_throughput": 60276.61, "synch_weights_time_ms": 0.69}, "counters": {"num_env_steps_sampled": 3004800, "num_env_steps_trained": 3004800, "num_agent_steps_sampled": 3004800, "num_agent_steps_trained": 3004800}, "done": false, "episodes_total": 1259, "training_iteration": 380, "trial_id": "d8b7e_00000", "date": "2023-07-27_05-38-03", "timestamp": 1690425483, "time_this_iter_s": 39.36684584617615, "time_total_s": 6278.768561601639, "pid": 18921, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 366, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[1291920, 5e-05], [1731120, 8e-05], [2170320, 2.5e-05], [2609520, 2.5e-05], [3048720, 2.5e-05], [3487920, 2.5e-05], [3927120, 1e-05], [4366320, 1e-05], [4805520, 1e-05], [5244720, 5e-06], [5683920, 5e-06], [6123120, 5e-06], [6562320, 5e-06], [7001520, 1e-06], [7440720, 1e-06], [7879920, 1e-06], [8319120, 1e-06], [8758320, 5e-07], [9197520, 5e-07], [9636720, 2.5e-07], [10075920, 2.5e-07], [10515120, 1e-08], [10954320, 1e-08], [11393520, 5e-09], [11832720, 5e-09], [12271920, 1e-09]], "grad_clip": 0.5, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.1, "final_epsilon": 0.01, "epsilon_timesteps": 1387080}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 43920, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x16b7b79d0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1611.2238037586212, "iterations_since_restore": 40, "perf": {"cpu_util_percent": 17.675, "ram_util_percent": 68.86785714285715}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 2.5000000000000005e-05, "entropy_coeff": 0.049999999999999996, "policy_entropy": -1625.2239933291955, "policy_loss": -4.509425329553813e+19, "vf_loss": 302405726.3381924}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 27783.5, "diff_num_grad_updates_vs_sampler_policy": 27782.5}}, "num_env_steps_sampled": 3048720, "num_env_steps_trained": 3048720, "num_agent_steps_sampled": 3048720, "num_agent_steps_trained": 3048720}, "sampler_results": {"episode_reward_max": -1348824.8954038802, "episode_reward_min": -1369366.2314788997, "episode_reward_mean": -1353255.5719256345, "episode_len_mean": 43920.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1369366.2314788997, -1361335.2082701626, -1354747.2510403998, -1351385.668151872, -1353878.0036070035, -1353934.4440263135, -1349299.1822382265, -1352848.977192731, -1354881.8648155385, -1350293.381402571, -1351982.609620888, -1355148.9106643137, -1353355.7607168008, -1351316.0660699722, -1348824.8954038802, -1353463.9545051646, -1350201.1795549188, -1352786.6794055027, -1352053.2572481462, -1352558.3135243794, -1358466.517990561, -1351346.3540966634, -1351505.6693919636, -1353330.2319483531, -1351757.3621417605, -1351111.1344867356, -1352960.1558008753, -1353830.0290992912, -1352774.403007062, -1353239.1979867364, -1351903.1794592983, -1353195.1205072168, -1350544.7864785872, -1351714.7076935158, -1353808.3265127144, -1354467.1794068213, -1354455.2950085176, -1352877.5992428334, -1354615.6626388268, -1351517.925035784, -1350395.7720792037], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.14310994494475016, "mean_inference_ms": 0.2528989625610413, "mean_action_processing_ms": 0.060230798121707445, "mean_env_wait_ms": 0.47763167608100254, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0023382466013838607, "StateBufferConnector_ms": 0.00171952131317883, "ViewRequirementAgentConnector_ms": 0.04503959562720322}}, "episode_reward_max": -1348824.8954038802, "episode_reward_min": -1369366.2314788997, "episode_reward_mean": -1353255.5719256345, "episode_len_mean": 43920.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1369366.2314788997, -1361335.2082701626, -1354747.2510403998, -1351385.668151872, -1353878.0036070035, -1353934.4440263135, -1349299.1822382265, -1352848.977192731, -1354881.8648155385, -1350293.381402571, -1351982.609620888, -1355148.9106643137, -1353355.7607168008, -1351316.0660699722, -1348824.8954038802, -1353463.9545051646, -1350201.1795549188, -1352786.6794055027, -1352053.2572481462, -1352558.3135243794, -1358466.517990561, -1351346.3540966634, -1351505.6693919636, -1353330.2319483531, -1351757.3621417605, -1351111.1344867356, -1352960.1558008753, -1353830.0290992912, -1352774.403007062, -1353239.1979867364, -1351903.1794592983, -1353195.1205072168, -1350544.7864785872, -1351714.7076935158, -1353808.3265127144, -1354467.1794068213, -1354455.2950085176, -1352877.5992428334, -1354615.6626388268, -1351517.925035784, -1350395.7720792037], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.14310994494475016, "mean_inference_ms": 0.2528989625610413, "mean_action_processing_ms": 0.060230798121707445, "mean_env_wait_ms": 0.47763167608100254, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0023382466013838607, "StateBufferConnector_ms": 0.00171952131317883, "ViewRequirementAgentConnector_ms": 0.04503959562720322}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 3048720, "num_agent_steps_trained": 3048720, "num_env_steps_sampled": 3048720, "num_env_steps_trained": 3048720, "num_env_steps_sampled_this_iter": 43920, "num_env_steps_trained_this_iter": 43920, "num_env_steps_sampled_throughput_per_sec": 1120.9473277435648, "num_env_steps_trained_throughput_per_sec": 1120.9473277435648, "timesteps_total": 3048720, "num_steps_trained_this_iter": 43920, "agent_timesteps_total": 3048720, "timers": {"training_iteration_time_ms": 39367.217, "sample_time_ms": 38625.462, "load_time_ms": 12.517, "load_throughput": 3508821.522, "learn_time_ms": 728.436, "learn_throughput": 60293.567, "synch_weights_time_ms": 0.684}, "counters": {"num_env_steps_sampled": 3048720, "num_env_steps_trained": 3048720, "num_agent_steps_sampled": 3048720, "num_agent_steps_trained": 3048720}, "done": false, "episodes_total": 1260, "training_iteration": 381, "trial_id": "d8b7e_00000", "date": "2023-07-27_05-38-42", "timestamp": 1690425522, "time_this_iter_s": 39.18317699432373, "time_total_s": 6317.9517385959625, "pid": 18921, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 366, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[1291920, 5e-05], [1731120, 8e-05], [2170320, 2.5e-05], [2609520, 2.5e-05], [3048720, 2.5e-05], [3487920, 2.5e-05], [3927120, 1e-05], [4366320, 1e-05], [4805520, 1e-05], [5244720, 5e-06], [5683920, 5e-06], [6123120, 5e-06], [6562320, 5e-06], [7001520, 1e-06], [7440720, 1e-06], [7879920, 1e-06], [8319120, 1e-06], [8758320, 5e-07], [9197520, 5e-07], [9636720, 2.5e-07], [10075920, 2.5e-07], [10515120, 1e-08], [10954320, 1e-08], [11393520, 5e-09], [11832720, 5e-09], [12271920, 1e-09]], "grad_clip": 0.5, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.1, "final_epsilon": 0.01, "epsilon_timesteps": 1387080}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 43920, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x16b7b79d0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1650.406980752945, "iterations_since_restore": 41, "perf": {"cpu_util_percent": 18.87454545454546, "ram_util_percent": 68.91636363636363}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 2.5000000000000005e-05, "entropy_coeff": 0.049999999999999996, "policy_entropy": -1641.5571226781728, "policy_loss": -6.193791922794063e+19, "vf_loss": 304634687.79008746}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 28469.5, "diff_num_grad_updates_vs_sampler_policy": 28468.5}}, "num_env_steps_sampled": 3092640, "num_env_steps_trained": 3092640, "num_agent_steps_sampled": 3092640, "num_agent_steps_trained": 3092640}, "sampler_results": {"episode_reward_max": -1348824.8954038802, "episode_reward_min": -1369366.2314788997, "episode_reward_mean": -1353308.2538980793, "episode_len_mean": 43920.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1369366.2314788997, -1361335.2082701626, -1354747.2510403998, -1351385.668151872, -1353878.0036070035, -1353934.4440263135, -1349299.1822382265, -1352848.977192731, -1354881.8648155385, -1350293.381402571, -1351982.609620888, -1355148.9106643137, -1353355.7607168008, -1351316.0660699722, -1348824.8954038802, -1353463.9545051646, -1350201.1795549188, -1352786.6794055027, -1352053.2572481462, -1352558.3135243794, -1358466.517990561, -1351346.3540966634, -1351505.6693919636, -1353330.2319483531, -1351757.3621417605, -1351111.1344867356, -1352960.1558008753, -1353830.0290992912, -1352774.403007062, -1353239.1979867364, -1351903.1794592983, -1353195.1205072168, -1350544.7864785872, -1351714.7076935158, -1353808.3265127144, -1354467.1794068213, -1354455.2950085176, -1352877.5992428334, -1354615.6626388268, -1351517.925035784, -1350395.7720792037, -1355468.214768313], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.14296412208871115, "mean_inference_ms": 0.25256306314363636, "mean_action_processing_ms": 0.06017426471868454, "mean_env_wait_ms": 0.4770318757316261, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0023302577790759857, "StateBufferConnector_ms": 0.0017183167593819754, "ViewRequirementAgentConnector_ms": 0.04505032584780738}}, "episode_reward_max": -1348824.8954038802, "episode_reward_min": -1369366.2314788997, "episode_reward_mean": -1353308.2538980793, "episode_len_mean": 43920.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1369366.2314788997, -1361335.2082701626, -1354747.2510403998, -1351385.668151872, -1353878.0036070035, -1353934.4440263135, -1349299.1822382265, -1352848.977192731, -1354881.8648155385, -1350293.381402571, -1351982.609620888, -1355148.9106643137, -1353355.7607168008, -1351316.0660699722, -1348824.8954038802, -1353463.9545051646, -1350201.1795549188, -1352786.6794055027, -1352053.2572481462, -1352558.3135243794, -1358466.517990561, -1351346.3540966634, -1351505.6693919636, -1353330.2319483531, -1351757.3621417605, -1351111.1344867356, -1352960.1558008753, -1353830.0290992912, -1352774.403007062, -1353239.1979867364, -1351903.1794592983, -1353195.1205072168, -1350544.7864785872, -1351714.7076935158, -1353808.3265127144, -1354467.1794068213, -1354455.2950085176, -1352877.5992428334, -1354615.6626388268, -1351517.925035784, -1350395.7720792037, -1355468.214768313], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.14296412208871115, "mean_inference_ms": 0.25256306314363636, "mean_action_processing_ms": 0.06017426471868454, "mean_env_wait_ms": 0.4770318757316261, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0023302577790759857, "StateBufferConnector_ms": 0.0017183167593819754, "ViewRequirementAgentConnector_ms": 0.04505032584780738}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 3092640, "num_agent_steps_trained": 3092640, "num_env_steps_sampled": 3092640, "num_env_steps_trained": 3092640, "num_env_steps_sampled_this_iter": 43920, "num_env_steps_trained_this_iter": 43920, "num_env_steps_sampled_throughput_per_sec": 1122.1193290880813, "num_env_steps_trained_throughput_per_sec": 1122.1193290880813, "timesteps_total": 3092640, "num_steps_trained_this_iter": 43920, "agent_timesteps_total": 3092640, "timers": {"training_iteration_time_ms": 39351.381, "sample_time_ms": 38609.863, "load_time_ms": 12.527, "load_throughput": 3506156.853, "learn_time_ms": 728.182, "learn_throughput": 60314.585, "synch_weights_time_ms": 0.692}, "counters": {"num_env_steps_sampled": 3092640, "num_env_steps_trained": 3092640, "num_agent_steps_sampled": 3092640, "num_agent_steps_trained": 3092640}, "done": false, "episodes_total": 1261, "training_iteration": 382, "trial_id": "d8b7e_00000", "date": "2023-07-27_05-39-21", "timestamp": 1690425561, "time_this_iter_s": 39.14219307899475, "time_total_s": 6357.093931674957, "pid": 18921, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 366, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[1291920, 5e-05], [1731120, 8e-05], [2170320, 2.5e-05], [2609520, 2.5e-05], [3048720, 2.5e-05], [3487920, 2.5e-05], [3927120, 1e-05], [4366320, 1e-05], [4805520, 1e-05], [5244720, 5e-06], [5683920, 5e-06], [6123120, 5e-06], [6562320, 5e-06], [7001520, 1e-06], [7440720, 1e-06], [7879920, 1e-06], [8319120, 1e-06], [8758320, 5e-07], [9197520, 5e-07], [9636720, 2.5e-07], [10075920, 2.5e-07], [10515120, 1e-08], [10954320, 1e-08], [11393520, 5e-09], [11832720, 5e-09], [12271920, 1e-09]], "grad_clip": 0.5, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.1, "final_epsilon": 0.01, "epsilon_timesteps": 1387080}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 43920, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x16b7b79d0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1689.5491738319397, "iterations_since_restore": 42, "perf": {"cpu_util_percent": 18.919999999999998, "ram_util_percent": 68.90363636363637}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 2.5000000000000005e-05, "entropy_coeff": 0.049999999999999996, "policy_entropy": -1622.2575169332522, "policy_loss": -4.627035312973161e+19, "vf_loss": 302623359.8075802}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 29155.5, "diff_num_grad_updates_vs_sampler_policy": 29154.5}}, "num_env_steps_sampled": 3136560, "num_env_steps_trained": 3136560, "num_agent_steps_sampled": 3136560, "num_agent_steps_trained": 3136560}, "sampler_results": {"episode_reward_max": -1348824.8954038802, "episode_reward_min": -1369366.2314788997, "episode_reward_mean": -1353253.4322613294, "episode_len_mean": 43920.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1369366.2314788997, -1361335.2082701626, -1354747.2510403998, -1351385.668151872, -1353878.0036070035, -1353934.4440263135, -1349299.1822382265, -1352848.977192731, -1354881.8648155385, -1350293.381402571, -1351982.609620888, -1355148.9106643137, -1353355.7607168008, -1351316.0660699722, -1348824.8954038802, -1353463.9545051646, -1350201.1795549188, -1352786.6794055027, -1352053.2572481462, -1352558.3135243794, -1358466.517990561, -1351346.3540966634, -1351505.6693919636, -1353330.2319483531, -1351757.3621417605, -1351111.1344867356, -1352960.1558008753, -1353830.0290992912, -1352774.403007062, -1353239.1979867364, -1351903.1794592983, -1353195.1205072168, -1350544.7864785872, -1351714.7076935158, -1353808.3265127144, -1354467.1794068213, -1354455.2950085176, -1352877.5992428334, -1354615.6626388268, -1351517.925035784, -1350395.7720792037, -1355468.214768313, -1350950.9235178346], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.14282346149458114, "mean_inference_ms": 0.25223935907495787, "mean_action_processing_ms": 0.06011987760344619, "mean_env_wait_ms": 0.4764556008039952, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0023902848709461302, "StateBufferConnector_ms": 0.0017254851585210755, "ViewRequirementAgentConnector_ms": 0.045115448707757994}}, "episode_reward_max": -1348824.8954038802, "episode_reward_min": -1369366.2314788997, "episode_reward_mean": -1353253.4322613294, "episode_len_mean": 43920.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1369366.2314788997, -1361335.2082701626, -1354747.2510403998, -1351385.668151872, -1353878.0036070035, -1353934.4440263135, -1349299.1822382265, -1352848.977192731, -1354881.8648155385, -1350293.381402571, -1351982.609620888, -1355148.9106643137, -1353355.7607168008, -1351316.0660699722, -1348824.8954038802, -1353463.9545051646, -1350201.1795549188, -1352786.6794055027, -1352053.2572481462, -1352558.3135243794, -1358466.517990561, -1351346.3540966634, -1351505.6693919636, -1353330.2319483531, -1351757.3621417605, -1351111.1344867356, -1352960.1558008753, -1353830.0290992912, -1352774.403007062, -1353239.1979867364, -1351903.1794592983, -1353195.1205072168, -1350544.7864785872, -1351714.7076935158, -1353808.3265127144, -1354467.1794068213, -1354455.2950085176, -1352877.5992428334, -1354615.6626388268, -1351517.925035784, -1350395.7720792037, -1355468.214768313, -1350950.9235178346], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.14282346149458114, "mean_inference_ms": 0.25223935907495787, "mean_action_processing_ms": 0.06011987760344619, "mean_env_wait_ms": 0.4764556008039952, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0023902848709461302, "StateBufferConnector_ms": 0.0017254851585210755, "ViewRequirementAgentConnector_ms": 0.045115448707757994}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 3136560, "num_agent_steps_trained": 3136560, "num_env_steps_sampled": 3136560, "num_env_steps_trained": 3136560, "num_env_steps_sampled_this_iter": 43920, "num_env_steps_trained_this_iter": 43920, "num_env_steps_sampled_throughput_per_sec": 1114.475370164983, "num_env_steps_trained_throughput_per_sec": 1114.475370164983, "timesteps_total": 3136560, "num_steps_trained_this_iter": 43920, "agent_timesteps_total": 3136560, "timers": {"training_iteration_time_ms": 39371.078, "sample_time_ms": 38630.716, "load_time_ms": 12.586, "load_throughput": 3489671.607, "learn_time_ms": 726.968, "learn_throughput": 60415.308, "synch_weights_time_ms": 0.69}, "counters": {"num_env_steps_sampled": 3136560, "num_env_steps_trained": 3136560, "num_agent_steps_sampled": 3136560, "num_agent_steps_trained": 3136560}, "done": false, "episodes_total": 1262, "training_iteration": 383, "trial_id": "d8b7e_00000", "date": "2023-07-27_05-40-01", "timestamp": 1690425601, "time_this_iter_s": 39.410735845565796, "time_total_s": 6396.504667520523, "pid": 18921, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 366, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[1291920, 5e-05], [1731120, 8e-05], [2170320, 2.5e-05], [2609520, 2.5e-05], [3048720, 2.5e-05], [3487920, 2.5e-05], [3927120, 1e-05], [4366320, 1e-05], [4805520, 1e-05], [5244720, 5e-06], [5683920, 5e-06], [6123120, 5e-06], [6562320, 5e-06], [7001520, 1e-06], [7440720, 1e-06], [7879920, 1e-06], [8319120, 1e-06], [8758320, 5e-07], [9197520, 5e-07], [9636720, 2.5e-07], [10075920, 2.5e-07], [10515120, 1e-08], [10954320, 1e-08], [11393520, 5e-09], [11832720, 5e-09], [12271920, 1e-09]], "grad_clip": 0.5, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.1, "final_epsilon": 0.01, "epsilon_timesteps": 1387080}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 43920, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x16b7b79d0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1728.9599096775055, "iterations_since_restore": 43, "perf": {"cpu_util_percent": 17.973214285714285, "ram_util_percent": 68.89464285714286}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 2.5000000000000005e-05, "entropy_coeff": 0.049999999999999996, "policy_entropy": -1605.2250850221506, "policy_loss": -3.2442405206102254e+19, "vf_loss": 301903592.0116618}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 29841.5, "diff_num_grad_updates_vs_sampler_policy": 29840.5}}, "num_env_steps_sampled": 3180480, "num_env_steps_trained": 3180480, "num_agent_steps_sampled": 3180480, "num_agent_steps_trained": 3180480}, "sampler_results": {"episode_reward_max": -1348824.8954038802, "episode_reward_min": -1369366.2314788997, "episode_reward_mean": -1353167.2629148336, "episode_len_mean": 43920.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1369366.2314788997, -1361335.2082701626, -1354747.2510403998, -1351385.668151872, -1353878.0036070035, -1353934.4440263135, -1349299.1822382265, -1352848.977192731, -1354881.8648155385, -1350293.381402571, -1351982.609620888, -1355148.9106643137, -1353355.7607168008, -1351316.0660699722, -1348824.8954038802, -1353463.9545051646, -1350201.1795549188, -1352786.6794055027, -1352053.2572481462, -1352558.3135243794, -1358466.517990561, -1351346.3540966634, -1351505.6693919636, -1353330.2319483531, -1351757.3621417605, -1351111.1344867356, -1352960.1558008753, -1353830.0290992912, -1352774.403007062, -1353239.1979867364, -1351903.1794592983, -1353195.1205072168, -1350544.7864785872, -1351714.7076935158, -1353808.3265127144, -1354467.1794068213, -1354455.2950085176, -1352877.5992428334, -1354615.6626388268, -1351517.925035784, -1350395.7720792037, -1355468.214768313, -1350950.9235178346, -1349461.9810155102], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1426873713328003, "mean_inference_ms": 0.25192707562244654, "mean_action_processing_ms": 0.06006744155001655, "mean_env_wait_ms": 0.47590121881836905, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002384727651422674, "StateBufferConnector_ms": 0.001729076558893377, "ViewRequirementAgentConnector_ms": 0.04514130679043857}}, "episode_reward_max": -1348824.8954038802, "episode_reward_min": -1369366.2314788997, "episode_reward_mean": -1353167.2629148336, "episode_len_mean": 43920.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1369366.2314788997, -1361335.2082701626, -1354747.2510403998, -1351385.668151872, -1353878.0036070035, -1353934.4440263135, -1349299.1822382265, -1352848.977192731, -1354881.8648155385, -1350293.381402571, -1351982.609620888, -1355148.9106643137, -1353355.7607168008, -1351316.0660699722, -1348824.8954038802, -1353463.9545051646, -1350201.1795549188, -1352786.6794055027, -1352053.2572481462, -1352558.3135243794, -1358466.517990561, -1351346.3540966634, -1351505.6693919636, -1353330.2319483531, -1351757.3621417605, -1351111.1344867356, -1352960.1558008753, -1353830.0290992912, -1352774.403007062, -1353239.1979867364, -1351903.1794592983, -1353195.1205072168, -1350544.7864785872, -1351714.7076935158, -1353808.3265127144, -1354467.1794068213, -1354455.2950085176, -1352877.5992428334, -1354615.6626388268, -1351517.925035784, -1350395.7720792037, -1355468.214768313, -1350950.9235178346, -1349461.9810155102], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1426873713328003, "mean_inference_ms": 0.25192707562244654, "mean_action_processing_ms": 0.06006744155001655, "mean_env_wait_ms": 0.47590121881836905, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002384727651422674, "StateBufferConnector_ms": 0.001729076558893377, "ViewRequirementAgentConnector_ms": 0.04514130679043857}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 3180480, "num_agent_steps_trained": 3180480, "num_env_steps_sampled": 3180480, "num_env_steps_trained": 3180480, "num_env_steps_sampled_this_iter": 43920, "num_env_steps_trained_this_iter": 43920, "num_env_steps_sampled_throughput_per_sec": 1115.9103331238362, "num_env_steps_trained_throughput_per_sec": 1115.9103331238362, "timesteps_total": 3180480, "num_steps_trained_this_iter": 43920, "agent_timesteps_total": 3180480, "timers": {"training_iteration_time_ms": 39357.526, "sample_time_ms": 38617.873, "load_time_ms": 12.636, "load_throughput": 3475863.838, "learn_time_ms": 726.205, "learn_throughput": 60478.801, "synch_weights_time_ms": 0.696}, "counters": {"num_env_steps_sampled": 3180480, "num_env_steps_trained": 3180480, "num_agent_steps_sampled": 3180480, "num_agent_steps_trained": 3180480}, "done": false, "episodes_total": 1263, "training_iteration": 384, "trial_id": "d8b7e_00000", "date": "2023-07-27_05-40-40", "timestamp": 1690425640, "time_this_iter_s": 39.36003613471985, "time_total_s": 6435.864703655243, "pid": 18921, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 366, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[1291920, 5e-05], [1731120, 8e-05], [2170320, 2.5e-05], [2609520, 2.5e-05], [3048720, 2.5e-05], [3487920, 2.5e-05], [3927120, 1e-05], [4366320, 1e-05], [4805520, 1e-05], [5244720, 5e-06], [5683920, 5e-06], [6123120, 5e-06], [6562320, 5e-06], [7001520, 1e-06], [7440720, 1e-06], [7879920, 1e-06], [8319120, 1e-06], [8758320, 5e-07], [9197520, 5e-07], [9636720, 2.5e-07], [10075920, 2.5e-07], [10515120, 1e-08], [10954320, 1e-08], [11393520, 5e-09], [11832720, 5e-09], [12271920, 1e-09]], "grad_clip": 0.5, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.1, "final_epsilon": 0.01, "epsilon_timesteps": 1387080}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 43920, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x16b7b79d0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1768.3199458122253, "iterations_since_restore": 44, "perf": {"cpu_util_percent": 17.767857142857142, "ram_util_percent": 68.89107142857144}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 2.5000000000000005e-05, "entropy_coeff": 0.049999999999999996, "policy_entropy": -1630.31818712418, "policy_loss": -6.156774479320447e+19, "vf_loss": 303641657.47521865}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 30527.5, "diff_num_grad_updates_vs_sampler_policy": 30526.5}}, "num_env_steps_sampled": 3224400, "num_env_steps_trained": 3224400, "num_agent_steps_sampled": 3224400, "num_agent_steps_trained": 3224400}, "sampler_results": {"episode_reward_max": -1348824.8954038802, "episode_reward_min": -1369366.2314788997, "episode_reward_mean": -1353168.9714792208, "episode_len_mean": 43920.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1369366.2314788997, -1361335.2082701626, -1354747.2510403998, -1351385.668151872, -1353878.0036070035, -1353934.4440263135, -1349299.1822382265, -1352848.977192731, -1354881.8648155385, -1350293.381402571, -1351982.609620888, -1355148.9106643137, -1353355.7607168008, -1351316.0660699722, -1348824.8954038802, -1353463.9545051646, -1350201.1795549188, -1352786.6794055027, -1352053.2572481462, -1352558.3135243794, -1358466.517990561, -1351346.3540966634, -1351505.6693919636, -1353330.2319483531, -1351757.3621417605, -1351111.1344867356, -1352960.1558008753, -1353830.0290992912, -1352774.403007062, -1353239.1979867364, -1351903.1794592983, -1353195.1205072168, -1350544.7864785872, -1351714.7076935158, -1353808.3265127144, -1354467.1794068213, -1354455.2950085176, -1352877.5992428334, -1354615.6626388268, -1351517.925035784, -1350395.7720792037, -1355468.214768313, -1350950.9235178346, -1349461.9810155102, -1353244.1483122527], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.14255667764655594, "mean_inference_ms": 0.2516268400777653, "mean_action_processing_ms": 0.06001690397167529, "mean_env_wait_ms": 0.4753646522310234, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0023772981431749132, "StateBufferConnector_ms": 0.0017272101508246528, "ViewRequirementAgentConnector_ms": 0.04508919186062283}}, "episode_reward_max": -1348824.8954038802, "episode_reward_min": -1369366.2314788997, "episode_reward_mean": -1353168.9714792208, "episode_len_mean": 43920.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1369366.2314788997, -1361335.2082701626, -1354747.2510403998, -1351385.668151872, -1353878.0036070035, -1353934.4440263135, -1349299.1822382265, -1352848.977192731, -1354881.8648155385, -1350293.381402571, -1351982.609620888, -1355148.9106643137, -1353355.7607168008, -1351316.0660699722, -1348824.8954038802, -1353463.9545051646, -1350201.1795549188, -1352786.6794055027, -1352053.2572481462, -1352558.3135243794, -1358466.517990561, -1351346.3540966634, -1351505.6693919636, -1353330.2319483531, -1351757.3621417605, -1351111.1344867356, -1352960.1558008753, -1353830.0290992912, -1352774.403007062, -1353239.1979867364, -1351903.1794592983, -1353195.1205072168, -1350544.7864785872, -1351714.7076935158, -1353808.3265127144, -1354467.1794068213, -1354455.2950085176, -1352877.5992428334, -1354615.6626388268, -1351517.925035784, -1350395.7720792037, -1355468.214768313, -1350950.9235178346, -1349461.9810155102, -1353244.1483122527], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.14255667764655594, "mean_inference_ms": 0.2516268400777653, "mean_action_processing_ms": 0.06001690397167529, "mean_env_wait_ms": 0.4753646522310234, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0023772981431749132, "StateBufferConnector_ms": 0.0017272101508246528, "ViewRequirementAgentConnector_ms": 0.04508919186062283}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 3224400, "num_agent_steps_trained": 3224400, "num_env_steps_sampled": 3224400, "num_env_steps_trained": 3224400, "num_env_steps_sampled_this_iter": 43920, "num_env_steps_trained_this_iter": 43920, "num_env_steps_sampled_throughput_per_sec": 1117.6427667323117, "num_env_steps_trained_throughput_per_sec": 1117.6427667323117, "timesteps_total": 3224400, "num_steps_trained_this_iter": 43920, "agent_timesteps_total": 3224400, "timers": {"training_iteration_time_ms": 39334.377, "sample_time_ms": 38596.175, "load_time_ms": 12.675, "load_throughput": 3464952.096, "learn_time_ms": 724.71, "learn_throughput": 60603.589, "synch_weights_time_ms": 0.7}, "counters": {"num_env_steps_sampled": 3224400, "num_env_steps_trained": 3224400, "num_agent_steps_sampled": 3224400, "num_agent_steps_trained": 3224400}, "done": false, "episodes_total": 1264, "training_iteration": 385, "trial_id": "d8b7e_00000", "date": "2023-07-27_05-41-20", "timestamp": 1690425680, "time_this_iter_s": 39.29917597770691, "time_total_s": 6475.16387963295, "pid": 18921, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 366, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[1291920, 5e-05], [1731120, 8e-05], [2170320, 2.5e-05], [2609520, 2.5e-05], [3048720, 2.5e-05], [3487920, 2.5e-05], [3927120, 1e-05], [4366320, 1e-05], [4805520, 1e-05], [5244720, 5e-06], [5683920, 5e-06], [6123120, 5e-06], [6562320, 5e-06], [7001520, 1e-06], [7440720, 1e-06], [7879920, 1e-06], [8319120, 1e-06], [8758320, 5e-07], [9197520, 5e-07], [9636720, 2.5e-07], [10075920, 2.5e-07], [10515120, 1e-08], [10954320, 1e-08], [11393520, 5e-09], [11832720, 5e-09], [12271920, 1e-09]], "grad_clip": 0.5, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.1, "final_epsilon": 0.01, "epsilon_timesteps": 1387080}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 43920, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x16b7b79d0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1807.6191217899323, "iterations_since_restore": 45, "perf": {"cpu_util_percent": 20.912499999999998, "ram_util_percent": 68.90714285714286}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 2.5000000000000005e-05, "entropy_coeff": 0.049999999999999996, "policy_entropy": -1610.5137859377846, "policy_loss": -3.929274561488017e+19, "vf_loss": 302983487.31778425}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 31213.5, "diff_num_grad_updates_vs_sampler_policy": 31212.5}}, "num_env_steps_sampled": 3268320, "num_env_steps_trained": 3268320, "num_agent_steps_sampled": 3268320, "num_agent_steps_trained": 3268320}, "sampler_results": {"episode_reward_max": -1348824.8954038802, "episode_reward_min": -1369366.2314788997, "episode_reward_mean": -1353138.6402717433, "episode_len_mean": 43920.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1369366.2314788997, -1361335.2082701626, -1354747.2510403998, -1351385.668151872, -1353878.0036070035, -1353934.4440263135, -1349299.1822382265, -1352848.977192731, -1354881.8648155385, -1350293.381402571, -1351982.609620888, -1355148.9106643137, -1353355.7607168008, -1351316.0660699722, -1348824.8954038802, -1353463.9545051646, -1350201.1795549188, -1352786.6794055027, -1352053.2572481462, -1352558.3135243794, -1358466.517990561, -1351346.3540966634, -1351505.6693919636, -1353330.2319483531, -1351757.3621417605, -1351111.1344867356, -1352960.1558008753, -1353830.0290992912, -1352774.403007062, -1353239.1979867364, -1351903.1794592983, -1353195.1205072168, -1350544.7864785872, -1351714.7076935158, -1353808.3265127144, -1354467.1794068213, -1354455.2950085176, -1352877.5992428334, -1354615.6626388268, -1351517.925035784, -1350395.7720792037, -1355468.214768313, -1350950.9235178346, -1349461.9810155102, -1353244.1483122527, -1351773.7359352622], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.14243030807584917, "mean_inference_ms": 0.2513370478154836, "mean_action_processing_ms": 0.05996815614860175, "mean_env_wait_ms": 0.47484694440374675, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0023784844771675443, "StateBufferConnector_ms": 0.0017368275186289911, "ViewRequirementAgentConnector_ms": 0.04525443781977114}}, "episode_reward_max": -1348824.8954038802, "episode_reward_min": -1369366.2314788997, "episode_reward_mean": -1353138.6402717433, "episode_len_mean": 43920.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1369366.2314788997, -1361335.2082701626, -1354747.2510403998, -1351385.668151872, -1353878.0036070035, -1353934.4440263135, -1349299.1822382265, -1352848.977192731, -1354881.8648155385, -1350293.381402571, -1351982.609620888, -1355148.9106643137, -1353355.7607168008, -1351316.0660699722, -1348824.8954038802, -1353463.9545051646, -1350201.1795549188, -1352786.6794055027, -1352053.2572481462, -1352558.3135243794, -1358466.517990561, -1351346.3540966634, -1351505.6693919636, -1353330.2319483531, -1351757.3621417605, -1351111.1344867356, -1352960.1558008753, -1353830.0290992912, -1352774.403007062, -1353239.1979867364, -1351903.1794592983, -1353195.1205072168, -1350544.7864785872, -1351714.7076935158, -1353808.3265127144, -1354467.1794068213, -1354455.2950085176, -1352877.5992428334, -1354615.6626388268, -1351517.925035784, -1350395.7720792037, -1355468.214768313, -1350950.9235178346, -1349461.9810155102, -1353244.1483122527, -1351773.7359352622], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.14243030807584917, "mean_inference_ms": 0.2513370478154836, "mean_action_processing_ms": 0.05996815614860175, "mean_env_wait_ms": 0.47484694440374675, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0023784844771675443, "StateBufferConnector_ms": 0.0017368275186289911, "ViewRequirementAgentConnector_ms": 0.04525443781977114}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 3268320, "num_agent_steps_trained": 3268320, "num_env_steps_sampled": 3268320, "num_env_steps_trained": 3268320, "num_env_steps_sampled_this_iter": 43920, "num_env_steps_trained_this_iter": 43920, "num_env_steps_sampled_throughput_per_sec": 1116.378749923732, "num_env_steps_trained_throughput_per_sec": 1116.378749923732, "timesteps_total": 3268320, "num_steps_trained_this_iter": 43920, "agent_timesteps_total": 3268320, "timers": {"training_iteration_time_ms": 39327.712, "sample_time_ms": 38588.942, "load_time_ms": 12.841, "load_throughput": 3420374.239, "learn_time_ms": 725.109, "learn_throughput": 60570.231, "synch_weights_time_ms": 0.704}, "counters": {"num_env_steps_sampled": 3268320, "num_env_steps_trained": 3268320, "num_agent_steps_sampled": 3268320, "num_agent_steps_trained": 3268320}, "done": false, "episodes_total": 1265, "training_iteration": 386, "trial_id": "d8b7e_00000", "date": "2023-07-27_05-41-59", "timestamp": 1690425719, "time_this_iter_s": 39.343528032302856, "time_total_s": 6514.507407665253, "pid": 18921, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 366, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[1291920, 5e-05], [1731120, 8e-05], [2170320, 2.5e-05], [2609520, 2.5e-05], [3048720, 2.5e-05], [3487920, 2.5e-05], [3927120, 1e-05], [4366320, 1e-05], [4805520, 1e-05], [5244720, 5e-06], [5683920, 5e-06], [6123120, 5e-06], [6562320, 5e-06], [7001520, 1e-06], [7440720, 1e-06], [7879920, 1e-06], [8319120, 1e-06], [8758320, 5e-07], [9197520, 5e-07], [9636720, 2.5e-07], [10075920, 2.5e-07], [10515120, 1e-08], [10954320, 1e-08], [11393520, 5e-09], [11832720, 5e-09], [12271920, 1e-09]], "grad_clip": 0.5, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.1, "final_epsilon": 0.01, "epsilon_timesteps": 1387080}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 43920, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x16b7b79d0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1846.962649822235, "iterations_since_restore": 46, "perf": {"cpu_util_percent": 17.68909090909091, "ram_util_percent": 68.85454545454544}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 2.5000000000000005e-05, "entropy_coeff": 0.049999999999999996, "policy_entropy": -1632.7413758925725, "policy_loss": -6.199815498757307e+19, "vf_loss": 304263896.3731778}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 31899.5, "diff_num_grad_updates_vs_sampler_policy": 31898.5}}, "num_env_steps_sampled": 3312240, "num_env_steps_trained": 3312240, "num_agent_steps_sampled": 3312240, "num_agent_steps_trained": 3312240}, "sampler_results": {"episode_reward_max": -1348824.8954038802, "episode_reward_min": -1369366.2314788997, "episode_reward_mean": -1353169.3258603655, "episode_len_mean": 43920.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1369366.2314788997, -1361335.2082701626, -1354747.2510403998, -1351385.668151872, -1353878.0036070035, -1353934.4440263135, -1349299.1822382265, -1352848.977192731, -1354881.8648155385, -1350293.381402571, -1351982.609620888, -1355148.9106643137, -1353355.7607168008, -1351316.0660699722, -1348824.8954038802, -1353463.9545051646, -1350201.1795549188, -1352786.6794055027, -1352053.2572481462, -1352558.3135243794, -1358466.517990561, -1351346.3540966634, -1351505.6693919636, -1353330.2319483531, -1351757.3621417605, -1351111.1344867356, -1352960.1558008753, -1353830.0290992912, -1352774.403007062, -1353239.1979867364, -1351903.1794592983, -1353195.1205072168, -1350544.7864785872, -1351714.7076935158, -1353808.3265127144, -1354467.1794068213, -1354455.2950085176, -1352877.5992428334, -1354615.6626388268, -1351517.925035784, -1350395.7720792037, -1355468.214768313, -1350950.9235178346, -1349461.9810155102, -1353244.1483122527, -1351773.7359352622, -1354580.862936983], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.14230792718185195, "mean_inference_ms": 0.2510567717694464, "mean_action_processing_ms": 0.05992106576592893, "mean_env_wait_ms": 0.4743466465548183, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0023775912345723902, "StateBufferConnector_ms": 0.0017358901652883977, "ViewRequirementAgentConnector_ms": 0.0454030138380984}}, "episode_reward_max": -1348824.8954038802, "episode_reward_min": -1369366.2314788997, "episode_reward_mean": -1353169.3258603655, "episode_len_mean": 43920.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1369366.2314788997, -1361335.2082701626, -1354747.2510403998, -1351385.668151872, -1353878.0036070035, -1353934.4440263135, -1349299.1822382265, -1352848.977192731, -1354881.8648155385, -1350293.381402571, -1351982.609620888, -1355148.9106643137, -1353355.7607168008, -1351316.0660699722, -1348824.8954038802, -1353463.9545051646, -1350201.1795549188, -1352786.6794055027, -1352053.2572481462, -1352558.3135243794, -1358466.517990561, -1351346.3540966634, -1351505.6693919636, -1353330.2319483531, -1351757.3621417605, -1351111.1344867356, -1352960.1558008753, -1353830.0290992912, -1352774.403007062, -1353239.1979867364, -1351903.1794592983, -1353195.1205072168, -1350544.7864785872, -1351714.7076935158, -1353808.3265127144, -1354467.1794068213, -1354455.2950085176, -1352877.5992428334, -1354615.6626388268, -1351517.925035784, -1350395.7720792037, -1355468.214768313, -1350950.9235178346, -1349461.9810155102, -1353244.1483122527, -1351773.7359352622, -1354580.862936983], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.14230792718185195, "mean_inference_ms": 0.2510567717694464, "mean_action_processing_ms": 0.05992106576592893, "mean_env_wait_ms": 0.4743466465548183, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0023775912345723902, "StateBufferConnector_ms": 0.0017358901652883977, "ViewRequirementAgentConnector_ms": 0.0454030138380984}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 3312240, "num_agent_steps_trained": 3312240, "num_env_steps_sampled": 3312240, "num_env_steps_trained": 3312240, "num_env_steps_sampled_this_iter": 43920, "num_env_steps_trained_this_iter": 43920, "num_env_steps_sampled_throughput_per_sec": 1119.0550800927529, "num_env_steps_trained_throughput_per_sec": 1119.0550800927529, "timesteps_total": 3312240, "num_steps_trained_this_iter": 43920, "agent_timesteps_total": 3312240, "timers": {"training_iteration_time_ms": 39284.05, "sample_time_ms": 38543.742, "load_time_ms": 12.917, "load_throughput": 3400127.942, "learn_time_ms": 726.57, "learn_throughput": 60448.425, "synch_weights_time_ms": 0.705}, "counters": {"num_env_steps_sampled": 3312240, "num_env_steps_trained": 3312240, "num_agent_steps_sampled": 3312240, "num_agent_steps_trained": 3312240}, "done": false, "episodes_total": 1266, "training_iteration": 387, "trial_id": "d8b7e_00000", "date": "2023-07-27_05-42-38", "timestamp": 1690425758, "time_this_iter_s": 39.24942994117737, "time_total_s": 6553.75683760643, "pid": 18921, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 366, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[1291920, 5e-05], [1731120, 8e-05], [2170320, 2.5e-05], [2609520, 2.5e-05], [3048720, 2.5e-05], [3487920, 2.5e-05], [3927120, 1e-05], [4366320, 1e-05], [4805520, 1e-05], [5244720, 5e-06], [5683920, 5e-06], [6123120, 5e-06], [6562320, 5e-06], [7001520, 1e-06], [7440720, 1e-06], [7879920, 1e-06], [8319120, 1e-06], [8758320, 5e-07], [9197520, 5e-07], [9636720, 2.5e-07], [10075920, 2.5e-07], [10515120, 1e-08], [10954320, 1e-08], [11393520, 5e-09], [11832720, 5e-09], [12271920, 1e-09]], "grad_clip": 0.5, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.1, "final_epsilon": 0.01, "epsilon_timesteps": 1387080}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 43920, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x16b7b79d0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1886.2120797634125, "iterations_since_restore": 47, "perf": {"cpu_util_percent": 18.373214285714287, "ram_util_percent": 68.85000000000001}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 2.5000000000000005e-05, "entropy_coeff": 0.049999999999999996, "policy_entropy": -1615.696636589206, "policy_loss": -4.308916704682747e+19, "vf_loss": 303791762.2157434}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 32585.5, "diff_num_grad_updates_vs_sampler_policy": 32584.5}}, "num_env_steps_sampled": 3356160, "num_env_steps_trained": 3356160, "num_agent_steps_sampled": 3356160, "num_agent_steps_trained": 3356160}, "sampler_results": {"episode_reward_max": -1348824.8954038802, "episode_reward_min": -1369366.2314788997, "episode_reward_mean": -1353175.2648122746, "episode_len_mean": 43920.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1369366.2314788997, -1361335.2082701626, -1354747.2510403998, -1351385.668151872, -1353878.0036070035, -1353934.4440263135, -1349299.1822382265, -1352848.977192731, -1354881.8648155385, -1350293.381402571, -1351982.609620888, -1355148.9106643137, -1353355.7607168008, -1351316.0660699722, -1348824.8954038802, -1353463.9545051646, -1350201.1795549188, -1352786.6794055027, -1352053.2572481462, -1352558.3135243794, -1358466.517990561, -1351346.3540966634, -1351505.6693919636, -1353330.2319483531, -1351757.3621417605, -1351111.1344867356, -1352960.1558008753, -1353830.0290992912, -1352774.403007062, -1353239.1979867364, -1351903.1794592983, -1353195.1205072168, -1350544.7864785872, -1351714.7076935158, -1353808.3265127144, -1354467.1794068213, -1354455.2950085176, -1352877.5992428334, -1354615.6626388268, -1351517.925035784, -1350395.7720792037, -1355468.214768313, -1350950.9235178346, -1349461.9810155102, -1353244.1483122527, -1351773.7359352622, -1354580.862936983, -1353454.3955520217], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.14218954763080727, "mean_inference_ms": 0.25078552652124103, "mean_action_processing_ms": 0.059875517113082755, "mean_env_wait_ms": 0.4738620110998923, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002411504586537679, "StateBufferConnector_ms": 0.0017404556274414062, "ViewRequirementAgentConnector_ms": 0.04538347323735555}}, "episode_reward_max": -1348824.8954038802, "episode_reward_min": -1369366.2314788997, "episode_reward_mean": -1353175.2648122746, "episode_len_mean": 43920.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1369366.2314788997, -1361335.2082701626, -1354747.2510403998, -1351385.668151872, -1353878.0036070035, -1353934.4440263135, -1349299.1822382265, -1352848.977192731, -1354881.8648155385, -1350293.381402571, -1351982.609620888, -1355148.9106643137, -1353355.7607168008, -1351316.0660699722, -1348824.8954038802, -1353463.9545051646, -1350201.1795549188, -1352786.6794055027, -1352053.2572481462, -1352558.3135243794, -1358466.517990561, -1351346.3540966634, -1351505.6693919636, -1353330.2319483531, -1351757.3621417605, -1351111.1344867356, -1352960.1558008753, -1353830.0290992912, -1352774.403007062, -1353239.1979867364, -1351903.1794592983, -1353195.1205072168, -1350544.7864785872, -1351714.7076935158, -1353808.3265127144, -1354467.1794068213, -1354455.2950085176, -1352877.5992428334, -1354615.6626388268, -1351517.925035784, -1350395.7720792037, -1355468.214768313, -1350950.9235178346, -1349461.9810155102, -1353244.1483122527, -1351773.7359352622, -1354580.862936983, -1353454.3955520217], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.14218954763080727, "mean_inference_ms": 0.25078552652124103, "mean_action_processing_ms": 0.059875517113082755, "mean_env_wait_ms": 0.4738620110998923, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002411504586537679, "StateBufferConnector_ms": 0.0017404556274414062, "ViewRequirementAgentConnector_ms": 0.04538347323735555}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 3356160, "num_agent_steps_trained": 3356160, "num_env_steps_sampled": 3356160, "num_env_steps_trained": 3356160, "num_env_steps_sampled_this_iter": 43920, "num_env_steps_trained_this_iter": 43920, "num_env_steps_sampled_throughput_per_sec": 1120.8728473510025, "num_env_steps_trained_throughput_per_sec": 1120.8728473510025, "timesteps_total": 3356160, "num_steps_trained_this_iter": 43920, "agent_timesteps_total": 3356160, "timers": {"training_iteration_time_ms": 39295.104, "sample_time_ms": 38554.066, "load_time_ms": 12.954, "load_throughput": 3390571.747, "learn_time_ms": 727.266, "learn_throughput": 60390.566, "synch_weights_time_ms": 0.703}, "counters": {"num_env_steps_sampled": 3356160, "num_env_steps_trained": 3356160, "num_agent_steps_sampled": 3356160, "num_agent_steps_trained": 3356160}, "done": false, "episodes_total": 1267, "training_iteration": 388, "trial_id": "d8b7e_00000", "date": "2023-07-27_05-43-17", "timestamp": 1690425797, "time_this_iter_s": 39.18615174293518, "time_total_s": 6592.942989349365, "pid": 18921, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 366, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[1291920, 5e-05], [1731120, 8e-05], [2170320, 2.5e-05], [2609520, 2.5e-05], [3048720, 2.5e-05], [3487920, 2.5e-05], [3927120, 1e-05], [4366320, 1e-05], [4805520, 1e-05], [5244720, 5e-06], [5683920, 5e-06], [6123120, 5e-06], [6562320, 5e-06], [7001520, 1e-06], [7440720, 1e-06], [7879920, 1e-06], [8319120, 1e-06], [8758320, 5e-07], [9197520, 5e-07], [9636720, 2.5e-07], [10075920, 2.5e-07], [10515120, 1e-08], [10954320, 1e-08], [11393520, 5e-09], [11832720, 5e-09], [12271920, 1e-09]], "grad_clip": 0.5, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.1, "final_epsilon": 0.01, "epsilon_timesteps": 1387080}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 43920, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x16b7b79d0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1925.3982315063477, "iterations_since_restore": 48, "perf": {"cpu_util_percent": 18.054545454545455, "ram_util_percent": 68.92363636363636}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 2.5000000000000005e-05, "entropy_coeff": 0.049999999999999996, "policy_entropy": -1585.4198291656228, "policy_loss": -3.4550032011349692e+19, "vf_loss": 302915308.66472304}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 33271.5, "diff_num_grad_updates_vs_sampler_policy": 33270.5}}, "num_env_steps_sampled": 3400080, "num_env_steps_trained": 3400080, "num_agent_steps_sampled": 3400080, "num_agent_steps_trained": 3400080}, "sampler_results": {"episode_reward_max": -1348824.8954038802, "episode_reward_min": -1369366.2314788997, "episode_reward_mean": -1353149.7429418324, "episode_len_mean": 43920.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1369366.2314788997, -1361335.2082701626, -1354747.2510403998, -1351385.668151872, -1353878.0036070035, -1353934.4440263135, -1349299.1822382265, -1352848.977192731, -1354881.8648155385, -1350293.381402571, -1351982.609620888, -1355148.9106643137, -1353355.7607168008, -1351316.0660699722, -1348824.8954038802, -1353463.9545051646, -1350201.1795549188, -1352786.6794055027, -1352053.2572481462, -1352558.3135243794, -1358466.517990561, -1351346.3540966634, -1351505.6693919636, -1353330.2319483531, -1351757.3621417605, -1351111.1344867356, -1352960.1558008753, -1353830.0290992912, -1352774.403007062, -1353239.1979867364, -1351903.1794592983, -1353195.1205072168, -1350544.7864785872, -1351714.7076935158, -1353808.3265127144, -1354467.1794068213, -1354455.2950085176, -1352877.5992428334, -1354615.6626388268, -1351517.925035784, -1350395.7720792037, -1355468.214768313, -1350950.9235178346, -1349461.9810155102, -1353244.1483122527, -1351773.7359352622, -1354580.862936983, -1353454.3955520217, -1351924.6931606017], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.14207514719560682, "mean_inference_ms": 0.25052321126883415, "mean_action_processing_ms": 0.059831489504547974, "mean_env_wait_ms": 0.47339524420989987, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002402188826580437, "StateBufferConnector_ms": 0.0017380227847975127, "ViewRequirementAgentConnector_ms": 0.045324831592793366}}, "episode_reward_max": -1348824.8954038802, "episode_reward_min": -1369366.2314788997, "episode_reward_mean": -1353149.7429418324, "episode_len_mean": 43920.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1369366.2314788997, -1361335.2082701626, -1354747.2510403998, -1351385.668151872, -1353878.0036070035, -1353934.4440263135, -1349299.1822382265, -1352848.977192731, -1354881.8648155385, -1350293.381402571, -1351982.609620888, -1355148.9106643137, -1353355.7607168008, -1351316.0660699722, -1348824.8954038802, -1353463.9545051646, -1350201.1795549188, -1352786.6794055027, -1352053.2572481462, -1352558.3135243794, -1358466.517990561, -1351346.3540966634, -1351505.6693919636, -1353330.2319483531, -1351757.3621417605, -1351111.1344867356, -1352960.1558008753, -1353830.0290992912, -1352774.403007062, -1353239.1979867364, -1351903.1794592983, -1353195.1205072168, -1350544.7864785872, -1351714.7076935158, -1353808.3265127144, -1354467.1794068213, -1354455.2950085176, -1352877.5992428334, -1354615.6626388268, -1351517.925035784, -1350395.7720792037, -1355468.214768313, -1350950.9235178346, -1349461.9810155102, -1353244.1483122527, -1351773.7359352622, -1354580.862936983, -1353454.3955520217, -1351924.6931606017], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.14207514719560682, "mean_inference_ms": 0.25052321126883415, "mean_action_processing_ms": 0.059831489504547974, "mean_env_wait_ms": 0.47339524420989987, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002402188826580437, "StateBufferConnector_ms": 0.0017380227847975127, "ViewRequirementAgentConnector_ms": 0.045324831592793366}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 3400080, "num_agent_steps_trained": 3400080, "num_env_steps_sampled": 3400080, "num_env_steps_trained": 3400080, "num_env_steps_sampled_this_iter": 43920, "num_env_steps_trained_this_iter": 43920, "num_env_steps_sampled_throughput_per_sec": 1110.5297746215217, "num_env_steps_trained_throughput_per_sec": 1110.5297746215217, "timesteps_total": 3400080, "num_steps_trained_this_iter": 43920, "agent_timesteps_total": 3400080, "timers": {"training_iteration_time_ms": 39307.074, "sample_time_ms": 38570.26, "load_time_ms": 12.904, "load_throughput": 3403595.71, "learn_time_ms": 723.092, "learn_throughput": 60739.156, "synch_weights_time_ms": 0.701}, "counters": {"num_env_steps_sampled": 3400080, "num_env_steps_trained": 3400080, "num_agent_steps_sampled": 3400080, "num_agent_steps_trained": 3400080}, "done": false, "episodes_total": 1268, "training_iteration": 389, "trial_id": "d8b7e_00000", "date": "2023-07-27_05-43-57", "timestamp": 1690425837, "time_this_iter_s": 39.55084013938904, "time_total_s": 6632.493829488754, "pid": 18921, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 366, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[1291920, 5e-05], [1731120, 8e-05], [2170320, 2.5e-05], [2609520, 2.5e-05], [3048720, 2.5e-05], [3487920, 2.5e-05], [3927120, 1e-05], [4366320, 1e-05], [4805520, 1e-05], [5244720, 5e-06], [5683920, 5e-06], [6123120, 5e-06], [6562320, 5e-06], [7001520, 1e-06], [7440720, 1e-06], [7879920, 1e-06], [8319120, 1e-06], [8758320, 5e-07], [9197520, 5e-07], [9636720, 2.5e-07], [10075920, 2.5e-07], [10515120, 1e-08], [10954320, 1e-08], [11393520, 5e-09], [11832720, 5e-09], [12271920, 1e-09]], "grad_clip": 0.5, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.1, "final_epsilon": 0.01, "epsilon_timesteps": 1387080}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 43920, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x16b7b79d0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1964.9490716457367, "iterations_since_restore": 49, "perf": {"cpu_util_percent": 18.360714285714288, "ram_util_percent": 68.925}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 2.5000000000000005e-05, "entropy_coeff": 0.049999999999999996, "policy_entropy": -1586.107755166101, "policy_loss": -3.1683007400926925e+19, "vf_loss": 301922750.7521866}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 33957.5, "diff_num_grad_updates_vs_sampler_policy": 33956.5}}, "num_env_steps_sampled": 3444000, "num_env_steps_trained": 3444000, "num_agent_steps_sampled": 3444000, "num_agent_steps_trained": 3444000}, "sampler_results": {"episode_reward_max": -1348824.8954038802, "episode_reward_min": -1369366.2314788997, "episode_reward_mean": -1353073.7435730034, "episode_len_mean": 43920.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1369366.2314788997, -1361335.2082701626, -1354747.2510403998, -1351385.668151872, -1353878.0036070035, -1353934.4440263135, -1349299.1822382265, -1352848.977192731, -1354881.8648155385, -1350293.381402571, -1351982.609620888, -1355148.9106643137, -1353355.7607168008, -1351316.0660699722, -1348824.8954038802, -1353463.9545051646, -1350201.1795549188, -1352786.6794055027, -1352053.2572481462, -1352558.3135243794, -1358466.517990561, -1351346.3540966634, -1351505.6693919636, -1353330.2319483531, -1351757.3621417605, -1351111.1344867356, -1352960.1558008753, -1353830.0290992912, -1352774.403007062, -1353239.1979867364, -1351903.1794592983, -1353195.1205072168, -1350544.7864785872, -1351714.7076935158, -1353808.3265127144, -1354467.1794068213, -1354455.2950085176, -1352877.5992428334, -1354615.6626388268, -1351517.925035784, -1350395.7720792037, -1355468.214768313, -1350950.9235178346, -1349461.9810155102, -1353244.1483122527, -1351773.7359352622, -1354580.862936983, -1353454.3955520217, -1351924.6931606017, -1349349.7745003805], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.14196461985282693, "mean_inference_ms": 0.2502691043040233, "mean_action_processing_ms": 0.05978876517348163, "mean_env_wait_ms": 0.4729413302161152, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002392292022705078, "StateBufferConnector_ms": 0.0017333030700683594, "ViewRequirementAgentConnector_ms": 0.04526662826538086}}, "episode_reward_max": -1348824.8954038802, "episode_reward_min": -1369366.2314788997, "episode_reward_mean": -1353073.7435730034, "episode_len_mean": 43920.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1369366.2314788997, -1361335.2082701626, -1354747.2510403998, -1351385.668151872, -1353878.0036070035, -1353934.4440263135, -1349299.1822382265, -1352848.977192731, -1354881.8648155385, -1350293.381402571, -1351982.609620888, -1355148.9106643137, -1353355.7607168008, -1351316.0660699722, -1348824.8954038802, -1353463.9545051646, -1350201.1795549188, -1352786.6794055027, -1352053.2572481462, -1352558.3135243794, -1358466.517990561, -1351346.3540966634, -1351505.6693919636, -1353330.2319483531, -1351757.3621417605, -1351111.1344867356, -1352960.1558008753, -1353830.0290992912, -1352774.403007062, -1353239.1979867364, -1351903.1794592983, -1353195.1205072168, -1350544.7864785872, -1351714.7076935158, -1353808.3265127144, -1354467.1794068213, -1354455.2950085176, -1352877.5992428334, -1354615.6626388268, -1351517.925035784, -1350395.7720792037, -1355468.214768313, -1350950.9235178346, -1349461.9810155102, -1353244.1483122527, -1351773.7359352622, -1354580.862936983, -1353454.3955520217, -1351924.6931606017, -1349349.7745003805], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.14196461985282693, "mean_inference_ms": 0.2502691043040233, "mean_action_processing_ms": 0.05978876517348163, "mean_env_wait_ms": 0.4729413302161152, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002392292022705078, "StateBufferConnector_ms": 0.0017333030700683594, "ViewRequirementAgentConnector_ms": 0.04526662826538086}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 3444000, "num_agent_steps_trained": 3444000, "num_env_steps_sampled": 3444000, "num_env_steps_trained": 3444000, "num_env_steps_sampled_this_iter": 43920, "num_env_steps_trained_this_iter": 43920, "num_env_steps_sampled_throughput_per_sec": 1124.2844839170089, "num_env_steps_trained_throughput_per_sec": 1124.2844839170089, "timesteps_total": 3444000, "num_steps_trained_this_iter": 43920, "agent_timesteps_total": 3444000, "timers": {"training_iteration_time_ms": 39277.106, "sample_time_ms": 38539.681, "load_time_ms": 12.924, "load_throughput": 3398302.668, "learn_time_ms": 723.703, "learn_throughput": 60687.917, "synch_weights_time_ms": 0.686}, "counters": {"num_env_steps_sampled": 3444000, "num_env_steps_trained": 3444000, "num_agent_steps_sampled": 3444000, "num_agent_steps_trained": 3444000}, "done": false, "episodes_total": 1269, "training_iteration": 390, "trial_id": "d8b7e_00000", "date": "2023-07-27_05-44-36", "timestamp": 1690425876, "time_this_iter_s": 39.0669469833374, "time_total_s": 6671.560776472092, "pid": 18921, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 366, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[1291920, 5e-05], [1731120, 8e-05], [2170320, 2.5e-05], [2609520, 2.5e-05], [3048720, 2.5e-05], [3487920, 2.5e-05], [3927120, 1e-05], [4366320, 1e-05], [4805520, 1e-05], [5244720, 5e-06], [5683920, 5e-06], [6123120, 5e-06], [6562320, 5e-06], [7001520, 1e-06], [7440720, 1e-06], [7879920, 1e-06], [8319120, 1e-06], [8758320, 5e-07], [9197520, 5e-07], [9636720, 2.5e-07], [10075920, 2.5e-07], [10515120, 1e-08], [10954320, 1e-08], [11393520, 5e-09], [11832720, 5e-09], [12271920, 1e-09]], "grad_clip": 0.5, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.1, "final_epsilon": 0.01, "epsilon_timesteps": 1387080}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 43920, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x16b7b79d0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 2004.016018629074, "iterations_since_restore": 50, "perf": {"cpu_util_percent": 19.592857142857145, "ram_util_percent": 68.89821428571429}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 2.5000000000000005e-05, "entropy_coeff": 0.049999999999999996, "policy_entropy": -1555.002720068217, "policy_loss": -2.0630854043419263e+19, "vf_loss": 301776379.2303207}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 34643.5, "diff_num_grad_updates_vs_sampler_policy": 34642.5}}, "num_env_steps_sampled": 3487920, "num_env_steps_trained": 3487920, "num_agent_steps_sampled": 3487920, "num_agent_steps_trained": 3487920}, "sampler_results": {"episode_reward_max": -1348824.8954038802, "episode_reward_min": -1369366.2314788997, "episode_reward_mean": -1352999.9453325688, "episode_len_mean": 43920.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1369366.2314788997, -1361335.2082701626, -1354747.2510403998, -1351385.668151872, -1353878.0036070035, -1353934.4440263135, -1349299.1822382265, -1352848.977192731, -1354881.8648155385, -1350293.381402571, -1351982.609620888, -1355148.9106643137, -1353355.7607168008, -1351316.0660699722, -1348824.8954038802, -1353463.9545051646, -1350201.1795549188, -1352786.6794055027, -1352053.2572481462, -1352558.3135243794, -1358466.517990561, -1351346.3540966634, -1351505.6693919636, -1353330.2319483531, -1351757.3621417605, -1351111.1344867356, -1352960.1558008753, -1353830.0290992912, -1352774.403007062, -1353239.1979867364, -1351903.1794592983, -1353195.1205072168, -1350544.7864785872, -1351714.7076935158, -1353808.3265127144, -1354467.1794068213, -1354455.2950085176, -1352877.5992428334, -1354615.6626388268, -1351517.925035784, -1350395.7720792037, -1355468.214768313, -1350950.9235178346, -1349461.9810155102, -1353244.1483122527, -1351773.7359352622, -1354580.862936983, -1353454.3955520217, -1351924.6931606017, -1349349.7745003805, -1349310.0333108394], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1418577957061058, "mean_inference_ms": 0.2500229110242602, "mean_action_processing_ms": 0.05974737437256647, "mean_env_wait_ms": 0.4725016013004252, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002384185791015625, "StateBufferConnector_ms": 0.0017236260806812959, "ViewRequirementAgentConnector_ms": 0.045221927119236366}}, "episode_reward_max": -1348824.8954038802, "episode_reward_min": -1369366.2314788997, "episode_reward_mean": -1352999.9453325688, "episode_len_mean": 43920.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1369366.2314788997, -1361335.2082701626, -1354747.2510403998, -1351385.668151872, -1353878.0036070035, -1353934.4440263135, -1349299.1822382265, -1352848.977192731, -1354881.8648155385, -1350293.381402571, -1351982.609620888, -1355148.9106643137, -1353355.7607168008, -1351316.0660699722, -1348824.8954038802, -1353463.9545051646, -1350201.1795549188, -1352786.6794055027, -1352053.2572481462, -1352558.3135243794, -1358466.517990561, -1351346.3540966634, -1351505.6693919636, -1353330.2319483531, -1351757.3621417605, -1351111.1344867356, -1352960.1558008753, -1353830.0290992912, -1352774.403007062, -1353239.1979867364, -1351903.1794592983, -1353195.1205072168, -1350544.7864785872, -1351714.7076935158, -1353808.3265127144, -1354467.1794068213, -1354455.2950085176, -1352877.5992428334, -1354615.6626388268, -1351517.925035784, -1350395.7720792037, -1355468.214768313, -1350950.9235178346, -1349461.9810155102, -1353244.1483122527, -1351773.7359352622, -1354580.862936983, -1353454.3955520217, -1351924.6931606017, -1349349.7745003805, -1349310.0333108394], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1418577957061058, "mean_inference_ms": 0.2500229110242602, "mean_action_processing_ms": 0.05974737437256647, "mean_env_wait_ms": 0.4725016013004252, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002384185791015625, "StateBufferConnector_ms": 0.0017236260806812959, "ViewRequirementAgentConnector_ms": 0.045221927119236366}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 3487920, "num_agent_steps_trained": 3487920, "num_env_steps_sampled": 3487920, "num_env_steps_trained": 3487920, "num_env_steps_sampled_this_iter": 43920, "num_env_steps_trained_this_iter": 43920, "num_env_steps_sampled_throughput_per_sec": 1117.393741468381, "num_env_steps_trained_throughput_per_sec": 1117.393741468381, "timesteps_total": 3487920, "num_steps_trained_this_iter": 43920, "agent_timesteps_total": 3487920, "timers": {"training_iteration_time_ms": 39289.566, "sample_time_ms": 38551.567, "load_time_ms": 12.852, "load_throughput": 3417309.575, "learn_time_ms": 724.346, "learn_throughput": 60633.983, "synch_weights_time_ms": 0.689}, "counters": {"num_env_steps_sampled": 3487920, "num_env_steps_trained": 3487920, "num_agent_steps_sampled": 3487920, "num_agent_steps_trained": 3487920}, "done": false, "episodes_total": 1270, "training_iteration": 391, "trial_id": "d8b7e_00000", "date": "2023-07-27_05-45-15", "timestamp": 1690425915, "time_this_iter_s": 39.307788133621216, "time_total_s": 6710.868564605713, "pid": 18921, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 366, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[1291920, 5e-05], [1731120, 8e-05], [2170320, 2.5e-05], [2609520, 2.5e-05], [3048720, 2.5e-05], [3487920, 2.5e-05], [3927120, 1e-05], [4366320, 1e-05], [4805520, 1e-05], [5244720, 5e-06], [5683920, 5e-06], [6123120, 5e-06], [6562320, 5e-06], [7001520, 1e-06], [7440720, 1e-06], [7879920, 1e-06], [8319120, 1e-06], [8758320, 5e-07], [9197520, 5e-07], [9636720, 2.5e-07], [10075920, 2.5e-07], [10515120, 1e-08], [10954320, 1e-08], [11393520, 5e-09], [11832720, 5e-09], [12271920, 1e-09]], "grad_clip": 0.5, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.1, "final_epsilon": 0.01, "epsilon_timesteps": 1387080}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 43920, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x16b7b79d0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 2043.3238067626953, "iterations_since_restore": 51, "perf": {"cpu_util_percent": 17.834545454545456, "ram_util_percent": 68.94545454545455}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 2.5000000000000005e-05, "entropy_coeff": 0.049999999999999996, "policy_entropy": -1513.7182113602976, "policy_loss": -1.3093726423877786e+19, "vf_loss": 304679843.5451895}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 35329.5, "diff_num_grad_updates_vs_sampler_policy": 35328.5}}, "num_env_steps_sampled": 3531840, "num_env_steps_trained": 3531840, "num_agent_steps_sampled": 3531840, "num_agent_steps_trained": 3531840}, "sampler_results": {"episode_reward_max": -1348824.8954038802, "episode_reward_min": -1369366.2314788997, "episode_reward_mean": -1353049.2289929255, "episode_len_mean": 43920.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1369366.2314788997, -1361335.2082701626, -1354747.2510403998, -1351385.668151872, -1353878.0036070035, -1353934.4440263135, -1349299.1822382265, -1352848.977192731, -1354881.8648155385, -1350293.381402571, -1351982.609620888, -1355148.9106643137, -1353355.7607168008, -1351316.0660699722, -1348824.8954038802, -1353463.9545051646, -1350201.1795549188, -1352786.6794055027, -1352053.2572481462, -1352558.3135243794, -1358466.517990561, -1351346.3540966634, -1351505.6693919636, -1353330.2319483531, -1351757.3621417605, -1351111.1344867356, -1352960.1558008753, -1353830.0290992912, -1352774.403007062, -1353239.1979867364, -1351903.1794592983, -1353195.1205072168, -1350544.7864785872, -1351714.7076935158, -1353808.3265127144, -1354467.1794068213, -1354455.2950085176, -1352877.5992428334, -1354615.6626388268, -1351517.925035784, -1350395.7720792037, -1355468.214768313, -1350950.9235178346, -1349461.9810155102, -1353244.1483122527, -1351773.7359352622, -1354580.862936983, -1353454.3955520217, -1351924.6931606017, -1349349.7745003805, -1349310.0333108394, -1355562.6956711074], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.14175445281886728, "mean_inference_ms": 0.24978395136075054, "mean_action_processing_ms": 0.0597071826401696, "mean_env_wait_ms": 0.47207536531094874, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002377766829270583, "StateBufferConnector_ms": 0.001719823250403771, "ViewRequirementAgentConnector_ms": 0.04519040767963116}}, "episode_reward_max": -1348824.8954038802, "episode_reward_min": -1369366.2314788997, "episode_reward_mean": -1353049.2289929255, "episode_len_mean": 43920.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1369366.2314788997, -1361335.2082701626, -1354747.2510403998, -1351385.668151872, -1353878.0036070035, -1353934.4440263135, -1349299.1822382265, -1352848.977192731, -1354881.8648155385, -1350293.381402571, -1351982.609620888, -1355148.9106643137, -1353355.7607168008, -1351316.0660699722, -1348824.8954038802, -1353463.9545051646, -1350201.1795549188, -1352786.6794055027, -1352053.2572481462, -1352558.3135243794, -1358466.517990561, -1351346.3540966634, -1351505.6693919636, -1353330.2319483531, -1351757.3621417605, -1351111.1344867356, -1352960.1558008753, -1353830.0290992912, -1352774.403007062, -1353239.1979867364, -1351903.1794592983, -1353195.1205072168, -1350544.7864785872, -1351714.7076935158, -1353808.3265127144, -1354467.1794068213, -1354455.2950085176, -1352877.5992428334, -1354615.6626388268, -1351517.925035784, -1350395.7720792037, -1355468.214768313, -1350950.9235178346, -1349461.9810155102, -1353244.1483122527, -1351773.7359352622, -1354580.862936983, -1353454.3955520217, -1351924.6931606017, -1349349.7745003805, -1349310.0333108394, -1355562.6956711074], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.14175445281886728, "mean_inference_ms": 0.24978395136075054, "mean_action_processing_ms": 0.0597071826401696, "mean_env_wait_ms": 0.47207536531094874, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002377766829270583, "StateBufferConnector_ms": 0.001719823250403771, "ViewRequirementAgentConnector_ms": 0.04519040767963116}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 3531840, "num_agent_steps_trained": 3531840, "num_env_steps_sampled": 3531840, "num_env_steps_trained": 3531840, "num_env_steps_sampled_this_iter": 43920, "num_env_steps_trained_this_iter": 43920, "num_env_steps_sampled_throughput_per_sec": 1118.531173060078, "num_env_steps_trained_throughput_per_sec": 1118.531173060078, "timesteps_total": 3531840, "num_steps_trained_this_iter": 43920, "agent_timesteps_total": 3531840, "timers": {"training_iteration_time_ms": 39302.122, "sample_time_ms": 38562.879, "load_time_ms": 12.853, "load_throughput": 3417233.504, "learn_time_ms": 725.597, "learn_throughput": 60529.43, "synch_weights_time_ms": 0.681}, "counters": {"num_env_steps_sampled": 3531840, "num_env_steps_trained": 3531840, "num_agent_steps_sampled": 3531840, "num_agent_steps_trained": 3531840}, "done": false, "episodes_total": 1271, "training_iteration": 392, "trial_id": "d8b7e_00000", "date": "2023-07-27_05-45-55", "timestamp": 1690425955, "time_this_iter_s": 39.26790809631348, "time_total_s": 6750.136472702026, "pid": 18921, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 366, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[1291920, 5e-05], [1731120, 8e-05], [2170320, 2.5e-05], [2609520, 2.5e-05], [3048720, 2.5e-05], [3487920, 2.5e-05], [3927120, 1e-05], [4366320, 1e-05], [4805520, 1e-05], [5244720, 5e-06], [5683920, 5e-06], [6123120, 5e-06], [6562320, 5e-06], [7001520, 1e-06], [7440720, 1e-06], [7879920, 1e-06], [8319120, 1e-06], [8758320, 5e-07], [9197520, 5e-07], [9636720, 2.5e-07], [10075920, 2.5e-07], [10515120, 1e-08], [10954320, 1e-08], [11393520, 5e-09], [11832720, 5e-09], [12271920, 1e-09]], "grad_clip": 0.5, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.1, "final_epsilon": 0.01, "epsilon_timesteps": 1387080}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 43920, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x16b7b79d0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 2082.591714859009, "iterations_since_restore": 52, "perf": {"cpu_util_percent": 18.485714285714288, "ram_util_percent": 68.95714285714287}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 2.3500000000000005e-05, "entropy_coeff": 0.049999999999999996, "policy_entropy": -1484.5038324027994, "policy_loss": -1.131470201806624e+19, "vf_loss": 302579594.98542273}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 36015.5, "diff_num_grad_updates_vs_sampler_policy": 36014.5}}, "num_env_steps_sampled": 3575760, "num_env_steps_trained": 3575760, "num_agent_steps_sampled": 3575760, "num_agent_steps_trained": 3575760}, "sampler_results": {"episode_reward_max": -1348824.8954038802, "episode_reward_min": -1369366.2314788997, "episode_reward_mean": -1353014.0466611413, "episode_len_mean": 43920.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1369366.2314788997, -1361335.2082701626, -1354747.2510403998, -1351385.668151872, -1353878.0036070035, -1353934.4440263135, -1349299.1822382265, -1352848.977192731, -1354881.8648155385, -1350293.381402571, -1351982.609620888, -1355148.9106643137, -1353355.7607168008, -1351316.0660699722, -1348824.8954038802, -1353463.9545051646, -1350201.1795549188, -1352786.6794055027, -1352053.2572481462, -1352558.3135243794, -1358466.517990561, -1351346.3540966634, -1351505.6693919636, -1353330.2319483531, -1351757.3621417605, -1351111.1344867356, -1352960.1558008753, -1353830.0290992912, -1352774.403007062, -1353239.1979867364, -1351903.1794592983, -1353195.1205072168, -1350544.7864785872, -1351714.7076935158, -1353808.3265127144, -1354467.1794068213, -1354455.2950085176, -1352877.5992428334, -1354615.6626388268, -1351517.925035784, -1350395.7720792037, -1355468.214768313, -1350950.9235178346, -1349461.9810155102, -1353244.1483122527, -1351773.7359352622, -1354580.862936983, -1353454.3955520217, -1351924.6931606017, -1349349.7745003805, -1349310.0333108394, -1355562.6956711074, -1351184.5654083667], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1416540645056962, "mean_inference_ms": 0.24955247310183135, "mean_action_processing_ms": 0.05966823893353096, "mean_env_wait_ms": 0.47166394835805303, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002377438095380675, "StateBufferConnector_ms": 0.0017256106970445165, "ViewRequirementAgentConnector_ms": 0.04518706843538104}}, "episode_reward_max": -1348824.8954038802, "episode_reward_min": -1369366.2314788997, "episode_reward_mean": -1353014.0466611413, "episode_len_mean": 43920.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1369366.2314788997, -1361335.2082701626, -1354747.2510403998, -1351385.668151872, -1353878.0036070035, -1353934.4440263135, -1349299.1822382265, -1352848.977192731, -1354881.8648155385, -1350293.381402571, -1351982.609620888, -1355148.9106643137, -1353355.7607168008, -1351316.0660699722, -1348824.8954038802, -1353463.9545051646, -1350201.1795549188, -1352786.6794055027, -1352053.2572481462, -1352558.3135243794, -1358466.517990561, -1351346.3540966634, -1351505.6693919636, -1353330.2319483531, -1351757.3621417605, -1351111.1344867356, -1352960.1558008753, -1353830.0290992912, -1352774.403007062, -1353239.1979867364, -1351903.1794592983, -1353195.1205072168, -1350544.7864785872, -1351714.7076935158, -1353808.3265127144, -1354467.1794068213, -1354455.2950085176, -1352877.5992428334, -1354615.6626388268, -1351517.925035784, -1350395.7720792037, -1355468.214768313, -1350950.9235178346, -1349461.9810155102, -1353244.1483122527, -1351773.7359352622, -1354580.862936983, -1353454.3955520217, -1351924.6931606017, -1349349.7745003805, -1349310.0333108394, -1355562.6956711074, -1351184.5654083667], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1416540645056962, "mean_inference_ms": 0.24955247310183135, "mean_action_processing_ms": 0.05966823893353096, "mean_env_wait_ms": 0.47166394835805303, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002377438095380675, "StateBufferConnector_ms": 0.0017256106970445165, "ViewRequirementAgentConnector_ms": 0.04518706843538104}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 3575760, "num_agent_steps_trained": 3575760, "num_env_steps_sampled": 3575760, "num_env_steps_trained": 3575760, "num_env_steps_sampled_this_iter": 43920, "num_env_steps_trained_this_iter": 43920, "num_env_steps_sampled_throughput_per_sec": 1110.3998368931855, "num_env_steps_trained_throughput_per_sec": 1110.3998368931855, "timesteps_total": 3575760, "num_steps_trained_this_iter": 43920, "agent_timesteps_total": 3575760, "timers": {"training_iteration_time_ms": 39316.586, "sample_time_ms": 38576.594, "load_time_ms": 12.769, "load_throughput": 3439578.164, "learn_time_ms": 726.428, "learn_throughput": 60460.262, "synch_weights_time_ms": 0.683}, "counters": {"num_env_steps_sampled": 3575760, "num_env_steps_trained": 3575760, "num_agent_steps_sampled": 3575760, "num_agent_steps_trained": 3575760}, "done": false, "episodes_total": 1272, "training_iteration": 393, "trial_id": "d8b7e_00000", "date": "2023-07-27_05-46-34", "timestamp": 1690425994, "time_this_iter_s": 39.55541396141052, "time_total_s": 6789.691886663437, "pid": 18921, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 366, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[1291920, 5e-05], [1731120, 8e-05], [2170320, 2.5e-05], [2609520, 2.5e-05], [3048720, 2.5e-05], [3487920, 2.5e-05], [3927120, 1e-05], [4366320, 1e-05], [4805520, 1e-05], [5244720, 5e-06], [5683920, 5e-06], [6123120, 5e-06], [6562320, 5e-06], [7001520, 1e-06], [7440720, 1e-06], [7879920, 1e-06], [8319120, 1e-06], [8758320, 5e-07], [9197520, 5e-07], [9636720, 2.5e-07], [10075920, 2.5e-07], [10515120, 1e-08], [10954320, 1e-08], [11393520, 5e-09], [11832720, 5e-09], [12271920, 1e-09]], "grad_clip": 0.5, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.1, "final_epsilon": 0.01, "epsilon_timesteps": 1387080}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 43920, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x16b7b79d0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 2122.1471288204193, "iterations_since_restore": 53, "perf": {"cpu_util_percent": 18.630357142857143, "ram_util_percent": 68.94464285714285}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 2.1999999999999996e-05, "entropy_coeff": 0.049999999999999996, "policy_entropy": -1468.5120911890147, "policy_loss": -1.266586561900905e+19, "vf_loss": 305010093.877551}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 36701.5, "diff_num_grad_updates_vs_sampler_policy": 36700.5}}, "num_env_steps_sampled": 3619680, "num_env_steps_trained": 3619680, "num_agent_steps_sampled": 3619680, "num_agent_steps_trained": 3619680}, "sampler_results": {"episode_reward_max": -1348824.8954038802, "episode_reward_min": -1369366.2314788997, "episode_reward_mean": -1353077.4600489747, "episode_len_mean": 43920.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1369366.2314788997, -1361335.2082701626, -1354747.2510403998, -1351385.668151872, -1353878.0036070035, -1353934.4440263135, -1349299.1822382265, -1352848.977192731, -1354881.8648155385, -1350293.381402571, -1351982.609620888, -1355148.9106643137, -1353355.7607168008, -1351316.0660699722, -1348824.8954038802, -1353463.9545051646, -1350201.1795549188, -1352786.6794055027, -1352053.2572481462, -1352558.3135243794, -1358466.517990561, -1351346.3540966634, -1351505.6693919636, -1353330.2319483531, -1351757.3621417605, -1351111.1344867356, -1352960.1558008753, -1353830.0290992912, -1352774.403007062, -1353239.1979867364, -1351903.1794592983, -1353195.1205072168, -1350544.7864785872, -1351714.7076935158, -1353808.3265127144, -1354467.1794068213, -1354455.2950085176, -1352877.5992428334, -1354615.6626388268, -1351517.925035784, -1350395.7720792037, -1355468.214768313, -1350950.9235178346, -1349461.9810155102, -1353244.1483122527, -1351773.7359352622, -1354580.862936983, -1353454.3955520217, -1351924.6931606017, -1349349.7745003805, -1349310.0333108394, -1355562.6956711074, -1351184.5654083667, -1356438.3696041456], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.14155656698474145, "mean_inference_ms": 0.24932807338610874, "mean_action_processing_ms": 0.05963050197375793, "mean_env_wait_ms": 0.47126427112347646, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002372264862060547, "StateBufferConnector_ms": 0.0017254440872757524, "ViewRequirementAgentConnector_ms": 0.04515073917530201}}, "episode_reward_max": -1348824.8954038802, "episode_reward_min": -1369366.2314788997, "episode_reward_mean": -1353077.4600489747, "episode_len_mean": 43920.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1369366.2314788997, -1361335.2082701626, -1354747.2510403998, -1351385.668151872, -1353878.0036070035, -1353934.4440263135, -1349299.1822382265, -1352848.977192731, -1354881.8648155385, -1350293.381402571, -1351982.609620888, -1355148.9106643137, -1353355.7607168008, -1351316.0660699722, -1348824.8954038802, -1353463.9545051646, -1350201.1795549188, -1352786.6794055027, -1352053.2572481462, -1352558.3135243794, -1358466.517990561, -1351346.3540966634, -1351505.6693919636, -1353330.2319483531, -1351757.3621417605, -1351111.1344867356, -1352960.1558008753, -1353830.0290992912, -1352774.403007062, -1353239.1979867364, -1351903.1794592983, -1353195.1205072168, -1350544.7864785872, -1351714.7076935158, -1353808.3265127144, -1354467.1794068213, -1354455.2950085176, -1352877.5992428334, -1354615.6626388268, -1351517.925035784, -1350395.7720792037, -1355468.214768313, -1350950.9235178346, -1349461.9810155102, -1353244.1483122527, -1351773.7359352622, -1354580.862936983, -1353454.3955520217, -1351924.6931606017, -1349349.7745003805, -1349310.0333108394, -1355562.6956711074, -1351184.5654083667, -1356438.3696041456], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.14155656698474145, "mean_inference_ms": 0.24932807338610874, "mean_action_processing_ms": 0.05963050197375793, "mean_env_wait_ms": 0.47126427112347646, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002372264862060547, "StateBufferConnector_ms": 0.0017254440872757524, "ViewRequirementAgentConnector_ms": 0.04515073917530201}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 3619680, "num_agent_steps_trained": 3619680, "num_env_steps_sampled": 3619680, "num_env_steps_trained": 3619680, "num_env_steps_sampled_this_iter": 43920, "num_env_steps_trained_this_iter": 43920, "num_env_steps_sampled_throughput_per_sec": 1116.9706876449623, "num_env_steps_trained_throughput_per_sec": 1116.9706876449623, "timesteps_total": 3619680, "num_steps_trained_this_iter": 43920, "agent_timesteps_total": 3619680, "timers": {"training_iteration_time_ms": 39312.85, "sample_time_ms": 38567.937, "load_time_ms": 12.689, "load_throughput": 3461202.155, "learn_time_ms": 731.429, "learn_throughput": 60046.81, "synch_weights_time_ms": 0.682}, "counters": {"num_env_steps_sampled": 3619680, "num_env_steps_trained": 3619680, "num_agent_steps_sampled": 3619680, "num_agent_steps_trained": 3619680}, "done": false, "episodes_total": 1273, "training_iteration": 394, "trial_id": "d8b7e_00000", "date": "2023-07-27_05-47-14", "timestamp": 1690426034, "time_this_iter_s": 39.32272982597351, "time_total_s": 6829.01461648941, "pid": 18921, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 366, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[1291920, 5e-05], [1731120, 8e-05], [2170320, 2.5e-05], [2609520, 2.5e-05], [3048720, 2.5e-05], [3487920, 2.5e-05], [3927120, 1e-05], [4366320, 1e-05], [4805520, 1e-05], [5244720, 5e-06], [5683920, 5e-06], [6123120, 5e-06], [6562320, 5e-06], [7001520, 1e-06], [7440720, 1e-06], [7879920, 1e-06], [8319120, 1e-06], [8758320, 5e-07], [9197520, 5e-07], [9636720, 2.5e-07], [10075920, 2.5e-07], [10515120, 1e-08], [10954320, 1e-08], [11393520, 5e-09], [11832720, 5e-09], [12271920, 1e-09]], "grad_clip": 0.5, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.1, "final_epsilon": 0.01, "epsilon_timesteps": 1387080}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 43920, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x16b7b79d0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 2161.469858646393, "iterations_since_restore": 54, "perf": {"cpu_util_percent": 19.5, "ram_util_percent": 68.85892857142856}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 2.0500000000000004e-05, "entropy_coeff": 0.049999999999999996, "policy_entropy": -1444.6797641943217, "policy_loss": -1.3599198945196409e+19, "vf_loss": 302689831.1720117}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 37387.5, "diff_num_grad_updates_vs_sampler_policy": 37386.5}}, "num_env_steps_sampled": 3663600, "num_env_steps_trained": 3663600, "num_agent_steps_sampled": 3663600, "num_agent_steps_trained": 3663600}, "sampler_results": {"episode_reward_max": -1348824.8954038802, "episode_reward_min": -1369366.2314788997, "episode_reward_mean": -1353050.1153427097, "episode_len_mean": 43920.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1369366.2314788997, -1361335.2082701626, -1354747.2510403998, -1351385.668151872, -1353878.0036070035, -1353934.4440263135, -1349299.1822382265, -1352848.977192731, -1354881.8648155385, -1350293.381402571, -1351982.609620888, -1355148.9106643137, -1353355.7607168008, -1351316.0660699722, -1348824.8954038802, -1353463.9545051646, -1350201.1795549188, -1352786.6794055027, -1352053.2572481462, -1352558.3135243794, -1358466.517990561, -1351346.3540966634, -1351505.6693919636, -1353330.2319483531, -1351757.3621417605, -1351111.1344867356, -1352960.1558008753, -1353830.0290992912, -1352774.403007062, -1353239.1979867364, -1351903.1794592983, -1353195.1205072168, -1350544.7864785872, -1351714.7076935158, -1353808.3265127144, -1354467.1794068213, -1354455.2950085176, -1352877.5992428334, -1354615.6626388268, -1351517.925035784, -1350395.7720792037, -1355468.214768313, -1350950.9235178346, -1349461.9810155102, -1353244.1483122527, -1351773.7359352622, -1354580.862936983, -1353454.3955520217, -1351924.6931606017, -1349349.7745003805, -1349310.0333108394, -1355562.6956711074, -1351184.5654083667, -1356438.3696041456, -1351573.5012043987], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1414617093342703, "mean_inference_ms": 0.24911066358198156, "mean_action_processing_ms": 0.059593873793729726, "mean_env_wait_ms": 0.4708764026533898, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0023664127696644177, "StateBufferConnector_ms": 0.0017257170243696733, "ViewRequirementAgentConnector_ms": 0.04514477469704368}}, "episode_reward_max": -1348824.8954038802, "episode_reward_min": -1369366.2314788997, "episode_reward_mean": -1353050.1153427097, "episode_len_mean": 43920.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1369366.2314788997, -1361335.2082701626, -1354747.2510403998, -1351385.668151872, -1353878.0036070035, -1353934.4440263135, -1349299.1822382265, -1352848.977192731, -1354881.8648155385, -1350293.381402571, -1351982.609620888, -1355148.9106643137, -1353355.7607168008, -1351316.0660699722, -1348824.8954038802, -1353463.9545051646, -1350201.1795549188, -1352786.6794055027, -1352053.2572481462, -1352558.3135243794, -1358466.517990561, -1351346.3540966634, -1351505.6693919636, -1353330.2319483531, -1351757.3621417605, -1351111.1344867356, -1352960.1558008753, -1353830.0290992912, -1352774.403007062, -1353239.1979867364, -1351903.1794592983, -1353195.1205072168, -1350544.7864785872, -1351714.7076935158, -1353808.3265127144, -1354467.1794068213, -1354455.2950085176, -1352877.5992428334, -1354615.6626388268, -1351517.925035784, -1350395.7720792037, -1355468.214768313, -1350950.9235178346, -1349461.9810155102, -1353244.1483122527, -1351773.7359352622, -1354580.862936983, -1353454.3955520217, -1351924.6931606017, -1349349.7745003805, -1349310.0333108394, -1355562.6956711074, -1351184.5654083667, -1356438.3696041456, -1351573.5012043987], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1414617093342703, "mean_inference_ms": 0.24911066358198156, "mean_action_processing_ms": 0.059593873793729726, "mean_env_wait_ms": 0.4708764026533898, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0023664127696644177, "StateBufferConnector_ms": 0.0017257170243696733, "ViewRequirementAgentConnector_ms": 0.04514477469704368}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 3663600, "num_agent_steps_trained": 3663600, "num_env_steps_sampled": 3663600, "num_env_steps_trained": 3663600, "num_env_steps_sampled_this_iter": 43920, "num_env_steps_trained_this_iter": 43920, "num_env_steps_sampled_throughput_per_sec": 1116.1676989846853, "num_env_steps_trained_throughput_per_sec": 1116.1676989846853, "timesteps_total": 3663600, "num_steps_trained_this_iter": 43920, "agent_timesteps_total": 3663600, "timers": {"training_iteration_time_ms": 39318.043, "sample_time_ms": 38571.573, "load_time_ms": 12.719, "load_throughput": 3453118.008, "learn_time_ms": 732.959, "learn_throughput": 59921.5, "synch_weights_time_ms": 0.68}, "counters": {"num_env_steps_sampled": 3663600, "num_env_steps_trained": 3663600, "num_agent_steps_sampled": 3663600, "num_agent_steps_trained": 3663600}, "done": false, "episodes_total": 1274, "training_iteration": 395, "trial_id": "d8b7e_00000", "date": "2023-07-27_05-47-53", "timestamp": 1690426073, "time_this_iter_s": 39.350931882858276, "time_total_s": 6868.365548372269, "pid": 18921, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 366, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[1291920, 5e-05], [1731120, 8e-05], [2170320, 2.5e-05], [2609520, 2.5e-05], [3048720, 2.5e-05], [3487920, 2.5e-05], [3927120, 1e-05], [4366320, 1e-05], [4805520, 1e-05], [5244720, 5e-06], [5683920, 5e-06], [6123120, 5e-06], [6562320, 5e-06], [7001520, 1e-06], [7440720, 1e-06], [7879920, 1e-06], [8319120, 1e-06], [8758320, 5e-07], [9197520, 5e-07], [9636720, 2.5e-07], [10075920, 2.5e-07], [10515120, 1e-08], [10954320, 1e-08], [11393520, 5e-09], [11832720, 5e-09], [12271920, 1e-09]], "grad_clip": 0.5, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.1, "final_epsilon": 0.01, "epsilon_timesteps": 1387080}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 43920, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x16b7b79d0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 2200.820790529251, "iterations_since_restore": 55, "perf": {"cpu_util_percent": 17.930909090909093, "ram_util_percent": 68.90363636363637}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1.9e-05, "entropy_coeff": 0.049999999999999996, "policy_entropy": -1429.7517659267949, "policy_loss": -1.1540806389578764e+19, "vf_loss": 303448810.98542273}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 38073.5, "diff_num_grad_updates_vs_sampler_policy": 38072.5}}, "num_env_steps_sampled": 3707520, "num_env_steps_trained": 3707520, "num_agent_steps_sampled": 3707520, "num_agent_steps_trained": 3707520}, "sampler_results": {"episode_reward_max": -1348824.8954038802, "episode_reward_min": -1369366.2314788997, "episode_reward_mean": -1353051.5353025931, "episode_len_mean": 43920.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1369366.2314788997, -1361335.2082701626, -1354747.2510403998, -1351385.668151872, -1353878.0036070035, -1353934.4440263135, -1349299.1822382265, -1352848.977192731, -1354881.8648155385, -1350293.381402571, -1351982.609620888, -1355148.9106643137, -1353355.7607168008, -1351316.0660699722, -1348824.8954038802, -1353463.9545051646, -1350201.1795549188, -1352786.6794055027, -1352053.2572481462, -1352558.3135243794, -1358466.517990561, -1351346.3540966634, -1351505.6693919636, -1353330.2319483531, -1351757.3621417605, -1351111.1344867356, -1352960.1558008753, -1353830.0290992912, -1352774.403007062, -1353239.1979867364, -1351903.1794592983, -1353195.1205072168, -1350544.7864785872, -1351714.7076935158, -1353808.3265127144, -1354467.1794068213, -1354455.2950085176, -1352877.5992428334, -1354615.6626388268, -1351517.925035784, -1350395.7720792037, -1355468.214768313, -1350950.9235178346, -1349461.9810155102, -1353244.1483122527, -1351773.7359352622, -1354580.862936983, -1353454.3955520217, -1351924.6931606017, -1349349.7745003805, -1349310.0333108394, -1355562.6956711074, -1351184.5654083667, -1356438.3696041456, -1351573.5012043987, -1353129.6330961955], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.14136940533393383, "mean_inference_ms": 0.2488994805158356, "mean_action_processing_ms": 0.05955832261793629, "mean_env_wait_ms": 0.47050006590576005, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002362898417881557, "StateBufferConnector_ms": 0.0017229999814714705, "ViewRequirementAgentConnector_ms": 0.045114755630493164}}, "episode_reward_max": -1348824.8954038802, "episode_reward_min": -1369366.2314788997, "episode_reward_mean": -1353051.5353025931, "episode_len_mean": 43920.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1369366.2314788997, -1361335.2082701626, -1354747.2510403998, -1351385.668151872, -1353878.0036070035, -1353934.4440263135, -1349299.1822382265, -1352848.977192731, -1354881.8648155385, -1350293.381402571, -1351982.609620888, -1355148.9106643137, -1353355.7607168008, -1351316.0660699722, -1348824.8954038802, -1353463.9545051646, -1350201.1795549188, -1352786.6794055027, -1352053.2572481462, -1352558.3135243794, -1358466.517990561, -1351346.3540966634, -1351505.6693919636, -1353330.2319483531, -1351757.3621417605, -1351111.1344867356, -1352960.1558008753, -1353830.0290992912, -1352774.403007062, -1353239.1979867364, -1351903.1794592983, -1353195.1205072168, -1350544.7864785872, -1351714.7076935158, -1353808.3265127144, -1354467.1794068213, -1354455.2950085176, -1352877.5992428334, -1354615.6626388268, -1351517.925035784, -1350395.7720792037, -1355468.214768313, -1350950.9235178346, -1349461.9810155102, -1353244.1483122527, -1351773.7359352622, -1354580.862936983, -1353454.3955520217, -1351924.6931606017, -1349349.7745003805, -1349310.0333108394, -1355562.6956711074, -1351184.5654083667, -1356438.3696041456, -1351573.5012043987, -1353129.6330961955], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.14136940533393383, "mean_inference_ms": 0.2488994805158356, "mean_action_processing_ms": 0.05955832261793629, "mean_env_wait_ms": 0.47050006590576005, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002362898417881557, "StateBufferConnector_ms": 0.0017229999814714705, "ViewRequirementAgentConnector_ms": 0.045114755630493164}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 3707520, "num_agent_steps_trained": 3707520, "num_env_steps_sampled": 3707520, "num_env_steps_trained": 3707520, "num_env_steps_sampled_this_iter": 43920, "num_env_steps_trained_this_iter": 43920, "num_env_steps_sampled_throughput_per_sec": 1116.8917236406926, "num_env_steps_trained_throughput_per_sec": 1116.8917236406926, "timesteps_total": 3707520, "num_steps_trained_this_iter": 43920, "agent_timesteps_total": 3707520, "timers": {"training_iteration_time_ms": 39316.236, "sample_time_ms": 38569.444, "load_time_ms": 12.573, "load_throughput": 3493192.042, "learn_time_ms": 733.434, "learn_throughput": 59882.698, "synch_weights_time_ms": 0.671}, "counters": {"num_env_steps_sampled": 3707520, "num_env_steps_trained": 3707520, "num_agent_steps_sampled": 3707520, "num_agent_steps_trained": 3707520}, "done": false, "episodes_total": 1275, "training_iteration": 396, "trial_id": "d8b7e_00000", "date": "2023-07-27_05-48-32", "timestamp": 1690426112, "time_this_iter_s": 39.32552790641785, "time_total_s": 6907.6910762786865, "pid": 18921, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 366, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[1291920, 5e-05], [1731120, 8e-05], [2170320, 2.5e-05], [2609520, 2.5e-05], [3048720, 2.5e-05], [3487920, 2.5e-05], [3927120, 1e-05], [4366320, 1e-05], [4805520, 1e-05], [5244720, 5e-06], [5683920, 5e-06], [6123120, 5e-06], [6562320, 5e-06], [7001520, 1e-06], [7440720, 1e-06], [7879920, 1e-06], [8319120, 1e-06], [8758320, 5e-07], [9197520, 5e-07], [9636720, 2.5e-07], [10075920, 2.5e-07], [10515120, 1e-08], [10954320, 1e-08], [11393520, 5e-09], [11832720, 5e-09], [12271920, 1e-09]], "grad_clip": 0.5, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.1, "final_epsilon": 0.01, "epsilon_timesteps": 1387080}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 43920, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x16b7b79d0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 2240.146318435669, "iterations_since_restore": 56, "perf": {"cpu_util_percent": 17.785714285714285, "ram_util_percent": 68.93571428571428}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1.75e-05, "entropy_coeff": 0.049999999999999996, "policy_entropy": -1423.253225788083, "policy_loss": -1.4708623513525367e+19, "vf_loss": 304511217.7084548}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 38759.5, "diff_num_grad_updates_vs_sampler_policy": 38758.5}}, "num_env_steps_sampled": 3751440, "num_env_steps_trained": 3751440, "num_agent_steps_sampled": 3751440, "num_agent_steps_trained": 3751440}, "sampler_results": {"episode_reward_max": -1348824.8954038802, "episode_reward_min": -1369366.2314788997, "episode_reward_mean": -1353089.4999117597, "episode_len_mean": 43920.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1369366.2314788997, -1361335.2082701626, -1354747.2510403998, -1351385.668151872, -1353878.0036070035, -1353934.4440263135, -1349299.1822382265, -1352848.977192731, -1354881.8648155385, -1350293.381402571, -1351982.609620888, -1355148.9106643137, -1353355.7607168008, -1351316.0660699722, -1348824.8954038802, -1353463.9545051646, -1350201.1795549188, -1352786.6794055027, -1352053.2572481462, -1352558.3135243794, -1358466.517990561, -1351346.3540966634, -1351505.6693919636, -1353330.2319483531, -1351757.3621417605, -1351111.1344867356, -1352960.1558008753, -1353830.0290992912, -1352774.403007062, -1353239.1979867364, -1351903.1794592983, -1353195.1205072168, -1350544.7864785872, -1351714.7076935158, -1353808.3265127144, -1354467.1794068213, -1354455.2950085176, -1352877.5992428334, -1354615.6626388268, -1351517.925035784, -1350395.7720792037, -1355468.214768313, -1350950.9235178346, -1349461.9810155102, -1353244.1483122527, -1351773.7359352622, -1354580.862936983, -1353454.3955520217, -1351924.6931606017, -1349349.7745003805, -1349310.0333108394, -1355562.6956711074, -1351184.5654083667, -1356438.3696041456, -1351573.5012043987, -1353129.6330961955, -1355215.5180250898], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.14128017702951223, "mean_inference_ms": 0.24869412523590234, "mean_action_processing_ms": 0.05952381550582438, "mean_env_wait_ms": 0.4701356577573784, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0023544880381801674, "StateBufferConnector_ms": 0.001720378273411801, "ViewRequirementAgentConnector_ms": 0.045077006022135414}}, "episode_reward_max": -1348824.8954038802, "episode_reward_min": -1369366.2314788997, "episode_reward_mean": -1353089.4999117597, "episode_len_mean": 43920.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1369366.2314788997, -1361335.2082701626, -1354747.2510403998, -1351385.668151872, -1353878.0036070035, -1353934.4440263135, -1349299.1822382265, -1352848.977192731, -1354881.8648155385, -1350293.381402571, -1351982.609620888, -1355148.9106643137, -1353355.7607168008, -1351316.0660699722, -1348824.8954038802, -1353463.9545051646, -1350201.1795549188, -1352786.6794055027, -1352053.2572481462, -1352558.3135243794, -1358466.517990561, -1351346.3540966634, -1351505.6693919636, -1353330.2319483531, -1351757.3621417605, -1351111.1344867356, -1352960.1558008753, -1353830.0290992912, -1352774.403007062, -1353239.1979867364, -1351903.1794592983, -1353195.1205072168, -1350544.7864785872, -1351714.7076935158, -1353808.3265127144, -1354467.1794068213, -1354455.2950085176, -1352877.5992428334, -1354615.6626388268, -1351517.925035784, -1350395.7720792037, -1355468.214768313, -1350950.9235178346, -1349461.9810155102, -1353244.1483122527, -1351773.7359352622, -1354580.862936983, -1353454.3955520217, -1351924.6931606017, -1349349.7745003805, -1349310.0333108394, -1355562.6956711074, -1351184.5654083667, -1356438.3696041456, -1351573.5012043987, -1353129.6330961955, -1355215.5180250898], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.14128017702951223, "mean_inference_ms": 0.24869412523590234, "mean_action_processing_ms": 0.05952381550582438, "mean_env_wait_ms": 0.4701356577573784, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0023544880381801674, "StateBufferConnector_ms": 0.001720378273411801, "ViewRequirementAgentConnector_ms": 0.045077006022135414}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 3751440, "num_agent_steps_trained": 3751440, "num_env_steps_sampled": 3751440, "num_env_steps_trained": 3751440, "num_env_steps_sampled_this_iter": 43920, "num_env_steps_trained_this_iter": 43920, "num_env_steps_sampled_throughput_per_sec": 1110.8600607934936, "num_env_steps_trained_throughput_per_sec": 1110.8600607934936, "timesteps_total": 3751440, "num_steps_trained_this_iter": 43920, "agent_timesteps_total": 3751440, "timers": {"training_iteration_time_ms": 39345.19, "sample_time_ms": 38598.188, "load_time_ms": 12.509, "load_throughput": 3511175.673, "learn_time_ms": 733.705, "learn_throughput": 59860.555, "synch_weights_time_ms": 0.674}, "counters": {"num_env_steps_sampled": 3751440, "num_env_steps_trained": 3751440, "num_agent_steps_sampled": 3751440, "num_agent_steps_trained": 3751440}, "done": false, "episodes_total": 1276, "training_iteration": 397, "trial_id": "d8b7e_00000", "date": "2023-07-27_05-49-12", "timestamp": 1690426152, "time_this_iter_s": 39.53898000717163, "time_total_s": 6947.230056285858, "pid": 18921, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 366, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[1291920, 5e-05], [1731120, 8e-05], [2170320, 2.5e-05], [2609520, 2.5e-05], [3048720, 2.5e-05], [3487920, 2.5e-05], [3927120, 1e-05], [4366320, 1e-05], [4805520, 1e-05], [5244720, 5e-06], [5683920, 5e-06], [6123120, 5e-06], [6562320, 5e-06], [7001520, 1e-06], [7440720, 1e-06], [7879920, 1e-06], [8319120, 1e-06], [8758320, 5e-07], [9197520, 5e-07], [9636720, 2.5e-07], [10075920, 2.5e-07], [10515120, 1e-08], [10954320, 1e-08], [11393520, 5e-09], [11832720, 5e-09], [12271920, 1e-09]], "grad_clip": 0.5, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.1, "final_epsilon": 0.01, "epsilon_timesteps": 1387080}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 43920, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x16b7b79d0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 2279.6852984428406, "iterations_since_restore": 57, "perf": {"cpu_util_percent": 17.42142857142857, "ram_util_percent": 68.93928571428572}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1.6000000000000006e-05, "entropy_coeff": 0.049999999999999996, "policy_entropy": -1469.583243589707, "policy_loss": -2.7475984216009613e+19, "vf_loss": 305012999.8425656}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 39445.5, "diff_num_grad_updates_vs_sampler_policy": 39444.5}}, "num_env_steps_sampled": 3795360, "num_env_steps_trained": 3795360, "num_agent_steps_sampled": 3795360, "num_agent_steps_trained": 3795360}, "sampler_results": {"episode_reward_max": -1348824.8954038802, "episode_reward_min": -1369366.2314788997, "episode_reward_mean": -1353148.6876844608, "episode_len_mean": 43920.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1369366.2314788997, -1361335.2082701626, -1354747.2510403998, -1351385.668151872, -1353878.0036070035, -1353934.4440263135, -1349299.1822382265, -1352848.977192731, -1354881.8648155385, -1350293.381402571, -1351982.609620888, -1355148.9106643137, -1353355.7607168008, -1351316.0660699722, -1348824.8954038802, -1353463.9545051646, -1350201.1795549188, -1352786.6794055027, -1352053.2572481462, -1352558.3135243794, -1358466.517990561, -1351346.3540966634, -1351505.6693919636, -1353330.2319483531, -1351757.3621417605, -1351111.1344867356, -1352960.1558008753, -1353830.0290992912, -1352774.403007062, -1353239.1979867364, -1351903.1794592983, -1353195.1205072168, -1350544.7864785872, -1351714.7076935158, -1353808.3265127144, -1354467.1794068213, -1354455.2950085176, -1352877.5992428334, -1354615.6626388268, -1351517.925035784, -1350395.7720792037, -1355468.214768313, -1350950.9235178346, -1349461.9810155102, -1353244.1483122527, -1351773.7359352622, -1354580.862936983, -1353454.3955520217, -1351924.6931606017, -1349349.7745003805, -1349310.0333108394, -1355562.6956711074, -1351184.5654083667, -1356438.3696041456, -1351573.5012043987, -1353129.6330961955, -1355215.5180250898, -1356522.3907284164], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1411932881545961, "mean_inference_ms": 0.24849415983095471, "mean_action_processing_ms": 0.05949023389553427, "mean_env_wait_ms": 0.46978108751499825, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0023492451371817753, "StateBufferConnector_ms": 0.00171661376953125, "ViewRequirementAgentConnector_ms": 0.04508166477597993}}, "episode_reward_max": -1348824.8954038802, "episode_reward_min": -1369366.2314788997, "episode_reward_mean": -1353148.6876844608, "episode_len_mean": 43920.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1369366.2314788997, -1361335.2082701626, -1354747.2510403998, -1351385.668151872, -1353878.0036070035, -1353934.4440263135, -1349299.1822382265, -1352848.977192731, -1354881.8648155385, -1350293.381402571, -1351982.609620888, -1355148.9106643137, -1353355.7607168008, -1351316.0660699722, -1348824.8954038802, -1353463.9545051646, -1350201.1795549188, -1352786.6794055027, -1352053.2572481462, -1352558.3135243794, -1358466.517990561, -1351346.3540966634, -1351505.6693919636, -1353330.2319483531, -1351757.3621417605, -1351111.1344867356, -1352960.1558008753, -1353830.0290992912, -1352774.403007062, -1353239.1979867364, -1351903.1794592983, -1353195.1205072168, -1350544.7864785872, -1351714.7076935158, -1353808.3265127144, -1354467.1794068213, -1354455.2950085176, -1352877.5992428334, -1354615.6626388268, -1351517.925035784, -1350395.7720792037, -1355468.214768313, -1350950.9235178346, -1349461.9810155102, -1353244.1483122527, -1351773.7359352622, -1354580.862936983, -1353454.3955520217, -1351924.6931606017, -1349349.7745003805, -1349310.0333108394, -1355562.6956711074, -1351184.5654083667, -1356438.3696041456, -1351573.5012043987, -1353129.6330961955, -1355215.5180250898, -1356522.3907284164], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1411932881545961, "mean_inference_ms": 0.24849415983095471, "mean_action_processing_ms": 0.05949023389553427, "mean_env_wait_ms": 0.46978108751499825, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0023492451371817753, "StateBufferConnector_ms": 0.00171661376953125, "ViewRequirementAgentConnector_ms": 0.04508166477597993}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 3795360, "num_agent_steps_trained": 3795360, "num_env_steps_sampled": 3795360, "num_env_steps_trained": 3795360, "num_env_steps_sampled_this_iter": 43920, "num_env_steps_trained_this_iter": 43920, "num_env_steps_sampled_throughput_per_sec": 1121.171326454423, "num_env_steps_trained_throughput_per_sec": 1121.171326454423, "timesteps_total": 3795360, "num_steps_trained_this_iter": 43920, "agent_timesteps_total": 3795360, "timers": {"training_iteration_time_ms": 39344.146, "sample_time_ms": 38598.077, "load_time_ms": 12.529, "load_throughput": 3505456.297, "learn_time_ms": 732.726, "learn_throughput": 59940.529, "synch_weights_time_ms": 0.693}, "counters": {"num_env_steps_sampled": 3795360, "num_env_steps_trained": 3795360, "num_agent_steps_sampled": 3795360, "num_agent_steps_trained": 3795360}, "done": false, "episodes_total": 1277, "training_iteration": 398, "trial_id": "d8b7e_00000", "date": "2023-07-27_05-49-51", "timestamp": 1690426191, "time_this_iter_s": 39.175954818725586, "time_total_s": 6986.406011104584, "pid": 18921, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 366, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[1291920, 5e-05], [1731120, 8e-05], [2170320, 2.5e-05], [2609520, 2.5e-05], [3048720, 2.5e-05], [3487920, 2.5e-05], [3927120, 1e-05], [4366320, 1e-05], [4805520, 1e-05], [5244720, 5e-06], [5683920, 5e-06], [6123120, 5e-06], [6562320, 5e-06], [7001520, 1e-06], [7440720, 1e-06], [7879920, 1e-06], [8319120, 1e-06], [8758320, 5e-07], [9197520, 5e-07], [9636720, 2.5e-07], [10075920, 2.5e-07], [10515120, 1e-08], [10954320, 1e-08], [11393520, 5e-09], [11832720, 5e-09], [12271920, 1e-09]], "grad_clip": 0.5, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.1, "final_epsilon": 0.01, "epsilon_timesteps": 1387080}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 43920, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x16b7b79d0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 2318.861253261566, "iterations_since_restore": 58, "perf": {"cpu_util_percent": 20.39272727272727, "ram_util_percent": 68.90727272727273}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1.4500000000000003e-05, "entropy_coeff": 0.049999999999999996, "policy_entropy": -1410.4870272711485, "policy_loss": -1.4497232826335916e+19, "vf_loss": 302918771.3294461}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 40131.5, "diff_num_grad_updates_vs_sampler_policy": 40130.5}}, "num_env_steps_sampled": 3839280, "num_env_steps_trained": 3839280, "num_agent_steps_sampled": 3839280, "num_agent_steps_trained": 3839280}, "sampler_results": {"episode_reward_max": -1348824.8954038802, "episode_reward_min": -1369366.2314788997, "episode_reward_mean": -1353127.3694997923, "episode_len_mean": 43920.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1369366.2314788997, -1361335.2082701626, -1354747.2510403998, -1351385.668151872, -1353878.0036070035, -1353934.4440263135, -1349299.1822382265, -1352848.977192731, -1354881.8648155385, -1350293.381402571, -1351982.609620888, -1355148.9106643137, -1353355.7607168008, -1351316.0660699722, -1348824.8954038802, -1353463.9545051646, -1350201.1795549188, -1352786.6794055027, -1352053.2572481462, -1352558.3135243794, -1358466.517990561, -1351346.3540966634, -1351505.6693919636, -1353330.2319483531, -1351757.3621417605, -1351111.1344867356, -1352960.1558008753, -1353830.0290992912, -1352774.403007062, -1353239.1979867364, -1351903.1794592983, -1353195.1205072168, -1350544.7864785872, -1351714.7076935158, -1353808.3265127144, -1354467.1794068213, -1354455.2950085176, -1352877.5992428334, -1354615.6626388268, -1351517.925035784, -1350395.7720792037, -1355468.214768313, -1350950.9235178346, -1349461.9810155102, -1353244.1483122527, -1351773.7359352622, -1354580.862936983, -1353454.3955520217, -1351924.6931606017, -1349349.7745003805, -1349310.0333108394, -1355562.6956711074, -1351184.5654083667, -1356438.3696041456, -1351573.5012043987, -1353129.6330961955, -1355215.5180250898, -1356522.3907284164, -1351890.9147890166], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.14110900496540515, "mean_inference_ms": 0.24829973882052606, "mean_action_processing_ms": 0.05945759985822282, "mean_env_wait_ms": 0.4694354867266619, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002345796358787407, "StateBufferConnector_ms": 0.001718634265964314, "ViewRequirementAgentConnector_ms": 0.04504939257088354}}, "episode_reward_max": -1348824.8954038802, "episode_reward_min": -1369366.2314788997, "episode_reward_mean": -1353127.3694997923, "episode_len_mean": 43920.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1369366.2314788997, -1361335.2082701626, -1354747.2510403998, -1351385.668151872, -1353878.0036070035, -1353934.4440263135, -1349299.1822382265, -1352848.977192731, -1354881.8648155385, -1350293.381402571, -1351982.609620888, -1355148.9106643137, -1353355.7607168008, -1351316.0660699722, -1348824.8954038802, -1353463.9545051646, -1350201.1795549188, -1352786.6794055027, -1352053.2572481462, -1352558.3135243794, -1358466.517990561, -1351346.3540966634, -1351505.6693919636, -1353330.2319483531, -1351757.3621417605, -1351111.1344867356, -1352960.1558008753, -1353830.0290992912, -1352774.403007062, -1353239.1979867364, -1351903.1794592983, -1353195.1205072168, -1350544.7864785872, -1351714.7076935158, -1353808.3265127144, -1354467.1794068213, -1354455.2950085176, -1352877.5992428334, -1354615.6626388268, -1351517.925035784, -1350395.7720792037, -1355468.214768313, -1350950.9235178346, -1349461.9810155102, -1353244.1483122527, -1351773.7359352622, -1354580.862936983, -1353454.3955520217, -1351924.6931606017, -1349349.7745003805, -1349310.0333108394, -1355562.6956711074, -1351184.5654083667, -1356438.3696041456, -1351573.5012043987, -1353129.6330961955, -1355215.5180250898, -1356522.3907284164, -1351890.9147890166], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.14110900496540515, "mean_inference_ms": 0.24829973882052606, "mean_action_processing_ms": 0.05945759985822282, "mean_env_wait_ms": 0.4694354867266619, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002345796358787407, "StateBufferConnector_ms": 0.001718634265964314, "ViewRequirementAgentConnector_ms": 0.04504939257088354}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 3839280, "num_agent_steps_trained": 3839280, "num_env_steps_sampled": 3839280, "num_env_steps_trained": 3839280, "num_env_steps_sampled_this_iter": 43920, "num_env_steps_trained_this_iter": 43920, "num_env_steps_sampled_throughput_per_sec": 1119.2298021833915, "num_env_steps_trained_throughput_per_sec": 1119.2298021833915, "timesteps_total": 3839280, "num_steps_trained_this_iter": 43920, "agent_timesteps_total": 3839280, "timers": {"training_iteration_time_ms": 39313.404, "sample_time_ms": 38566.837, "load_time_ms": 12.524, "load_throughput": 3506864.365, "learn_time_ms": 733.23, "learn_throughput": 59899.356, "synch_weights_time_ms": 0.691}, "counters": {"num_env_steps_sampled": 3839280, "num_env_steps_trained": 3839280, "num_agent_steps_sampled": 3839280, "num_agent_steps_trained": 3839280}, "done": false, "episodes_total": 1278, "training_iteration": 399, "trial_id": "d8b7e_00000", "date": "2023-07-27_05-50-30", "timestamp": 1690426230, "time_this_iter_s": 39.24339509010315, "time_total_s": 7025.649406194687, "pid": 18921, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 366, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[1291920, 5e-05], [1731120, 8e-05], [2170320, 2.5e-05], [2609520, 2.5e-05], [3048720, 2.5e-05], [3487920, 2.5e-05], [3927120, 1e-05], [4366320, 1e-05], [4805520, 1e-05], [5244720, 5e-06], [5683920, 5e-06], [6123120, 5e-06], [6562320, 5e-06], [7001520, 1e-06], [7440720, 1e-06], [7879920, 1e-06], [8319120, 1e-06], [8758320, 5e-07], [9197520, 5e-07], [9636720, 2.5e-07], [10075920, 2.5e-07], [10515120, 1e-08], [10954320, 1e-08], [11393520, 5e-09], [11832720, 5e-09], [12271920, 1e-09]], "grad_clip": 0.5, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.1, "final_epsilon": 0.01, "epsilon_timesteps": 1387080}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 43920, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x16b7b79d0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 2358.1046483516693, "iterations_since_restore": 59, "perf": {"cpu_util_percent": 18.55535714285714, "ram_util_percent": 69.01607142857144}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1.3000000000000001e-05, "entropy_coeff": 0.049999999999999996, "policy_entropy": -1376.6872768568924, "policy_loss": -7.67299708244472e+18, "vf_loss": 303627178.4781341}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 40817.5, "diff_num_grad_updates_vs_sampler_policy": 40816.5}}, "num_env_steps_sampled": 3883200, "num_env_steps_trained": 3883200, "num_agent_steps_sampled": 3883200, "num_agent_steps_trained": 3883200}, "sampler_results": {"episode_reward_max": -1348824.8954038802, "episode_reward_min": -1369366.2314788997, "episode_reward_mean": -1353130.5863644148, "episode_len_mean": 43920.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1369366.2314788997, -1361335.2082701626, -1354747.2510403998, -1351385.668151872, -1353878.0036070035, -1353934.4440263135, -1349299.1822382265, -1352848.977192731, -1354881.8648155385, -1350293.381402571, -1351982.609620888, -1355148.9106643137, -1353355.7607168008, -1351316.0660699722, -1348824.8954038802, -1353463.9545051646, -1350201.1795549188, -1352786.6794055027, -1352053.2572481462, -1352558.3135243794, -1358466.517990561, -1351346.3540966634, -1351505.6693919636, -1353330.2319483531, -1351757.3621417605, -1351111.1344867356, -1352960.1558008753, -1353830.0290992912, -1352774.403007062, -1353239.1979867364, -1351903.1794592983, -1353195.1205072168, -1350544.7864785872, -1351714.7076935158, -1353808.3265127144, -1354467.1794068213, -1354455.2950085176, -1352877.5992428334, -1354615.6626388268, -1351517.925035784, -1350395.7720792037, -1355468.214768313, -1350950.9235178346, -1349461.9810155102, -1353244.1483122527, -1351773.7359352622, -1354580.862936983, -1353454.3955520217, -1351924.6931606017, -1349349.7745003805, -1349310.0333108394, -1355562.6956711074, -1351184.5654083667, -1356438.3696041456, -1351573.5012043987, -1353129.6330961955, -1355215.5180250898, -1356522.3907284164, -1351890.9147890166, -1353320.3813771496], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1410274327388577, "mean_inference_ms": 0.24811058973146047, "mean_action_processing_ms": 0.05942589800579125, "mean_env_wait_ms": 0.4691000035959254, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0023412704467773438, "StateBufferConnector_ms": 0.0017178058624267578, "ViewRequirementAgentConnector_ms": 0.0450583299001058}}, "episode_reward_max": -1348824.8954038802, "episode_reward_min": -1369366.2314788997, "episode_reward_mean": -1353130.5863644148, "episode_len_mean": 43920.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1369366.2314788997, -1361335.2082701626, -1354747.2510403998, -1351385.668151872, -1353878.0036070035, -1353934.4440263135, -1349299.1822382265, -1352848.977192731, -1354881.8648155385, -1350293.381402571, -1351982.609620888, -1355148.9106643137, -1353355.7607168008, -1351316.0660699722, -1348824.8954038802, -1353463.9545051646, -1350201.1795549188, -1352786.6794055027, -1352053.2572481462, -1352558.3135243794, -1358466.517990561, -1351346.3540966634, -1351505.6693919636, -1353330.2319483531, -1351757.3621417605, -1351111.1344867356, -1352960.1558008753, -1353830.0290992912, -1352774.403007062, -1353239.1979867364, -1351903.1794592983, -1353195.1205072168, -1350544.7864785872, -1351714.7076935158, -1353808.3265127144, -1354467.1794068213, -1354455.2950085176, -1352877.5992428334, -1354615.6626388268, -1351517.925035784, -1350395.7720792037, -1355468.214768313, -1350950.9235178346, -1349461.9810155102, -1353244.1483122527, -1351773.7359352622, -1354580.862936983, -1353454.3955520217, -1351924.6931606017, -1349349.7745003805, -1349310.0333108394, -1355562.6956711074, -1351184.5654083667, -1356438.3696041456, -1351573.5012043987, -1353129.6330961955, -1355215.5180250898, -1356522.3907284164, -1351890.9147890166, -1353320.3813771496], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1410274327388577, "mean_inference_ms": 0.24811058973146047, "mean_action_processing_ms": 0.05942589800579125, "mean_env_wait_ms": 0.4691000035959254, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0023412704467773438, "StateBufferConnector_ms": 0.0017178058624267578, "ViewRequirementAgentConnector_ms": 0.0450583299001058}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 3883200, "num_agent_steps_trained": 3883200, "num_env_steps_sampled": 3883200, "num_env_steps_trained": 3883200, "num_env_steps_sampled_this_iter": 43920, "num_env_steps_trained_this_iter": 43920, "num_env_steps_sampled_throughput_per_sec": 1111.7212815267226, "num_env_steps_trained_throughput_per_sec": 1111.7212815267226, "timesteps_total": 3883200, "num_steps_trained_this_iter": 43920, "agent_timesteps_total": 3883200, "timers": {"training_iteration_time_ms": 39357.55, "sample_time_ms": 38610.698, "load_time_ms": 12.519, "load_throughput": 3508146.624, "learn_time_ms": 733.513, "learn_throughput": 59876.199, "synch_weights_time_ms": 0.695}, "counters": {"num_env_steps_sampled": 3883200, "num_env_steps_trained": 3883200, "num_agent_steps_sampled": 3883200, "num_agent_steps_trained": 3883200}, "done": false, "episodes_total": 1279, "training_iteration": 400, "trial_id": "d8b7e_00000", "date": "2023-07-27_05-51-10", "timestamp": 1690426270, "time_this_iter_s": 39.508355140686035, "time_total_s": 7065.157761335373, "pid": 18921, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 366, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[1291920, 5e-05], [1731120, 8e-05], [2170320, 2.5e-05], [2609520, 2.5e-05], [3048720, 2.5e-05], [3487920, 2.5e-05], [3927120, 1e-05], [4366320, 1e-05], [4805520, 1e-05], [5244720, 5e-06], [5683920, 5e-06], [6123120, 5e-06], [6562320, 5e-06], [7001520, 1e-06], [7440720, 1e-06], [7879920, 1e-06], [8319120, 1e-06], [8758320, 5e-07], [9197520, 5e-07], [9636720, 2.5e-07], [10075920, 2.5e-07], [10515120, 1e-08], [10954320, 1e-08], [11393520, 5e-09], [11832720, 5e-09], [12271920, 1e-09]], "grad_clip": 0.5, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.1, "final_epsilon": 0.01, "epsilon_timesteps": 1387080}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 43920, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x16b7b79d0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 2397.6130034923553, "iterations_since_restore": 60, "perf": {"cpu_util_percent": 17.660714285714285, "ram_util_percent": 69.14821428571429}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1.1499999999999998e-05, "entropy_coeff": 0.049999999999999996, "policy_entropy": -1348.8039383512892, "policy_loss": -6.931286843667866e+18, "vf_loss": 302633291.65014577}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 41503.5, "diff_num_grad_updates_vs_sampler_policy": 41502.5}}, "num_env_steps_sampled": 3927120, "num_env_steps_trained": 3927120, "num_agent_steps_sampled": 3927120, "num_agent_steps_trained": 3927120}, "sampler_results": {"episode_reward_max": -1348824.8954038802, "episode_reward_min": -1369366.2314788997, "episode_reward_mean": -1353101.690274185, "episode_len_mean": 43920.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1369366.2314788997, -1361335.2082701626, -1354747.2510403998, -1351385.668151872, -1353878.0036070035, -1353934.4440263135, -1349299.1822382265, -1352848.977192731, -1354881.8648155385, -1350293.381402571, -1351982.609620888, -1355148.9106643137, -1353355.7607168008, -1351316.0660699722, -1348824.8954038802, -1353463.9545051646, -1350201.1795549188, -1352786.6794055027, -1352053.2572481462, -1352558.3135243794, -1358466.517990561, -1351346.3540966634, -1351505.6693919636, -1353330.2319483531, -1351757.3621417605, -1351111.1344867356, -1352960.1558008753, -1353830.0290992912, -1352774.403007062, -1353239.1979867364, -1351903.1794592983, -1353195.1205072168, -1350544.7864785872, -1351714.7076935158, -1353808.3265127144, -1354467.1794068213, -1354455.2950085176, -1352877.5992428334, -1354615.6626388268, -1351517.925035784, -1350395.7720792037, -1355468.214768313, -1350950.9235178346, -1349461.9810155102, -1353244.1483122527, -1351773.7359352622, -1354580.862936983, -1353454.3955520217, -1351924.6931606017, -1349349.7745003805, -1349310.0333108394, -1355562.6956711074, -1351184.5654083667, -1356438.3696041456, -1351573.5012043987, -1353129.6330961955, -1355215.5180250898, -1356522.3907284164, -1351890.9147890166, -1353320.3813771496, -1351367.9248604018], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.14094797864561606, "mean_inference_ms": 0.24792651559871673, "mean_action_processing_ms": 0.05939502567138232, "mean_env_wait_ms": 0.4687725704606593, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0023361112250656377, "StateBufferConnector_ms": 0.0017201314206983223, "ViewRequirementAgentConnector_ms": 0.04505173104708312}}, "episode_reward_max": -1348824.8954038802, "episode_reward_min": -1369366.2314788997, "episode_reward_mean": -1353101.690274185, "episode_len_mean": 43920.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1369366.2314788997, -1361335.2082701626, -1354747.2510403998, -1351385.668151872, -1353878.0036070035, -1353934.4440263135, -1349299.1822382265, -1352848.977192731, -1354881.8648155385, -1350293.381402571, -1351982.609620888, -1355148.9106643137, -1353355.7607168008, -1351316.0660699722, -1348824.8954038802, -1353463.9545051646, -1350201.1795549188, -1352786.6794055027, -1352053.2572481462, -1352558.3135243794, -1358466.517990561, -1351346.3540966634, -1351505.6693919636, -1353330.2319483531, -1351757.3621417605, -1351111.1344867356, -1352960.1558008753, -1353830.0290992912, -1352774.403007062, -1353239.1979867364, -1351903.1794592983, -1353195.1205072168, -1350544.7864785872, -1351714.7076935158, -1353808.3265127144, -1354467.1794068213, -1354455.2950085176, -1352877.5992428334, -1354615.6626388268, -1351517.925035784, -1350395.7720792037, -1355468.214768313, -1350950.9235178346, -1349461.9810155102, -1353244.1483122527, -1351773.7359352622, -1354580.862936983, -1353454.3955520217, -1351924.6931606017, -1349349.7745003805, -1349310.0333108394, -1355562.6956711074, -1351184.5654083667, -1356438.3696041456, -1351573.5012043987, -1353129.6330961955, -1355215.5180250898, -1356522.3907284164, -1351890.9147890166, -1353320.3813771496, -1351367.9248604018], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.14094797864561606, "mean_inference_ms": 0.24792651559871673, "mean_action_processing_ms": 0.05939502567138232, "mean_env_wait_ms": 0.4687725704606593, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0023361112250656377, "StateBufferConnector_ms": 0.0017201314206983223, "ViewRequirementAgentConnector_ms": 0.04505173104708312}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 3927120, "num_agent_steps_trained": 3927120, "num_env_steps_sampled": 3927120, "num_env_steps_trained": 3927120, "num_env_steps_sampled_this_iter": 43920, "num_env_steps_trained_this_iter": 43920, "num_env_steps_sampled_throughput_per_sec": 1121.9721712958665, "num_env_steps_trained_throughput_per_sec": 1121.9721712958665, "timesteps_total": 3927120, "num_steps_trained_this_iter": 43920, "agent_timesteps_total": 3927120, "timers": {"training_iteration_time_ms": 39341.51, "sample_time_ms": 38595.658, "load_time_ms": 12.514, "load_throughput": 3509724.019, "learn_time_ms": 732.52, "learn_throughput": 59957.368, "synch_weights_time_ms": 0.695}, "counters": {"num_env_steps_sampled": 3927120, "num_env_steps_trained": 3927120, "num_agent_steps_sampled": 3927120, "num_agent_steps_trained": 3927120}, "done": false, "episodes_total": 1280, "training_iteration": 401, "trial_id": "d8b7e_00000", "date": "2023-07-27_05-51-49", "timestamp": 1690426309, "time_this_iter_s": 39.147441148757935, "time_total_s": 7104.305202484131, "pid": 18921, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 366, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[1291920, 5e-05], [1731120, 8e-05], [2170320, 2.5e-05], [2609520, 2.5e-05], [3048720, 2.5e-05], [3487920, 2.5e-05], [3927120, 1e-05], [4366320, 1e-05], [4805520, 1e-05], [5244720, 5e-06], [5683920, 5e-06], [6123120, 5e-06], [6562320, 5e-06], [7001520, 1e-06], [7440720, 1e-06], [7879920, 1e-06], [8319120, 1e-06], [8758320, 5e-07], [9197520, 5e-07], [9636720, 2.5e-07], [10075920, 2.5e-07], [10515120, 1e-08], [10954320, 1e-08], [11393520, 5e-09], [11832720, 5e-09], [12271920, 1e-09]], "grad_clip": 0.5, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.1, "final_epsilon": 0.01, "epsilon_timesteps": 1387080}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 43920, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x16b7b79d0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 2436.7604446411133, "iterations_since_restore": 61, "perf": {"cpu_util_percent": 17.57090909090909, "ram_util_percent": 69.15272727272728}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-05, "entropy_coeff": 0.049999999999999996, "policy_entropy": -1341.1454421507722, "policy_loss": -7.839365580532333e+18, "vf_loss": 304647612.4314869}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 42189.5, "diff_num_grad_updates_vs_sampler_policy": 42188.5}}, "num_env_steps_sampled": 3971040, "num_env_steps_trained": 3971040, "num_agent_steps_sampled": 3971040, "num_agent_steps_trained": 3971040}, "sampler_results": {"episode_reward_max": -1348824.8954038802, "episode_reward_min": -1369366.2314788997, "episode_reward_mean": -1353149.003323353, "episode_len_mean": 43920.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1369366.2314788997, -1361335.2082701626, -1354747.2510403998, -1351385.668151872, -1353878.0036070035, -1353934.4440263135, -1349299.1822382265, -1352848.977192731, -1354881.8648155385, -1350293.381402571, -1351982.609620888, -1355148.9106643137, -1353355.7607168008, -1351316.0660699722, -1348824.8954038802, -1353463.9545051646, -1350201.1795549188, -1352786.6794055027, -1352053.2572481462, -1352558.3135243794, -1358466.517990561, -1351346.3540966634, -1351505.6693919636, -1353330.2319483531, -1351757.3621417605, -1351111.1344867356, -1352960.1558008753, -1353830.0290992912, -1352774.403007062, -1353239.1979867364, -1351903.1794592983, -1353195.1205072168, -1350544.7864785872, -1351714.7076935158, -1353808.3265127144, -1354467.1794068213, -1354455.2950085176, -1352877.5992428334, -1354615.6626388268, -1351517.925035784, -1350395.7720792037, -1355468.214768313, -1350950.9235178346, -1349461.9810155102, -1353244.1483122527, -1351773.7359352622, -1354580.862936983, -1353454.3955520217, -1351924.6931606017, -1349349.7745003805, -1349310.0333108394, -1355562.6956711074, -1351184.5654083667, -1356438.3696041456, -1351573.5012043987, -1353129.6330961955, -1355215.5180250898, -1356522.3907284164, -1351890.9147890166, -1353320.3813771496, -1351367.9248604018, -1356035.0993225917], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.14087050428442988, "mean_inference_ms": 0.24774707872743063, "mean_action_processing_ms": 0.05936499222855903, "mean_env_wait_ms": 0.46845400693246164, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002372264862060547, "StateBufferConnector_ms": 0.0017223819609611265, "ViewRequirementAgentConnector_ms": 0.04509264423001197}}, "episode_reward_max": -1348824.8954038802, "episode_reward_min": -1369366.2314788997, "episode_reward_mean": -1353149.003323353, "episode_len_mean": 43920.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1369366.2314788997, -1361335.2082701626, -1354747.2510403998, -1351385.668151872, -1353878.0036070035, -1353934.4440263135, -1349299.1822382265, -1352848.977192731, -1354881.8648155385, -1350293.381402571, -1351982.609620888, -1355148.9106643137, -1353355.7607168008, -1351316.0660699722, -1348824.8954038802, -1353463.9545051646, -1350201.1795549188, -1352786.6794055027, -1352053.2572481462, -1352558.3135243794, -1358466.517990561, -1351346.3540966634, -1351505.6693919636, -1353330.2319483531, -1351757.3621417605, -1351111.1344867356, -1352960.1558008753, -1353830.0290992912, -1352774.403007062, -1353239.1979867364, -1351903.1794592983, -1353195.1205072168, -1350544.7864785872, -1351714.7076935158, -1353808.3265127144, -1354467.1794068213, -1354455.2950085176, -1352877.5992428334, -1354615.6626388268, -1351517.925035784, -1350395.7720792037, -1355468.214768313, -1350950.9235178346, -1349461.9810155102, -1353244.1483122527, -1351773.7359352622, -1354580.862936983, -1353454.3955520217, -1351924.6931606017, -1349349.7745003805, -1349310.0333108394, -1355562.6956711074, -1351184.5654083667, -1356438.3696041456, -1351573.5012043987, -1353129.6330961955, -1355215.5180250898, -1356522.3907284164, -1351890.9147890166, -1353320.3813771496, -1351367.9248604018, -1356035.0993225917], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.14087050428442988, "mean_inference_ms": 0.24774707872743063, "mean_action_processing_ms": 0.05936499222855903, "mean_env_wait_ms": 0.46845400693246164, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002372264862060547, "StateBufferConnector_ms": 0.0017223819609611265, "ViewRequirementAgentConnector_ms": 0.04509264423001197}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 3971040, "num_agent_steps_trained": 3971040, "num_env_steps_sampled": 3971040, "num_env_steps_trained": 3971040, "num_env_steps_sampled_this_iter": 43920, "num_env_steps_trained_this_iter": 43920, "num_env_steps_sampled_throughput_per_sec": 1117.100860405678, "num_env_steps_trained_throughput_per_sec": 1117.100860405678, "timesteps_total": 3971040, "num_steps_trained_this_iter": 43920, "agent_timesteps_total": 3971040, "timers": {"training_iteration_time_ms": 39346.538, "sample_time_ms": 38600.356, "load_time_ms": 12.474, "load_throughput": 3521041.165, "learn_time_ms": 732.885, "learn_throughput": 59927.558, "synch_weights_time_ms": 0.701}, "counters": {"num_env_steps_sampled": 3971040, "num_env_steps_trained": 3971040, "num_agent_steps_sampled": 3971040, "num_agent_steps_trained": 3971040}, "done": false, "episodes_total": 1281, "training_iteration": 402, "trial_id": "d8b7e_00000", "date": "2023-07-27_05-52-28", "timestamp": 1690426348, "time_this_iter_s": 39.31809687614441, "time_total_s": 7143.623299360275, "pid": 18921, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 366, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[1291920, 5e-05], [1731120, 8e-05], [2170320, 2.5e-05], [2609520, 2.5e-05], [3048720, 2.5e-05], [3487920, 2.5e-05], [3927120, 1e-05], [4366320, 1e-05], [4805520, 1e-05], [5244720, 5e-06], [5683920, 5e-06], [6123120, 5e-06], [6562320, 5e-06], [7001520, 1e-06], [7440720, 1e-06], [7879920, 1e-06], [8319120, 1e-06], [8758320, 5e-07], [9197520, 5e-07], [9636720, 2.5e-07], [10075920, 2.5e-07], [10515120, 1e-08], [10954320, 1e-08], [11393520, 5e-09], [11832720, 5e-09], [12271920, 1e-09]], "grad_clip": 0.5, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.1, "final_epsilon": 0.01, "epsilon_timesteps": 1387080}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 43920, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x16b7b79d0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 2476.0785415172577, "iterations_since_restore": 62, "perf": {"cpu_util_percent": 18.724999999999998, "ram_util_percent": 69.10535714285713}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-05, "entropy_coeff": 0.049999999999999996, "policy_entropy": -1326.2774572789494, "policy_loss": -6.28772920481374e+18, "vf_loss": 302620340.1924198}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 42875.5, "diff_num_grad_updates_vs_sampler_policy": 42874.5}}, "num_env_steps_sampled": 4014960, "num_env_steps_trained": 4014960, "num_agent_steps_sampled": 4014960, "num_agent_steps_trained": 4014960}, "sampler_results": {"episode_reward_max": -1348824.8954038802, "episode_reward_min": -1369366.2314788997, "episode_reward_mean": -1353116.987115274, "episode_len_mean": 43920.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1369366.2314788997, -1361335.2082701626, -1354747.2510403998, -1351385.668151872, -1353878.0036070035, -1353934.4440263135, -1349299.1822382265, -1352848.977192731, -1354881.8648155385, -1350293.381402571, -1351982.609620888, -1355148.9106643137, -1353355.7607168008, -1351316.0660699722, -1348824.8954038802, -1353463.9545051646, -1350201.1795549188, -1352786.6794055027, -1352053.2572481462, -1352558.3135243794, -1358466.517990561, -1351346.3540966634, -1351505.6693919636, -1353330.2319483531, -1351757.3621417605, -1351111.1344867356, -1352960.1558008753, -1353830.0290992912, -1352774.403007062, -1353239.1979867364, -1351903.1794592983, -1353195.1205072168, -1350544.7864785872, -1351714.7076935158, -1353808.3265127144, -1354467.1794068213, -1354455.2950085176, -1352877.5992428334, -1354615.6626388268, -1351517.925035784, -1350395.7720792037, -1355468.214768313, -1350950.9235178346, -1349461.9810155102, -1353244.1483122527, -1351773.7359352622, -1354580.862936983, -1353454.3955520217, -1351924.6931606017, -1349349.7745003805, -1349310.0333108394, -1355562.6956711074, -1351184.5654083667, -1356438.3696041456, -1351573.5012043987, -1353129.6330961955, -1355215.5180250898, -1356522.3907284164, -1351890.9147890166, -1353320.3813771496, -1351367.9248604018, -1356035.0993225917, -1351131.9822143805], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.14079491462067906, "mean_inference_ms": 0.24757221847493072, "mean_action_processing_ms": 0.05933572046396416, "mean_env_wait_ms": 0.4681425006685314, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002372075640966022, "StateBufferConnector_ms": 0.001724561055501302, "ViewRequirementAgentConnector_ms": 0.04509214370969742}}, "episode_reward_max": -1348824.8954038802, "episode_reward_min": -1369366.2314788997, "episode_reward_mean": -1353116.987115274, "episode_len_mean": 43920.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1369366.2314788997, -1361335.2082701626, -1354747.2510403998, -1351385.668151872, -1353878.0036070035, -1353934.4440263135, -1349299.1822382265, -1352848.977192731, -1354881.8648155385, -1350293.381402571, -1351982.609620888, -1355148.9106643137, -1353355.7607168008, -1351316.0660699722, -1348824.8954038802, -1353463.9545051646, -1350201.1795549188, -1352786.6794055027, -1352053.2572481462, -1352558.3135243794, -1358466.517990561, -1351346.3540966634, -1351505.6693919636, -1353330.2319483531, -1351757.3621417605, -1351111.1344867356, -1352960.1558008753, -1353830.0290992912, -1352774.403007062, -1353239.1979867364, -1351903.1794592983, -1353195.1205072168, -1350544.7864785872, -1351714.7076935158, -1353808.3265127144, -1354467.1794068213, -1354455.2950085176, -1352877.5992428334, -1354615.6626388268, -1351517.925035784, -1350395.7720792037, -1355468.214768313, -1350950.9235178346, -1349461.9810155102, -1353244.1483122527, -1351773.7359352622, -1354580.862936983, -1353454.3955520217, -1351924.6931606017, -1349349.7745003805, -1349310.0333108394, -1355562.6956711074, -1351184.5654083667, -1356438.3696041456, -1351573.5012043987, -1353129.6330961955, -1355215.5180250898, -1356522.3907284164, -1351890.9147890166, -1353320.3813771496, -1351367.9248604018, -1356035.0993225917, -1351131.9822143805], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.14079491462067906, "mean_inference_ms": 0.24757221847493072, "mean_action_processing_ms": 0.05933572046396416, "mean_env_wait_ms": 0.4681425006685314, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002372075640966022, "StateBufferConnector_ms": 0.001724561055501302, "ViewRequirementAgentConnector_ms": 0.04509214370969742}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 4014960, "num_agent_steps_trained": 4014960, "num_env_steps_sampled": 4014960, "num_env_steps_trained": 4014960, "num_env_steps_sampled_this_iter": 43920, "num_env_steps_trained_this_iter": 43920, "num_env_steps_sampled_throughput_per_sec": 1124.4800962922193, "num_env_steps_trained_throughput_per_sec": 1124.4800962922193, "timesteps_total": 4014960, "num_steps_trained_this_iter": 43920, "agent_timesteps_total": 4014960, "timers": {"training_iteration_time_ms": 39297.011, "sample_time_ms": 38551.694, "load_time_ms": 12.42, "load_throughput": 3536147.418, "learn_time_ms": 732.07, "learn_throughput": 59994.234, "synch_weights_time_ms": 0.704}, "counters": {"num_env_steps_sampled": 4014960, "num_env_steps_trained": 4014960, "num_agent_steps_sampled": 4014960, "num_agent_steps_trained": 4014960}, "done": false, "episodes_total": 1282, "training_iteration": 403, "trial_id": "d8b7e_00000", "date": "2023-07-27_05-53-07", "timestamp": 1690426387, "time_this_iter_s": 39.06028079986572, "time_total_s": 7182.683580160141, "pid": 18921, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 366, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[1291920, 5e-05], [1731120, 8e-05], [2170320, 2.5e-05], [2609520, 2.5e-05], [3048720, 2.5e-05], [3487920, 2.5e-05], [3927120, 1e-05], [4366320, 1e-05], [4805520, 1e-05], [5244720, 5e-06], [5683920, 5e-06], [6123120, 5e-06], [6562320, 5e-06], [7001520, 1e-06], [7440720, 1e-06], [7879920, 1e-06], [8319120, 1e-06], [8758320, 5e-07], [9197520, 5e-07], [9636720, 2.5e-07], [10075920, 2.5e-07], [10515120, 1e-08], [10954320, 1e-08], [11393520, 5e-09], [11832720, 5e-09], [12271920, 1e-09]], "grad_clip": 0.5, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.1, "final_epsilon": 0.01, "epsilon_timesteps": 1387080}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 43920, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x16b7b79d0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 2515.1388223171234, "iterations_since_restore": 63, "perf": {"cpu_util_percent": 19.28181818181818, "ram_util_percent": 68.98727272727272}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-05, "entropy_coeff": 0.049999999999999996, "policy_entropy": -1318.2331219108737, "policy_loss": -3.7485230149793357e+18, "vf_loss": 301461601.25947523}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 43561.5, "diff_num_grad_updates_vs_sampler_policy": 43560.5}}, "num_env_steps_sampled": 4058880, "num_env_steps_trained": 4058880, "num_agent_steps_sampled": 4058880, "num_agent_steps_trained": 4058880}, "sampler_results": {"episode_reward_max": -1348610.8719291363, "episode_reward_min": -1369366.2314788997, "episode_reward_mean": -1353046.5790654907, "episode_len_mean": 43920.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1369366.2314788997, -1361335.2082701626, -1354747.2510403998, -1351385.668151872, -1353878.0036070035, -1353934.4440263135, -1349299.1822382265, -1352848.977192731, -1354881.8648155385, -1350293.381402571, -1351982.609620888, -1355148.9106643137, -1353355.7607168008, -1351316.0660699722, -1348824.8954038802, -1353463.9545051646, -1350201.1795549188, -1352786.6794055027, -1352053.2572481462, -1352558.3135243794, -1358466.517990561, -1351346.3540966634, -1351505.6693919636, -1353330.2319483531, -1351757.3621417605, -1351111.1344867356, -1352960.1558008753, -1353830.0290992912, -1352774.403007062, -1353239.1979867364, -1351903.1794592983, -1353195.1205072168, -1350544.7864785872, -1351714.7076935158, -1353808.3265127144, -1354467.1794068213, -1354455.2950085176, -1352877.5992428334, -1354615.6626388268, -1351517.925035784, -1350395.7720792037, -1355468.214768313, -1350950.9235178346, -1349461.9810155102, -1353244.1483122527, -1351773.7359352622, -1354580.862936983, -1353454.3955520217, -1351924.6931606017, -1349349.7745003805, -1349310.0333108394, -1355562.6956711074, -1351184.5654083667, -1356438.3696041456, -1351573.5012043987, -1353129.6330961955, -1355215.5180250898, -1356522.3907284164, -1351890.9147890166, -1353320.3813771496, -1351367.9248604018, -1356035.0993225917, -1351131.9822143805, -1348610.8719291363], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.14072127835024545, "mean_inference_ms": 0.24740185139785492, "mean_action_processing_ms": 0.05930724027022051, "mean_env_wait_ms": 0.4678393002646491, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0023681670427322388, "StateBufferConnector_ms": 0.0017274171113967896, "ViewRequirementAgentConnector_ms": 0.04513189196586609}}, "episode_reward_max": -1348610.8719291363, "episode_reward_min": -1369366.2314788997, "episode_reward_mean": -1353046.5790654907, "episode_len_mean": 43920.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1369366.2314788997, -1361335.2082701626, -1354747.2510403998, -1351385.668151872, -1353878.0036070035, -1353934.4440263135, -1349299.1822382265, -1352848.977192731, -1354881.8648155385, -1350293.381402571, -1351982.609620888, -1355148.9106643137, -1353355.7607168008, -1351316.0660699722, -1348824.8954038802, -1353463.9545051646, -1350201.1795549188, -1352786.6794055027, -1352053.2572481462, -1352558.3135243794, -1358466.517990561, -1351346.3540966634, -1351505.6693919636, -1353330.2319483531, -1351757.3621417605, -1351111.1344867356, -1352960.1558008753, -1353830.0290992912, -1352774.403007062, -1353239.1979867364, -1351903.1794592983, -1353195.1205072168, -1350544.7864785872, -1351714.7076935158, -1353808.3265127144, -1354467.1794068213, -1354455.2950085176, -1352877.5992428334, -1354615.6626388268, -1351517.925035784, -1350395.7720792037, -1355468.214768313, -1350950.9235178346, -1349461.9810155102, -1353244.1483122527, -1351773.7359352622, -1354580.862936983, -1353454.3955520217, -1351924.6931606017, -1349349.7745003805, -1349310.0333108394, -1355562.6956711074, -1351184.5654083667, -1356438.3696041456, -1351573.5012043987, -1353129.6330961955, -1355215.5180250898, -1356522.3907284164, -1351890.9147890166, -1353320.3813771496, -1351367.9248604018, -1356035.0993225917, -1351131.9822143805, -1348610.8719291363], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.14072127835024545, "mean_inference_ms": 0.24740185139785492, "mean_action_processing_ms": 0.05930724027022051, "mean_env_wait_ms": 0.4678393002646491, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0023681670427322388, "StateBufferConnector_ms": 0.0017274171113967896, "ViewRequirementAgentConnector_ms": 0.04513189196586609}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 4058880, "num_agent_steps_trained": 4058880, "num_env_steps_sampled": 4058880, "num_env_steps_trained": 4058880, "num_env_steps_sampled_this_iter": 43920, "num_env_steps_trained_this_iter": 43920, "num_env_steps_sampled_throughput_per_sec": 1114.9813925878166, "num_env_steps_trained_throughput_per_sec": 1114.9813925878166, "timesteps_total": 4058880, "num_steps_trained_this_iter": 43920, "agent_timesteps_total": 4058880, "timers": {"training_iteration_time_ms": 39304.027, "sample_time_ms": 38563.564, "load_time_ms": 12.442, "load_throughput": 3529872.932, "learn_time_ms": 727.193, "learn_throughput": 60396.659, "synch_weights_time_ms": 0.704}, "counters": {"num_env_steps_sampled": 4058880, "num_env_steps_trained": 4058880, "num_agent_steps_sampled": 4058880, "num_agent_steps_trained": 4058880}, "done": false, "episodes_total": 1283, "training_iteration": 404, "trial_id": "d8b7e_00000", "date": "2023-07-27_05-53-47", "timestamp": 1690426427, "time_this_iter_s": 39.39293098449707, "time_total_s": 7222.076511144638, "pid": 18921, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 366, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[1291920, 5e-05], [1731120, 8e-05], [2170320, 2.5e-05], [2609520, 2.5e-05], [3048720, 2.5e-05], [3487920, 2.5e-05], [3927120, 1e-05], [4366320, 1e-05], [4805520, 1e-05], [5244720, 5e-06], [5683920, 5e-06], [6123120, 5e-06], [6562320, 5e-06], [7001520, 1e-06], [7440720, 1e-06], [7879920, 1e-06], [8319120, 1e-06], [8758320, 5e-07], [9197520, 5e-07], [9636720, 2.5e-07], [10075920, 2.5e-07], [10515120, 1e-08], [10954320, 1e-08], [11393520, 5e-09], [11832720, 5e-09], [12271920, 1e-09]], "grad_clip": 0.5, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.1, "final_epsilon": 0.01, "epsilon_timesteps": 1387080}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 43920, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x16b7b79d0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 2554.5317533016205, "iterations_since_restore": 64, "perf": {"cpu_util_percent": 17.97142857142857, "ram_util_percent": 69.07857142857142}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-05, "entropy_coeff": 0.049999999999999996, "policy_entropy": -1369.2593390906866, "policy_loss": -8.897012720187343e+18, "vf_loss": 304022537.3702624}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 44247.5, "diff_num_grad_updates_vs_sampler_policy": 44246.5}}, "num_env_steps_sampled": 4102800, "num_env_steps_trained": 4102800, "num_agent_steps_sampled": 4102800, "num_agent_steps_trained": 4102800}, "sampler_results": {"episode_reward_max": -1348610.8719291363, "episode_reward_min": -1369366.2314788997, "episode_reward_mean": -1353066.1812547243, "episode_len_mean": 43920.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1369366.2314788997, -1361335.2082701626, -1354747.2510403998, -1351385.668151872, -1353878.0036070035, -1353934.4440263135, -1349299.1822382265, -1352848.977192731, -1354881.8648155385, -1350293.381402571, -1351982.609620888, -1355148.9106643137, -1353355.7607168008, -1351316.0660699722, -1348824.8954038802, -1353463.9545051646, -1350201.1795549188, -1352786.6794055027, -1352053.2572481462, -1352558.3135243794, -1358466.517990561, -1351346.3540966634, -1351505.6693919636, -1353330.2319483531, -1351757.3621417605, -1351111.1344867356, -1352960.1558008753, -1353830.0290992912, -1352774.403007062, -1353239.1979867364, -1351903.1794592983, -1353195.1205072168, -1350544.7864785872, -1351714.7076935158, -1353808.3265127144, -1354467.1794068213, -1354455.2950085176, -1352877.5992428334, -1354615.6626388268, -1351517.925035784, -1350395.7720792037, -1355468.214768313, -1350950.9235178346, -1349461.9810155102, -1353244.1483122527, -1351773.7359352622, -1354580.862936983, -1353454.3955520217, -1351924.6931606017, -1349349.7745003805, -1349310.0333108394, -1355562.6956711074, -1351184.5654083667, -1356438.3696041456, -1351573.5012043987, -1353129.6330961955, -1355215.5180250898, -1356522.3907284164, -1351890.9147890166, -1353320.3813771496, -1351367.9248604018, -1356035.0993225917, -1351131.9822143805, -1348610.8719291363, -1354320.7213656737], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.14064926451830723, "mean_inference_ms": 0.247235608313738, "mean_action_processing_ms": 0.059279489312709426, "mean_env_wait_ms": 0.46754334322865015, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002376116239107572, "StateBufferConnector_ms": 0.0017298184908353365, "ViewRequirementAgentConnector_ms": 0.04509889162503756}}, "episode_reward_max": -1348610.8719291363, "episode_reward_min": -1369366.2314788997, "episode_reward_mean": -1353066.1812547243, "episode_len_mean": 43920.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1369366.2314788997, -1361335.2082701626, -1354747.2510403998, -1351385.668151872, -1353878.0036070035, -1353934.4440263135, -1349299.1822382265, -1352848.977192731, -1354881.8648155385, -1350293.381402571, -1351982.609620888, -1355148.9106643137, -1353355.7607168008, -1351316.0660699722, -1348824.8954038802, -1353463.9545051646, -1350201.1795549188, -1352786.6794055027, -1352053.2572481462, -1352558.3135243794, -1358466.517990561, -1351346.3540966634, -1351505.6693919636, -1353330.2319483531, -1351757.3621417605, -1351111.1344867356, -1352960.1558008753, -1353830.0290992912, -1352774.403007062, -1353239.1979867364, -1351903.1794592983, -1353195.1205072168, -1350544.7864785872, -1351714.7076935158, -1353808.3265127144, -1354467.1794068213, -1354455.2950085176, -1352877.5992428334, -1354615.6626388268, -1351517.925035784, -1350395.7720792037, -1355468.214768313, -1350950.9235178346, -1349461.9810155102, -1353244.1483122527, -1351773.7359352622, -1354580.862936983, -1353454.3955520217, -1351924.6931606017, -1349349.7745003805, -1349310.0333108394, -1355562.6956711074, -1351184.5654083667, -1356438.3696041456, -1351573.5012043987, -1353129.6330961955, -1355215.5180250898, -1356522.3907284164, -1351890.9147890166, -1353320.3813771496, -1351367.9248604018, -1356035.0993225917, -1351131.9822143805, -1348610.8719291363, -1354320.7213656737], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.14064926451830723, "mean_inference_ms": 0.247235608313738, "mean_action_processing_ms": 0.059279489312709426, "mean_env_wait_ms": 0.46754334322865015, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002376116239107572, "StateBufferConnector_ms": 0.0017298184908353365, "ViewRequirementAgentConnector_ms": 0.04509889162503756}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 4102800, "num_agent_steps_trained": 4102800, "num_env_steps_sampled": 4102800, "num_env_steps_trained": 4102800, "num_env_steps_sampled_this_iter": 43920, "num_env_steps_trained_this_iter": 43920, "num_env_steps_sampled_throughput_per_sec": 1121.5119953931114, "num_env_steps_trained_throughput_per_sec": 1121.5119953931114, "timesteps_total": 4102800, "num_steps_trained_this_iter": 43920, "agent_timesteps_total": 4102800, "timers": {"training_iteration_time_ms": 39285.276, "sample_time_ms": 38545.577, "load_time_ms": 12.435, "load_throughput": 3531896.491, "learn_time_ms": 726.437, "learn_throughput": 60459.506, "synch_weights_time_ms": 0.705}, "counters": {"num_env_steps_sampled": 4102800, "num_env_steps_trained": 4102800, "num_agent_steps_sampled": 4102800, "num_agent_steps_trained": 4102800}, "done": false, "episodes_total": 1284, "training_iteration": 405, "trial_id": "d8b7e_00000", "date": "2023-07-27_05-54-26", "timestamp": 1690426466, "time_this_iter_s": 39.163954973220825, "time_total_s": 7261.240466117859, "pid": 18921, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 366, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[1291920, 5e-05], [1731120, 8e-05], [2170320, 2.5e-05], [2609520, 2.5e-05], [3048720, 2.5e-05], [3487920, 2.5e-05], [3927120, 1e-05], [4366320, 1e-05], [4805520, 1e-05], [5244720, 5e-06], [5683920, 5e-06], [6123120, 5e-06], [6562320, 5e-06], [7001520, 1e-06], [7440720, 1e-06], [7879920, 1e-06], [8319120, 1e-06], [8758320, 5e-07], [9197520, 5e-07], [9636720, 2.5e-07], [10075920, 2.5e-07], [10515120, 1e-08], [10954320, 1e-08], [11393520, 5e-09], [11832720, 5e-09], [12271920, 1e-09]], "grad_clip": 0.5, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.1, "final_epsilon": 0.01, "epsilon_timesteps": 1387080}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 43920, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x16b7b79d0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 2593.6957082748413, "iterations_since_restore": 65, "perf": {"cpu_util_percent": 17.775000000000002, "ram_util_percent": 69.13214285714285}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-05, "entropy_coeff": 0.049999999999999996, "policy_entropy": -1404.7136006257972, "policy_loss": -1.947980114810664e+19, "vf_loss": 303346084.5539359}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 44933.5, "diff_num_grad_updates_vs_sampler_policy": 44932.5}}, "num_env_steps_sampled": 4146720, "num_env_steps_trained": 4146720, "num_agent_steps_sampled": 4146720, "num_agent_steps_trained": 4146720}, "sampler_results": {"episode_reward_max": -1348610.8719291363, "episode_reward_min": -1369366.2314788997, "episode_reward_mean": -1353065.1029506999, "episode_len_mean": 43920.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1369366.2314788997, -1361335.2082701626, -1354747.2510403998, -1351385.668151872, -1353878.0036070035, -1353934.4440263135, -1349299.1822382265, -1352848.977192731, -1354881.8648155385, -1350293.381402571, -1351982.609620888, -1355148.9106643137, -1353355.7607168008, -1351316.0660699722, -1348824.8954038802, -1353463.9545051646, -1350201.1795549188, -1352786.6794055027, -1352053.2572481462, -1352558.3135243794, -1358466.517990561, -1351346.3540966634, -1351505.6693919636, -1353330.2319483531, -1351757.3621417605, -1351111.1344867356, -1352960.1558008753, -1353830.0290992912, -1352774.403007062, -1353239.1979867364, -1351903.1794592983, -1353195.1205072168, -1350544.7864785872, -1351714.7076935158, -1353808.3265127144, -1354467.1794068213, -1354455.2950085176, -1352877.5992428334, -1354615.6626388268, -1351517.925035784, -1350395.7720792037, -1355468.214768313, -1350950.9235178346, -1349461.9810155102, -1353244.1483122527, -1351773.7359352622, -1354580.862936983, -1353454.3955520217, -1351924.6931606017, -1349349.7745003805, -1349310.0333108394, -1355562.6956711074, -1351184.5654083667, -1356438.3696041456, -1351573.5012043987, -1353129.6330961955, -1355215.5180250898, -1356522.3907284164, -1351890.9147890166, -1353320.3813771496, -1351367.9248604018, -1356035.0993225917, -1351131.9822143805, -1348610.8719291363, -1354320.7213656737, -1352995.0131891116], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.14058271363065314, "mean_inference_ms": 0.24707766119705032, "mean_action_processing_ms": 0.05925362339460613, "mean_env_wait_ms": 0.4672609311929301, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002375516024502841, "StateBufferConnector_ms": 0.0017379269455418441, "ViewRequirementAgentConnector_ms": 0.04514889283613725}}, "episode_reward_max": -1348610.8719291363, "episode_reward_min": -1369366.2314788997, "episode_reward_mean": -1353065.1029506999, "episode_len_mean": 43920.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1369366.2314788997, -1361335.2082701626, -1354747.2510403998, -1351385.668151872, -1353878.0036070035, -1353934.4440263135, -1349299.1822382265, -1352848.977192731, -1354881.8648155385, -1350293.381402571, -1351982.609620888, -1355148.9106643137, -1353355.7607168008, -1351316.0660699722, -1348824.8954038802, -1353463.9545051646, -1350201.1795549188, -1352786.6794055027, -1352053.2572481462, -1352558.3135243794, -1358466.517990561, -1351346.3540966634, -1351505.6693919636, -1353330.2319483531, -1351757.3621417605, -1351111.1344867356, -1352960.1558008753, -1353830.0290992912, -1352774.403007062, -1353239.1979867364, -1351903.1794592983, -1353195.1205072168, -1350544.7864785872, -1351714.7076935158, -1353808.3265127144, -1354467.1794068213, -1354455.2950085176, -1352877.5992428334, -1354615.6626388268, -1351517.925035784, -1350395.7720792037, -1355468.214768313, -1350950.9235178346, -1349461.9810155102, -1353244.1483122527, -1351773.7359352622, -1354580.862936983, -1353454.3955520217, -1351924.6931606017, -1349349.7745003805, -1349310.0333108394, -1355562.6956711074, -1351184.5654083667, -1356438.3696041456, -1351573.5012043987, -1353129.6330961955, -1355215.5180250898, -1356522.3907284164, -1351890.9147890166, -1353320.3813771496, -1351367.9248604018, -1356035.0993225917, -1351131.9822143805, -1348610.8719291363, -1354320.7213656737, -1352995.0131891116], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.14058271363065314, "mean_inference_ms": 0.24707766119705032, "mean_action_processing_ms": 0.05925362339460613, "mean_env_wait_ms": 0.4672609311929301, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002375516024502841, "StateBufferConnector_ms": 0.0017379269455418441, "ViewRequirementAgentConnector_ms": 0.04514889283613725}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 4146720, "num_agent_steps_trained": 4146720, "num_env_steps_sampled": 4146720, "num_env_steps_trained": 4146720, "num_env_steps_sampled_this_iter": 43920, "num_env_steps_trained_this_iter": 43920, "num_env_steps_sampled_throughput_per_sec": 1035.434882626502, "num_env_steps_trained_throughput_per_sec": 1035.434882626502, "timesteps_total": 4146720, "num_steps_trained_this_iter": 43920, "agent_timesteps_total": 4146720, "timers": {"training_iteration_time_ms": 39594.63, "sample_time_ms": 38841.379, "load_time_ms": 12.579, "load_throughput": 3491417.703, "learn_time_ms": 739.826, "learn_throughput": 59365.334, "synch_weights_time_ms": 0.721}, "counters": {"num_env_steps_sampled": 4146720, "num_env_steps_trained": 4146720, "num_agent_steps_sampled": 4146720, "num_agent_steps_trained": 4146720}, "done": false, "episodes_total": 1285, "training_iteration": 406, "trial_id": "d8b7e_00000", "date": "2023-07-27_05-55-08", "timestamp": 1690426508, "time_this_iter_s": 42.41929817199707, "time_total_s": 7303.659764289856, "pid": 18921, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 366, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[1291920, 5e-05], [1731120, 8e-05], [2170320, 2.5e-05], [2609520, 2.5e-05], [3048720, 2.5e-05], [3487920, 2.5e-05], [3927120, 1e-05], [4366320, 1e-05], [4805520, 1e-05], [5244720, 5e-06], [5683920, 5e-06], [6123120, 5e-06], [6562320, 5e-06], [7001520, 1e-06], [7440720, 1e-06], [7879920, 1e-06], [8319120, 1e-06], [8758320, 5e-07], [9197520, 5e-07], [9636720, 2.5e-07], [10075920, 2.5e-07], [10515120, 1e-08], [10954320, 1e-08], [11393520, 5e-09], [11832720, 5e-09], [12271920, 1e-09]], "grad_clip": 0.5, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.1, "final_epsilon": 0.01, "epsilon_timesteps": 1387080}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 43920, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x16b7b79d0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 2636.1150064468384, "iterations_since_restore": 66, "perf": {"cpu_util_percent": 18.261666666666667, "ram_util_percent": 69.1}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-05, "entropy_coeff": 0.049999999999999996, "policy_entropy": -1379.8259551379144, "policy_loss": -1.1115660431966341e+19, "vf_loss": 302318383.51603496}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 45619.5, "diff_num_grad_updates_vs_sampler_policy": 45618.5}}, "num_env_steps_sampled": 4190640, "num_env_steps_trained": 4190640, "num_agent_steps_sampled": 4190640, "num_agent_steps_trained": 4190640}, "sampler_results": {"episode_reward_max": -1348610.8719291363, "episode_reward_min": -1369366.2314788997, "episode_reward_mean": -1353028.2597341174, "episode_len_mean": 43920.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1369366.2314788997, -1361335.2082701626, -1354747.2510403998, -1351385.668151872, -1353878.0036070035, -1353934.4440263135, -1349299.1822382265, -1352848.977192731, -1354881.8648155385, -1350293.381402571, -1351982.609620888, -1355148.9106643137, -1353355.7607168008, -1351316.0660699722, -1348824.8954038802, -1353463.9545051646, -1350201.1795549188, -1352786.6794055027, -1352053.2572481462, -1352558.3135243794, -1358466.517990561, -1351346.3540966634, -1351505.6693919636, -1353330.2319483531, -1351757.3621417605, -1351111.1344867356, -1352960.1558008753, -1353830.0290992912, -1352774.403007062, -1353239.1979867364, -1351903.1794592983, -1353195.1205072168, -1350544.7864785872, -1351714.7076935158, -1353808.3265127144, -1354467.1794068213, -1354455.2950085176, -1352877.5992428334, -1354615.6626388268, -1351517.925035784, -1350395.7720792037, -1355468.214768313, -1350950.9235178346, -1349461.9810155102, -1353244.1483122527, -1351773.7359352622, -1354580.862936983, -1353454.3955520217, -1351924.6931606017, -1349349.7745003805, -1349310.0333108394, -1355562.6956711074, -1351184.5654083667, -1356438.3696041456, -1351573.5012043987, -1353129.6330961955, -1355215.5180250898, -1356522.3907284164, -1351890.9147890166, -1353320.3813771496, -1351367.9248604018, -1356035.0993225917, -1351131.9822143805, -1348610.8719291363, -1354320.7213656737, -1352995.0131891116, -1350596.607439688], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.14052173792108533, "mean_inference_ms": 0.24692914548821823, "mean_action_processing_ms": 0.05922988351039534, "mean_env_wait_ms": 0.4669933102664897, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0024069601030492073, "StateBufferConnector_ms": 0.0017390322329393073, "ViewRequirementAgentConnector_ms": 0.045180320739746094}}, "episode_reward_max": -1348610.8719291363, "episode_reward_min": -1369366.2314788997, "episode_reward_mean": -1353028.2597341174, "episode_len_mean": 43920.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1369366.2314788997, -1361335.2082701626, -1354747.2510403998, -1351385.668151872, -1353878.0036070035, -1353934.4440263135, -1349299.1822382265, -1352848.977192731, -1354881.8648155385, -1350293.381402571, -1351982.609620888, -1355148.9106643137, -1353355.7607168008, -1351316.0660699722, -1348824.8954038802, -1353463.9545051646, -1350201.1795549188, -1352786.6794055027, -1352053.2572481462, -1352558.3135243794, -1358466.517990561, -1351346.3540966634, -1351505.6693919636, -1353330.2319483531, -1351757.3621417605, -1351111.1344867356, -1352960.1558008753, -1353830.0290992912, -1352774.403007062, -1353239.1979867364, -1351903.1794592983, -1353195.1205072168, -1350544.7864785872, -1351714.7076935158, -1353808.3265127144, -1354467.1794068213, -1354455.2950085176, -1352877.5992428334, -1354615.6626388268, -1351517.925035784, -1350395.7720792037, -1355468.214768313, -1350950.9235178346, -1349461.9810155102, -1353244.1483122527, -1351773.7359352622, -1354580.862936983, -1353454.3955520217, -1351924.6931606017, -1349349.7745003805, -1349310.0333108394, -1355562.6956711074, -1351184.5654083667, -1356438.3696041456, -1351573.5012043987, -1353129.6330961955, -1355215.5180250898, -1356522.3907284164, -1351890.9147890166, -1353320.3813771496, -1351367.9248604018, -1356035.0993225917, -1351131.9822143805, -1348610.8719291363, -1354320.7213656737, -1352995.0131891116, -1350596.607439688], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.14052173792108533, "mean_inference_ms": 0.24692914548821823, "mean_action_processing_ms": 0.05922988351039534, "mean_env_wait_ms": 0.4669933102664897, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0024069601030492073, "StateBufferConnector_ms": 0.0017390322329393073, "ViewRequirementAgentConnector_ms": 0.045180320739746094}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 4190640, "num_agent_steps_trained": 4190640, "num_env_steps_sampled": 4190640, "num_env_steps_trained": 4190640, "num_env_steps_sampled_this_iter": 43920, "num_env_steps_trained_this_iter": 43920, "num_env_steps_sampled_throughput_per_sec": 1015.1590646385246, "num_env_steps_trained_throughput_per_sec": 1015.1590646385246, "timesteps_total": 4190640, "num_steps_trained_this_iter": 43920, "agent_timesteps_total": 4190640, "timers": {"training_iteration_time_ms": 39967.352, "sample_time_ms": 39202.95, "load_time_ms": 12.761, "load_throughput": 3441763.121, "learn_time_ms": 750.793, "learn_throughput": 58498.157, "synch_weights_time_ms": 0.722}, "counters": {"num_env_steps_sampled": 4190640, "num_env_steps_trained": 4190640, "num_agent_steps_sampled": 4190640, "num_agent_steps_trained": 4190640}, "done": false, "episodes_total": 1286, "training_iteration": 407, "trial_id": "d8b7e_00000", "date": "2023-07-27_05-55-52", "timestamp": 1690426552, "time_this_iter_s": 43.26662492752075, "time_total_s": 7346.926389217377, "pid": 18921, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 366, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[1291920, 5e-05], [1731120, 8e-05], [2170320, 2.5e-05], [2609520, 2.5e-05], [3048720, 2.5e-05], [3487920, 2.5e-05], [3927120, 1e-05], [4366320, 1e-05], [4805520, 1e-05], [5244720, 5e-06], [5683920, 5e-06], [6123120, 5e-06], [6562320, 5e-06], [7001520, 1e-06], [7440720, 1e-06], [7879920, 1e-06], [8319120, 1e-06], [8758320, 5e-07], [9197520, 5e-07], [9636720, 2.5e-07], [10075920, 2.5e-07], [10515120, 1e-08], [10954320, 1e-08], [11393520, 5e-09], [11832720, 5e-09], [12271920, 1e-09]], "grad_clip": 0.5, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.1, "final_epsilon": 0.01, "epsilon_timesteps": 1387080}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 43920, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x16b7b79d0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 2679.381631374359, "iterations_since_restore": 67, "perf": {"cpu_util_percent": 19.339344262295086, "ram_util_percent": 69.11475409836065}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-05, "entropy_coeff": 0.049999999999999996, "policy_entropy": -1347.238886974991, "policy_loss": -6.184730277746985e+18, "vf_loss": 301832599.0962099}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 46305.5, "diff_num_grad_updates_vs_sampler_policy": 46304.5}}, "num_env_steps_sampled": 4234560, "num_env_steps_trained": 4234560, "num_agent_steps_sampled": 4234560, "num_agent_steps_trained": 4234560}, "sampler_results": {"episode_reward_max": -1348610.8719291363, "episode_reward_min": -1369366.2314788997, "episode_reward_mean": -1352978.5694029236, "episode_len_mean": 43920.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1369366.2314788997, -1361335.2082701626, -1354747.2510403998, -1351385.668151872, -1353878.0036070035, -1353934.4440263135, -1349299.1822382265, -1352848.977192731, -1354881.8648155385, -1350293.381402571, -1351982.609620888, -1355148.9106643137, -1353355.7607168008, -1351316.0660699722, -1348824.8954038802, -1353463.9545051646, -1350201.1795549188, -1352786.6794055027, -1352053.2572481462, -1352558.3135243794, -1358466.517990561, -1351346.3540966634, -1351505.6693919636, -1353330.2319483531, -1351757.3621417605, -1351111.1344867356, -1352960.1558008753, -1353830.0290992912, -1352774.403007062, -1353239.1979867364, -1351903.1794592983, -1353195.1205072168, -1350544.7864785872, -1351714.7076935158, -1353808.3265127144, -1354467.1794068213, -1354455.2950085176, -1352877.5992428334, -1354615.6626388268, -1351517.925035784, -1350395.7720792037, -1355468.214768313, -1350950.9235178346, -1349461.9810155102, -1353244.1483122527, -1351773.7359352622, -1354580.862936983, -1353454.3955520217, -1351924.6931606017, -1349349.7745003805, -1349310.0333108394, -1355562.6956711074, -1351184.5654083667, -1356438.3696041456, -1351573.5012043987, -1353129.6330961955, -1355215.5180250898, -1356522.3907284164, -1351890.9147890166, -1353320.3813771496, -1351367.9248604018, -1356035.0993225917, -1351131.9822143805, -1348610.8719291363, -1354320.7213656737, -1352995.0131891116, -1350596.607439688, -1349649.3172129309], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.14046546275623256, "mean_inference_ms": 0.24678853979014678, "mean_action_processing_ms": 0.05920795418231764, "mean_env_wait_ms": 0.4667385649769046, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0024059239555807676, "StateBufferConnector_ms": 0.0017429099363439223, "ViewRequirementAgentConnector_ms": 0.04522449829999138}}, "episode_reward_max": -1348610.8719291363, "episode_reward_min": -1369366.2314788997, "episode_reward_mean": -1352978.5694029236, "episode_len_mean": 43920.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1369366.2314788997, -1361335.2082701626, -1354747.2510403998, -1351385.668151872, -1353878.0036070035, -1353934.4440263135, -1349299.1822382265, -1352848.977192731, -1354881.8648155385, -1350293.381402571, -1351982.609620888, -1355148.9106643137, -1353355.7607168008, -1351316.0660699722, -1348824.8954038802, -1353463.9545051646, -1350201.1795549188, -1352786.6794055027, -1352053.2572481462, -1352558.3135243794, -1358466.517990561, -1351346.3540966634, -1351505.6693919636, -1353330.2319483531, -1351757.3621417605, -1351111.1344867356, -1352960.1558008753, -1353830.0290992912, -1352774.403007062, -1353239.1979867364, -1351903.1794592983, -1353195.1205072168, -1350544.7864785872, -1351714.7076935158, -1353808.3265127144, -1354467.1794068213, -1354455.2950085176, -1352877.5992428334, -1354615.6626388268, -1351517.925035784, -1350395.7720792037, -1355468.214768313, -1350950.9235178346, -1349461.9810155102, -1353244.1483122527, -1351773.7359352622, -1354580.862936983, -1353454.3955520217, -1351924.6931606017, -1349349.7745003805, -1349310.0333108394, -1355562.6956711074, -1351184.5654083667, -1356438.3696041456, -1351573.5012043987, -1353129.6330961955, -1355215.5180250898, -1356522.3907284164, -1351890.9147890166, -1353320.3813771496, -1351367.9248604018, -1356035.0993225917, -1351131.9822143805, -1348610.8719291363, -1354320.7213656737, -1352995.0131891116, -1350596.607439688, -1349649.3172129309], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.14046546275623256, "mean_inference_ms": 0.24678853979014678, "mean_action_processing_ms": 0.05920795418231764, "mean_env_wait_ms": 0.4667385649769046, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0024059239555807676, "StateBufferConnector_ms": 0.0017429099363439223, "ViewRequirementAgentConnector_ms": 0.04522449829999138}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 4234560, "num_agent_steps_trained": 4234560, "num_env_steps_sampled": 4234560, "num_env_steps_trained": 4234560, "num_env_steps_sampled_this_iter": 43920, "num_env_steps_trained_this_iter": 43920, "num_env_steps_sampled_throughput_per_sec": 1029.1445235454387, "num_env_steps_trained_throughput_per_sec": 1029.1445235454387, "timesteps_total": 4234560, "num_steps_trained_this_iter": 43920, "agent_timesteps_total": 4234560, "timers": {"training_iteration_time_ms": 40317.643, "sample_time_ms": 39543.66, "load_time_ms": 12.718, "load_throughput": 3453266.892, "learn_time_ms": 760.437, "learn_throughput": 57756.277, "synch_weights_time_ms": 0.708}, "counters": {"num_env_steps_sampled": 4234560, "num_env_steps_trained": 4234560, "num_agent_steps_sampled": 4234560, "num_agent_steps_trained": 4234560}, "done": false, "episodes_total": 1287, "training_iteration": 408, "trial_id": "d8b7e_00000", "date": "2023-07-27_05-56-34", "timestamp": 1690426594, "time_this_iter_s": 42.67862010002136, "time_total_s": 7389.605009317398, "pid": 18921, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 366, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[1291920, 5e-05], [1731120, 8e-05], [2170320, 2.5e-05], [2609520, 2.5e-05], [3048720, 2.5e-05], [3487920, 2.5e-05], [3927120, 1e-05], [4366320, 1e-05], [4805520, 1e-05], [5244720, 5e-06], [5683920, 5e-06], [6123120, 5e-06], [6562320, 5e-06], [7001520, 1e-06], [7440720, 1e-06], [7879920, 1e-06], [8319120, 1e-06], [8758320, 5e-07], [9197520, 5e-07], [9636720, 2.5e-07], [10075920, 2.5e-07], [10515120, 1e-08], [10954320, 1e-08], [11393520, 5e-09], [11832720, 5e-09], [12271920, 1e-09]], "grad_clip": 0.5, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.1, "final_epsilon": 0.01, "epsilon_timesteps": 1387080}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 43920, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x16b7b79d0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 2722.0602514743805, "iterations_since_restore": 68, "perf": {"cpu_util_percent": 17.623333333333335, "ram_util_percent": 69.15333333333335}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-05, "entropy_coeff": 0.049999999999999996, "policy_entropy": -1394.7485392489864, "policy_loss": -1.9840401322574967e+19, "vf_loss": 302489430.3381924}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 46991.5, "diff_num_grad_updates_vs_sampler_policy": 46990.5}}, "num_env_steps_sampled": 4278480, "num_env_steps_trained": 4278480, "num_agent_steps_sampled": 4278480, "num_agent_steps_trained": 4278480}, "sampler_results": {"episode_reward_max": -1348610.8719291363, "episode_reward_min": -1369366.2314788997, "episode_reward_mean": -1352951.7245986562, "episode_len_mean": 43920.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1369366.2314788997, -1361335.2082701626, -1354747.2510403998, -1351385.668151872, -1353878.0036070035, -1353934.4440263135, -1349299.1822382265, -1352848.977192731, -1354881.8648155385, -1350293.381402571, -1351982.609620888, -1355148.9106643137, -1353355.7607168008, -1351316.0660699722, -1348824.8954038802, -1353463.9545051646, -1350201.1795549188, -1352786.6794055027, -1352053.2572481462, -1352558.3135243794, -1358466.517990561, -1351346.3540966634, -1351505.6693919636, -1353330.2319483531, -1351757.3621417605, -1351111.1344867356, -1352960.1558008753, -1353830.0290992912, -1352774.403007062, -1353239.1979867364, -1351903.1794592983, -1353195.1205072168, -1350544.7864785872, -1351714.7076935158, -1353808.3265127144, -1354467.1794068213, -1354455.2950085176, -1352877.5992428334, -1354615.6626388268, -1351517.925035784, -1350395.7720792037, -1355468.214768313, -1350950.9235178346, -1349461.9810155102, -1353244.1483122527, -1351773.7359352622, -1354580.862936983, -1353454.3955520217, -1351924.6931606017, -1349349.7745003805, -1349310.0333108394, -1355562.6956711074, -1351184.5654083667, -1356438.3696041456, -1351573.5012043987, -1353129.6330961955, -1355215.5180250898, -1356522.3907284164, -1351890.9147890166, -1353320.3813771496, -1351367.9248604018, -1356035.0993225917, -1351131.9822143805, -1348610.8719291363, -1354320.7213656737, -1352995.0131891116, -1350596.607439688, -1349649.3172129309, -1351126.277908477], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.14041316159042175, "mean_inference_ms": 0.24665503691801996, "mean_action_processing_ms": 0.05918757230588632, "mean_env_wait_ms": 0.46649578806489433, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0023997348287831182, "StateBufferConnector_ms": 0.0017397645590961843, "ViewRequirementAgentConnector_ms": 0.0452152196911798}}, "episode_reward_max": -1348610.8719291363, "episode_reward_min": -1369366.2314788997, "episode_reward_mean": -1352951.7245986562, "episode_len_mean": 43920.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1369366.2314788997, -1361335.2082701626, -1354747.2510403998, -1351385.668151872, -1353878.0036070035, -1353934.4440263135, -1349299.1822382265, -1352848.977192731, -1354881.8648155385, -1350293.381402571, -1351982.609620888, -1355148.9106643137, -1353355.7607168008, -1351316.0660699722, -1348824.8954038802, -1353463.9545051646, -1350201.1795549188, -1352786.6794055027, -1352053.2572481462, -1352558.3135243794, -1358466.517990561, -1351346.3540966634, -1351505.6693919636, -1353330.2319483531, -1351757.3621417605, -1351111.1344867356, -1352960.1558008753, -1353830.0290992912, -1352774.403007062, -1353239.1979867364, -1351903.1794592983, -1353195.1205072168, -1350544.7864785872, -1351714.7076935158, -1353808.3265127144, -1354467.1794068213, -1354455.2950085176, -1352877.5992428334, -1354615.6626388268, -1351517.925035784, -1350395.7720792037, -1355468.214768313, -1350950.9235178346, -1349461.9810155102, -1353244.1483122527, -1351773.7359352622, -1354580.862936983, -1353454.3955520217, -1351924.6931606017, -1349349.7745003805, -1349310.0333108394, -1355562.6956711074, -1351184.5654083667, -1356438.3696041456, -1351573.5012043987, -1353129.6330961955, -1355215.5180250898, -1356522.3907284164, -1351890.9147890166, -1353320.3813771496, -1351367.9248604018, -1356035.0993225917, -1351131.9822143805, -1348610.8719291363, -1354320.7213656737, -1352995.0131891116, -1350596.607439688, -1349649.3172129309, -1351126.277908477], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.14041316159042175, "mean_inference_ms": 0.24665503691801996, "mean_action_processing_ms": 0.05918757230588632, "mean_env_wait_ms": 0.46649578806489433, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0023997348287831182, "StateBufferConnector_ms": 0.0017397645590961843, "ViewRequirementAgentConnector_ms": 0.0452152196911798}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 4278480, "num_agent_steps_trained": 4278480, "num_env_steps_sampled": 4278480, "num_env_steps_trained": 4278480, "num_env_steps_sampled_this_iter": 43920, "num_env_steps_trained_this_iter": 43920, "num_env_steps_sampled_throughput_per_sec": 1033.932280803072, "num_env_steps_trained_throughput_per_sec": 1033.932280803072, "timesteps_total": 4278480, "num_steps_trained_this_iter": 43920, "agent_timesteps_total": 4278480, "timers": {"training_iteration_time_ms": 40641.377, "sample_time_ms": 39854.262, "load_time_ms": 12.848, "load_throughput": 3418482.762, "learn_time_ms": 773.427, "learn_throughput": 56786.262, "synch_weights_time_ms": 0.72}, "counters": {"num_env_steps_sampled": 4278480, "num_env_steps_trained": 4278480, "num_agent_steps_sampled": 4278480, "num_agent_steps_trained": 4278480}, "done": false, "episodes_total": 1288, "training_iteration": 409, "trial_id": "d8b7e_00000", "date": "2023-07-27_05-57-17", "timestamp": 1690426637, "time_this_iter_s": 42.48107409477234, "time_total_s": 7432.08608341217, "pid": 18921, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 366, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[1291920, 5e-05], [1731120, 8e-05], [2170320, 2.5e-05], [2609520, 2.5e-05], [3048720, 2.5e-05], [3487920, 2.5e-05], [3927120, 1e-05], [4366320, 1e-05], [4805520, 1e-05], [5244720, 5e-06], [5683920, 5e-06], [6123120, 5e-06], [6562320, 5e-06], [7001520, 1e-06], [7440720, 1e-06], [7879920, 1e-06], [8319120, 1e-06], [8758320, 5e-07], [9197520, 5e-07], [9636720, 2.5e-07], [10075920, 2.5e-07], [10515120, 1e-08], [10954320, 1e-08], [11393520, 5e-09], [11832720, 5e-09], [12271920, 1e-09]], "grad_clip": 0.5, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.1, "final_epsilon": 0.01, "epsilon_timesteps": 1387080}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 43920, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x16b7b79d0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 2764.541325569153, "iterations_since_restore": 69, "perf": {"cpu_util_percent": 17.8, "ram_util_percent": 69.12950819672132}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-05, "entropy_coeff": 0.049999999999999996, "policy_entropy": -1371.6402338767539, "policy_loss": -9.235050913568303e+18, "vf_loss": 303810260.23323613}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 47677.5, "diff_num_grad_updates_vs_sampler_policy": 47676.5}}, "num_env_steps_sampled": 4322400, "num_env_steps_trained": 4322400, "num_agent_steps_sampled": 4322400, "num_agent_steps_trained": 4322400}, "sampler_results": {"episode_reward_max": -1348610.8719291363, "episode_reward_min": -1369366.2314788997, "episode_reward_mean": -1352963.6433296755, "episode_len_mean": 43920.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1369366.2314788997, -1361335.2082701626, -1354747.2510403998, -1351385.668151872, -1353878.0036070035, -1353934.4440263135, -1349299.1822382265, -1352848.977192731, -1354881.8648155385, -1350293.381402571, -1351982.609620888, -1355148.9106643137, -1353355.7607168008, -1351316.0660699722, -1348824.8954038802, -1353463.9545051646, -1350201.1795549188, -1352786.6794055027, -1352053.2572481462, -1352558.3135243794, -1358466.517990561, -1351346.3540966634, -1351505.6693919636, -1353330.2319483531, -1351757.3621417605, -1351111.1344867356, -1352960.1558008753, -1353830.0290992912, -1352774.403007062, -1353239.1979867364, -1351903.1794592983, -1353195.1205072168, -1350544.7864785872, -1351714.7076935158, -1353808.3265127144, -1354467.1794068213, -1354455.2950085176, -1352877.5992428334, -1354615.6626388268, -1351517.925035784, -1350395.7720792037, -1355468.214768313, -1350950.9235178346, -1349461.9810155102, -1353244.1483122527, -1351773.7359352622, -1354580.862936983, -1353454.3955520217, -1351924.6931606017, -1349349.7745003805, -1349310.0333108394, -1355562.6956711074, -1351184.5654083667, -1356438.3696041456, -1351573.5012043987, -1353129.6330961955, -1355215.5180250898, -1356522.3907284164, -1351890.9147890166, -1353320.3813771496, -1351367.9248604018, -1356035.0993225917, -1351131.9822143805, -1348610.8719291363, -1354320.7213656737, -1352995.0131891116, -1350596.607439688, -1349649.3172129309, -1351126.277908477, -1353786.0357700172], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.14036499379005973, "mean_inference_ms": 0.24652823859620782, "mean_action_processing_ms": 0.059168551467527725, "mean_env_wait_ms": 0.466263411805964, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0024008750915527344, "StateBufferConnector_ms": 0.0017442022051130021, "ViewRequirementAgentConnector_ms": 0.04531247275216239}}, "episode_reward_max": -1348610.8719291363, "episode_reward_min": -1369366.2314788997, "episode_reward_mean": -1352963.6433296755, "episode_len_mean": 43920.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1369366.2314788997, -1361335.2082701626, -1354747.2510403998, -1351385.668151872, -1353878.0036070035, -1353934.4440263135, -1349299.1822382265, -1352848.977192731, -1354881.8648155385, -1350293.381402571, -1351982.609620888, -1355148.9106643137, -1353355.7607168008, -1351316.0660699722, -1348824.8954038802, -1353463.9545051646, -1350201.1795549188, -1352786.6794055027, -1352053.2572481462, -1352558.3135243794, -1358466.517990561, -1351346.3540966634, -1351505.6693919636, -1353330.2319483531, -1351757.3621417605, -1351111.1344867356, -1352960.1558008753, -1353830.0290992912, -1352774.403007062, -1353239.1979867364, -1351903.1794592983, -1353195.1205072168, -1350544.7864785872, -1351714.7076935158, -1353808.3265127144, -1354467.1794068213, -1354455.2950085176, -1352877.5992428334, -1354615.6626388268, -1351517.925035784, -1350395.7720792037, -1355468.214768313, -1350950.9235178346, -1349461.9810155102, -1353244.1483122527, -1351773.7359352622, -1354580.862936983, -1353454.3955520217, -1351924.6931606017, -1349349.7745003805, -1349310.0333108394, -1355562.6956711074, -1351184.5654083667, -1356438.3696041456, -1351573.5012043987, -1353129.6330961955, -1355215.5180250898, -1356522.3907284164, -1351890.9147890166, -1353320.3813771496, -1351367.9248604018, -1356035.0993225917, -1351131.9822143805, -1348610.8719291363, -1354320.7213656737, -1352995.0131891116, -1350596.607439688, -1349649.3172129309, -1351126.277908477, -1353786.0357700172], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.14036499379005973, "mean_inference_ms": 0.24652823859620782, "mean_action_processing_ms": 0.059168551467527725, "mean_env_wait_ms": 0.466263411805964, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0024008750915527344, "StateBufferConnector_ms": 0.0017442022051130021, "ViewRequirementAgentConnector_ms": 0.04531247275216239}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 4322400, "num_agent_steps_trained": 4322400, "num_env_steps_sampled": 4322400, "num_env_steps_trained": 4322400, "num_env_steps_sampled_this_iter": 43920, "num_env_steps_trained_this_iter": 43920, "num_env_steps_sampled_throughput_per_sec": 1035.817322488664, "num_env_steps_trained_throughput_per_sec": 1035.817322488664, "timesteps_total": 4322400, "num_steps_trained_this_iter": 43920, "agent_timesteps_total": 4322400, "timers": {"training_iteration_time_ms": 40930.876, "sample_time_ms": 40128.423, "load_time_ms": 12.963, "load_throughput": 3388108.516, "learn_time_ms": 788.642, "learn_throughput": 55690.68, "synch_weights_time_ms": 0.726}, "counters": {"num_env_steps_sampled": 4322400, "num_env_steps_trained": 4322400, "num_agent_steps_sampled": 4322400, "num_agent_steps_trained": 4322400}, "done": false, "episodes_total": 1289, "training_iteration": 410, "trial_id": "d8b7e_00000", "date": "2023-07-27_05-57-59", "timestamp": 1690426679, "time_this_iter_s": 42.40356707572937, "time_total_s": 7474.4896504879, "pid": 18921, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 366, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[1291920, 5e-05], [1731120, 8e-05], [2170320, 2.5e-05], [2609520, 2.5e-05], [3048720, 2.5e-05], [3487920, 2.5e-05], [3927120, 1e-05], [4366320, 1e-05], [4805520, 1e-05], [5244720, 5e-06], [5683920, 5e-06], [6123120, 5e-06], [6562320, 5e-06], [7001520, 1e-06], [7440720, 1e-06], [7879920, 1e-06], [8319120, 1e-06], [8758320, 5e-07], [9197520, 5e-07], [9636720, 2.5e-07], [10075920, 2.5e-07], [10515120, 1e-08], [10954320, 1e-08], [11393520, 5e-09], [11832720, 5e-09], [12271920, 1e-09]], "grad_clip": 0.5, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.1, "final_epsilon": 0.01, "epsilon_timesteps": 1387080}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 43920, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x16b7b79d0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 2806.944892644882, "iterations_since_restore": 70, "perf": {"cpu_util_percent": 18.865, "ram_util_percent": 69.07999999999998}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-05, "entropy_coeff": 0.049999999999999996, "policy_entropy": -1349.4750522802592, "policy_loss": -6.357399976864048e+18, "vf_loss": 301691817.90670556}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 48363.5, "diff_num_grad_updates_vs_sampler_policy": 48362.5}}, "num_env_steps_sampled": 4366320, "num_env_steps_trained": 4366320, "num_agent_steps_sampled": 4366320, "num_agent_steps_trained": 4366320}, "sampler_results": {"episode_reward_max": -1348610.8719291363, "episode_reward_min": -1369366.2314788997, "episode_reward_mean": -1352910.6566756892, "episode_len_mean": 43920.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1369366.2314788997, -1361335.2082701626, -1354747.2510403998, -1351385.668151872, -1353878.0036070035, -1353934.4440263135, -1349299.1822382265, -1352848.977192731, -1354881.8648155385, -1350293.381402571, -1351982.609620888, -1355148.9106643137, -1353355.7607168008, -1351316.0660699722, -1348824.8954038802, -1353463.9545051646, -1350201.1795549188, -1352786.6794055027, -1352053.2572481462, -1352558.3135243794, -1358466.517990561, -1351346.3540966634, -1351505.6693919636, -1353330.2319483531, -1351757.3621417605, -1351111.1344867356, -1352960.1558008753, -1353830.0290992912, -1352774.403007062, -1353239.1979867364, -1351903.1794592983, -1353195.1205072168, -1350544.7864785872, -1351714.7076935158, -1353808.3265127144, -1354467.1794068213, -1354455.2950085176, -1352877.5992428334, -1354615.6626388268, -1351517.925035784, -1350395.7720792037, -1355468.214768313, -1350950.9235178346, -1349461.9810155102, -1353244.1483122527, -1351773.7359352622, -1354580.862936983, -1353454.3955520217, -1351924.6931606017, -1349349.7745003805, -1349310.0333108394, -1355562.6956711074, -1351184.5654083667, -1356438.3696041456, -1351573.5012043987, -1353129.6330961955, -1355215.5180250898, -1356522.3907284164, -1351890.9147890166, -1353320.3813771496, -1351367.9248604018, -1356035.0993225917, -1351131.9822143805, -1348610.8719291363, -1354320.7213656737, -1352995.0131891116, -1350596.607439688, -1349649.3172129309, -1351126.277908477, -1353786.0357700172, -1349201.5908966495], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.14032033652597597, "mean_inference_ms": 0.24640764479488222, "mean_action_processing_ms": 0.05915087916441542, "mean_env_wait_ms": 0.4660410149416649, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0024003042301661533, "StateBufferConnector_ms": 0.0017448210380446743, "ViewRequirementAgentConnector_ms": 0.045320685480681945}}, "episode_reward_max": -1348610.8719291363, "episode_reward_min": -1369366.2314788997, "episode_reward_mean": -1352910.6566756892, "episode_len_mean": 43920.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1369366.2314788997, -1361335.2082701626, -1354747.2510403998, -1351385.668151872, -1353878.0036070035, -1353934.4440263135, -1349299.1822382265, -1352848.977192731, -1354881.8648155385, -1350293.381402571, -1351982.609620888, -1355148.9106643137, -1353355.7607168008, -1351316.0660699722, -1348824.8954038802, -1353463.9545051646, -1350201.1795549188, -1352786.6794055027, -1352053.2572481462, -1352558.3135243794, -1358466.517990561, -1351346.3540966634, -1351505.6693919636, -1353330.2319483531, -1351757.3621417605, -1351111.1344867356, -1352960.1558008753, -1353830.0290992912, -1352774.403007062, -1353239.1979867364, -1351903.1794592983, -1353195.1205072168, -1350544.7864785872, -1351714.7076935158, -1353808.3265127144, -1354467.1794068213, -1354455.2950085176, -1352877.5992428334, -1354615.6626388268, -1351517.925035784, -1350395.7720792037, -1355468.214768313, -1350950.9235178346, -1349461.9810155102, -1353244.1483122527, -1351773.7359352622, -1354580.862936983, -1353454.3955520217, -1351924.6931606017, -1349349.7745003805, -1349310.0333108394, -1355562.6956711074, -1351184.5654083667, -1356438.3696041456, -1351573.5012043987, -1353129.6330961955, -1355215.5180250898, -1356522.3907284164, -1351890.9147890166, -1353320.3813771496, -1351367.9248604018, -1356035.0993225917, -1351131.9822143805, -1348610.8719291363, -1354320.7213656737, -1352995.0131891116, -1350596.607439688, -1349649.3172129309, -1351126.277908477, -1353786.0357700172, -1349201.5908966495], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.14032033652597597, "mean_inference_ms": 0.24640764479488222, "mean_action_processing_ms": 0.05915087916441542, "mean_env_wait_ms": 0.4660410149416649, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0024003042301661533, "StateBufferConnector_ms": 0.0017448210380446743, "ViewRequirementAgentConnector_ms": 0.045320685480681945}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 4366320, "num_agent_steps_trained": 4366320, "num_env_steps_sampled": 4366320, "num_env_steps_trained": 4366320, "num_env_steps_sampled_this_iter": 43920, "num_env_steps_trained_this_iter": 43920, "num_env_steps_sampled_throughput_per_sec": 1040.2978041685117, "num_env_steps_trained_throughput_per_sec": 1040.2978041685117, "timesteps_total": 4366320, "num_steps_trained_this_iter": 43920, "agent_timesteps_total": 4366320, "timers": {"training_iteration_time_ms": 41238.209, "sample_time_ms": 40425.77, "load_time_ms": 13.298, "load_throughput": 3302672.628, "learn_time_ms": 798.285, "learn_throughput": 55017.923, "synch_weights_time_ms": 0.731}, "counters": {"num_env_steps_sampled": 4366320, "num_env_steps_trained": 4366320, "num_agent_steps_sampled": 4366320, "num_agent_steps_trained": 4366320}, "done": false, "episodes_total": 1290, "training_iteration": 411, "trial_id": "d8b7e_00000", "date": "2023-07-27_05-58-42", "timestamp": 1690426722, "time_this_iter_s": 42.221132040023804, "time_total_s": 7516.710782527924, "pid": 18921, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 366, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[1291920, 5e-05], [1731120, 8e-05], [2170320, 2.5e-05], [2609520, 2.5e-05], [3048720, 2.5e-05], [3487920, 2.5e-05], [3927120, 1e-05], [4366320, 1e-05], [4805520, 1e-05], [5244720, 5e-06], [5683920, 5e-06], [6123120, 5e-06], [6562320, 5e-06], [7001520, 1e-06], [7440720, 1e-06], [7879920, 1e-06], [8319120, 1e-06], [8758320, 5e-07], [9197520, 5e-07], [9636720, 2.5e-07], [10075920, 2.5e-07], [10515120, 1e-08], [10954320, 1e-08], [11393520, 5e-09], [11832720, 5e-09], [12271920, 1e-09]], "grad_clip": 0.5, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.1, "final_epsilon": 0.01, "epsilon_timesteps": 1387080}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 43920, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x16b7b79d0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 2849.166024684906, "iterations_since_restore": 71, "perf": {"cpu_util_percent": 19.018644067796608, "ram_util_percent": 69.1}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-05, "entropy_coeff": 0.049999999999999996, "policy_entropy": -1394.6845799215334, "policy_loss": -1.8040550321776196e+19, "vf_loss": 305997607.21865886}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 49049.5, "diff_num_grad_updates_vs_sampler_policy": 49048.5}}, "num_env_steps_sampled": 4410240, "num_env_steps_trained": 4410240, "num_agent_steps_sampled": 4410240, "num_agent_steps_trained": 4410240}, "sampler_results": {"episode_reward_max": -1348610.8719291363, "episode_reward_min": -1369366.2314788997, "episode_reward_mean": -1352992.7729863375, "episode_len_mean": 43920.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1369366.2314788997, -1361335.2082701626, -1354747.2510403998, -1351385.668151872, -1353878.0036070035, -1353934.4440263135, -1349299.1822382265, -1352848.977192731, -1354881.8648155385, -1350293.381402571, -1351982.609620888, -1355148.9106643137, -1353355.7607168008, -1351316.0660699722, -1348824.8954038802, -1353463.9545051646, -1350201.1795549188, -1352786.6794055027, -1352053.2572481462, -1352558.3135243794, -1358466.517990561, -1351346.3540966634, -1351505.6693919636, -1353330.2319483531, -1351757.3621417605, -1351111.1344867356, -1352960.1558008753, -1353830.0290992912, -1352774.403007062, -1353239.1979867364, -1351903.1794592983, -1353195.1205072168, -1350544.7864785872, -1351714.7076935158, -1353808.3265127144, -1354467.1794068213, -1354455.2950085176, -1352877.5992428334, -1354615.6626388268, -1351517.925035784, -1350395.7720792037, -1355468.214768313, -1350950.9235178346, -1349461.9810155102, -1353244.1483122527, -1351773.7359352622, -1354580.862936983, -1353454.3955520217, -1351924.6931606017, -1349349.7745003805, -1349310.0333108394, -1355562.6956711074, -1351184.5654083667, -1356438.3696041456, -1351573.5012043987, -1353129.6330961955, -1355215.5180250898, -1356522.3907284164, -1351890.9147890166, -1353320.3813771496, -1351367.9248604018, -1356035.0993225917, -1351131.9822143805, -1348610.8719291363, -1354320.7213656737, -1352995.0131891116, -1350596.607439688, -1349649.3172129309, -1351126.277908477, -1353786.0357700172, -1349201.5908966495, -1358823.0310423607], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.14027889438819757, "mean_inference_ms": 0.24629263693396958, "mean_action_processing_ms": 0.05913445186775252, "mean_env_wait_ms": 0.46582772322819266, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0023967689938015407, "StateBufferConnector_ms": 0.0017417801751030816, "ViewRequirementAgentConnector_ms": 0.0453157557381524}}, "episode_reward_max": -1348610.8719291363, "episode_reward_min": -1369366.2314788997, "episode_reward_mean": -1352992.7729863375, "episode_len_mean": 43920.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1369366.2314788997, -1361335.2082701626, -1354747.2510403998, -1351385.668151872, -1353878.0036070035, -1353934.4440263135, -1349299.1822382265, -1352848.977192731, -1354881.8648155385, -1350293.381402571, -1351982.609620888, -1355148.9106643137, -1353355.7607168008, -1351316.0660699722, -1348824.8954038802, -1353463.9545051646, -1350201.1795549188, -1352786.6794055027, -1352053.2572481462, -1352558.3135243794, -1358466.517990561, -1351346.3540966634, -1351505.6693919636, -1353330.2319483531, -1351757.3621417605, -1351111.1344867356, -1352960.1558008753, -1353830.0290992912, -1352774.403007062, -1353239.1979867364, -1351903.1794592983, -1353195.1205072168, -1350544.7864785872, -1351714.7076935158, -1353808.3265127144, -1354467.1794068213, -1354455.2950085176, -1352877.5992428334, -1354615.6626388268, -1351517.925035784, -1350395.7720792037, -1355468.214768313, -1350950.9235178346, -1349461.9810155102, -1353244.1483122527, -1351773.7359352622, -1354580.862936983, -1353454.3955520217, -1351924.6931606017, -1349349.7745003805, -1349310.0333108394, -1355562.6956711074, -1351184.5654083667, -1356438.3696041456, -1351573.5012043987, -1353129.6330961955, -1355215.5180250898, -1356522.3907284164, -1351890.9147890166, -1353320.3813771496, -1351367.9248604018, -1356035.0993225917, -1351131.9822143805, -1348610.8719291363, -1354320.7213656737, -1352995.0131891116, -1350596.607439688, -1349649.3172129309, -1351126.277908477, -1353786.0357700172, -1349201.5908966495, -1358823.0310423607], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.14027889438819757, "mean_inference_ms": 0.24629263693396958, "mean_action_processing_ms": 0.05913445186775252, "mean_env_wait_ms": 0.46582772322819266, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0023967689938015407, "StateBufferConnector_ms": 0.0017417801751030816, "ViewRequirementAgentConnector_ms": 0.0453157557381524}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 4410240, "num_agent_steps_trained": 4410240, "num_env_steps_sampled": 4410240, "num_env_steps_trained": 4410240, "num_env_steps_sampled_this_iter": 43920, "num_env_steps_trained_this_iter": 43920, "num_env_steps_sampled_throughput_per_sec": 1044.8104716587343, "num_env_steps_trained_throughput_per_sec": 1044.8104716587343, "timesteps_total": 4410240, "num_steps_trained_this_iter": 43920, "agent_timesteps_total": 4410240, "timers": {"training_iteration_time_ms": 41510.236, "sample_time_ms": 40689.936, "load_time_ms": 13.488, "load_throughput": 3256335.531, "learn_time_ms": 805.955, "learn_throughput": 54494.367, "synch_weights_time_ms": 0.731}, "counters": {"num_env_steps_sampled": 4410240, "num_env_steps_trained": 4410240, "num_agent_steps_sampled": 4410240, "num_agent_steps_trained": 4410240}, "done": false, "episodes_total": 1291, "training_iteration": 412, "trial_id": "d8b7e_00000", "date": "2023-07-27_05-59-24", "timestamp": 1690426764, "time_this_iter_s": 42.038620948791504, "time_total_s": 7558.749403476715, "pid": 18921, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 366, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[1291920, 5e-05], [1731120, 8e-05], [2170320, 2.5e-05], [2609520, 2.5e-05], [3048720, 2.5e-05], [3487920, 2.5e-05], [3927120, 1e-05], [4366320, 1e-05], [4805520, 1e-05], [5244720, 5e-06], [5683920, 5e-06], [6123120, 5e-06], [6562320, 5e-06], [7001520, 1e-06], [7440720, 1e-06], [7879920, 1e-06], [8319120, 1e-06], [8758320, 5e-07], [9197520, 5e-07], [9636720, 2.5e-07], [10075920, 2.5e-07], [10515120, 1e-08], [10954320, 1e-08], [11393520, 5e-09], [11832720, 5e-09], [12271920, 1e-09]], "grad_clip": 0.5, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.1, "final_epsilon": 0.01, "epsilon_timesteps": 1387080}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 43920, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x16b7b79d0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 2891.2046456336975, "iterations_since_restore": 72, "perf": {"cpu_util_percent": 17.916666666666664, "ram_util_percent": 69.12333333333332}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-05, "entropy_coeff": 0.049999999999999996, "policy_entropy": -1371.0926280563845, "policy_loss": -1.310545579229765e+19, "vf_loss": 302171820.3148688}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 49735.5, "diff_num_grad_updates_vs_sampler_policy": 49734.5}}, "num_env_steps_sampled": 4454160, "num_env_steps_trained": 4454160, "num_agent_steps_sampled": 4454160, "num_agent_steps_trained": 4454160}, "sampler_results": {"episode_reward_max": -1348610.8719291363, "episode_reward_min": -1369366.2314788997, "episode_reward_mean": -1352954.429208961, "episode_len_mean": 43920.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1369366.2314788997, -1361335.2082701626, -1354747.2510403998, -1351385.668151872, -1353878.0036070035, -1353934.4440263135, -1349299.1822382265, -1352848.977192731, -1354881.8648155385, -1350293.381402571, -1351982.609620888, -1355148.9106643137, -1353355.7607168008, -1351316.0660699722, -1348824.8954038802, -1353463.9545051646, -1350201.1795549188, -1352786.6794055027, -1352053.2572481462, -1352558.3135243794, -1358466.517990561, -1351346.3540966634, -1351505.6693919636, -1353330.2319483531, -1351757.3621417605, -1351111.1344867356, -1352960.1558008753, -1353830.0290992912, -1352774.403007062, -1353239.1979867364, -1351903.1794592983, -1353195.1205072168, -1350544.7864785872, -1351714.7076935158, -1353808.3265127144, -1354467.1794068213, -1354455.2950085176, -1352877.5992428334, -1354615.6626388268, -1351517.925035784, -1350395.7720792037, -1355468.214768313, -1350950.9235178346, -1349461.9810155102, -1353244.1483122527, -1351773.7359352622, -1354580.862936983, -1353454.3955520217, -1351924.6931606017, -1349349.7745003805, -1349310.0333108394, -1355562.6956711074, -1351184.5654083667, -1356438.3696041456, -1351573.5012043987, -1353129.6330961955, -1355215.5180250898, -1356522.3907284164, -1351890.9147890166, -1353320.3813771496, -1351367.9248604018, -1356035.0993225917, -1351131.9822143805, -1348610.8719291363, -1354320.7213656737, -1352995.0131891116, -1350596.607439688, -1349649.3172129309, -1351126.277908477, -1353786.0357700172, -1349201.5908966495, -1358823.0310423607, -1350193.6772378606], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.14024063344457074, "mean_inference_ms": 0.24618302580986495, "mean_action_processing_ms": 0.05911921033171331, "mean_env_wait_ms": 0.4656237916695026, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0023936572140210296, "StateBufferConnector_ms": 0.0017456812401340433, "ViewRequirementAgentConnector_ms": 0.04533316991100573}}, "episode_reward_max": -1348610.8719291363, "episode_reward_min": -1369366.2314788997, "episode_reward_mean": -1352954.429208961, "episode_len_mean": 43920.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1369366.2314788997, -1361335.2082701626, -1354747.2510403998, -1351385.668151872, -1353878.0036070035, -1353934.4440263135, -1349299.1822382265, -1352848.977192731, -1354881.8648155385, -1350293.381402571, -1351982.609620888, -1355148.9106643137, -1353355.7607168008, -1351316.0660699722, -1348824.8954038802, -1353463.9545051646, -1350201.1795549188, -1352786.6794055027, -1352053.2572481462, -1352558.3135243794, -1358466.517990561, -1351346.3540966634, -1351505.6693919636, -1353330.2319483531, -1351757.3621417605, -1351111.1344867356, -1352960.1558008753, -1353830.0290992912, -1352774.403007062, -1353239.1979867364, -1351903.1794592983, -1353195.1205072168, -1350544.7864785872, -1351714.7076935158, -1353808.3265127144, -1354467.1794068213, -1354455.2950085176, -1352877.5992428334, -1354615.6626388268, -1351517.925035784, -1350395.7720792037, -1355468.214768313, -1350950.9235178346, -1349461.9810155102, -1353244.1483122527, -1351773.7359352622, -1354580.862936983, -1353454.3955520217, -1351924.6931606017, -1349349.7745003805, -1349310.0333108394, -1355562.6956711074, -1351184.5654083667, -1356438.3696041456, -1351573.5012043987, -1353129.6330961955, -1355215.5180250898, -1356522.3907284164, -1351890.9147890166, -1353320.3813771496, -1351367.9248604018, -1356035.0993225917, -1351131.9822143805, -1348610.8719291363, -1354320.7213656737, -1352995.0131891116, -1350596.607439688, -1349649.3172129309, -1351126.277908477, -1353786.0357700172, -1349201.5908966495, -1358823.0310423607, -1350193.6772378606], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.14024063344457074, "mean_inference_ms": 0.24618302580986495, "mean_action_processing_ms": 0.05911921033171331, "mean_env_wait_ms": 0.4656237916695026, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0023936572140210296, "StateBufferConnector_ms": 0.0017456812401340433, "ViewRequirementAgentConnector_ms": 0.04533316991100573}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 4454160, "num_agent_steps_trained": 4454160, "num_env_steps_sampled": 4454160, "num_env_steps_trained": 4454160, "num_env_steps_sampled_this_iter": 43920, "num_env_steps_trained_this_iter": 43920, "num_env_steps_sampled_throughput_per_sec": 1039.4076295322895, "num_env_steps_trained_throughput_per_sec": 1039.4076295322895, "timesteps_total": 4454160, "num_steps_trained_this_iter": 43920, "agent_timesteps_total": 4454160, "timers": {"training_iteration_time_ms": 41829.915, "sample_time_ms": 41001.691, "load_time_ms": 13.595, "load_throughput": 3230518.066, "learn_time_ms": 813.769, "learn_throughput": 53971.118, "synch_weights_time_ms": 0.732}, "counters": {"num_env_steps_sampled": 4454160, "num_env_steps_trained": 4454160, "num_agent_steps_sampled": 4454160, "num_agent_steps_trained": 4454160}, "done": false, "episodes_total": 1292, "training_iteration": 413, "trial_id": "d8b7e_00000", "date": "2023-07-27_06-00-06", "timestamp": 1690426806, "time_this_iter_s": 42.25701713562012, "time_total_s": 7601.006420612335, "pid": 18921, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 366, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[1291920, 5e-05], [1731120, 8e-05], [2170320, 2.5e-05], [2609520, 2.5e-05], [3048720, 2.5e-05], [3487920, 2.5e-05], [3927120, 1e-05], [4366320, 1e-05], [4805520, 1e-05], [5244720, 5e-06], [5683920, 5e-06], [6123120, 5e-06], [6562320, 5e-06], [7001520, 1e-06], [7440720, 1e-06], [7879920, 1e-06], [8319120, 1e-06], [8758320, 5e-07], [9197520, 5e-07], [9636720, 2.5e-07], [10075920, 2.5e-07], [10515120, 1e-08], [10954320, 1e-08], [11393520, 5e-09], [11832720, 5e-09], [12271920, 1e-09]], "grad_clip": 0.5, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.1, "final_epsilon": 0.01, "epsilon_timesteps": 1387080}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 43920, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x16b7b79d0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 2933.4616627693176, "iterations_since_restore": 73, "perf": {"cpu_util_percent": 18.331666666666663, "ram_util_percent": 69.15833333333333}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-05, "entropy_coeff": 0.049999999999999996, "policy_entropy": -1403.2265039560746, "policy_loss": -2.4257737096864973e+19, "vf_loss": 302828193.4110787}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 50421.5, "diff_num_grad_updates_vs_sampler_policy": 50420.5}}, "num_env_steps_sampled": 4498080, "num_env_steps_trained": 4498080, "num_agent_steps_sampled": 4498080, "num_agent_steps_trained": 4498080}, "sampler_results": {"episode_reward_max": -1348610.8719291363, "episode_reward_min": -1369366.2314788997, "episode_reward_mean": -1352940.7949056989, "episode_len_mean": 43920.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1369366.2314788997, -1361335.2082701626, -1354747.2510403998, -1351385.668151872, -1353878.0036070035, -1353934.4440263135, -1349299.1822382265, -1352848.977192731, -1354881.8648155385, -1350293.381402571, -1351982.609620888, -1355148.9106643137, -1353355.7607168008, -1351316.0660699722, -1348824.8954038802, -1353463.9545051646, -1350201.1795549188, -1352786.6794055027, -1352053.2572481462, -1352558.3135243794, -1358466.517990561, -1351346.3540966634, -1351505.6693919636, -1353330.2319483531, -1351757.3621417605, -1351111.1344867356, -1352960.1558008753, -1353830.0290992912, -1352774.403007062, -1353239.1979867364, -1351903.1794592983, -1353195.1205072168, -1350544.7864785872, -1351714.7076935158, -1353808.3265127144, -1354467.1794068213, -1354455.2950085176, -1352877.5992428334, -1354615.6626388268, -1351517.925035784, -1350395.7720792037, -1355468.214768313, -1350950.9235178346, -1349461.9810155102, -1353244.1483122527, -1351773.7359352622, -1354580.862936983, -1353454.3955520217, -1351924.6931606017, -1349349.7745003805, -1349310.0333108394, -1355562.6956711074, -1351184.5654083667, -1356438.3696041456, -1351573.5012043987, -1353129.6330961955, -1355215.5180250898, -1356522.3907284164, -1351890.9147890166, -1353320.3813771496, -1351367.9248604018, -1356035.0993225917, -1351131.9822143805, -1348610.8719291363, -1354320.7213656737, -1352995.0131891116, -1350596.607439688, -1349649.3172129309, -1351126.277908477, -1353786.0357700172, -1349201.5908966495, -1358823.0310423607, -1350193.6772378606, -1351945.4907675462], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.14020587938804466, "mean_inference_ms": 0.24607892778040083, "mean_action_processing_ms": 0.05910505222721, "mean_env_wait_ms": 0.46542953834539125, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002401261716275602, "StateBufferConnector_ms": 0.0017465771855534734, "ViewRequirementAgentConnector_ms": 0.045348824681462466}}, "episode_reward_max": -1348610.8719291363, "episode_reward_min": -1369366.2314788997, "episode_reward_mean": -1352940.7949056989, "episode_len_mean": 43920.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1369366.2314788997, -1361335.2082701626, -1354747.2510403998, -1351385.668151872, -1353878.0036070035, -1353934.4440263135, -1349299.1822382265, -1352848.977192731, -1354881.8648155385, -1350293.381402571, -1351982.609620888, -1355148.9106643137, -1353355.7607168008, -1351316.0660699722, -1348824.8954038802, -1353463.9545051646, -1350201.1795549188, -1352786.6794055027, -1352053.2572481462, -1352558.3135243794, -1358466.517990561, -1351346.3540966634, -1351505.6693919636, -1353330.2319483531, -1351757.3621417605, -1351111.1344867356, -1352960.1558008753, -1353830.0290992912, -1352774.403007062, -1353239.1979867364, -1351903.1794592983, -1353195.1205072168, -1350544.7864785872, -1351714.7076935158, -1353808.3265127144, -1354467.1794068213, -1354455.2950085176, -1352877.5992428334, -1354615.6626388268, -1351517.925035784, -1350395.7720792037, -1355468.214768313, -1350950.9235178346, -1349461.9810155102, -1353244.1483122527, -1351773.7359352622, -1354580.862936983, -1353454.3955520217, -1351924.6931606017, -1349349.7745003805, -1349310.0333108394, -1355562.6956711074, -1351184.5654083667, -1356438.3696041456, -1351573.5012043987, -1353129.6330961955, -1355215.5180250898, -1356522.3907284164, -1351890.9147890166, -1353320.3813771496, -1351367.9248604018, -1356035.0993225917, -1351131.9822143805, -1348610.8719291363, -1354320.7213656737, -1352995.0131891116, -1350596.607439688, -1349649.3172129309, -1351126.277908477, -1353786.0357700172, -1349201.5908966495, -1358823.0310423607, -1350193.6772378606, -1351945.4907675462], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.14020587938804466, "mean_inference_ms": 0.24607892778040083, "mean_action_processing_ms": 0.05910505222721, "mean_env_wait_ms": 0.46542953834539125, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002401261716275602, "StateBufferConnector_ms": 0.0017465771855534734, "ViewRequirementAgentConnector_ms": 0.045348824681462466}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 4498080, "num_agent_steps_trained": 4498080, "num_env_steps_sampled": 4498080, "num_env_steps_trained": 4498080, "num_env_steps_sampled_this_iter": 43920, "num_env_steps_trained_this_iter": 43920, "num_env_steps_sampled_throughput_per_sec": 1028.8724828754187, "num_env_steps_trained_throughput_per_sec": 1028.8724828754187, "timesteps_total": 4498080, "num_steps_trained_this_iter": 43920, "agent_timesteps_total": 4498080, "timers": {"training_iteration_time_ms": 42159.586, "sample_time_ms": 41321.411, "load_time_ms": 13.674, "load_throughput": 3212019.788, "learn_time_ms": 823.632, "learn_throughput": 53324.807, "synch_weights_time_ms": 0.741}, "counters": {"num_env_steps_sampled": 4498080, "num_env_steps_trained": 4498080, "num_agent_steps_sampled": 4498080, "num_agent_steps_trained": 4498080}, "done": false, "episodes_total": 1293, "training_iteration": 414, "trial_id": "d8b7e_00000", "date": "2023-07-27_06-00-49", "timestamp": 1690426849, "time_this_iter_s": 42.68976616859436, "time_total_s": 7643.69618678093, "pid": 18921, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 366, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[1291920, 5e-05], [1731120, 8e-05], [2170320, 2.5e-05], [2609520, 2.5e-05], [3048720, 2.5e-05], [3487920, 2.5e-05], [3927120, 1e-05], [4366320, 1e-05], [4805520, 1e-05], [5244720, 5e-06], [5683920, 5e-06], [6123120, 5e-06], [6562320, 5e-06], [7001520, 1e-06], [7440720, 1e-06], [7879920, 1e-06], [8319120, 1e-06], [8758320, 5e-07], [9197520, 5e-07], [9636720, 2.5e-07], [10075920, 2.5e-07], [10515120, 1e-08], [10954320, 1e-08], [11393520, 5e-09], [11832720, 5e-09], [12271920, 1e-09]], "grad_clip": 0.5, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.1, "final_epsilon": 0.01, "epsilon_timesteps": 1387080}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 43920, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x16b7b79d0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 2976.151428937912, "iterations_since_restore": 74, "perf": {"cpu_util_percent": 19.19, "ram_util_percent": 69.135}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-05, "entropy_coeff": 0.049999999999999996, "policy_entropy": -1377.8187601072796, "policy_loss": -1.1917301802831278e+19, "vf_loss": 301198862.28571427}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 51107.5, "diff_num_grad_updates_vs_sampler_policy": 51106.5}}, "num_env_steps_sampled": 4542000, "num_env_steps_trained": 4542000, "num_agent_steps_sampled": 4542000, "num_agent_steps_trained": 4542000}, "sampler_results": {"episode_reward_max": -1348114.0124051112, "episode_reward_min": -1369366.2314788997, "episode_reward_mean": -1352876.437805691, "episode_len_mean": 43920.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1369366.2314788997, -1361335.2082701626, -1354747.2510403998, -1351385.668151872, -1353878.0036070035, -1353934.4440263135, -1349299.1822382265, -1352848.977192731, -1354881.8648155385, -1350293.381402571, -1351982.609620888, -1355148.9106643137, -1353355.7607168008, -1351316.0660699722, -1348824.8954038802, -1353463.9545051646, -1350201.1795549188, -1352786.6794055027, -1352053.2572481462, -1352558.3135243794, -1358466.517990561, -1351346.3540966634, -1351505.6693919636, -1353330.2319483531, -1351757.3621417605, -1351111.1344867356, -1352960.1558008753, -1353830.0290992912, -1352774.403007062, -1353239.1979867364, -1351903.1794592983, -1353195.1205072168, -1350544.7864785872, -1351714.7076935158, -1353808.3265127144, -1354467.1794068213, -1354455.2950085176, -1352877.5992428334, -1354615.6626388268, -1351517.925035784, -1350395.7720792037, -1355468.214768313, -1350950.9235178346, -1349461.9810155102, -1353244.1483122527, -1351773.7359352622, -1354580.862936983, -1353454.3955520217, -1351924.6931606017, -1349349.7745003805, -1349310.0333108394, -1355562.6956711074, -1351184.5654083667, -1356438.3696041456, -1351573.5012043987, -1353129.6330961955, -1355215.5180250898, -1356522.3907284164, -1351890.9147890166, -1353320.3813771496, -1351367.9248604018, -1356035.0993225917, -1351131.9822143805, -1348610.8719291363, -1354320.7213656737, -1352995.0131891116, -1350596.607439688, -1349649.3172129309, -1351126.277908477, -1353786.0357700172, -1349201.5908966495, -1358823.0310423607, -1350193.6772378606, -1351945.4907675462, -1348114.0124051112], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.14017393941367226, "mean_inference_ms": 0.24597936692305505, "mean_action_processing_ms": 0.059091804167683185, "mean_env_wait_ms": 0.4652429839223136, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002399444580078125, "StateBufferConnector_ms": 0.0017496744791666667, "ViewRequirementAgentConnector_ms": 0.045364061991373696}}, "episode_reward_max": -1348114.0124051112, "episode_reward_min": -1369366.2314788997, "episode_reward_mean": -1352876.437805691, "episode_len_mean": 43920.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1369366.2314788997, -1361335.2082701626, -1354747.2510403998, -1351385.668151872, -1353878.0036070035, -1353934.4440263135, -1349299.1822382265, -1352848.977192731, -1354881.8648155385, -1350293.381402571, -1351982.609620888, -1355148.9106643137, -1353355.7607168008, -1351316.0660699722, -1348824.8954038802, -1353463.9545051646, -1350201.1795549188, -1352786.6794055027, -1352053.2572481462, -1352558.3135243794, -1358466.517990561, -1351346.3540966634, -1351505.6693919636, -1353330.2319483531, -1351757.3621417605, -1351111.1344867356, -1352960.1558008753, -1353830.0290992912, -1352774.403007062, -1353239.1979867364, -1351903.1794592983, -1353195.1205072168, -1350544.7864785872, -1351714.7076935158, -1353808.3265127144, -1354467.1794068213, -1354455.2950085176, -1352877.5992428334, -1354615.6626388268, -1351517.925035784, -1350395.7720792037, -1355468.214768313, -1350950.9235178346, -1349461.9810155102, -1353244.1483122527, -1351773.7359352622, -1354580.862936983, -1353454.3955520217, -1351924.6931606017, -1349349.7745003805, -1349310.0333108394, -1355562.6956711074, -1351184.5654083667, -1356438.3696041456, -1351573.5012043987, -1353129.6330961955, -1355215.5180250898, -1356522.3907284164, -1351890.9147890166, -1353320.3813771496, -1351367.9248604018, -1356035.0993225917, -1351131.9822143805, -1348610.8719291363, -1354320.7213656737, -1352995.0131891116, -1350596.607439688, -1349649.3172129309, -1351126.277908477, -1353786.0357700172, -1349201.5908966495, -1358823.0310423607, -1350193.6772378606, -1351945.4907675462, -1348114.0124051112], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.14017393941367226, "mean_inference_ms": 0.24597936692305505, "mean_action_processing_ms": 0.059091804167683185, "mean_env_wait_ms": 0.4652429839223136, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002399444580078125, "StateBufferConnector_ms": 0.0017496744791666667, "ViewRequirementAgentConnector_ms": 0.045364061991373696}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 4542000, "num_agent_steps_trained": 4542000, "num_env_steps_sampled": 4542000, "num_env_steps_trained": 4542000, "num_env_steps_sampled_this_iter": 43920, "num_env_steps_trained_this_iter": 43920, "num_env_steps_sampled_throughput_per_sec": 1047.4697412580088, "num_env_steps_trained_throughput_per_sec": 1047.4697412580088, "timesteps_total": 4542000, "num_steps_trained_this_iter": 43920, "agent_timesteps_total": 4542000, "timers": {"training_iteration_time_ms": 42436.405, "sample_time_ms": 41592.259, "load_time_ms": 13.794, "load_throughput": 3184071.705, "learn_time_ms": 829.477, "learn_throughput": 52949.047, "synch_weights_time_ms": 0.745}, "counters": {"num_env_steps_sampled": 4542000, "num_env_steps_trained": 4542000, "num_agent_steps_sampled": 4542000, "num_agent_steps_trained": 4542000}, "done": false, "episodes_total": 1294, "training_iteration": 415, "trial_id": "d8b7e_00000", "date": "2023-07-27_06-01-31", "timestamp": 1690426891, "time_this_iter_s": 41.93167996406555, "time_total_s": 7685.627866744995, "pid": 18921, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 366, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[1291920, 5e-05], [1731120, 8e-05], [2170320, 2.5e-05], [2609520, 2.5e-05], [3048720, 2.5e-05], [3487920, 2.5e-05], [3927120, 1e-05], [4366320, 1e-05], [4805520, 1e-05], [5244720, 5e-06], [5683920, 5e-06], [6123120, 5e-06], [6562320, 5e-06], [7001520, 1e-06], [7440720, 1e-06], [7879920, 1e-06], [8319120, 1e-06], [8758320, 5e-07], [9197520, 5e-07], [9636720, 2.5e-07], [10075920, 2.5e-07], [10515120, 1e-08], [10954320, 1e-08], [11393520, 5e-09], [11832720, 5e-09], [12271920, 1e-09]], "grad_clip": 0.5, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.1, "final_epsilon": 0.01, "epsilon_timesteps": 1387080}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 43920, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x16b7b79d0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 3018.0831089019775, "iterations_since_restore": 75, "perf": {"cpu_util_percent": 18.413333333333338, "ram_util_percent": 69.11166666666666}}
