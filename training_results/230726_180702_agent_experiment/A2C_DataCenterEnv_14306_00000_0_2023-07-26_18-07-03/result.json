{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-08, "entropy_coeff": 0.05, "policy_entropy": -345.0190063476563, "policy_loss": -46731380.6, "vf_loss": 7878442.35}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 13.0, "diff_num_grad_updates_vs_sampler_policy": 12.0}}, "num_env_steps_sampled": 121080, "num_env_steps_trained": 121080, "num_agent_steps_sampled": 121080, "num_agent_steps_trained": 121080}, "sampler_results": {"episode_reward_max": -2056.15284991328, "episode_reward_min": -2119.171799360851, "episode_reward_mean": -2096.552050730536, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-2119.171799360851, -2114.331502917478, -2056.15284991328], "episode_lengths": [360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.533698254002122, "mean_inference_ms": 0.43108019974361844, "mean_action_processing_ms": 0.10363069758384343, "mean_env_wait_ms": 4.070503418363982, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005094210306803386, "StateBufferConnector_ms": 0.005253156026204427, "ViewRequirementAgentConnector_ms": 0.10164578755696614}}, "episode_reward_max": -2056.15284991328, "episode_reward_min": -2119.171799360851, "episode_reward_mean": -2096.552050730536, "episode_len_mean": 360.0, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-2119.171799360851, -2114.331502917478, -2056.15284991328], "episode_lengths": [360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.533698254002122, "mean_inference_ms": 0.43108019974361844, "mean_action_processing_ms": 0.10363069758384343, "mean_env_wait_ms": 4.070503418363982, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005094210306803386, "StateBufferConnector_ms": 0.005253156026204427, "ViewRequirementAgentConnector_ms": 0.10164578755696614}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 121080, "num_agent_steps_trained": 121080, "num_env_steps_sampled": 121080, "num_env_steps_trained": 121080, "num_env_steps_sampled_this_iter": 1080, "num_env_steps_trained_this_iter": 1080, "num_env_steps_sampled_throughput_per_sec": 81.72807146181017, "num_env_steps_trained_throughput_per_sec": 81.72807146181017, "timesteps_total": 121080, "num_steps_trained_this_iter": 1080, "agent_timesteps_total": 121080, "timers": {"training_iteration_time_ms": 4404.832, "sample_time_ms": 4386.204, "load_time_ms": 0.537, "load_throughput": 670989.234, "learn_time_ms": 17.199, "learn_throughput": 20931.788, "synch_weights_time_ms": 0.831}, "counters": {"num_env_steps_sampled": 121080, "num_env_steps_trained": 121080, "num_agent_steps_sampled": 121080, "num_agent_steps_trained": 121080}, "done": false, "episodes_total": 817, "training_iteration": 161, "trial_id": "14306_00000", "date": "2023-07-26_18-07-23", "timestamp": 1690384043, "time_this_iter_s": 13.21706771850586, "time_total_s": 1743.0477945804596, "pid": 7707, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[131310, 5e-05], [136710, 8e-05], [142110, 2.5e-05], [147510, 2.5e-05], [152910, 2.5e-05], [158310, 2.5e-05], [163710, 1e-05], [169110, 1e-05], [174510, 1e-05], [179910, 5e-06], [185310, 5e-06], [190710, 5e-06], [196110, 5e-06], [201510, 1e-06], [206910, 1e-06], [212310, 1e-06], [217710, 1e-06], [223110, 5e-07], [228510, 5e-07], [233910, 2.5e-07], [239310, 2.5e-07], [244710, 1e-07], [250110, 1e-07], [255510, 5e-08], [260910, 5e-08], [266310, 1e-08]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.15, "final_epsilon": 0.05, "epsilon_timesteps": 264960}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x14a3b79d0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 13.21706771850586, "iterations_since_restore": 1, "perf": {"cpu_util_percent": 29.410526315789472, "ram_util_percent": 58.08421052631579}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-08, "entropy_coeff": 0.05, "policy_entropy": -345.1576232910156, "policy_loss": -29240413.3, "vf_loss": 5547905.5}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 28.0, "diff_num_grad_updates_vs_sampler_policy": 27.0}}, "num_env_steps_sampled": 122160, "num_env_steps_trained": 122160, "num_agent_steps_sampled": 122160, "num_agent_steps_trained": 122160}, "sampler_results": {"episode_reward_max": -1783.6167235197013, "episode_reward_min": -2205.7189272174583, "episode_reward_mean": -2063.052788035854, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-2119.171799360851, -2114.331502917478, -2056.15284991328, -2205.7189272174583, -2099.324925286358, -1783.6167235197013], "episode_lengths": [360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.542577421994987, "mean_inference_ms": 0.42530658004538174, "mean_action_processing_ms": 0.10236383870985159, "mean_env_wait_ms": 3.3952454553732956, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0047524770100911455, "StateBufferConnector_ms": 0.004080931345621745, "ViewRequirementAgentConnector_ms": 0.08540550867716472}}, "episode_reward_max": -1783.6167235197013, "episode_reward_min": -2205.7189272174583, "episode_reward_mean": -2063.052788035854, "episode_len_mean": 360.0, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-2119.171799360851, -2114.331502917478, -2056.15284991328, -2205.7189272174583, -2099.324925286358, -1783.6167235197013], "episode_lengths": [360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.542577421994987, "mean_inference_ms": 0.42530658004538174, "mean_action_processing_ms": 0.10236383870985159, "mean_env_wait_ms": 3.3952454553732956, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0047524770100911455, "StateBufferConnector_ms": 0.004080931345621745, "ViewRequirementAgentConnector_ms": 0.08540550867716472}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 122160, "num_agent_steps_trained": 122160, "num_env_steps_sampled": 122160, "num_env_steps_trained": 122160, "num_env_steps_sampled_this_iter": 1080, "num_env_steps_trained_this_iter": 1080, "num_env_steps_sampled_throughput_per_sec": 105.20245706359334, "num_env_steps_trained_throughput_per_sec": 105.20245706359334, "timesteps_total": 122160, "num_steps_trained_this_iter": 1080, "agent_timesteps_total": 122160, "timers": {"training_iteration_time_ms": 3913.396, "sample_time_ms": 3898.368, "load_time_ms": 0.417, "load_throughput": 862992.631, "learn_time_ms": 13.766, "learn_throughput": 26151.82, "synch_weights_time_ms": 0.793}, "counters": {"num_env_steps_sampled": 122160, "num_env_steps_trained": 122160, "num_agent_steps_sampled": 122160, "num_agent_steps_trained": 122160}, "done": false, "episodes_total": 820, "training_iteration": 162, "trial_id": "14306_00000", "date": "2023-07-26_18-07-33", "timestamp": 1690384053, "time_this_iter_s": 10.268457889556885, "time_total_s": 1753.3162524700165, "pid": 7707, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[131310, 5e-05], [136710, 8e-05], [142110, 2.5e-05], [147510, 2.5e-05], [152910, 2.5e-05], [158310, 2.5e-05], [163710, 1e-05], [169110, 1e-05], [174510, 1e-05], [179910, 5e-06], [185310, 5e-06], [190710, 5e-06], [196110, 5e-06], [201510, 1e-06], [206910, 1e-06], [212310, 1e-06], [217710, 1e-06], [223110, 5e-07], [228510, 5e-07], [233910, 2.5e-07], [239310, 2.5e-07], [244710, 1e-07], [250110, 1e-07], [255510, 5e-08], [260910, 5e-08], [266310, 1e-08]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.15, "final_epsilon": 0.05, "epsilon_timesteps": 264960}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x14a3b79d0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 23.485525608062744, "iterations_since_restore": 2, "perf": {"cpu_util_percent": 29.106666666666666, "ram_util_percent": 58.533333333333324}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-08, "entropy_coeff": 0.05, "policy_entropy": -345.1986450195312, "policy_loss": -27932168.2, "vf_loss": 7098884.5}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 43.0, "diff_num_grad_updates_vs_sampler_policy": 42.0}}, "num_env_steps_sampled": 123240, "num_env_steps_trained": 123240, "num_agent_steps_sampled": 123240, "num_agent_steps_trained": 123240}, "sampler_results": {"episode_reward_max": -1783.6167235197013, "episode_reward_min": -2205.7189272174583, "episode_reward_mean": -2063.168190124432, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-2119.171799360851, -2114.331502917478, -2056.15284991328, -2205.7189272174583, -2099.324925286358, -1783.6167235197013, -2198.8005148640627, -1959.4255405533393, -2031.9709274873644], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.564130779017083, "mean_inference_ms": 0.420365561426757, "mean_action_processing_ms": 0.10139051482123394, "mean_env_wait_ms": 3.022276567214951, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0042650434705946184, "StateBufferConnector_ms": 0.0036795934041341147, "ViewRequirementAgentConnector_ms": 0.07985168033175999}}, "episode_reward_max": -1783.6167235197013, "episode_reward_min": -2205.7189272174583, "episode_reward_mean": -2063.168190124432, "episode_len_mean": 360.0, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-2119.171799360851, -2114.331502917478, -2056.15284991328, -2205.7189272174583, -2099.324925286358, -1783.6167235197013, -2198.8005148640627, -1959.4255405533393, -2031.9709274873644], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.564130779017083, "mean_inference_ms": 0.420365561426757, "mean_action_processing_ms": 0.10139051482123394, "mean_env_wait_ms": 3.022276567214951, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0042650434705946184, "StateBufferConnector_ms": 0.0036795934041341147, "ViewRequirementAgentConnector_ms": 0.07985168033175999}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 123240, "num_agent_steps_trained": 123240, "num_env_steps_sampled": 123240, "num_env_steps_trained": 123240, "num_env_steps_sampled_this_iter": 1080, "num_env_steps_trained_this_iter": 1080, "num_env_steps_sampled_throughput_per_sec": 103.50872319839777, "num_env_steps_trained_throughput_per_sec": 103.50872319839777, "timesteps_total": 123240, "num_steps_trained_this_iter": 1080, "agent_timesteps_total": 123240, "timers": {"training_iteration_time_ms": 3768.248, "sample_time_ms": 3754.073, "load_time_ms": 0.379, "load_throughput": 950450.76, "learn_time_ms": 12.95, "learn_throughput": 27799.349, "synch_weights_time_ms": 0.797}, "counters": {"num_env_steps_sampled": 123240, "num_env_steps_trained": 123240, "num_agent_steps_sampled": 123240, "num_agent_steps_trained": 123240}, "done": false, "episodes_total": 823, "training_iteration": 163, "trial_id": "14306_00000", "date": "2023-07-26_18-07-43", "timestamp": 1690384063, "time_this_iter_s": 10.436622142791748, "time_total_s": 1763.7528746128082, "pid": 7707, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[131310, 5e-05], [136710, 8e-05], [142110, 2.5e-05], [147510, 2.5e-05], [152910, 2.5e-05], [158310, 2.5e-05], [163710, 1e-05], [169110, 1e-05], [174510, 1e-05], [179910, 5e-06], [185310, 5e-06], [190710, 5e-06], [196110, 5e-06], [201510, 1e-06], [206910, 1e-06], [212310, 1e-06], [217710, 1e-06], [223110, 5e-07], [228510, 5e-07], [233910, 2.5e-07], [239310, 2.5e-07], [244710, 1e-07], [250110, 1e-07], [255510, 5e-08], [260910, 5e-08], [266310, 1e-08]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.15, "final_epsilon": 0.05, "epsilon_timesteps": 264960}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x14a3b79d0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 33.92214775085449, "iterations_since_restore": 3, "perf": {"cpu_util_percent": 26.926666666666666, "ram_util_percent": 58.54}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-08, "entropy_coeff": 0.05, "policy_entropy": -345.20155639648436, "policy_loss": -24827068.4, "vf_loss": 5373681.2}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 58.0, "diff_num_grad_updates_vs_sampler_policy": 57.0}}, "num_env_steps_sampled": 124320, "num_env_steps_trained": 124320, "num_agent_steps_sampled": 124320, "num_agent_steps_trained": 124320}, "sampler_results": {"episode_reward_max": -1732.3916216536554, "episode_reward_min": -2205.7189272174583, "episode_reward_mean": -2026.3144462093087, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-2119.171799360851, -2114.331502917478, -2056.15284991328, -2205.7189272174583, -2099.324925286358, -1783.6167235197013, -2198.8005148640627, -1959.4255405533393, -2031.9709274873644, -2146.934807250676, -1867.9332144874832, -1732.3916216536554], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.567784309649832, "mean_inference_ms": 0.4177007597019358, "mean_action_processing_ms": 0.10089520897487403, "mean_env_wait_ms": 2.776988748418393, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004329284032185872, "StateBufferConnector_ms": 0.003532568613688151, "ViewRequirementAgentConnector_ms": 0.07742444674173991}}, "episode_reward_max": -1732.3916216536554, "episode_reward_min": -2205.7189272174583, "episode_reward_mean": -2026.3144462093087, "episode_len_mean": 360.0, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-2119.171799360851, -2114.331502917478, -2056.15284991328, -2205.7189272174583, -2099.324925286358, -1783.6167235197013, -2198.8005148640627, -1959.4255405533393, -2031.9709274873644, -2146.934807250676, -1867.9332144874832, -1732.3916216536554], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.567784309649832, "mean_inference_ms": 0.4177007597019358, "mean_action_processing_ms": 0.10089520897487403, "mean_env_wait_ms": 2.776988748418393, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004329284032185872, "StateBufferConnector_ms": 0.003532568613688151, "ViewRequirementAgentConnector_ms": 0.07742444674173991}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 124320, "num_agent_steps_trained": 124320, "num_env_steps_sampled": 124320, "num_env_steps_trained": 124320, "num_env_steps_sampled_this_iter": 1080, "num_env_steps_trained_this_iter": 1080, "num_env_steps_sampled_throughput_per_sec": 106.43178023098584, "num_env_steps_trained_throughput_per_sec": 106.43178023098584, "timesteps_total": 124320, "num_steps_trained_this_iter": 1080, "agent_timesteps_total": 124320, "timers": {"training_iteration_time_ms": 3433.161, "sample_time_ms": 3421.507, "load_time_ms": 0.301, "load_throughput": 1197137.43, "learn_time_ms": 10.542, "learn_throughput": 34147.614, "synch_weights_time_ms": 0.768}, "counters": {"num_env_steps_sampled": 124320, "num_env_steps_trained": 124320, "num_agent_steps_sampled": 124320, "num_agent_steps_trained": 124320}, "done": false, "episodes_total": 826, "training_iteration": 164, "trial_id": "14306_00000", "date": "2023-07-26_18-07-54", "timestamp": 1690384074, "time_this_iter_s": 10.150266170501709, "time_total_s": 1773.90314078331, "pid": 7707, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[131310, 5e-05], [136710, 8e-05], [142110, 2.5e-05], [147510, 2.5e-05], [152910, 2.5e-05], [158310, 2.5e-05], [163710, 1e-05], [169110, 1e-05], [174510, 1e-05], [179910, 5e-06], [185310, 5e-06], [190710, 5e-06], [196110, 5e-06], [201510, 1e-06], [206910, 1e-06], [212310, 1e-06], [217710, 1e-06], [223110, 5e-07], [228510, 5e-07], [233910, 2.5e-07], [239310, 2.5e-07], [244710, 1e-07], [250110, 1e-07], [255510, 5e-08], [260910, 5e-08], [266310, 1e-08]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.15, "final_epsilon": 0.05, "epsilon_timesteps": 264960}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x14a3b79d0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 44.0724139213562, "iterations_since_restore": 4, "perf": {"cpu_util_percent": 26.72142857142857, "ram_util_percent": 58.25}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-08, "entropy_coeff": 0.05, "policy_entropy": -345.2696899414062, "policy_loss": -27581379.5, "vf_loss": 6206627.4}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 73.0, "diff_num_grad_updates_vs_sampler_policy": 72.0}}, "num_env_steps_sampled": 125400, "num_env_steps_trained": 125400, "num_agent_steps_sampled": 125400, "num_agent_steps_trained": 125400}, "sampler_results": {"episode_reward_max": -1732.3916216536554, "episode_reward_min": -2234.2070943633057, "episode_reward_mean": -2022.8733093539208, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-2119.171799360851, -2114.331502917478, -2056.15284991328, -2205.7189272174583, -2099.324925286358, -1783.6167235197013, -2198.8005148640627, -1959.4255405533393, -2031.9709274873644, -2146.934807250676, -1867.9332144874832, -1732.3916216536554, -2234.2070943633057, -1983.003248740253, -1810.115942693552], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.563033288248665, "mean_inference_ms": 0.41554653119554996, "mean_action_processing_ms": 0.10049538309658423, "mean_env_wait_ms": 2.6037646714918474, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004115104675292969, "StateBufferConnector_ms": 0.0034062067667643228, "ViewRequirementAgentConnector_ms": 0.07510185241699219}}, "episode_reward_max": -1732.3916216536554, "episode_reward_min": -2234.2070943633057, "episode_reward_mean": -2022.8733093539208, "episode_len_mean": 360.0, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-2119.171799360851, -2114.331502917478, -2056.15284991328, -2205.7189272174583, -2099.324925286358, -1783.6167235197013, -2198.8005148640627, -1959.4255405533393, -2031.9709274873644, -2146.934807250676, -1867.9332144874832, -1732.3916216536554, -2234.2070943633057, -1983.003248740253, -1810.115942693552], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.563033288248665, "mean_inference_ms": 0.41554653119554996, "mean_action_processing_ms": 0.10049538309658423, "mean_env_wait_ms": 2.6037646714918474, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004115104675292969, "StateBufferConnector_ms": 0.0034062067667643228, "ViewRequirementAgentConnector_ms": 0.07510185241699219}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 125400, "num_agent_steps_trained": 125400, "num_env_steps_sampled": 125400, "num_env_steps_trained": 125400, "num_env_steps_sampled_this_iter": 1080, "num_env_steps_trained_this_iter": 1080, "num_env_steps_sampled_throughput_per_sec": 106.9469876486967, "num_env_steps_trained_throughput_per_sec": 106.9469876486967, "timesteps_total": 125400, "num_steps_trained_this_iter": 1080, "agent_timesteps_total": 125400, "timers": {"training_iteration_time_ms": 3406.105, "sample_time_ms": 3394.414, "load_time_ms": 0.307, "load_throughput": 1173140.735, "learn_time_ms": 10.586, "learn_throughput": 34006.492, "synch_weights_time_ms": 0.753}, "counters": {"num_env_steps_sampled": 125400, "num_env_steps_trained": 125400, "num_agent_steps_sampled": 125400, "num_agent_steps_trained": 125400}, "done": false, "episodes_total": 829, "training_iteration": 165, "trial_id": "14306_00000", "date": "2023-07-26_18-08-04", "timestamp": 1690384084, "time_this_iter_s": 10.10111403465271, "time_total_s": 1784.0042548179626, "pid": 7707, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[131310, 5e-05], [136710, 8e-05], [142110, 2.5e-05], [147510, 2.5e-05], [152910, 2.5e-05], [158310, 2.5e-05], [163710, 1e-05], [169110, 1e-05], [174510, 1e-05], [179910, 5e-06], [185310, 5e-06], [190710, 5e-06], [196110, 5e-06], [201510, 1e-06], [206910, 1e-06], [212310, 1e-06], [217710, 1e-06], [223110, 5e-07], [228510, 5e-07], [233910, 2.5e-07], [239310, 2.5e-07], [244710, 1e-07], [250110, 1e-07], [255510, 5e-08], [260910, 5e-08], [266310, 1e-08]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.15, "final_epsilon": 0.05, "epsilon_timesteps": 264960}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x14a3b79d0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 54.17352795600891, "iterations_since_restore": 5, "perf": {"cpu_util_percent": 29.059999999999995, "ram_util_percent": 58.04666666666666}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-08, "entropy_coeff": 0.05, "policy_entropy": -345.14423828125, "policy_loss": -36969361.4, "vf_loss": 5155554.5}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 93.0, "diff_num_grad_updates_vs_sampler_policy": 92.0}}, "num_env_steps_sampled": 126840, "num_env_steps_trained": 126840, "num_agent_steps_sampled": 126840, "num_agent_steps_trained": 126840}, "sampler_results": {"episode_reward_max": -1732.3916216536554, "episode_reward_min": -2234.2070943633057, "episode_reward_mean": -2012.3785939619647, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-2119.171799360851, -2114.331502917478, -2056.15284991328, -2205.7189272174583, -2099.324925286358, -1783.6167235197013, -2198.8005148640627, -1959.4255405533393, -2031.9709274873644, -2146.934807250676, -1867.9332144874832, -1732.3916216536554, -2234.2070943633057, -1983.003248740253, -1810.115942693552, -1880.740363158521, -2051.0059405638153, -2099.0961425143632, -1861.2511987318119], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.551370209570525, "mean_inference_ms": 0.41328520424067, "mean_action_processing_ms": 0.10007025070605183, "mean_env_wait_ms": 2.430294409426491, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0041961669921875, "StateBufferConnector_ms": 0.003321547257272821, "ViewRequirementAgentConnector_ms": 0.07341284500925165}}, "episode_reward_max": -1732.3916216536554, "episode_reward_min": -2234.2070943633057, "episode_reward_mean": -2012.3785939619647, "episode_len_mean": 360.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-2119.171799360851, -2114.331502917478, -2056.15284991328, -2205.7189272174583, -2099.324925286358, -1783.6167235197013, -2198.8005148640627, -1959.4255405533393, -2031.9709274873644, -2146.934807250676, -1867.9332144874832, -1732.3916216536554, -2234.2070943633057, -1983.003248740253, -1810.115942693552, -1880.740363158521, -2051.0059405638153, -2099.0961425143632, -1861.2511987318119], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.551370209570525, "mean_inference_ms": 0.41328520424067, "mean_action_processing_ms": 0.10007025070605183, "mean_env_wait_ms": 2.430294409426491, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0041961669921875, "StateBufferConnector_ms": 0.003321547257272821, "ViewRequirementAgentConnector_ms": 0.07341284500925165}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 126840, "num_agent_steps_trained": 126840, "num_env_steps_sampled": 126840, "num_env_steps_trained": 126840, "num_env_steps_sampled_this_iter": 1440, "num_env_steps_trained_this_iter": 1440, "num_env_steps_sampled_throughput_per_sec": 108.54555976824675, "num_env_steps_trained_throughput_per_sec": 108.54555976824675, "timesteps_total": 126840, "num_steps_trained_this_iter": 1440, "agent_timesteps_total": 126840, "timers": {"training_iteration_time_ms": 3351.198, "sample_time_ms": 3340.001, "load_time_ms": 0.307, "load_throughput": 1173414.237, "learn_time_ms": 10.115, "learn_throughput": 35589.604, "synch_weights_time_ms": 0.731}, "counters": {"num_env_steps_sampled": 126840, "num_env_steps_trained": 126840, "num_agent_steps_sampled": 126840, "num_agent_steps_trained": 126840}, "done": false, "episodes_total": 833, "training_iteration": 166, "trial_id": "14306_00000", "date": "2023-07-26_18-08-17", "timestamp": 1690384097, "time_this_iter_s": 13.269012928009033, "time_total_s": 1797.2732677459717, "pid": 7707, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[131310, 5e-05], [136710, 8e-05], [142110, 2.5e-05], [147510, 2.5e-05], [152910, 2.5e-05], [158310, 2.5e-05], [163710, 1e-05], [169110, 1e-05], [174510, 1e-05], [179910, 5e-06], [185310, 5e-06], [190710, 5e-06], [196110, 5e-06], [201510, 1e-06], [206910, 1e-06], [212310, 1e-06], [217710, 1e-06], [223110, 5e-07], [228510, 5e-07], [233910, 2.5e-07], [239310, 2.5e-07], [244710, 1e-07], [250110, 1e-07], [255510, 5e-08], [260910, 5e-08], [266310, 1e-08]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.15, "final_epsilon": 0.05, "epsilon_timesteps": 264960}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x14a3b79d0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 67.44254088401794, "iterations_since_restore": 6, "perf": {"cpu_util_percent": 26.121052631578948, "ram_util_percent": 58.33684210526315}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-08, "entropy_coeff": 0.05, "policy_entropy": -344.6308166503906, "policy_loss": -31209342.8, "vf_loss": 8031552.65}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 108.0, "diff_num_grad_updates_vs_sampler_policy": 107.0}}, "num_env_steps_sampled": 127920, "num_env_steps_trained": 127920, "num_agent_steps_sampled": 127920, "num_agent_steps_trained": 127920}, "sampler_results": {"episode_reward_max": -1623.6366775976976, "episode_reward_min": -2234.2070943633057, "episode_reward_mean": -1993.7599975416224, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-2119.171799360851, -2114.331502917478, -2056.15284991328, -2205.7189272174583, -2099.324925286358, -1783.6167235197013, -2198.8005148640627, -1959.4255405533393, -2031.9709274873644, -2146.934807250676, -1867.9332144874832, -1732.3916216536554, -2234.2070943633057, -1983.003248740253, -1810.115942693552, -1880.740363158521, -2051.0059405638153, -2099.0961425143632, -1861.2511987318119, -1623.6366775976976, -1833.7213963946356, -2170.1685866460275], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.544042080543093, "mean_inference_ms": 0.41219375923788815, "mean_action_processing_ms": 0.09988866770825461, "mean_env_wait_ms": 2.3321669289550404, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004238432103937323, "StateBufferConnector_ms": 0.003349781036376953, "ViewRequirementAgentConnector_ms": 0.07521022449840199}}, "episode_reward_max": -1623.6366775976976, "episode_reward_min": -2234.2070943633057, "episode_reward_mean": -1993.7599975416224, "episode_len_mean": 360.0, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-2119.171799360851, -2114.331502917478, -2056.15284991328, -2205.7189272174583, -2099.324925286358, -1783.6167235197013, -2198.8005148640627, -1959.4255405533393, -2031.9709274873644, -2146.934807250676, -1867.9332144874832, -1732.3916216536554, -2234.2070943633057, -1983.003248740253, -1810.115942693552, -1880.740363158521, -2051.0059405638153, -2099.0961425143632, -1861.2511987318119, -1623.6366775976976, -1833.7213963946356, -2170.1685866460275], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.544042080543093, "mean_inference_ms": 0.41219375923788815, "mean_action_processing_ms": 0.09988866770825461, "mean_env_wait_ms": 2.3321669289550404, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004238432103937323, "StateBufferConnector_ms": 0.003349781036376953, "ViewRequirementAgentConnector_ms": 0.07521022449840199}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 127920, "num_agent_steps_trained": 127920, "num_env_steps_sampled": 127920, "num_env_steps_trained": 127920, "num_env_steps_sampled_this_iter": 1080, "num_env_steps_trained_this_iter": 1080, "num_env_steps_sampled_throughput_per_sec": 107.79634033686366, "num_env_steps_trained_throughput_per_sec": 107.79634033686366, "timesteps_total": 127920, "num_steps_trained_this_iter": 1080, "agent_timesteps_total": 127920, "timers": {"training_iteration_time_ms": 3338.353, "sample_time_ms": 3327.101, "load_time_ms": 0.311, "load_throughput": 1155720.964, "learn_time_ms": 10.167, "learn_throughput": 35408.666, "synch_weights_time_ms": 0.729}, "counters": {"num_env_steps_sampled": 127920, "num_env_steps_trained": 127920, "num_agent_steps_sampled": 127920, "num_agent_steps_trained": 127920}, "done": false, "episodes_total": 836, "training_iteration": 167, "trial_id": "14306_00000", "date": "2023-07-26_18-08-27", "timestamp": 1690384107, "time_this_iter_s": 10.021430969238281, "time_total_s": 1807.29469871521, "pid": 7707, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[131310, 5e-05], [136710, 8e-05], [142110, 2.5e-05], [147510, 2.5e-05], [152910, 2.5e-05], [158310, 2.5e-05], [163710, 1e-05], [169110, 1e-05], [174510, 1e-05], [179910, 5e-06], [185310, 5e-06], [190710, 5e-06], [196110, 5e-06], [201510, 1e-06], [206910, 1e-06], [212310, 1e-06], [217710, 1e-06], [223110, 5e-07], [228510, 5e-07], [233910, 2.5e-07], [239310, 2.5e-07], [244710, 1e-07], [250110, 1e-07], [255510, 5e-08], [260910, 5e-08], [266310, 1e-08]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.15, "final_epsilon": 0.05, "epsilon_timesteps": 264960}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x14a3b79d0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 77.46397185325623, "iterations_since_restore": 7, "perf": {"cpu_util_percent": 29.614285714285707, "ram_util_percent": 58.35714285714287}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-08, "entropy_coeff": 0.05, "policy_entropy": -345.1101318359375, "policy_loss": -34078428.0, "vf_loss": 7448313.8}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 123.0, "diff_num_grad_updates_vs_sampler_policy": 122.0}}, "num_env_steps_sampled": 129000, "num_env_steps_trained": 129000, "num_agent_steps_sampled": 129000, "num_agent_steps_trained": 129000}, "sampler_results": {"episode_reward_max": -1623.6366775976976, "episode_reward_min": -2234.2070943633057, "episode_reward_mean": -1999.4954659538923, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-2119.171799360851, -2114.331502917478, -2056.15284991328, -2205.7189272174583, -2099.324925286358, -1783.6167235197013, -2198.8005148640627, -1959.4255405533393, -2031.9709274873644, -2146.934807250676, -1867.9332144874832, -1732.3916216536554, -2234.2070943633057, -1983.003248740253, -1810.115942693552, -1880.740363158521, -2051.0059405638153, -2099.0961425143632, -1861.2511987318119, -1623.6366775976976, -1833.7213963946356, -2170.1685866460275, -1845.8168296279084, -2224.92297284634, -2053.926900457367], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.537198498781836, "mean_inference_ms": 0.41107433588796793, "mean_action_processing_ms": 0.09968285933376997, "mean_env_wait_ms": 2.2521856973308543, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004216194152832031, "StateBufferConnector_ms": 0.0032978057861328125, "ViewRequirementAgentConnector_ms": 0.07406139373779297}}, "episode_reward_max": -1623.6366775976976, "episode_reward_min": -2234.2070943633057, "episode_reward_mean": -1999.4954659538923, "episode_len_mean": 360.0, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-2119.171799360851, -2114.331502917478, -2056.15284991328, -2205.7189272174583, -2099.324925286358, -1783.6167235197013, -2198.8005148640627, -1959.4255405533393, -2031.9709274873644, -2146.934807250676, -1867.9332144874832, -1732.3916216536554, -2234.2070943633057, -1983.003248740253, -1810.115942693552, -1880.740363158521, -2051.0059405638153, -2099.0961425143632, -1861.2511987318119, -1623.6366775976976, -1833.7213963946356, -2170.1685866460275, -1845.8168296279084, -2224.92297284634, -2053.926900457367], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.537198498781836, "mean_inference_ms": 0.41107433588796793, "mean_action_processing_ms": 0.09968285933376997, "mean_env_wait_ms": 2.2521856973308543, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004216194152832031, "StateBufferConnector_ms": 0.0032978057861328125, "ViewRequirementAgentConnector_ms": 0.07406139373779297}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 129000, "num_agent_steps_trained": 129000, "num_env_steps_sampled": 129000, "num_env_steps_trained": 129000, "num_env_steps_sampled_this_iter": 1080, "num_env_steps_trained_this_iter": 1080, "num_env_steps_sampled_throughput_per_sec": 107.73966855551967, "num_env_steps_trained_throughput_per_sec": 107.73966855551967, "timesteps_total": 129000, "num_steps_trained_this_iter": 1080, "agent_timesteps_total": 129000, "timers": {"training_iteration_time_ms": 3330.924, "sample_time_ms": 3319.981, "load_time_ms": 0.301, "load_throughput": 1195810.121, "learn_time_ms": 9.881, "learn_throughput": 36435.07, "synch_weights_time_ms": 0.716}, "counters": {"num_env_steps_sampled": 129000, "num_env_steps_trained": 129000, "num_agent_steps_sampled": 129000, "num_agent_steps_trained": 129000}, "done": false, "episodes_total": 839, "training_iteration": 168, "trial_id": "14306_00000", "date": "2023-07-26_18-08-37", "timestamp": 1690384117, "time_this_iter_s": 10.026763916015625, "time_total_s": 1817.3214626312256, "pid": 7707, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[131310, 5e-05], [136710, 8e-05], [142110, 2.5e-05], [147510, 2.5e-05], [152910, 2.5e-05], [158310, 2.5e-05], [163710, 1e-05], [169110, 1e-05], [174510, 1e-05], [179910, 5e-06], [185310, 5e-06], [190710, 5e-06], [196110, 5e-06], [201510, 1e-06], [206910, 1e-06], [212310, 1e-06], [217710, 1e-06], [223110, 5e-07], [228510, 5e-07], [233910, 2.5e-07], [239310, 2.5e-07], [244710, 1e-07], [250110, 1e-07], [255510, 5e-08], [260910, 5e-08], [266310, 1e-08]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.15, "final_epsilon": 0.05, "epsilon_timesteps": 264960}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x14a3b79d0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 87.49073576927185, "iterations_since_restore": 8, "perf": {"cpu_util_percent": 26.014285714285716, "ram_util_percent": 58.121428571428574}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-08, "entropy_coeff": 0.05, "policy_entropy": -345.35706787109376, "policy_loss": -19805043.4, "vf_loss": 4036862.875}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 143.0, "diff_num_grad_updates_vs_sampler_policy": 142.0}}, "num_env_steps_sampled": 130440, "num_env_steps_trained": 130440, "num_agent_steps_sampled": 130440, "num_agent_steps_trained": 130440}, "sampler_results": {"episode_reward_max": -1623.6366775976976, "episode_reward_min": -2234.2070943633057, "episode_reward_mean": -1974.3183758746623, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-2119.171799360851, -2114.331502917478, -2056.15284991328, -2205.7189272174583, -2099.324925286358, -1783.6167235197013, -2198.8005148640627, -1959.4255405533393, -2031.9709274873644, -2146.934807250676, -1867.9332144874832, -1732.3916216536554, -2234.2070943633057, -1983.003248740253, -1810.115942693552, -1880.740363158521, -2051.0059405638153, -2099.0961425143632, -1861.2511987318119, -1623.6366775976976, -1833.7213963946356, -2170.1685866460275, -1845.8168296279084, -2224.92297284634, -2053.926900457367, -1999.6749001357318, -1761.9641895342056, -1845.4101580372842, -1660.79700381068], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.528683773129317, "mean_inference_ms": 0.40937898086560287, "mean_action_processing_ms": 0.09936543818315943, "mean_env_wait_ms": 2.1633281552148222, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004263581900761045, "StateBufferConnector_ms": 0.003304974786166487, "ViewRequirementAgentConnector_ms": 0.07401417041647024}}, "episode_reward_max": -1623.6366775976976, "episode_reward_min": -2234.2070943633057, "episode_reward_mean": -1974.3183758746623, "episode_len_mean": 360.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-2119.171799360851, -2114.331502917478, -2056.15284991328, -2205.7189272174583, -2099.324925286358, -1783.6167235197013, -2198.8005148640627, -1959.4255405533393, -2031.9709274873644, -2146.934807250676, -1867.9332144874832, -1732.3916216536554, -2234.2070943633057, -1983.003248740253, -1810.115942693552, -1880.740363158521, -2051.0059405638153, -2099.0961425143632, -1861.2511987318119, -1623.6366775976976, -1833.7213963946356, -2170.1685866460275, -1845.8168296279084, -2224.92297284634, -2053.926900457367, -1999.6749001357318, -1761.9641895342056, -1845.4101580372842, -1660.79700381068], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.528683773129317, "mean_inference_ms": 0.40937898086560287, "mean_action_processing_ms": 0.09936543818315943, "mean_env_wait_ms": 2.1633281552148222, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004263581900761045, "StateBufferConnector_ms": 0.003304974786166487, "ViewRequirementAgentConnector_ms": 0.07401417041647024}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 130440, "num_agent_steps_trained": 130440, "num_env_steps_sampled": 130440, "num_env_steps_trained": 130440, "num_env_steps_sampled_this_iter": 1440, "num_env_steps_trained_this_iter": 1440, "num_env_steps_sampled_throughput_per_sec": 108.99095126463422, "num_env_steps_trained_throughput_per_sec": 108.99095126463422, "timesteps_total": 130440, "num_steps_trained_this_iter": 1440, "agent_timesteps_total": 130440, "timers": {"training_iteration_time_ms": 3325.503, "sample_time_ms": 3314.576, "load_time_ms": 0.301, "load_throughput": 1196757.898, "learn_time_ms": 9.86, "learn_throughput": 36511.454, "synch_weights_time_ms": 0.723}, "counters": {"num_env_steps_sampled": 130440, "num_env_steps_trained": 130440, "num_agent_steps_sampled": 130440, "num_agent_steps_trained": 130440}, "done": false, "episodes_total": 843, "training_iteration": 169, "trial_id": "14306_00000", "date": "2023-07-26_18-08-50", "timestamp": 1690384130, "time_this_iter_s": 13.21475100517273, "time_total_s": 1830.5362136363983, "pid": 7707, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[131310, 5e-05], [136710, 8e-05], [142110, 2.5e-05], [147510, 2.5e-05], [152910, 2.5e-05], [158310, 2.5e-05], [163710, 1e-05], [169110, 1e-05], [174510, 1e-05], [179910, 5e-06], [185310, 5e-06], [190710, 5e-06], [196110, 5e-06], [201510, 1e-06], [206910, 1e-06], [212310, 1e-06], [217710, 1e-06], [223110, 5e-07], [228510, 5e-07], [233910, 2.5e-07], [239310, 2.5e-07], [244710, 1e-07], [250110, 1e-07], [255510, 5e-08], [260910, 5e-08], [266310, 1e-08]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.15, "final_epsilon": 0.05, "epsilon_timesteps": 264960}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x14a3b79d0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 100.70548677444458, "iterations_since_restore": 9, "perf": {"cpu_util_percent": 24.268421052631584, "ram_util_percent": 58.39473684210526}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-08, "entropy_coeff": 0.05, "policy_entropy": -344.770751953125, "policy_loss": -39551788.8, "vf_loss": 7638056.5}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 158.0, "diff_num_grad_updates_vs_sampler_policy": 157.0}}, "num_env_steps_sampled": 131520, "num_env_steps_trained": 131520, "num_agent_steps_sampled": 131520, "num_agent_steps_trained": 131520}, "sampler_results": {"episode_reward_max": -1623.6366775976976, "episode_reward_min": -2234.2070943633057, "episode_reward_mean": -1989.6232323428396, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-2119.171799360851, -2114.331502917478, -2056.15284991328, -2205.7189272174583, -2099.324925286358, -1783.6167235197013, -2198.8005148640627, -1959.4255405533393, -2031.9709274873644, -2146.934807250676, -1867.9332144874832, -1732.3916216536554, -2234.2070943633057, -1983.003248740253, -1810.115942693552, -1880.740363158521, -2051.0059405638153, -2099.0961425143632, -1861.2511987318119, -1623.6366775976976, -1833.7213963946356, -2170.1685866460275, -1845.8168296279084, -2224.92297284634, -2053.926900457367, -1999.6749001357318, -1761.9641895342056, -1845.4101580372842, -1660.79700381068, -2200.276684034361, -2099.2137564929294, -2113.220094078378], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.523631729085771, "mean_inference_ms": 0.40889676823174964, "mean_action_processing_ms": 0.0993067894000799, "mean_env_wait_ms": 2.1096637145423034, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004173070192337036, "StateBufferConnector_ms": 0.003279745578765869, "ViewRequirementAgentConnector_ms": 0.0735841691493988}}, "episode_reward_max": -1623.6366775976976, "episode_reward_min": -2234.2070943633057, "episode_reward_mean": -1989.6232323428396, "episode_len_mean": 360.0, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-2119.171799360851, -2114.331502917478, -2056.15284991328, -2205.7189272174583, -2099.324925286358, -1783.6167235197013, -2198.8005148640627, -1959.4255405533393, -2031.9709274873644, -2146.934807250676, -1867.9332144874832, -1732.3916216536554, -2234.2070943633057, -1983.003248740253, -1810.115942693552, -1880.740363158521, -2051.0059405638153, -2099.0961425143632, -1861.2511987318119, -1623.6366775976976, -1833.7213963946356, -2170.1685866460275, -1845.8168296279084, -2224.92297284634, -2053.926900457367, -1999.6749001357318, -1761.9641895342056, -1845.4101580372842, -1660.79700381068, -2200.276684034361, -2099.2137564929294, -2113.220094078378], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.523631729085771, "mean_inference_ms": 0.40889676823174964, "mean_action_processing_ms": 0.0993067894000799, "mean_env_wait_ms": 2.1096637145423034, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004173070192337036, "StateBufferConnector_ms": 0.003279745578765869, "ViewRequirementAgentConnector_ms": 0.0735841691493988}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 131520, "num_agent_steps_trained": 131520, "num_env_steps_sampled": 131520, "num_env_steps_trained": 131520, "num_env_steps_sampled_this_iter": 1080, "num_env_steps_trained_this_iter": 1080, "num_env_steps_sampled_throughput_per_sec": 104.97460051018437, "num_env_steps_trained_throughput_per_sec": 104.97460051018437, "timesteps_total": 131520, "num_steps_trained_this_iter": 1080, "agent_timesteps_total": 131520, "timers": {"training_iteration_time_ms": 3352.434, "sample_time_ms": 3341.542, "load_time_ms": 0.299, "load_throughput": 1202284.768, "learn_time_ms": 9.823, "learn_throughput": 36647.479, "synch_weights_time_ms": 0.726}, "counters": {"num_env_steps_sampled": 131520, "num_env_steps_trained": 131520, "num_agent_steps_sampled": 131520, "num_agent_steps_trained": 131520}, "done": false, "episodes_total": 846, "training_iteration": 170, "trial_id": "14306_00000", "date": "2023-07-26_18-09-01", "timestamp": 1690384141, "time_this_iter_s": 10.290803909301758, "time_total_s": 1840.8270175457, "pid": 7707, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[131310, 5e-05], [136710, 8e-05], [142110, 2.5e-05], [147510, 2.5e-05], [152910, 2.5e-05], [158310, 2.5e-05], [163710, 1e-05], [169110, 1e-05], [174510, 1e-05], [179910, 5e-06], [185310, 5e-06], [190710, 5e-06], [196110, 5e-06], [201510, 1e-06], [206910, 1e-06], [212310, 1e-06], [217710, 1e-06], [223110, 5e-07], [228510, 5e-07], [233910, 2.5e-07], [239310, 2.5e-07], [244710, 1e-07], [250110, 1e-07], [255510, 5e-08], [260910, 5e-08], [266310, 1e-08]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.15, "final_epsilon": 0.05, "epsilon_timesteps": 264960}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x14a3b79d0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 110.99629068374634, "iterations_since_restore": 10, "perf": {"cpu_util_percent": 29.74, "ram_util_percent": 58.54}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 5.516666666666667e-05, "entropy_coeff": 0.05, "policy_entropy": -376.8552001953125, "policy_loss": -62791169.6, "vf_loss": 7669805.15}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 173.0, "diff_num_grad_updates_vs_sampler_policy": 172.0}}, "num_env_steps_sampled": 132600, "num_env_steps_trained": 132600, "num_agent_steps_sampled": 132600, "num_agent_steps_trained": 132600}, "sampler_results": {"episode_reward_max": -1623.6366775976976, "episode_reward_min": -2243.898806316024, "episode_reward_mean": -1999.3191694948173, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-2119.171799360851, -2114.331502917478, -2056.15284991328, -2205.7189272174583, -2099.324925286358, -1783.6167235197013, -2198.8005148640627, -1959.4255405533393, -2031.9709274873644, -2146.934807250676, -1867.9332144874832, -1732.3916216536554, -2234.2070943633057, -1983.003248740253, -1810.115942693552, -1880.740363158521, -2051.0059405638153, -2099.0961425143632, -1861.2511987318119, -1623.6366775976976, -1833.7213963946356, -2170.1685866460275, -1845.8168296279084, -2224.92297284634, -2053.926900457367, -1999.6749001357318, -1761.9641895342056, -1845.4101580372842, -1660.79700381068, -2200.276684034361, -2099.2137564929294, -2113.220094078378, -1999.6454971942321, -2243.898806316024, -2064.683193837476], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.519348680615963, "mean_inference_ms": 0.4082660476272596, "mean_action_processing_ms": 0.09921152909795267, "mean_env_wait_ms": 2.0636038632012457, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004070826939174107, "StateBufferConnector_ms": 0.0032411302839006695, "ViewRequirementAgentConnector_ms": 0.07290022713797432}}, "episode_reward_max": -1623.6366775976976, "episode_reward_min": -2243.898806316024, "episode_reward_mean": -1999.3191694948173, "episode_len_mean": 360.0, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-2119.171799360851, -2114.331502917478, -2056.15284991328, -2205.7189272174583, -2099.324925286358, -1783.6167235197013, -2198.8005148640627, -1959.4255405533393, -2031.9709274873644, -2146.934807250676, -1867.9332144874832, -1732.3916216536554, -2234.2070943633057, -1983.003248740253, -1810.115942693552, -1880.740363158521, -2051.0059405638153, -2099.0961425143632, -1861.2511987318119, -1623.6366775976976, -1833.7213963946356, -2170.1685866460275, -1845.8168296279084, -2224.92297284634, -2053.926900457367, -1999.6749001357318, -1761.9641895342056, -1845.4101580372842, -1660.79700381068, -2200.276684034361, -2099.2137564929294, -2113.220094078378, -1999.6454971942321, -2243.898806316024, -2064.683193837476], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.519348680615963, "mean_inference_ms": 0.4082660476272596, "mean_action_processing_ms": 0.09921152909795267, "mean_env_wait_ms": 2.0636038632012457, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004070826939174107, "StateBufferConnector_ms": 0.0032411302839006695, "ViewRequirementAgentConnector_ms": 0.07290022713797432}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 132600, "num_agent_steps_trained": 132600, "num_env_steps_sampled": 132600, "num_env_steps_trained": 132600, "num_env_steps_sampled_this_iter": 1080, "num_env_steps_trained_this_iter": 1080, "num_env_steps_sampled_throughput_per_sec": 106.83252283332733, "num_env_steps_trained_throughput_per_sec": 106.83252283332733, "timesteps_total": 132600, "num_steps_trained_this_iter": 1080, "agent_timesteps_total": 132600, "timers": {"training_iteration_time_ms": 3360.945, "sample_time_ms": 3349.912, "load_time_ms": 0.301, "load_throughput": 1195336.795, "learn_time_ms": 9.938, "learn_throughput": 36224.239, "synch_weights_time_ms": 0.75}, "counters": {"num_env_steps_sampled": 132600, "num_env_steps_trained": 132600, "num_agent_steps_sampled": 132600, "num_agent_steps_trained": 132600}, "done": false, "episodes_total": 849, "training_iteration": 171, "trial_id": "14306_00000", "date": "2023-07-26_18-09-11", "timestamp": 1690384151, "time_this_iter_s": 10.11185908317566, "time_total_s": 1850.9388766288757, "pid": 7707, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[131310, 5e-05], [136710, 8e-05], [142110, 2.5e-05], [147510, 2.5e-05], [152910, 2.5e-05], [158310, 2.5e-05], [163710, 1e-05], [169110, 1e-05], [174510, 1e-05], [179910, 5e-06], [185310, 5e-06], [190710, 5e-06], [196110, 5e-06], [201510, 1e-06], [206910, 1e-06], [212310, 1e-06], [217710, 1e-06], [223110, 5e-07], [228510, 5e-07], [233910, 2.5e-07], [239310, 2.5e-07], [244710, 1e-07], [250110, 1e-07], [255510, 5e-08], [260910, 5e-08], [266310, 1e-08]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.15, "final_epsilon": 0.05, "epsilon_timesteps": 264960}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x14a3b79d0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 121.108149766922, "iterations_since_restore": 11, "perf": {"cpu_util_percent": 25.35, "ram_util_percent": 58.42142857142858}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 6.116666666666667e-05, "entropy_coeff": 0.05, "policy_entropy": -420.06585693359375, "policy_loss": -162044426.4, "vf_loss": 14730289.2}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 188.0, "diff_num_grad_updates_vs_sampler_policy": 187.0}}, "num_env_steps_sampled": 133680, "num_env_steps_trained": 133680, "num_agent_steps_sampled": 133680, "num_agent_steps_trained": 133680}, "sampler_results": {"episode_reward_max": -1623.6366775976976, "episode_reward_min": -2826.9278593746703, "episode_reward_mean": -2025.6645315839085, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-2119.171799360851, -2114.331502917478, -2056.15284991328, -2205.7189272174583, -2099.324925286358, -1783.6167235197013, -2198.8005148640627, -1959.4255405533393, -2031.9709274873644, -2146.934807250676, -1867.9332144874832, -1732.3916216536554, -2234.2070943633057, -1983.003248740253, -1810.115942693552, -1880.740363158521, -2051.0059405638153, -2099.0961425143632, -1861.2511987318119, -1623.6366775976976, -1833.7213963946356, -2170.1685866460275, -1845.8168296279084, -2224.92297284634, -2053.926900457367, -1999.6749001357318, -1761.9641895342056, -1845.4101580372842, -1660.79700381068, -2200.276684034361, -2099.2137564929294, -2113.220094078378, -1999.6454971942321, -2243.898806316024, -2064.683193837476, -2170.1598230617215, -2001.9935854335158, -2826.9278593746703], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.51660754208627, "mean_inference_ms": 0.40755033537902174, "mean_action_processing_ms": 0.0990967915958705, "mean_env_wait_ms": 2.0240122183268427, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004001667625025699, "StateBufferConnector_ms": 0.0032142588966771178, "ViewRequirementAgentConnector_ms": 0.07236380326120477}}, "episode_reward_max": -1623.6366775976976, "episode_reward_min": -2826.9278593746703, "episode_reward_mean": -2025.6645315839085, "episode_len_mean": 360.0, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-2119.171799360851, -2114.331502917478, -2056.15284991328, -2205.7189272174583, -2099.324925286358, -1783.6167235197013, -2198.8005148640627, -1959.4255405533393, -2031.9709274873644, -2146.934807250676, -1867.9332144874832, -1732.3916216536554, -2234.2070943633057, -1983.003248740253, -1810.115942693552, -1880.740363158521, -2051.0059405638153, -2099.0961425143632, -1861.2511987318119, -1623.6366775976976, -1833.7213963946356, -2170.1685866460275, -1845.8168296279084, -2224.92297284634, -2053.926900457367, -1999.6749001357318, -1761.9641895342056, -1845.4101580372842, -1660.79700381068, -2200.276684034361, -2099.2137564929294, -2113.220094078378, -1999.6454971942321, -2243.898806316024, -2064.683193837476, -2170.1598230617215, -2001.9935854335158, -2826.9278593746703], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.51660754208627, "mean_inference_ms": 0.40755033537902174, "mean_action_processing_ms": 0.0990967915958705, "mean_env_wait_ms": 2.0240122183268427, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004001667625025699, "StateBufferConnector_ms": 0.0032142588966771178, "ViewRequirementAgentConnector_ms": 0.07236380326120477}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 133680, "num_agent_steps_trained": 133680, "num_env_steps_sampled": 133680, "num_env_steps_trained": 133680, "num_env_steps_sampled_this_iter": 1080, "num_env_steps_trained_this_iter": 1080, "num_env_steps_sampled_throughput_per_sec": 104.39805041520702, "num_env_steps_trained_throughput_per_sec": 104.39805041520702, "timesteps_total": 133680, "num_steps_trained_this_iter": 1080, "agent_timesteps_total": 133680, "timers": {"training_iteration_time_ms": 3400.027, "sample_time_ms": 3388.982, "load_time_ms": 0.301, "load_throughput": 1196378.607, "learn_time_ms": 9.97, "learn_throughput": 36107.644, "synch_weights_time_ms": 0.73}, "counters": {"num_env_steps_sampled": 133680, "num_env_steps_trained": 133680, "num_agent_steps_sampled": 133680, "num_agent_steps_trained": 133680}, "done": false, "episodes_total": 852, "training_iteration": 172, "trial_id": "14306_00000", "date": "2023-07-26_18-09-21", "timestamp": 1690384161, "time_this_iter_s": 10.347690105438232, "time_total_s": 1861.286566734314, "pid": 7707, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[131310, 5e-05], [136710, 8e-05], [142110, 2.5e-05], [147510, 2.5e-05], [152910, 2.5e-05], [158310, 2.5e-05], [163710, 1e-05], [169110, 1e-05], [174510, 1e-05], [179910, 5e-06], [185310, 5e-06], [190710, 5e-06], [196110, 5e-06], [201510, 1e-06], [206910, 1e-06], [212310, 1e-06], [217710, 1e-06], [223110, 5e-07], [228510, 5e-07], [233910, 2.5e-07], [239310, 2.5e-07], [244710, 1e-07], [250110, 1e-07], [255510, 5e-08], [260910, 5e-08], [266310, 1e-08]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.15, "final_epsilon": 0.05, "epsilon_timesteps": 264960}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x14a3b79d0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 131.45583987236023, "iterations_since_restore": 12, "perf": {"cpu_util_percent": 21.993333333333332, "ram_util_percent": 58.36666666666666}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 6.716666666666667e-05, "entropy_coeff": 0.05, "policy_entropy": -466.796630859375, "policy_loss": -905965011.2, "vf_loss": 134106593.6}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 203.0, "diff_num_grad_updates_vs_sampler_policy": 202.0}}, "num_env_steps_sampled": 134760, "num_env_steps_trained": 134760, "num_agent_steps_sampled": 134760, "num_agent_steps_trained": 134760}, "sampler_results": {"episode_reward_max": -1623.6366775976976, "episode_reward_min": -9055.053679015089, "episode_reward_mean": -2270.9633119456307, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-2119.171799360851, -2114.331502917478, -2056.15284991328, -2205.7189272174583, -2099.324925286358, -1783.6167235197013, -2198.8005148640627, -1959.4255405533393, -2031.9709274873644, -2146.934807250676, -1867.9332144874832, -1732.3916216536554, -2234.2070943633057, -1983.003248740253, -1810.115942693552, -1880.740363158521, -2051.0059405638153, -2099.0961425143632, -1861.2511987318119, -1623.6366775976976, -1833.7213963946356, -2170.1685866460275, -1845.8168296279084, -2224.92297284634, -2053.926900457367, -1999.6749001357318, -1761.9641895342056, -1845.4101580372842, -1660.79700381068, -2200.276684034361, -2099.2137564929294, -2113.220094078378, -1999.6454971942321, -2243.898806316024, -2064.683193837476, -2170.1598230617215, -2001.9935854335158, -2826.9278593746703, -2549.0906692719304, -4530.099241295323, -9055.053679015089], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.514328699659597, "mean_inference_ms": 0.4067787186963152, "mean_action_processing_ms": 0.09896656068183456, "mean_env_wait_ms": 1.9891337422426427, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004097310508169779, "StateBufferConnector_ms": 0.0031901568901248093, "ViewRequirementAgentConnector_ms": 0.07176282929211128}}, "episode_reward_max": -1623.6366775976976, "episode_reward_min": -9055.053679015089, "episode_reward_mean": -2270.9633119456307, "episode_len_mean": 360.0, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-2119.171799360851, -2114.331502917478, -2056.15284991328, -2205.7189272174583, -2099.324925286358, -1783.6167235197013, -2198.8005148640627, -1959.4255405533393, -2031.9709274873644, -2146.934807250676, -1867.9332144874832, -1732.3916216536554, -2234.2070943633057, -1983.003248740253, -1810.115942693552, -1880.740363158521, -2051.0059405638153, -2099.0961425143632, -1861.2511987318119, -1623.6366775976976, -1833.7213963946356, -2170.1685866460275, -1845.8168296279084, -2224.92297284634, -2053.926900457367, -1999.6749001357318, -1761.9641895342056, -1845.4101580372842, -1660.79700381068, -2200.276684034361, -2099.2137564929294, -2113.220094078378, -1999.6454971942321, -2243.898806316024, -2064.683193837476, -2170.1598230617215, -2001.9935854335158, -2826.9278593746703, -2549.0906692719304, -4530.099241295323, -9055.053679015089], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.514328699659597, "mean_inference_ms": 0.4067787186963152, "mean_action_processing_ms": 0.09896656068183456, "mean_env_wait_ms": 1.9891337422426427, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004097310508169779, "StateBufferConnector_ms": 0.0031901568901248093, "ViewRequirementAgentConnector_ms": 0.07176282929211128}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 134760, "num_agent_steps_trained": 134760, "num_env_steps_sampled": 134760, "num_env_steps_trained": 134760, "num_env_steps_sampled_this_iter": 1080, "num_env_steps_trained_this_iter": 1080, "num_env_steps_sampled_throughput_per_sec": 106.66914329470619, "num_env_steps_trained_throughput_per_sec": 106.66914329470619, "timesteps_total": 134760, "num_steps_trained_this_iter": 1080, "agent_timesteps_total": 134760, "timers": {"training_iteration_time_ms": 3392.103, "sample_time_ms": 3381.222, "load_time_ms": 0.3, "load_throughput": 1198848.305, "learn_time_ms": 9.824, "learn_throughput": 36645.256, "synch_weights_time_ms": 0.713}, "counters": {"num_env_steps_sampled": 134760, "num_env_steps_trained": 134760, "num_agent_steps_sampled": 134760, "num_agent_steps_trained": 134760}, "done": false, "episodes_total": 855, "training_iteration": 173, "trial_id": "14306_00000", "date": "2023-07-26_18-09-31", "timestamp": 1690384171, "time_this_iter_s": 10.127365827560425, "time_total_s": 1871.4139325618744, "pid": 7707, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[131310, 5e-05], [136710, 8e-05], [142110, 2.5e-05], [147510, 2.5e-05], [152910, 2.5e-05], [158310, 2.5e-05], [163710, 1e-05], [169110, 1e-05], [174510, 1e-05], [179910, 5e-06], [185310, 5e-06], [190710, 5e-06], [196110, 5e-06], [201510, 1e-06], [206910, 1e-06], [212310, 1e-06], [217710, 1e-06], [223110, 5e-07], [228510, 5e-07], [233910, 2.5e-07], [239310, 2.5e-07], [244710, 1e-07], [250110, 1e-07], [255510, 5e-08], [260910, 5e-08], [266310, 1e-08]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.15, "final_epsilon": 0.05, "epsilon_timesteps": 264960}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x14a3b79d0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 141.58320569992065, "iterations_since_restore": 13, "perf": {"cpu_util_percent": 21.72142857142857, "ram_util_percent": 57.828571428571436}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 7.316666666666667e-05, "entropy_coeff": 0.05, "policy_entropy": -526.9774658203125, "policy_loss": -1375369548.8, "vf_loss": 223565539.2}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 218.0, "diff_num_grad_updates_vs_sampler_policy": 217.0}}, "num_env_steps_sampled": 135840, "num_env_steps_trained": 135840, "num_agent_steps_sampled": 135840, "num_agent_steps_trained": 135840}, "sampler_results": {"episode_reward_max": -1623.6366775976976, "episode_reward_min": -11690.365175060395, "episode_reward_mean": -2906.6813143979734, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-2119.171799360851, -2114.331502917478, -2056.15284991328, -2205.7189272174583, -2099.324925286358, -1783.6167235197013, -2198.8005148640627, -1959.4255405533393, -2031.9709274873644, -2146.934807250676, -1867.9332144874832, -1732.3916216536554, -2234.2070943633057, -1983.003248740253, -1810.115942693552, -1880.740363158521, -2051.0059405638153, -2099.0961425143632, -1861.2511987318119, -1623.6366775976976, -1833.7213963946356, -2170.1685866460275, -1845.8168296279084, -2224.92297284634, -2053.926900457367, -1999.6749001357318, -1761.9641895342056, -1845.4101580372842, -1660.79700381068, -2200.276684034361, -2099.2137564929294, -2113.220094078378, -1999.6454971942321, -2243.898806316024, -2064.683193837476, -2170.1598230617215, -2001.9935854335158, -2826.9278593746703, -2549.0906692719304, -4530.099241295323, -9055.053679015089, -11557.62411448131, -11690.365175060395, -11536.492754198262], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.512718676948965, "mean_inference_ms": 0.40599809051181734, "mean_action_processing_ms": 0.09882966519046801, "mean_env_wait_ms": 1.9585446487786902, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004039569334550338, "StateBufferConnector_ms": 0.003169341520829634, "ViewRequirementAgentConnector_ms": 0.07131587375294078}}, "episode_reward_max": -1623.6366775976976, "episode_reward_min": -11690.365175060395, "episode_reward_mean": -2906.6813143979734, "episode_len_mean": 360.0, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-2119.171799360851, -2114.331502917478, -2056.15284991328, -2205.7189272174583, -2099.324925286358, -1783.6167235197013, -2198.8005148640627, -1959.4255405533393, -2031.9709274873644, -2146.934807250676, -1867.9332144874832, -1732.3916216536554, -2234.2070943633057, -1983.003248740253, -1810.115942693552, -1880.740363158521, -2051.0059405638153, -2099.0961425143632, -1861.2511987318119, -1623.6366775976976, -1833.7213963946356, -2170.1685866460275, -1845.8168296279084, -2224.92297284634, -2053.926900457367, -1999.6749001357318, -1761.9641895342056, -1845.4101580372842, -1660.79700381068, -2200.276684034361, -2099.2137564929294, -2113.220094078378, -1999.6454971942321, -2243.898806316024, -2064.683193837476, -2170.1598230617215, -2001.9935854335158, -2826.9278593746703, -2549.0906692719304, -4530.099241295323, -9055.053679015089, -11557.62411448131, -11690.365175060395, -11536.492754198262], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.512718676948965, "mean_inference_ms": 0.40599809051181734, "mean_action_processing_ms": 0.09882966519046801, "mean_env_wait_ms": 1.9585446487786902, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004039569334550338, "StateBufferConnector_ms": 0.003169341520829634, "ViewRequirementAgentConnector_ms": 0.07131587375294078}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 135840, "num_agent_steps_trained": 135840, "num_env_steps_sampled": 135840, "num_env_steps_trained": 135840, "num_env_steps_sampled_this_iter": 1080, "num_env_steps_trained_this_iter": 1080, "num_env_steps_sampled_throughput_per_sec": 104.90440630628596, "num_env_steps_trained_throughput_per_sec": 104.90440630628596, "timesteps_total": 135840, "num_steps_trained_this_iter": 1080, "agent_timesteps_total": 135840, "timers": {"training_iteration_time_ms": 3418.204, "sample_time_ms": 3407.394, "load_time_ms": 0.299, "load_throughput": 1205452.211, "learn_time_ms": 9.765, "learn_throughput": 36866.43, "synch_weights_time_ms": 0.704}, "counters": {"num_env_steps_sampled": 135840, "num_env_steps_trained": 135840, "num_agent_steps_sampled": 135840, "num_agent_steps_trained": 135840}, "done": false, "episodes_total": 858, "training_iteration": 174, "trial_id": "14306_00000", "date": "2023-07-26_18-09-42", "timestamp": 1690384182, "time_this_iter_s": 10.297679901123047, "time_total_s": 1881.7116124629974, "pid": 7707, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[131310, 5e-05], [136710, 8e-05], [142110, 2.5e-05], [147510, 2.5e-05], [152910, 2.5e-05], [158310, 2.5e-05], [163710, 1e-05], [169110, 1e-05], [174510, 1e-05], [179910, 5e-06], [185310, 5e-06], [190710, 5e-06], [196110, 5e-06], [201510, 1e-06], [206910, 1e-06], [212310, 1e-06], [217710, 1e-06], [223110, 5e-07], [228510, 5e-07], [233910, 2.5e-07], [239310, 2.5e-07], [244710, 1e-07], [250110, 1e-07], [255510, 5e-08], [260910, 5e-08], [266310, 1e-08]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.15, "final_epsilon": 0.05, "epsilon_timesteps": 264960}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x14a3b79d0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 151.8808856010437, "iterations_since_restore": 14, "perf": {"cpu_util_percent": 21.019999999999996, "ram_util_percent": 57.48666666666667}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 7.916666666666668e-05, "entropy_coeff": 0.05, "policy_entropy": -589.550244140625, "policy_loss": -4082787097.6, "vf_loss": 226889745.6}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 233.0, "diff_num_grad_updates_vs_sampler_policy": 232.0}}, "num_env_steps_sampled": 136920, "num_env_steps_trained": 136920, "num_agent_steps_sampled": 136920, "num_agent_steps_trained": 136920}, "sampler_results": {"episode_reward_max": -1623.6366775976976, "episode_reward_min": -11690.365175060395, "episode_reward_mean": -3456.3838374922425, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-2119.171799360851, -2114.331502917478, -2056.15284991328, -2205.7189272174583, -2099.324925286358, -1783.6167235197013, -2198.8005148640627, -1959.4255405533393, -2031.9709274873644, -2146.934807250676, -1867.9332144874832, -1732.3916216536554, -2234.2070943633057, -1983.003248740253, -1810.115942693552, -1880.740363158521, -2051.0059405638153, -2099.0961425143632, -1861.2511987318119, -1623.6366775976976, -1833.7213963946356, -2170.1685866460275, -1845.8168296279084, -2224.92297284634, -2053.926900457367, -1999.6749001357318, -1761.9641895342056, -1845.4101580372842, -1660.79700381068, -2200.276684034361, -2099.2137564929294, -2113.220094078378, -1999.6454971942321, -2243.898806316024, -2064.683193837476, -2170.1598230617215, -2001.9935854335158, -2826.9278593746703, -2549.0906692719304, -4530.099241295323, -9055.053679015089, -11557.62411448131, -11690.365175060395, -11536.492754198262, -11315.672754182919, -11554.547061699, -11685.842712742626], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.5113156613999195, "mean_inference_ms": 0.40525740551847106, "mean_action_processing_ms": 0.09869623133718748, "mean_env_wait_ms": 1.9313338590991123, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00407239224048371, "StateBufferConnector_ms": 0.0031572707155917553, "ViewRequirementAgentConnector_ms": 0.07137744984728225}}, "episode_reward_max": -1623.6366775976976, "episode_reward_min": -11690.365175060395, "episode_reward_mean": -3456.3838374922425, "episode_len_mean": 360.0, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-2119.171799360851, -2114.331502917478, -2056.15284991328, -2205.7189272174583, -2099.324925286358, -1783.6167235197013, -2198.8005148640627, -1959.4255405533393, -2031.9709274873644, -2146.934807250676, -1867.9332144874832, -1732.3916216536554, -2234.2070943633057, -1983.003248740253, -1810.115942693552, -1880.740363158521, -2051.0059405638153, -2099.0961425143632, -1861.2511987318119, -1623.6366775976976, -1833.7213963946356, -2170.1685866460275, -1845.8168296279084, -2224.92297284634, -2053.926900457367, -1999.6749001357318, -1761.9641895342056, -1845.4101580372842, -1660.79700381068, -2200.276684034361, -2099.2137564929294, -2113.220094078378, -1999.6454971942321, -2243.898806316024, -2064.683193837476, -2170.1598230617215, -2001.9935854335158, -2826.9278593746703, -2549.0906692719304, -4530.099241295323, -9055.053679015089, -11557.62411448131, -11690.365175060395, -11536.492754198262, -11315.672754182919, -11554.547061699, -11685.842712742626], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.5113156613999195, "mean_inference_ms": 0.40525740551847106, "mean_action_processing_ms": 0.09869623133718748, "mean_env_wait_ms": 1.9313338590991123, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00407239224048371, "StateBufferConnector_ms": 0.0031572707155917553, "ViewRequirementAgentConnector_ms": 0.07137744984728225}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 136920, "num_agent_steps_trained": 136920, "num_env_steps_sampled": 136920, "num_env_steps_trained": 136920, "num_env_steps_sampled_this_iter": 1080, "num_env_steps_trained_this_iter": 1080, "num_env_steps_sampled_throughput_per_sec": 105.99440471198109, "num_env_steps_trained_throughput_per_sec": 105.99440471198109, "timesteps_total": 136920, "num_steps_trained_this_iter": 1080, "agent_timesteps_total": 136920, "timers": {"training_iteration_time_ms": 3405.837, "sample_time_ms": 3395.086, "load_time_ms": 0.299, "load_throughput": 1205355.983, "learn_time_ms": 9.702, "learn_throughput": 37104.782, "synch_weights_time_ms": 0.707}, "counters": {"num_env_steps_sampled": 136920, "num_env_steps_trained": 136920, "num_agent_steps_sampled": 136920, "num_agent_steps_trained": 136920}, "done": false, "episodes_total": 861, "training_iteration": 175, "trial_id": "14306_00000", "date": "2023-07-26_18-09-52", "timestamp": 1690384192, "time_this_iter_s": 10.191895961761475, "time_total_s": 1891.903508424759, "pid": 7707, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[131310, 5e-05], [136710, 8e-05], [142110, 2.5e-05], [147510, 2.5e-05], [152910, 2.5e-05], [158310, 2.5e-05], [163710, 1e-05], [169110, 1e-05], [174510, 1e-05], [179910, 5e-06], [185310, 5e-06], [190710, 5e-06], [196110, 5e-06], [201510, 1e-06], [206910, 1e-06], [212310, 1e-06], [217710, 1e-06], [223110, 5e-07], [228510, 5e-07], [233910, 2.5e-07], [239310, 2.5e-07], [244710, 1e-07], [250110, 1e-07], [255510, 5e-08], [260910, 5e-08], [266310, 1e-08]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.15, "final_epsilon": 0.05, "epsilon_timesteps": 264960}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x14a3b79d0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 162.07278156280518, "iterations_since_restore": 15, "perf": {"cpu_util_percent": 21.91428571428571, "ram_util_percent": 57.52857142857143}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 7.052777777777778e-05, "entropy_coeff": 0.05, "policy_entropy": -649.9024536132813, "policy_loss": -8806406963.2, "vf_loss": 218353635.2}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 248.0, "diff_num_grad_updates_vs_sampler_policy": 247.0}}, "num_env_steps_sampled": 138000, "num_env_steps_trained": 138000, "num_agent_steps_sampled": 138000, "num_agent_steps_trained": 138000}, "sampler_results": {"episode_reward_max": -1623.6366775976976, "episode_reward_min": -11690.365175060395, "episode_reward_mean": -3933.7150098869856, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-2119.171799360851, -2114.331502917478, -2056.15284991328, -2205.7189272174583, -2099.324925286358, -1783.6167235197013, -2198.8005148640627, -1959.4255405533393, -2031.9709274873644, -2146.934807250676, -1867.9332144874832, -1732.3916216536554, -2234.2070943633057, -1983.003248740253, -1810.115942693552, -1880.740363158521, -2051.0059405638153, -2099.0961425143632, -1861.2511987318119, -1623.6366775976976, -1833.7213963946356, -2170.1685866460275, -1845.8168296279084, -2224.92297284634, -2053.926900457367, -1999.6749001357318, -1761.9641895342056, -1845.4101580372842, -1660.79700381068, -2200.276684034361, -2099.2137564929294, -2113.220094078378, -1999.6454971942321, -2243.898806316024, -2064.683193837476, -2170.1598230617215, -2001.9935854335158, -2826.9278593746703, -2549.0906692719304, -4530.099241295323, -9055.053679015089, -11557.62411448131, -11690.365175060395, -11536.492754198262, -11315.672754182919, -11554.547061699, -11685.842712742626, -11372.3699668468, -11461.865010105279, -11401.475155261835], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.510260852437941, "mean_inference_ms": 0.4045250693115032, "mean_action_processing_ms": 0.09856270215927014, "mean_env_wait_ms": 1.907043793689233, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004032135009765625, "StateBufferConnector_ms": 0.0031523704528808594, "ViewRequirementAgentConnector_ms": 0.07122611999511719}}, "episode_reward_max": -1623.6366775976976, "episode_reward_min": -11690.365175060395, "episode_reward_mean": -3933.7150098869856, "episode_len_mean": 360.0, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-2119.171799360851, -2114.331502917478, -2056.15284991328, -2205.7189272174583, -2099.324925286358, -1783.6167235197013, -2198.8005148640627, -1959.4255405533393, -2031.9709274873644, -2146.934807250676, -1867.9332144874832, -1732.3916216536554, -2234.2070943633057, -1983.003248740253, -1810.115942693552, -1880.740363158521, -2051.0059405638153, -2099.0961425143632, -1861.2511987318119, -1623.6366775976976, -1833.7213963946356, -2170.1685866460275, -1845.8168296279084, -2224.92297284634, -2053.926900457367, -1999.6749001357318, -1761.9641895342056, -1845.4101580372842, -1660.79700381068, -2200.276684034361, -2099.2137564929294, -2113.220094078378, -1999.6454971942321, -2243.898806316024, -2064.683193837476, -2170.1598230617215, -2001.9935854335158, -2826.9278593746703, -2549.0906692719304, -4530.099241295323, -9055.053679015089, -11557.62411448131, -11690.365175060395, -11536.492754198262, -11315.672754182919, -11554.547061699, -11685.842712742626, -11372.3699668468, -11461.865010105279, -11401.475155261835], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.510260852437941, "mean_inference_ms": 0.4045250693115032, "mean_action_processing_ms": 0.09856270215927014, "mean_env_wait_ms": 1.907043793689233, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004032135009765625, "StateBufferConnector_ms": 0.0031523704528808594, "ViewRequirementAgentConnector_ms": 0.07122611999511719}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 138000, "num_agent_steps_trained": 138000, "num_env_steps_sampled": 138000, "num_env_steps_trained": 138000, "num_env_steps_sampled_this_iter": 1080, "num_env_steps_trained_this_iter": 1080, "num_env_steps_sampled_throughput_per_sec": 105.24218221883784, "num_env_steps_trained_throughput_per_sec": 105.24218221883784, "timesteps_total": 138000, "num_steps_trained_this_iter": 1080, "agent_timesteps_total": 138000, "timers": {"training_iteration_time_ms": 3413.295, "sample_time_ms": 3402.344, "load_time_ms": 0.314, "load_throughput": 1147377.994, "learn_time_ms": 9.856, "learn_throughput": 36525.939, "synch_weights_time_ms": 0.736}, "counters": {"num_env_steps_sampled": 138000, "num_env_steps_trained": 138000, "num_agent_steps_sampled": 138000, "num_agent_steps_trained": 138000}, "done": false, "episodes_total": 864, "training_iteration": 176, "trial_id": "14306_00000", "date": "2023-07-26_18-10-02", "timestamp": 1690384202, "time_this_iter_s": 10.264910221099854, "time_total_s": 1902.1684186458588, "pid": 7707, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[131310, 5e-05], [136710, 8e-05], [142110, 2.5e-05], [147510, 2.5e-05], [152910, 2.5e-05], [158310, 2.5e-05], [163710, 1e-05], [169110, 1e-05], [174510, 1e-05], [179910, 5e-06], [185310, 5e-06], [190710, 5e-06], [196110, 5e-06], [201510, 1e-06], [206910, 1e-06], [212310, 1e-06], [217710, 1e-06], [223110, 5e-07], [228510, 5e-07], [233910, 2.5e-07], [239310, 2.5e-07], [244710, 1e-07], [250110, 1e-07], [255510, 5e-08], [260910, 5e-08], [266310, 1e-08]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.15, "final_epsilon": 0.05, "epsilon_timesteps": 264960}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x14a3b79d0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 172.33769178390503, "iterations_since_restore": 16, "perf": {"cpu_util_percent": 24.686666666666667, "ram_util_percent": 57.42666666666666}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 5.952777777777779e-05, "entropy_coeff": 0.05, "policy_entropy": -701.402490234375, "policy_loss": -14639013273.6, "vf_loss": 225435489.6}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 263.0, "diff_num_grad_updates_vs_sampler_policy": 262.0}}, "num_env_steps_sampled": 139080, "num_env_steps_trained": 139080, "num_agent_steps_sampled": 139080, "num_agent_steps_trained": 139080}, "sampler_results": {"episode_reward_max": -1623.6366775976976, "episode_reward_min": -11690.365175060395, "episode_reward_mean": -4363.734115318753, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-2119.171799360851, -2114.331502917478, -2056.15284991328, -2205.7189272174583, -2099.324925286358, -1783.6167235197013, -2198.8005148640627, -1959.4255405533393, -2031.9709274873644, -2146.934807250676, -1867.9332144874832, -1732.3916216536554, -2234.2070943633057, -1983.003248740253, -1810.115942693552, -1880.740363158521, -2051.0059405638153, -2099.0961425143632, -1861.2511987318119, -1623.6366775976976, -1833.7213963946356, -2170.1685866460275, -1845.8168296279084, -2224.92297284634, -2053.926900457367, -1999.6749001357318, -1761.9641895342056, -1845.4101580372842, -1660.79700381068, -2200.276684034361, -2099.2137564929294, -2113.220094078378, -1999.6454971942321, -2243.898806316024, -2064.683193837476, -2170.1598230617215, -2001.9935854335158, -2826.9278593746703, -2549.0906692719304, -4530.099241295323, -9055.053679015089, -11557.62411448131, -11690.365175060395, -11536.492754198262, -11315.672754182919, -11554.547061699, -11685.842712742626, -11372.3699668468, -11461.865010105279, -11401.475155261835, -11457.1546918822, -11477.147275717844, -11657.855649944562], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.5095547231229345, "mean_inference_ms": 0.40392775060523217, "mean_action_processing_ms": 0.09845335961549734, "mean_env_wait_ms": 1.8852229191781484, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00400408258977926, "StateBufferConnector_ms": 0.0031354292383733787, "ViewRequirementAgentConnector_ms": 0.07111756306774211}}, "episode_reward_max": -1623.6366775976976, "episode_reward_min": -11690.365175060395, "episode_reward_mean": -4363.734115318753, "episode_len_mean": 360.0, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-2119.171799360851, -2114.331502917478, -2056.15284991328, -2205.7189272174583, -2099.324925286358, -1783.6167235197013, -2198.8005148640627, -1959.4255405533393, -2031.9709274873644, -2146.934807250676, -1867.9332144874832, -1732.3916216536554, -2234.2070943633057, -1983.003248740253, -1810.115942693552, -1880.740363158521, -2051.0059405638153, -2099.0961425143632, -1861.2511987318119, -1623.6366775976976, -1833.7213963946356, -2170.1685866460275, -1845.8168296279084, -2224.92297284634, -2053.926900457367, -1999.6749001357318, -1761.9641895342056, -1845.4101580372842, -1660.79700381068, -2200.276684034361, -2099.2137564929294, -2113.220094078378, -1999.6454971942321, -2243.898806316024, -2064.683193837476, -2170.1598230617215, -2001.9935854335158, -2826.9278593746703, -2549.0906692719304, -4530.099241295323, -9055.053679015089, -11557.62411448131, -11690.365175060395, -11536.492754198262, -11315.672754182919, -11554.547061699, -11685.842712742626, -11372.3699668468, -11461.865010105279, -11401.475155261835, -11457.1546918822, -11477.147275717844, -11657.855649944562], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.5095547231229345, "mean_inference_ms": 0.40392775060523217, "mean_action_processing_ms": 0.09845335961549734, "mean_env_wait_ms": 1.8852229191781484, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00400408258977926, "StateBufferConnector_ms": 0.0031354292383733787, "ViewRequirementAgentConnector_ms": 0.07111756306774211}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 139080, "num_agent_steps_trained": 139080, "num_env_steps_sampled": 139080, "num_env_steps_trained": 139080, "num_env_steps_sampled_this_iter": 1080, "num_env_steps_trained_this_iter": 1080, "num_env_steps_sampled_throughput_per_sec": 104.45863571623528, "num_env_steps_trained_throughput_per_sec": 104.45863571623528, "timesteps_total": 139080, "num_steps_trained_this_iter": 1080, "agent_timesteps_total": 139080, "timers": {"training_iteration_time_ms": 3416.044, "sample_time_ms": 3405.027, "load_time_ms": 0.314, "load_throughput": 1145897.731, "learn_time_ms": 9.906, "learn_throughput": 36341.59, "synch_weights_time_ms": 0.752}, "counters": {"num_env_steps_sampled": 139080, "num_env_steps_trained": 139080, "num_agent_steps_sampled": 139080, "num_agent_steps_trained": 139080}, "done": false, "episodes_total": 867, "training_iteration": 177, "trial_id": "14306_00000", "date": "2023-07-26_18-10-13", "timestamp": 1690384213, "time_this_iter_s": 10.341580867767334, "time_total_s": 1912.509999513626, "pid": 7707, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[131310, 5e-05], [136710, 8e-05], [142110, 2.5e-05], [147510, 2.5e-05], [152910, 2.5e-05], [158310, 2.5e-05], [163710, 1e-05], [169110, 1e-05], [174510, 1e-05], [179910, 5e-06], [185310, 5e-06], [190710, 5e-06], [196110, 5e-06], [201510, 1e-06], [206910, 1e-06], [212310, 1e-06], [217710, 1e-06], [223110, 5e-07], [228510, 5e-07], [233910, 2.5e-07], [239310, 2.5e-07], [244710, 1e-07], [250110, 1e-07], [255510, 5e-08], [260910, 5e-08], [266310, 1e-08]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.15, "final_epsilon": 0.05, "epsilon_timesteps": 264960}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x14a3b79d0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 182.67927265167236, "iterations_since_restore": 17, "perf": {"cpu_util_percent": 25.173333333333332, "ram_util_percent": 58.179999999999986}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 4.852777777777778e-05, "entropy_coeff": 0.05, "policy_entropy": -743.979345703125, "policy_loss": -22154701619.2, "vf_loss": 225561049.6}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 278.0, "diff_num_grad_updates_vs_sampler_policy": 277.0}}, "num_env_steps_sampled": 140160, "num_env_steps_trained": 140160, "num_agent_steps_sampled": 140160, "num_agent_steps_trained": 140160}, "sampler_results": {"episode_reward_max": -1623.6366775976976, "episode_reward_min": -11690.365175060395, "episode_reward_mean": -4754.26009786903, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-2119.171799360851, -2114.331502917478, -2056.15284991328, -2205.7189272174583, -2099.324925286358, -1783.6167235197013, -2198.8005148640627, -1959.4255405533393, -2031.9709274873644, -2146.934807250676, -1867.9332144874832, -1732.3916216536554, -2234.2070943633057, -1983.003248740253, -1810.115942693552, -1880.740363158521, -2051.0059405638153, -2099.0961425143632, -1861.2511987318119, -1623.6366775976976, -1833.7213963946356, -2170.1685866460275, -1845.8168296279084, -2224.92297284634, -2053.926900457367, -1999.6749001357318, -1761.9641895342056, -1845.4101580372842, -1660.79700381068, -2200.276684034361, -2099.2137564929294, -2113.220094078378, -1999.6454971942321, -2243.898806316024, -2064.683193837476, -2170.1598230617215, -2001.9935854335158, -2826.9278593746703, -2549.0906692719304, -4530.099241295323, -9055.053679015089, -11557.62411448131, -11690.365175060395, -11536.492754198262, -11315.672754182919, -11554.547061699, -11685.842712742626, -11372.3699668468, -11461.865010105279, -11401.475155261835, -11457.1546918822, -11477.147275717844, -11657.855649944562, -11649.264979809974, -11652.754583469581, -11658.63780549219], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.509601455781834, "mean_inference_ms": 0.4033182358386429, "mean_action_processing_ms": 0.09834017325003143, "mean_env_wait_ms": 1.8655522451142144, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003959451402936663, "StateBufferConnector_ms": 0.0031215803963797434, "ViewRequirementAgentConnector_ms": 0.070779664175851}}, "episode_reward_max": -1623.6366775976976, "episode_reward_min": -11690.365175060395, "episode_reward_mean": -4754.26009786903, "episode_len_mean": 360.0, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-2119.171799360851, -2114.331502917478, -2056.15284991328, -2205.7189272174583, -2099.324925286358, -1783.6167235197013, -2198.8005148640627, -1959.4255405533393, -2031.9709274873644, -2146.934807250676, -1867.9332144874832, -1732.3916216536554, -2234.2070943633057, -1983.003248740253, -1810.115942693552, -1880.740363158521, -2051.0059405638153, -2099.0961425143632, -1861.2511987318119, -1623.6366775976976, -1833.7213963946356, -2170.1685866460275, -1845.8168296279084, -2224.92297284634, -2053.926900457367, -1999.6749001357318, -1761.9641895342056, -1845.4101580372842, -1660.79700381068, -2200.276684034361, -2099.2137564929294, -2113.220094078378, -1999.6454971942321, -2243.898806316024, -2064.683193837476, -2170.1598230617215, -2001.9935854335158, -2826.9278593746703, -2549.0906692719304, -4530.099241295323, -9055.053679015089, -11557.62411448131, -11690.365175060395, -11536.492754198262, -11315.672754182919, -11554.547061699, -11685.842712742626, -11372.3699668468, -11461.865010105279, -11401.475155261835, -11457.1546918822, -11477.147275717844, -11657.855649944562, -11649.264979809974, -11652.754583469581, -11658.63780549219], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.509601455781834, "mean_inference_ms": 0.4033182358386429, "mean_action_processing_ms": 0.09834017325003143, "mean_env_wait_ms": 1.8655522451142144, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003959451402936663, "StateBufferConnector_ms": 0.0031215803963797434, "ViewRequirementAgentConnector_ms": 0.070779664175851}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 140160, "num_agent_steps_trained": 140160, "num_env_steps_sampled": 140160, "num_env_steps_trained": 140160, "num_env_steps_sampled_this_iter": 1080, "num_env_steps_trained_this_iter": 1080, "num_env_steps_sampled_throughput_per_sec": 103.01795917864237, "num_env_steps_trained_throughput_per_sec": 103.01795917864237, "timesteps_total": 140160, "num_steps_trained_this_iter": 1080, "agent_timesteps_total": 140160, "timers": {"training_iteration_time_ms": 3448.227, "sample_time_ms": 3437.167, "load_time_ms": 0.319, "load_throughput": 1129187.436, "learn_time_ms": 9.96, "learn_throughput": 36144.637, "synch_weights_time_ms": 0.736}, "counters": {"num_env_steps_sampled": 140160, "num_env_steps_trained": 140160, "num_agent_steps_sampled": 140160, "num_agent_steps_trained": 140160}, "done": false, "episodes_total": 870, "training_iteration": 178, "trial_id": "14306_00000", "date": "2023-07-26_18-10-23", "timestamp": 1690384223, "time_this_iter_s": 10.486242055892944, "time_total_s": 1922.996241569519, "pid": 7707, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[131310, 5e-05], [136710, 8e-05], [142110, 2.5e-05], [147510, 2.5e-05], [152910, 2.5e-05], [158310, 2.5e-05], [163710, 1e-05], [169110, 1e-05], [174510, 1e-05], [179910, 5e-06], [185310, 5e-06], [190710, 5e-06], [196110, 5e-06], [201510, 1e-06], [206910, 1e-06], [212310, 1e-06], [217710, 1e-06], [223110, 5e-07], [228510, 5e-07], [233910, 2.5e-07], [239310, 2.5e-07], [244710, 1e-07], [250110, 1e-07], [255510, 5e-08], [260910, 5e-08], [266310, 1e-08]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.15, "final_epsilon": 0.05, "epsilon_timesteps": 264960}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x14a3b79d0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 193.1655147075653, "iterations_since_restore": 18, "perf": {"cpu_util_percent": 18.586666666666666, "ram_util_percent": 57.839999999999996}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 3.752777777777778e-05, "entropy_coeff": 0.05, "policy_entropy": -777.7087280273438, "policy_loss": -34986770432.0, "vf_loss": 224043084.8}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 293.0, "diff_num_grad_updates_vs_sampler_policy": 292.0}}, "num_env_steps_sampled": 141240, "num_env_steps_trained": 141240, "num_agent_steps_sampled": 141240, "num_agent_steps_trained": 141240}, "sampler_results": {"episode_reward_max": -1623.6366775976976, "episode_reward_min": -11694.445759932762, "episode_reward_mean": -5104.3346016870555, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-2119.171799360851, -2114.331502917478, -2056.15284991328, -2205.7189272174583, -2099.324925286358, -1783.6167235197013, -2198.8005148640627, -1959.4255405533393, -2031.9709274873644, -2146.934807250676, -1867.9332144874832, -1732.3916216536554, -2234.2070943633057, -1983.003248740253, -1810.115942693552, -1880.740363158521, -2051.0059405638153, -2099.0961425143632, -1861.2511987318119, -1623.6366775976976, -1833.7213963946356, -2170.1685866460275, -1845.8168296279084, -2224.92297284634, -2053.926900457367, -1999.6749001357318, -1761.9641895342056, -1845.4101580372842, -1660.79700381068, -2200.276684034361, -2099.2137564929294, -2113.220094078378, -1999.6454971942321, -2243.898806316024, -2064.683193837476, -2170.1598230617215, -2001.9935854335158, -2826.9278593746703, -2549.0906692719304, -4530.099241295323, -9055.053679015089, -11557.62411448131, -11690.365175060395, -11536.492754198262, -11315.672754182919, -11554.547061699, -11685.842712742626, -11372.3699668468, -11461.865010105279, -11401.475155261835, -11457.1546918822, -11477.147275717844, -11657.855649944562, -11649.264979809974, -11652.754583469581, -11658.63780549219, -11634.65449256153, -11694.445759932762, -11588.07576637634], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.509887061876751, "mean_inference_ms": 0.4027098312757844, "mean_action_processing_ms": 0.09822582872303671, "mean_env_wait_ms": 1.8478921300319864, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003914913888704978, "StateBufferConnector_ms": 0.003105098918332892, "ViewRequirementAgentConnector_ms": 0.07048299757100768}}, "episode_reward_max": -1623.6366775976976, "episode_reward_min": -11694.445759932762, "episode_reward_mean": -5104.3346016870555, "episode_len_mean": 360.0, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-2119.171799360851, -2114.331502917478, -2056.15284991328, -2205.7189272174583, -2099.324925286358, -1783.6167235197013, -2198.8005148640627, -1959.4255405533393, -2031.9709274873644, -2146.934807250676, -1867.9332144874832, -1732.3916216536554, -2234.2070943633057, -1983.003248740253, -1810.115942693552, -1880.740363158521, -2051.0059405638153, -2099.0961425143632, -1861.2511987318119, -1623.6366775976976, -1833.7213963946356, -2170.1685866460275, -1845.8168296279084, -2224.92297284634, -2053.926900457367, -1999.6749001357318, -1761.9641895342056, -1845.4101580372842, -1660.79700381068, -2200.276684034361, -2099.2137564929294, -2113.220094078378, -1999.6454971942321, -2243.898806316024, -2064.683193837476, -2170.1598230617215, -2001.9935854335158, -2826.9278593746703, -2549.0906692719304, -4530.099241295323, -9055.053679015089, -11557.62411448131, -11690.365175060395, -11536.492754198262, -11315.672754182919, -11554.547061699, -11685.842712742626, -11372.3699668468, -11461.865010105279, -11401.475155261835, -11457.1546918822, -11477.147275717844, -11657.855649944562, -11649.264979809974, -11652.754583469581, -11658.63780549219, -11634.65449256153, -11694.445759932762, -11588.07576637634], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.509887061876751, "mean_inference_ms": 0.4027098312757844, "mean_action_processing_ms": 0.09822582872303671, "mean_env_wait_ms": 1.8478921300319864, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003914913888704978, "StateBufferConnector_ms": 0.003105098918332892, "ViewRequirementAgentConnector_ms": 0.07048299757100768}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 141240, "num_agent_steps_trained": 141240, "num_env_steps_sampled": 141240, "num_env_steps_trained": 141240, "num_env_steps_sampled_this_iter": 1080, "num_env_steps_trained_this_iter": 1080, "num_env_steps_sampled_throughput_per_sec": 103.68641869813017, "num_env_steps_trained_throughput_per_sec": 103.68641869813017, "timesteps_total": 141240, "num_steps_trained_this_iter": 1080, "agent_timesteps_total": 141240, "timers": {"training_iteration_time_ms": 3463.921, "sample_time_ms": 3453.007, "load_time_ms": 0.317, "load_throughput": 1136240.078, "learn_time_ms": 9.841, "learn_throughput": 36583.195, "synch_weights_time_ms": 0.713}, "counters": {"num_env_steps_sampled": 141240, "num_env_steps_trained": 141240, "num_agent_steps_sampled": 141240, "num_agent_steps_trained": 141240}, "done": false, "episodes_total": 873, "training_iteration": 179, "trial_id": "14306_00000", "date": "2023-07-26_18-10-33", "timestamp": 1690384233, "time_this_iter_s": 10.41864800453186, "time_total_s": 1933.414889574051, "pid": 7707, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[131310, 5e-05], [136710, 8e-05], [142110, 2.5e-05], [147510, 2.5e-05], [152910, 2.5e-05], [158310, 2.5e-05], [163710, 1e-05], [169110, 1e-05], [174510, 1e-05], [179910, 5e-06], [185310, 5e-06], [190710, 5e-06], [196110, 5e-06], [201510, 1e-06], [206910, 1e-06], [212310, 1e-06], [217710, 1e-06], [223110, 5e-07], [228510, 5e-07], [233910, 2.5e-07], [239310, 2.5e-07], [244710, 1e-07], [250110, 1e-07], [255510, 5e-08], [260910, 5e-08], [266310, 1e-08]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.15, "final_epsilon": 0.05, "epsilon_timesteps": 264960}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x14a3b79d0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 203.58416271209717, "iterations_since_restore": 19, "perf": {"cpu_util_percent": 20.746666666666666, "ram_util_percent": 57.940000000000005}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 2.5e-05, "entropy_coeff": 0.05, "policy_entropy": -808.1730102539062, "policy_loss": -40209272012.8, "vf_loss": 217022608.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 313.0, "diff_num_grad_updates_vs_sampler_policy": 312.0}}, "num_env_steps_sampled": 142680, "num_env_steps_trained": 142680, "num_agent_steps_sampled": 142680, "num_agent_steps_trained": 142680}, "sampler_results": {"episode_reward_max": -1623.6366775976976, "episode_reward_min": -11694.445759932762, "episode_reward_mean": -5509.8636604031435, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-2119.171799360851, -2114.331502917478, -2056.15284991328, -2205.7189272174583, -2099.324925286358, -1783.6167235197013, -2198.8005148640627, -1959.4255405533393, -2031.9709274873644, -2146.934807250676, -1867.9332144874832, -1732.3916216536554, -2234.2070943633057, -1983.003248740253, -1810.115942693552, -1880.740363158521, -2051.0059405638153, -2099.0961425143632, -1861.2511987318119, -1623.6366775976976, -1833.7213963946356, -2170.1685866460275, -1845.8168296279084, -2224.92297284634, -2053.926900457367, -1999.6749001357318, -1761.9641895342056, -1845.4101580372842, -1660.79700381068, -2200.276684034361, -2099.2137564929294, -2113.220094078378, -1999.6454971942321, -2243.898806316024, -2064.683193837476, -2170.1598230617215, -2001.9935854335158, -2826.9278593746703, -2549.0906692719304, -4530.099241295323, -9055.053679015089, -11557.62411448131, -11690.365175060395, -11536.492754198262, -11315.672754182919, -11554.547061699, -11685.842712742626, -11372.3699668468, -11461.865010105279, -11401.475155261835, -11457.1546918822, -11477.147275717844, -11657.855649944562, -11649.264979809974, -11652.754583469581, -11658.63780549219, -11634.65449256153, -11694.445759932762, -11588.07576637634, -11609.267342366833, -11431.665057041375, -11599.03386030396, -11325.702846149565], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.509720362537394, "mean_inference_ms": 0.4019371333881243, "mean_action_processing_ms": 0.09808000262297714, "mean_env_wait_ms": 1.8261585520845833, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0038695713830372643, "StateBufferConnector_ms": 0.0030877098204597593, "ViewRequirementAgentConnector_ms": 0.07018399617028614}}, "episode_reward_max": -1623.6366775976976, "episode_reward_min": -11694.445759932762, "episode_reward_mean": -5509.8636604031435, "episode_len_mean": 360.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-2119.171799360851, -2114.331502917478, -2056.15284991328, -2205.7189272174583, -2099.324925286358, -1783.6167235197013, -2198.8005148640627, -1959.4255405533393, -2031.9709274873644, -2146.934807250676, -1867.9332144874832, -1732.3916216536554, -2234.2070943633057, -1983.003248740253, -1810.115942693552, -1880.740363158521, -2051.0059405638153, -2099.0961425143632, -1861.2511987318119, -1623.6366775976976, -1833.7213963946356, -2170.1685866460275, -1845.8168296279084, -2224.92297284634, -2053.926900457367, -1999.6749001357318, -1761.9641895342056, -1845.4101580372842, -1660.79700381068, -2200.276684034361, -2099.2137564929294, -2113.220094078378, -1999.6454971942321, -2243.898806316024, -2064.683193837476, -2170.1598230617215, -2001.9935854335158, -2826.9278593746703, -2549.0906692719304, -4530.099241295323, -9055.053679015089, -11557.62411448131, -11690.365175060395, -11536.492754198262, -11315.672754182919, -11554.547061699, -11685.842712742626, -11372.3699668468, -11461.865010105279, -11401.475155261835, -11457.1546918822, -11477.147275717844, -11657.855649944562, -11649.264979809974, -11652.754583469581, -11658.63780549219, -11634.65449256153, -11694.445759932762, -11588.07576637634, -11609.267342366833, -11431.665057041375, -11599.03386030396, -11325.702846149565], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.509720362537394, "mean_inference_ms": 0.4019371333881243, "mean_action_processing_ms": 0.09808000262297714, "mean_env_wait_ms": 1.8261585520845833, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0038695713830372643, "StateBufferConnector_ms": 0.0030877098204597593, "ViewRequirementAgentConnector_ms": 0.07018399617028614}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 142680, "num_agent_steps_trained": 142680, "num_env_steps_sampled": 142680, "num_env_steps_trained": 142680, "num_env_steps_sampled_this_iter": 1440, "num_env_steps_trained_this_iter": 1440, "num_env_steps_sampled_throughput_per_sec": 108.22819230593278, "num_env_steps_trained_throughput_per_sec": 108.22819230593278, "timesteps_total": 142680, "num_steps_trained_this_iter": 1440, "agent_timesteps_total": 142680, "timers": {"training_iteration_time_ms": 3420.473, "sample_time_ms": 3409.681, "load_time_ms": 0.302, "load_throughput": 1193730.287, "learn_time_ms": 9.751, "learn_throughput": 36918.711, "synch_weights_time_ms": 0.696}, "counters": {"num_env_steps_sampled": 142680, "num_env_steps_trained": 142680, "num_agent_steps_sampled": 142680, "num_agent_steps_trained": 142680}, "done": false, "episodes_total": 877, "training_iteration": 180, "trial_id": "14306_00000", "date": "2023-07-26_18-10-47", "timestamp": 1690384247, "time_this_iter_s": 13.30792498588562, "time_total_s": 1946.7228145599365, "pid": 7707, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[131310, 5e-05], [136710, 8e-05], [142110, 2.5e-05], [147510, 2.5e-05], [152910, 2.5e-05], [158310, 2.5e-05], [163710, 1e-05], [169110, 1e-05], [174510, 1e-05], [179910, 5e-06], [185310, 5e-06], [190710, 5e-06], [196110, 5e-06], [201510, 1e-06], [206910, 1e-06], [212310, 1e-06], [217710, 1e-06], [223110, 5e-07], [228510, 5e-07], [233910, 2.5e-07], [239310, 2.5e-07], [244710, 1e-07], [250110, 1e-07], [255510, 5e-08], [260910, 5e-08], [266310, 1e-08]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.15, "final_epsilon": 0.05, "epsilon_timesteps": 264960}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x14a3b79d0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 216.8920876979828, "iterations_since_restore": 20, "perf": {"cpu_util_percent": 25.333333333333332, "ram_util_percent": 58.650000000000006}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 2.5e-05, "entropy_coeff": 0.05, "policy_entropy": -827.292333984375, "policy_loss": -36773518540.8, "vf_loss": 220785627.2}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 328.0, "diff_num_grad_updates_vs_sampler_policy": 327.0}}, "num_env_steps_sampled": 143760, "num_env_steps_trained": 143760, "num_agent_steps_sampled": 143760, "num_agent_steps_trained": 143760}, "sampler_results": {"episode_reward_max": -1623.6366775976976, "episode_reward_min": -11694.445759932762, "episode_reward_mean": -5781.839787034267, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-2119.171799360851, -2114.331502917478, -2056.15284991328, -2205.7189272174583, -2099.324925286358, -1783.6167235197013, -2198.8005148640627, -1959.4255405533393, -2031.9709274873644, -2146.934807250676, -1867.9332144874832, -1732.3916216536554, -2234.2070943633057, -1983.003248740253, -1810.115942693552, -1880.740363158521, -2051.0059405638153, -2099.0961425143632, -1861.2511987318119, -1623.6366775976976, -1833.7213963946356, -2170.1685866460275, -1845.8168296279084, -2224.92297284634, -2053.926900457367, -1999.6749001357318, -1761.9641895342056, -1845.4101580372842, -1660.79700381068, -2200.276684034361, -2099.2137564929294, -2113.220094078378, -1999.6454971942321, -2243.898806316024, -2064.683193837476, -2170.1598230617215, -2001.9935854335158, -2826.9278593746703, -2549.0906692719304, -4530.099241295323, -9055.053679015089, -11557.62411448131, -11690.365175060395, -11536.492754198262, -11315.672754182919, -11554.547061699, -11685.842712742626, -11372.3699668468, -11461.865010105279, -11401.475155261835, -11457.1546918822, -11477.147275717844, -11657.855649944562, -11649.264979809974, -11652.754583469581, -11658.63780549219, -11634.65449256153, -11694.445759932762, -11588.07576637634, -11609.267342366833, -11431.665057041375, -11599.03386030396, -11325.702846149565, -11585.644624276785, -11422.85799119354, -11471.512723393245], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.5099556875593905, "mean_inference_ms": 0.40138999311486495, "mean_action_processing_ms": 0.09797582287332184, "mean_env_wait_ms": 1.8112748441974225, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0038920026836973248, "StateBufferConnector_ms": 0.00308246323556611, "ViewRequirementAgentConnector_ms": 0.06999716614231918}}, "episode_reward_max": -1623.6366775976976, "episode_reward_min": -11694.445759932762, "episode_reward_mean": -5781.839787034267, "episode_len_mean": 360.0, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-2119.171799360851, -2114.331502917478, -2056.15284991328, -2205.7189272174583, -2099.324925286358, -1783.6167235197013, -2198.8005148640627, -1959.4255405533393, -2031.9709274873644, -2146.934807250676, -1867.9332144874832, -1732.3916216536554, -2234.2070943633057, -1983.003248740253, -1810.115942693552, -1880.740363158521, -2051.0059405638153, -2099.0961425143632, -1861.2511987318119, -1623.6366775976976, -1833.7213963946356, -2170.1685866460275, -1845.8168296279084, -2224.92297284634, -2053.926900457367, -1999.6749001357318, -1761.9641895342056, -1845.4101580372842, -1660.79700381068, -2200.276684034361, -2099.2137564929294, -2113.220094078378, -1999.6454971942321, -2243.898806316024, -2064.683193837476, -2170.1598230617215, -2001.9935854335158, -2826.9278593746703, -2549.0906692719304, -4530.099241295323, -9055.053679015089, -11557.62411448131, -11690.365175060395, -11536.492754198262, -11315.672754182919, -11554.547061699, -11685.842712742626, -11372.3699668468, -11461.865010105279, -11401.475155261835, -11457.1546918822, -11477.147275717844, -11657.855649944562, -11649.264979809974, -11652.754583469581, -11658.63780549219, -11634.65449256153, -11694.445759932762, -11588.07576637634, -11609.267342366833, -11431.665057041375, -11599.03386030396, -11325.702846149565, -11585.644624276785, -11422.85799119354, -11471.512723393245], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.5099556875593905, "mean_inference_ms": 0.40138999311486495, "mean_action_processing_ms": 0.09797582287332184, "mean_env_wait_ms": 1.8112748441974225, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0038920026836973248, "StateBufferConnector_ms": 0.00308246323556611, "ViewRequirementAgentConnector_ms": 0.06999716614231918}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 143760, "num_agent_steps_trained": 143760, "num_env_steps_sampled": 143760, "num_env_steps_trained": 143760, "num_env_steps_sampled_this_iter": 1080, "num_env_steps_trained_this_iter": 1080, "num_env_steps_sampled_throughput_per_sec": 104.62720459846649, "num_env_steps_trained_throughput_per_sec": 104.62720459846649, "timesteps_total": 143760, "num_steps_trained_this_iter": 1080, "agent_timesteps_total": 143760, "timers": {"training_iteration_time_ms": 3404.348, "sample_time_ms": 3393.55, "load_time_ms": 0.296, "load_throughput": 1216034.018, "learn_time_ms": 9.763, "learn_throughput": 36872.282, "synch_weights_time_ms": 0.695}, "counters": {"num_env_steps_sampled": 143760, "num_env_steps_trained": 143760, "num_agent_steps_sampled": 143760, "num_agent_steps_trained": 143760}, "done": false, "episodes_total": 880, "training_iteration": 181, "trial_id": "14306_00000", "date": "2023-07-26_18-10-57", "timestamp": 1690384257, "time_this_iter_s": 10.325160264968872, "time_total_s": 1957.0479748249054, "pid": 7707, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[131310, 5e-05], [136710, 8e-05], [142110, 2.5e-05], [147510, 2.5e-05], [152910, 2.5e-05], [158310, 2.5e-05], [163710, 1e-05], [169110, 1e-05], [174510, 1e-05], [179910, 5e-06], [185310, 5e-06], [190710, 5e-06], [196110, 5e-06], [201510, 1e-06], [206910, 1e-06], [212310, 1e-06], [217710, 1e-06], [223110, 5e-07], [228510, 5e-07], [233910, 2.5e-07], [239310, 2.5e-07], [244710, 1e-07], [250110, 1e-07], [255510, 5e-08], [260910, 5e-08], [266310, 1e-08]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.15, "final_epsilon": 0.05, "epsilon_timesteps": 264960}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x14a3b79d0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 227.21724796295166, "iterations_since_restore": 21, "perf": {"cpu_util_percent": 20.206666666666667, "ram_util_percent": 58.16666666666668}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 2.5e-05, "entropy_coeff": 0.05, "policy_entropy": -846.6470947265625, "policy_loss": -86953897984.0, "vf_loss": 221522457.6}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 343.0, "diff_num_grad_updates_vs_sampler_policy": 342.0}}, "num_env_steps_sampled": 144840, "num_env_steps_trained": 144840, "num_agent_steps_sampled": 144840, "num_agent_steps_trained": 144840}, "sampler_results": {"episode_reward_max": -1623.6366775976976, "episode_reward_min": -11717.425358625549, "episode_reward_mean": -6033.528560462516, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-2119.171799360851, -2114.331502917478, -2056.15284991328, -2205.7189272174583, -2099.324925286358, -1783.6167235197013, -2198.8005148640627, -1959.4255405533393, -2031.9709274873644, -2146.934807250676, -1867.9332144874832, -1732.3916216536554, -2234.2070943633057, -1983.003248740253, -1810.115942693552, -1880.740363158521, -2051.0059405638153, -2099.0961425143632, -1861.2511987318119, -1623.6366775976976, -1833.7213963946356, -2170.1685866460275, -1845.8168296279084, -2224.92297284634, -2053.926900457367, -1999.6749001357318, -1761.9641895342056, -1845.4101580372842, -1660.79700381068, -2200.276684034361, -2099.2137564929294, -2113.220094078378, -1999.6454971942321, -2243.898806316024, -2064.683193837476, -2170.1598230617215, -2001.9935854335158, -2826.9278593746703, -2549.0906692719304, -4530.099241295323, -9055.053679015089, -11557.62411448131, -11690.365175060395, -11536.492754198262, -11315.672754182919, -11554.547061699, -11685.842712742626, -11372.3699668468, -11461.865010105279, -11401.475155261835, -11457.1546918822, -11477.147275717844, -11657.855649944562, -11649.264979809974, -11652.754583469581, -11658.63780549219, -11634.65449256153, -11694.445759932762, -11588.07576637634, -11609.267342366833, -11431.665057041375, -11599.03386030396, -11325.702846149565, -11585.644624276785, -11422.85799119354, -11471.512723393245, -11404.199834204574, -11717.425358625549, -11590.419534821875], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.510495928690585, "mean_inference_ms": 0.4008742725630215, "mean_action_processing_ms": 0.09787635680221383, "mean_env_wait_ms": 1.7975318386867278, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003909719163093014, "StateBufferConnector_ms": 0.003069034521130548, "ViewRequirementAgentConnector_ms": 0.06981034209762794}}, "episode_reward_max": -1623.6366775976976, "episode_reward_min": -11717.425358625549, "episode_reward_mean": -6033.528560462516, "episode_len_mean": 360.0, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-2119.171799360851, -2114.331502917478, -2056.15284991328, -2205.7189272174583, -2099.324925286358, -1783.6167235197013, -2198.8005148640627, -1959.4255405533393, -2031.9709274873644, -2146.934807250676, -1867.9332144874832, -1732.3916216536554, -2234.2070943633057, -1983.003248740253, -1810.115942693552, -1880.740363158521, -2051.0059405638153, -2099.0961425143632, -1861.2511987318119, -1623.6366775976976, -1833.7213963946356, -2170.1685866460275, -1845.8168296279084, -2224.92297284634, -2053.926900457367, -1999.6749001357318, -1761.9641895342056, -1845.4101580372842, -1660.79700381068, -2200.276684034361, -2099.2137564929294, -2113.220094078378, -1999.6454971942321, -2243.898806316024, -2064.683193837476, -2170.1598230617215, -2001.9935854335158, -2826.9278593746703, -2549.0906692719304, -4530.099241295323, -9055.053679015089, -11557.62411448131, -11690.365175060395, -11536.492754198262, -11315.672754182919, -11554.547061699, -11685.842712742626, -11372.3699668468, -11461.865010105279, -11401.475155261835, -11457.1546918822, -11477.147275717844, -11657.855649944562, -11649.264979809974, -11652.754583469581, -11658.63780549219, -11634.65449256153, -11694.445759932762, -11588.07576637634, -11609.267342366833, -11431.665057041375, -11599.03386030396, -11325.702846149565, -11585.644624276785, -11422.85799119354, -11471.512723393245, -11404.199834204574, -11717.425358625549, -11590.419534821875], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.510495928690585, "mean_inference_ms": 0.4008742725630215, "mean_action_processing_ms": 0.09787635680221383, "mean_env_wait_ms": 1.7975318386867278, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003909719163093014, "StateBufferConnector_ms": 0.003069034521130548, "ViewRequirementAgentConnector_ms": 0.06981034209762794}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 144840, "num_agent_steps_trained": 144840, "num_env_steps_sampled": 144840, "num_env_steps_trained": 144840, "num_env_steps_sampled_this_iter": 1080, "num_env_steps_trained_this_iter": 1080, "num_env_steps_sampled_throughput_per_sec": 103.76102847160521, "num_env_steps_trained_throughput_per_sec": 103.76102847160521, "timesteps_total": 144840, "num_steps_trained_this_iter": 1080, "agent_timesteps_total": 144840, "timers": {"training_iteration_time_ms": 3403.599, "sample_time_ms": 3392.801, "load_time_ms": 0.298, "load_throughput": 1207573.129, "learn_time_ms": 9.756, "learn_throughput": 36900.847, "synch_weights_time_ms": 0.699}, "counters": {"num_env_steps_sampled": 144840, "num_env_steps_trained": 144840, "num_agent_steps_sampled": 144840, "num_agent_steps_trained": 144840}, "done": false, "episodes_total": 883, "training_iteration": 182, "trial_id": "14306_00000", "date": "2023-07-26_18-11-08", "timestamp": 1690384268, "time_this_iter_s": 10.411565065383911, "time_total_s": 1967.4595398902893, "pid": 7707, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[131310, 5e-05], [136710, 8e-05], [142110, 2.5e-05], [147510, 2.5e-05], [152910, 2.5e-05], [158310, 2.5e-05], [163710, 1e-05], [169110, 1e-05], [174510, 1e-05], [179910, 5e-06], [185310, 5e-06], [190710, 5e-06], [196110, 5e-06], [201510, 1e-06], [206910, 1e-06], [212310, 1e-06], [217710, 1e-06], [223110, 5e-07], [228510, 5e-07], [233910, 2.5e-07], [239310, 2.5e-07], [244710, 1e-07], [250110, 1e-07], [255510, 5e-08], [260910, 5e-08], [266310, 1e-08]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.15, "final_epsilon": 0.05, "epsilon_timesteps": 264960}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x14a3b79d0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 237.62881302833557, "iterations_since_restore": 22, "perf": {"cpu_util_percent": 19.9, "ram_util_percent": 58.160000000000004}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 2.5e-05, "entropy_coeff": 0.05, "policy_entropy": -865.8777099609375, "policy_loss": -93061226496.0, "vf_loss": 228113905.6}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 358.0, "diff_num_grad_updates_vs_sampler_policy": 357.0}}, "num_env_steps_sampled": 145920, "num_env_steps_trained": 145920, "num_agent_steps_sampled": 145920, "num_agent_steps_trained": 145920}, "sampler_results": {"episode_reward_max": -1623.6366775976976, "episode_reward_min": -11732.979388276095, "episode_reward_mean": -6266.586305827362, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-2119.171799360851, -2114.331502917478, -2056.15284991328, -2205.7189272174583, -2099.324925286358, -1783.6167235197013, -2198.8005148640627, -1959.4255405533393, -2031.9709274873644, -2146.934807250676, -1867.9332144874832, -1732.3916216536554, -2234.2070943633057, -1983.003248740253, -1810.115942693552, -1880.740363158521, -2051.0059405638153, -2099.0961425143632, -1861.2511987318119, -1623.6366775976976, -1833.7213963946356, -2170.1685866460275, -1845.8168296279084, -2224.92297284634, -2053.926900457367, -1999.6749001357318, -1761.9641895342056, -1845.4101580372842, -1660.79700381068, -2200.276684034361, -2099.2137564929294, -2113.220094078378, -1999.6454971942321, -2243.898806316024, -2064.683193837476, -2170.1598230617215, -2001.9935854335158, -2826.9278593746703, -2549.0906692719304, -4530.099241295323, -9055.053679015089, -11557.62411448131, -11690.365175060395, -11536.492754198262, -11315.672754182919, -11554.547061699, -11685.842712742626, -11372.3699668468, -11461.865010105279, -11401.475155261835, -11457.1546918822, -11477.147275717844, -11657.855649944562, -11649.264979809974, -11652.754583469581, -11658.63780549219, -11634.65449256153, -11694.445759932762, -11588.07576637634, -11609.267342366833, -11431.665057041375, -11599.03386030396, -11325.702846149565, -11585.644624276785, -11422.85799119354, -11471.512723393245, -11404.199834204574, -11717.425358625549, -11590.419534821875, -11494.557346930525, -11653.206612449843, -11732.979388276095], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.511187429696323, "mean_inference_ms": 0.40037760705088377, "mean_action_processing_ms": 0.0977809647917064, "mean_env_wait_ms": 1.7849145425164528, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0038862228393554688, "StateBufferConnector_ms": 0.0030593739615546334, "ViewRequirementAgentConnector_ms": 0.06966855790879992}}, "episode_reward_max": -1623.6366775976976, "episode_reward_min": -11732.979388276095, "episode_reward_mean": -6266.586305827362, "episode_len_mean": 360.0, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-2119.171799360851, -2114.331502917478, -2056.15284991328, -2205.7189272174583, -2099.324925286358, -1783.6167235197013, -2198.8005148640627, -1959.4255405533393, -2031.9709274873644, -2146.934807250676, -1867.9332144874832, -1732.3916216536554, -2234.2070943633057, -1983.003248740253, -1810.115942693552, -1880.740363158521, -2051.0059405638153, -2099.0961425143632, -1861.2511987318119, -1623.6366775976976, -1833.7213963946356, -2170.1685866460275, -1845.8168296279084, -2224.92297284634, -2053.926900457367, -1999.6749001357318, -1761.9641895342056, -1845.4101580372842, -1660.79700381068, -2200.276684034361, -2099.2137564929294, -2113.220094078378, -1999.6454971942321, -2243.898806316024, -2064.683193837476, -2170.1598230617215, -2001.9935854335158, -2826.9278593746703, -2549.0906692719304, -4530.099241295323, -9055.053679015089, -11557.62411448131, -11690.365175060395, -11536.492754198262, -11315.672754182919, -11554.547061699, -11685.842712742626, -11372.3699668468, -11461.865010105279, -11401.475155261835, -11457.1546918822, -11477.147275717844, -11657.855649944562, -11649.264979809974, -11652.754583469581, -11658.63780549219, -11634.65449256153, -11694.445759932762, -11588.07576637634, -11609.267342366833, -11431.665057041375, -11599.03386030396, -11325.702846149565, -11585.644624276785, -11422.85799119354, -11471.512723393245, -11404.199834204574, -11717.425358625549, -11590.419534821875, -11494.557346930525, -11653.206612449843, -11732.979388276095], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.511187429696323, "mean_inference_ms": 0.40037760705088377, "mean_action_processing_ms": 0.0977809647917064, "mean_env_wait_ms": 1.7849145425164528, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0038862228393554688, "StateBufferConnector_ms": 0.0030593739615546334, "ViewRequirementAgentConnector_ms": 0.06966855790879992}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 145920, "num_agent_steps_trained": 145920, "num_env_steps_sampled": 145920, "num_env_steps_trained": 145920, "num_env_steps_sampled_this_iter": 1080, "num_env_steps_trained_this_iter": 1080, "num_env_steps_sampled_throughput_per_sec": 103.66026633479625, "num_env_steps_trained_throughput_per_sec": 103.66026633479625, "timesteps_total": 145920, "num_steps_trained_this_iter": 1080, "agent_timesteps_total": 145920, "timers": {"training_iteration_time_ms": 3449.994, "sample_time_ms": 3439.258, "load_time_ms": 0.3, "load_throughput": 1201710.657, "learn_time_ms": 9.698, "learn_throughput": 37119.194, "synch_weights_time_ms": 0.695}, "counters": {"num_env_steps_sampled": 145920, "num_env_steps_trained": 145920, "num_agent_steps_sampled": 145920, "num_agent_steps_trained": 145920}, "done": false, "episodes_total": 886, "training_iteration": 183, "trial_id": "14306_00000", "date": "2023-07-26_18-11-18", "timestamp": 1690384278, "time_this_iter_s": 10.421546936035156, "time_total_s": 1977.8810868263245, "pid": 7707, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[131310, 5e-05], [136710, 8e-05], [142110, 2.5e-05], [147510, 2.5e-05], [152910, 2.5e-05], [158310, 2.5e-05], [163710, 1e-05], [169110, 1e-05], [174510, 1e-05], [179910, 5e-06], [185310, 5e-06], [190710, 5e-06], [196110, 5e-06], [201510, 1e-06], [206910, 1e-06], [212310, 1e-06], [217710, 1e-06], [223110, 5e-07], [228510, 5e-07], [233910, 2.5e-07], [239310, 2.5e-07], [244710, 1e-07], [250110, 1e-07], [255510, 5e-08], [260910, 5e-08], [266310, 1e-08]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.15, "final_epsilon": 0.05, "epsilon_timesteps": 264960}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x14a3b79d0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 248.05035996437073, "iterations_since_restore": 23, "perf": {"cpu_util_percent": 20.600000000000005, "ram_util_percent": 58.05333333333332}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 2.5e-05, "entropy_coeff": 0.05, "policy_entropy": -885.0468505859375, "policy_loss": -91743328665.6, "vf_loss": 221217913.6}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 373.0, "diff_num_grad_updates_vs_sampler_policy": 372.0}}, "num_env_steps_sampled": 147000, "num_env_steps_trained": 147000, "num_agent_steps_sampled": 147000, "num_agent_steps_trained": 147000}, "sampler_results": {"episode_reward_max": -1623.6366775976976, "episode_reward_min": -11732.979388276095, "episode_reward_mean": -6480.460574852276, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-2119.171799360851, -2114.331502917478, -2056.15284991328, -2205.7189272174583, -2099.324925286358, -1783.6167235197013, -2198.8005148640627, -1959.4255405533393, -2031.9709274873644, -2146.934807250676, -1867.9332144874832, -1732.3916216536554, -2234.2070943633057, -1983.003248740253, -1810.115942693552, -1880.740363158521, -2051.0059405638153, -2099.0961425143632, -1861.2511987318119, -1623.6366775976976, -1833.7213963946356, -2170.1685866460275, -1845.8168296279084, -2224.92297284634, -2053.926900457367, -1999.6749001357318, -1761.9641895342056, -1845.4101580372842, -1660.79700381068, -2200.276684034361, -2099.2137564929294, -2113.220094078378, -1999.6454971942321, -2243.898806316024, -2064.683193837476, -2170.1598230617215, -2001.9935854335158, -2826.9278593746703, -2549.0906692719304, -4530.099241295323, -9055.053679015089, -11557.62411448131, -11690.365175060395, -11536.492754198262, -11315.672754182919, -11554.547061699, -11685.842712742626, -11372.3699668468, -11461.865010105279, -11401.475155261835, -11457.1546918822, -11477.147275717844, -11657.855649944562, -11649.264979809974, -11652.754583469581, -11658.63780549219, -11634.65449256153, -11694.445759932762, -11588.07576637634, -11609.267342366833, -11431.665057041375, -11599.03386030396, -11325.702846149565, -11585.644624276785, -11422.85799119354, -11471.512723393245, -11404.199834204574, -11717.425358625549, -11590.419534821875, -11494.557346930525, -11653.206612449843, -11732.979388276095, -11637.946837089046, -11679.427736165399, -11522.954521096248], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.512182972934599, "mean_inference_ms": 0.3998999677508853, "mean_action_processing_ms": 0.0976890101160364, "mean_env_wait_ms": 1.773212466640621, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0038576126098632812, "StateBufferConnector_ms": 0.003052393595377604, "ViewRequirementAgentConnector_ms": 0.06951649983723958}}, "episode_reward_max": -1623.6366775976976, "episode_reward_min": -11732.979388276095, "episode_reward_mean": -6480.460574852276, "episode_len_mean": 360.0, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-2119.171799360851, -2114.331502917478, -2056.15284991328, -2205.7189272174583, -2099.324925286358, -1783.6167235197013, -2198.8005148640627, -1959.4255405533393, -2031.9709274873644, -2146.934807250676, -1867.9332144874832, -1732.3916216536554, -2234.2070943633057, -1983.003248740253, -1810.115942693552, -1880.740363158521, -2051.0059405638153, -2099.0961425143632, -1861.2511987318119, -1623.6366775976976, -1833.7213963946356, -2170.1685866460275, -1845.8168296279084, -2224.92297284634, -2053.926900457367, -1999.6749001357318, -1761.9641895342056, -1845.4101580372842, -1660.79700381068, -2200.276684034361, -2099.2137564929294, -2113.220094078378, -1999.6454971942321, -2243.898806316024, -2064.683193837476, -2170.1598230617215, -2001.9935854335158, -2826.9278593746703, -2549.0906692719304, -4530.099241295323, -9055.053679015089, -11557.62411448131, -11690.365175060395, -11536.492754198262, -11315.672754182919, -11554.547061699, -11685.842712742626, -11372.3699668468, -11461.865010105279, -11401.475155261835, -11457.1546918822, -11477.147275717844, -11657.855649944562, -11649.264979809974, -11652.754583469581, -11658.63780549219, -11634.65449256153, -11694.445759932762, -11588.07576637634, -11609.267342366833, -11431.665057041375, -11599.03386030396, -11325.702846149565, -11585.644624276785, -11422.85799119354, -11471.512723393245, -11404.199834204574, -11717.425358625549, -11590.419534821875, -11494.557346930525, -11653.206612449843, -11732.979388276095, -11637.946837089046, -11679.427736165399, -11522.954521096248], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.512182972934599, "mean_inference_ms": 0.3998999677508853, "mean_action_processing_ms": 0.0976890101160364, "mean_env_wait_ms": 1.773212466640621, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0038576126098632812, "StateBufferConnector_ms": 0.003052393595377604, "ViewRequirementAgentConnector_ms": 0.06951649983723958}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 147000, "num_agent_steps_trained": 147000, "num_env_steps_sampled": 147000, "num_env_steps_trained": 147000, "num_env_steps_sampled_this_iter": 1080, "num_env_steps_trained_this_iter": 1080, "num_env_steps_sampled_throughput_per_sec": 102.9286433625537, "num_env_steps_trained_throughput_per_sec": 102.9286433625537, "timesteps_total": 147000, "num_steps_trained_this_iter": 1080, "agent_timesteps_total": 147000, "timers": {"training_iteration_time_ms": 3472.128, "sample_time_ms": 3461.392, "load_time_ms": 0.3, "load_throughput": 1200468.628, "learn_time_ms": 9.702, "learn_throughput": 37107.153, "synch_weights_time_ms": 0.692}, "counters": {"num_env_steps_sampled": 147000, "num_env_steps_trained": 147000, "num_agent_steps_sampled": 147000, "num_agent_steps_trained": 147000}, "done": false, "episodes_total": 889, "training_iteration": 184, "trial_id": "14306_00000", "date": "2023-07-26_18-11-29", "timestamp": 1690384289, "time_this_iter_s": 10.49537205696106, "time_total_s": 1988.3764588832855, "pid": 7707, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[131310, 5e-05], [136710, 8e-05], [142110, 2.5e-05], [147510, 2.5e-05], [152910, 2.5e-05], [158310, 2.5e-05], [163710, 1e-05], [169110, 1e-05], [174510, 1e-05], [179910, 5e-06], [185310, 5e-06], [190710, 5e-06], [196110, 5e-06], [201510, 1e-06], [206910, 1e-06], [212310, 1e-06], [217710, 1e-06], [223110, 5e-07], [228510, 5e-07], [233910, 2.5e-07], [239310, 2.5e-07], [244710, 1e-07], [250110, 1e-07], [255510, 5e-08], [260910, 5e-08], [266310, 1e-08]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.15, "final_epsilon": 0.05, "epsilon_timesteps": 264960}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x14a3b79d0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 258.5457320213318, "iterations_since_restore": 24, "perf": {"cpu_util_percent": 17.18666666666667, "ram_util_percent": 57.91333333333333}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 2.5e-05, "entropy_coeff": 0.05, "policy_entropy": -904.4323852539062, "policy_loss": -163140966809.6, "vf_loss": 221941849.6}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 388.0, "diff_num_grad_updates_vs_sampler_policy": 387.0}}, "num_env_steps_sampled": 148080, "num_env_steps_trained": 148080, "num_agent_steps_sampled": 148080, "num_agent_steps_trained": 148080}, "sampler_results": {"episode_reward_max": -1623.6366775976976, "episode_reward_min": -11732.979388276095, "episode_reward_mean": -6675.9369605302145, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-2119.171799360851, -2114.331502917478, -2056.15284991328, -2205.7189272174583, -2099.324925286358, -1783.6167235197013, -2198.8005148640627, -1959.4255405533393, -2031.9709274873644, -2146.934807250676, -1867.9332144874832, -1732.3916216536554, -2234.2070943633057, -1983.003248740253, -1810.115942693552, -1880.740363158521, -2051.0059405638153, -2099.0961425143632, -1861.2511987318119, -1623.6366775976976, -1833.7213963946356, -2170.1685866460275, -1845.8168296279084, -2224.92297284634, -2053.926900457367, -1999.6749001357318, -1761.9641895342056, -1845.4101580372842, -1660.79700381068, -2200.276684034361, -2099.2137564929294, -2113.220094078378, -1999.6454971942321, -2243.898806316024, -2064.683193837476, -2170.1598230617215, -2001.9935854335158, -2826.9278593746703, -2549.0906692719304, -4530.099241295323, -9055.053679015089, -11557.62411448131, -11690.365175060395, -11536.492754198262, -11315.672754182919, -11554.547061699, -11685.842712742626, -11372.3699668468, -11461.865010105279, -11401.475155261835, -11457.1546918822, -11477.147275717844, -11657.855649944562, -11649.264979809974, -11652.754583469581, -11658.63780549219, -11634.65449256153, -11694.445759932762, -11588.07576637634, -11609.267342366833, -11431.665057041375, -11599.03386030396, -11325.702846149565, -11585.644624276785, -11422.85799119354, -11471.512723393245, -11404.199834204574, -11717.425358625549, -11590.419534821875, -11494.557346930525, -11653.206612449843, -11732.979388276095, -11637.946837089046, -11679.427736165399, -11522.954521096248, -11518.033535857354, -11673.853409119987, -11496.652862458675], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.51314003384281, "mean_inference_ms": 0.39946064359911143, "mean_action_processing_ms": 0.09760431846706653, "mean_env_wait_ms": 1.7623498250966965, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0038382334586901544, "StateBufferConnector_ms": 0.0030560371203300282, "ViewRequirementAgentConnector_ms": 0.06955709212865585}}, "episode_reward_max": -1623.6366775976976, "episode_reward_min": -11732.979388276095, "episode_reward_mean": -6675.9369605302145, "episode_len_mean": 360.0, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-2119.171799360851, -2114.331502917478, -2056.15284991328, -2205.7189272174583, -2099.324925286358, -1783.6167235197013, -2198.8005148640627, -1959.4255405533393, -2031.9709274873644, -2146.934807250676, -1867.9332144874832, -1732.3916216536554, -2234.2070943633057, -1983.003248740253, -1810.115942693552, -1880.740363158521, -2051.0059405638153, -2099.0961425143632, -1861.2511987318119, -1623.6366775976976, -1833.7213963946356, -2170.1685866460275, -1845.8168296279084, -2224.92297284634, -2053.926900457367, -1999.6749001357318, -1761.9641895342056, -1845.4101580372842, -1660.79700381068, -2200.276684034361, -2099.2137564929294, -2113.220094078378, -1999.6454971942321, -2243.898806316024, -2064.683193837476, -2170.1598230617215, -2001.9935854335158, -2826.9278593746703, -2549.0906692719304, -4530.099241295323, -9055.053679015089, -11557.62411448131, -11690.365175060395, -11536.492754198262, -11315.672754182919, -11554.547061699, -11685.842712742626, -11372.3699668468, -11461.865010105279, -11401.475155261835, -11457.1546918822, -11477.147275717844, -11657.855649944562, -11649.264979809974, -11652.754583469581, -11658.63780549219, -11634.65449256153, -11694.445759932762, -11588.07576637634, -11609.267342366833, -11431.665057041375, -11599.03386030396, -11325.702846149565, -11585.644624276785, -11422.85799119354, -11471.512723393245, -11404.199834204574, -11717.425358625549, -11590.419534821875, -11494.557346930525, -11653.206612449843, -11732.979388276095, -11637.946837089046, -11679.427736165399, -11522.954521096248, -11518.033535857354, -11673.853409119987, -11496.652862458675], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.51314003384281, "mean_inference_ms": 0.39946064359911143, "mean_action_processing_ms": 0.09760431846706653, "mean_env_wait_ms": 1.7623498250966965, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0038382334586901544, "StateBufferConnector_ms": 0.0030560371203300282, "ViewRequirementAgentConnector_ms": 0.06955709212865585}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 148080, "num_agent_steps_trained": 148080, "num_env_steps_sampled": 148080, "num_env_steps_trained": 148080, "num_env_steps_sampled_this_iter": 1080, "num_env_steps_trained_this_iter": 1080, "num_env_steps_sampled_throughput_per_sec": 104.6329346815927, "num_env_steps_trained_throughput_per_sec": 104.6329346815927, "timesteps_total": 148080, "num_steps_trained_this_iter": 1080, "agent_timesteps_total": 148080, "timers": {"training_iteration_time_ms": 3471.72, "sample_time_ms": 3460.888, "load_time_ms": 0.3, "load_throughput": 1201615.025, "learn_time_ms": 9.792, "learn_throughput": 36766.16, "synch_weights_time_ms": 0.698}, "counters": {"num_env_steps_sampled": 148080, "num_env_steps_trained": 148080, "num_agent_steps_sampled": 148080, "num_agent_steps_trained": 148080}, "done": false, "episodes_total": 892, "training_iteration": 185, "trial_id": "14306_00000", "date": "2023-07-26_18-11-39", "timestamp": 1690384299, "time_this_iter_s": 10.324466943740845, "time_total_s": 1998.7009258270264, "pid": 7707, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[131310, 5e-05], [136710, 8e-05], [142110, 2.5e-05], [147510, 2.5e-05], [152910, 2.5e-05], [158310, 2.5e-05], [163710, 1e-05], [169110, 1e-05], [174510, 1e-05], [179910, 5e-06], [185310, 5e-06], [190710, 5e-06], [196110, 5e-06], [201510, 1e-06], [206910, 1e-06], [212310, 1e-06], [217710, 1e-06], [223110, 5e-07], [228510, 5e-07], [233910, 2.5e-07], [239310, 2.5e-07], [244710, 1e-07], [250110, 1e-07], [255510, 5e-08], [260910, 5e-08], [266310, 1e-08]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.15, "final_epsilon": 0.05, "epsilon_timesteps": 264960}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x14a3b79d0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 268.87019896507263, "iterations_since_restore": 25, "perf": {"cpu_util_percent": 25.064285714285713, "ram_util_percent": 58.27857142857143}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 2.5e-05, "entropy_coeff": 0.05, "policy_entropy": -923.5279418945313, "policy_loss": -145221597593.6, "vf_loss": 216101577.6}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 403.0, "diff_num_grad_updates_vs_sampler_policy": 402.0}}, "num_env_steps_sampled": 149160, "num_env_steps_trained": 149160, "num_agent_steps_sampled": 149160, "num_agent_steps_trained": 149160}, "sampler_results": {"episode_reward_max": -1623.6366775976976, "episode_reward_min": -11732.979388276095, "episode_reward_mean": -6854.584985922083, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-2119.171799360851, -2114.331502917478, -2056.15284991328, -2205.7189272174583, -2099.324925286358, -1783.6167235197013, -2198.8005148640627, -1959.4255405533393, -2031.9709274873644, -2146.934807250676, -1867.9332144874832, -1732.3916216536554, -2234.2070943633057, -1983.003248740253, -1810.115942693552, -1880.740363158521, -2051.0059405638153, -2099.0961425143632, -1861.2511987318119, -1623.6366775976976, -1833.7213963946356, -2170.1685866460275, -1845.8168296279084, -2224.92297284634, -2053.926900457367, -1999.6749001357318, -1761.9641895342056, -1845.4101580372842, -1660.79700381068, -2200.276684034361, -2099.2137564929294, -2113.220094078378, -1999.6454971942321, -2243.898806316024, -2064.683193837476, -2170.1598230617215, -2001.9935854335158, -2826.9278593746703, -2549.0906692719304, -4530.099241295323, -9055.053679015089, -11557.62411448131, -11690.365175060395, -11536.492754198262, -11315.672754182919, -11554.547061699, -11685.842712742626, -11372.3699668468, -11461.865010105279, -11401.475155261835, -11457.1546918822, -11477.147275717844, -11657.855649944562, -11649.264979809974, -11652.754583469581, -11658.63780549219, -11634.65449256153, -11694.445759932762, -11588.07576637634, -11609.267342366833, -11431.665057041375, -11599.03386030396, -11325.702846149565, -11585.644624276785, -11422.85799119354, -11471.512723393245, -11404.199834204574, -11717.425358625549, -11590.419534821875, -11494.557346930525, -11653.206612449843, -11732.979388276095, -11637.946837089046, -11679.427736165399, -11522.954521096248, -11518.033535857354, -11673.853409119987, -11496.652862458675, -11463.735082128287, -11609.888339851545, -11424.677516352256], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.5138460053706995, "mean_inference_ms": 0.3990579855786155, "mean_action_processing_ms": 0.09752679364641895, "mean_env_wait_ms": 1.7521443865123432, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0038288257740162037, "StateBufferConnector_ms": 0.0030626485377182196, "ViewRequirementAgentConnector_ms": 0.06960645134066358}}, "episode_reward_max": -1623.6366775976976, "episode_reward_min": -11732.979388276095, "episode_reward_mean": -6854.584985922083, "episode_len_mean": 360.0, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-2119.171799360851, -2114.331502917478, -2056.15284991328, -2205.7189272174583, -2099.324925286358, -1783.6167235197013, -2198.8005148640627, -1959.4255405533393, -2031.9709274873644, -2146.934807250676, -1867.9332144874832, -1732.3916216536554, -2234.2070943633057, -1983.003248740253, -1810.115942693552, -1880.740363158521, -2051.0059405638153, -2099.0961425143632, -1861.2511987318119, -1623.6366775976976, -1833.7213963946356, -2170.1685866460275, -1845.8168296279084, -2224.92297284634, -2053.926900457367, -1999.6749001357318, -1761.9641895342056, -1845.4101580372842, -1660.79700381068, -2200.276684034361, -2099.2137564929294, -2113.220094078378, -1999.6454971942321, -2243.898806316024, -2064.683193837476, -2170.1598230617215, -2001.9935854335158, -2826.9278593746703, -2549.0906692719304, -4530.099241295323, -9055.053679015089, -11557.62411448131, -11690.365175060395, -11536.492754198262, -11315.672754182919, -11554.547061699, -11685.842712742626, -11372.3699668468, -11461.865010105279, -11401.475155261835, -11457.1546918822, -11477.147275717844, -11657.855649944562, -11649.264979809974, -11652.754583469581, -11658.63780549219, -11634.65449256153, -11694.445759932762, -11588.07576637634, -11609.267342366833, -11431.665057041375, -11599.03386030396, -11325.702846149565, -11585.644624276785, -11422.85799119354, -11471.512723393245, -11404.199834204574, -11717.425358625549, -11590.419534821875, -11494.557346930525, -11653.206612449843, -11732.979388276095, -11637.946837089046, -11679.427736165399, -11522.954521096248, -11518.033535857354, -11673.853409119987, -11496.652862458675, -11463.735082128287, -11609.888339851545, -11424.677516352256], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.5138460053706995, "mean_inference_ms": 0.3990579855786155, "mean_action_processing_ms": 0.09752679364641895, "mean_env_wait_ms": 1.7521443865123432, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0038288257740162037, "StateBufferConnector_ms": 0.0030626485377182196, "ViewRequirementAgentConnector_ms": 0.06960645134066358}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 149160, "num_agent_steps_trained": 149160, "num_env_steps_sampled": 149160, "num_env_steps_trained": 149160, "num_env_steps_sampled_this_iter": 1080, "num_env_steps_trained_this_iter": 1080, "num_env_steps_sampled_throughput_per_sec": 107.10903691469868, "num_env_steps_trained_throughput_per_sec": 107.10903691469868, "timesteps_total": 149160, "num_steps_trained_this_iter": 1080, "agent_timesteps_total": 149160, "timers": {"training_iteration_time_ms": 3433.252, "sample_time_ms": 3422.364, "load_time_ms": 0.298, "load_throughput": 1206222.591, "learn_time_ms": 9.849, "learn_throughput": 36550.519, "synch_weights_time_ms": 0.696}, "counters": {"num_env_steps_sampled": 149160, "num_env_steps_trained": 149160, "num_agent_steps_sampled": 149160, "num_agent_steps_trained": 149160}, "done": false, "episodes_total": 895, "training_iteration": 186, "trial_id": "14306_00000", "date": "2023-07-26_18-11-49", "timestamp": 1690384309, "time_this_iter_s": 10.086071968078613, "time_total_s": 2008.786997795105, "pid": 7707, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[131310, 5e-05], [136710, 8e-05], [142110, 2.5e-05], [147510, 2.5e-05], [152910, 2.5e-05], [158310, 2.5e-05], [163710, 1e-05], [169110, 1e-05], [174510, 1e-05], [179910, 5e-06], [185310, 5e-06], [190710, 5e-06], [196110, 5e-06], [201510, 1e-06], [206910, 1e-06], [212310, 1e-06], [217710, 1e-06], [223110, 5e-07], [228510, 5e-07], [233910, 2.5e-07], [239310, 2.5e-07], [244710, 1e-07], [250110, 1e-07], [255510, 5e-08], [260910, 5e-08], [266310, 1e-08]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.15, "final_epsilon": 0.05, "epsilon_timesteps": 264960}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x14a3b79d0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 278.95627093315125, "iterations_since_restore": 26, "perf": {"cpu_util_percent": 28.546666666666667, "ram_util_percent": 58.85333333333334}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 2.5e-05, "entropy_coeff": 0.05, "policy_entropy": -942.5283325195312, "policy_loss": -387066973388.8, "vf_loss": 230870422.4}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 418.0, "diff_num_grad_updates_vs_sampler_policy": 417.0}}, "num_env_steps_sampled": 150240, "num_env_steps_trained": 150240, "num_agent_steps_sampled": 150240, "num_agent_steps_trained": 150240}, "sampler_results": {"episode_reward_max": -1623.6366775976976, "episode_reward_min": -11747.771684461546, "episode_reward_mean": -7024.149015272975, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-2119.171799360851, -2114.331502917478, -2056.15284991328, -2205.7189272174583, -2099.324925286358, -1783.6167235197013, -2198.8005148640627, -1959.4255405533393, -2031.9709274873644, -2146.934807250676, -1867.9332144874832, -1732.3916216536554, -2234.2070943633057, -1983.003248740253, -1810.115942693552, -1880.740363158521, -2051.0059405638153, -2099.0961425143632, -1861.2511987318119, -1623.6366775976976, -1833.7213963946356, -2170.1685866460275, -1845.8168296279084, -2224.92297284634, -2053.926900457367, -1999.6749001357318, -1761.9641895342056, -1845.4101580372842, -1660.79700381068, -2200.276684034361, -2099.2137564929294, -2113.220094078378, -1999.6454971942321, -2243.898806316024, -2064.683193837476, -2170.1598230617215, -2001.9935854335158, -2826.9278593746703, -2549.0906692719304, -4530.099241295323, -9055.053679015089, -11557.62411448131, -11690.365175060395, -11536.492754198262, -11315.672754182919, -11554.547061699, -11685.842712742626, -11372.3699668468, -11461.865010105279, -11401.475155261835, -11457.1546918822, -11477.147275717844, -11657.855649944562, -11649.264979809974, -11652.754583469581, -11658.63780549219, -11634.65449256153, -11694.445759932762, -11588.07576637634, -11609.267342366833, -11431.665057041375, -11599.03386030396, -11325.702846149565, -11585.644624276785, -11422.85799119354, -11471.512723393245, -11404.199834204574, -11717.425358625549, -11590.419534821875, -11494.557346930525, -11653.206612449843, -11732.979388276095, -11637.946837089046, -11679.427736165399, -11522.954521096248, -11518.033535857354, -11673.853409119987, -11496.652862458675, -11463.735082128287, -11609.888339851545, -11424.677516352256, -11552.00603516849, -11507.355703611092, -11747.771684461546], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.514350857849199, "mean_inference_ms": 0.39867965505965036, "mean_action_processing_ms": 0.09745405085731698, "mean_env_wait_ms": 1.7425674206707984, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00384393192472912, "StateBufferConnector_ms": 0.003055731455485026, "ViewRequirementAgentConnector_ms": 0.06951093673706055}}, "episode_reward_max": -1623.6366775976976, "episode_reward_min": -11747.771684461546, "episode_reward_mean": -7024.149015272975, "episode_len_mean": 360.0, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-2119.171799360851, -2114.331502917478, -2056.15284991328, -2205.7189272174583, -2099.324925286358, -1783.6167235197013, -2198.8005148640627, -1959.4255405533393, -2031.9709274873644, -2146.934807250676, -1867.9332144874832, -1732.3916216536554, -2234.2070943633057, -1983.003248740253, -1810.115942693552, -1880.740363158521, -2051.0059405638153, -2099.0961425143632, -1861.2511987318119, -1623.6366775976976, -1833.7213963946356, -2170.1685866460275, -1845.8168296279084, -2224.92297284634, -2053.926900457367, -1999.6749001357318, -1761.9641895342056, -1845.4101580372842, -1660.79700381068, -2200.276684034361, -2099.2137564929294, -2113.220094078378, -1999.6454971942321, -2243.898806316024, -2064.683193837476, -2170.1598230617215, -2001.9935854335158, -2826.9278593746703, -2549.0906692719304, -4530.099241295323, -9055.053679015089, -11557.62411448131, -11690.365175060395, -11536.492754198262, -11315.672754182919, -11554.547061699, -11685.842712742626, -11372.3699668468, -11461.865010105279, -11401.475155261835, -11457.1546918822, -11477.147275717844, -11657.855649944562, -11649.264979809974, -11652.754583469581, -11658.63780549219, -11634.65449256153, -11694.445759932762, -11588.07576637634, -11609.267342366833, -11431.665057041375, -11599.03386030396, -11325.702846149565, -11585.644624276785, -11422.85799119354, -11471.512723393245, -11404.199834204574, -11717.425358625549, -11590.419534821875, -11494.557346930525, -11653.206612449843, -11732.979388276095, -11637.946837089046, -11679.427736165399, -11522.954521096248, -11518.033535857354, -11673.853409119987, -11496.652862458675, -11463.735082128287, -11609.888339851545, -11424.677516352256, -11552.00603516849, -11507.355703611092, -11747.771684461546], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.514350857849199, "mean_inference_ms": 0.39867965505965036, "mean_action_processing_ms": 0.09745405085731698, "mean_env_wait_ms": 1.7425674206707984, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00384393192472912, "StateBufferConnector_ms": 0.003055731455485026, "ViewRequirementAgentConnector_ms": 0.06951093673706055}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 150240, "num_agent_steps_trained": 150240, "num_env_steps_sampled": 150240, "num_env_steps_trained": 150240, "num_env_steps_sampled_this_iter": 1080, "num_env_steps_trained_this_iter": 1080, "num_env_steps_sampled_throughput_per_sec": 106.82173520151075, "num_env_steps_trained_throughput_per_sec": 106.82173520151075, "timesteps_total": 150240, "num_steps_trained_this_iter": 1080, "agent_timesteps_total": 150240, "timers": {"training_iteration_time_ms": 3400.743, "sample_time_ms": 3389.787, "load_time_ms": 0.299, "load_throughput": 1203338.731, "learn_time_ms": 9.913, "learn_throughput": 36316.329, "synch_weights_time_ms": 0.7}, "counters": {"num_env_steps_sampled": 150240, "num_env_steps_trained": 150240, "num_agent_steps_sampled": 150240, "num_agent_steps_trained": 150240}, "done": false, "episodes_total": 898, "training_iteration": 187, "trial_id": "14306_00000", "date": "2023-07-26_18-11-59", "timestamp": 1690384319, "time_this_iter_s": 10.113629817962646, "time_total_s": 2018.9006276130676, "pid": 7707, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[131310, 5e-05], [136710, 8e-05], [142110, 2.5e-05], [147510, 2.5e-05], [152910, 2.5e-05], [158310, 2.5e-05], [163710, 1e-05], [169110, 1e-05], [174510, 1e-05], [179910, 5e-06], [185310, 5e-06], [190710, 5e-06], [196110, 5e-06], [201510, 1e-06], [206910, 1e-06], [212310, 1e-06], [217710, 1e-06], [223110, 5e-07], [228510, 5e-07], [233910, 2.5e-07], [239310, 2.5e-07], [244710, 1e-07], [250110, 1e-07], [255510, 5e-08], [260910, 5e-08], [266310, 1e-08]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.15, "final_epsilon": 0.05, "epsilon_timesteps": 264960}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x14a3b79d0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 289.0699007511139, "iterations_since_restore": 27, "perf": {"cpu_util_percent": 23.042857142857144, "ram_util_percent": 59.164285714285704}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 2.5e-05, "entropy_coeff": 0.05, "policy_entropy": -961.3109375, "policy_loss": -220756577484.8, "vf_loss": 220455260.8}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 433.0, "diff_num_grad_updates_vs_sampler_policy": 432.0}}, "num_env_steps_sampled": 151320, "num_env_steps_trained": 151320, "num_agent_steps_sampled": 151320, "num_agent_steps_trained": 151320}, "sampler_results": {"episode_reward_max": -1623.6366775976976, "episode_reward_min": -11747.771684461546, "episode_reward_mean": -7178.488531252917, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-2119.171799360851, -2114.331502917478, -2056.15284991328, -2205.7189272174583, -2099.324925286358, -1783.6167235197013, -2198.8005148640627, -1959.4255405533393, -2031.9709274873644, -2146.934807250676, -1867.9332144874832, -1732.3916216536554, -2234.2070943633057, -1983.003248740253, -1810.115942693552, -1880.740363158521, -2051.0059405638153, -2099.0961425143632, -1861.2511987318119, -1623.6366775976976, -1833.7213963946356, -2170.1685866460275, -1845.8168296279084, -2224.92297284634, -2053.926900457367, -1999.6749001357318, -1761.9641895342056, -1845.4101580372842, -1660.79700381068, -2200.276684034361, -2099.2137564929294, -2113.220094078378, -1999.6454971942321, -2243.898806316024, -2064.683193837476, -2170.1598230617215, -2001.9935854335158, -2826.9278593746703, -2549.0906692719304, -4530.099241295323, -9055.053679015089, -11557.62411448131, -11690.365175060395, -11536.492754198262, -11315.672754182919, -11554.547061699, -11685.842712742626, -11372.3699668468, -11461.865010105279, -11401.475155261835, -11457.1546918822, -11477.147275717844, -11657.855649944562, -11649.264979809974, -11652.754583469581, -11658.63780549219, -11634.65449256153, -11694.445759932762, -11588.07576637634, -11609.267342366833, -11431.665057041375, -11599.03386030396, -11325.702846149565, -11585.644624276785, -11422.85799119354, -11471.512723393245, -11404.199834204574, -11717.425358625549, -11590.419534821875, -11494.557346930525, -11653.206612449843, -11732.979388276095, -11637.946837089046, -11679.427736165399, -11522.954521096248, -11518.033535857354, -11673.853409119987, -11496.652862458675, -11463.735082128287, -11609.888339851545, -11424.677516352256, -11552.00603516849, -11507.355703611092, -11747.771684461546, -11646.772801020817, -11422.788495943822, -11430.423639109304], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.514628161884334, "mean_inference_ms": 0.39832159322553107, "mean_action_processing_ms": 0.0973853947722516, "mean_env_wait_ms": 1.7335131547466704, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0038596405380073636, "StateBufferConnector_ms": 0.0030512097238124102, "ViewRequirementAgentConnector_ms": 0.06938145078461745}}, "episode_reward_max": -1623.6366775976976, "episode_reward_min": -11747.771684461546, "episode_reward_mean": -7178.488531252917, "episode_len_mean": 360.0, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-2119.171799360851, -2114.331502917478, -2056.15284991328, -2205.7189272174583, -2099.324925286358, -1783.6167235197013, -2198.8005148640627, -1959.4255405533393, -2031.9709274873644, -2146.934807250676, -1867.9332144874832, -1732.3916216536554, -2234.2070943633057, -1983.003248740253, -1810.115942693552, -1880.740363158521, -2051.0059405638153, -2099.0961425143632, -1861.2511987318119, -1623.6366775976976, -1833.7213963946356, -2170.1685866460275, -1845.8168296279084, -2224.92297284634, -2053.926900457367, -1999.6749001357318, -1761.9641895342056, -1845.4101580372842, -1660.79700381068, -2200.276684034361, -2099.2137564929294, -2113.220094078378, -1999.6454971942321, -2243.898806316024, -2064.683193837476, -2170.1598230617215, -2001.9935854335158, -2826.9278593746703, -2549.0906692719304, -4530.099241295323, -9055.053679015089, -11557.62411448131, -11690.365175060395, -11536.492754198262, -11315.672754182919, -11554.547061699, -11685.842712742626, -11372.3699668468, -11461.865010105279, -11401.475155261835, -11457.1546918822, -11477.147275717844, -11657.855649944562, -11649.264979809974, -11652.754583469581, -11658.63780549219, -11634.65449256153, -11694.445759932762, -11588.07576637634, -11609.267342366833, -11431.665057041375, -11599.03386030396, -11325.702846149565, -11585.644624276785, -11422.85799119354, -11471.512723393245, -11404.199834204574, -11717.425358625549, -11590.419534821875, -11494.557346930525, -11653.206612449843, -11732.979388276095, -11637.946837089046, -11679.427736165399, -11522.954521096248, -11518.033535857354, -11673.853409119987, -11496.652862458675, -11463.735082128287, -11609.888339851545, -11424.677516352256, -11552.00603516849, -11507.355703611092, -11747.771684461546, -11646.772801020817, -11422.788495943822, -11430.423639109304], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.514628161884334, "mean_inference_ms": 0.39832159322553107, "mean_action_processing_ms": 0.0973853947722516, "mean_env_wait_ms": 1.7335131547466704, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0038596405380073636, "StateBufferConnector_ms": 0.0030512097238124102, "ViewRequirementAgentConnector_ms": 0.06938145078461745}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 151320, "num_agent_steps_trained": 151320, "num_env_steps_sampled": 151320, "num_env_steps_trained": 151320, "num_env_steps_sampled_this_iter": 1080, "num_env_steps_trained_this_iter": 1080, "num_env_steps_sampled_throughput_per_sec": 107.83860861920726, "num_env_steps_trained_throughput_per_sec": 107.83860861920726, "timesteps_total": 151320, "num_steps_trained_this_iter": 1080, "agent_timesteps_total": 151320, "timers": {"training_iteration_time_ms": 3360.714, "sample_time_ms": 3349.663, "load_time_ms": 0.3, "load_throughput": 1199514.967, "learn_time_ms": 9.991, "learn_throughput": 36033.54, "synch_weights_time_ms": 0.716}, "counters": {"num_env_steps_sampled": 151320, "num_env_steps_trained": 151320, "num_agent_steps_sampled": 151320, "num_agent_steps_trained": 151320}, "done": false, "episodes_total": 901, "training_iteration": 188, "trial_id": "14306_00000", "date": "2023-07-26_18-12-09", "timestamp": 1690384329, "time_this_iter_s": 10.017834186553955, "time_total_s": 2028.9184617996216, "pid": 7707, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[131310, 5e-05], [136710, 8e-05], [142110, 2.5e-05], [147510, 2.5e-05], [152910, 2.5e-05], [158310, 2.5e-05], [163710, 1e-05], [169110, 1e-05], [174510, 1e-05], [179910, 5e-06], [185310, 5e-06], [190710, 5e-06], [196110, 5e-06], [201510, 1e-06], [206910, 1e-06], [212310, 1e-06], [217710, 1e-06], [223110, 5e-07], [228510, 5e-07], [233910, 2.5e-07], [239310, 2.5e-07], [244710, 1e-07], [250110, 1e-07], [255510, 5e-08], [260910, 5e-08], [266310, 1e-08]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.15, "final_epsilon": 0.05, "epsilon_timesteps": 264960}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x14a3b79d0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 299.08773493766785, "iterations_since_restore": 28, "perf": {"cpu_util_percent": 23.90666666666667, "ram_util_percent": 59.08}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 2.5e-05, "entropy_coeff": 0.05, "policy_entropy": -980.0406616210937, "policy_loss": -357024146227.2, "vf_loss": 222149587.2}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 448.0, "diff_num_grad_updates_vs_sampler_policy": 447.0}}, "num_env_steps_sampled": 152400, "num_env_steps_trained": 152400, "num_agent_steps_sampled": 152400, "num_agent_steps_trained": 152400}, "sampler_results": {"episode_reward_max": -1623.6366775976976, "episode_reward_min": -11747.771684461546, "episode_reward_mean": -7321.589226621153, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-2119.171799360851, -2114.331502917478, -2056.15284991328, -2205.7189272174583, -2099.324925286358, -1783.6167235197013, -2198.8005148640627, -1959.4255405533393, -2031.9709274873644, -2146.934807250676, -1867.9332144874832, -1732.3916216536554, -2234.2070943633057, -1983.003248740253, -1810.115942693552, -1880.740363158521, -2051.0059405638153, -2099.0961425143632, -1861.2511987318119, -1623.6366775976976, -1833.7213963946356, -2170.1685866460275, -1845.8168296279084, -2224.92297284634, -2053.926900457367, -1999.6749001357318, -1761.9641895342056, -1845.4101580372842, -1660.79700381068, -2200.276684034361, -2099.2137564929294, -2113.220094078378, -1999.6454971942321, -2243.898806316024, -2064.683193837476, -2170.1598230617215, -2001.9935854335158, -2826.9278593746703, -2549.0906692719304, -4530.099241295323, -9055.053679015089, -11557.62411448131, -11690.365175060395, -11536.492754198262, -11315.672754182919, -11554.547061699, -11685.842712742626, -11372.3699668468, -11461.865010105279, -11401.475155261835, -11457.1546918822, -11477.147275717844, -11657.855649944562, -11649.264979809974, -11652.754583469581, -11658.63780549219, -11634.65449256153, -11694.445759932762, -11588.07576637634, -11609.267342366833, -11431.665057041375, -11599.03386030396, -11325.702846149565, -11585.644624276785, -11422.85799119354, -11471.512723393245, -11404.199834204574, -11717.425358625549, -11590.419534821875, -11494.557346930525, -11653.206612449843, -11732.979388276095, -11637.946837089046, -11679.427736165399, -11522.954521096248, -11518.033535857354, -11673.853409119987, -11496.652862458675, -11463.735082128287, -11609.888339851545, -11424.677516352256, -11552.00603516849, -11507.355703611092, -11747.771684461546, -11646.772801020817, -11422.788495943822, -11430.423639109304, -11324.705743288792, -11529.55193302171, -11560.270500589313], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.514805560124232, "mean_inference_ms": 0.39797550851230923, "mean_action_processing_ms": 0.0973191205071058, "mean_env_wait_ms": 1.724944574915892, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0038361549377441406, "StateBufferConnector_ms": 0.0030451350741916234, "ViewRequirementAgentConnector_ms": 0.0692794058057997}}, "episode_reward_max": -1623.6366775976976, "episode_reward_min": -11747.771684461546, "episode_reward_mean": -7321.589226621153, "episode_len_mean": 360.0, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-2119.171799360851, -2114.331502917478, -2056.15284991328, -2205.7189272174583, -2099.324925286358, -1783.6167235197013, -2198.8005148640627, -1959.4255405533393, -2031.9709274873644, -2146.934807250676, -1867.9332144874832, -1732.3916216536554, -2234.2070943633057, -1983.003248740253, -1810.115942693552, -1880.740363158521, -2051.0059405638153, -2099.0961425143632, -1861.2511987318119, -1623.6366775976976, -1833.7213963946356, -2170.1685866460275, -1845.8168296279084, -2224.92297284634, -2053.926900457367, -1999.6749001357318, -1761.9641895342056, -1845.4101580372842, -1660.79700381068, -2200.276684034361, -2099.2137564929294, -2113.220094078378, -1999.6454971942321, -2243.898806316024, -2064.683193837476, -2170.1598230617215, -2001.9935854335158, -2826.9278593746703, -2549.0906692719304, -4530.099241295323, -9055.053679015089, -11557.62411448131, -11690.365175060395, -11536.492754198262, -11315.672754182919, -11554.547061699, -11685.842712742626, -11372.3699668468, -11461.865010105279, -11401.475155261835, -11457.1546918822, -11477.147275717844, -11657.855649944562, -11649.264979809974, -11652.754583469581, -11658.63780549219, -11634.65449256153, -11694.445759932762, -11588.07576637634, -11609.267342366833, -11431.665057041375, -11599.03386030396, -11325.702846149565, -11585.644624276785, -11422.85799119354, -11471.512723393245, -11404.199834204574, -11717.425358625549, -11590.419534821875, -11494.557346930525, -11653.206612449843, -11732.979388276095, -11637.946837089046, -11679.427736165399, -11522.954521096248, -11518.033535857354, -11673.853409119987, -11496.652862458675, -11463.735082128287, -11609.888339851545, -11424.677516352256, -11552.00603516849, -11507.355703611092, -11747.771684461546, -11646.772801020817, -11422.788495943822, -11430.423639109304, -11324.705743288792, -11529.55193302171, -11560.270500589313], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.514805560124232, "mean_inference_ms": 0.39797550851230923, "mean_action_processing_ms": 0.0973191205071058, "mean_env_wait_ms": 1.724944574915892, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0038361549377441406, "StateBufferConnector_ms": 0.0030451350741916234, "ViewRequirementAgentConnector_ms": 0.0692794058057997}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 152400, "num_agent_steps_trained": 152400, "num_env_steps_sampled": 152400, "num_env_steps_trained": 152400, "num_env_steps_sampled_this_iter": 1080, "num_env_steps_trained_this_iter": 1080, "num_env_steps_sampled_throughput_per_sec": 106.92300596551215, "num_env_steps_trained_throughput_per_sec": 106.92300596551215, "timesteps_total": 152400, "num_steps_trained_this_iter": 1080, "agent_timesteps_total": 152400, "timers": {"training_iteration_time_ms": 3349.975, "sample_time_ms": 3339.0, "load_time_ms": 0.3, "load_throughput": 1201901.966, "learn_time_ms": 9.932, "learn_throughput": 36246.326, "synch_weights_time_ms": 0.7}, "counters": {"num_env_steps_sampled": 152400, "num_env_steps_trained": 152400, "num_agent_steps_sampled": 152400, "num_agent_steps_trained": 152400}, "done": false, "episodes_total": 904, "training_iteration": 189, "trial_id": "14306_00000", "date": "2023-07-26_18-12-19", "timestamp": 1690384339, "time_this_iter_s": 10.103471755981445, "time_total_s": 2039.021933555603, "pid": 7707, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[131310, 5e-05], [136710, 8e-05], [142110, 2.5e-05], [147510, 2.5e-05], [152910, 2.5e-05], [158310, 2.5e-05], [163710, 1e-05], [169110, 1e-05], [174510, 1e-05], [179910, 5e-06], [185310, 5e-06], [190710, 5e-06], [196110, 5e-06], [201510, 1e-06], [206910, 1e-06], [212310, 1e-06], [217710, 1e-06], [223110, 5e-07], [228510, 5e-07], [233910, 2.5e-07], [239310, 2.5e-07], [244710, 1e-07], [250110, 1e-07], [255510, 5e-08], [260910, 5e-08], [266310, 1e-08]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.15, "final_epsilon": 0.05, "epsilon_timesteps": 264960}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x14a3b79d0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 309.1912066936493, "iterations_since_restore": 29, "perf": {"cpu_util_percent": 23.42142857142857, "ram_util_percent": 58.66428571428572}}
