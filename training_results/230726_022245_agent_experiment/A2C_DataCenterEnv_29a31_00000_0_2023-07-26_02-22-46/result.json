{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-07, "entropy_coeff": 0.05, "policy_entropy": 267.512451171875, "policy_loss": -141677.96875, "vf_loss": 8763057.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 3.0, "diff_num_grad_updates_vs_sampler_policy": 2.0}}, "num_env_steps_sampled": 220920, "num_env_steps_trained": 220920, "num_agent_steps_sampled": 220920, "num_agent_steps_trained": 220920}, "sampler_results": {"episode_reward_max": -726.8807054690234, "episode_reward_min": -959.2389568152724, "episode_reward_mean": -865.3814335400851, "episode_len_mean": 120.0, "episode_media": {}, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-726.8807054690234, -910.0246383359593, -959.2389568152724], "episode_lengths": [120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 20.922723569368063, "mean_inference_ms": 0.41676690373724523, "mean_action_processing_ms": 0.09787974265143483, "mean_env_wait_ms": 9.907054108595915, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0038464864095052085, "StateBufferConnector_ms": 0.0028689702351888022, "ViewRequirementAgentConnector_ms": 0.06798108418782552}}, "episode_reward_max": -726.8807054690234, "episode_reward_min": -959.2389568152724, "episode_reward_mean": -865.3814335400851, "episode_len_mean": 120.0, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-726.8807054690234, -910.0246383359593, -959.2389568152724], "episode_lengths": [120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 20.922723569368063, "mean_inference_ms": 0.41676690373724523, "mean_action_processing_ms": 0.09787974265143483, "mean_env_wait_ms": 9.907054108595915, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0038464864095052085, "StateBufferConnector_ms": 0.0028689702351888022, "ViewRequirementAgentConnector_ms": 0.06798108418782552}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 220920, "num_agent_steps_trained": 220920, "num_env_steps_sampled": 220920, "num_env_steps_trained": 220920, "num_env_steps_sampled_this_iter": 360, "num_env_steps_trained_this_iter": 360, "num_env_steps_sampled_throughput_per_sec": 31.632200798381582, "num_env_steps_trained_throughput_per_sec": 31.632200798381582, "timesteps_total": 220920, "num_steps_trained_this_iter": 360, "agent_timesteps_total": 220920, "timers": {"training_iteration_time_ms": 3793.586, "sample_time_ms": 3777.556, "load_time_ms": 0.339, "load_throughput": 353535.341, "learn_time_ms": 14.869, "learn_throughput": 8070.41, "synch_weights_time_ms": 0.774}, "counters": {"num_env_steps_sampled": 220920, "num_env_steps_trained": 220920, "num_agent_steps_sampled": 220920, "num_agent_steps_trained": 220920}, "done": false, "episodes_total": 1841, "training_iteration": 461, "trial_id": "29a31_00000", "date": "2023-07-26_02-23-04", "timestamp": 1690327384, "time_this_iter_s": 11.383714199066162, "time_total_s": 5632.709190130234, "pid": 90822, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 1, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[253680, 5e-06], [256080, 5e-06], [258480, 2.5e-06], [260880, 2.5e-06], [263280, 2.5e-06], [265680, 2.5e-06], [268080, 1e-06], [270480, 1e-06], [272880, 1e-06], [275280, 5e-07], [277680, 5e-07], [280080, 5e-07], [282480, 5e-07], [284880, 5e-07], [287280, 1e-07], [289680, 1e-07], [292080, 1e-07]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 120, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x16ca65700>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 11.383714199066162, "iterations_since_restore": 1, "perf": {"cpu_util_percent": 31.052941176470593, "ram_util_percent": 77.98235294117647}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-07, "entropy_coeff": 0.05, "policy_entropy": 267.4992370605469, "policy_loss": -90770.375, "vf_loss": 3548086.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 7.0, "diff_num_grad_updates_vs_sampler_policy": 6.0}}, "num_env_steps_sampled": 221400, "num_env_steps_trained": 221400, "num_agent_steps_sampled": 221400, "num_agent_steps_trained": 221400}, "sampler_results": {"episode_reward_max": -545.6956984135606, "episode_reward_min": -959.2389568152724, "episode_reward_mean": -814.1766713380418, "episode_len_mean": 120.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-726.8807054690234, -910.0246383359593, -959.2389568152724, -838.2211556646348, -545.6956984135606, -949.1260831696337, -770.0494614982084], "episode_lengths": [120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 20.888050563852126, "mean_inference_ms": 0.4152224917852577, "mean_action_processing_ms": 0.09820455402497354, "mean_env_wait_ms": 7.54067524853179, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004165513174874442, "StateBufferConnector_ms": 0.0028235571725027902, "ViewRequirementAgentConnector_ms": 0.06839888436453682}}, "episode_reward_max": -545.6956984135606, "episode_reward_min": -959.2389568152724, "episode_reward_mean": -814.1766713380418, "episode_len_mean": 120.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-726.8807054690234, -910.0246383359593, -959.2389568152724, -838.2211556646348, -545.6956984135606, -949.1260831696337, -770.0494614982084], "episode_lengths": [120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 20.888050563852126, "mean_inference_ms": 0.4152224917852577, "mean_action_processing_ms": 0.09820455402497354, "mean_env_wait_ms": 7.54067524853179, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004165513174874442, "StateBufferConnector_ms": 0.0028235571725027902, "ViewRequirementAgentConnector_ms": 0.06839888436453682}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 221400, "num_agent_steps_trained": 221400, "num_env_steps_sampled": 221400, "num_env_steps_trained": 221400, "num_env_steps_sampled_this_iter": 480, "num_env_steps_trained_this_iter": 480, "num_env_steps_sampled_throughput_per_sec": 41.57225961476216, "num_env_steps_trained_throughput_per_sec": 41.57225961476216, "timesteps_total": 221400, "num_steps_trained_this_iter": 480, "agent_timesteps_total": 221400, "timers": {"training_iteration_time_ms": 3275.267, "sample_time_ms": 3266.237, "load_time_ms": 0.27, "load_throughput": 444850.424, "learn_time_ms": 7.96, "learn_throughput": 15076.191, "synch_weights_time_ms": 0.758}, "counters": {"num_env_steps_sampled": 221400, "num_env_steps_trained": 221400, "num_agent_steps_sampled": 221400, "num_agent_steps_trained": 221400}, "done": false, "episodes_total": 1845, "training_iteration": 462, "trial_id": "29a31_00000", "date": "2023-07-26_02-23-16", "timestamp": 1690327396, "time_this_iter_s": 11.548583984375, "time_total_s": 5644.257774114609, "pid": 90822, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 1, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[253680, 5e-06], [256080, 5e-06], [258480, 2.5e-06], [260880, 2.5e-06], [263280, 2.5e-06], [265680, 2.5e-06], [268080, 1e-06], [270480, 1e-06], [272880, 1e-06], [275280, 5e-07], [277680, 5e-07], [280080, 5e-07], [282480, 5e-07], [284880, 5e-07], [287280, 1e-07], [289680, 1e-07], [292080, 1e-07]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 120, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x16ca65700>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 22.932298183441162, "iterations_since_restore": 2, "perf": {"cpu_util_percent": 34.825, "ram_util_percent": 74.45}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-07, "entropy_coeff": 0.05, "policy_entropy": 267.48248291015625, "policy_loss": -97186.890625, "vf_loss": 4328030.5}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 11.0, "diff_num_grad_updates_vs_sampler_policy": 10.0}}, "num_env_steps_sampled": 221880, "num_env_steps_trained": 221880, "num_agent_steps_sampled": 221880, "num_agent_steps_trained": 221880}, "sampler_results": {"episode_reward_max": -545.6956984135606, "episode_reward_min": -959.2389568152724, "episode_reward_mean": -801.147158661226, "episode_len_mean": 120.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-726.8807054690234, -910.0246383359593, -959.2389568152724, -838.2211556646348, -545.6956984135606, -949.1260831696337, -770.0494614982084, -866.1901591867485, -767.9635814346034, -660.1648686394927, -819.063436646348], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 20.894522714766644, "mean_inference_ms": 0.41270142592474685, "mean_action_processing_ms": 0.0979177117662162, "mean_env_wait_ms": 6.479312112559168, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004317543723366477, "StateBufferConnector_ms": 0.0028003345836292615, "ViewRequirementAgentConnector_ms": 0.06870573217218573}}, "episode_reward_max": -545.6956984135606, "episode_reward_min": -959.2389568152724, "episode_reward_mean": -801.147158661226, "episode_len_mean": 120.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-726.8807054690234, -910.0246383359593, -959.2389568152724, -838.2211556646348, -545.6956984135606, -949.1260831696337, -770.0494614982084, -866.1901591867485, -767.9635814346034, -660.1648686394927, -819.063436646348], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 20.894522714766644, "mean_inference_ms": 0.41270142592474685, "mean_action_processing_ms": 0.0979177117662162, "mean_env_wait_ms": 6.479312112559168, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004317543723366477, "StateBufferConnector_ms": 0.0028003345836292615, "ViewRequirementAgentConnector_ms": 0.06870573217218573}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 221880, "num_agent_steps_trained": 221880, "num_env_steps_sampled": 221880, "num_env_steps_trained": 221880, "num_env_steps_sampled_this_iter": 480, "num_env_steps_trained_this_iter": 480, "num_env_steps_sampled_throughput_per_sec": 41.37615053355853, "num_env_steps_trained_throughput_per_sec": 41.37615053355853, "timesteps_total": 221880, "num_steps_trained_this_iter": 480, "agent_timesteps_total": 221880, "timers": {"training_iteration_time_ms": 2892.013, "sample_time_ms": 2888.1, "load_time_ms": 0.221, "load_throughput": 542659.278, "learn_time_ms": 2.924, "learn_throughput": 41035.138, "synch_weights_time_ms": 0.728}, "counters": {"num_env_steps_sampled": 221880, "num_env_steps_trained": 221880, "num_agent_steps_sampled": 221880, "num_agent_steps_trained": 221880}, "done": false, "episodes_total": 1849, "training_iteration": 463, "trial_id": "29a31_00000", "date": "2023-07-26_02-23-27", "timestamp": 1690327407, "time_this_iter_s": 11.603363037109375, "time_total_s": 5655.861137151718, "pid": 90822, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 1, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[253680, 5e-06], [256080, 5e-06], [258480, 2.5e-06], [260880, 2.5e-06], [263280, 2.5e-06], [265680, 2.5e-06], [268080, 1e-06], [270480, 1e-06], [272880, 1e-06], [275280, 5e-07], [277680, 5e-07], [280080, 5e-07], [282480, 5e-07], [284880, 5e-07], [287280, 1e-07], [289680, 1e-07], [292080, 1e-07]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 120, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x16ca65700>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 34.53566122055054, "iterations_since_restore": 3, "perf": {"cpu_util_percent": 33.87647058823529, "ram_util_percent": 78.3058823529412}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-07, "entropy_coeff": 0.05, "policy_entropy": 267.4645080566406, "policy_loss": -108319.703125, "vf_loss": 5218822.5}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 15.0, "diff_num_grad_updates_vs_sampler_policy": 14.0}}, "num_env_steps_sampled": 222360, "num_env_steps_trained": 222360, "num_agent_steps_sampled": 222360, "num_agent_steps_trained": 222360}, "sampler_results": {"episode_reward_max": -538.0263443305196, "episode_reward_min": -959.2389568152724, "episode_reward_mean": -790.346268767593, "episode_len_mean": 120.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-726.8807054690234, -910.0246383359593, -959.2389568152724, -838.2211556646348, -545.6956984135606, -949.1260831696337, -770.0494614982084, -866.1901591867485, -767.9635814346034, -660.1648686394927, -819.063436646348, -943.1467361268203, -886.7125040129276, -538.0263443305196, -674.6897017701436], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 20.946888971785995, "mean_inference_ms": 0.41118569871469124, "mean_action_processing_ms": 0.09764858367784032, "mean_env_wait_ms": 5.8448988092555645, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004102389017740886, "StateBufferConnector_ms": 0.0027640660603841147, "ViewRequirementAgentConnector_ms": 0.0686502456665039}}, "episode_reward_max": -538.0263443305196, "episode_reward_min": -959.2389568152724, "episode_reward_mean": -790.346268767593, "episode_len_mean": 120.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-726.8807054690234, -910.0246383359593, -959.2389568152724, -838.2211556646348, -545.6956984135606, -949.1260831696337, -770.0494614982084, -866.1901591867485, -767.9635814346034, -660.1648686394927, -819.063436646348, -943.1467361268203, -886.7125040129276, -538.0263443305196, -674.6897017701436], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 20.946888971785995, "mean_inference_ms": 0.41118569871469124, "mean_action_processing_ms": 0.09764858367784032, "mean_env_wait_ms": 5.8448988092555645, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004102389017740886, "StateBufferConnector_ms": 0.0027640660603841147, "ViewRequirementAgentConnector_ms": 0.0686502456665039}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 222360, "num_agent_steps_trained": 222360, "num_env_steps_sampled": 222360, "num_env_steps_trained": 222360, "num_env_steps_sampled_this_iter": 480, "num_env_steps_trained_this_iter": 480, "num_env_steps_sampled_throughput_per_sec": 40.256717149813774, "num_env_steps_trained_throughput_per_sec": 40.256717149813774, "timesteps_total": 222360, "num_steps_trained_this_iter": 480, "agent_timesteps_total": 222360, "timers": {"training_iteration_time_ms": 2939.315, "sample_time_ms": 2935.497, "load_time_ms": 0.221, "load_throughput": 542717.792, "learn_time_ms": 2.831, "learn_throughput": 42385.973, "synch_weights_time_ms": 0.726}, "counters": {"num_env_steps_sampled": 222360, "num_env_steps_trained": 222360, "num_agent_steps_sampled": 222360, "num_agent_steps_trained": 222360}, "done": false, "episodes_total": 1853, "training_iteration": 464, "trial_id": "29a31_00000", "date": "2023-07-26_02-23-39", "timestamp": 1690327419, "time_this_iter_s": 11.92593002319336, "time_total_s": 5667.7870671749115, "pid": 90822, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 1, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[253680, 5e-06], [256080, 5e-06], [258480, 2.5e-06], [260880, 2.5e-06], [263280, 2.5e-06], [265680, 2.5e-06], [268080, 1e-06], [270480, 1e-06], [272880, 1e-06], [275280, 5e-07], [277680, 5e-07], [280080, 5e-07], [282480, 5e-07], [284880, 5e-07], [287280, 1e-07], [289680, 1e-07], [292080, 1e-07]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 120, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x16ca65700>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 46.4615912437439, "iterations_since_restore": 4, "perf": {"cpu_util_percent": 39.582352941176474, "ram_util_percent": 78.80588235294118}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-07, "entropy_coeff": 0.05, "policy_entropy": 267.47833251953125, "policy_loss": -149598.46875, "vf_loss": 9829675.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 19.0, "diff_num_grad_updates_vs_sampler_policy": 18.0}}, "num_env_steps_sampled": 222840, "num_env_steps_trained": 222840, "num_agent_steps_sampled": 222840, "num_agent_steps_trained": 222840}, "sampler_results": {"episode_reward_max": -538.0263443305196, "episode_reward_min": -1037.9028207106699, "episode_reward_mean": -785.974228729153, "episode_len_mean": 120.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-726.8807054690234, -910.0246383359593, -959.2389568152724, -838.2211556646348, -545.6956984135606, -949.1260831696337, -770.0494614982084, -866.1901591867485, -767.9635814346034, -660.1648686394927, -819.063436646348, -943.1467361268203, -886.7125040129276, -538.0263443305196, -674.6897017701436, -761.115765714462, -542.3565469218164, -736.9411809930638, -1037.9028207106699], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 21.002517288661377, "mean_inference_ms": 0.4098287638025382, "mean_action_processing_ms": 0.09739395831912324, "mean_env_wait_ms": 5.413867586777149, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003972806428608142, "StateBufferConnector_ms": 0.002770674856085526, "ViewRequirementAgentConnector_ms": 0.06820402647319593}}, "episode_reward_max": -538.0263443305196, "episode_reward_min": -1037.9028207106699, "episode_reward_mean": -785.974228729153, "episode_len_mean": 120.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-726.8807054690234, -910.0246383359593, -959.2389568152724, -838.2211556646348, -545.6956984135606, -949.1260831696337, -770.0494614982084, -866.1901591867485, -767.9635814346034, -660.1648686394927, -819.063436646348, -943.1467361268203, -886.7125040129276, -538.0263443305196, -674.6897017701436, -761.115765714462, -542.3565469218164, -736.9411809930638, -1037.9028207106699], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 21.002517288661377, "mean_inference_ms": 0.4098287638025382, "mean_action_processing_ms": 0.09739395831912324, "mean_env_wait_ms": 5.413867586777149, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003972806428608142, "StateBufferConnector_ms": 0.002770674856085526, "ViewRequirementAgentConnector_ms": 0.06820402647319593}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 222840, "num_agent_steps_trained": 222840, "num_env_steps_sampled": 222840, "num_env_steps_trained": 222840, "num_env_steps_sampled_this_iter": 480, "num_env_steps_trained_this_iter": 480, "num_env_steps_sampled_throughput_per_sec": 40.173038520136934, "num_env_steps_trained_throughput_per_sec": 40.173038520136934, "timesteps_total": 222840, "num_steps_trained_this_iter": 480, "agent_timesteps_total": 222840, "timers": {"training_iteration_time_ms": 2968.939, "sample_time_ms": 2965.022, "load_time_ms": 0.225, "load_throughput": 534192.825, "learn_time_ms": 2.92, "learn_throughput": 41093.769, "synch_weights_time_ms": 0.731}, "counters": {"num_env_steps_sampled": 222840, "num_env_steps_trained": 222840, "num_agent_steps_sampled": 222840, "num_agent_steps_trained": 222840}, "done": false, "episodes_total": 1857, "training_iteration": 465, "trial_id": "29a31_00000", "date": "2023-07-26_02-23-51", "timestamp": 1690327431, "time_this_iter_s": 11.9508798122406, "time_total_s": 5679.737946987152, "pid": 90822, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 1, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[253680, 5e-06], [256080, 5e-06], [258480, 2.5e-06], [260880, 2.5e-06], [263280, 2.5e-06], [265680, 2.5e-06], [268080, 1e-06], [270480, 1e-06], [272880, 1e-06], [275280, 5e-07], [277680, 5e-07], [280080, 5e-07], [282480, 5e-07], [284880, 5e-07], [287280, 1e-07], [289680, 1e-07], [292080, 1e-07]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 120, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x16ca65700>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 58.4124710559845, "iterations_since_restore": 5, "perf": {"cpu_util_percent": 38.911764705882355, "ram_util_percent": 78.71176470588236}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-07, "entropy_coeff": 0.05, "policy_entropy": 267.5016784667969, "policy_loss": -163279.265625, "vf_loss": 10307862.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 23.0, "diff_num_grad_updates_vs_sampler_policy": 22.0}}, "num_env_steps_sampled": 223320, "num_env_steps_trained": 223320, "num_agent_steps_sampled": 223320, "num_agent_steps_trained": 223320}, "sampler_results": {"episode_reward_max": -538.0263443305196, "episode_reward_min": -1109.3846433101253, "episode_reward_mean": -779.0324841585297, "episode_len_mean": 120.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-726.8807054690234, -910.0246383359593, -959.2389568152724, -838.2211556646348, -545.6956984135606, -949.1260831696337, -770.0494614982084, -866.1901591867485, -767.9635814346034, -660.1648686394927, -819.063436646348, -943.1467361268203, -886.7125040129276, -538.0263443305196, -674.6897017701436, -761.115765714462, -542.3565469218164, -736.9411809930638, -1037.9028207106699, -647.2917554966986, -580.3247649579893, -647.2356260274616, -1109.3846433101253], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 21.048498969702585, "mean_inference_ms": 0.4089510032589576, "mean_action_processing_ms": 0.09720644419704143, "mean_env_wait_ms": 5.098714060991418, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0038872594418733015, "StateBufferConnector_ms": 0.0027646189150602922, "ViewRequirementAgentConnector_ms": 0.06779484126878821}}, "episode_reward_max": -538.0263443305196, "episode_reward_min": -1109.3846433101253, "episode_reward_mean": -779.0324841585297, "episode_len_mean": 120.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-726.8807054690234, -910.0246383359593, -959.2389568152724, -838.2211556646348, -545.6956984135606, -949.1260831696337, -770.0494614982084, -866.1901591867485, -767.9635814346034, -660.1648686394927, -819.063436646348, -943.1467361268203, -886.7125040129276, -538.0263443305196, -674.6897017701436, -761.115765714462, -542.3565469218164, -736.9411809930638, -1037.9028207106699, -647.2917554966986, -580.3247649579893, -647.2356260274616, -1109.3846433101253], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 21.048498969702585, "mean_inference_ms": 0.4089510032589576, "mean_action_processing_ms": 0.09720644419704143, "mean_env_wait_ms": 5.098714060991418, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0038872594418733015, "StateBufferConnector_ms": 0.0027646189150602922, "ViewRequirementAgentConnector_ms": 0.06779484126878821}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 223320, "num_agent_steps_trained": 223320, "num_env_steps_sampled": 223320, "num_env_steps_trained": 223320, "num_env_steps_sampled_this_iter": 480, "num_env_steps_trained_this_iter": 480, "num_env_steps_sampled_throughput_per_sec": 40.34301743786463, "num_env_steps_trained_throughput_per_sec": 40.34301743786463, "timesteps_total": 223320, "num_steps_trained_this_iter": 480, "agent_timesteps_total": 223320, "timers": {"training_iteration_time_ms": 2989.091, "sample_time_ms": 2985.007, "load_time_ms": 0.243, "load_throughput": 493157.437, "learn_time_ms": 3.044, "learn_throughput": 39415.52, "synch_weights_time_ms": 0.735}, "counters": {"num_env_steps_sampled": 223320, "num_env_steps_trained": 223320, "num_agent_steps_sampled": 223320, "num_agent_steps_trained": 223320}, "done": false, "episodes_total": 1861, "training_iteration": 466, "trial_id": "29a31_00000", "date": "2023-07-26_02-24-03", "timestamp": 1690327443, "time_this_iter_s": 11.900636911392212, "time_total_s": 5691.638583898544, "pid": 90822, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 1, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[253680, 5e-06], [256080, 5e-06], [258480, 2.5e-06], [260880, 2.5e-06], [263280, 2.5e-06], [265680, 2.5e-06], [268080, 1e-06], [270480, 1e-06], [272880, 1e-06], [275280, 5e-07], [277680, 5e-07], [280080, 5e-07], [282480, 5e-07], [284880, 5e-07], [287280, 1e-07], [289680, 1e-07], [292080, 1e-07]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 120, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x16ca65700>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 70.31310796737671, "iterations_since_restore": 6, "perf": {"cpu_util_percent": 35.523529411764706, "ram_util_percent": 78.42941176470588}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-07, "entropy_coeff": 0.05, "policy_entropy": 267.45306396484375, "policy_loss": -76328.421875, "vf_loss": 2427488.25}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 27.0, "diff_num_grad_updates_vs_sampler_policy": 26.0}}, "num_env_steps_sampled": 223800, "num_env_steps_trained": 223800, "num_agent_steps_sampled": 223800, "num_agent_steps_trained": 223800}, "sampler_results": {"episode_reward_max": -438.86208744418377, "episode_reward_min": -1109.3846433101253, "episode_reward_mean": -767.98639522788, "episode_len_mean": 120.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-726.8807054690234, -910.0246383359593, -959.2389568152724, -838.2211556646348, -545.6956984135606, -949.1260831696337, -770.0494614982084, -866.1901591867485, -767.9635814346034, -660.1648686394927, -819.063436646348, -943.1467361268203, -886.7125040129276, -538.0263443305196, -674.6897017701436, -761.115765714462, -542.3565469218164, -736.9411809930638, -1037.9028207106699, -647.2917554966986, -580.3247649579893, -647.2356260274616, -1109.3846433101253, -789.4196789053547, -987.7684243197841, -438.86208744418377, -601.8353448372565], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 21.066602163032226, "mean_inference_ms": 0.4081412480271092, "mean_action_processing_ms": 0.09705088176503116, "mean_env_wait_ms": 4.855549424209533, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003962163571958189, "StateBufferConnector_ms": 0.0027515270091869213, "ViewRequirementAgentConnector_ms": 0.0678998452645761}}, "episode_reward_max": -438.86208744418377, "episode_reward_min": -1109.3846433101253, "episode_reward_mean": -767.98639522788, "episode_len_mean": 120.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-726.8807054690234, -910.0246383359593, -959.2389568152724, -838.2211556646348, -545.6956984135606, -949.1260831696337, -770.0494614982084, -866.1901591867485, -767.9635814346034, -660.1648686394927, -819.063436646348, -943.1467361268203, -886.7125040129276, -538.0263443305196, -674.6897017701436, -761.115765714462, -542.3565469218164, -736.9411809930638, -1037.9028207106699, -647.2917554966986, -580.3247649579893, -647.2356260274616, -1109.3846433101253, -789.4196789053547, -987.7684243197841, -438.86208744418377, -601.8353448372565], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 21.066602163032226, "mean_inference_ms": 0.4081412480271092, "mean_action_processing_ms": 0.09705088176503116, "mean_env_wait_ms": 4.855549424209533, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003962163571958189, "StateBufferConnector_ms": 0.0027515270091869213, "ViewRequirementAgentConnector_ms": 0.0678998452645761}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 223800, "num_agent_steps_trained": 223800, "num_env_steps_sampled": 223800, "num_env_steps_trained": 223800, "num_env_steps_sampled_this_iter": 480, "num_env_steps_trained_this_iter": 480, "num_env_steps_sampled_throughput_per_sec": 41.99796195979538, "num_env_steps_trained_throughput_per_sec": 41.99796195979538, "timesteps_total": 223800, "num_steps_trained_this_iter": 480, "agent_timesteps_total": 223800, "timers": {"training_iteration_time_ms": 2923.186, "sample_time_ms": 2919.177, "load_time_ms": 0.241, "load_throughput": 498234.488, "learn_time_ms": 2.981, "learn_throughput": 40252.76, "synch_weights_time_ms": 0.728}, "counters": {"num_env_steps_sampled": 223800, "num_env_steps_trained": 223800, "num_agent_steps_sampled": 223800, "num_agent_steps_trained": 223800}, "done": false, "episodes_total": 1865, "training_iteration": 467, "trial_id": "29a31_00000", "date": "2023-07-26_02-24-15", "timestamp": 1690327455, "time_this_iter_s": 11.43162488937378, "time_total_s": 5703.070208787918, "pid": 90822, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 1, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[253680, 5e-06], [256080, 5e-06], [258480, 2.5e-06], [260880, 2.5e-06], [263280, 2.5e-06], [265680, 2.5e-06], [268080, 1e-06], [270480, 1e-06], [272880, 1e-06], [275280, 5e-07], [277680, 5e-07], [280080, 5e-07], [282480, 5e-07], [284880, 5e-07], [287280, 1e-07], [289680, 1e-07], [292080, 1e-07]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 120, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x16ca65700>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 81.74473285675049, "iterations_since_restore": 7, "perf": {"cpu_util_percent": 32.3, "ram_util_percent": 77.66250000000001}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-07, "entropy_coeff": 0.05, "policy_entropy": 267.44097900390625, "policy_loss": -68298.7890625, "vf_loss": 2050251.25}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 31.0, "diff_num_grad_updates_vs_sampler_policy": 30.0}}, "num_env_steps_sampled": 224280, "num_env_steps_trained": 224280, "num_agent_steps_sampled": 224280, "num_agent_steps_trained": 224280}, "sampler_results": {"episode_reward_max": -438.86208744418377, "episode_reward_min": -1109.3846433101253, "episode_reward_mean": -775.9968817588311, "episode_len_mean": 120.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-726.8807054690234, -910.0246383359593, -959.2389568152724, -838.2211556646348, -545.6956984135606, -949.1260831696337, -770.0494614982084, -866.1901591867485, -767.9635814346034, -660.1648686394927, -819.063436646348, -943.1467361268203, -886.7125040129276, -538.0263443305196, -674.6897017701436, -761.115765714462, -542.3565469218164, -736.9411809930638, -1037.9028207106699, -647.2917554966986, -580.3247649579893, -647.2356260274616, -1109.3846433101253, -789.4196789053547, -987.7684243197841, -438.86208744418377, -601.8353448372565, -785.5092317718627, -1097.893224576639, -923.7516345999588, -513.116572422542], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 21.079038727540198, "mean_inference_ms": 0.40738411428981014, "mean_action_processing_ms": 0.09691566031240792, "mean_env_wait_ms": 4.661636202936623, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003987743008521295, "StateBufferConnector_ms": 0.002743351844049269, "ViewRequirementAgentConnector_ms": 0.06758935989872102}}, "episode_reward_max": -438.86208744418377, "episode_reward_min": -1109.3846433101253, "episode_reward_mean": -775.9968817588311, "episode_len_mean": 120.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-726.8807054690234, -910.0246383359593, -959.2389568152724, -838.2211556646348, -545.6956984135606, -949.1260831696337, -770.0494614982084, -866.1901591867485, -767.9635814346034, -660.1648686394927, -819.063436646348, -943.1467361268203, -886.7125040129276, -538.0263443305196, -674.6897017701436, -761.115765714462, -542.3565469218164, -736.9411809930638, -1037.9028207106699, -647.2917554966986, -580.3247649579893, -647.2356260274616, -1109.3846433101253, -789.4196789053547, -987.7684243197841, -438.86208744418377, -601.8353448372565, -785.5092317718627, -1097.893224576639, -923.7516345999588, -513.116572422542], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 21.079038727540198, "mean_inference_ms": 0.40738411428981014, "mean_action_processing_ms": 0.09691566031240792, "mean_env_wait_ms": 4.661636202936623, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003987743008521295, "StateBufferConnector_ms": 0.002743351844049269, "ViewRequirementAgentConnector_ms": 0.06758935989872102}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 224280, "num_agent_steps_trained": 224280, "num_env_steps_sampled": 224280, "num_env_steps_trained": 224280, "num_env_steps_sampled_this_iter": 480, "num_env_steps_trained_this_iter": 480, "num_env_steps_sampled_throughput_per_sec": 41.11479025925057, "num_env_steps_trained_throughput_per_sec": 41.11479025925057, "timesteps_total": 224280, "num_steps_trained_this_iter": 480, "agent_timesteps_total": 224280, "timers": {"training_iteration_time_ms": 2902.651, "sample_time_ms": 2898.63, "load_time_ms": 0.241, "load_throughput": 497643.346, "learn_time_ms": 2.987, "learn_throughput": 40178.212, "synch_weights_time_ms": 0.733}, "counters": {"num_env_steps_sampled": 224280, "num_env_steps_trained": 224280, "num_agent_steps_sampled": 224280, "num_agent_steps_trained": 224280}, "done": false, "episodes_total": 1869, "training_iteration": 468, "trial_id": "29a31_00000", "date": "2023-07-26_02-24-26", "timestamp": 1690327466, "time_this_iter_s": 11.677015781402588, "time_total_s": 5714.747224569321, "pid": 90822, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 1, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[253680, 5e-06], [256080, 5e-06], [258480, 2.5e-06], [260880, 2.5e-06], [263280, 2.5e-06], [265680, 2.5e-06], [268080, 1e-06], [270480, 1e-06], [272880, 1e-06], [275280, 5e-07], [277680, 5e-07], [280080, 5e-07], [282480, 5e-07], [284880, 5e-07], [287280, 1e-07], [289680, 1e-07], [292080, 1e-07]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 120, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x16ca65700>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 93.42174863815308, "iterations_since_restore": 8, "perf": {"cpu_util_percent": 35.34705882352941, "ram_util_percent": 78.08235294117648}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-07, "entropy_coeff": 0.05, "policy_entropy": 267.45172119140625, "policy_loss": -63906.75390625, "vf_loss": 1967809.125}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 35.0, "diff_num_grad_updates_vs_sampler_policy": 34.0}}, "num_env_steps_sampled": 224760, "num_env_steps_trained": 224760, "num_agent_steps_sampled": 224760, "num_agent_steps_trained": 224760}, "sampler_results": {"episode_reward_max": -438.86208744418377, "episode_reward_min": -1109.3846433101253, "episode_reward_mean": -781.1396285609218, "episode_len_mean": 120.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-726.8807054690234, -910.0246383359593, -959.2389568152724, -838.2211556646348, -545.6956984135606, -949.1260831696337, -770.0494614982084, -866.1901591867485, -767.9635814346034, -660.1648686394927, -819.063436646348, -943.1467361268203, -886.7125040129276, -538.0263443305196, -674.6897017701436, -761.115765714462, -542.3565469218164, -736.9411809930638, -1037.9028207106699, -647.2917554966986, -580.3247649579893, -647.2356260274616, -1109.3846433101253, -789.4196789053547, -987.7684243197841, -438.86208744418377, -601.8353448372565, -785.5092317718627, -1097.893224576639, -923.7516345999588, -513.116572422542, -1046.5206012100732, -1020.8328057930153, -707.6916014324142, -508.93865667299724], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 21.08739571268644, "mean_inference_ms": 0.40670922577801616, "mean_action_processing_ms": 0.09680088854869257, "mean_env_wait_ms": 4.502679831190117, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003940718514578683, "StateBufferConnector_ms": 0.002734320504324777, "ViewRequirementAgentConnector_ms": 0.06758757999965123}}, "episode_reward_max": -438.86208744418377, "episode_reward_min": -1109.3846433101253, "episode_reward_mean": -781.1396285609218, "episode_len_mean": 120.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-726.8807054690234, -910.0246383359593, -959.2389568152724, -838.2211556646348, -545.6956984135606, -949.1260831696337, -770.0494614982084, -866.1901591867485, -767.9635814346034, -660.1648686394927, -819.063436646348, -943.1467361268203, -886.7125040129276, -538.0263443305196, -674.6897017701436, -761.115765714462, -542.3565469218164, -736.9411809930638, -1037.9028207106699, -647.2917554966986, -580.3247649579893, -647.2356260274616, -1109.3846433101253, -789.4196789053547, -987.7684243197841, -438.86208744418377, -601.8353448372565, -785.5092317718627, -1097.893224576639, -923.7516345999588, -513.116572422542, -1046.5206012100732, -1020.8328057930153, -707.6916014324142, -508.93865667299724], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 21.08739571268644, "mean_inference_ms": 0.40670922577801616, "mean_action_processing_ms": 0.09680088854869257, "mean_env_wait_ms": 4.502679831190117, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003940718514578683, "StateBufferConnector_ms": 0.002734320504324777, "ViewRequirementAgentConnector_ms": 0.06758757999965123}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 224760, "num_agent_steps_trained": 224760, "num_env_steps_sampled": 224760, "num_env_steps_trained": 224760, "num_env_steps_sampled_this_iter": 480, "num_env_steps_trained_this_iter": 480, "num_env_steps_sampled_throughput_per_sec": 41.20508356496789, "num_env_steps_trained_throughput_per_sec": 41.20508356496789, "timesteps_total": 224760, "num_steps_trained_this_iter": 480, "agent_timesteps_total": 224760, "timers": {"training_iteration_time_ms": 2905.781, "sample_time_ms": 2901.975, "load_time_ms": 0.222, "load_throughput": 540561.143, "learn_time_ms": 2.835, "learn_throughput": 42333.567, "synch_weights_time_ms": 0.709}, "counters": {"num_env_steps_sampled": 224760, "num_env_steps_trained": 224760, "num_agent_steps_sampled": 224760, "num_agent_steps_trained": 224760}, "done": false, "episodes_total": 1873, "training_iteration": 469, "trial_id": "29a31_00000", "date": "2023-07-26_02-24-38", "timestamp": 1690327478, "time_this_iter_s": 11.651465892791748, "time_total_s": 5726.398690462112, "pid": 90822, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 1, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[253680, 5e-06], [256080, 5e-06], [258480, 2.5e-06], [260880, 2.5e-06], [263280, 2.5e-06], [265680, 2.5e-06], [268080, 1e-06], [270480, 1e-06], [272880, 1e-06], [275280, 5e-07], [277680, 5e-07], [280080, 5e-07], [282480, 5e-07], [284880, 5e-07], [287280, 1e-07], [289680, 1e-07], [292080, 1e-07]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 120, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x16ca65700>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 105.07321453094482, "iterations_since_restore": 9, "perf": {"cpu_util_percent": 37.79375, "ram_util_percent": 75.9875}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-07, "entropy_coeff": 0.05, "policy_entropy": 267.48846435546875, "policy_loss": -97324.1171875, "vf_loss": 4293791.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 39.0, "diff_num_grad_updates_vs_sampler_policy": 38.0}}, "num_env_steps_sampled": 225240, "num_env_steps_trained": 225240, "num_agent_steps_sampled": 225240, "num_agent_steps_trained": 225240}, "sampler_results": {"episode_reward_max": -438.86208744418377, "episode_reward_min": -1109.3846433101253, "episode_reward_mean": -768.1155317870274, "episode_len_mean": 120.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-726.8807054690234, -910.0246383359593, -959.2389568152724, -838.2211556646348, -545.6956984135606, -949.1260831696337, -770.0494614982084, -866.1901591867485, -767.9635814346034, -660.1648686394927, -819.063436646348, -943.1467361268203, -886.7125040129276, -538.0263443305196, -674.6897017701436, -761.115765714462, -542.3565469218164, -736.9411809930638, -1037.9028207106699, -647.2917554966986, -580.3247649579893, -647.2356260274616, -1109.3846433101253, -789.4196789053547, -987.7684243197841, -438.86208744418377, -601.8353448372565, -785.5092317718627, -1097.893224576639, -923.7516345999588, -513.116572422542, -1046.5206012100732, -1020.8328057930153, -707.6916014324142, -508.93865667299724, -585.2377905999639, -602.8732502128115, -621.085564677536, -807.4221345714965], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 21.092451470787925, "mean_inference_ms": 0.4061138465960831, "mean_action_processing_ms": 0.09669623334987681, "mean_env_wait_ms": 4.3706993633212825, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0039137326754056494, "StateBufferConnector_ms": 0.0027161378126878003, "ViewRequirementAgentConnector_ms": 0.06768092131003356}}, "episode_reward_max": -438.86208744418377, "episode_reward_min": -1109.3846433101253, "episode_reward_mean": -768.1155317870274, "episode_len_mean": 120.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-726.8807054690234, -910.0246383359593, -959.2389568152724, -838.2211556646348, -545.6956984135606, -949.1260831696337, -770.0494614982084, -866.1901591867485, -767.9635814346034, -660.1648686394927, -819.063436646348, -943.1467361268203, -886.7125040129276, -538.0263443305196, -674.6897017701436, -761.115765714462, -542.3565469218164, -736.9411809930638, -1037.9028207106699, -647.2917554966986, -580.3247649579893, -647.2356260274616, -1109.3846433101253, -789.4196789053547, -987.7684243197841, -438.86208744418377, -601.8353448372565, -785.5092317718627, -1097.893224576639, -923.7516345999588, -513.116572422542, -1046.5206012100732, -1020.8328057930153, -707.6916014324142, -508.93865667299724, -585.2377905999639, -602.8732502128115, -621.085564677536, -807.4221345714965], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 21.092451470787925, "mean_inference_ms": 0.4061138465960831, "mean_action_processing_ms": 0.09669623334987681, "mean_env_wait_ms": 4.3706993633212825, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0039137326754056494, "StateBufferConnector_ms": 0.0027161378126878003, "ViewRequirementAgentConnector_ms": 0.06768092131003356}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 225240, "num_agent_steps_trained": 225240, "num_env_steps_sampled": 225240, "num_env_steps_trained": 225240, "num_env_steps_sampled_this_iter": 480, "num_env_steps_trained_this_iter": 480, "num_env_steps_sampled_throughput_per_sec": 41.14909563250131, "num_env_steps_trained_throughput_per_sec": 41.14909563250131, "timesteps_total": 225240, "num_steps_trained_this_iter": 480, "agent_timesteps_total": 225240, "timers": {"training_iteration_time_ms": 2918.875, "sample_time_ms": 2915.095, "load_time_ms": 0.22, "load_throughput": 545659.67, "learn_time_ms": 2.819, "learn_throughput": 42567.721, "synch_weights_time_ms": 0.702}, "counters": {"num_env_steps_sampled": 225240, "num_env_steps_trained": 225240, "num_agent_steps_sampled": 225240, "num_agent_steps_trained": 225240}, "done": false, "episodes_total": 1877, "training_iteration": 470, "trial_id": "29a31_00000", "date": "2023-07-26_02-24-50", "timestamp": 1690327490, "time_this_iter_s": 11.667479991912842, "time_total_s": 5738.066170454025, "pid": 90822, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 1, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[253680, 5e-06], [256080, 5e-06], [258480, 2.5e-06], [260880, 2.5e-06], [263280, 2.5e-06], [265680, 2.5e-06], [268080, 1e-06], [270480, 1e-06], [272880, 1e-06], [275280, 5e-07], [277680, 5e-07], [280080, 5e-07], [282480, 5e-07], [284880, 5e-07], [287280, 1e-07], [289680, 1e-07], [292080, 1e-07]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 120, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x16ca65700>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 116.74069452285767, "iterations_since_restore": 10, "perf": {"cpu_util_percent": 39.50000000000001, "ram_util_percent": 76.63529411764705}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-07, "entropy_coeff": 0.05, "policy_entropy": 267.4924011230469, "policy_loss": -106748.6015625, "vf_loss": 5503090.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 43.0, "diff_num_grad_updates_vs_sampler_policy": 42.0}}, "num_env_steps_sampled": 225720, "num_env_steps_trained": 225720, "num_agent_steps_sampled": 225720, "num_agent_steps_trained": 225720}, "sampler_results": {"episode_reward_max": -438.86208744418377, "episode_reward_min": -1109.3846433101253, "episode_reward_mean": -757.2390217312455, "episode_len_mean": 120.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-726.8807054690234, -910.0246383359593, -959.2389568152724, -838.2211556646348, -545.6956984135606, -949.1260831696337, -770.0494614982084, -866.1901591867485, -767.9635814346034, -660.1648686394927, -819.063436646348, -943.1467361268203, -886.7125040129276, -538.0263443305196, -674.6897017701436, -761.115765714462, -542.3565469218164, -736.9411809930638, -1037.9028207106699, -647.2917554966986, -580.3247649579893, -647.2356260274616, -1109.3846433101253, -789.4196789053547, -987.7684243197841, -438.86208744418377, -601.8353448372565, -785.5092317718627, -1097.893224576639, -923.7516345999588, -513.116572422542, -1046.5206012100732, -1020.8328057930153, -707.6916014324142, -508.93865667299724, -585.2377905999639, -602.8732502128115, -621.085564677536, -807.4221345714965, -733.8959402616267, -504.9023758256783, -535.227544086126, -830.7463345760563], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 21.10013570087674, "mean_inference_ms": 0.4056460771710464, "mean_action_processing_ms": 0.09661474622670174, "mean_env_wait_ms": 4.25890128109936, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003947768100472384, "StateBufferConnector_ms": 0.002736823503361192, "ViewRequirementAgentConnector_ms": 0.06758944932804552}}, "episode_reward_max": -438.86208744418377, "episode_reward_min": -1109.3846433101253, "episode_reward_mean": -757.2390217312455, "episode_len_mean": 120.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-726.8807054690234, -910.0246383359593, -959.2389568152724, -838.2211556646348, -545.6956984135606, -949.1260831696337, -770.0494614982084, -866.1901591867485, -767.9635814346034, -660.1648686394927, -819.063436646348, -943.1467361268203, -886.7125040129276, -538.0263443305196, -674.6897017701436, -761.115765714462, -542.3565469218164, -736.9411809930638, -1037.9028207106699, -647.2917554966986, -580.3247649579893, -647.2356260274616, -1109.3846433101253, -789.4196789053547, -987.7684243197841, -438.86208744418377, -601.8353448372565, -785.5092317718627, -1097.893224576639, -923.7516345999588, -513.116572422542, -1046.5206012100732, -1020.8328057930153, -707.6916014324142, -508.93865667299724, -585.2377905999639, -602.8732502128115, -621.085564677536, -807.4221345714965, -733.8959402616267, -504.9023758256783, -535.227544086126, -830.7463345760563], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 21.10013570087674, "mean_inference_ms": 0.4056460771710464, "mean_action_processing_ms": 0.09661474622670174, "mean_env_wait_ms": 4.25890128109936, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003947768100472384, "StateBufferConnector_ms": 0.002736823503361192, "ViewRequirementAgentConnector_ms": 0.06758944932804552}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 225720, "num_agent_steps_trained": 225720, "num_env_steps_sampled": 225720, "num_env_steps_trained": 225720, "num_env_steps_sampled_this_iter": 480, "num_env_steps_trained_this_iter": 480, "num_env_steps_sampled_throughput_per_sec": 40.26002340172221, "num_env_steps_trained_throughput_per_sec": 40.26002340172221, "timesteps_total": 225720, "num_steps_trained_this_iter": 480, "agent_timesteps_total": 225720, "timers": {"training_iteration_time_ms": 2947.669, "sample_time_ms": 2943.805, "load_time_ms": 0.221, "load_throughput": 543538.315, "learn_time_ms": 2.886, "learn_throughput": 41574.757, "synch_weights_time_ms": 0.716}, "counters": {"num_env_steps_sampled": 225720, "num_env_steps_trained": 225720, "num_agent_steps_sampled": 225720, "num_agent_steps_trained": 225720}, "done": false, "episodes_total": 1881, "training_iteration": 471, "trial_id": "29a31_00000", "date": "2023-07-26_02-25-02", "timestamp": 1690327502, "time_this_iter_s": 11.925021171569824, "time_total_s": 5749.991191625595, "pid": 90822, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 1, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[253680, 5e-06], [256080, 5e-06], [258480, 2.5e-06], [260880, 2.5e-06], [263280, 2.5e-06], [265680, 2.5e-06], [268080, 1e-06], [270480, 1e-06], [272880, 1e-06], [275280, 5e-07], [277680, 5e-07], [280080, 5e-07], [282480, 5e-07], [284880, 5e-07], [287280, 1e-07], [289680, 1e-07], [292080, 1e-07]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 120, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x16ca65700>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 128.6657156944275, "iterations_since_restore": 11, "perf": {"cpu_util_percent": 35.96470588235293, "ram_util_percent": 78.63529411764705}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-07, "entropy_coeff": 0.05, "policy_entropy": 267.4560241699219, "policy_loss": -101732.1953125, "vf_loss": 4977006.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 47.0, "diff_num_grad_updates_vs_sampler_policy": 46.0}}, "num_env_steps_sampled": 226200, "num_env_steps_trained": 226200, "num_agent_steps_sampled": 226200, "num_agent_steps_trained": 226200}, "sampler_results": {"episode_reward_max": -438.86208744418377, "episode_reward_min": -1109.3846433101253, "episode_reward_mean": -761.509140347173, "episode_len_mean": 120.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-726.8807054690234, -910.0246383359593, -959.2389568152724, -838.2211556646348, -545.6956984135606, -949.1260831696337, -770.0494614982084, -866.1901591867485, -767.9635814346034, -660.1648686394927, -819.063436646348, -943.1467361268203, -886.7125040129276, -538.0263443305196, -674.6897017701436, -761.115765714462, -542.3565469218164, -736.9411809930638, -1037.9028207106699, -647.2917554966986, -580.3247649579893, -647.2356260274616, -1109.3846433101253, -789.4196789053547, -987.7684243197841, -438.86208744418377, -601.8353448372565, -785.5092317718627, -1097.893224576639, -923.7516345999588, -513.116572422542, -1046.5206012100732, -1020.8328057930153, -707.6916014324142, -508.93865667299724, -585.2377905999639, -602.8732502128115, -621.085564677536, -807.4221345714965, -733.8959402616267, -504.9023758256783, -535.227544086126, -830.7463345760563, -869.2392853804182, -688.2975757953916, -855.6557076104586, -816.4590930873079], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 21.10394715820112, "mean_inference_ms": 0.40528471378592545, "mean_action_processing_ms": 0.09655231390179964, "mean_env_wait_ms": 4.162173134742225, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0038999192258144947, "StateBufferConnector_ms": 0.00273724819751496, "ViewRequirementAgentConnector_ms": 0.06750745976224859}}, "episode_reward_max": -438.86208744418377, "episode_reward_min": -1109.3846433101253, "episode_reward_mean": -761.509140347173, "episode_len_mean": 120.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-726.8807054690234, -910.0246383359593, -959.2389568152724, -838.2211556646348, -545.6956984135606, -949.1260831696337, -770.0494614982084, -866.1901591867485, -767.9635814346034, -660.1648686394927, -819.063436646348, -943.1467361268203, -886.7125040129276, -538.0263443305196, -674.6897017701436, -761.115765714462, -542.3565469218164, -736.9411809930638, -1037.9028207106699, -647.2917554966986, -580.3247649579893, -647.2356260274616, -1109.3846433101253, -789.4196789053547, -987.7684243197841, -438.86208744418377, -601.8353448372565, -785.5092317718627, -1097.893224576639, -923.7516345999588, -513.116572422542, -1046.5206012100732, -1020.8328057930153, -707.6916014324142, -508.93865667299724, -585.2377905999639, -602.8732502128115, -621.085564677536, -807.4221345714965, -733.8959402616267, -504.9023758256783, -535.227544086126, -830.7463345760563, -869.2392853804182, -688.2975757953916, -855.6557076104586, -816.4590930873079], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 21.10394715820112, "mean_inference_ms": 0.40528471378592545, "mean_action_processing_ms": 0.09655231390179964, "mean_env_wait_ms": 4.162173134742225, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0038999192258144947, "StateBufferConnector_ms": 0.00273724819751496, "ViewRequirementAgentConnector_ms": 0.06750745976224859}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 226200, "num_agent_steps_trained": 226200, "num_env_steps_sampled": 226200, "num_env_steps_trained": 226200, "num_env_steps_sampled_this_iter": 480, "num_env_steps_trained_this_iter": 480, "num_env_steps_sampled_throughput_per_sec": 41.62985340907188, "num_env_steps_trained_throughput_per_sec": 41.62985340907188, "timesteps_total": 226200, "num_steps_trained_this_iter": 480, "agent_timesteps_total": 226200, "timers": {"training_iteration_time_ms": 2932.923, "sample_time_ms": 2928.998, "load_time_ms": 0.222, "load_throughput": 539518.148, "learn_time_ms": 2.939, "learn_throughput": 40826.437, "synch_weights_time_ms": 0.723}, "counters": {"num_env_steps_sampled": 226200, "num_env_steps_trained": 226200, "num_agent_steps_sampled": 226200, "num_agent_steps_trained": 226200}, "done": false, "episodes_total": 1885, "training_iteration": 472, "trial_id": "29a31_00000", "date": "2023-07-26_02-25-13", "timestamp": 1690327513, "time_this_iter_s": 11.532758951187134, "time_total_s": 5761.523950576782, "pid": 90822, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 1, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[253680, 5e-06], [256080, 5e-06], [258480, 2.5e-06], [260880, 2.5e-06], [263280, 2.5e-06], [265680, 2.5e-06], [268080, 1e-06], [270480, 1e-06], [272880, 1e-06], [275280, 5e-07], [277680, 5e-07], [280080, 5e-07], [282480, 5e-07], [284880, 5e-07], [287280, 1e-07], [289680, 1e-07], [292080, 1e-07]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 120, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x16ca65700>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 140.19847464561462, "iterations_since_restore": 12, "perf": {"cpu_util_percent": 37.71875, "ram_util_percent": 77.01875}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-07, "entropy_coeff": 0.05, "policy_entropy": 267.4549865722656, "policy_loss": -127313.09375, "vf_loss": 6586659.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 51.0, "diff_num_grad_updates_vs_sampler_policy": 50.0}}, "num_env_steps_sampled": 226680, "num_env_steps_trained": 226680, "num_agent_steps_sampled": 226680, "num_agent_steps_trained": 226680}, "sampler_results": {"episode_reward_max": -438.86208744418377, "episode_reward_min": -1109.3846433101253, "episode_reward_mean": -775.2919490206727, "episode_len_mean": 120.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-726.8807054690234, -910.0246383359593, -959.2389568152724, -838.2211556646348, -545.6956984135606, -949.1260831696337, -770.0494614982084, -866.1901591867485, -767.9635814346034, -660.1648686394927, -819.063436646348, -943.1467361268203, -886.7125040129276, -538.0263443305196, -674.6897017701436, -761.115765714462, -542.3565469218164, -736.9411809930638, -1037.9028207106699, -647.2917554966986, -580.3247649579893, -647.2356260274616, -1109.3846433101253, -789.4196789053547, -987.7684243197841, -438.86208744418377, -601.8353448372565, -785.5092317718627, -1097.893224576639, -923.7516345999588, -513.116572422542, -1046.5206012100732, -1020.8328057930153, -707.6916014324142, -508.93865667299724, -585.2377905999639, -602.8732502128115, -621.085564677536, -807.4221345714965, -733.8959402616267, -504.9023758256783, -535.227544086126, -830.7463345760563, -869.2392853804182, -688.2975757953916, -855.6557076104586, -816.4590930873079, -852.585947072578, -818.8534892446769, -1067.7114821321316, -1009.8088852877822], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 21.10555683731849, "mean_inference_ms": 0.40496837995662893, "mean_action_processing_ms": 0.09649498462778254, "mean_env_wait_ms": 4.07769881407755, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0039259592692057295, "StateBufferConnector_ms": 0.0027324639114679073, "ViewRequirementAgentConnector_ms": 0.067443473666322}}, "episode_reward_max": -438.86208744418377, "episode_reward_min": -1109.3846433101253, "episode_reward_mean": -775.2919490206727, "episode_len_mean": 120.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-726.8807054690234, -910.0246383359593, -959.2389568152724, -838.2211556646348, -545.6956984135606, -949.1260831696337, -770.0494614982084, -866.1901591867485, -767.9635814346034, -660.1648686394927, -819.063436646348, -943.1467361268203, -886.7125040129276, -538.0263443305196, -674.6897017701436, -761.115765714462, -542.3565469218164, -736.9411809930638, -1037.9028207106699, -647.2917554966986, -580.3247649579893, -647.2356260274616, -1109.3846433101253, -789.4196789053547, -987.7684243197841, -438.86208744418377, -601.8353448372565, -785.5092317718627, -1097.893224576639, -923.7516345999588, -513.116572422542, -1046.5206012100732, -1020.8328057930153, -707.6916014324142, -508.93865667299724, -585.2377905999639, -602.8732502128115, -621.085564677536, -807.4221345714965, -733.8959402616267, -504.9023758256783, -535.227544086126, -830.7463345760563, -869.2392853804182, -688.2975757953916, -855.6557076104586, -816.4590930873079, -852.585947072578, -818.8534892446769, -1067.7114821321316, -1009.8088852877822], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 21.10555683731849, "mean_inference_ms": 0.40496837995662893, "mean_action_processing_ms": 0.09649498462778254, "mean_env_wait_ms": 4.07769881407755, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0039259592692057295, "StateBufferConnector_ms": 0.0027324639114679073, "ViewRequirementAgentConnector_ms": 0.067443473666322}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 226680, "num_agent_steps_trained": 226680, "num_env_steps_sampled": 226680, "num_env_steps_trained": 226680, "num_env_steps_sampled_this_iter": 480, "num_env_steps_trained_this_iter": 480, "num_env_steps_sampled_throughput_per_sec": 41.48993960641696, "num_env_steps_trained_throughput_per_sec": 41.48993960641696, "timesteps_total": 226680, "num_steps_trained_this_iter": 480, "agent_timesteps_total": 226680, "timers": {"training_iteration_time_ms": 2894.045, "sample_time_ms": 2890.128, "load_time_ms": 0.223, "load_throughput": 538018.685, "learn_time_ms": 2.931, "learn_throughput": 40935.015, "synch_weights_time_ms": 0.722}, "counters": {"num_env_steps_sampled": 226680, "num_env_steps_trained": 226680, "num_agent_steps_sampled": 226680, "num_agent_steps_trained": 226680}, "done": false, "episodes_total": 1889, "training_iteration": 473, "trial_id": "29a31_00000", "date": "2023-07-26_02-25-25", "timestamp": 1690327525, "time_this_iter_s": 11.571682929992676, "time_total_s": 5773.095633506775, "pid": 90822, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 1, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[253680, 5e-06], [256080, 5e-06], [258480, 2.5e-06], [260880, 2.5e-06], [263280, 2.5e-06], [265680, 2.5e-06], [268080, 1e-06], [270480, 1e-06], [272880, 1e-06], [275280, 5e-07], [277680, 5e-07], [280080, 5e-07], [282480, 5e-07], [284880, 5e-07], [287280, 1e-07], [289680, 1e-07], [292080, 1e-07]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 120, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x16ca65700>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 151.7701575756073, "iterations_since_restore": 13, "perf": {"cpu_util_percent": 31.970588235294116, "ram_util_percent": 77.6470588235294}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-07, "entropy_coeff": 0.05, "policy_entropy": 267.4560852050781, "policy_loss": -118453.2578125, "vf_loss": 6680650.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 55.0, "diff_num_grad_updates_vs_sampler_policy": 54.0}}, "num_env_steps_sampled": 227160, "num_env_steps_trained": 227160, "num_agent_steps_sampled": 227160, "num_agent_steps_trained": 227160}, "sampler_results": {"episode_reward_max": -438.86208744418377, "episode_reward_min": -1109.3846433101253, "episode_reward_mean": -786.3826277109166, "episode_len_mean": 120.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-726.8807054690234, -910.0246383359593, -959.2389568152724, -838.2211556646348, -545.6956984135606, -949.1260831696337, -770.0494614982084, -866.1901591867485, -767.9635814346034, -660.1648686394927, -819.063436646348, -943.1467361268203, -886.7125040129276, -538.0263443305196, -674.6897017701436, -761.115765714462, -542.3565469218164, -736.9411809930638, -1037.9028207106699, -647.2917554966986, -580.3247649579893, -647.2356260274616, -1109.3846433101253, -789.4196789053547, -987.7684243197841, -438.86208744418377, -601.8353448372565, -785.5092317718627, -1097.893224576639, -923.7516345999588, -513.116572422542, -1046.5206012100732, -1020.8328057930153, -707.6916014324142, -508.93865667299724, -585.2377905999639, -602.8732502128115, -621.085564677536, -807.4221345714965, -733.8959402616267, -504.9023758256783, -535.227544086126, -830.7463345760563, -869.2392853804182, -688.2975757953916, -855.6557076104586, -816.4590930873079, -852.585947072578, -818.8534892446769, -1067.7114821321316, -1009.8088852877822, -930.6718950336667, -871.2061796795947, -888.2774470322815, -1020.9996023005622], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 21.10499259249523, "mean_inference_ms": 0.40469788788140354, "mean_action_processing_ms": 0.09644660123822114, "mean_env_wait_ms": 4.0030567479543135, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0039317391135475855, "StateBufferConnector_ms": 0.0027392127297141337, "ViewRequirementAgentConnector_ms": 0.06772951646284624}}, "episode_reward_max": -438.86208744418377, "episode_reward_min": -1109.3846433101253, "episode_reward_mean": -786.3826277109166, "episode_len_mean": 120.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-726.8807054690234, -910.0246383359593, -959.2389568152724, -838.2211556646348, -545.6956984135606, -949.1260831696337, -770.0494614982084, -866.1901591867485, -767.9635814346034, -660.1648686394927, -819.063436646348, -943.1467361268203, -886.7125040129276, -538.0263443305196, -674.6897017701436, -761.115765714462, -542.3565469218164, -736.9411809930638, -1037.9028207106699, -647.2917554966986, -580.3247649579893, -647.2356260274616, -1109.3846433101253, -789.4196789053547, -987.7684243197841, -438.86208744418377, -601.8353448372565, -785.5092317718627, -1097.893224576639, -923.7516345999588, -513.116572422542, -1046.5206012100732, -1020.8328057930153, -707.6916014324142, -508.93865667299724, -585.2377905999639, -602.8732502128115, -621.085564677536, -807.4221345714965, -733.8959402616267, -504.9023758256783, -535.227544086126, -830.7463345760563, -869.2392853804182, -688.2975757953916, -855.6557076104586, -816.4590930873079, -852.585947072578, -818.8534892446769, -1067.7114821321316, -1009.8088852877822, -930.6718950336667, -871.2061796795947, -888.2774470322815, -1020.9996023005622], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 21.10499259249523, "mean_inference_ms": 0.40469788788140354, "mean_action_processing_ms": 0.09644660123822114, "mean_env_wait_ms": 4.0030567479543135, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0039317391135475855, "StateBufferConnector_ms": 0.0027392127297141337, "ViewRequirementAgentConnector_ms": 0.06772951646284624}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 227160, "num_agent_steps_trained": 227160, "num_env_steps_sampled": 227160, "num_env_steps_trained": 227160, "num_env_steps_sampled_this_iter": 480, "num_env_steps_trained_this_iter": 480, "num_env_steps_sampled_throughput_per_sec": 41.753384817948486, "num_env_steps_trained_throughput_per_sec": 41.753384817948486, "timesteps_total": 227160, "num_steps_trained_this_iter": 480, "agent_timesteps_total": 227160, "timers": {"training_iteration_time_ms": 2876.579, "sample_time_ms": 2872.775, "load_time_ms": 0.219, "load_throughput": 548095.916, "learn_time_ms": 2.838, "learn_throughput": 42288.04, "synch_weights_time_ms": 0.708}, "counters": {"num_env_steps_sampled": 227160, "num_env_steps_trained": 227160, "num_agent_steps_sampled": 227160, "num_agent_steps_trained": 227160}, "done": false, "episodes_total": 1893, "training_iteration": 474, "trial_id": "29a31_00000", "date": "2023-07-26_02-25-36", "timestamp": 1690327536, "time_this_iter_s": 11.498589992523193, "time_total_s": 5784.594223499298, "pid": 90822, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 1, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[253680, 5e-06], [256080, 5e-06], [258480, 2.5e-06], [260880, 2.5e-06], [263280, 2.5e-06], [265680, 2.5e-06], [268080, 1e-06], [270480, 1e-06], [272880, 1e-06], [275280, 5e-07], [277680, 5e-07], [280080, 5e-07], [282480, 5e-07], [284880, 5e-07], [287280, 1e-07], [289680, 1e-07], [292080, 1e-07]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 120, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x16ca65700>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 163.2687475681305, "iterations_since_restore": 14, "perf": {"cpu_util_percent": 37.175, "ram_util_percent": 77.56875}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-07, "entropy_coeff": 0.05, "policy_entropy": 267.4397888183594, "policy_loss": -80786.515625, "vf_loss": 3217841.5}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 59.0, "diff_num_grad_updates_vs_sampler_policy": 58.0}}, "num_env_steps_sampled": 227640, "num_env_steps_trained": 227640, "num_agent_steps_sampled": 227640, "num_agent_steps_trained": 227640}, "sampler_results": {"episode_reward_max": -438.86208744418377, "episode_reward_min": -1109.3846433101253, "episode_reward_mean": -782.8988322170246, "episode_len_mean": 120.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-726.8807054690234, -910.0246383359593, -959.2389568152724, -838.2211556646348, -545.6956984135606, -949.1260831696337, -770.0494614982084, -866.1901591867485, -767.9635814346034, -660.1648686394927, -819.063436646348, -943.1467361268203, -886.7125040129276, -538.0263443305196, -674.6897017701436, -761.115765714462, -542.3565469218164, -736.9411809930638, -1037.9028207106699, -647.2917554966986, -580.3247649579893, -647.2356260274616, -1109.3846433101253, -789.4196789053547, -987.7684243197841, -438.86208744418377, -601.8353448372565, -785.5092317718627, -1097.893224576639, -923.7516345999588, -513.116572422542, -1046.5206012100732, -1020.8328057930153, -707.6916014324142, -508.93865667299724, -585.2377905999639, -602.8732502128115, -621.085564677536, -807.4221345714965, -733.8959402616267, -504.9023758256783, -535.227544086126, -830.7463345760563, -869.2392853804182, -688.2975757953916, -855.6557076104586, -816.4590930873079, -852.585947072578, -818.8534892446769, -1067.7114821321316, -1009.8088852877822, -930.6718950336667, -871.2061796795947, -888.2774470322815, -1020.9996023005622, -740.0716080267732, -746.3443956394477, -732.832450643513, -720.7381223943072], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 21.105928134908897, "mean_inference_ms": 0.40442656487309486, "mean_action_processing_ms": 0.09639884620298379, "mean_env_wait_ms": 3.936780886773505, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0039064278036861095, "StateBufferConnector_ms": 0.002738984964661679, "ViewRequirementAgentConnector_ms": 0.06771976664914924}}, "episode_reward_max": -438.86208744418377, "episode_reward_min": -1109.3846433101253, "episode_reward_mean": -782.8988322170246, "episode_len_mean": 120.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-726.8807054690234, -910.0246383359593, -959.2389568152724, -838.2211556646348, -545.6956984135606, -949.1260831696337, -770.0494614982084, -866.1901591867485, -767.9635814346034, -660.1648686394927, -819.063436646348, -943.1467361268203, -886.7125040129276, -538.0263443305196, -674.6897017701436, -761.115765714462, -542.3565469218164, -736.9411809930638, -1037.9028207106699, -647.2917554966986, -580.3247649579893, -647.2356260274616, -1109.3846433101253, -789.4196789053547, -987.7684243197841, -438.86208744418377, -601.8353448372565, -785.5092317718627, -1097.893224576639, -923.7516345999588, -513.116572422542, -1046.5206012100732, -1020.8328057930153, -707.6916014324142, -508.93865667299724, -585.2377905999639, -602.8732502128115, -621.085564677536, -807.4221345714965, -733.8959402616267, -504.9023758256783, -535.227544086126, -830.7463345760563, -869.2392853804182, -688.2975757953916, -855.6557076104586, -816.4590930873079, -852.585947072578, -818.8534892446769, -1067.7114821321316, -1009.8088852877822, -930.6718950336667, -871.2061796795947, -888.2774470322815, -1020.9996023005622, -740.0716080267732, -746.3443956394477, -732.832450643513, -720.7381223943072], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 21.105928134908897, "mean_inference_ms": 0.40442656487309486, "mean_action_processing_ms": 0.09639884620298379, "mean_env_wait_ms": 3.936780886773505, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0039064278036861095, "StateBufferConnector_ms": 0.002738984964661679, "ViewRequirementAgentConnector_ms": 0.06771976664914924}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 227640, "num_agent_steps_trained": 227640, "num_env_steps_sampled": 227640, "num_env_steps_trained": 227640, "num_env_steps_sampled_this_iter": 480, "num_env_steps_trained_this_iter": 480, "num_env_steps_sampled_throughput_per_sec": 40.58611020332488, "num_env_steps_trained_throughput_per_sec": 40.58611020332488, "timesteps_total": 227640, "num_steps_trained_this_iter": 480, "agent_timesteps_total": 227640, "timers": {"training_iteration_time_ms": 2917.721, "sample_time_ms": 2914.019, "load_time_ms": 0.218, "load_throughput": 550674.486, "learn_time_ms": 2.75, "learn_throughput": 43629.313, "synch_weights_time_ms": 0.694}, "counters": {"num_env_steps_sampled": 227640, "num_env_steps_trained": 227640, "num_agent_steps_sampled": 227640, "num_agent_steps_trained": 227640}, "done": false, "episodes_total": 1897, "training_iteration": 475, "trial_id": "29a31_00000", "date": "2023-07-26_02-25-48", "timestamp": 1690327548, "time_this_iter_s": 11.829220056533813, "time_total_s": 5796.423443555832, "pid": 90822, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 1, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[253680, 5e-06], [256080, 5e-06], [258480, 2.5e-06], [260880, 2.5e-06], [263280, 2.5e-06], [265680, 2.5e-06], [268080, 1e-06], [270480, 1e-06], [272880, 1e-06], [275280, 5e-07], [277680, 5e-07], [280080, 5e-07], [282480, 5e-07], [284880, 5e-07], [287280, 1e-07], [289680, 1e-07], [292080, 1e-07]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 120, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x16ca65700>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 175.0979676246643, "iterations_since_restore": 15, "perf": {"cpu_util_percent": 35.811764705882354, "ram_util_percent": 77.95882352941177}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-07, "entropy_coeff": 0.05, "policy_entropy": 267.4615478515625, "policy_loss": -84838.390625, "vf_loss": 3065376.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 63.0, "diff_num_grad_updates_vs_sampler_policy": 62.0}}, "num_env_steps_sampled": 228120, "num_env_steps_trained": 228120, "num_agent_steps_sampled": 228120, "num_agent_steps_trained": 228120}, "sampler_results": {"episode_reward_max": -438.86208744418377, "episode_reward_min": -1109.3846433101253, "episode_reward_mean": -777.3753636107713, "episode_len_mean": 120.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-726.8807054690234, -910.0246383359593, -959.2389568152724, -838.2211556646348, -545.6956984135606, -949.1260831696337, -770.0494614982084, -866.1901591867485, -767.9635814346034, -660.1648686394927, -819.063436646348, -943.1467361268203, -886.7125040129276, -538.0263443305196, -674.6897017701436, -761.115765714462, -542.3565469218164, -736.9411809930638, -1037.9028207106699, -647.2917554966986, -580.3247649579893, -647.2356260274616, -1109.3846433101253, -789.4196789053547, -987.7684243197841, -438.86208744418377, -601.8353448372565, -785.5092317718627, -1097.893224576639, -923.7516345999588, -513.116572422542, -1046.5206012100732, -1020.8328057930153, -707.6916014324142, -508.93865667299724, -585.2377905999639, -602.8732502128115, -621.085564677536, -807.4221345714965, -733.8959402616267, -504.9023758256783, -535.227544086126, -830.7463345760563, -869.2392853804182, -688.2975757953916, -855.6557076104586, -816.4590930873079, -852.585947072578, -818.8534892446769, -1067.7114821321316, -1009.8088852877822, -930.6718950336667, -871.2061796795947, -888.2774470322815, -1020.9996023005622, -740.0716080267732, -746.3443956394477, -732.832450643513, -720.7381223943072, -652.5513813574496, -998.0419556137812, -470.3559029456608, -662.6675667572466], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 21.107338613810246, "mean_inference_ms": 0.40418998718948895, "mean_action_processing_ms": 0.09635651756331427, "mean_env_wait_ms": 3.8775734365027876, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0039501795693049355, "StateBufferConnector_ms": 0.002753545367528522, "ViewRequirementAgentConnector_ms": 0.0679258316282242}}, "episode_reward_max": -438.86208744418377, "episode_reward_min": -1109.3846433101253, "episode_reward_mean": -777.3753636107713, "episode_len_mean": 120.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-726.8807054690234, -910.0246383359593, -959.2389568152724, -838.2211556646348, -545.6956984135606, -949.1260831696337, -770.0494614982084, -866.1901591867485, -767.9635814346034, -660.1648686394927, -819.063436646348, -943.1467361268203, -886.7125040129276, -538.0263443305196, -674.6897017701436, -761.115765714462, -542.3565469218164, -736.9411809930638, -1037.9028207106699, -647.2917554966986, -580.3247649579893, -647.2356260274616, -1109.3846433101253, -789.4196789053547, -987.7684243197841, -438.86208744418377, -601.8353448372565, -785.5092317718627, -1097.893224576639, -923.7516345999588, -513.116572422542, -1046.5206012100732, -1020.8328057930153, -707.6916014324142, -508.93865667299724, -585.2377905999639, -602.8732502128115, -621.085564677536, -807.4221345714965, -733.8959402616267, -504.9023758256783, -535.227544086126, -830.7463345760563, -869.2392853804182, -688.2975757953916, -855.6557076104586, -816.4590930873079, -852.585947072578, -818.8534892446769, -1067.7114821321316, -1009.8088852877822, -930.6718950336667, -871.2061796795947, -888.2774470322815, -1020.9996023005622, -740.0716080267732, -746.3443956394477, -732.832450643513, -720.7381223943072, -652.5513813574496, -998.0419556137812, -470.3559029456608, -662.6675667572466], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 21.107338613810246, "mean_inference_ms": 0.40418998718948895, "mean_action_processing_ms": 0.09635651756331427, "mean_env_wait_ms": 3.8775734365027876, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0039501795693049355, "StateBufferConnector_ms": 0.002753545367528522, "ViewRequirementAgentConnector_ms": 0.0679258316282242}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 228120, "num_agent_steps_trained": 228120, "num_env_steps_sampled": 228120, "num_env_steps_trained": 228120, "num_env_steps_sampled_this_iter": 480, "num_env_steps_trained_this_iter": 480, "num_env_steps_sampled_throughput_per_sec": 40.76748163928752, "num_env_steps_trained_throughput_per_sec": 40.76748163928752, "timesteps_total": 228120, "num_steps_trained_this_iter": 480, "agent_timesteps_total": 228120, "timers": {"training_iteration_time_ms": 2943.239, "sample_time_ms": 2939.506, "load_time_ms": 0.219, "load_throughput": 547321.096, "learn_time_ms": 2.763, "learn_throughput": 43434.659, "synch_weights_time_ms": 0.711}, "counters": {"num_env_steps_sampled": 228120, "num_env_steps_trained": 228120, "num_agent_steps_sampled": 228120, "num_agent_steps_trained": 228120}, "done": false, "episodes_total": 1901, "training_iteration": 476, "trial_id": "29a31_00000", "date": "2023-07-26_02-26-00", "timestamp": 1690327560, "time_this_iter_s": 11.776602029800415, "time_total_s": 5808.200045585632, "pid": 90822, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 1, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[253680, 5e-06], [256080, 5e-06], [258480, 2.5e-06], [260880, 2.5e-06], [263280, 2.5e-06], [265680, 2.5e-06], [268080, 1e-06], [270480, 1e-06], [272880, 1e-06], [275280, 5e-07], [277680, 5e-07], [280080, 5e-07], [282480, 5e-07], [284880, 5e-07], [287280, 1e-07], [289680, 1e-07], [292080, 1e-07]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 120, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x16ca65700>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 186.87456965446472, "iterations_since_restore": 16, "perf": {"cpu_util_percent": 37.27058823529413, "ram_util_percent": 78.80000000000001}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-07, "entropy_coeff": 0.05, "policy_entropy": 267.4744873046875, "policy_loss": -140789.4375, "vf_loss": 9897907.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 67.0, "diff_num_grad_updates_vs_sampler_policy": 66.0}}, "num_env_steps_sampled": 228600, "num_env_steps_trained": 228600, "num_agent_steps_sampled": 228600, "num_agent_steps_trained": 228600}, "sampler_results": {"episode_reward_max": -438.86208744418377, "episode_reward_min": -1178.8451275361977, "episode_reward_mean": -772.8259391532906, "episode_len_mean": 120.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-726.8807054690234, -910.0246383359593, -959.2389568152724, -838.2211556646348, -545.6956984135606, -949.1260831696337, -770.0494614982084, -866.1901591867485, -767.9635814346034, -660.1648686394927, -819.063436646348, -943.1467361268203, -886.7125040129276, -538.0263443305196, -674.6897017701436, -761.115765714462, -542.3565469218164, -736.9411809930638, -1037.9028207106699, -647.2917554966986, -580.3247649579893, -647.2356260274616, -1109.3846433101253, -789.4196789053547, -987.7684243197841, -438.86208744418377, -601.8353448372565, -785.5092317718627, -1097.893224576639, -923.7516345999588, -513.116572422542, -1046.5206012100732, -1020.8328057930153, -707.6916014324142, -508.93865667299724, -585.2377905999639, -602.8732502128115, -621.085564677536, -807.4221345714965, -733.8959402616267, -504.9023758256783, -535.227544086126, -830.7463345760563, -869.2392853804182, -688.2975757953916, -855.6557076104586, -816.4590930873079, -852.585947072578, -818.8534892446769, -1067.7114821321316, -1009.8088852877822, -930.6718950336667, -871.2061796795947, -888.2774470322815, -1020.9996023005622, -740.0716080267732, -746.3443956394477, -732.832450643513, -720.7381223943072, -652.5513813574496, -998.0419556137812, -470.3559029456608, -662.6675667572466, -474.8680286616357, -580.8105718120331, -570.1662877820227, -1178.8451275361977], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 21.108674396169913, "mean_inference_ms": 0.40396637996197887, "mean_action_processing_ms": 0.09631664391993855, "mean_env_wait_ms": 3.8241594190730637, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003970914812230352, "StateBufferConnector_ms": 0.0027489306321784633, "ViewRequirementAgentConnector_ms": 0.06796851086972365}}, "episode_reward_max": -438.86208744418377, "episode_reward_min": -1178.8451275361977, "episode_reward_mean": -772.8259391532906, "episode_len_mean": 120.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-726.8807054690234, -910.0246383359593, -959.2389568152724, -838.2211556646348, -545.6956984135606, -949.1260831696337, -770.0494614982084, -866.1901591867485, -767.9635814346034, -660.1648686394927, -819.063436646348, -943.1467361268203, -886.7125040129276, -538.0263443305196, -674.6897017701436, -761.115765714462, -542.3565469218164, -736.9411809930638, -1037.9028207106699, -647.2917554966986, -580.3247649579893, -647.2356260274616, -1109.3846433101253, -789.4196789053547, -987.7684243197841, -438.86208744418377, -601.8353448372565, -785.5092317718627, -1097.893224576639, -923.7516345999588, -513.116572422542, -1046.5206012100732, -1020.8328057930153, -707.6916014324142, -508.93865667299724, -585.2377905999639, -602.8732502128115, -621.085564677536, -807.4221345714965, -733.8959402616267, -504.9023758256783, -535.227544086126, -830.7463345760563, -869.2392853804182, -688.2975757953916, -855.6557076104586, -816.4590930873079, -852.585947072578, -818.8534892446769, -1067.7114821321316, -1009.8088852877822, -930.6718950336667, -871.2061796795947, -888.2774470322815, -1020.9996023005622, -740.0716080267732, -746.3443956394477, -732.832450643513, -720.7381223943072, -652.5513813574496, -998.0419556137812, -470.3559029456608, -662.6675667572466, -474.8680286616357, -580.8105718120331, -570.1662877820227, -1178.8451275361977], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 21.108674396169913, "mean_inference_ms": 0.40396637996197887, "mean_action_processing_ms": 0.09631664391993855, "mean_env_wait_ms": 3.8241594190730637, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003970914812230352, "StateBufferConnector_ms": 0.0027489306321784633, "ViewRequirementAgentConnector_ms": 0.06796851086972365}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 228600, "num_agent_steps_trained": 228600, "num_env_steps_sampled": 228600, "num_env_steps_trained": 228600, "num_env_steps_sampled_this_iter": 480, "num_env_steps_trained_this_iter": 480, "num_env_steps_sampled_throughput_per_sec": 41.029923330235945, "num_env_steps_trained_throughput_per_sec": 41.029923330235945, "timesteps_total": 228600, "num_steps_trained_this_iter": 480, "agent_timesteps_total": 228600, "timers": {"training_iteration_time_ms": 2945.143, "sample_time_ms": 2941.257, "load_time_ms": 0.232, "load_throughput": 518135.145, "learn_time_ms": 2.883, "learn_throughput": 41628.743, "synch_weights_time_ms": 0.725}, "counters": {"num_env_steps_sampled": 228600, "num_env_steps_trained": 228600, "num_agent_steps_sampled": 228600, "num_agent_steps_trained": 228600}, "done": false, "episodes_total": 1905, "training_iteration": 477, "trial_id": "29a31_00000", "date": "2023-07-26_02-26-12", "timestamp": 1690327572, "time_this_iter_s": 11.701306104660034, "time_total_s": 5819.901351690292, "pid": 90822, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 1, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[253680, 5e-06], [256080, 5e-06], [258480, 2.5e-06], [260880, 2.5e-06], [263280, 2.5e-06], [265680, 2.5e-06], [268080, 1e-06], [270480, 1e-06], [272880, 1e-06], [275280, 5e-07], [277680, 5e-07], [280080, 5e-07], [282480, 5e-07], [284880, 5e-07], [287280, 1e-07], [289680, 1e-07], [292080, 1e-07]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 120, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x16ca65700>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 198.57587575912476, "iterations_since_restore": 17, "perf": {"cpu_util_percent": 38.743750000000006, "ram_util_percent": 78.35624999999999}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-07, "entropy_coeff": 0.05, "policy_entropy": 267.48779296875, "policy_loss": -72792.09375, "vf_loss": 2469711.75}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 71.0, "diff_num_grad_updates_vs_sampler_policy": 70.0}}, "num_env_steps_sampled": 229080, "num_env_steps_trained": 229080, "num_agent_steps_sampled": 229080, "num_agent_steps_trained": 229080}, "sampler_results": {"episode_reward_max": -438.86208744418377, "episode_reward_min": -1178.8451275361977, "episode_reward_mean": -766.11158160251, "episode_len_mean": 120.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-726.8807054690234, -910.0246383359593, -959.2389568152724, -838.2211556646348, -545.6956984135606, -949.1260831696337, -770.0494614982084, -866.1901591867485, -767.9635814346034, -660.1648686394927, -819.063436646348, -943.1467361268203, -886.7125040129276, -538.0263443305196, -674.6897017701436, -761.115765714462, -542.3565469218164, -736.9411809930638, -1037.9028207106699, -647.2917554966986, -580.3247649579893, -647.2356260274616, -1109.3846433101253, -789.4196789053547, -987.7684243197841, -438.86208744418377, -601.8353448372565, -785.5092317718627, -1097.893224576639, -923.7516345999588, -513.116572422542, -1046.5206012100732, -1020.8328057930153, -707.6916014324142, -508.93865667299724, -585.2377905999639, -602.8732502128115, -621.085564677536, -807.4221345714965, -733.8959402616267, -504.9023758256783, -535.227544086126, -830.7463345760563, -869.2392853804182, -688.2975757953916, -855.6557076104586, -816.4590930873079, -852.585947072578, -818.8534892446769, -1067.7114821321316, -1009.8088852877822, -930.6718950336667, -871.2061796795947, -888.2774470322815, -1020.9996023005622, -740.0716080267732, -746.3443956394477, -732.832450643513, -720.7381223943072, -652.5513813574496, -998.0419556137812, -470.3559029456608, -662.6675667572466, -474.8680286616357, -580.8105718120331, -570.1662877820227, -1178.8451275361977, -858.7163013056644, -694.8156343944005, -452.7068189820576, -608.3456158256217], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 21.10811314574041, "mean_inference_ms": 0.40374875795219795, "mean_action_processing_ms": 0.09627899840096646, "mean_env_wait_ms": 3.775387073045931, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003934913957622689, "StateBufferConnector_ms": 0.002737784049880337, "ViewRequirementAgentConnector_ms": 0.06781598212013781}}, "episode_reward_max": -438.86208744418377, "episode_reward_min": -1178.8451275361977, "episode_reward_mean": -766.11158160251, "episode_len_mean": 120.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-726.8807054690234, -910.0246383359593, -959.2389568152724, -838.2211556646348, -545.6956984135606, -949.1260831696337, -770.0494614982084, -866.1901591867485, -767.9635814346034, -660.1648686394927, -819.063436646348, -943.1467361268203, -886.7125040129276, -538.0263443305196, -674.6897017701436, -761.115765714462, -542.3565469218164, -736.9411809930638, -1037.9028207106699, -647.2917554966986, -580.3247649579893, -647.2356260274616, -1109.3846433101253, -789.4196789053547, -987.7684243197841, -438.86208744418377, -601.8353448372565, -785.5092317718627, -1097.893224576639, -923.7516345999588, -513.116572422542, -1046.5206012100732, -1020.8328057930153, -707.6916014324142, -508.93865667299724, -585.2377905999639, -602.8732502128115, -621.085564677536, -807.4221345714965, -733.8959402616267, -504.9023758256783, -535.227544086126, -830.7463345760563, -869.2392853804182, -688.2975757953916, -855.6557076104586, -816.4590930873079, -852.585947072578, -818.8534892446769, -1067.7114821321316, -1009.8088852877822, -930.6718950336667, -871.2061796795947, -888.2774470322815, -1020.9996023005622, -740.0716080267732, -746.3443956394477, -732.832450643513, -720.7381223943072, -652.5513813574496, -998.0419556137812, -470.3559029456608, -662.6675667572466, -474.8680286616357, -580.8105718120331, -570.1662877820227, -1178.8451275361977, -858.7163013056644, -694.8156343944005, -452.7068189820576, -608.3456158256217], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 21.10811314574041, "mean_inference_ms": 0.40374875795219795, "mean_action_processing_ms": 0.09627899840096646, "mean_env_wait_ms": 3.775387073045931, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003934913957622689, "StateBufferConnector_ms": 0.002737784049880337, "ViewRequirementAgentConnector_ms": 0.06781598212013781}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 229080, "num_agent_steps_trained": 229080, "num_env_steps_sampled": 229080, "num_env_steps_trained": 229080, "num_env_steps_sampled_this_iter": 480, "num_env_steps_trained_this_iter": 480, "num_env_steps_sampled_throughput_per_sec": 42.20491180579601, "num_env_steps_trained_throughput_per_sec": 42.20491180579601, "timesteps_total": 229080, "num_steps_trained_this_iter": 480, "agent_timesteps_total": 229080, "timers": {"training_iteration_time_ms": 2894.999, "sample_time_ms": 2891.109, "load_time_ms": 0.231, "load_throughput": 519150.572, "learn_time_ms": 2.894, "learn_throughput": 41465.496, "synch_weights_time_ms": 0.718}, "counters": {"num_env_steps_sampled": 229080, "num_env_steps_trained": 229080, "num_agent_steps_sampled": 229080, "num_agent_steps_trained": 229080}, "done": false, "episodes_total": 1909, "training_iteration": 478, "trial_id": "29a31_00000", "date": "2023-07-26_02-26-23", "timestamp": 1690327583, "time_this_iter_s": 11.375660181045532, "time_total_s": 5831.277011871338, "pid": 90822, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 1, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[253680, 5e-06], [256080, 5e-06], [258480, 2.5e-06], [260880, 2.5e-06], [263280, 2.5e-06], [265680, 2.5e-06], [268080, 1e-06], [270480, 1e-06], [272880, 1e-06], [275280, 5e-07], [277680, 5e-07], [280080, 5e-07], [282480, 5e-07], [284880, 5e-07], [287280, 1e-07], [289680, 1e-07], [292080, 1e-07]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 120, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x16ca65700>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 209.9515359401703, "iterations_since_restore": 18, "perf": {"cpu_util_percent": 33.556250000000006, "ram_util_percent": 77.26875}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-07, "entropy_coeff": 0.05, "policy_entropy": 267.4723815917969, "policy_loss": -105834.359375, "vf_loss": 4806971.5}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 75.0, "diff_num_grad_updates_vs_sampler_policy": 74.0}}, "num_env_steps_sampled": 229560, "num_env_steps_trained": 229560, "num_agent_steps_sampled": 229560, "num_agent_steps_trained": 229560}, "sampler_results": {"episode_reward_max": -438.86208744418377, "episode_reward_min": -1178.8451275361977, "episode_reward_mean": -770.8049290137983, "episode_len_mean": 120.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-726.8807054690234, -910.0246383359593, -959.2389568152724, -838.2211556646348, -545.6956984135606, -949.1260831696337, -770.0494614982084, -866.1901591867485, -767.9635814346034, -660.1648686394927, -819.063436646348, -943.1467361268203, -886.7125040129276, -538.0263443305196, -674.6897017701436, -761.115765714462, -542.3565469218164, -736.9411809930638, -1037.9028207106699, -647.2917554966986, -580.3247649579893, -647.2356260274616, -1109.3846433101253, -789.4196789053547, -987.7684243197841, -438.86208744418377, -601.8353448372565, -785.5092317718627, -1097.893224576639, -923.7516345999588, -513.116572422542, -1046.5206012100732, -1020.8328057930153, -707.6916014324142, -508.93865667299724, -585.2377905999639, -602.8732502128115, -621.085564677536, -807.4221345714965, -733.8959402616267, -504.9023758256783, -535.227544086126, -830.7463345760563, -869.2392853804182, -688.2975757953916, -855.6557076104586, -816.4590930873079, -852.585947072578, -818.8534892446769, -1067.7114821321316, -1009.8088852877822, -930.6718950336667, -871.2061796795947, -888.2774470322815, -1020.9996023005622, -740.0716080267732, -746.3443956394477, -732.832450643513, -720.7381223943072, -652.5513813574496, -998.0419556137812, -470.3559029456608, -662.6675667572466, -474.8680286616357, -580.8105718120331, -570.1662877820227, -1178.8451275361977, -858.7163013056644, -694.8156343944005, -452.7068189820576, -608.3456158256217, -750.660993351937, -1045.2173286787524, -833.3557270235104, -787.2133332024458], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 21.106269134615694, "mean_inference_ms": 0.40355608244408403, "mean_action_processing_ms": 0.09624570075944183, "mean_env_wait_ms": 3.730910255611017, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0039221445719401045, "StateBufferConnector_ms": 0.0027271906534830728, "ViewRequirementAgentConnector_ms": 0.06776682535807292}}, "episode_reward_max": -438.86208744418377, "episode_reward_min": -1178.8451275361977, "episode_reward_mean": -770.8049290137983, "episode_len_mean": 120.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-726.8807054690234, -910.0246383359593, -959.2389568152724, -838.2211556646348, -545.6956984135606, -949.1260831696337, -770.0494614982084, -866.1901591867485, -767.9635814346034, -660.1648686394927, -819.063436646348, -943.1467361268203, -886.7125040129276, -538.0263443305196, -674.6897017701436, -761.115765714462, -542.3565469218164, -736.9411809930638, -1037.9028207106699, -647.2917554966986, -580.3247649579893, -647.2356260274616, -1109.3846433101253, -789.4196789053547, -987.7684243197841, -438.86208744418377, -601.8353448372565, -785.5092317718627, -1097.893224576639, -923.7516345999588, -513.116572422542, -1046.5206012100732, -1020.8328057930153, -707.6916014324142, -508.93865667299724, -585.2377905999639, -602.8732502128115, -621.085564677536, -807.4221345714965, -733.8959402616267, -504.9023758256783, -535.227544086126, -830.7463345760563, -869.2392853804182, -688.2975757953916, -855.6557076104586, -816.4590930873079, -852.585947072578, -818.8534892446769, -1067.7114821321316, -1009.8088852877822, -930.6718950336667, -871.2061796795947, -888.2774470322815, -1020.9996023005622, -740.0716080267732, -746.3443956394477, -732.832450643513, -720.7381223943072, -652.5513813574496, -998.0419556137812, -470.3559029456608, -662.6675667572466, -474.8680286616357, -580.8105718120331, -570.1662877820227, -1178.8451275361977, -858.7163013056644, -694.8156343944005, -452.7068189820576, -608.3456158256217, -750.660993351937, -1045.2173286787524, -833.3557270235104, -787.2133332024458], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 21.106269134615694, "mean_inference_ms": 0.40355608244408403, "mean_action_processing_ms": 0.09624570075944183, "mean_env_wait_ms": 3.730910255611017, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0039221445719401045, "StateBufferConnector_ms": 0.0027271906534830728, "ViewRequirementAgentConnector_ms": 0.06776682535807292}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 229560, "num_agent_steps_trained": 229560, "num_env_steps_sampled": 229560, "num_env_steps_trained": 229560, "num_env_steps_sampled_this_iter": 480, "num_env_steps_trained_this_iter": 480, "num_env_steps_sampled_throughput_per_sec": 41.94896266916685, "num_env_steps_trained_throughput_per_sec": 41.94896266916685, "timesteps_total": 229560, "num_steps_trained_this_iter": 480, "agent_timesteps_total": 229560, "timers": {"training_iteration_time_ms": 2859.57, "sample_time_ms": 2855.797, "load_time_ms": 0.22, "load_throughput": 545718.833, "learn_time_ms": 2.804, "learn_throughput": 42797.565, "synch_weights_time_ms": 0.709}, "counters": {"num_env_steps_sampled": 229560, "num_env_steps_trained": 229560, "num_agent_steps_sampled": 229560, "num_agent_steps_trained": 229560}, "done": false, "episodes_total": 1913, "training_iteration": 479, "trial_id": "29a31_00000", "date": "2023-07-26_02-26-35", "timestamp": 1690327595, "time_this_iter_s": 11.44501805305481, "time_total_s": 5842.722029924393, "pid": 90822, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 1, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[253680, 5e-06], [256080, 5e-06], [258480, 2.5e-06], [260880, 2.5e-06], [263280, 2.5e-06], [265680, 2.5e-06], [268080, 1e-06], [270480, 1e-06], [272880, 1e-06], [275280, 5e-07], [277680, 5e-07], [280080, 5e-07], [282480, 5e-07], [284880, 5e-07], [287280, 1e-07], [289680, 1e-07], [292080, 1e-07]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 120, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x16ca65700>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 221.3965539932251, "iterations_since_restore": 19, "perf": {"cpu_util_percent": 33.911764705882355, "ram_util_percent": 77.44117647058823}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-07, "entropy_coeff": 0.05, "policy_entropy": 267.4490661621094, "policy_loss": -92128.71875, "vf_loss": 4222808.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 79.0, "diff_num_grad_updates_vs_sampler_policy": 78.0}}, "num_env_steps_sampled": 230040, "num_env_steps_trained": 230040, "num_agent_steps_sampled": 230040, "num_agent_steps_trained": 230040}, "sampler_results": {"episode_reward_max": -438.86208744418377, "episode_reward_min": -1178.8451275361977, "episode_reward_mean": -766.7737385793124, "episode_len_mean": 120.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-726.8807054690234, -910.0246383359593, -959.2389568152724, -838.2211556646348, -545.6956984135606, -949.1260831696337, -770.0494614982084, -866.1901591867485, -767.9635814346034, -660.1648686394927, -819.063436646348, -943.1467361268203, -886.7125040129276, -538.0263443305196, -674.6897017701436, -761.115765714462, -542.3565469218164, -736.9411809930638, -1037.9028207106699, -647.2917554966986, -580.3247649579893, -647.2356260274616, -1109.3846433101253, -789.4196789053547, -987.7684243197841, -438.86208744418377, -601.8353448372565, -785.5092317718627, -1097.893224576639, -923.7516345999588, -513.116572422542, -1046.5206012100732, -1020.8328057930153, -707.6916014324142, -508.93865667299724, -585.2377905999639, -602.8732502128115, -621.085564677536, -807.4221345714965, -733.8959402616267, -504.9023758256783, -535.227544086126, -830.7463345760563, -869.2392853804182, -688.2975757953916, -855.6557076104586, -816.4590930873079, -852.585947072578, -818.8534892446769, -1067.7114821321316, -1009.8088852877822, -930.6718950336667, -871.2061796795947, -888.2774470322815, -1020.9996023005622, -740.0716080267732, -746.3443956394477, -732.832450643513, -720.7381223943072, -652.5513813574496, -998.0419556137812, -470.3559029456608, -662.6675667572466, -474.8680286616357, -580.8105718120331, -570.1662877820227, -1178.8451275361977, -858.7163013056644, -694.8156343944005, -452.7068189820576, -608.3456158256217, -750.660993351937, -1045.2173286787524, -833.3557270235104, -787.2133332024458, -808.0492994819223, -539.7716950499627, -750.3821065654046, -666.5525706335234], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 21.10478033374586, "mean_inference_ms": 0.40337834562921754, "mean_action_processing_ms": 0.09621465037827792, "mean_env_wait_ms": 3.6901552662958035, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003919118567358089, "StateBufferConnector_ms": 0.002738192111630983, "ViewRequirementAgentConnector_ms": 0.06790644005884099}}, "episode_reward_max": -438.86208744418377, "episode_reward_min": -1178.8451275361977, "episode_reward_mean": -766.7737385793124, "episode_len_mean": 120.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-726.8807054690234, -910.0246383359593, -959.2389568152724, -838.2211556646348, -545.6956984135606, -949.1260831696337, -770.0494614982084, -866.1901591867485, -767.9635814346034, -660.1648686394927, -819.063436646348, -943.1467361268203, -886.7125040129276, -538.0263443305196, -674.6897017701436, -761.115765714462, -542.3565469218164, -736.9411809930638, -1037.9028207106699, -647.2917554966986, -580.3247649579893, -647.2356260274616, -1109.3846433101253, -789.4196789053547, -987.7684243197841, -438.86208744418377, -601.8353448372565, -785.5092317718627, -1097.893224576639, -923.7516345999588, -513.116572422542, -1046.5206012100732, -1020.8328057930153, -707.6916014324142, -508.93865667299724, -585.2377905999639, -602.8732502128115, -621.085564677536, -807.4221345714965, -733.8959402616267, -504.9023758256783, -535.227544086126, -830.7463345760563, -869.2392853804182, -688.2975757953916, -855.6557076104586, -816.4590930873079, -852.585947072578, -818.8534892446769, -1067.7114821321316, -1009.8088852877822, -930.6718950336667, -871.2061796795947, -888.2774470322815, -1020.9996023005622, -740.0716080267732, -746.3443956394477, -732.832450643513, -720.7381223943072, -652.5513813574496, -998.0419556137812, -470.3559029456608, -662.6675667572466, -474.8680286616357, -580.8105718120331, -570.1662877820227, -1178.8451275361977, -858.7163013056644, -694.8156343944005, -452.7068189820576, -608.3456158256217, -750.660993351937, -1045.2173286787524, -833.3557270235104, -787.2133332024458, -808.0492994819223, -539.7716950499627, -750.3821065654046, -666.5525706335234], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 21.10478033374586, "mean_inference_ms": 0.40337834562921754, "mean_action_processing_ms": 0.09621465037827792, "mean_env_wait_ms": 3.6901552662958035, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003919118567358089, "StateBufferConnector_ms": 0.002738192111630983, "ViewRequirementAgentConnector_ms": 0.06790644005884099}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 230040, "num_agent_steps_trained": 230040, "num_env_steps_sampled": 230040, "num_env_steps_trained": 230040, "num_env_steps_sampled_this_iter": 480, "num_env_steps_trained_this_iter": 480, "num_env_steps_sampled_throughput_per_sec": 41.07836187745962, "num_env_steps_trained_throughput_per_sec": 41.07836187745962, "timesteps_total": 230040, "num_steps_trained_this_iter": 480, "agent_timesteps_total": 230040, "timers": {"training_iteration_time_ms": 2876.684, "sample_time_ms": 2872.926, "load_time_ms": 0.218, "load_throughput": 551338.022, "learn_time_ms": 2.796, "learn_throughput": 42914.7, "synch_weights_time_ms": 0.705}, "counters": {"num_env_steps_sampled": 230040, "num_env_steps_trained": 230040, "num_agent_steps_sampled": 230040, "num_agent_steps_trained": 230040}, "done": false, "episodes_total": 1917, "training_iteration": 480, "trial_id": "29a31_00000", "date": "2023-07-26_02-26-46", "timestamp": 1690327606, "time_this_iter_s": 11.687712907791138, "time_total_s": 5854.409742832184, "pid": 90822, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 1, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[253680, 5e-06], [256080, 5e-06], [258480, 2.5e-06], [260880, 2.5e-06], [263280, 2.5e-06], [265680, 2.5e-06], [268080, 1e-06], [270480, 1e-06], [272880, 1e-06], [275280, 5e-07], [277680, 5e-07], [280080, 5e-07], [282480, 5e-07], [284880, 5e-07], [287280, 1e-07], [289680, 1e-07], [292080, 1e-07]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 120, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x16ca65700>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 233.08426690101624, "iterations_since_restore": 20, "perf": {"cpu_util_percent": 36.55625, "ram_util_percent": 77.48125}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-07, "entropy_coeff": 0.05, "policy_entropy": 267.48797607421875, "policy_loss": -158134.78125, "vf_loss": 10901464.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 83.0, "diff_num_grad_updates_vs_sampler_policy": 82.0}}, "num_env_steps_sampled": 230520, "num_env_steps_trained": 230520, "num_agent_steps_sampled": 230520, "num_agent_steps_trained": 230520}, "sampler_results": {"episode_reward_max": -438.86208744418377, "episode_reward_min": -1187.195266104132, "episode_reward_mean": -775.3564822521923, "episode_len_mean": 120.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-726.8807054690234, -910.0246383359593, -959.2389568152724, -838.2211556646348, -545.6956984135606, -949.1260831696337, -770.0494614982084, -866.1901591867485, -767.9635814346034, -660.1648686394927, -819.063436646348, -943.1467361268203, -886.7125040129276, -538.0263443305196, -674.6897017701436, -761.115765714462, -542.3565469218164, -736.9411809930638, -1037.9028207106699, -647.2917554966986, -580.3247649579893, -647.2356260274616, -1109.3846433101253, -789.4196789053547, -987.7684243197841, -438.86208744418377, -601.8353448372565, -785.5092317718627, -1097.893224576639, -923.7516345999588, -513.116572422542, -1046.5206012100732, -1020.8328057930153, -707.6916014324142, -508.93865667299724, -585.2377905999639, -602.8732502128115, -621.085564677536, -807.4221345714965, -733.8959402616267, -504.9023758256783, -535.227544086126, -830.7463345760563, -869.2392853804182, -688.2975757953916, -855.6557076104586, -816.4590930873079, -852.585947072578, -818.8534892446769, -1067.7114821321316, -1009.8088852877822, -930.6718950336667, -871.2061796795947, -888.2774470322815, -1020.9996023005622, -740.0716080267732, -746.3443956394477, -732.832450643513, -720.7381223943072, -652.5513813574496, -998.0419556137812, -470.3559029456608, -662.6675667572466, -474.8680286616357, -580.8105718120331, -570.1662877820227, -1178.8451275361977, -858.7163013056644, -694.8156343944005, -452.7068189820576, -608.3456158256217, -750.660993351937, -1045.2173286787524, -833.3557270235104, -787.2133332024458, -808.0492994819223, -539.7716950499627, -750.3821065654046, -666.5525706335234, -795.5260674886666, -1187.195266104132, -646.8361095209852, -1149.905236052508], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 21.104267874645153, "mean_inference_ms": 0.4031963131210119, "mean_action_processing_ms": 0.09618239109331697, "mean_env_wait_ms": 3.652988760097615, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0039761324962937685, "StateBufferConnector_ms": 0.0027329088693641753, "ViewRequirementAgentConnector_ms": 0.06772409002464938}}, "episode_reward_max": -438.86208744418377, "episode_reward_min": -1187.195266104132, "episode_reward_mean": -775.3564822521923, "episode_len_mean": 120.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-726.8807054690234, -910.0246383359593, -959.2389568152724, -838.2211556646348, -545.6956984135606, -949.1260831696337, -770.0494614982084, -866.1901591867485, -767.9635814346034, -660.1648686394927, -819.063436646348, -943.1467361268203, -886.7125040129276, -538.0263443305196, -674.6897017701436, -761.115765714462, -542.3565469218164, -736.9411809930638, -1037.9028207106699, -647.2917554966986, -580.3247649579893, -647.2356260274616, -1109.3846433101253, -789.4196789053547, -987.7684243197841, -438.86208744418377, -601.8353448372565, -785.5092317718627, -1097.893224576639, -923.7516345999588, -513.116572422542, -1046.5206012100732, -1020.8328057930153, -707.6916014324142, -508.93865667299724, -585.2377905999639, -602.8732502128115, -621.085564677536, -807.4221345714965, -733.8959402616267, -504.9023758256783, -535.227544086126, -830.7463345760563, -869.2392853804182, -688.2975757953916, -855.6557076104586, -816.4590930873079, -852.585947072578, -818.8534892446769, -1067.7114821321316, -1009.8088852877822, -930.6718950336667, -871.2061796795947, -888.2774470322815, -1020.9996023005622, -740.0716080267732, -746.3443956394477, -732.832450643513, -720.7381223943072, -652.5513813574496, -998.0419556137812, -470.3559029456608, -662.6675667572466, -474.8680286616357, -580.8105718120331, -570.1662877820227, -1178.8451275361977, -858.7163013056644, -694.8156343944005, -452.7068189820576, -608.3456158256217, -750.660993351937, -1045.2173286787524, -833.3557270235104, -787.2133332024458, -808.0492994819223, -539.7716950499627, -750.3821065654046, -666.5525706335234, -795.5260674886666, -1187.195266104132, -646.8361095209852, -1149.905236052508], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 21.104267874645153, "mean_inference_ms": 0.4031963131210119, "mean_action_processing_ms": 0.09618239109331697, "mean_env_wait_ms": 3.652988760097615, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0039761324962937685, "StateBufferConnector_ms": 0.0027329088693641753, "ViewRequirementAgentConnector_ms": 0.06772409002464938}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 230520, "num_agent_steps_trained": 230520, "num_env_steps_sampled": 230520, "num_env_steps_trained": 230520, "num_env_steps_sampled_this_iter": 480, "num_env_steps_trained_this_iter": 480, "num_env_steps_sampled_throughput_per_sec": 40.3643418179214, "num_env_steps_trained_throughput_per_sec": 40.3643418179214, "timesteps_total": 230520, "num_steps_trained_this_iter": 480, "agent_timesteps_total": 230520, "timers": {"training_iteration_time_ms": 2924.373, "sample_time_ms": 2920.642, "load_time_ms": 0.219, "load_throughput": 549112.459, "learn_time_ms": 2.771, "learn_throughput": 43299.394, "synch_weights_time_ms": 0.701}, "counters": {"num_env_steps_sampled": 230520, "num_env_steps_trained": 230520, "num_agent_steps_sampled": 230520, "num_agent_steps_trained": 230520}, "done": false, "episodes_total": 1921, "training_iteration": 481, "trial_id": "29a31_00000", "date": "2023-07-26_02-26-58", "timestamp": 1690327618, "time_this_iter_s": 11.894273042678833, "time_total_s": 5866.304015874863, "pid": 90822, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 1, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[253680, 5e-06], [256080, 5e-06], [258480, 2.5e-06], [260880, 2.5e-06], [263280, 2.5e-06], [265680, 2.5e-06], [268080, 1e-06], [270480, 1e-06], [272880, 1e-06], [275280, 5e-07], [277680, 5e-07], [280080, 5e-07], [282480, 5e-07], [284880, 5e-07], [287280, 1e-07], [289680, 1e-07], [292080, 1e-07]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 120, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x16ca65700>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 244.97853994369507, "iterations_since_restore": 21, "perf": {"cpu_util_percent": 37.417647058823526, "ram_util_percent": 77.78823529411765}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-07, "entropy_coeff": 0.05, "policy_entropy": 267.4573974609375, "policy_loss": -75966.7890625, "vf_loss": 2809953.5}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 87.0, "diff_num_grad_updates_vs_sampler_policy": 86.0}}, "num_env_steps_sampled": 231000, "num_env_steps_trained": 231000, "num_agent_steps_sampled": 231000, "num_agent_steps_trained": 231000}, "sampler_results": {"episode_reward_max": -438.86208744418377, "episode_reward_min": -1187.195266104132, "episode_reward_mean": -771.9472414915238, "episode_len_mean": 120.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-726.8807054690234, -910.0246383359593, -959.2389568152724, -838.2211556646348, -545.6956984135606, -949.1260831696337, -770.0494614982084, -866.1901591867485, -767.9635814346034, -660.1648686394927, -819.063436646348, -943.1467361268203, -886.7125040129276, -538.0263443305196, -674.6897017701436, -761.115765714462, -542.3565469218164, -736.9411809930638, -1037.9028207106699, -647.2917554966986, -580.3247649579893, -647.2356260274616, -1109.3846433101253, -789.4196789053547, -987.7684243197841, -438.86208744418377, -601.8353448372565, -785.5092317718627, -1097.893224576639, -923.7516345999588, -513.116572422542, -1046.5206012100732, -1020.8328057930153, -707.6916014324142, -508.93865667299724, -585.2377905999639, -602.8732502128115, -621.085564677536, -807.4221345714965, -733.8959402616267, -504.9023758256783, -535.227544086126, -830.7463345760563, -869.2392853804182, -688.2975757953916, -855.6557076104586, -816.4590930873079, -852.585947072578, -818.8534892446769, -1067.7114821321316, -1009.8088852877822, -930.6718950336667, -871.2061796795947, -888.2774470322815, -1020.9996023005622, -740.0716080267732, -746.3443956394477, -732.832450643513, -720.7381223943072, -652.5513813574496, -998.0419556137812, -470.3559029456608, -662.6675667572466, -474.8680286616357, -580.8105718120331, -570.1662877820227, -1178.8451275361977, -858.7163013056644, -694.8156343944005, -452.7068189820576, -608.3456158256217, -750.660993351937, -1045.2173286787524, -833.3557270235104, -787.2133332024458, -808.0492994819223, -539.7716950499627, -750.3821065654046, -666.5525706335234, -795.5260674886666, -1187.195266104132, -646.8361095209852, -1149.905236052508, -801.2423149206337, -684.6117348729066, -792.8103939927032, -526.157539044346], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 21.103630922178368, "mean_inference_ms": 0.40304215484746053, "mean_action_processing_ms": 0.09615532178234036, "mean_env_wait_ms": 3.618709167161929, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003985700936153017, "StateBufferConnector_ms": 0.0027292076198534034, "ViewRequirementAgentConnector_ms": 0.06762208609745421}}, "episode_reward_max": -438.86208744418377, "episode_reward_min": -1187.195266104132, "episode_reward_mean": -771.9472414915238, "episode_len_mean": 120.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-726.8807054690234, -910.0246383359593, -959.2389568152724, -838.2211556646348, -545.6956984135606, -949.1260831696337, -770.0494614982084, -866.1901591867485, -767.9635814346034, -660.1648686394927, -819.063436646348, -943.1467361268203, -886.7125040129276, -538.0263443305196, -674.6897017701436, -761.115765714462, -542.3565469218164, -736.9411809930638, -1037.9028207106699, -647.2917554966986, -580.3247649579893, -647.2356260274616, -1109.3846433101253, -789.4196789053547, -987.7684243197841, -438.86208744418377, -601.8353448372565, -785.5092317718627, -1097.893224576639, -923.7516345999588, -513.116572422542, -1046.5206012100732, -1020.8328057930153, -707.6916014324142, -508.93865667299724, -585.2377905999639, -602.8732502128115, -621.085564677536, -807.4221345714965, -733.8959402616267, -504.9023758256783, -535.227544086126, -830.7463345760563, -869.2392853804182, -688.2975757953916, -855.6557076104586, -816.4590930873079, -852.585947072578, -818.8534892446769, -1067.7114821321316, -1009.8088852877822, -930.6718950336667, -871.2061796795947, -888.2774470322815, -1020.9996023005622, -740.0716080267732, -746.3443956394477, -732.832450643513, -720.7381223943072, -652.5513813574496, -998.0419556137812, -470.3559029456608, -662.6675667572466, -474.8680286616357, -580.8105718120331, -570.1662877820227, -1178.8451275361977, -858.7163013056644, -694.8156343944005, -452.7068189820576, -608.3456158256217, -750.660993351937, -1045.2173286787524, -833.3557270235104, -787.2133332024458, -808.0492994819223, -539.7716950499627, -750.3821065654046, -666.5525706335234, -795.5260674886666, -1187.195266104132, -646.8361095209852, -1149.905236052508, -801.2423149206337, -684.6117348729066, -792.8103939927032, -526.157539044346], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 21.103630922178368, "mean_inference_ms": 0.40304215484746053, "mean_action_processing_ms": 0.09615532178234036, "mean_env_wait_ms": 3.618709167161929, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003985700936153017, "StateBufferConnector_ms": 0.0027292076198534034, "ViewRequirementAgentConnector_ms": 0.06762208609745421}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 231000, "num_agent_steps_trained": 231000, "num_env_steps_sampled": 231000, "num_env_steps_trained": 231000, "num_env_steps_sampled_this_iter": 480, "num_env_steps_trained_this_iter": 480, "num_env_steps_sampled_throughput_per_sec": 41.220766297864955, "num_env_steps_trained_throughput_per_sec": 41.220766297864955, "timesteps_total": 231000, "num_steps_trained_this_iter": 480, "agent_timesteps_total": 231000, "timers": {"training_iteration_time_ms": 2950.881, "sample_time_ms": 2947.1, "load_time_ms": 0.222, "load_throughput": 540445.055, "learn_time_ms": 2.819, "learn_throughput": 42571.322, "synch_weights_time_ms": 0.7}, "counters": {"num_env_steps_sampled": 231000, "num_env_steps_trained": 231000, "num_agent_steps_sampled": 231000, "num_agent_steps_trained": 231000}, "done": false, "episodes_total": 1925, "training_iteration": 482, "trial_id": "29a31_00000", "date": "2023-07-26_02-27-10", "timestamp": 1690327630, "time_this_iter_s": 11.647550106048584, "time_total_s": 5877.951565980911, "pid": 90822, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 1, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[253680, 5e-06], [256080, 5e-06], [258480, 2.5e-06], [260880, 2.5e-06], [263280, 2.5e-06], [265680, 2.5e-06], [268080, 1e-06], [270480, 1e-06], [272880, 1e-06], [275280, 5e-07], [277680, 5e-07], [280080, 5e-07], [282480, 5e-07], [284880, 5e-07], [287280, 1e-07], [289680, 1e-07], [292080, 1e-07]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 120, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x16ca65700>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 256.62609004974365, "iterations_since_restore": 22, "perf": {"cpu_util_percent": 38.22352941176471, "ram_util_percent": 79.41176470588235}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-07, "entropy_coeff": 0.05, "policy_entropy": 267.4617004394531, "policy_loss": -96055.453125, "vf_loss": 4041999.5}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 91.0, "diff_num_grad_updates_vs_sampler_policy": 90.0}}, "num_env_steps_sampled": 231480, "num_env_steps_trained": 231480, "num_agent_steps_sampled": 231480, "num_agent_steps_trained": 231480}, "sampler_results": {"episode_reward_max": -438.86208744418377, "episode_reward_min": -1187.195266104132, "episode_reward_mean": -771.0593029713283, "episode_len_mean": 120.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-726.8807054690234, -910.0246383359593, -959.2389568152724, -838.2211556646348, -545.6956984135606, -949.1260831696337, -770.0494614982084, -866.1901591867485, -767.9635814346034, -660.1648686394927, -819.063436646348, -943.1467361268203, -886.7125040129276, -538.0263443305196, -674.6897017701436, -761.115765714462, -542.3565469218164, -736.9411809930638, -1037.9028207106699, -647.2917554966986, -580.3247649579893, -647.2356260274616, -1109.3846433101253, -789.4196789053547, -987.7684243197841, -438.86208744418377, -601.8353448372565, -785.5092317718627, -1097.893224576639, -923.7516345999588, -513.116572422542, -1046.5206012100732, -1020.8328057930153, -707.6916014324142, -508.93865667299724, -585.2377905999639, -602.8732502128115, -621.085564677536, -807.4221345714965, -733.8959402616267, -504.9023758256783, -535.227544086126, -830.7463345760563, -869.2392853804182, -688.2975757953916, -855.6557076104586, -816.4590930873079, -852.585947072578, -818.8534892446769, -1067.7114821321316, -1009.8088852877822, -930.6718950336667, -871.2061796795947, -888.2774470322815, -1020.9996023005622, -740.0716080267732, -746.3443956394477, -732.832450643513, -720.7381223943072, -652.5513813574496, -998.0419556137812, -470.3559029456608, -662.6675667572466, -474.8680286616357, -580.8105718120331, -570.1662877820227, -1178.8451275361977, -858.7163013056644, -694.8156343944005, -452.7068189820576, -608.3456158256217, -750.660993351937, -1045.2173286787524, -833.3557270235104, -787.2133332024458, -808.0492994819223, -539.7716950499627, -750.3821065654046, -666.5525706335234, -795.5260674886666, -1187.195266104132, -646.8361095209852, -1149.905236052508, -801.2423149206337, -684.6117348729066, -792.8103939927032, -526.157539044346, -689.7443666324847, -770.2809562845098, -932.3016437312655, -614.6595939800584], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 21.10251180470105, "mean_inference_ms": 0.4029220865645741, "mean_action_processing_ms": 0.0961343455064147, "mean_env_wait_ms": 3.586901472988563, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00398211426787324, "StateBufferConnector_ms": 0.0027365736908965058, "ViewRequirementAgentConnector_ms": 0.06791051927503648}}, "episode_reward_max": -438.86208744418377, "episode_reward_min": -1187.195266104132, "episode_reward_mean": -771.0593029713283, "episode_len_mean": 120.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-726.8807054690234, -910.0246383359593, -959.2389568152724, -838.2211556646348, -545.6956984135606, -949.1260831696337, -770.0494614982084, -866.1901591867485, -767.9635814346034, -660.1648686394927, -819.063436646348, -943.1467361268203, -886.7125040129276, -538.0263443305196, -674.6897017701436, -761.115765714462, -542.3565469218164, -736.9411809930638, -1037.9028207106699, -647.2917554966986, -580.3247649579893, -647.2356260274616, -1109.3846433101253, -789.4196789053547, -987.7684243197841, -438.86208744418377, -601.8353448372565, -785.5092317718627, -1097.893224576639, -923.7516345999588, -513.116572422542, -1046.5206012100732, -1020.8328057930153, -707.6916014324142, -508.93865667299724, -585.2377905999639, -602.8732502128115, -621.085564677536, -807.4221345714965, -733.8959402616267, -504.9023758256783, -535.227544086126, -830.7463345760563, -869.2392853804182, -688.2975757953916, -855.6557076104586, -816.4590930873079, -852.585947072578, -818.8534892446769, -1067.7114821321316, -1009.8088852877822, -930.6718950336667, -871.2061796795947, -888.2774470322815, -1020.9996023005622, -740.0716080267732, -746.3443956394477, -732.832450643513, -720.7381223943072, -652.5513813574496, -998.0419556137812, -470.3559029456608, -662.6675667572466, -474.8680286616357, -580.8105718120331, -570.1662877820227, -1178.8451275361977, -858.7163013056644, -694.8156343944005, -452.7068189820576, -608.3456158256217, -750.660993351937, -1045.2173286787524, -833.3557270235104, -787.2133332024458, -808.0492994819223, -539.7716950499627, -750.3821065654046, -666.5525706335234, -795.5260674886666, -1187.195266104132, -646.8361095209852, -1149.905236052508, -801.2423149206337, -684.6117348729066, -792.8103939927032, -526.157539044346, -689.7443666324847, -770.2809562845098, -932.3016437312655, -614.6595939800584], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 21.10251180470105, "mean_inference_ms": 0.4029220865645741, "mean_action_processing_ms": 0.0961343455064147, "mean_env_wait_ms": 3.586901472988563, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00398211426787324, "StateBufferConnector_ms": 0.0027365736908965058, "ViewRequirementAgentConnector_ms": 0.06791051927503648}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 231480, "num_agent_steps_trained": 231480, "num_env_steps_sampled": 231480, "num_env_steps_trained": 231480, "num_env_steps_sampled_this_iter": 480, "num_env_steps_trained_this_iter": 480, "num_env_steps_sampled_throughput_per_sec": 41.6246229080885, "num_env_steps_trained_throughput_per_sec": 41.6246229080885, "timesteps_total": 231480, "num_steps_trained_this_iter": 480, "agent_timesteps_total": 231480, "timers": {"training_iteration_time_ms": 2930.573, "sample_time_ms": 2926.745, "load_time_ms": 0.225, "load_throughput": 532441.003, "learn_time_ms": 2.857, "learn_throughput": 42002.544, "synch_weights_time_ms": 0.705}, "counters": {"num_env_steps_sampled": 231480, "num_env_steps_trained": 231480, "num_agent_steps_sampled": 231480, "num_agent_steps_trained": 231480}, "done": false, "episodes_total": 1929, "training_iteration": 483, "trial_id": "29a31_00000", "date": "2023-07-26_02-27-21", "timestamp": 1690327641, "time_this_iter_s": 11.534332990646362, "time_total_s": 5889.485898971558, "pid": 90822, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 1, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[253680, 5e-06], [256080, 5e-06], [258480, 2.5e-06], [260880, 2.5e-06], [263280, 2.5e-06], [265680, 2.5e-06], [268080, 1e-06], [270480, 1e-06], [272880, 1e-06], [275280, 5e-07], [277680, 5e-07], [280080, 5e-07], [282480, 5e-07], [284880, 5e-07], [287280, 1e-07], [289680, 1e-07], [292080, 1e-07]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 120, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x16ca65700>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 268.16042304039, "iterations_since_restore": 23, "perf": {"cpu_util_percent": 34.48125, "ram_util_percent": 75.59375}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-07, "entropy_coeff": 0.05, "policy_entropy": 267.4371337890625, "policy_loss": -150023.875, "vf_loss": 10114569.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 95.0, "diff_num_grad_updates_vs_sampler_policy": 94.0}}, "num_env_steps_sampled": 231960, "num_env_steps_trained": 231960, "num_agent_steps_sampled": 231960, "num_agent_steps_trained": 231960}, "sampler_results": {"episode_reward_max": -401.0565983900857, "episode_reward_min": -1187.195266104132, "episode_reward_mean": -768.6952174175074, "episode_len_mean": 120.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-726.8807054690234, -910.0246383359593, -959.2389568152724, -838.2211556646348, -545.6956984135606, -949.1260831696337, -770.0494614982084, -866.1901591867485, -767.9635814346034, -660.1648686394927, -819.063436646348, -943.1467361268203, -886.7125040129276, -538.0263443305196, -674.6897017701436, -761.115765714462, -542.3565469218164, -736.9411809930638, -1037.9028207106699, -647.2917554966986, -580.3247649579893, -647.2356260274616, -1109.3846433101253, -789.4196789053547, -987.7684243197841, -438.86208744418377, -601.8353448372565, -785.5092317718627, -1097.893224576639, -923.7516345999588, -513.116572422542, -1046.5206012100732, -1020.8328057930153, -707.6916014324142, -508.93865667299724, -585.2377905999639, -602.8732502128115, -621.085564677536, -807.4221345714965, -733.8959402616267, -504.9023758256783, -535.227544086126, -830.7463345760563, -869.2392853804182, -688.2975757953916, -855.6557076104586, -816.4590930873079, -852.585947072578, -818.8534892446769, -1067.7114821321316, -1009.8088852877822, -930.6718950336667, -871.2061796795947, -888.2774470322815, -1020.9996023005622, -740.0716080267732, -746.3443956394477, -732.832450643513, -720.7381223943072, -652.5513813574496, -998.0419556137812, -470.3559029456608, -662.6675667572466, -474.8680286616357, -580.8105718120331, -570.1662877820227, -1178.8451275361977, -858.7163013056644, -694.8156343944005, -452.7068189820576, -608.3456158256217, -750.660993351937, -1045.2173286787524, -833.3557270235104, -787.2133332024458, -808.0492994819223, -539.7716950499627, -750.3821065654046, -666.5525706335234, -795.5260674886666, -1187.195266104132, -646.8361095209852, -1149.905236052508, -801.2423149206337, -684.6117348729066, -792.8103939927032, -526.157539044346, -689.7443666324847, -770.2809562845098, -932.3016437312655, -614.6595939800584, -536.4521534334979, -401.0565983900857, -735.497953612034, -1186.642378836706], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 21.101354521064497, "mean_inference_ms": 0.4028392377809781, "mean_action_processing_ms": 0.09611790971221386, "mean_env_wait_ms": 3.5572340198110672, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0039524781076531665, "StateBufferConnector_ms": 0.0027398059242650084, "ViewRequirementAgentConnector_ms": 0.06782105094508122}}, "episode_reward_max": -401.0565983900857, "episode_reward_min": -1187.195266104132, "episode_reward_mean": -768.6952174175074, "episode_len_mean": 120.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-726.8807054690234, -910.0246383359593, -959.2389568152724, -838.2211556646348, -545.6956984135606, -949.1260831696337, -770.0494614982084, -866.1901591867485, -767.9635814346034, -660.1648686394927, -819.063436646348, -943.1467361268203, -886.7125040129276, -538.0263443305196, -674.6897017701436, -761.115765714462, -542.3565469218164, -736.9411809930638, -1037.9028207106699, -647.2917554966986, -580.3247649579893, -647.2356260274616, -1109.3846433101253, -789.4196789053547, -987.7684243197841, -438.86208744418377, -601.8353448372565, -785.5092317718627, -1097.893224576639, -923.7516345999588, -513.116572422542, -1046.5206012100732, -1020.8328057930153, -707.6916014324142, -508.93865667299724, -585.2377905999639, -602.8732502128115, -621.085564677536, -807.4221345714965, -733.8959402616267, -504.9023758256783, -535.227544086126, -830.7463345760563, -869.2392853804182, -688.2975757953916, -855.6557076104586, -816.4590930873079, -852.585947072578, -818.8534892446769, -1067.7114821321316, -1009.8088852877822, -930.6718950336667, -871.2061796795947, -888.2774470322815, -1020.9996023005622, -740.0716080267732, -746.3443956394477, -732.832450643513, -720.7381223943072, -652.5513813574496, -998.0419556137812, -470.3559029456608, -662.6675667572466, -474.8680286616357, -580.8105718120331, -570.1662877820227, -1178.8451275361977, -858.7163013056644, -694.8156343944005, -452.7068189820576, -608.3456158256217, -750.660993351937, -1045.2173286787524, -833.3557270235104, -787.2133332024458, -808.0492994819223, -539.7716950499627, -750.3821065654046, -666.5525706335234, -795.5260674886666, -1187.195266104132, -646.8361095209852, -1149.905236052508, -801.2423149206337, -684.6117348729066, -792.8103939927032, -526.157539044346, -689.7443666324847, -770.2809562845098, -932.3016437312655, -614.6595939800584, -536.4521534334979, -401.0565983900857, -735.497953612034, -1186.642378836706], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 21.101354521064497, "mean_inference_ms": 0.4028392377809781, "mean_action_processing_ms": 0.09611790971221386, "mean_env_wait_ms": 3.5572340198110672, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0039524781076531665, "StateBufferConnector_ms": 0.0027398059242650084, "ViewRequirementAgentConnector_ms": 0.06782105094508122}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 231960, "num_agent_steps_trained": 231960, "num_env_steps_sampled": 231960, "num_env_steps_trained": 231960, "num_env_steps_sampled_this_iter": 480, "num_env_steps_trained_this_iter": 480, "num_env_steps_sampled_throughput_per_sec": 41.34423168177517, "num_env_steps_trained_throughput_per_sec": 41.34423168177517, "timesteps_total": 231960, "num_steps_trained_this_iter": 480, "agent_timesteps_total": 231960, "timers": {"training_iteration_time_ms": 2901.293, "sample_time_ms": 2897.393, "load_time_ms": 0.226, "load_throughput": 531148.67, "learn_time_ms": 2.904, "learn_throughput": 41324.21, "synch_weights_time_ms": 0.729}, "counters": {"num_env_steps_sampled": 231960, "num_env_steps_trained": 231960, "num_agent_steps_sampled": 231960, "num_agent_steps_trained": 231960}, "done": false, "episodes_total": 1933, "training_iteration": 484, "trial_id": "29a31_00000", "date": "2023-07-26_02-27-33", "timestamp": 1690327653, "time_this_iter_s": 11.612765789031982, "time_total_s": 5901.09866476059, "pid": 90822, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 1, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[253680, 5e-06], [256080, 5e-06], [258480, 2.5e-06], [260880, 2.5e-06], [263280, 2.5e-06], [265680, 2.5e-06], [268080, 1e-06], [270480, 1e-06], [272880, 1e-06], [275280, 5e-07], [277680, 5e-07], [280080, 5e-07], [282480, 5e-07], [284880, 5e-07], [287280, 1e-07], [289680, 1e-07], [292080, 1e-07]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 120, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x16ca65700>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 279.773188829422, "iterations_since_restore": 24, "perf": {"cpu_util_percent": 35.33529411764705, "ram_util_percent": 73.88235294117646}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-07, "entropy_coeff": 0.05, "policy_entropy": 267.41497802734375, "policy_loss": -62466.2578125, "vf_loss": 1853930.75}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 99.0, "diff_num_grad_updates_vs_sampler_policy": 98.0}}, "num_env_steps_sampled": 232440, "num_env_steps_trained": 232440, "num_agent_steps_sampled": 232440, "num_agent_steps_trained": 232440}, "sampler_results": {"episode_reward_max": -401.0565983900857, "episode_reward_min": -1187.195266104132, "episode_reward_mean": -766.3858237005819, "episode_len_mean": 120.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-726.8807054690234, -910.0246383359593, -959.2389568152724, -838.2211556646348, -545.6956984135606, -949.1260831696337, -770.0494614982084, -866.1901591867485, -767.9635814346034, -660.1648686394927, -819.063436646348, -943.1467361268203, -886.7125040129276, -538.0263443305196, -674.6897017701436, -761.115765714462, -542.3565469218164, -736.9411809930638, -1037.9028207106699, -647.2917554966986, -580.3247649579893, -647.2356260274616, -1109.3846433101253, -789.4196789053547, -987.7684243197841, -438.86208744418377, -601.8353448372565, -785.5092317718627, -1097.893224576639, -923.7516345999588, -513.116572422542, -1046.5206012100732, -1020.8328057930153, -707.6916014324142, -508.93865667299724, -585.2377905999639, -602.8732502128115, -621.085564677536, -807.4221345714965, -733.8959402616267, -504.9023758256783, -535.227544086126, -830.7463345760563, -869.2392853804182, -688.2975757953916, -855.6557076104586, -816.4590930873079, -852.585947072578, -818.8534892446769, -1067.7114821321316, -1009.8088852877822, -930.6718950336667, -871.2061796795947, -888.2774470322815, -1020.9996023005622, -740.0716080267732, -746.3443956394477, -732.832450643513, -720.7381223943072, -652.5513813574496, -998.0419556137812, -470.3559029456608, -662.6675667572466, -474.8680286616357, -580.8105718120331, -570.1662877820227, -1178.8451275361977, -858.7163013056644, -694.8156343944005, -452.7068189820576, -608.3456158256217, -750.660993351937, -1045.2173286787524, -833.3557270235104, -787.2133332024458, -808.0492994819223, -539.7716950499627, -750.3821065654046, -666.5525706335234, -795.5260674886666, -1187.195266104132, -646.8361095209852, -1149.905236052508, -801.2423149206337, -684.6117348729066, -792.8103939927032, -526.157539044346, -689.7443666324847, -770.2809562845098, -932.3016437312655, -614.6595939800584, -536.4521534334979, -401.0565983900857, -735.497953612034, -1186.642378836706, -728.6278433915107, -832.3646724203976, -664.031553164132, -621.1268227183493], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 21.09973220221114, "mean_inference_ms": 0.4027524787226258, "mean_action_processing_ms": 0.09610102956201864, "mean_env_wait_ms": 3.529477258163646, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003932461594090317, "StateBufferConnector_ms": 0.0027353113347833805, "ViewRequirementAgentConnector_ms": 0.0678060030696368}}, "episode_reward_max": -401.0565983900857, "episode_reward_min": -1187.195266104132, "episode_reward_mean": -766.3858237005819, "episode_len_mean": 120.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-726.8807054690234, -910.0246383359593, -959.2389568152724, -838.2211556646348, -545.6956984135606, -949.1260831696337, -770.0494614982084, -866.1901591867485, -767.9635814346034, -660.1648686394927, -819.063436646348, -943.1467361268203, -886.7125040129276, -538.0263443305196, -674.6897017701436, -761.115765714462, -542.3565469218164, -736.9411809930638, -1037.9028207106699, -647.2917554966986, -580.3247649579893, -647.2356260274616, -1109.3846433101253, -789.4196789053547, -987.7684243197841, -438.86208744418377, -601.8353448372565, -785.5092317718627, -1097.893224576639, -923.7516345999588, -513.116572422542, -1046.5206012100732, -1020.8328057930153, -707.6916014324142, -508.93865667299724, -585.2377905999639, -602.8732502128115, -621.085564677536, -807.4221345714965, -733.8959402616267, -504.9023758256783, -535.227544086126, -830.7463345760563, -869.2392853804182, -688.2975757953916, -855.6557076104586, -816.4590930873079, -852.585947072578, -818.8534892446769, -1067.7114821321316, -1009.8088852877822, -930.6718950336667, -871.2061796795947, -888.2774470322815, -1020.9996023005622, -740.0716080267732, -746.3443956394477, -732.832450643513, -720.7381223943072, -652.5513813574496, -998.0419556137812, -470.3559029456608, -662.6675667572466, -474.8680286616357, -580.8105718120331, -570.1662877820227, -1178.8451275361977, -858.7163013056644, -694.8156343944005, -452.7068189820576, -608.3456158256217, -750.660993351937, -1045.2173286787524, -833.3557270235104, -787.2133332024458, -808.0492994819223, -539.7716950499627, -750.3821065654046, -666.5525706335234, -795.5260674886666, -1187.195266104132, -646.8361095209852, -1149.905236052508, -801.2423149206337, -684.6117348729066, -792.8103939927032, -526.157539044346, -689.7443666324847, -770.2809562845098, -932.3016437312655, -614.6595939800584, -536.4521534334979, -401.0565983900857, -735.497953612034, -1186.642378836706, -728.6278433915107, -832.3646724203976, -664.031553164132, -621.1268227183493], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 21.09973220221114, "mean_inference_ms": 0.4027524787226258, "mean_action_processing_ms": 0.09610102956201864, "mean_env_wait_ms": 3.529477258163646, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003932461594090317, "StateBufferConnector_ms": 0.0027353113347833805, "ViewRequirementAgentConnector_ms": 0.0678060030696368}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 232440, "num_agent_steps_trained": 232440, "num_env_steps_sampled": 232440, "num_env_steps_trained": 232440, "num_env_steps_sampled_this_iter": 480, "num_env_steps_trained_this_iter": 480, "num_env_steps_sampled_throughput_per_sec": 41.87253972826626, "num_env_steps_trained_throughput_per_sec": 41.87253972826626, "timesteps_total": 232440, "num_steps_trained_this_iter": 480, "agent_timesteps_total": 232440, "timers": {"training_iteration_time_ms": 2880.606, "sample_time_ms": 2876.723, "load_time_ms": 0.225, "load_throughput": 534306.242, "learn_time_ms": 2.884, "learn_throughput": 41614.287, "synch_weights_time_ms": 0.733}, "counters": {"num_env_steps_sampled": 232440, "num_env_steps_trained": 232440, "num_agent_steps_sampled": 232440, "num_agent_steps_trained": 232440}, "done": false, "episodes_total": 1937, "training_iteration": 485, "trial_id": "29a31_00000", "date": "2023-07-26_02-27-45", "timestamp": 1690327665, "time_this_iter_s": 11.46596884727478, "time_total_s": 5912.564633607864, "pid": 90822, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 1, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[253680, 5e-06], [256080, 5e-06], [258480, 2.5e-06], [260880, 2.5e-06], [263280, 2.5e-06], [265680, 2.5e-06], [268080, 1e-06], [270480, 1e-06], [272880, 1e-06], [275280, 5e-07], [277680, 5e-07], [280080, 5e-07], [282480, 5e-07], [284880, 5e-07], [287280, 1e-07], [289680, 1e-07], [292080, 1e-07]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 120, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x16ca65700>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 291.2391576766968, "iterations_since_restore": 25, "perf": {"cpu_util_percent": 36.79375, "ram_util_percent": 73.85625}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-07, "entropy_coeff": 0.05, "policy_entropy": 267.4372253417969, "policy_loss": -70533.0234375, "vf_loss": 2419250.5}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 103.0, "diff_num_grad_updates_vs_sampler_policy": 102.0}}, "num_env_steps_sampled": 232920, "num_env_steps_trained": 232920, "num_agent_steps_sampled": 232920, "num_agent_steps_trained": 232920}, "sampler_results": {"episode_reward_max": -360.4635582382683, "episode_reward_min": -1187.195266104132, "episode_reward_mean": -758.3526684281318, "episode_len_mean": 120.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-838.2211556646348, -545.6956984135606, -949.1260831696337, -770.0494614982084, -866.1901591867485, -767.9635814346034, -660.1648686394927, -819.063436646348, -943.1467361268203, -886.7125040129276, -538.0263443305196, -674.6897017701436, -761.115765714462, -542.3565469218164, -736.9411809930638, -1037.9028207106699, -647.2917554966986, -580.3247649579893, -647.2356260274616, -1109.3846433101253, -789.4196789053547, -987.7684243197841, -438.86208744418377, -601.8353448372565, -785.5092317718627, -1097.893224576639, -923.7516345999588, -513.116572422542, -1046.5206012100732, -1020.8328057930153, -707.6916014324142, -508.93865667299724, -585.2377905999639, -602.8732502128115, -621.085564677536, -807.4221345714965, -733.8959402616267, -504.9023758256783, -535.227544086126, -830.7463345760563, -869.2392853804182, -688.2975757953916, -855.6557076104586, -816.4590930873079, -852.585947072578, -818.8534892446769, -1067.7114821321316, -1009.8088852877822, -930.6718950336667, -871.2061796795947, -888.2774470322815, -1020.9996023005622, -740.0716080267732, -746.3443956394477, -732.832450643513, -720.7381223943072, -652.5513813574496, -998.0419556137812, -470.3559029456608, -662.6675667572466, -474.8680286616357, -580.8105718120331, -570.1662877820227, -1178.8451275361977, -858.7163013056644, -694.8156343944005, -452.7068189820576, -608.3456158256217, -750.660993351937, -1045.2173286787524, -833.3557270235104, -787.2133332024458, -808.0492994819223, -539.7716950499627, -750.3821065654046, -666.5525706335234, -795.5260674886666, -1187.195266104132, -646.8361095209852, -1149.905236052508, -801.2423149206337, -684.6117348729066, -792.8103939927032, -526.157539044346, -689.7443666324847, -770.2809562845098, -932.3016437312655, -614.6595939800584, -536.4521534334979, -401.0565983900857, -735.497953612034, -1186.642378836706, -728.6278433915107, -832.3646724203976, -664.031553164132, -621.1268227183493, -360.4635582382683, -783.908098890003, -816.2804678552773, -598.5624720922849], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 21.104626630640563, "mean_inference_ms": 0.4022585810809936, "mean_action_processing_ms": 0.09603379937539808, "mean_env_wait_ms": 3.3114396228612266, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003923177719116211, "StateBufferConnector_ms": 0.0027282238006591797, "ViewRequirementAgentConnector_ms": 0.06777429580688477}}, "episode_reward_max": -360.4635582382683, "episode_reward_min": -1187.195266104132, "episode_reward_mean": -758.3526684281318, "episode_len_mean": 120.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-838.2211556646348, -545.6956984135606, -949.1260831696337, -770.0494614982084, -866.1901591867485, -767.9635814346034, -660.1648686394927, -819.063436646348, -943.1467361268203, -886.7125040129276, -538.0263443305196, -674.6897017701436, -761.115765714462, -542.3565469218164, -736.9411809930638, -1037.9028207106699, -647.2917554966986, -580.3247649579893, -647.2356260274616, -1109.3846433101253, -789.4196789053547, -987.7684243197841, -438.86208744418377, -601.8353448372565, -785.5092317718627, -1097.893224576639, -923.7516345999588, -513.116572422542, -1046.5206012100732, -1020.8328057930153, -707.6916014324142, -508.93865667299724, -585.2377905999639, -602.8732502128115, -621.085564677536, -807.4221345714965, -733.8959402616267, -504.9023758256783, -535.227544086126, -830.7463345760563, -869.2392853804182, -688.2975757953916, -855.6557076104586, -816.4590930873079, -852.585947072578, -818.8534892446769, -1067.7114821321316, -1009.8088852877822, -930.6718950336667, -871.2061796795947, -888.2774470322815, -1020.9996023005622, -740.0716080267732, -746.3443956394477, -732.832450643513, -720.7381223943072, -652.5513813574496, -998.0419556137812, -470.3559029456608, -662.6675667572466, -474.8680286616357, -580.8105718120331, -570.1662877820227, -1178.8451275361977, -858.7163013056644, -694.8156343944005, -452.7068189820576, -608.3456158256217, -750.660993351937, -1045.2173286787524, -833.3557270235104, -787.2133332024458, -808.0492994819223, -539.7716950499627, -750.3821065654046, -666.5525706335234, -795.5260674886666, -1187.195266104132, -646.8361095209852, -1149.905236052508, -801.2423149206337, -684.6117348729066, -792.8103939927032, -526.157539044346, -689.7443666324847, -770.2809562845098, -932.3016437312655, -614.6595939800584, -536.4521534334979, -401.0565983900857, -735.497953612034, -1186.642378836706, -728.6278433915107, -832.3646724203976, -664.031553164132, -621.1268227183493, -360.4635582382683, -783.908098890003, -816.2804678552773, -598.5624720922849], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 21.104626630640563, "mean_inference_ms": 0.4022585810809936, "mean_action_processing_ms": 0.09603379937539808, "mean_env_wait_ms": 3.3114396228612266, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003923177719116211, "StateBufferConnector_ms": 0.0027282238006591797, "ViewRequirementAgentConnector_ms": 0.06777429580688477}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 232920, "num_agent_steps_trained": 232920, "num_env_steps_sampled": 232920, "num_env_steps_trained": 232920, "num_env_steps_sampled_this_iter": 480, "num_env_steps_trained_this_iter": 480, "num_env_steps_sampled_throughput_per_sec": 39.9768438953772, "num_env_steps_trained_throughput_per_sec": 39.9768438953772, "timesteps_total": 232920, "num_steps_trained_this_iter": 480, "agent_timesteps_total": 232920, "timers": {"training_iteration_time_ms": 2927.917, "sample_time_ms": 2924.125, "load_time_ms": 0.223, "load_throughput": 538825.051, "learn_time_ms": 2.823, "learn_throughput": 42507.684, "synch_weights_time_ms": 0.706}, "counters": {"num_env_steps_sampled": 232920, "num_env_steps_trained": 232920, "num_agent_steps_sampled": 232920, "num_agent_steps_trained": 232920}, "done": false, "episodes_total": 1941, "training_iteration": 486, "trial_id": "29a31_00000", "date": "2023-07-26_02-27-57", "timestamp": 1690327677, "time_this_iter_s": 12.009646892547607, "time_total_s": 5924.574280500412, "pid": 90822, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 1, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[253680, 5e-06], [256080, 5e-06], [258480, 2.5e-06], [260880, 2.5e-06], [263280, 2.5e-06], [265680, 2.5e-06], [268080, 1e-06], [270480, 1e-06], [272880, 1e-06], [275280, 5e-07], [277680, 5e-07], [280080, 5e-07], [282480, 5e-07], [284880, 5e-07], [287280, 1e-07], [289680, 1e-07], [292080, 1e-07]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 120, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x16ca65700>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 303.2488045692444, "iterations_since_restore": 26, "perf": {"cpu_util_percent": 37.85294117647059, "ram_util_percent": 74.30000000000001}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-07, "entropy_coeff": 0.05, "policy_entropy": 267.44171142578125, "policy_loss": -135401.0, "vf_loss": 7061040.5}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 107.0, "diff_num_grad_updates_vs_sampler_policy": 106.0}}, "num_env_steps_sampled": 233400, "num_env_steps_trained": 233400, "num_agent_steps_sampled": 233400, "num_agent_steps_trained": 233400}, "sampler_results": {"episode_reward_max": -360.4635582382683, "episode_reward_min": -1187.195266104132, "episode_reward_mean": -761.7481473893844, "episode_len_mean": 120.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-866.1901591867485, -767.9635814346034, -660.1648686394927, -819.063436646348, -943.1467361268203, -886.7125040129276, -538.0263443305196, -674.6897017701436, -761.115765714462, -542.3565469218164, -736.9411809930638, -1037.9028207106699, -647.2917554966986, -580.3247649579893, -647.2356260274616, -1109.3846433101253, -789.4196789053547, -987.7684243197841, -438.86208744418377, -601.8353448372565, -785.5092317718627, -1097.893224576639, -923.7516345999588, -513.116572422542, -1046.5206012100732, -1020.8328057930153, -707.6916014324142, -508.93865667299724, -585.2377905999639, -602.8732502128115, -621.085564677536, -807.4221345714965, -733.8959402616267, -504.9023758256783, -535.227544086126, -830.7463345760563, -869.2392853804182, -688.2975757953916, -855.6557076104586, -816.4590930873079, -852.585947072578, -818.8534892446769, -1067.7114821321316, -1009.8088852877822, -930.6718950336667, -871.2061796795947, -888.2774470322815, -1020.9996023005622, -740.0716080267732, -746.3443956394477, -732.832450643513, -720.7381223943072, -652.5513813574496, -998.0419556137812, -470.3559029456608, -662.6675667572466, -474.8680286616357, -580.8105718120331, -570.1662877820227, -1178.8451275361977, -858.7163013056644, -694.8156343944005, -452.7068189820576, -608.3456158256217, -750.660993351937, -1045.2173286787524, -833.3557270235104, -787.2133332024458, -808.0492994819223, -539.7716950499627, -750.3821065654046, -666.5525706335234, -795.5260674886666, -1187.195266104132, -646.8361095209852, -1149.905236052508, -801.2423149206337, -684.6117348729066, -792.8103939927032, -526.157539044346, -689.7443666324847, -770.2809562845098, -932.3016437312655, -614.6595939800584, -536.4521534334979, -401.0565983900857, -735.497953612034, -1186.642378836706, -728.6278433915107, -832.3646724203976, -664.031553164132, -621.1268227183493, -360.4635582382683, -783.908098890003, -816.2804678552773, -598.5624720922849, -821.8618812052129, -798.6359594142689, -914.7550554229312, -907.387398828879], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 21.114073484185525, "mean_inference_ms": 0.4017538305497773, "mean_action_processing_ms": 0.09593082299966085, "mean_env_wait_ms": 3.195087615810357, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003925800323486328, "StateBufferConnector_ms": 0.0027244091033935547, "ViewRequirementAgentConnector_ms": 0.06775903701782227}}, "episode_reward_max": -360.4635582382683, "episode_reward_min": -1187.195266104132, "episode_reward_mean": -761.7481473893844, "episode_len_mean": 120.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-866.1901591867485, -767.9635814346034, -660.1648686394927, -819.063436646348, -943.1467361268203, -886.7125040129276, -538.0263443305196, -674.6897017701436, -761.115765714462, -542.3565469218164, -736.9411809930638, -1037.9028207106699, -647.2917554966986, -580.3247649579893, -647.2356260274616, -1109.3846433101253, -789.4196789053547, -987.7684243197841, -438.86208744418377, -601.8353448372565, -785.5092317718627, -1097.893224576639, -923.7516345999588, -513.116572422542, -1046.5206012100732, -1020.8328057930153, -707.6916014324142, -508.93865667299724, -585.2377905999639, -602.8732502128115, -621.085564677536, -807.4221345714965, -733.8959402616267, -504.9023758256783, -535.227544086126, -830.7463345760563, -869.2392853804182, -688.2975757953916, -855.6557076104586, -816.4590930873079, -852.585947072578, -818.8534892446769, -1067.7114821321316, -1009.8088852877822, -930.6718950336667, -871.2061796795947, -888.2774470322815, -1020.9996023005622, -740.0716080267732, -746.3443956394477, -732.832450643513, -720.7381223943072, -652.5513813574496, -998.0419556137812, -470.3559029456608, -662.6675667572466, -474.8680286616357, -580.8105718120331, -570.1662877820227, -1178.8451275361977, -858.7163013056644, -694.8156343944005, -452.7068189820576, -608.3456158256217, -750.660993351937, -1045.2173286787524, -833.3557270235104, -787.2133332024458, -808.0492994819223, -539.7716950499627, -750.3821065654046, -666.5525706335234, -795.5260674886666, -1187.195266104132, -646.8361095209852, -1149.905236052508, -801.2423149206337, -684.6117348729066, -792.8103939927032, -526.157539044346, -689.7443666324847, -770.2809562845098, -932.3016437312655, -614.6595939800584, -536.4521534334979, -401.0565983900857, -735.497953612034, -1186.642378836706, -728.6278433915107, -832.3646724203976, -664.031553164132, -621.1268227183493, -360.4635582382683, -783.908098890003, -816.2804678552773, -598.5624720922849, -821.8618812052129, -798.6359594142689, -914.7550554229312, -907.387398828879], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 21.114073484185525, "mean_inference_ms": 0.4017538305497773, "mean_action_processing_ms": 0.09593082299966085, "mean_env_wait_ms": 3.195087615810357, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003925800323486328, "StateBufferConnector_ms": 0.0027244091033935547, "ViewRequirementAgentConnector_ms": 0.06775903701782227}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 233400, "num_agent_steps_trained": 233400, "num_env_steps_sampled": 233400, "num_env_steps_trained": 233400, "num_env_steps_sampled_this_iter": 480, "num_env_steps_trained_this_iter": 480, "num_env_steps_sampled_throughput_per_sec": 40.557182485753174, "num_env_steps_trained_throughput_per_sec": 40.557182485753174, "timesteps_total": 233400, "num_steps_trained_this_iter": 480, "agent_timesteps_total": 233400, "timers": {"training_iteration_time_ms": 2955.861, "sample_time_ms": 2952.043, "load_time_ms": 0.224, "load_throughput": 535728.026, "learn_time_ms": 2.842, "learn_throughput": 42216.391, "synch_weights_time_ms": 0.71}, "counters": {"num_env_steps_sampled": 233400, "num_env_steps_trained": 233400, "num_agent_steps_sampled": 233400, "num_agent_steps_trained": 233400}, "done": false, "episodes_total": 1945, "training_iteration": 487, "trial_id": "29a31_00000", "date": "2023-07-26_02-28-08", "timestamp": 1690327688, "time_this_iter_s": 11.837769269943237, "time_total_s": 5936.412049770355, "pid": 90822, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 1, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[253680, 5e-06], [256080, 5e-06], [258480, 2.5e-06], [260880, 2.5e-06], [263280, 2.5e-06], [265680, 2.5e-06], [268080, 1e-06], [270480, 1e-06], [272880, 1e-06], [275280, 5e-07], [277680, 5e-07], [280080, 5e-07], [282480, 5e-07], [284880, 5e-07], [287280, 1e-07], [289680, 1e-07], [292080, 1e-07]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 120, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x16ca65700>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 315.0865738391876, "iterations_since_restore": 27, "perf": {"cpu_util_percent": 37.71176470588235, "ram_util_percent": 75.60588235294118}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-07, "entropy_coeff": 0.05, "policy_entropy": 267.4512634277344, "policy_loss": -84719.671875, "vf_loss": 3307327.25}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 111.0, "diff_num_grad_updates_vs_sampler_policy": 110.0}}, "num_env_steps_sampled": 233880, "num_env_steps_trained": 233880, "num_agent_steps_sampled": 233880, "num_agent_steps_trained": 233880}, "sampler_results": {"episode_reward_max": -360.4635582382683, "episode_reward_min": -1187.195266104132, "episode_reward_mean": -759.249674764873, "episode_len_mean": 120.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-943.1467361268203, -886.7125040129276, -538.0263443305196, -674.6897017701436, -761.115765714462, -542.3565469218164, -736.9411809930638, -1037.9028207106699, -647.2917554966986, -580.3247649579893, -647.2356260274616, -1109.3846433101253, -789.4196789053547, -987.7684243197841, -438.86208744418377, -601.8353448372565, -785.5092317718627, -1097.893224576639, -923.7516345999588, -513.116572422542, -1046.5206012100732, -1020.8328057930153, -707.6916014324142, -508.93865667299724, -585.2377905999639, -602.8732502128115, -621.085564677536, -807.4221345714965, -733.8959402616267, -504.9023758256783, -535.227544086126, -830.7463345760563, -869.2392853804182, -688.2975757953916, -855.6557076104586, -816.4590930873079, -852.585947072578, -818.8534892446769, -1067.7114821321316, -1009.8088852877822, -930.6718950336667, -871.2061796795947, -888.2774470322815, -1020.9996023005622, -740.0716080267732, -746.3443956394477, -732.832450643513, -720.7381223943072, -652.5513813574496, -998.0419556137812, -470.3559029456608, -662.6675667572466, -474.8680286616357, -580.8105718120331, -570.1662877820227, -1178.8451275361977, -858.7163013056644, -694.8156343944005, -452.7068189820576, -608.3456158256217, -750.660993351937, -1045.2173286787524, -833.3557270235104, -787.2133332024458, -808.0492994819223, -539.7716950499627, -750.3821065654046, -666.5525706335234, -795.5260674886666, -1187.195266104132, -646.8361095209852, -1149.905236052508, -801.2423149206337, -684.6117348729066, -792.8103939927032, -526.157539044346, -689.7443666324847, -770.2809562845098, -932.3016437312655, -614.6595939800584, -536.4521534334979, -401.0565983900857, -735.497953612034, -1186.642378836706, -728.6278433915107, -832.3646724203976, -664.031553164132, -621.1268227183493, -360.4635582382683, -783.908098890003, -816.2804678552773, -598.5624720922849, -821.8618812052129, -798.6359594142689, -914.7550554229312, -907.387398828879, -806.032838220834, -853.2777366222037, -535.9236276345816, -668.3005809784493], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 21.121370498807934, "mean_inference_ms": 0.4014839040992746, "mean_action_processing_ms": 0.09586967241933429, "mean_env_wait_ms": 3.12446847085695, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00392460823059082, "StateBufferConnector_ms": 0.0027272701263427734, "ViewRequirementAgentConnector_ms": 0.06773257255554199}}, "episode_reward_max": -360.4635582382683, "episode_reward_min": -1187.195266104132, "episode_reward_mean": -759.249674764873, "episode_len_mean": 120.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-943.1467361268203, -886.7125040129276, -538.0263443305196, -674.6897017701436, -761.115765714462, -542.3565469218164, -736.9411809930638, -1037.9028207106699, -647.2917554966986, -580.3247649579893, -647.2356260274616, -1109.3846433101253, -789.4196789053547, -987.7684243197841, -438.86208744418377, -601.8353448372565, -785.5092317718627, -1097.893224576639, -923.7516345999588, -513.116572422542, -1046.5206012100732, -1020.8328057930153, -707.6916014324142, -508.93865667299724, -585.2377905999639, -602.8732502128115, -621.085564677536, -807.4221345714965, -733.8959402616267, -504.9023758256783, -535.227544086126, -830.7463345760563, -869.2392853804182, -688.2975757953916, -855.6557076104586, -816.4590930873079, -852.585947072578, -818.8534892446769, -1067.7114821321316, -1009.8088852877822, -930.6718950336667, -871.2061796795947, -888.2774470322815, -1020.9996023005622, -740.0716080267732, -746.3443956394477, -732.832450643513, -720.7381223943072, -652.5513813574496, -998.0419556137812, -470.3559029456608, -662.6675667572466, -474.8680286616357, -580.8105718120331, -570.1662877820227, -1178.8451275361977, -858.7163013056644, -694.8156343944005, -452.7068189820576, -608.3456158256217, -750.660993351937, -1045.2173286787524, -833.3557270235104, -787.2133332024458, -808.0492994819223, -539.7716950499627, -750.3821065654046, -666.5525706335234, -795.5260674886666, -1187.195266104132, -646.8361095209852, -1149.905236052508, -801.2423149206337, -684.6117348729066, -792.8103939927032, -526.157539044346, -689.7443666324847, -770.2809562845098, -932.3016437312655, -614.6595939800584, -536.4521534334979, -401.0565983900857, -735.497953612034, -1186.642378836706, -728.6278433915107, -832.3646724203976, -664.031553164132, -621.1268227183493, -360.4635582382683, -783.908098890003, -816.2804678552773, -598.5624720922849, -821.8618812052129, -798.6359594142689, -914.7550554229312, -907.387398828879, -806.032838220834, -853.2777366222037, -535.9236276345816, -668.3005809784493], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 21.121370498807934, "mean_inference_ms": 0.4014839040992746, "mean_action_processing_ms": 0.09586967241933429, "mean_env_wait_ms": 3.12446847085695, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00392460823059082, "StateBufferConnector_ms": 0.0027272701263427734, "ViewRequirementAgentConnector_ms": 0.06773257255554199}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 233880, "num_agent_steps_trained": 233880, "num_env_steps_sampled": 233880, "num_env_steps_trained": 233880, "num_env_steps_sampled_this_iter": 480, "num_env_steps_trained_this_iter": 480, "num_env_steps_sampled_throughput_per_sec": 41.25605111287689, "num_env_steps_trained_throughput_per_sec": 41.25605111287689, "timesteps_total": 233880, "num_steps_trained_this_iter": 480, "agent_timesteps_total": 233880, "timers": {"training_iteration_time_ms": 2955.884, "sample_time_ms": 2952.067, "load_time_ms": 0.224, "load_throughput": 536013.291, "learn_time_ms": 2.848, "learn_throughput": 42136.87, "synch_weights_time_ms": 0.705}, "counters": {"num_env_steps_sampled": 233880, "num_env_steps_trained": 233880, "num_agent_steps_sampled": 233880, "num_agent_steps_trained": 233880}, "done": false, "episodes_total": 1949, "training_iteration": 488, "trial_id": "29a31_00000", "date": "2023-07-26_02-28-20", "timestamp": 1690327700, "time_this_iter_s": 11.637399911880493, "time_total_s": 5948.049449682236, "pid": 90822, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 1, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[253680, 5e-06], [256080, 5e-06], [258480, 2.5e-06], [260880, 2.5e-06], [263280, 2.5e-06], [265680, 2.5e-06], [268080, 1e-06], [270480, 1e-06], [272880, 1e-06], [275280, 5e-07], [277680, 5e-07], [280080, 5e-07], [282480, 5e-07], [284880, 5e-07], [287280, 1e-07], [289680, 1e-07], [292080, 1e-07]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 120, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x16ca65700>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 326.7239737510681, "iterations_since_restore": 28, "perf": {"cpu_util_percent": 36.90625, "ram_util_percent": 77.975}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-07, "entropy_coeff": 0.05, "policy_entropy": 267.44171142578125, "policy_loss": -123741.4453125, "vf_loss": 7500304.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 115.0, "diff_num_grad_updates_vs_sampler_policy": 114.0}}, "num_env_steps_sampled": 234360, "num_env_steps_trained": 234360, "num_agent_steps_sampled": 234360, "num_agent_steps_trained": 234360}, "sampler_results": {"episode_reward_max": -360.4635582382683, "episode_reward_min": -1187.195266104132, "episode_reward_mean": -761.078695059443, "episode_len_mean": 120.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-761.115765714462, -542.3565469218164, -736.9411809930638, -1037.9028207106699, -647.2917554966986, -580.3247649579893, -647.2356260274616, -1109.3846433101253, -789.4196789053547, -987.7684243197841, -438.86208744418377, -601.8353448372565, -785.5092317718627, -1097.893224576639, -923.7516345999588, -513.116572422542, -1046.5206012100732, -1020.8328057930153, -707.6916014324142, -508.93865667299724, -585.2377905999639, -602.8732502128115, -621.085564677536, -807.4221345714965, -733.8959402616267, -504.9023758256783, -535.227544086126, -830.7463345760563, -869.2392853804182, -688.2975757953916, -855.6557076104586, -816.4590930873079, -852.585947072578, -818.8534892446769, -1067.7114821321316, -1009.8088852877822, -930.6718950336667, -871.2061796795947, -888.2774470322815, -1020.9996023005622, -740.0716080267732, -746.3443956394477, -732.832450643513, -720.7381223943072, -652.5513813574496, -998.0419556137812, -470.3559029456608, -662.6675667572466, -474.8680286616357, -580.8105718120331, -570.1662877820227, -1178.8451275361977, -858.7163013056644, -694.8156343944005, -452.7068189820576, -608.3456158256217, -750.660993351937, -1045.2173286787524, -833.3557270235104, -787.2133332024458, -808.0492994819223, -539.7716950499627, -750.3821065654046, -666.5525706335234, -795.5260674886666, -1187.195266104132, -646.8361095209852, -1149.905236052508, -801.2423149206337, -684.6117348729066, -792.8103939927032, -526.157539044346, -689.7443666324847, -770.2809562845098, -932.3016437312655, -614.6595939800584, -536.4521534334979, -401.0565983900857, -735.497953612034, -1186.642378836706, -728.6278433915107, -832.3646724203976, -664.031553164132, -621.1268227183493, -360.4635582382683, -783.908098890003, -816.2804678552773, -598.5624720922849, -821.8618812052129, -798.6359594142689, -914.7550554229312, -907.387398828879, -806.032838220834, -853.2777366222037, -535.9236276345816, -668.3005809784493, -817.6324127460357, -575.5426486006425, -844.338362443564, -987.9638919071522], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 21.12054930826606, "mean_inference_ms": 0.40126311825604255, "mean_action_processing_ms": 0.09582738861342296, "mean_env_wait_ms": 3.074324186141687, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0039327144622802734, "StateBufferConnector_ms": 0.0027322769165039062, "ViewRequirementAgentConnector_ms": 0.06770563125610352}}, "episode_reward_max": -360.4635582382683, "episode_reward_min": -1187.195266104132, "episode_reward_mean": -761.078695059443, "episode_len_mean": 120.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-761.115765714462, -542.3565469218164, -736.9411809930638, -1037.9028207106699, -647.2917554966986, -580.3247649579893, -647.2356260274616, -1109.3846433101253, -789.4196789053547, -987.7684243197841, -438.86208744418377, -601.8353448372565, -785.5092317718627, -1097.893224576639, -923.7516345999588, -513.116572422542, -1046.5206012100732, -1020.8328057930153, -707.6916014324142, -508.93865667299724, -585.2377905999639, -602.8732502128115, -621.085564677536, -807.4221345714965, -733.8959402616267, -504.9023758256783, -535.227544086126, -830.7463345760563, -869.2392853804182, -688.2975757953916, -855.6557076104586, -816.4590930873079, -852.585947072578, -818.8534892446769, -1067.7114821321316, -1009.8088852877822, -930.6718950336667, -871.2061796795947, -888.2774470322815, -1020.9996023005622, -740.0716080267732, -746.3443956394477, -732.832450643513, -720.7381223943072, -652.5513813574496, -998.0419556137812, -470.3559029456608, -662.6675667572466, -474.8680286616357, -580.8105718120331, -570.1662877820227, -1178.8451275361977, -858.7163013056644, -694.8156343944005, -452.7068189820576, -608.3456158256217, -750.660993351937, -1045.2173286787524, -833.3557270235104, -787.2133332024458, -808.0492994819223, -539.7716950499627, -750.3821065654046, -666.5525706335234, -795.5260674886666, -1187.195266104132, -646.8361095209852, -1149.905236052508, -801.2423149206337, -684.6117348729066, -792.8103939927032, -526.157539044346, -689.7443666324847, -770.2809562845098, -932.3016437312655, -614.6595939800584, -536.4521534334979, -401.0565983900857, -735.497953612034, -1186.642378836706, -728.6278433915107, -832.3646724203976, -664.031553164132, -621.1268227183493, -360.4635582382683, -783.908098890003, -816.2804678552773, -598.5624720922849, -821.8618812052129, -798.6359594142689, -914.7550554229312, -907.387398828879, -806.032838220834, -853.2777366222037, -535.9236276345816, -668.3005809784493, -817.6324127460357, -575.5426486006425, -844.338362443564, -987.9638919071522], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 21.12054930826606, "mean_inference_ms": 0.40126311825604255, "mean_action_processing_ms": 0.09582738861342296, "mean_env_wait_ms": 3.074324186141687, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0039327144622802734, "StateBufferConnector_ms": 0.0027322769165039062, "ViewRequirementAgentConnector_ms": 0.06770563125610352}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 234360, "num_agent_steps_trained": 234360, "num_env_steps_sampled": 234360, "num_env_steps_trained": 234360, "num_env_steps_sampled_this_iter": 480, "num_env_steps_trained_this_iter": 480, "num_env_steps_sampled_throughput_per_sec": 42.16070518067151, "num_env_steps_trained_throughput_per_sec": 42.16070518067151, "timesteps_total": 234360, "num_steps_trained_this_iter": 480, "agent_timesteps_total": 234360, "timers": {"training_iteration_time_ms": 2900.789, "sample_time_ms": 2896.979, "load_time_ms": 0.224, "load_throughput": 534874.049, "learn_time_ms": 2.819, "learn_throughput": 42563.042, "synch_weights_time_ms": 0.726}, "counters": {"num_env_steps_sampled": 234360, "num_env_steps_trained": 234360, "num_agent_steps_sampled": 234360, "num_agent_steps_trained": 234360}, "done": false, "episodes_total": 1953, "training_iteration": 489, "trial_id": "29a31_00000", "date": "2023-07-26_02-28-32", "timestamp": 1690327712, "time_this_iter_s": 11.387742757797241, "time_total_s": 5959.437192440033, "pid": 90822, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 1, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[253680, 5e-06], [256080, 5e-06], [258480, 2.5e-06], [260880, 2.5e-06], [263280, 2.5e-06], [265680, 2.5e-06], [268080, 1e-06], [270480, 1e-06], [272880, 1e-06], [275280, 5e-07], [277680, 5e-07], [280080, 5e-07], [282480, 5e-07], [284880, 5e-07], [287280, 1e-07], [289680, 1e-07], [292080, 1e-07]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 120, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x16ca65700>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 338.11171650886536, "iterations_since_restore": 29, "perf": {"cpu_util_percent": 35.21176470588236, "ram_util_percent": 75.18235294117648}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-07, "entropy_coeff": 0.05, "policy_entropy": 267.4349670410156, "policy_loss": -106262.609375, "vf_loss": 4892365.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 119.0, "diff_num_grad_updates_vs_sampler_policy": 118.0}}, "num_env_steps_sampled": 234840, "num_env_steps_trained": 234840, "num_agent_steps_sampled": 234840, "num_agent_steps_trained": 234840}, "sampler_results": {"episode_reward_max": -360.4635582382683, "episode_reward_min": -1187.195266104132, "episode_reward_mean": -758.6600346815959, "episode_len_mean": 120.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-647.2917554966986, -580.3247649579893, -647.2356260274616, -1109.3846433101253, -789.4196789053547, -987.7684243197841, -438.86208744418377, -601.8353448372565, -785.5092317718627, -1097.893224576639, -923.7516345999588, -513.116572422542, -1046.5206012100732, -1020.8328057930153, -707.6916014324142, -508.93865667299724, -585.2377905999639, -602.8732502128115, -621.085564677536, -807.4221345714965, -733.8959402616267, -504.9023758256783, -535.227544086126, -830.7463345760563, -869.2392853804182, -688.2975757953916, -855.6557076104586, -816.4590930873079, -852.585947072578, -818.8534892446769, -1067.7114821321316, -1009.8088852877822, -930.6718950336667, -871.2061796795947, -888.2774470322815, -1020.9996023005622, -740.0716080267732, -746.3443956394477, -732.832450643513, -720.7381223943072, -652.5513813574496, -998.0419556137812, -470.3559029456608, -662.6675667572466, -474.8680286616357, -580.8105718120331, -570.1662877820227, -1178.8451275361977, -858.7163013056644, -694.8156343944005, -452.7068189820576, -608.3456158256217, -750.660993351937, -1045.2173286787524, -833.3557270235104, -787.2133332024458, -808.0492994819223, -539.7716950499627, -750.3821065654046, -666.5525706335234, -795.5260674886666, -1187.195266104132, -646.8361095209852, -1149.905236052508, -801.2423149206337, -684.6117348729066, -792.8103939927032, -526.157539044346, -689.7443666324847, -770.2809562845098, -932.3016437312655, -614.6595939800584, -536.4521534334979, -401.0565983900857, -735.497953612034, -1186.642378836706, -728.6278433915107, -832.3646724203976, -664.031553164132, -621.1268227183493, -360.4635582382683, -783.908098890003, -816.2804678552773, -598.5624720922849, -821.8618812052129, -798.6359594142689, -914.7550554229312, -907.387398828879, -806.032838220834, -853.2777366222037, -535.9236276345816, -668.3005809784493, -817.6324127460357, -575.5426486006425, -844.338362443564, -987.9638919071522, -964.0078814003056, -575.0411396747068, -486.9990873779783, -810.4021681023249], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 21.114747975693277, "mean_inference_ms": 0.4011428507218004, "mean_action_processing_ms": 0.09580564095231078, "mean_env_wait_ms": 3.0360277544887877, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003931999206542969, "StateBufferConnector_ms": 0.0027282238006591797, "ViewRequirementAgentConnector_ms": 0.0677182674407959}}, "episode_reward_max": -360.4635582382683, "episode_reward_min": -1187.195266104132, "episode_reward_mean": -758.6600346815959, "episode_len_mean": 120.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-647.2917554966986, -580.3247649579893, -647.2356260274616, -1109.3846433101253, -789.4196789053547, -987.7684243197841, -438.86208744418377, -601.8353448372565, -785.5092317718627, -1097.893224576639, -923.7516345999588, -513.116572422542, -1046.5206012100732, -1020.8328057930153, -707.6916014324142, -508.93865667299724, -585.2377905999639, -602.8732502128115, -621.085564677536, -807.4221345714965, -733.8959402616267, -504.9023758256783, -535.227544086126, -830.7463345760563, -869.2392853804182, -688.2975757953916, -855.6557076104586, -816.4590930873079, -852.585947072578, -818.8534892446769, -1067.7114821321316, -1009.8088852877822, -930.6718950336667, -871.2061796795947, -888.2774470322815, -1020.9996023005622, -740.0716080267732, -746.3443956394477, -732.832450643513, -720.7381223943072, -652.5513813574496, -998.0419556137812, -470.3559029456608, -662.6675667572466, -474.8680286616357, -580.8105718120331, -570.1662877820227, -1178.8451275361977, -858.7163013056644, -694.8156343944005, -452.7068189820576, -608.3456158256217, -750.660993351937, -1045.2173286787524, -833.3557270235104, -787.2133332024458, -808.0492994819223, -539.7716950499627, -750.3821065654046, -666.5525706335234, -795.5260674886666, -1187.195266104132, -646.8361095209852, -1149.905236052508, -801.2423149206337, -684.6117348729066, -792.8103939927032, -526.157539044346, -689.7443666324847, -770.2809562845098, -932.3016437312655, -614.6595939800584, -536.4521534334979, -401.0565983900857, -735.497953612034, -1186.642378836706, -728.6278433915107, -832.3646724203976, -664.031553164132, -621.1268227183493, -360.4635582382683, -783.908098890003, -816.2804678552773, -598.5624720922849, -821.8618812052129, -798.6359594142689, -914.7550554229312, -907.387398828879, -806.032838220834, -853.2777366222037, -535.9236276345816, -668.3005809784493, -817.6324127460357, -575.5426486006425, -844.338362443564, -987.9638919071522, -964.0078814003056, -575.0411396747068, -486.9990873779783, -810.4021681023249], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 21.114747975693277, "mean_inference_ms": 0.4011428507218004, "mean_action_processing_ms": 0.09580564095231078, "mean_env_wait_ms": 3.0360277544887877, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003931999206542969, "StateBufferConnector_ms": 0.0027282238006591797, "ViewRequirementAgentConnector_ms": 0.0677182674407959}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 234840, "num_agent_steps_trained": 234840, "num_env_steps_sampled": 234840, "num_env_steps_trained": 234840, "num_env_steps_sampled_this_iter": 480, "num_env_steps_trained_this_iter": 480, "num_env_steps_sampled_throughput_per_sec": 41.36240999933311, "num_env_steps_trained_throughput_per_sec": 41.36240999933311, "timesteps_total": 234840, "num_steps_trained_this_iter": 480, "agent_timesteps_total": 234840, "timers": {"training_iteration_time_ms": 2878.928, "sample_time_ms": 2875.117, "load_time_ms": 0.225, "load_throughput": 533343.732, "learn_time_ms": 2.819, "learn_throughput": 42568.801, "synch_weights_time_ms": 0.725}, "counters": {"num_env_steps_sampled": 234840, "num_env_steps_trained": 234840, "num_agent_steps_sampled": 234840, "num_agent_steps_trained": 234840}, "done": false, "episodes_total": 1957, "training_iteration": 490, "trial_id": "29a31_00000", "date": "2023-07-26_02-28-43", "timestamp": 1690327723, "time_this_iter_s": 11.607470035552979, "time_total_s": 5971.044662475586, "pid": 90822, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 1, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[253680, 5e-06], [256080, 5e-06], [258480, 2.5e-06], [260880, 2.5e-06], [263280, 2.5e-06], [265680, 2.5e-06], [268080, 1e-06], [270480, 1e-06], [272880, 1e-06], [275280, 5e-07], [277680, 5e-07], [280080, 5e-07], [282480, 5e-07], [284880, 5e-07], [287280, 1e-07], [289680, 1e-07], [292080, 1e-07]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 120, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x16ca65700>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 349.71918654441833, "iterations_since_restore": 30, "perf": {"cpu_util_percent": 36.41875, "ram_util_percent": 74.61875}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-07, "entropy_coeff": 0.05, "policy_entropy": 267.4502868652344, "policy_loss": -54629.6796875, "vf_loss": 1420827.125}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 123.0, "diff_num_grad_updates_vs_sampler_policy": 122.0}}, "num_env_steps_sampled": 235320, "num_env_steps_trained": 235320, "num_agent_steps_sampled": 235320, "num_agent_steps_trained": 235320}, "sampler_results": {"episode_reward_max": -360.4635582382683, "episode_reward_min": -1187.195266104132, "episode_reward_mean": -762.4134273500498, "episode_len_mean": 120.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-789.4196789053547, -987.7684243197841, -438.86208744418377, -601.8353448372565, -785.5092317718627, -1097.893224576639, -923.7516345999588, -513.116572422542, -1046.5206012100732, -1020.8328057930153, -707.6916014324142, -508.93865667299724, -585.2377905999639, -602.8732502128115, -621.085564677536, -807.4221345714965, -733.8959402616267, -504.9023758256783, -535.227544086126, -830.7463345760563, -869.2392853804182, -688.2975757953916, -855.6557076104586, -816.4590930873079, -852.585947072578, -818.8534892446769, -1067.7114821321316, -1009.8088852877822, -930.6718950336667, -871.2061796795947, -888.2774470322815, -1020.9996023005622, -740.0716080267732, -746.3443956394477, -732.832450643513, -720.7381223943072, -652.5513813574496, -998.0419556137812, -470.3559029456608, -662.6675667572466, -474.8680286616357, -580.8105718120331, -570.1662877820227, -1178.8451275361977, -858.7163013056644, -694.8156343944005, -452.7068189820576, -608.3456158256217, -750.660993351937, -1045.2173286787524, -833.3557270235104, -787.2133332024458, -808.0492994819223, -539.7716950499627, -750.3821065654046, -666.5525706335234, -795.5260674886666, -1187.195266104132, -646.8361095209852, -1149.905236052508, -801.2423149206337, -684.6117348729066, -792.8103939927032, -526.157539044346, -689.7443666324847, -770.2809562845098, -932.3016437312655, -614.6595939800584, -536.4521534334979, -401.0565983900857, -735.497953612034, -1186.642378836706, -728.6278433915107, -832.3646724203976, -664.031553164132, -621.1268227183493, -360.4635582382683, -783.908098890003, -816.2804678552773, -598.5624720922849, -821.8618812052129, -798.6359594142689, -914.7550554229312, -907.387398828879, -806.032838220834, -853.2777366222037, -535.9236276345816, -668.3005809784493, -817.6324127460357, -575.5426486006425, -844.338362443564, -987.9638919071522, -964.0078814003056, -575.0411396747068, -486.9990873779783, -810.4021681023249, -1020.3625499691664, -788.4657366836122, -1059.1970154748042, -491.5507545100828], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 21.10671421927956, "mean_inference_ms": 0.40102014838093936, "mean_action_processing_ms": 0.09578815130289925, "mean_env_wait_ms": 3.005296605375934, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003943681716918945, "StateBufferConnector_ms": 0.0027387142181396484, "ViewRequirementAgentConnector_ms": 0.06794118881225586}}, "episode_reward_max": -360.4635582382683, "episode_reward_min": -1187.195266104132, "episode_reward_mean": -762.4134273500498, "episode_len_mean": 120.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-789.4196789053547, -987.7684243197841, -438.86208744418377, -601.8353448372565, -785.5092317718627, -1097.893224576639, -923.7516345999588, -513.116572422542, -1046.5206012100732, -1020.8328057930153, -707.6916014324142, -508.93865667299724, -585.2377905999639, -602.8732502128115, -621.085564677536, -807.4221345714965, -733.8959402616267, -504.9023758256783, -535.227544086126, -830.7463345760563, -869.2392853804182, -688.2975757953916, -855.6557076104586, -816.4590930873079, -852.585947072578, -818.8534892446769, -1067.7114821321316, -1009.8088852877822, -930.6718950336667, -871.2061796795947, -888.2774470322815, -1020.9996023005622, -740.0716080267732, -746.3443956394477, -732.832450643513, -720.7381223943072, -652.5513813574496, -998.0419556137812, -470.3559029456608, -662.6675667572466, -474.8680286616357, -580.8105718120331, -570.1662877820227, -1178.8451275361977, -858.7163013056644, -694.8156343944005, -452.7068189820576, -608.3456158256217, -750.660993351937, -1045.2173286787524, -833.3557270235104, -787.2133332024458, -808.0492994819223, -539.7716950499627, -750.3821065654046, -666.5525706335234, -795.5260674886666, -1187.195266104132, -646.8361095209852, -1149.905236052508, -801.2423149206337, -684.6117348729066, -792.8103939927032, -526.157539044346, -689.7443666324847, -770.2809562845098, -932.3016437312655, -614.6595939800584, -536.4521534334979, -401.0565983900857, -735.497953612034, -1186.642378836706, -728.6278433915107, -832.3646724203976, -664.031553164132, -621.1268227183493, -360.4635582382683, -783.908098890003, -816.2804678552773, -598.5624720922849, -821.8618812052129, -798.6359594142689, -914.7550554229312, -907.387398828879, -806.032838220834, -853.2777366222037, -535.9236276345816, -668.3005809784493, -817.6324127460357, -575.5426486006425, -844.338362443564, -987.9638919071522, -964.0078814003056, -575.0411396747068, -486.9990873779783, -810.4021681023249, -1020.3625499691664, -788.4657366836122, -1059.1970154748042, -491.5507545100828], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 21.10671421927956, "mean_inference_ms": 0.40102014838093936, "mean_action_processing_ms": 0.09578815130289925, "mean_env_wait_ms": 3.005296605375934, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003943681716918945, "StateBufferConnector_ms": 0.0027387142181396484, "ViewRequirementAgentConnector_ms": 0.06794118881225586}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 235320, "num_agent_steps_trained": 235320, "num_env_steps_sampled": 235320, "num_env_steps_trained": 235320, "num_env_steps_sampled_this_iter": 480, "num_env_steps_trained_this_iter": 480, "num_env_steps_sampled_throughput_per_sec": 41.1956066524593, "num_env_steps_trained_throughput_per_sec": 41.1956066524593, "timesteps_total": 235320, "num_steps_trained_this_iter": 480, "agent_timesteps_total": 235320, "timers": {"training_iteration_time_ms": 2894.563, "sample_time_ms": 2890.739, "load_time_ms": 0.226, "load_throughput": 532047.019, "learn_time_ms": 2.828, "learn_throughput": 42430.281, "synch_weights_time_ms": 0.728}, "counters": {"num_env_steps_sampled": 235320, "num_env_steps_trained": 235320, "num_agent_steps_sampled": 235320, "num_agent_steps_trained": 235320}, "done": false, "episodes_total": 1961, "training_iteration": 491, "trial_id": "29a31_00000", "date": "2023-07-26_02-28-55", "timestamp": 1690327735, "time_this_iter_s": 11.6544189453125, "time_total_s": 5982.699081420898, "pid": 90822, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 1, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[253680, 5e-06], [256080, 5e-06], [258480, 2.5e-06], [260880, 2.5e-06], [263280, 2.5e-06], [265680, 2.5e-06], [268080, 1e-06], [270480, 1e-06], [272880, 1e-06], [275280, 5e-07], [277680, 5e-07], [280080, 5e-07], [282480, 5e-07], [284880, 5e-07], [287280, 1e-07], [289680, 1e-07], [292080, 1e-07]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 120, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x16ca65700>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 361.37360548973083, "iterations_since_restore": 31, "perf": {"cpu_util_percent": 37.07058823529411, "ram_util_percent": 75.02941176470588}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-07, "entropy_coeff": 0.05, "policy_entropy": 267.46417236328125, "policy_loss": -144701.8125, "vf_loss": 9907427.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 127.0, "diff_num_grad_updates_vs_sampler_policy": 126.0}}, "num_env_steps_sampled": 235800, "num_env_steps_trained": 235800, "num_agent_steps_sampled": 235800, "num_agent_steps_trained": 235800}, "sampler_results": {"episode_reward_max": -360.4635582382683, "episode_reward_min": -1187.195266104132, "episode_reward_mean": -763.4211954783921, "episode_len_mean": 120.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-785.5092317718627, -1097.893224576639, -923.7516345999588, -513.116572422542, -1046.5206012100732, -1020.8328057930153, -707.6916014324142, -508.93865667299724, -585.2377905999639, -602.8732502128115, -621.085564677536, -807.4221345714965, -733.8959402616267, -504.9023758256783, -535.227544086126, -830.7463345760563, -869.2392853804182, -688.2975757953916, -855.6557076104586, -816.4590930873079, -852.585947072578, -818.8534892446769, -1067.7114821321316, -1009.8088852877822, -930.6718950336667, -871.2061796795947, -888.2774470322815, -1020.9996023005622, -740.0716080267732, -746.3443956394477, -732.832450643513, -720.7381223943072, -652.5513813574496, -998.0419556137812, -470.3559029456608, -662.6675667572466, -474.8680286616357, -580.8105718120331, -570.1662877820227, -1178.8451275361977, -858.7163013056644, -694.8156343944005, -452.7068189820576, -608.3456158256217, -750.660993351937, -1045.2173286787524, -833.3557270235104, -787.2133332024458, -808.0492994819223, -539.7716950499627, -750.3821065654046, -666.5525706335234, -795.5260674886666, -1187.195266104132, -646.8361095209852, -1149.905236052508, -801.2423149206337, -684.6117348729066, -792.8103939927032, -526.157539044346, -689.7443666324847, -770.2809562845098, -932.3016437312655, -614.6595939800584, -536.4521534334979, -401.0565983900857, -735.497953612034, -1186.642378836706, -728.6278433915107, -832.3646724203976, -664.031553164132, -621.1268227183493, -360.4635582382683, -783.908098890003, -816.2804678552773, -598.5624720922849, -821.8618812052129, -798.6359594142689, -914.7550554229312, -907.387398828879, -806.032838220834, -853.2777366222037, -535.9236276345816, -668.3005809784493, -817.6324127460357, -575.5426486006425, -844.338362443564, -987.9638919071522, -964.0078814003056, -575.0411396747068, -486.9990873779783, -810.4021681023249, -1020.3625499691664, -788.4657366836122, -1059.1970154748042, -491.5507545100828, -538.8076432084302, -802.9904993100657, -483.486963464396, -1093.3772423579098], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 21.10299939653551, "mean_inference_ms": 0.4009416569881449, "mean_action_processing_ms": 0.09577519496930721, "mean_env_wait_ms": 2.980146755536937, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003936052322387695, "StateBufferConnector_ms": 0.002730846405029297, "ViewRequirementAgentConnector_ms": 0.06781840324401855}}, "episode_reward_max": -360.4635582382683, "episode_reward_min": -1187.195266104132, "episode_reward_mean": -763.4211954783921, "episode_len_mean": 120.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-785.5092317718627, -1097.893224576639, -923.7516345999588, -513.116572422542, -1046.5206012100732, -1020.8328057930153, -707.6916014324142, -508.93865667299724, -585.2377905999639, -602.8732502128115, -621.085564677536, -807.4221345714965, -733.8959402616267, -504.9023758256783, -535.227544086126, -830.7463345760563, -869.2392853804182, -688.2975757953916, -855.6557076104586, -816.4590930873079, -852.585947072578, -818.8534892446769, -1067.7114821321316, -1009.8088852877822, -930.6718950336667, -871.2061796795947, -888.2774470322815, -1020.9996023005622, -740.0716080267732, -746.3443956394477, -732.832450643513, -720.7381223943072, -652.5513813574496, -998.0419556137812, -470.3559029456608, -662.6675667572466, -474.8680286616357, -580.8105718120331, -570.1662877820227, -1178.8451275361977, -858.7163013056644, -694.8156343944005, -452.7068189820576, -608.3456158256217, -750.660993351937, -1045.2173286787524, -833.3557270235104, -787.2133332024458, -808.0492994819223, -539.7716950499627, -750.3821065654046, -666.5525706335234, -795.5260674886666, -1187.195266104132, -646.8361095209852, -1149.905236052508, -801.2423149206337, -684.6117348729066, -792.8103939927032, -526.157539044346, -689.7443666324847, -770.2809562845098, -932.3016437312655, -614.6595939800584, -536.4521534334979, -401.0565983900857, -735.497953612034, -1186.642378836706, -728.6278433915107, -832.3646724203976, -664.031553164132, -621.1268227183493, -360.4635582382683, -783.908098890003, -816.2804678552773, -598.5624720922849, -821.8618812052129, -798.6359594142689, -914.7550554229312, -907.387398828879, -806.032838220834, -853.2777366222037, -535.9236276345816, -668.3005809784493, -817.6324127460357, -575.5426486006425, -844.338362443564, -987.9638919071522, -964.0078814003056, -575.0411396747068, -486.9990873779783, -810.4021681023249, -1020.3625499691664, -788.4657366836122, -1059.1970154748042, -491.5507545100828, -538.8076432084302, -802.9904993100657, -483.486963464396, -1093.3772423579098], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 21.10299939653551, "mean_inference_ms": 0.4009416569881449, "mean_action_processing_ms": 0.09577519496930721, "mean_env_wait_ms": 2.980146755536937, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003936052322387695, "StateBufferConnector_ms": 0.002730846405029297, "ViewRequirementAgentConnector_ms": 0.06781840324401855}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 235800, "num_agent_steps_trained": 235800, "num_env_steps_sampled": 235800, "num_env_steps_trained": 235800, "num_env_steps_sampled_this_iter": 480, "num_env_steps_trained_this_iter": 480, "num_env_steps_sampled_throughput_per_sec": 40.51278099966904, "num_env_steps_trained_throughput_per_sec": 40.51278099966904, "timesteps_total": 235800, "num_steps_trained_this_iter": 480, "agent_timesteps_total": 235800, "timers": {"training_iteration_time_ms": 2929.108, "sample_time_ms": 2925.302, "load_time_ms": 0.224, "load_throughput": 535386.108, "learn_time_ms": 2.823, "learn_throughput": 42509.838, "synch_weights_time_ms": 0.717}, "counters": {"num_env_steps_sampled": 235800, "num_env_steps_trained": 235800, "num_agent_steps_sampled": 235800, "num_agent_steps_trained": 235800}, "done": false, "episodes_total": 1965, "training_iteration": 492, "trial_id": "29a31_00000", "date": "2023-07-26_02-29-07", "timestamp": 1690327747, "time_this_iter_s": 11.850810050964355, "time_total_s": 5994.549891471863, "pid": 90822, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 1, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[253680, 5e-06], [256080, 5e-06], [258480, 2.5e-06], [260880, 2.5e-06], [263280, 2.5e-06], [265680, 2.5e-06], [268080, 1e-06], [270480, 1e-06], [272880, 1e-06], [275280, 5e-07], [277680, 5e-07], [280080, 5e-07], [282480, 5e-07], [284880, 5e-07], [287280, 1e-07], [289680, 1e-07], [292080, 1e-07]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 120, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x16ca65700>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 373.2244155406952, "iterations_since_restore": 32, "perf": {"cpu_util_percent": 38.087500000000006, "ram_util_percent": 76.025}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-07, "entropy_coeff": 0.05, "policy_entropy": 267.4436340332031, "policy_loss": -96266.4140625, "vf_loss": 4051354.75}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 131.0, "diff_num_grad_updates_vs_sampler_policy": 130.0}}, "num_env_steps_sampled": 236280, "num_env_steps_trained": 236280, "num_agent_steps_sampled": 236280, "num_agent_steps_trained": 236280}, "sampler_results": {"episode_reward_max": -360.4635582382683, "episode_reward_min": -1187.195266104132, "episode_reward_mean": -761.05219543786, "episode_len_mean": 120.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1046.5206012100732, -1020.8328057930153, -707.6916014324142, -508.93865667299724, -585.2377905999639, -602.8732502128115, -621.085564677536, -807.4221345714965, -733.8959402616267, -504.9023758256783, -535.227544086126, -830.7463345760563, -869.2392853804182, -688.2975757953916, -855.6557076104586, -816.4590930873079, -852.585947072578, -818.8534892446769, -1067.7114821321316, -1009.8088852877822, -930.6718950336667, -871.2061796795947, -888.2774470322815, -1020.9996023005622, -740.0716080267732, -746.3443956394477, -732.832450643513, -720.7381223943072, -652.5513813574496, -998.0419556137812, -470.3559029456608, -662.6675667572466, -474.8680286616357, -580.8105718120331, -570.1662877820227, -1178.8451275361977, -858.7163013056644, -694.8156343944005, -452.7068189820576, -608.3456158256217, -750.660993351937, -1045.2173286787524, -833.3557270235104, -787.2133332024458, -808.0492994819223, -539.7716950499627, -750.3821065654046, -666.5525706335234, -795.5260674886666, -1187.195266104132, -646.8361095209852, -1149.905236052508, -801.2423149206337, -684.6117348729066, -792.8103939927032, -526.157539044346, -689.7443666324847, -770.2809562845098, -932.3016437312655, -614.6595939800584, -536.4521534334979, -401.0565983900857, -735.497953612034, -1186.642378836706, -728.6278433915107, -832.3646724203976, -664.031553164132, -621.1268227183493, -360.4635582382683, -783.908098890003, -816.2804678552773, -598.5624720922849, -821.8618812052129, -798.6359594142689, -914.7550554229312, -907.387398828879, -806.032838220834, -853.2777366222037, -535.9236276345816, -668.3005809784493, -817.6324127460357, -575.5426486006425, -844.338362443564, -987.9638919071522, -964.0078814003056, -575.0411396747068, -486.9990873779783, -810.4021681023249, -1020.3625499691664, -788.4657366836122, -1059.1970154748042, -491.5507545100828, -538.8076432084302, -802.9904993100657, -483.486963464396, -1093.3772423579098, -1154.7176883418608, -679.809950071456, -628.7414875841309, -620.1015333203428], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 21.09994181954067, "mean_inference_ms": 0.4009143908764111, "mean_action_processing_ms": 0.09576825278912633, "mean_env_wait_ms": 2.9590057829408805, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003977298736572266, "StateBufferConnector_ms": 0.0027468204498291016, "ViewRequirementAgentConnector_ms": 0.0681462287902832}}, "episode_reward_max": -360.4635582382683, "episode_reward_min": -1187.195266104132, "episode_reward_mean": -761.05219543786, "episode_len_mean": 120.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1046.5206012100732, -1020.8328057930153, -707.6916014324142, -508.93865667299724, -585.2377905999639, -602.8732502128115, -621.085564677536, -807.4221345714965, -733.8959402616267, -504.9023758256783, -535.227544086126, -830.7463345760563, -869.2392853804182, -688.2975757953916, -855.6557076104586, -816.4590930873079, -852.585947072578, -818.8534892446769, -1067.7114821321316, -1009.8088852877822, -930.6718950336667, -871.2061796795947, -888.2774470322815, -1020.9996023005622, -740.0716080267732, -746.3443956394477, -732.832450643513, -720.7381223943072, -652.5513813574496, -998.0419556137812, -470.3559029456608, -662.6675667572466, -474.8680286616357, -580.8105718120331, -570.1662877820227, -1178.8451275361977, -858.7163013056644, -694.8156343944005, -452.7068189820576, -608.3456158256217, -750.660993351937, -1045.2173286787524, -833.3557270235104, -787.2133332024458, -808.0492994819223, -539.7716950499627, -750.3821065654046, -666.5525706335234, -795.5260674886666, -1187.195266104132, -646.8361095209852, -1149.905236052508, -801.2423149206337, -684.6117348729066, -792.8103939927032, -526.157539044346, -689.7443666324847, -770.2809562845098, -932.3016437312655, -614.6595939800584, -536.4521534334979, -401.0565983900857, -735.497953612034, -1186.642378836706, -728.6278433915107, -832.3646724203976, -664.031553164132, -621.1268227183493, -360.4635582382683, -783.908098890003, -816.2804678552773, -598.5624720922849, -821.8618812052129, -798.6359594142689, -914.7550554229312, -907.387398828879, -806.032838220834, -853.2777366222037, -535.9236276345816, -668.3005809784493, -817.6324127460357, -575.5426486006425, -844.338362443564, -987.9638919071522, -964.0078814003056, -575.0411396747068, -486.9990873779783, -810.4021681023249, -1020.3625499691664, -788.4657366836122, -1059.1970154748042, -491.5507545100828, -538.8076432084302, -802.9904993100657, -483.486963464396, -1093.3772423579098, -1154.7176883418608, -679.809950071456, -628.7414875841309, -620.1015333203428], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 21.09994181954067, "mean_inference_ms": 0.4009143908764111, "mean_action_processing_ms": 0.09576825278912633, "mean_env_wait_ms": 2.9590057829408805, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003977298736572266, "StateBufferConnector_ms": 0.0027468204498291016, "ViewRequirementAgentConnector_ms": 0.0681462287902832}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 236280, "num_agent_steps_trained": 236280, "num_env_steps_sampled": 236280, "num_env_steps_trained": 236280, "num_env_steps_sampled_this_iter": 480, "num_env_steps_trained_this_iter": 480, "num_env_steps_sampled_throughput_per_sec": 40.60432390024313, "num_env_steps_trained_throughput_per_sec": 40.60432390024313, "timesteps_total": 236280, "num_steps_trained_this_iter": 480, "agent_timesteps_total": 236280, "timers": {"training_iteration_time_ms": 2947.367, "sample_time_ms": 2943.479, "load_time_ms": 0.228, "load_throughput": 525218.074, "learn_time_ms": 2.896, "learn_throughput": 41429.999, "synch_weights_time_ms": 0.716}, "counters": {"num_env_steps_sampled": 236280, "num_env_steps_trained": 236280, "num_agent_steps_sampled": 236280, "num_agent_steps_trained": 236280}, "done": false, "episodes_total": 1969, "training_iteration": 493, "trial_id": "29a31_00000", "date": "2023-07-26_02-29-19", "timestamp": 1690327759, "time_this_iter_s": 11.824265956878662, "time_total_s": 6006.3741574287415, "pid": 90822, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 1, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[253680, 5e-06], [256080, 5e-06], [258480, 2.5e-06], [260880, 2.5e-06], [263280, 2.5e-06], [265680, 2.5e-06], [268080, 1e-06], [270480, 1e-06], [272880, 1e-06], [275280, 5e-07], [277680, 5e-07], [280080, 5e-07], [282480, 5e-07], [284880, 5e-07], [287280, 1e-07], [289680, 1e-07], [292080, 1e-07]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 120, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x16ca65700>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 385.04868149757385, "iterations_since_restore": 33, "perf": {"cpu_util_percent": 36.87058823529412, "ram_util_percent": 78.62941176470589}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-07, "entropy_coeff": 0.05, "policy_entropy": 267.4661865234375, "policy_loss": -71623.78125, "vf_loss": 2436239.75}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 135.0, "diff_num_grad_updates_vs_sampler_policy": 134.0}}, "num_env_steps_sampled": 236760, "num_env_steps_trained": 236760, "num_agent_steps_sampled": 236760, "num_agent_steps_trained": 236760}, "sampler_results": {"episode_reward_max": -360.4635582382683, "episode_reward_min": -1187.195266104132, "episode_reward_mean": -753.5786341188558, "episode_len_mean": 120.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-585.2377905999639, -602.8732502128115, -621.085564677536, -807.4221345714965, -733.8959402616267, -504.9023758256783, -535.227544086126, -830.7463345760563, -869.2392853804182, -688.2975757953916, -855.6557076104586, -816.4590930873079, -852.585947072578, -818.8534892446769, -1067.7114821321316, -1009.8088852877822, -930.6718950336667, -871.2061796795947, -888.2774470322815, -1020.9996023005622, -740.0716080267732, -746.3443956394477, -732.832450643513, -720.7381223943072, -652.5513813574496, -998.0419556137812, -470.3559029456608, -662.6675667572466, -474.8680286616357, -580.8105718120331, -570.1662877820227, -1178.8451275361977, -858.7163013056644, -694.8156343944005, -452.7068189820576, -608.3456158256217, -750.660993351937, -1045.2173286787524, -833.3557270235104, -787.2133332024458, -808.0492994819223, -539.7716950499627, -750.3821065654046, -666.5525706335234, -795.5260674886666, -1187.195266104132, -646.8361095209852, -1149.905236052508, -801.2423149206337, -684.6117348729066, -792.8103939927032, -526.157539044346, -689.7443666324847, -770.2809562845098, -932.3016437312655, -614.6595939800584, -536.4521534334979, -401.0565983900857, -735.497953612034, -1186.642378836706, -728.6278433915107, -832.3646724203976, -664.031553164132, -621.1268227183493, -360.4635582382683, -783.908098890003, -816.2804678552773, -598.5624720922849, -821.8618812052129, -798.6359594142689, -914.7550554229312, -907.387398828879, -806.032838220834, -853.2777366222037, -535.9236276345816, -668.3005809784493, -817.6324127460357, -575.5426486006425, -844.338362443564, -987.9638919071522, -964.0078814003056, -575.0411396747068, -486.9990873779783, -810.4021681023249, -1020.3625499691664, -788.4657366836122, -1059.1970154748042, -491.5507545100828, -538.8076432084302, -802.9904993100657, -483.486963464396, -1093.3772423579098, -1154.7176883418608, -679.809950071456, -628.7414875841309, -620.1015333203428, -690.1998822665496, -565.2021177932787, -633.5753863466925, -647.6501468015776], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 21.096977185850776, "mean_inference_ms": 0.4009286046649085, "mean_action_processing_ms": 0.0957656608414741, "mean_env_wait_ms": 2.940861012601315, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003976106643676758, "StateBufferConnector_ms": 0.0027511119842529297, "ViewRequirementAgentConnector_ms": 0.06811857223510742}}, "episode_reward_max": -360.4635582382683, "episode_reward_min": -1187.195266104132, "episode_reward_mean": -753.5786341188558, "episode_len_mean": 120.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-585.2377905999639, -602.8732502128115, -621.085564677536, -807.4221345714965, -733.8959402616267, -504.9023758256783, -535.227544086126, -830.7463345760563, -869.2392853804182, -688.2975757953916, -855.6557076104586, -816.4590930873079, -852.585947072578, -818.8534892446769, -1067.7114821321316, -1009.8088852877822, -930.6718950336667, -871.2061796795947, -888.2774470322815, -1020.9996023005622, -740.0716080267732, -746.3443956394477, -732.832450643513, -720.7381223943072, -652.5513813574496, -998.0419556137812, -470.3559029456608, -662.6675667572466, -474.8680286616357, -580.8105718120331, -570.1662877820227, -1178.8451275361977, -858.7163013056644, -694.8156343944005, -452.7068189820576, -608.3456158256217, -750.660993351937, -1045.2173286787524, -833.3557270235104, -787.2133332024458, -808.0492994819223, -539.7716950499627, -750.3821065654046, -666.5525706335234, -795.5260674886666, -1187.195266104132, -646.8361095209852, -1149.905236052508, -801.2423149206337, -684.6117348729066, -792.8103939927032, -526.157539044346, -689.7443666324847, -770.2809562845098, -932.3016437312655, -614.6595939800584, -536.4521534334979, -401.0565983900857, -735.497953612034, -1186.642378836706, -728.6278433915107, -832.3646724203976, -664.031553164132, -621.1268227183493, -360.4635582382683, -783.908098890003, -816.2804678552773, -598.5624720922849, -821.8618812052129, -798.6359594142689, -914.7550554229312, -907.387398828879, -806.032838220834, -853.2777366222037, -535.9236276345816, -668.3005809784493, -817.6324127460357, -575.5426486006425, -844.338362443564, -987.9638919071522, -964.0078814003056, -575.0411396747068, -486.9990873779783, -810.4021681023249, -1020.3625499691664, -788.4657366836122, -1059.1970154748042, -491.5507545100828, -538.8076432084302, -802.9904993100657, -483.486963464396, -1093.3772423579098, -1154.7176883418608, -679.809950071456, -628.7414875841309, -620.1015333203428, -690.1998822665496, -565.2021177932787, -633.5753863466925, -647.6501468015776], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 21.096977185850776, "mean_inference_ms": 0.4009286046649085, "mean_action_processing_ms": 0.0957656608414741, "mean_env_wait_ms": 2.940861012601315, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003976106643676758, "StateBufferConnector_ms": 0.0027511119842529297, "ViewRequirementAgentConnector_ms": 0.06811857223510742}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 236760, "num_agent_steps_trained": 236760, "num_env_steps_sampled": 236760, "num_env_steps_trained": 236760, "num_env_steps_sampled_this_iter": 480, "num_env_steps_trained_this_iter": 480, "num_env_steps_sampled_throughput_per_sec": 41.7226116198228, "num_env_steps_trained_throughput_per_sec": 41.7226116198228, "timesteps_total": 236760, "num_steps_trained_this_iter": 480, "agent_timesteps_total": 236760, "timers": {"training_iteration_time_ms": 2932.437, "sample_time_ms": 2928.542, "load_time_ms": 0.227, "load_throughput": 528139.014, "learn_time_ms": 2.894, "learn_throughput": 41463.446, "synch_weights_time_ms": 0.727}, "counters": {"num_env_steps_sampled": 236760, "num_env_steps_trained": 236760, "num_agent_steps_sampled": 236760, "num_agent_steps_trained": 236760}, "done": false, "episodes_total": 1973, "training_iteration": 494, "trial_id": "29a31_00000", "date": "2023-07-26_02-29-30", "timestamp": 1690327770, "time_this_iter_s": 11.507291316986084, "time_total_s": 6017.8814487457275, "pid": 90822, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 1, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[253680, 5e-06], [256080, 5e-06], [258480, 2.5e-06], [260880, 2.5e-06], [263280, 2.5e-06], [265680, 2.5e-06], [268080, 1e-06], [270480, 1e-06], [272880, 1e-06], [275280, 5e-07], [277680, 5e-07], [280080, 5e-07], [282480, 5e-07], [284880, 5e-07], [287280, 1e-07], [289680, 1e-07], [292080, 1e-07]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 120, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x16ca65700>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 396.55597281455994, "iterations_since_restore": 34, "perf": {"cpu_util_percent": 30.806250000000002, "ram_util_percent": 76.1625}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-07, "entropy_coeff": 0.05, "policy_entropy": 267.4445495605469, "policy_loss": -123393.2734375, "vf_loss": 6454417.5}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 139.0, "diff_num_grad_updates_vs_sampler_policy": 138.0}}, "num_env_steps_sampled": 237240, "num_env_steps_trained": 237240, "num_agent_steps_sampled": 237240, "num_agent_steps_trained": 237240}, "sampler_results": {"episode_reward_max": -360.4635582382683, "episode_reward_min": -1247.5517022468086, "episode_reward_mean": -764.1331426122588, "episode_len_mean": 120.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-733.8959402616267, -504.9023758256783, -535.227544086126, -830.7463345760563, -869.2392853804182, -688.2975757953916, -855.6557076104586, -816.4590930873079, -852.585947072578, -818.8534892446769, -1067.7114821321316, -1009.8088852877822, -930.6718950336667, -871.2061796795947, -888.2774470322815, -1020.9996023005622, -740.0716080267732, -746.3443956394477, -732.832450643513, -720.7381223943072, -652.5513813574496, -998.0419556137812, -470.3559029456608, -662.6675667572466, -474.8680286616357, -580.8105718120331, -570.1662877820227, -1178.8451275361977, -858.7163013056644, -694.8156343944005, -452.7068189820576, -608.3456158256217, -750.660993351937, -1045.2173286787524, -833.3557270235104, -787.2133332024458, -808.0492994819223, -539.7716950499627, -750.3821065654046, -666.5525706335234, -795.5260674886666, -1187.195266104132, -646.8361095209852, -1149.905236052508, -801.2423149206337, -684.6117348729066, -792.8103939927032, -526.157539044346, -689.7443666324847, -770.2809562845098, -932.3016437312655, -614.6595939800584, -536.4521534334979, -401.0565983900857, -735.497953612034, -1186.642378836706, -728.6278433915107, -832.3646724203976, -664.031553164132, -621.1268227183493, -360.4635582382683, -783.908098890003, -816.2804678552773, -598.5624720922849, -821.8618812052129, -798.6359594142689, -914.7550554229312, -907.387398828879, -806.032838220834, -853.2777366222037, -535.9236276345816, -668.3005809784493, -817.6324127460357, -575.5426486006425, -844.338362443564, -987.9638919071522, -964.0078814003056, -575.0411396747068, -486.9990873779783, -810.4021681023249, -1020.3625499691664, -788.4657366836122, -1059.1970154748042, -491.5507545100828, -538.8076432084302, -802.9904993100657, -483.486963464396, -1093.3772423579098, -1154.7176883418608, -679.809950071456, -628.7414875841309, -620.1015333203428, -690.1998822665496, -565.2021177932787, -633.5753863466925, -647.6501468015776, -1247.5517022468086, -990.2846551648403, -554.2219541785735, -880.0112778118812], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 21.09415176777574, "mean_inference_ms": 0.40096686195531867, "mean_action_processing_ms": 0.09576813496948686, "mean_env_wait_ms": 2.9247094306927512, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003971099853515625, "StateBufferConnector_ms": 0.002759695053100586, "ViewRequirementAgentConnector_ms": 0.06807160377502441}}, "episode_reward_max": -360.4635582382683, "episode_reward_min": -1247.5517022468086, "episode_reward_mean": -764.1331426122588, "episode_len_mean": 120.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-733.8959402616267, -504.9023758256783, -535.227544086126, -830.7463345760563, -869.2392853804182, -688.2975757953916, -855.6557076104586, -816.4590930873079, -852.585947072578, -818.8534892446769, -1067.7114821321316, -1009.8088852877822, -930.6718950336667, -871.2061796795947, -888.2774470322815, -1020.9996023005622, -740.0716080267732, -746.3443956394477, -732.832450643513, -720.7381223943072, -652.5513813574496, -998.0419556137812, -470.3559029456608, -662.6675667572466, -474.8680286616357, -580.8105718120331, -570.1662877820227, -1178.8451275361977, -858.7163013056644, -694.8156343944005, -452.7068189820576, -608.3456158256217, -750.660993351937, -1045.2173286787524, -833.3557270235104, -787.2133332024458, -808.0492994819223, -539.7716950499627, -750.3821065654046, -666.5525706335234, -795.5260674886666, -1187.195266104132, -646.8361095209852, -1149.905236052508, -801.2423149206337, -684.6117348729066, -792.8103939927032, -526.157539044346, -689.7443666324847, -770.2809562845098, -932.3016437312655, -614.6595939800584, -536.4521534334979, -401.0565983900857, -735.497953612034, -1186.642378836706, -728.6278433915107, -832.3646724203976, -664.031553164132, -621.1268227183493, -360.4635582382683, -783.908098890003, -816.2804678552773, -598.5624720922849, -821.8618812052129, -798.6359594142689, -914.7550554229312, -907.387398828879, -806.032838220834, -853.2777366222037, -535.9236276345816, -668.3005809784493, -817.6324127460357, -575.5426486006425, -844.338362443564, -987.9638919071522, -964.0078814003056, -575.0411396747068, -486.9990873779783, -810.4021681023249, -1020.3625499691664, -788.4657366836122, -1059.1970154748042, -491.5507545100828, -538.8076432084302, -802.9904993100657, -483.486963464396, -1093.3772423579098, -1154.7176883418608, -679.809950071456, -628.7414875841309, -620.1015333203428, -690.1998822665496, -565.2021177932787, -633.5753863466925, -647.6501468015776, -1247.5517022468086, -990.2846551648403, -554.2219541785735, -880.0112778118812], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 21.09415176777574, "mean_inference_ms": 0.40096686195531867, "mean_action_processing_ms": 0.09576813496948686, "mean_env_wait_ms": 2.9247094306927512, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003971099853515625, "StateBufferConnector_ms": 0.002759695053100586, "ViewRequirementAgentConnector_ms": 0.06807160377502441}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 237240, "num_agent_steps_trained": 237240, "num_env_steps_sampled": 237240, "num_env_steps_trained": 237240, "num_env_steps_sampled_this_iter": 480, "num_env_steps_trained_this_iter": 480, "num_env_steps_sampled_throughput_per_sec": 41.87788847500501, "num_env_steps_trained_throughput_per_sec": 41.87788847500501, "timesteps_total": 237240, "num_steps_trained_this_iter": 480, "agent_timesteps_total": 237240, "timers": {"training_iteration_time_ms": 2877.899, "sample_time_ms": 2873.987, "load_time_ms": 0.228, "load_throughput": 525986.498, "learn_time_ms": 2.903, "learn_throughput": 41333.712, "synch_weights_time_ms": 0.734}, "counters": {"num_env_steps_sampled": 237240, "num_env_steps_trained": 237240, "num_agent_steps_sampled": 237240, "num_agent_steps_trained": 237240}, "done": false, "episodes_total": 1977, "training_iteration": 495, "trial_id": "29a31_00000", "date": "2023-07-26_02-29-42", "timestamp": 1690327782, "time_this_iter_s": 11.465054988861084, "time_total_s": 6029.346503734589, "pid": 90822, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 1, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[253680, 5e-06], [256080, 5e-06], [258480, 2.5e-06], [260880, 2.5e-06], [263280, 2.5e-06], [265680, 2.5e-06], [268080, 1e-06], [270480, 1e-06], [272880, 1e-06], [275280, 5e-07], [277680, 5e-07], [280080, 5e-07], [282480, 5e-07], [284880, 5e-07], [287280, 1e-07], [289680, 1e-07], [292080, 1e-07]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 120, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x16ca65700>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 408.021027803421, "iterations_since_restore": 35, "perf": {"cpu_util_percent": 34.63529411764706, "ram_util_percent": 74.1470588235294}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-07, "entropy_coeff": 0.05, "policy_entropy": 267.4358825683594, "policy_loss": -66031.984375, "vf_loss": 1753976.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 143.0, "diff_num_grad_updates_vs_sampler_policy": 142.0}}, "num_env_steps_sampled": 237720, "num_env_steps_trained": 237720, "num_agent_steps_sampled": 237720, "num_agent_steps_trained": 237720}, "sampler_results": {"episode_reward_max": -360.4635582382683, "episode_reward_min": -1247.5517022468086, "episode_reward_mean": -764.4256453840422, "episode_len_mean": 120.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-869.2392853804182, -688.2975757953916, -855.6557076104586, -816.4590930873079, -852.585947072578, -818.8534892446769, -1067.7114821321316, -1009.8088852877822, -930.6718950336667, -871.2061796795947, -888.2774470322815, -1020.9996023005622, -740.0716080267732, -746.3443956394477, -732.832450643513, -720.7381223943072, -652.5513813574496, -998.0419556137812, -470.3559029456608, -662.6675667572466, -474.8680286616357, -580.8105718120331, -570.1662877820227, -1178.8451275361977, -858.7163013056644, -694.8156343944005, -452.7068189820576, -608.3456158256217, -750.660993351937, -1045.2173286787524, -833.3557270235104, -787.2133332024458, -808.0492994819223, -539.7716950499627, -750.3821065654046, -666.5525706335234, -795.5260674886666, -1187.195266104132, -646.8361095209852, -1149.905236052508, -801.2423149206337, -684.6117348729066, -792.8103939927032, -526.157539044346, -689.7443666324847, -770.2809562845098, -932.3016437312655, -614.6595939800584, -536.4521534334979, -401.0565983900857, -735.497953612034, -1186.642378836706, -728.6278433915107, -832.3646724203976, -664.031553164132, -621.1268227183493, -360.4635582382683, -783.908098890003, -816.2804678552773, -598.5624720922849, -821.8618812052129, -798.6359594142689, -914.7550554229312, -907.387398828879, -806.032838220834, -853.2777366222037, -535.9236276345816, -668.3005809784493, -817.6324127460357, -575.5426486006425, -844.338362443564, -987.9638919071522, -964.0078814003056, -575.0411396747068, -486.9990873779783, -810.4021681023249, -1020.3625499691664, -788.4657366836122, -1059.1970154748042, -491.5507545100828, -538.8076432084302, -802.9904993100657, -483.486963464396, -1093.3772423579098, -1154.7176883418608, -679.809950071456, -628.7414875841309, -620.1015333203428, -690.1998822665496, -565.2021177932787, -633.5753863466925, -647.6501468015776, -1247.5517022468086, -990.2846551648403, -554.2219541785735, -880.0112778118812, -743.7017521335646, -531.721159893199, -807.166822801979, -551.432737099075], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 21.089992650484714, "mean_inference_ms": 0.400985694030614, "mean_action_processing_ms": 0.09576717305270911, "mean_env_wait_ms": 2.910109550857513, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0039746761322021484, "StateBufferConnector_ms": 0.002750873565673828, "ViewRequirementAgentConnector_ms": 0.0681159496307373}}, "episode_reward_max": -360.4635582382683, "episode_reward_min": -1247.5517022468086, "episode_reward_mean": -764.4256453840422, "episode_len_mean": 120.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-869.2392853804182, -688.2975757953916, -855.6557076104586, -816.4590930873079, -852.585947072578, -818.8534892446769, -1067.7114821321316, -1009.8088852877822, -930.6718950336667, -871.2061796795947, -888.2774470322815, -1020.9996023005622, -740.0716080267732, -746.3443956394477, -732.832450643513, -720.7381223943072, -652.5513813574496, -998.0419556137812, -470.3559029456608, -662.6675667572466, -474.8680286616357, -580.8105718120331, -570.1662877820227, -1178.8451275361977, -858.7163013056644, -694.8156343944005, -452.7068189820576, -608.3456158256217, -750.660993351937, -1045.2173286787524, -833.3557270235104, -787.2133332024458, -808.0492994819223, -539.7716950499627, -750.3821065654046, -666.5525706335234, -795.5260674886666, -1187.195266104132, -646.8361095209852, -1149.905236052508, -801.2423149206337, -684.6117348729066, -792.8103939927032, -526.157539044346, -689.7443666324847, -770.2809562845098, -932.3016437312655, -614.6595939800584, -536.4521534334979, -401.0565983900857, -735.497953612034, -1186.642378836706, -728.6278433915107, -832.3646724203976, -664.031553164132, -621.1268227183493, -360.4635582382683, -783.908098890003, -816.2804678552773, -598.5624720922849, -821.8618812052129, -798.6359594142689, -914.7550554229312, -907.387398828879, -806.032838220834, -853.2777366222037, -535.9236276345816, -668.3005809784493, -817.6324127460357, -575.5426486006425, -844.338362443564, -987.9638919071522, -964.0078814003056, -575.0411396747068, -486.9990873779783, -810.4021681023249, -1020.3625499691664, -788.4657366836122, -1059.1970154748042, -491.5507545100828, -538.8076432084302, -802.9904993100657, -483.486963464396, -1093.3772423579098, -1154.7176883418608, -679.809950071456, -628.7414875841309, -620.1015333203428, -690.1998822665496, -565.2021177932787, -633.5753863466925, -647.6501468015776, -1247.5517022468086, -990.2846551648403, -554.2219541785735, -880.0112778118812, -743.7017521335646, -531.721159893199, -807.166822801979, -551.432737099075], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 21.089992650484714, "mean_inference_ms": 0.400985694030614, "mean_action_processing_ms": 0.09576717305270911, "mean_env_wait_ms": 2.910109550857513, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0039746761322021484, "StateBufferConnector_ms": 0.002750873565673828, "ViewRequirementAgentConnector_ms": 0.0681159496307373}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 237720, "num_agent_steps_trained": 237720, "num_env_steps_sampled": 237720, "num_env_steps_trained": 237720, "num_env_steps_sampled_this_iter": 480, "num_env_steps_trained_this_iter": 480, "num_env_steps_sampled_throughput_per_sec": 41.109824366823865, "num_env_steps_trained_throughput_per_sec": 41.109824366823865, "timesteps_total": 237720, "num_steps_trained_this_iter": 480, "agent_timesteps_total": 237720, "timers": {"training_iteration_time_ms": 2893.258, "sample_time_ms": 2889.451, "load_time_ms": 0.222, "load_throughput": 540619.205, "learn_time_ms": 2.828, "learn_throughput": 42428.135, "synch_weights_time_ms": 0.716}, "counters": {"num_env_steps_sampled": 237720, "num_env_steps_trained": 237720, "num_agent_steps_sampled": 237720, "num_agent_steps_trained": 237720}, "done": false, "episodes_total": 1981, "training_iteration": 496, "trial_id": "29a31_00000", "date": "2023-07-26_02-29-53", "timestamp": 1690327793, "time_this_iter_s": 11.67864179611206, "time_total_s": 6041.025145530701, "pid": 90822, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 1, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[253680, 5e-06], [256080, 5e-06], [258480, 2.5e-06], [260880, 2.5e-06], [263280, 2.5e-06], [265680, 2.5e-06], [268080, 1e-06], [270480, 1e-06], [272880, 1e-06], [275280, 5e-07], [277680, 5e-07], [280080, 5e-07], [282480, 5e-07], [284880, 5e-07], [287280, 1e-07], [289680, 1e-07], [292080, 1e-07]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 120, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x16ca65700>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 419.6996695995331, "iterations_since_restore": 36, "perf": {"cpu_util_percent": 37.70625, "ram_util_percent": 73.54374999999999}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-07, "entropy_coeff": 0.05, "policy_entropy": 267.45001220703125, "policy_loss": -135812.84375, "vf_loss": 8306440.5}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 147.0, "diff_num_grad_updates_vs_sampler_policy": 146.0}}, "num_env_steps_sampled": 238200, "num_env_steps_trained": 238200, "num_agent_steps_sampled": 238200, "num_agent_steps_trained": 238200}, "sampler_results": {"episode_reward_max": -360.4635582382683, "episode_reward_min": -1247.5517022468086, "episode_reward_mean": -765.7433641671907, "episode_len_mean": 120.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-852.585947072578, -818.8534892446769, -1067.7114821321316, -1009.8088852877822, -930.6718950336667, -871.2061796795947, -888.2774470322815, -1020.9996023005622, -740.0716080267732, -746.3443956394477, -732.832450643513, -720.7381223943072, -652.5513813574496, -998.0419556137812, -470.3559029456608, -662.6675667572466, -474.8680286616357, -580.8105718120331, -570.1662877820227, -1178.8451275361977, -858.7163013056644, -694.8156343944005, -452.7068189820576, -608.3456158256217, -750.660993351937, -1045.2173286787524, -833.3557270235104, -787.2133332024458, -808.0492994819223, -539.7716950499627, -750.3821065654046, -666.5525706335234, -795.5260674886666, -1187.195266104132, -646.8361095209852, -1149.905236052508, -801.2423149206337, -684.6117348729066, -792.8103939927032, -526.157539044346, -689.7443666324847, -770.2809562845098, -932.3016437312655, -614.6595939800584, -536.4521534334979, -401.0565983900857, -735.497953612034, -1186.642378836706, -728.6278433915107, -832.3646724203976, -664.031553164132, -621.1268227183493, -360.4635582382683, -783.908098890003, -816.2804678552773, -598.5624720922849, -821.8618812052129, -798.6359594142689, -914.7550554229312, -907.387398828879, -806.032838220834, -853.2777366222037, -535.9236276345816, -668.3005809784493, -817.6324127460357, -575.5426486006425, -844.338362443564, -987.9638919071522, -964.0078814003056, -575.0411396747068, -486.9990873779783, -810.4021681023249, -1020.3625499691664, -788.4657366836122, -1059.1970154748042, -491.5507545100828, -538.8076432084302, -802.9904993100657, -483.486963464396, -1093.3772423579098, -1154.7176883418608, -679.809950071456, -628.7414875841309, -620.1015333203428, -690.1998822665496, -565.2021177932787, -633.5753863466925, -647.6501468015776, -1247.5517022468086, -990.2846551648403, -554.2219541785735, -880.0112778118812, -743.7017521335646, -531.721159893199, -807.166822801979, -551.432737099075, -890.643322597953, -822.2198866915962, -710.9860813596496, -937.5742495392379], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 21.087576423940927, "mean_inference_ms": 0.4010029844005777, "mean_action_processing_ms": 0.09576568795808027, "mean_env_wait_ms": 2.8972402472436225, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00398564338684082, "StateBufferConnector_ms": 0.002749919891357422, "ViewRequirementAgentConnector_ms": 0.06817245483398438}}, "episode_reward_max": -360.4635582382683, "episode_reward_min": -1247.5517022468086, "episode_reward_mean": -765.7433641671907, "episode_len_mean": 120.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-852.585947072578, -818.8534892446769, -1067.7114821321316, -1009.8088852877822, -930.6718950336667, -871.2061796795947, -888.2774470322815, -1020.9996023005622, -740.0716080267732, -746.3443956394477, -732.832450643513, -720.7381223943072, -652.5513813574496, -998.0419556137812, -470.3559029456608, -662.6675667572466, -474.8680286616357, -580.8105718120331, -570.1662877820227, -1178.8451275361977, -858.7163013056644, -694.8156343944005, -452.7068189820576, -608.3456158256217, -750.660993351937, -1045.2173286787524, -833.3557270235104, -787.2133332024458, -808.0492994819223, -539.7716950499627, -750.3821065654046, -666.5525706335234, -795.5260674886666, -1187.195266104132, -646.8361095209852, -1149.905236052508, -801.2423149206337, -684.6117348729066, -792.8103939927032, -526.157539044346, -689.7443666324847, -770.2809562845098, -932.3016437312655, -614.6595939800584, -536.4521534334979, -401.0565983900857, -735.497953612034, -1186.642378836706, -728.6278433915107, -832.3646724203976, -664.031553164132, -621.1268227183493, -360.4635582382683, -783.908098890003, -816.2804678552773, -598.5624720922849, -821.8618812052129, -798.6359594142689, -914.7550554229312, -907.387398828879, -806.032838220834, -853.2777366222037, -535.9236276345816, -668.3005809784493, -817.6324127460357, -575.5426486006425, -844.338362443564, -987.9638919071522, -964.0078814003056, -575.0411396747068, -486.9990873779783, -810.4021681023249, -1020.3625499691664, -788.4657366836122, -1059.1970154748042, -491.5507545100828, -538.8076432084302, -802.9904993100657, -483.486963464396, -1093.3772423579098, -1154.7176883418608, -679.809950071456, -628.7414875841309, -620.1015333203428, -690.1998822665496, -565.2021177932787, -633.5753863466925, -647.6501468015776, -1247.5517022468086, -990.2846551648403, -554.2219541785735, -880.0112778118812, -743.7017521335646, -531.721159893199, -807.166822801979, -551.432737099075, -890.643322597953, -822.2198866915962, -710.9860813596496, -937.5742495392379], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 21.087576423940927, "mean_inference_ms": 0.4010029844005777, "mean_action_processing_ms": 0.09576568795808027, "mean_env_wait_ms": 2.8972402472436225, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00398564338684082, "StateBufferConnector_ms": 0.002749919891357422, "ViewRequirementAgentConnector_ms": 0.06817245483398438}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 238200, "num_agent_steps_trained": 238200, "num_env_steps_sampled": 238200, "num_env_steps_trained": 238200, "num_env_steps_sampled_this_iter": 480, "num_env_steps_trained_this_iter": 480, "num_env_steps_sampled_throughput_per_sec": 40.26846658871791, "num_env_steps_trained_throughput_per_sec": 40.26846658871791, "timesteps_total": 238200, "num_steps_trained_this_iter": 480, "agent_timesteps_total": 238200, "timers": {"training_iteration_time_ms": 2929.557, "sample_time_ms": 2925.79, "load_time_ms": 0.222, "load_throughput": 539981.204, "learn_time_ms": 2.809, "learn_throughput": 42725.631, "synch_weights_time_ms": 0.696}, "counters": {"num_env_steps_sampled": 238200, "num_env_steps_trained": 238200, "num_agent_steps_sampled": 238200, "num_agent_steps_trained": 238200}, "done": false, "episodes_total": 1985, "training_iteration": 497, "trial_id": "29a31_00000", "date": "2023-07-26_02-30-05", "timestamp": 1690327805, "time_this_iter_s": 11.922637701034546, "time_total_s": 6052.947783231735, "pid": 90822, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 1, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[253680, 5e-06], [256080, 5e-06], [258480, 2.5e-06], [260880, 2.5e-06], [263280, 2.5e-06], [265680, 2.5e-06], [268080, 1e-06], [270480, 1e-06], [272880, 1e-06], [275280, 5e-07], [277680, 5e-07], [280080, 5e-07], [282480, 5e-07], [284880, 5e-07], [287280, 1e-07], [289680, 1e-07], [292080, 1e-07]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 120, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x16ca65700>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 431.6223073005676, "iterations_since_restore": 37, "perf": {"cpu_util_percent": 37.63529411764706, "ram_util_percent": 74.12941176470588}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-07, "entropy_coeff": 0.05, "policy_entropy": 267.4339294433594, "policy_loss": -94524.5234375, "vf_loss": 4526420.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 151.0, "diff_num_grad_updates_vs_sampler_policy": 150.0}}, "num_env_steps_sampled": 238680, "num_env_steps_trained": 238680, "num_agent_steps_sampled": 238680, "num_agent_steps_trained": 238680}, "sampler_results": {"episode_reward_max": -360.4635582382683, "episode_reward_min": -1247.5517022468086, "episode_reward_mean": -756.4743269995495, "episode_len_mean": 120.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-930.6718950336667, -871.2061796795947, -888.2774470322815, -1020.9996023005622, -740.0716080267732, -746.3443956394477, -732.832450643513, -720.7381223943072, -652.5513813574496, -998.0419556137812, -470.3559029456608, -662.6675667572466, -474.8680286616357, -580.8105718120331, -570.1662877820227, -1178.8451275361977, -858.7163013056644, -694.8156343944005, -452.7068189820576, -608.3456158256217, -750.660993351937, -1045.2173286787524, -833.3557270235104, -787.2133332024458, -808.0492994819223, -539.7716950499627, -750.3821065654046, -666.5525706335234, -795.5260674886666, -1187.195266104132, -646.8361095209852, -1149.905236052508, -801.2423149206337, -684.6117348729066, -792.8103939927032, -526.157539044346, -689.7443666324847, -770.2809562845098, -932.3016437312655, -614.6595939800584, -536.4521534334979, -401.0565983900857, -735.497953612034, -1186.642378836706, -728.6278433915107, -832.3646724203976, -664.031553164132, -621.1268227183493, -360.4635582382683, -783.908098890003, -816.2804678552773, -598.5624720922849, -821.8618812052129, -798.6359594142689, -914.7550554229312, -907.387398828879, -806.032838220834, -853.2777366222037, -535.9236276345816, -668.3005809784493, -817.6324127460357, -575.5426486006425, -844.338362443564, -987.9638919071522, -964.0078814003056, -575.0411396747068, -486.9990873779783, -810.4021681023249, -1020.3625499691664, -788.4657366836122, -1059.1970154748042, -491.5507545100828, -538.8076432084302, -802.9904993100657, -483.486963464396, -1093.3772423579098, -1154.7176883418608, -679.809950071456, -628.7414875841309, -620.1015333203428, -690.1998822665496, -565.2021177932787, -633.5753863466925, -647.6501468015776, -1247.5517022468086, -990.2846551648403, -554.2219541785735, -880.0112778118812, -743.7017521335646, -531.721159893199, -807.166822801979, -551.432737099075, -890.643322597953, -822.2198866915962, -710.9860813596496, -937.5742495392379, -662.4326357313347, -800.6691972778154, -658.2315142840092, -700.7227396798912], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 21.08620796957559, "mean_inference_ms": 0.40102522814406283, "mean_action_processing_ms": 0.09576580308359446, "mean_env_wait_ms": 2.8857187468215955, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003985881805419922, "StateBufferConnector_ms": 0.002756834030151367, "ViewRequirementAgentConnector_ms": 0.06817936897277832}}, "episode_reward_max": -360.4635582382683, "episode_reward_min": -1247.5517022468086, "episode_reward_mean": -756.4743269995495, "episode_len_mean": 120.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-930.6718950336667, -871.2061796795947, -888.2774470322815, -1020.9996023005622, -740.0716080267732, -746.3443956394477, -732.832450643513, -720.7381223943072, -652.5513813574496, -998.0419556137812, -470.3559029456608, -662.6675667572466, -474.8680286616357, -580.8105718120331, -570.1662877820227, -1178.8451275361977, -858.7163013056644, -694.8156343944005, -452.7068189820576, -608.3456158256217, -750.660993351937, -1045.2173286787524, -833.3557270235104, -787.2133332024458, -808.0492994819223, -539.7716950499627, -750.3821065654046, -666.5525706335234, -795.5260674886666, -1187.195266104132, -646.8361095209852, -1149.905236052508, -801.2423149206337, -684.6117348729066, -792.8103939927032, -526.157539044346, -689.7443666324847, -770.2809562845098, -932.3016437312655, -614.6595939800584, -536.4521534334979, -401.0565983900857, -735.497953612034, -1186.642378836706, -728.6278433915107, -832.3646724203976, -664.031553164132, -621.1268227183493, -360.4635582382683, -783.908098890003, -816.2804678552773, -598.5624720922849, -821.8618812052129, -798.6359594142689, -914.7550554229312, -907.387398828879, -806.032838220834, -853.2777366222037, -535.9236276345816, -668.3005809784493, -817.6324127460357, -575.5426486006425, -844.338362443564, -987.9638919071522, -964.0078814003056, -575.0411396747068, -486.9990873779783, -810.4021681023249, -1020.3625499691664, -788.4657366836122, -1059.1970154748042, -491.5507545100828, -538.8076432084302, -802.9904993100657, -483.486963464396, -1093.3772423579098, -1154.7176883418608, -679.809950071456, -628.7414875841309, -620.1015333203428, -690.1998822665496, -565.2021177932787, -633.5753863466925, -647.6501468015776, -1247.5517022468086, -990.2846551648403, -554.2219541785735, -880.0112778118812, -743.7017521335646, -531.721159893199, -807.166822801979, -551.432737099075, -890.643322597953, -822.2198866915962, -710.9860813596496, -937.5742495392379, -662.4326357313347, -800.6691972778154, -658.2315142840092, -700.7227396798912], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 21.08620796957559, "mean_inference_ms": 0.40102522814406283, "mean_action_processing_ms": 0.09576580308359446, "mean_env_wait_ms": 2.8857187468215955, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003985881805419922, "StateBufferConnector_ms": 0.002756834030151367, "ViewRequirementAgentConnector_ms": 0.06817936897277832}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 238680, "num_agent_steps_trained": 238680, "num_env_steps_sampled": 238680, "num_env_steps_trained": 238680, "num_env_steps_sampled_this_iter": 480, "num_env_steps_trained_this_iter": 480, "num_env_steps_sampled_throughput_per_sec": 40.74053391340083, "num_env_steps_trained_throughput_per_sec": 40.74053391340083, "timesteps_total": 238680, "num_steps_trained_this_iter": 480, "agent_timesteps_total": 238680, "timers": {"training_iteration_time_ms": 2954.794, "sample_time_ms": 2950.978, "load_time_ms": 0.226, "load_throughput": 531934.559, "learn_time_ms": 2.842, "learn_throughput": 42229.142, "synch_weights_time_ms": 0.708}, "counters": {"num_env_steps_sampled": 238680, "num_env_steps_trained": 238680, "num_agent_steps_sampled": 238680, "num_agent_steps_trained": 238680}, "done": false, "episodes_total": 1989, "training_iteration": 498, "trial_id": "29a31_00000", "date": "2023-07-26_02-30-17", "timestamp": 1690327817, "time_this_iter_s": 11.784773826599121, "time_total_s": 6064.732557058334, "pid": 90822, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 1, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[253680, 5e-06], [256080, 5e-06], [258480, 2.5e-06], [260880, 2.5e-06], [263280, 2.5e-06], [265680, 2.5e-06], [268080, 1e-06], [270480, 1e-06], [272880, 1e-06], [275280, 5e-07], [277680, 5e-07], [280080, 5e-07], [282480, 5e-07], [284880, 5e-07], [287280, 1e-07], [289680, 1e-07], [292080, 1e-07]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 120, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x16ca65700>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 443.40708112716675, "iterations_since_restore": 38, "perf": {"cpu_util_percent": 36.317647058823525, "ram_util_percent": 77.06470588235294}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-07, "entropy_coeff": 0.05, "policy_entropy": 267.4776611328125, "policy_loss": -85185.828125, "vf_loss": 3469059.75}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 155.0, "diff_num_grad_updates_vs_sampler_policy": 154.0}}, "num_env_steps_sampled": 239160, "num_env_steps_trained": 239160, "num_agent_steps_sampled": 239160, "num_agent_steps_trained": 239160}, "sampler_results": {"episode_reward_max": -360.4635582382683, "episode_reward_min": -1247.5517022468086, "episode_reward_mean": -748.0115715073573, "episode_len_mean": 120.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-740.0716080267732, -746.3443956394477, -732.832450643513, -720.7381223943072, -652.5513813574496, -998.0419556137812, -470.3559029456608, -662.6675667572466, -474.8680286616357, -580.8105718120331, -570.1662877820227, -1178.8451275361977, -858.7163013056644, -694.8156343944005, -452.7068189820576, -608.3456158256217, -750.660993351937, -1045.2173286787524, -833.3557270235104, -787.2133332024458, -808.0492994819223, -539.7716950499627, -750.3821065654046, -666.5525706335234, -795.5260674886666, -1187.195266104132, -646.8361095209852, -1149.905236052508, -801.2423149206337, -684.6117348729066, -792.8103939927032, -526.157539044346, -689.7443666324847, -770.2809562845098, -932.3016437312655, -614.6595939800584, -536.4521534334979, -401.0565983900857, -735.497953612034, -1186.642378836706, -728.6278433915107, -832.3646724203976, -664.031553164132, -621.1268227183493, -360.4635582382683, -783.908098890003, -816.2804678552773, -598.5624720922849, -821.8618812052129, -798.6359594142689, -914.7550554229312, -907.387398828879, -806.032838220834, -853.2777366222037, -535.9236276345816, -668.3005809784493, -817.6324127460357, -575.5426486006425, -844.338362443564, -987.9638919071522, -964.0078814003056, -575.0411396747068, -486.9990873779783, -810.4021681023249, -1020.3625499691664, -788.4657366836122, -1059.1970154748042, -491.5507545100828, -538.8076432084302, -802.9904993100657, -483.486963464396, -1093.3772423579098, -1154.7176883418608, -679.809950071456, -628.7414875841309, -620.1015333203428, -690.1998822665496, -565.2021177932787, -633.5753863466925, -647.6501468015776, -1247.5517022468086, -990.2846551648403, -554.2219541785735, -880.0112778118812, -743.7017521335646, -531.721159893199, -807.166822801979, -551.432737099075, -890.643322597953, -822.2198866915962, -710.9860813596496, -937.5742495392379, -662.4326357313347, -800.6691972778154, -658.2315142840092, -700.7227396798912, -586.691534492754, -761.4475237982085, -733.9128377870884, -782.827678748833], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 21.085529331313783, "mean_inference_ms": 0.4010554707289614, "mean_action_processing_ms": 0.09576759631342387, "mean_env_wait_ms": 2.875375502531284, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003972291946411133, "StateBufferConnector_ms": 0.0027565956115722656, "ViewRequirementAgentConnector_ms": 0.06818127632141113}}, "episode_reward_max": -360.4635582382683, "episode_reward_min": -1247.5517022468086, "episode_reward_mean": -748.0115715073573, "episode_len_mean": 120.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-740.0716080267732, -746.3443956394477, -732.832450643513, -720.7381223943072, -652.5513813574496, -998.0419556137812, -470.3559029456608, -662.6675667572466, -474.8680286616357, -580.8105718120331, -570.1662877820227, -1178.8451275361977, -858.7163013056644, -694.8156343944005, -452.7068189820576, -608.3456158256217, -750.660993351937, -1045.2173286787524, -833.3557270235104, -787.2133332024458, -808.0492994819223, -539.7716950499627, -750.3821065654046, -666.5525706335234, -795.5260674886666, -1187.195266104132, -646.8361095209852, -1149.905236052508, -801.2423149206337, -684.6117348729066, -792.8103939927032, -526.157539044346, -689.7443666324847, -770.2809562845098, -932.3016437312655, -614.6595939800584, -536.4521534334979, -401.0565983900857, -735.497953612034, -1186.642378836706, -728.6278433915107, -832.3646724203976, -664.031553164132, -621.1268227183493, -360.4635582382683, -783.908098890003, -816.2804678552773, -598.5624720922849, -821.8618812052129, -798.6359594142689, -914.7550554229312, -907.387398828879, -806.032838220834, -853.2777366222037, -535.9236276345816, -668.3005809784493, -817.6324127460357, -575.5426486006425, -844.338362443564, -987.9638919071522, -964.0078814003056, -575.0411396747068, -486.9990873779783, -810.4021681023249, -1020.3625499691664, -788.4657366836122, -1059.1970154748042, -491.5507545100828, -538.8076432084302, -802.9904993100657, -483.486963464396, -1093.3772423579098, -1154.7176883418608, -679.809950071456, -628.7414875841309, -620.1015333203428, -690.1998822665496, -565.2021177932787, -633.5753863466925, -647.6501468015776, -1247.5517022468086, -990.2846551648403, -554.2219541785735, -880.0112778118812, -743.7017521335646, -531.721159893199, -807.166822801979, -551.432737099075, -890.643322597953, -822.2198866915962, -710.9860813596496, -937.5742495392379, -662.4326357313347, -800.6691972778154, -658.2315142840092, -700.7227396798912, -586.691534492754, -761.4475237982085, -733.9128377870884, -782.827678748833], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 21.085529331313783, "mean_inference_ms": 0.4010554707289614, "mean_action_processing_ms": 0.09576759631342387, "mean_env_wait_ms": 2.875375502531284, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003972291946411133, "StateBufferConnector_ms": 0.0027565956115722656, "ViewRequirementAgentConnector_ms": 0.06818127632141113}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 239160, "num_agent_steps_trained": 239160, "num_env_steps_sampled": 239160, "num_env_steps_trained": 239160, "num_env_steps_sampled_this_iter": 480, "num_env_steps_trained_this_iter": 480, "num_env_steps_sampled_throughput_per_sec": 41.7728097085695, "num_env_steps_trained_throughput_per_sec": 41.7728097085695, "timesteps_total": 239160, "num_steps_trained_this_iter": 480, "agent_timesteps_total": 239160, "timers": {"training_iteration_time_ms": 2909.225, "sample_time_ms": 2905.391, "load_time_ms": 0.225, "load_throughput": 532497.334, "learn_time_ms": 2.849, "learn_throughput": 42114.657, "synch_weights_time_ms": 0.718}, "counters": {"num_env_steps_sampled": 239160, "num_env_steps_trained": 239160, "num_agent_steps_sampled": 239160, "num_agent_steps_trained": 239160}, "done": false, "episodes_total": 1993, "training_iteration": 499, "trial_id": "29a31_00000", "date": "2023-07-26_02-30-29", "timestamp": 1690327829, "time_this_iter_s": 11.493516206741333, "time_total_s": 6076.226073265076, "pid": 90822, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 1, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[253680, 5e-06], [256080, 5e-06], [258480, 2.5e-06], [260880, 2.5e-06], [263280, 2.5e-06], [265680, 2.5e-06], [268080, 1e-06], [270480, 1e-06], [272880, 1e-06], [275280, 5e-07], [277680, 5e-07], [280080, 5e-07], [282480, 5e-07], [284880, 5e-07], [287280, 1e-07], [289680, 1e-07], [292080, 1e-07]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 120, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x16ca65700>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 454.9005973339081, "iterations_since_restore": 39, "perf": {"cpu_util_percent": 33.15, "ram_util_percent": 75.81875}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-07, "entropy_coeff": 0.05, "policy_entropy": 267.4525451660156, "policy_loss": -88320.1953125, "vf_loss": 3447942.75}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 159.0, "diff_num_grad_updates_vs_sampler_policy": 158.0}}, "num_env_steps_sampled": 239640, "num_env_steps_trained": 239640, "num_agent_steps_sampled": 239640, "num_agent_steps_trained": 239640}, "sampler_results": {"episode_reward_max": -360.4635582382683, "episode_reward_min": -1247.5517022468086, "episode_reward_mean": -746.1866320917288, "episode_len_mean": 120.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-652.5513813574496, -998.0419556137812, -470.3559029456608, -662.6675667572466, -474.8680286616357, -580.8105718120331, -570.1662877820227, -1178.8451275361977, -858.7163013056644, -694.8156343944005, -452.7068189820576, -608.3456158256217, -750.660993351937, -1045.2173286787524, -833.3557270235104, -787.2133332024458, -808.0492994819223, -539.7716950499627, -750.3821065654046, -666.5525706335234, -795.5260674886666, -1187.195266104132, -646.8361095209852, -1149.905236052508, -801.2423149206337, -684.6117348729066, -792.8103939927032, -526.157539044346, -689.7443666324847, -770.2809562845098, -932.3016437312655, -614.6595939800584, -536.4521534334979, -401.0565983900857, -735.497953612034, -1186.642378836706, -728.6278433915107, -832.3646724203976, -664.031553164132, -621.1268227183493, -360.4635582382683, -783.908098890003, -816.2804678552773, -598.5624720922849, -821.8618812052129, -798.6359594142689, -914.7550554229312, -907.387398828879, -806.032838220834, -853.2777366222037, -535.9236276345816, -668.3005809784493, -817.6324127460357, -575.5426486006425, -844.338362443564, -987.9638919071522, -964.0078814003056, -575.0411396747068, -486.9990873779783, -810.4021681023249, -1020.3625499691664, -788.4657366836122, -1059.1970154748042, -491.5507545100828, -538.8076432084302, -802.9904993100657, -483.486963464396, -1093.3772423579098, -1154.7176883418608, -679.809950071456, -628.7414875841309, -620.1015333203428, -690.1998822665496, -565.2021177932787, -633.5753863466925, -647.6501468015776, -1247.5517022468086, -990.2846551648403, -554.2219541785735, -880.0112778118812, -743.7017521335646, -531.721159893199, -807.166822801979, -551.432737099075, -890.643322597953, -822.2198866915962, -710.9860813596496, -937.5742495392379, -662.4326357313347, -800.6691972778154, -658.2315142840092, -700.7227396798912, -586.691534492754, -761.4475237982085, -733.9128377870884, -782.827678748833, -549.3468543859714, -774.413592672589, -682.1860211806298, -751.5461669019867], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 21.08399391954682, "mean_inference_ms": 0.40109965299386807, "mean_action_processing_ms": 0.09577153254412969, "mean_env_wait_ms": 2.8659105587064664, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003965854644775391, "StateBufferConnector_ms": 0.0027480125427246094, "ViewRequirementAgentConnector_ms": 0.06818175315856934}}, "episode_reward_max": -360.4635582382683, "episode_reward_min": -1247.5517022468086, "episode_reward_mean": -746.1866320917288, "episode_len_mean": 120.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-652.5513813574496, -998.0419556137812, -470.3559029456608, -662.6675667572466, -474.8680286616357, -580.8105718120331, -570.1662877820227, -1178.8451275361977, -858.7163013056644, -694.8156343944005, -452.7068189820576, -608.3456158256217, -750.660993351937, -1045.2173286787524, -833.3557270235104, -787.2133332024458, -808.0492994819223, -539.7716950499627, -750.3821065654046, -666.5525706335234, -795.5260674886666, -1187.195266104132, -646.8361095209852, -1149.905236052508, -801.2423149206337, -684.6117348729066, -792.8103939927032, -526.157539044346, -689.7443666324847, -770.2809562845098, -932.3016437312655, -614.6595939800584, -536.4521534334979, -401.0565983900857, -735.497953612034, -1186.642378836706, -728.6278433915107, -832.3646724203976, -664.031553164132, -621.1268227183493, -360.4635582382683, -783.908098890003, -816.2804678552773, -598.5624720922849, -821.8618812052129, -798.6359594142689, -914.7550554229312, -907.387398828879, -806.032838220834, -853.2777366222037, -535.9236276345816, -668.3005809784493, -817.6324127460357, -575.5426486006425, -844.338362443564, -987.9638919071522, -964.0078814003056, -575.0411396747068, -486.9990873779783, -810.4021681023249, -1020.3625499691664, -788.4657366836122, -1059.1970154748042, -491.5507545100828, -538.8076432084302, -802.9904993100657, -483.486963464396, -1093.3772423579098, -1154.7176883418608, -679.809950071456, -628.7414875841309, -620.1015333203428, -690.1998822665496, -565.2021177932787, -633.5753863466925, -647.6501468015776, -1247.5517022468086, -990.2846551648403, -554.2219541785735, -880.0112778118812, -743.7017521335646, -531.721159893199, -807.166822801979, -551.432737099075, -890.643322597953, -822.2198866915962, -710.9860813596496, -937.5742495392379, -662.4326357313347, -800.6691972778154, -658.2315142840092, -700.7227396798912, -586.691534492754, -761.4475237982085, -733.9128377870884, -782.827678748833, -549.3468543859714, -774.413592672589, -682.1860211806298, -751.5461669019867], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 21.08399391954682, "mean_inference_ms": 0.40109965299386807, "mean_action_processing_ms": 0.09577153254412969, "mean_env_wait_ms": 2.8659105587064664, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003965854644775391, "StateBufferConnector_ms": 0.0027480125427246094, "ViewRequirementAgentConnector_ms": 0.06818175315856934}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 239640, "num_agent_steps_trained": 239640, "num_env_steps_sampled": 239640, "num_env_steps_trained": 239640, "num_env_steps_sampled_this_iter": 480, "num_env_steps_trained_this_iter": 480, "num_env_steps_sampled_throughput_per_sec": 41.21168287981053, "num_env_steps_trained_throughput_per_sec": 41.21168287981053, "timesteps_total": 239640, "num_steps_trained_this_iter": 480, "agent_timesteps_total": 239640, "timers": {"training_iteration_time_ms": 2899.585, "sample_time_ms": 2895.791, "load_time_ms": 0.224, "load_throughput": 536756.404, "learn_time_ms": 2.821, "learn_throughput": 42542.895, "synch_weights_time_ms": 0.71}, "counters": {"num_env_steps_sampled": 239640, "num_env_steps_trained": 239640, "num_agent_steps_sampled": 239640, "num_agent_steps_trained": 239640}, "done": false, "episodes_total": 1997, "training_iteration": 500, "trial_id": "29a31_00000", "date": "2023-07-26_02-30-40", "timestamp": 1690327840, "time_this_iter_s": 11.649760007858276, "time_total_s": 6087.875833272934, "pid": 90822, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 1, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[253680, 5e-06], [256080, 5e-06], [258480, 2.5e-06], [260880, 2.5e-06], [263280, 2.5e-06], [265680, 2.5e-06], [268080, 1e-06], [270480, 1e-06], [272880, 1e-06], [275280, 5e-07], [277680, 5e-07], [280080, 5e-07], [282480, 5e-07], [284880, 5e-07], [287280, 1e-07], [289680, 1e-07], [292080, 1e-07]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 120, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x16ca65700>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 466.55035734176636, "iterations_since_restore": 40, "perf": {"cpu_util_percent": 35.94117647058823, "ram_util_percent": 75.40588235294116}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-07, "entropy_coeff": 0.05, "policy_entropy": 267.4302062988281, "policy_loss": -77997.4375, "vf_loss": 3003835.25}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 163.0, "diff_num_grad_updates_vs_sampler_policy": 162.0}}, "num_env_steps_sampled": 240120, "num_env_steps_trained": 240120, "num_agent_steps_sampled": 240120, "num_agent_steps_trained": 240120}, "sampler_results": {"episode_reward_max": -360.4635582382683, "episode_reward_min": -1247.5517022468086, "episode_reward_mean": -746.6356399768778, "episode_len_mean": 120.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-474.8680286616357, -580.8105718120331, -570.1662877820227, -1178.8451275361977, -858.7163013056644, -694.8156343944005, -452.7068189820576, -608.3456158256217, -750.660993351937, -1045.2173286787524, -833.3557270235104, -787.2133332024458, -808.0492994819223, -539.7716950499627, -750.3821065654046, -666.5525706335234, -795.5260674886666, -1187.195266104132, -646.8361095209852, -1149.905236052508, -801.2423149206337, -684.6117348729066, -792.8103939927032, -526.157539044346, -689.7443666324847, -770.2809562845098, -932.3016437312655, -614.6595939800584, -536.4521534334979, -401.0565983900857, -735.497953612034, -1186.642378836706, -728.6278433915107, -832.3646724203976, -664.031553164132, -621.1268227183493, -360.4635582382683, -783.908098890003, -816.2804678552773, -598.5624720922849, -821.8618812052129, -798.6359594142689, -914.7550554229312, -907.387398828879, -806.032838220834, -853.2777366222037, -535.9236276345816, -668.3005809784493, -817.6324127460357, -575.5426486006425, -844.338362443564, -987.9638919071522, -964.0078814003056, -575.0411396747068, -486.9990873779783, -810.4021681023249, -1020.3625499691664, -788.4657366836122, -1059.1970154748042, -491.5507545100828, -538.8076432084302, -802.9904993100657, -483.486963464396, -1093.3772423579098, -1154.7176883418608, -679.809950071456, -628.7414875841309, -620.1015333203428, -690.1998822665496, -565.2021177932787, -633.5753863466925, -647.6501468015776, -1247.5517022468086, -990.2846551648403, -554.2219541785735, -880.0112778118812, -743.7017521335646, -531.721159893199, -807.166822801979, -551.432737099075, -890.643322597953, -822.2198866915962, -710.9860813596496, -937.5742495392379, -662.4326357313347, -800.6691972778154, -658.2315142840092, -700.7227396798912, -586.691534492754, -761.4475237982085, -733.9128377870884, -782.827678748833, -549.3468543859714, -774.413592672589, -682.1860211806298, -751.5461669019867, -673.7653080406461, -719.383273251562, -860.7816931032946, -574.5873207935329], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 21.081634992981723, "mean_inference_ms": 0.40113669870154867, "mean_action_processing_ms": 0.09577508577970835, "mean_env_wait_ms": 2.8571123560044756, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003953695297241211, "StateBufferConnector_ms": 0.002739429473876953, "ViewRequirementAgentConnector_ms": 0.0680849552154541}}, "episode_reward_max": -360.4635582382683, "episode_reward_min": -1247.5517022468086, "episode_reward_mean": -746.6356399768778, "episode_len_mean": 120.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-474.8680286616357, -580.8105718120331, -570.1662877820227, -1178.8451275361977, -858.7163013056644, -694.8156343944005, -452.7068189820576, -608.3456158256217, -750.660993351937, -1045.2173286787524, -833.3557270235104, -787.2133332024458, -808.0492994819223, -539.7716950499627, -750.3821065654046, -666.5525706335234, -795.5260674886666, -1187.195266104132, -646.8361095209852, -1149.905236052508, -801.2423149206337, -684.6117348729066, -792.8103939927032, -526.157539044346, -689.7443666324847, -770.2809562845098, -932.3016437312655, -614.6595939800584, -536.4521534334979, -401.0565983900857, -735.497953612034, -1186.642378836706, -728.6278433915107, -832.3646724203976, -664.031553164132, -621.1268227183493, -360.4635582382683, -783.908098890003, -816.2804678552773, -598.5624720922849, -821.8618812052129, -798.6359594142689, -914.7550554229312, -907.387398828879, -806.032838220834, -853.2777366222037, -535.9236276345816, -668.3005809784493, -817.6324127460357, -575.5426486006425, -844.338362443564, -987.9638919071522, -964.0078814003056, -575.0411396747068, -486.9990873779783, -810.4021681023249, -1020.3625499691664, -788.4657366836122, -1059.1970154748042, -491.5507545100828, -538.8076432084302, -802.9904993100657, -483.486963464396, -1093.3772423579098, -1154.7176883418608, -679.809950071456, -628.7414875841309, -620.1015333203428, -690.1998822665496, -565.2021177932787, -633.5753863466925, -647.6501468015776, -1247.5517022468086, -990.2846551648403, -554.2219541785735, -880.0112778118812, -743.7017521335646, -531.721159893199, -807.166822801979, -551.432737099075, -890.643322597953, -822.2198866915962, -710.9860813596496, -937.5742495392379, -662.4326357313347, -800.6691972778154, -658.2315142840092, -700.7227396798912, -586.691534492754, -761.4475237982085, -733.9128377870884, -782.827678748833, -549.3468543859714, -774.413592672589, -682.1860211806298, -751.5461669019867, -673.7653080406461, -719.383273251562, -860.7816931032946, -574.5873207935329], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 21.081634992981723, "mean_inference_ms": 0.40113669870154867, "mean_action_processing_ms": 0.09577508577970835, "mean_env_wait_ms": 2.8571123560044756, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003953695297241211, "StateBufferConnector_ms": 0.002739429473876953, "ViewRequirementAgentConnector_ms": 0.0680849552154541}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 240120, "num_agent_steps_trained": 240120, "num_env_steps_sampled": 240120, "num_env_steps_trained": 240120, "num_env_steps_sampled_this_iter": 480, "num_env_steps_trained_this_iter": 480, "num_env_steps_sampled_throughput_per_sec": 42.03373566602489, "num_env_steps_trained_throughput_per_sec": 42.03373566602489, "timesteps_total": 240120, "num_steps_trained_this_iter": 480, "agent_timesteps_total": 240120, "timers": {"training_iteration_time_ms": 2882.674, "sample_time_ms": 2878.887, "load_time_ms": 0.221, "load_throughput": 543420.946, "learn_time_ms": 2.804, "learn_throughput": 42800.112, "synch_weights_time_ms": 0.722}, "counters": {"num_env_steps_sampled": 240120, "num_env_steps_trained": 240120, "num_agent_steps_sampled": 240120, "num_agent_steps_trained": 240120}, "done": false, "episodes_total": 2001, "training_iteration": 501, "trial_id": "29a31_00000", "date": "2023-07-26_02-30-52", "timestamp": 1690327852, "time_this_iter_s": 11.422125816345215, "time_total_s": 6099.297959089279, "pid": 90822, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 1, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[253680, 5e-06], [256080, 5e-06], [258480, 2.5e-06], [260880, 2.5e-06], [263280, 2.5e-06], [265680, 2.5e-06], [268080, 1e-06], [270480, 1e-06], [272880, 1e-06], [275280, 5e-07], [277680, 5e-07], [280080, 5e-07], [282480, 5e-07], [284880, 5e-07], [287280, 1e-07], [289680, 1e-07], [292080, 1e-07]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 120, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x16ca65700>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 477.9724831581116, "iterations_since_restore": 41, "perf": {"cpu_util_percent": 37.36875, "ram_util_percent": 73.54374999999999}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-07, "entropy_coeff": 0.05, "policy_entropy": 267.4168701171875, "policy_loss": -102241.4296875, "vf_loss": 4352015.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 167.0, "diff_num_grad_updates_vs_sampler_policy": 166.0}}, "num_env_steps_sampled": 240600, "num_env_steps_trained": 240600, "num_agent_steps_sampled": 240600, "num_agent_steps_trained": 240600}, "sampler_results": {"episode_reward_max": -360.4635582382683, "episode_reward_min": -1247.5517022468086, "episode_reward_mean": -746.9382701996597, "episode_len_mean": 120.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-858.7163013056644, -694.8156343944005, -452.7068189820576, -608.3456158256217, -750.660993351937, -1045.2173286787524, -833.3557270235104, -787.2133332024458, -808.0492994819223, -539.7716950499627, -750.3821065654046, -666.5525706335234, -795.5260674886666, -1187.195266104132, -646.8361095209852, -1149.905236052508, -801.2423149206337, -684.6117348729066, -792.8103939927032, -526.157539044346, -689.7443666324847, -770.2809562845098, -932.3016437312655, -614.6595939800584, -536.4521534334979, -401.0565983900857, -735.497953612034, -1186.642378836706, -728.6278433915107, -832.3646724203976, -664.031553164132, -621.1268227183493, -360.4635582382683, -783.908098890003, -816.2804678552773, -598.5624720922849, -821.8618812052129, -798.6359594142689, -914.7550554229312, -907.387398828879, -806.032838220834, -853.2777366222037, -535.9236276345816, -668.3005809784493, -817.6324127460357, -575.5426486006425, -844.338362443564, -987.9638919071522, -964.0078814003056, -575.0411396747068, -486.9990873779783, -810.4021681023249, -1020.3625499691664, -788.4657366836122, -1059.1970154748042, -491.5507545100828, -538.8076432084302, -802.9904993100657, -483.486963464396, -1093.3772423579098, -1154.7176883418608, -679.809950071456, -628.7414875841309, -620.1015333203428, -690.1998822665496, -565.2021177932787, -633.5753863466925, -647.6501468015776, -1247.5517022468086, -990.2846551648403, -554.2219541785735, -880.0112778118812, -743.7017521335646, -531.721159893199, -807.166822801979, -551.432737099075, -890.643322597953, -822.2198866915962, -710.9860813596496, -937.5742495392379, -662.4326357313347, -800.6691972778154, -658.2315142840092, -700.7227396798912, -586.691534492754, -761.4475237982085, -733.9128377870884, -782.827678748833, -549.3468543859714, -774.413592672589, -682.1860211806298, -751.5461669019867, -673.7653080406461, -719.383273251562, -860.7816931032946, -574.5873207935329, -758.1958160256859, -814.6505144404368, -550.202945075386, -711.9037625285532], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 21.07912870896262, "mean_inference_ms": 0.4011886390254981, "mean_action_processing_ms": 0.0957813321081029, "mean_env_wait_ms": 2.8489784061924213, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003950834274291992, "StateBufferConnector_ms": 0.0027425289154052734, "ViewRequirementAgentConnector_ms": 0.06810593605041504}}, "episode_reward_max": -360.4635582382683, "episode_reward_min": -1247.5517022468086, "episode_reward_mean": -746.9382701996597, "episode_len_mean": 120.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-858.7163013056644, -694.8156343944005, -452.7068189820576, -608.3456158256217, -750.660993351937, -1045.2173286787524, -833.3557270235104, -787.2133332024458, -808.0492994819223, -539.7716950499627, -750.3821065654046, -666.5525706335234, -795.5260674886666, -1187.195266104132, -646.8361095209852, -1149.905236052508, -801.2423149206337, -684.6117348729066, -792.8103939927032, -526.157539044346, -689.7443666324847, -770.2809562845098, -932.3016437312655, -614.6595939800584, -536.4521534334979, -401.0565983900857, -735.497953612034, -1186.642378836706, -728.6278433915107, -832.3646724203976, -664.031553164132, -621.1268227183493, -360.4635582382683, -783.908098890003, -816.2804678552773, -598.5624720922849, -821.8618812052129, -798.6359594142689, -914.7550554229312, -907.387398828879, -806.032838220834, -853.2777366222037, -535.9236276345816, -668.3005809784493, -817.6324127460357, -575.5426486006425, -844.338362443564, -987.9638919071522, -964.0078814003056, -575.0411396747068, -486.9990873779783, -810.4021681023249, -1020.3625499691664, -788.4657366836122, -1059.1970154748042, -491.5507545100828, -538.8076432084302, -802.9904993100657, -483.486963464396, -1093.3772423579098, -1154.7176883418608, -679.809950071456, -628.7414875841309, -620.1015333203428, -690.1998822665496, -565.2021177932787, -633.5753863466925, -647.6501468015776, -1247.5517022468086, -990.2846551648403, -554.2219541785735, -880.0112778118812, -743.7017521335646, -531.721159893199, -807.166822801979, -551.432737099075, -890.643322597953, -822.2198866915962, -710.9860813596496, -937.5742495392379, -662.4326357313347, -800.6691972778154, -658.2315142840092, -700.7227396798912, -586.691534492754, -761.4475237982085, -733.9128377870884, -782.827678748833, -549.3468543859714, -774.413592672589, -682.1860211806298, -751.5461669019867, -673.7653080406461, -719.383273251562, -860.7816931032946, -574.5873207935329, -758.1958160256859, -814.6505144404368, -550.202945075386, -711.9037625285532], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 21.07912870896262, "mean_inference_ms": 0.4011886390254981, "mean_action_processing_ms": 0.0957813321081029, "mean_env_wait_ms": 2.8489784061924213, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003950834274291992, "StateBufferConnector_ms": 0.0027425289154052734, "ViewRequirementAgentConnector_ms": 0.06810593605041504}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 240600, "num_agent_steps_trained": 240600, "num_env_steps_sampled": 240600, "num_env_steps_trained": 240600, "num_env_steps_sampled_this_iter": 480, "num_env_steps_trained_this_iter": 480, "num_env_steps_sampled_throughput_per_sec": 41.41074371215251, "num_env_steps_trained_throughput_per_sec": 41.41074371215251, "timesteps_total": 240600, "num_steps_trained_this_iter": 480, "agent_timesteps_total": 240600, "timers": {"training_iteration_time_ms": 2885.052, "sample_time_ms": 2881.217, "load_time_ms": 0.224, "load_throughput": 535899.148, "learn_time_ms": 2.839, "learn_throughput": 42270.282, "synch_weights_time_ms": 0.731}, "counters": {"num_env_steps_sampled": 240600, "num_env_steps_trained": 240600, "num_agent_steps_sampled": 240600, "num_agent_steps_trained": 240600}, "done": false, "episodes_total": 2005, "training_iteration": 502, "trial_id": "29a31_00000", "date": "2023-07-26_02-31-03", "timestamp": 1690327863, "time_this_iter_s": 11.59430193901062, "time_total_s": 6110.89226102829, "pid": 90822, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 1, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[253680, 5e-06], [256080, 5e-06], [258480, 2.5e-06], [260880, 2.5e-06], [263280, 2.5e-06], [265680, 2.5e-06], [268080, 1e-06], [270480, 1e-06], [272880, 1e-06], [275280, 5e-07], [277680, 5e-07], [280080, 5e-07], [282480, 5e-07], [284880, 5e-07], [287280, 1e-07], [289680, 1e-07], [292080, 1e-07]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 120, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x16ca65700>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 489.5667850971222, "iterations_since_restore": 42, "perf": {"cpu_util_percent": 42.368750000000006, "ram_util_percent": 74.50625000000001}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-07, "entropy_coeff": 0.05, "policy_entropy": 267.41241455078125, "policy_loss": -93755.6328125, "vf_loss": 4662095.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 171.0, "diff_num_grad_updates_vs_sampler_policy": 170.0}}, "num_env_steps_sampled": 241080, "num_env_steps_trained": 241080, "num_agent_steps_sampled": 241080, "num_agent_steps_trained": 241080}, "sampler_results": {"episode_reward_max": -360.4635582382683, "episode_reward_min": -1247.5517022468086, "episode_reward_mean": -754.2493828551179, "episode_len_mean": 120.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-750.660993351937, -1045.2173286787524, -833.3557270235104, -787.2133332024458, -808.0492994819223, -539.7716950499627, -750.3821065654046, -666.5525706335234, -795.5260674886666, -1187.195266104132, -646.8361095209852, -1149.905236052508, -801.2423149206337, -684.6117348729066, -792.8103939927032, -526.157539044346, -689.7443666324847, -770.2809562845098, -932.3016437312655, -614.6595939800584, -536.4521534334979, -401.0565983900857, -735.497953612034, -1186.642378836706, -728.6278433915107, -832.3646724203976, -664.031553164132, -621.1268227183493, -360.4635582382683, -783.908098890003, -816.2804678552773, -598.5624720922849, -821.8618812052129, -798.6359594142689, -914.7550554229312, -907.387398828879, -806.032838220834, -853.2777366222037, -535.9236276345816, -668.3005809784493, -817.6324127460357, -575.5426486006425, -844.338362443564, -987.9638919071522, -964.0078814003056, -575.0411396747068, -486.9990873779783, -810.4021681023249, -1020.3625499691664, -788.4657366836122, -1059.1970154748042, -491.5507545100828, -538.8076432084302, -802.9904993100657, -483.486963464396, -1093.3772423579098, -1154.7176883418608, -679.809950071456, -628.7414875841309, -620.1015333203428, -690.1998822665496, -565.2021177932787, -633.5753863466925, -647.6501468015776, -1247.5517022468086, -990.2846551648403, -554.2219541785735, -880.0112778118812, -743.7017521335646, -531.721159893199, -807.166822801979, -551.432737099075, -890.643322597953, -822.2198866915962, -710.9860813596496, -937.5742495392379, -662.4326357313347, -800.6691972778154, -658.2315142840092, -700.7227396798912, -586.691534492754, -761.4475237982085, -733.9128377870884, -782.827678748833, -549.3468543859714, -774.413592672589, -682.1860211806298, -751.5461669019867, -673.7653080406461, -719.383273251562, -860.7816931032946, -574.5873207935329, -758.1958160256859, -814.6505144404368, -550.202945075386, -711.9037625285532, -651.2176932449257, -924.0613606677422, -1116.3976631432336, -654.0189189977006], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 21.077969560025636, "mean_inference_ms": 0.4012527514348853, "mean_action_processing_ms": 0.0957884655369665, "mean_env_wait_ms": 2.8418121685483286, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003962993621826172, "StateBufferConnector_ms": 0.002749204635620117, "ViewRequirementAgentConnector_ms": 0.06830334663391113}}, "episode_reward_max": -360.4635582382683, "episode_reward_min": -1247.5517022468086, "episode_reward_mean": -754.2493828551179, "episode_len_mean": 120.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-750.660993351937, -1045.2173286787524, -833.3557270235104, -787.2133332024458, -808.0492994819223, -539.7716950499627, -750.3821065654046, -666.5525706335234, -795.5260674886666, -1187.195266104132, -646.8361095209852, -1149.905236052508, -801.2423149206337, -684.6117348729066, -792.8103939927032, -526.157539044346, -689.7443666324847, -770.2809562845098, -932.3016437312655, -614.6595939800584, -536.4521534334979, -401.0565983900857, -735.497953612034, -1186.642378836706, -728.6278433915107, -832.3646724203976, -664.031553164132, -621.1268227183493, -360.4635582382683, -783.908098890003, -816.2804678552773, -598.5624720922849, -821.8618812052129, -798.6359594142689, -914.7550554229312, -907.387398828879, -806.032838220834, -853.2777366222037, -535.9236276345816, -668.3005809784493, -817.6324127460357, -575.5426486006425, -844.338362443564, -987.9638919071522, -964.0078814003056, -575.0411396747068, -486.9990873779783, -810.4021681023249, -1020.3625499691664, -788.4657366836122, -1059.1970154748042, -491.5507545100828, -538.8076432084302, -802.9904993100657, -483.486963464396, -1093.3772423579098, -1154.7176883418608, -679.809950071456, -628.7414875841309, -620.1015333203428, -690.1998822665496, -565.2021177932787, -633.5753863466925, -647.6501468015776, -1247.5517022468086, -990.2846551648403, -554.2219541785735, -880.0112778118812, -743.7017521335646, -531.721159893199, -807.166822801979, -551.432737099075, -890.643322597953, -822.2198866915962, -710.9860813596496, -937.5742495392379, -662.4326357313347, -800.6691972778154, -658.2315142840092, -700.7227396798912, -586.691534492754, -761.4475237982085, -733.9128377870884, -782.827678748833, -549.3468543859714, -774.413592672589, -682.1860211806298, -751.5461669019867, -673.7653080406461, -719.383273251562, -860.7816931032946, -574.5873207935329, -758.1958160256859, -814.6505144404368, -550.202945075386, -711.9037625285532, -651.2176932449257, -924.0613606677422, -1116.3976631432336, -654.0189189977006], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 21.077969560025636, "mean_inference_ms": 0.4012527514348853, "mean_action_processing_ms": 0.0957884655369665, "mean_env_wait_ms": 2.8418121685483286, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003962993621826172, "StateBufferConnector_ms": 0.002749204635620117, "ViewRequirementAgentConnector_ms": 0.06830334663391113}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 241080, "num_agent_steps_trained": 241080, "num_env_steps_sampled": 241080, "num_env_steps_trained": 241080, "num_env_steps_sampled_this_iter": 480, "num_env_steps_trained_this_iter": 480, "num_env_steps_sampled_throughput_per_sec": 40.78060417083686, "num_env_steps_trained_throughput_per_sec": 40.78060417083686, "timesteps_total": 241080, "num_steps_trained_this_iter": 480, "agent_timesteps_total": 241080, "timers": {"training_iteration_time_ms": 2908.899, "sample_time_ms": 2905.075, "load_time_ms": 0.223, "load_throughput": 537329.433, "learn_time_ms": 2.841, "learn_throughput": 42244.738, "synch_weights_time_ms": 0.718}, "counters": {"num_env_steps_sampled": 241080, "num_env_steps_trained": 241080, "num_agent_steps_sampled": 241080, "num_agent_steps_trained": 241080}, "done": false, "episodes_total": 2009, "training_iteration": 503, "trial_id": "29a31_00000", "date": "2023-07-26_02-31-15", "timestamp": 1690327875, "time_this_iter_s": 11.77302598953247, "time_total_s": 6122.665287017822, "pid": 90822, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 1, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[253680, 5e-06], [256080, 5e-06], [258480, 2.5e-06], [260880, 2.5e-06], [263280, 2.5e-06], [265680, 2.5e-06], [268080, 1e-06], [270480, 1e-06], [272880, 1e-06], [275280, 5e-07], [277680, 5e-07], [280080, 5e-07], [282480, 5e-07], [284880, 5e-07], [287280, 1e-07], [289680, 1e-07], [292080, 1e-07]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 120, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x16ca65700>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 501.33981108665466, "iterations_since_restore": 43, "perf": {"cpu_util_percent": 41.38235294117647, "ram_util_percent": 78.47058823529413}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-07, "entropy_coeff": 0.05, "policy_entropy": 267.48907470703125, "policy_loss": -140807.828125, "vf_loss": 8296080.5}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 175.0, "diff_num_grad_updates_vs_sampler_policy": 174.0}}, "num_env_steps_sampled": 241560, "num_env_steps_trained": 241560, "num_agent_steps_sampled": 241560, "num_agent_steps_trained": 241560}, "sampler_results": {"episode_reward_max": -360.4635582382683, "episode_reward_min": -1247.5517022468086, "episode_reward_mean": -755.94635982636, "episode_len_mean": 120.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-808.0492994819223, -539.7716950499627, -750.3821065654046, -666.5525706335234, -795.5260674886666, -1187.195266104132, -646.8361095209852, -1149.905236052508, -801.2423149206337, -684.6117348729066, -792.8103939927032, -526.157539044346, -689.7443666324847, -770.2809562845098, -932.3016437312655, -614.6595939800584, -536.4521534334979, -401.0565983900857, -735.497953612034, -1186.642378836706, -728.6278433915107, -832.3646724203976, -664.031553164132, -621.1268227183493, -360.4635582382683, -783.908098890003, -816.2804678552773, -598.5624720922849, -821.8618812052129, -798.6359594142689, -914.7550554229312, -907.387398828879, -806.032838220834, -853.2777366222037, -535.9236276345816, -668.3005809784493, -817.6324127460357, -575.5426486006425, -844.338362443564, -987.9638919071522, -964.0078814003056, -575.0411396747068, -486.9990873779783, -810.4021681023249, -1020.3625499691664, -788.4657366836122, -1059.1970154748042, -491.5507545100828, -538.8076432084302, -802.9904993100657, -483.486963464396, -1093.3772423579098, -1154.7176883418608, -679.809950071456, -628.7414875841309, -620.1015333203428, -690.1998822665496, -565.2021177932787, -633.5753863466925, -647.6501468015776, -1247.5517022468086, -990.2846551648403, -554.2219541785735, -880.0112778118812, -743.7017521335646, -531.721159893199, -807.166822801979, -551.432737099075, -890.643322597953, -822.2198866915962, -710.9860813596496, -937.5742495392379, -662.4326357313347, -800.6691972778154, -658.2315142840092, -700.7227396798912, -586.691534492754, -761.4475237982085, -733.9128377870884, -782.827678748833, -549.3468543859714, -774.413592672589, -682.1860211806298, -751.5461669019867, -673.7653080406461, -719.383273251562, -860.7816931032946, -574.5873207935329, -758.1958160256859, -814.6505144404368, -550.202945075386, -711.9037625285532, -651.2176932449257, -924.0613606677422, -1116.3976631432336, -654.0189189977006, -501.74581124005044, -798.3699660057422, -1203.9385734942814, -1082.0907286407714], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 21.078150245199037, "mean_inference_ms": 0.4013175841487602, "mean_action_processing_ms": 0.09579604322649836, "mean_env_wait_ms": 2.8352076534254502, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003961324691772461, "StateBufferConnector_ms": 0.002763032913208008, "ViewRequirementAgentConnector_ms": 0.06837296485900879}}, "episode_reward_max": -360.4635582382683, "episode_reward_min": -1247.5517022468086, "episode_reward_mean": -755.94635982636, "episode_len_mean": 120.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-808.0492994819223, -539.7716950499627, -750.3821065654046, -666.5525706335234, -795.5260674886666, -1187.195266104132, -646.8361095209852, -1149.905236052508, -801.2423149206337, -684.6117348729066, -792.8103939927032, -526.157539044346, -689.7443666324847, -770.2809562845098, -932.3016437312655, -614.6595939800584, -536.4521534334979, -401.0565983900857, -735.497953612034, -1186.642378836706, -728.6278433915107, -832.3646724203976, -664.031553164132, -621.1268227183493, -360.4635582382683, -783.908098890003, -816.2804678552773, -598.5624720922849, -821.8618812052129, -798.6359594142689, -914.7550554229312, -907.387398828879, -806.032838220834, -853.2777366222037, -535.9236276345816, -668.3005809784493, -817.6324127460357, -575.5426486006425, -844.338362443564, -987.9638919071522, -964.0078814003056, -575.0411396747068, -486.9990873779783, -810.4021681023249, -1020.3625499691664, -788.4657366836122, -1059.1970154748042, -491.5507545100828, -538.8076432084302, -802.9904993100657, -483.486963464396, -1093.3772423579098, -1154.7176883418608, -679.809950071456, -628.7414875841309, -620.1015333203428, -690.1998822665496, -565.2021177932787, -633.5753863466925, -647.6501468015776, -1247.5517022468086, -990.2846551648403, -554.2219541785735, -880.0112778118812, -743.7017521335646, -531.721159893199, -807.166822801979, -551.432737099075, -890.643322597953, -822.2198866915962, -710.9860813596496, -937.5742495392379, -662.4326357313347, -800.6691972778154, -658.2315142840092, -700.7227396798912, -586.691534492754, -761.4475237982085, -733.9128377870884, -782.827678748833, -549.3468543859714, -774.413592672589, -682.1860211806298, -751.5461669019867, -673.7653080406461, -719.383273251562, -860.7816931032946, -574.5873207935329, -758.1958160256859, -814.6505144404368, -550.202945075386, -711.9037625285532, -651.2176932449257, -924.0613606677422, -1116.3976631432336, -654.0189189977006, -501.74581124005044, -798.3699660057422, -1203.9385734942814, -1082.0907286407714], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 21.078150245199037, "mean_inference_ms": 0.4013175841487602, "mean_action_processing_ms": 0.09579604322649836, "mean_env_wait_ms": 2.8352076534254502, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003961324691772461, "StateBufferConnector_ms": 0.002763032913208008, "ViewRequirementAgentConnector_ms": 0.06837296485900879}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 241560, "num_agent_steps_trained": 241560, "num_env_steps_sampled": 241560, "num_env_steps_trained": 241560, "num_env_steps_sampled_this_iter": 480, "num_env_steps_trained_this_iter": 480, "num_env_steps_sampled_throughput_per_sec": 40.54507863165686, "num_env_steps_trained_throughput_per_sec": 40.54507863165686, "timesteps_total": 241560, "num_steps_trained_this_iter": 480, "agent_timesteps_total": 241560, "timers": {"training_iteration_time_ms": 2938.45, "sample_time_ms": 2934.552, "load_time_ms": 0.229, "load_throughput": 523034.896, "learn_time_ms": 2.901, "learn_throughput": 41360.206, "synch_weights_time_ms": 0.724}, "counters": {"num_env_steps_sampled": 241560, "num_env_steps_trained": 241560, "num_agent_steps_sampled": 241560, "num_agent_steps_trained": 241560}, "done": false, "episodes_total": 2013, "training_iteration": 504, "trial_id": "29a31_00000", "date": "2023-07-26_02-31-27", "timestamp": 1690327887, "time_this_iter_s": 11.842357873916626, "time_total_s": 6134.507644891739, "pid": 90822, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 1, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[253680, 5e-06], [256080, 5e-06], [258480, 2.5e-06], [260880, 2.5e-06], [263280, 2.5e-06], [265680, 2.5e-06], [268080, 1e-06], [270480, 1e-06], [272880, 1e-06], [275280, 5e-07], [277680, 5e-07], [280080, 5e-07], [282480, 5e-07], [284880, 5e-07], [287280, 1e-07], [289680, 1e-07], [292080, 1e-07]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 120, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x16ca65700>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 513.1821689605713, "iterations_since_restore": 44, "perf": {"cpu_util_percent": 37.641176470588235, "ram_util_percent": 77.2470588235294}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-07, "entropy_coeff": 0.05, "policy_entropy": 267.4662170410156, "policy_loss": -84608.1015625, "vf_loss": 3147661.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 179.0, "diff_num_grad_updates_vs_sampler_policy": 178.0}}, "num_env_steps_sampled": 242040, "num_env_steps_trained": 242040, "num_agent_steps_sampled": 242040, "num_agent_steps_trained": 242040}, "sampler_results": {"episode_reward_max": -360.4635582382683, "episode_reward_min": -1247.5517022468086, "episode_reward_mean": -751.9651133917023, "episode_len_mean": 120.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-795.5260674886666, -1187.195266104132, -646.8361095209852, -1149.905236052508, -801.2423149206337, -684.6117348729066, -792.8103939927032, -526.157539044346, -689.7443666324847, -770.2809562845098, -932.3016437312655, -614.6595939800584, -536.4521534334979, -401.0565983900857, -735.497953612034, -1186.642378836706, -728.6278433915107, -832.3646724203976, -664.031553164132, -621.1268227183493, -360.4635582382683, -783.908098890003, -816.2804678552773, -598.5624720922849, -821.8618812052129, -798.6359594142689, -914.7550554229312, -907.387398828879, -806.032838220834, -853.2777366222037, -535.9236276345816, -668.3005809784493, -817.6324127460357, -575.5426486006425, -844.338362443564, -987.9638919071522, -964.0078814003056, -575.0411396747068, -486.9990873779783, -810.4021681023249, -1020.3625499691664, -788.4657366836122, -1059.1970154748042, -491.5507545100828, -538.8076432084302, -802.9904993100657, -483.486963464396, -1093.3772423579098, -1154.7176883418608, -679.809950071456, -628.7414875841309, -620.1015333203428, -690.1998822665496, -565.2021177932787, -633.5753863466925, -647.6501468015776, -1247.5517022468086, -990.2846551648403, -554.2219541785735, -880.0112778118812, -743.7017521335646, -531.721159893199, -807.166822801979, -551.432737099075, -890.643322597953, -822.2198866915962, -710.9860813596496, -937.5742495392379, -662.4326357313347, -800.6691972778154, -658.2315142840092, -700.7227396798912, -586.691534492754, -761.4475237982085, -733.9128377870884, -782.827678748833, -549.3468543859714, -774.413592672589, -682.1860211806298, -751.5461669019867, -673.7653080406461, -719.383273251562, -860.7816931032946, -574.5873207935329, -758.1958160256859, -814.6505144404368, -550.202945075386, -711.9037625285532, -651.2176932449257, -924.0613606677422, -1116.3976631432336, -654.0189189977006, -501.74581124005044, -798.3699660057422, -1203.9385734942814, -1082.0907286407714, -394.41729969669444, -677.9611896108728, -540.2029569599493, -754.0495819975154], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 21.077787142570923, "mean_inference_ms": 0.40138250983073376, "mean_action_processing_ms": 0.09580382894030759, "mean_env_wait_ms": 2.829054820030004, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0039484500885009766, "StateBufferConnector_ms": 0.002747774124145508, "ViewRequirementAgentConnector_ms": 0.06822848320007324}}, "episode_reward_max": -360.4635582382683, "episode_reward_min": -1247.5517022468086, "episode_reward_mean": -751.9651133917023, "episode_len_mean": 120.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-795.5260674886666, -1187.195266104132, -646.8361095209852, -1149.905236052508, -801.2423149206337, -684.6117348729066, -792.8103939927032, -526.157539044346, -689.7443666324847, -770.2809562845098, -932.3016437312655, -614.6595939800584, -536.4521534334979, -401.0565983900857, -735.497953612034, -1186.642378836706, -728.6278433915107, -832.3646724203976, -664.031553164132, -621.1268227183493, -360.4635582382683, -783.908098890003, -816.2804678552773, -598.5624720922849, -821.8618812052129, -798.6359594142689, -914.7550554229312, -907.387398828879, -806.032838220834, -853.2777366222037, -535.9236276345816, -668.3005809784493, -817.6324127460357, -575.5426486006425, -844.338362443564, -987.9638919071522, -964.0078814003056, -575.0411396747068, -486.9990873779783, -810.4021681023249, -1020.3625499691664, -788.4657366836122, -1059.1970154748042, -491.5507545100828, -538.8076432084302, -802.9904993100657, -483.486963464396, -1093.3772423579098, -1154.7176883418608, -679.809950071456, -628.7414875841309, -620.1015333203428, -690.1998822665496, -565.2021177932787, -633.5753863466925, -647.6501468015776, -1247.5517022468086, -990.2846551648403, -554.2219541785735, -880.0112778118812, -743.7017521335646, -531.721159893199, -807.166822801979, -551.432737099075, -890.643322597953, -822.2198866915962, -710.9860813596496, -937.5742495392379, -662.4326357313347, -800.6691972778154, -658.2315142840092, -700.7227396798912, -586.691534492754, -761.4475237982085, -733.9128377870884, -782.827678748833, -549.3468543859714, -774.413592672589, -682.1860211806298, -751.5461669019867, -673.7653080406461, -719.383273251562, -860.7816931032946, -574.5873207935329, -758.1958160256859, -814.6505144404368, -550.202945075386, -711.9037625285532, -651.2176932449257, -924.0613606677422, -1116.3976631432336, -654.0189189977006, -501.74581124005044, -798.3699660057422, -1203.9385734942814, -1082.0907286407714, -394.41729969669444, -677.9611896108728, -540.2029569599493, -754.0495819975154], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 21.077787142570923, "mean_inference_ms": 0.40138250983073376, "mean_action_processing_ms": 0.09580382894030759, "mean_env_wait_ms": 2.829054820030004, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0039484500885009766, "StateBufferConnector_ms": 0.002747774124145508, "ViewRequirementAgentConnector_ms": 0.06822848320007324}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 242040, "num_agent_steps_trained": 242040, "num_env_steps_sampled": 242040, "num_env_steps_trained": 242040, "num_env_steps_sampled_this_iter": 480, "num_env_steps_trained_this_iter": 480, "num_env_steps_sampled_throughput_per_sec": 42.054782184688605, "num_env_steps_trained_throughput_per_sec": 42.054782184688605, "timesteps_total": 242040, "num_steps_trained_this_iter": 480, "agent_timesteps_total": 242040, "timers": {"training_iteration_time_ms": 2907.241, "sample_time_ms": 2903.373, "load_time_ms": 0.228, "load_throughput": 525547.123, "learn_time_ms": 2.875, "learn_throughput": 41742.675, "synch_weights_time_ms": 0.723}, "counters": {"num_env_steps_sampled": 242040, "num_env_steps_trained": 242040, "num_agent_steps_sampled": 242040, "num_agent_steps_trained": 242040}, "done": false, "episodes_total": 2017, "training_iteration": 505, "trial_id": "29a31_00000", "date": "2023-07-26_02-31-38", "timestamp": 1690327898, "time_this_iter_s": 11.41651201248169, "time_total_s": 6145.924156904221, "pid": 90822, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 1, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[253680, 5e-06], [256080, 5e-06], [258480, 2.5e-06], [260880, 2.5e-06], [263280, 2.5e-06], [265680, 2.5e-06], [268080, 1e-06], [270480, 1e-06], [272880, 1e-06], [275280, 5e-07], [277680, 5e-07], [280080, 5e-07], [282480, 5e-07], [284880, 5e-07], [287280, 1e-07], [289680, 1e-07], [292080, 1e-07]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 120, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x16ca65700>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 524.598680973053, "iterations_since_restore": 45, "perf": {"cpu_util_percent": 34.925, "ram_util_percent": 74.84375}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-07, "entropy_coeff": 0.05, "policy_entropy": 267.4582214355469, "policy_loss": -110866.4609375, "vf_loss": 5678183.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 183.0, "diff_num_grad_updates_vs_sampler_policy": 182.0}}, "num_env_steps_sampled": 242520, "num_env_steps_trained": 242520, "num_agent_steps_sampled": 242520, "num_agent_steps_trained": 242520}, "sampler_results": {"episode_reward_max": -360.4635582382683, "episode_reward_min": -1247.5517022468086, "episode_reward_mean": -745.8592620236903, "episode_len_mean": 120.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-801.2423149206337, -684.6117348729066, -792.8103939927032, -526.157539044346, -689.7443666324847, -770.2809562845098, -932.3016437312655, -614.6595939800584, -536.4521534334979, -401.0565983900857, -735.497953612034, -1186.642378836706, -728.6278433915107, -832.3646724203976, -664.031553164132, -621.1268227183493, -360.4635582382683, -783.908098890003, -816.2804678552773, -598.5624720922849, -821.8618812052129, -798.6359594142689, -914.7550554229312, -907.387398828879, -806.032838220834, -853.2777366222037, -535.9236276345816, -668.3005809784493, -817.6324127460357, -575.5426486006425, -844.338362443564, -987.9638919071522, -964.0078814003056, -575.0411396747068, -486.9990873779783, -810.4021681023249, -1020.3625499691664, -788.4657366836122, -1059.1970154748042, -491.5507545100828, -538.8076432084302, -802.9904993100657, -483.486963464396, -1093.3772423579098, -1154.7176883418608, -679.809950071456, -628.7414875841309, -620.1015333203428, -690.1998822665496, -565.2021177932787, -633.5753863466925, -647.6501468015776, -1247.5517022468086, -990.2846551648403, -554.2219541785735, -880.0112778118812, -743.7017521335646, -531.721159893199, -807.166822801979, -551.432737099075, -890.643322597953, -822.2198866915962, -710.9860813596496, -937.5742495392379, -662.4326357313347, -800.6691972778154, -658.2315142840092, -700.7227396798912, -586.691534492754, -761.4475237982085, -733.9128377870884, -782.827678748833, -549.3468543859714, -774.413592672589, -682.1860211806298, -751.5461669019867, -673.7653080406461, -719.383273251562, -860.7816931032946, -574.5873207935329, -758.1958160256859, -814.6505144404368, -550.202945075386, -711.9037625285532, -651.2176932449257, -924.0613606677422, -1116.3976631432336, -654.0189189977006, -501.74581124005044, -798.3699660057422, -1203.9385734942814, -1082.0907286407714, -394.41729969669444, -677.9611896108728, -540.2029569599493, -754.0495819975154, -684.376520070522, -1026.549368134969, -581.8008976875988, -876.150756472005], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 21.076774030920422, "mean_inference_ms": 0.4014601897181373, "mean_action_processing_ms": 0.09581466676059555, "mean_env_wait_ms": 2.823019245763594, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003949880599975586, "StateBufferConnector_ms": 0.002747774124145508, "ViewRequirementAgentConnector_ms": 0.06831932067871094}}, "episode_reward_max": -360.4635582382683, "episode_reward_min": -1247.5517022468086, "episode_reward_mean": -745.8592620236903, "episode_len_mean": 120.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-801.2423149206337, -684.6117348729066, -792.8103939927032, -526.157539044346, -689.7443666324847, -770.2809562845098, -932.3016437312655, -614.6595939800584, -536.4521534334979, -401.0565983900857, -735.497953612034, -1186.642378836706, -728.6278433915107, -832.3646724203976, -664.031553164132, -621.1268227183493, -360.4635582382683, -783.908098890003, -816.2804678552773, -598.5624720922849, -821.8618812052129, -798.6359594142689, -914.7550554229312, -907.387398828879, -806.032838220834, -853.2777366222037, -535.9236276345816, -668.3005809784493, -817.6324127460357, -575.5426486006425, -844.338362443564, -987.9638919071522, -964.0078814003056, -575.0411396747068, -486.9990873779783, -810.4021681023249, -1020.3625499691664, -788.4657366836122, -1059.1970154748042, -491.5507545100828, -538.8076432084302, -802.9904993100657, -483.486963464396, -1093.3772423579098, -1154.7176883418608, -679.809950071456, -628.7414875841309, -620.1015333203428, -690.1998822665496, -565.2021177932787, -633.5753863466925, -647.6501468015776, -1247.5517022468086, -990.2846551648403, -554.2219541785735, -880.0112778118812, -743.7017521335646, -531.721159893199, -807.166822801979, -551.432737099075, -890.643322597953, -822.2198866915962, -710.9860813596496, -937.5742495392379, -662.4326357313347, -800.6691972778154, -658.2315142840092, -700.7227396798912, -586.691534492754, -761.4475237982085, -733.9128377870884, -782.827678748833, -549.3468543859714, -774.413592672589, -682.1860211806298, -751.5461669019867, -673.7653080406461, -719.383273251562, -860.7816931032946, -574.5873207935329, -758.1958160256859, -814.6505144404368, -550.202945075386, -711.9037625285532, -651.2176932449257, -924.0613606677422, -1116.3976631432336, -654.0189189977006, -501.74581124005044, -798.3699660057422, -1203.9385734942814, -1082.0907286407714, -394.41729969669444, -677.9611896108728, -540.2029569599493, -754.0495819975154, -684.376520070522, -1026.549368134969, -581.8008976875988, -876.150756472005], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 21.076774030920422, "mean_inference_ms": 0.4014601897181373, "mean_action_processing_ms": 0.09581466676059555, "mean_env_wait_ms": 2.823019245763594, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003949880599975586, "StateBufferConnector_ms": 0.002747774124145508, "ViewRequirementAgentConnector_ms": 0.06831932067871094}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 242520, "num_agent_steps_trained": 242520, "num_env_steps_sampled": 242520, "num_env_steps_trained": 242520, "num_env_steps_sampled_this_iter": 480, "num_env_steps_trained_this_iter": 480, "num_env_steps_sampled_throughput_per_sec": 41.21037195809936, "num_env_steps_trained_throughput_per_sec": 41.21037195809936, "timesteps_total": 242520, "num_steps_trained_this_iter": 480, "agent_timesteps_total": 242520, "timers": {"training_iteration_time_ms": 2885.756, "sample_time_ms": 2881.875, "load_time_ms": 0.23, "load_throughput": 522654.704, "learn_time_ms": 2.883, "learn_throughput": 41621.514, "synch_weights_time_ms": 0.726}, "counters": {"num_env_steps_sampled": 242520, "num_env_steps_trained": 242520, "num_agent_steps_sampled": 242520, "num_agent_steps_trained": 242520}, "done": false, "episodes_total": 2021, "training_iteration": 506, "trial_id": "29a31_00000", "date": "2023-07-26_02-31-50", "timestamp": 1690327910, "time_this_iter_s": 11.650345802307129, "time_total_s": 6157.574502706528, "pid": 90822, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 1, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[253680, 5e-06], [256080, 5e-06], [258480, 2.5e-06], [260880, 2.5e-06], [263280, 2.5e-06], [265680, 2.5e-06], [268080, 1e-06], [270480, 1e-06], [272880, 1e-06], [275280, 5e-07], [277680, 5e-07], [280080, 5e-07], [282480, 5e-07], [284880, 5e-07], [287280, 1e-07], [289680, 1e-07], [292080, 1e-07]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 120, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x16ca65700>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 536.2490267753601, "iterations_since_restore": 46, "perf": {"cpu_util_percent": 35.28823529411765, "ram_util_percent": 74.04705882352941}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-07, "entropy_coeff": 0.05, "policy_entropy": 267.43890380859375, "policy_loss": -106015.2578125, "vf_loss": 5631807.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 187.0, "diff_num_grad_updates_vs_sampler_policy": 186.0}}, "num_env_steps_sampled": 243000, "num_env_steps_trained": 243000, "num_agent_steps_sampled": 243000, "num_agent_steps_trained": 243000}, "sampler_results": {"episode_reward_max": -360.4635582382683, "episode_reward_min": -1247.5517022468086, "episode_reward_mean": -754.1435909333261, "episode_len_mean": 120.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-689.7443666324847, -770.2809562845098, -932.3016437312655, -614.6595939800584, -536.4521534334979, -401.0565983900857, -735.497953612034, -1186.642378836706, -728.6278433915107, -832.3646724203976, -664.031553164132, -621.1268227183493, -360.4635582382683, -783.908098890003, -816.2804678552773, -598.5624720922849, -821.8618812052129, -798.6359594142689, -914.7550554229312, -907.387398828879, -806.032838220834, -853.2777366222037, -535.9236276345816, -668.3005809784493, -817.6324127460357, -575.5426486006425, -844.338362443564, -987.9638919071522, -964.0078814003056, -575.0411396747068, -486.9990873779783, -810.4021681023249, -1020.3625499691664, -788.4657366836122, -1059.1970154748042, -491.5507545100828, -538.8076432084302, -802.9904993100657, -483.486963464396, -1093.3772423579098, -1154.7176883418608, -679.809950071456, -628.7414875841309, -620.1015333203428, -690.1998822665496, -565.2021177932787, -633.5753863466925, -647.6501468015776, -1247.5517022468086, -990.2846551648403, -554.2219541785735, -880.0112778118812, -743.7017521335646, -531.721159893199, -807.166822801979, -551.432737099075, -890.643322597953, -822.2198866915962, -710.9860813596496, -937.5742495392379, -662.4326357313347, -800.6691972778154, -658.2315142840092, -700.7227396798912, -586.691534492754, -761.4475237982085, -733.9128377870884, -782.827678748833, -549.3468543859714, -774.413592672589, -682.1860211806298, -751.5461669019867, -673.7653080406461, -719.383273251562, -860.7816931032946, -574.5873207935329, -758.1958160256859, -814.6505144404368, -550.202945075386, -711.9037625285532, -651.2176932449257, -924.0613606677422, -1116.3976631432336, -654.0189189977006, -501.74581124005044, -798.3699660057422, -1203.9385734942814, -1082.0907286407714, -394.41729969669444, -677.9611896108728, -540.2029569599493, -754.0495819975154, -684.376520070522, -1026.549368134969, -581.8008976875988, -876.150756472005, -1026.3913555404197, -941.0153748167279, -894.517853659287, -771.3302897777419], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 21.075829361880405, "mean_inference_ms": 0.40152371894127453, "mean_action_processing_ms": 0.09582320945037369, "mean_env_wait_ms": 2.8173503480070616, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003953695297241211, "StateBufferConnector_ms": 0.002745389938354492, "ViewRequirementAgentConnector_ms": 0.06832075119018555}}, "episode_reward_max": -360.4635582382683, "episode_reward_min": -1247.5517022468086, "episode_reward_mean": -754.1435909333261, "episode_len_mean": 120.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-689.7443666324847, -770.2809562845098, -932.3016437312655, -614.6595939800584, -536.4521534334979, -401.0565983900857, -735.497953612034, -1186.642378836706, -728.6278433915107, -832.3646724203976, -664.031553164132, -621.1268227183493, -360.4635582382683, -783.908098890003, -816.2804678552773, -598.5624720922849, -821.8618812052129, -798.6359594142689, -914.7550554229312, -907.387398828879, -806.032838220834, -853.2777366222037, -535.9236276345816, -668.3005809784493, -817.6324127460357, -575.5426486006425, -844.338362443564, -987.9638919071522, -964.0078814003056, -575.0411396747068, -486.9990873779783, -810.4021681023249, -1020.3625499691664, -788.4657366836122, -1059.1970154748042, -491.5507545100828, -538.8076432084302, -802.9904993100657, -483.486963464396, -1093.3772423579098, -1154.7176883418608, -679.809950071456, -628.7414875841309, -620.1015333203428, -690.1998822665496, -565.2021177932787, -633.5753863466925, -647.6501468015776, -1247.5517022468086, -990.2846551648403, -554.2219541785735, -880.0112778118812, -743.7017521335646, -531.721159893199, -807.166822801979, -551.432737099075, -890.643322597953, -822.2198866915962, -710.9860813596496, -937.5742495392379, -662.4326357313347, -800.6691972778154, -658.2315142840092, -700.7227396798912, -586.691534492754, -761.4475237982085, -733.9128377870884, -782.827678748833, -549.3468543859714, -774.413592672589, -682.1860211806298, -751.5461669019867, -673.7653080406461, -719.383273251562, -860.7816931032946, -574.5873207935329, -758.1958160256859, -814.6505144404368, -550.202945075386, -711.9037625285532, -651.2176932449257, -924.0613606677422, -1116.3976631432336, -654.0189189977006, -501.74581124005044, -798.3699660057422, -1203.9385734942814, -1082.0907286407714, -394.41729969669444, -677.9611896108728, -540.2029569599493, -754.0495819975154, -684.376520070522, -1026.549368134969, -581.8008976875988, -876.150756472005, -1026.3913555404197, -941.0153748167279, -894.517853659287, -771.3302897777419], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 21.075829361880405, "mean_inference_ms": 0.40152371894127453, "mean_action_processing_ms": 0.09582320945037369, "mean_env_wait_ms": 2.8173503480070616, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003953695297241211, "StateBufferConnector_ms": 0.002745389938354492, "ViewRequirementAgentConnector_ms": 0.06832075119018555}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 243000, "num_agent_steps_trained": 243000, "num_env_steps_sampled": 243000, "num_env_steps_trained": 243000, "num_env_steps_sampled_this_iter": 480, "num_env_steps_trained_this_iter": 480, "num_env_steps_sampled_throughput_per_sec": 41.32477911867264, "num_env_steps_trained_throughput_per_sec": 41.32477911867264, "timesteps_total": 243000, "num_steps_trained_this_iter": 480, "agent_timesteps_total": 243000, "timers": {"training_iteration_time_ms": 2901.282, "sample_time_ms": 2897.523, "load_time_ms": 0.225, "load_throughput": 534249.528, "learn_time_ms": 2.793, "learn_throughput": 42967.089, "synch_weights_time_ms": 0.701}, "counters": {"num_env_steps_sampled": 243000, "num_env_steps_trained": 243000, "num_agent_steps_sampled": 243000, "num_agent_steps_trained": 243000}, "done": false, "episodes_total": 2025, "training_iteration": 507, "trial_id": "29a31_00000", "date": "2023-07-26_02-32-02", "timestamp": 1690327922, "time_this_iter_s": 11.618072032928467, "time_total_s": 6169.192574739456, "pid": 90822, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 1, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[253680, 5e-06], [256080, 5e-06], [258480, 2.5e-06], [260880, 2.5e-06], [263280, 2.5e-06], [265680, 2.5e-06], [268080, 1e-06], [270480, 1e-06], [272880, 1e-06], [275280, 5e-07], [277680, 5e-07], [280080, 5e-07], [282480, 5e-07], [284880, 5e-07], [287280, 1e-07], [289680, 1e-07], [292080, 1e-07]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 120, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x16ca65700>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 547.8670988082886, "iterations_since_restore": 47, "perf": {"cpu_util_percent": 32.59375, "ram_util_percent": 72.35}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-07, "entropy_coeff": 0.05, "policy_entropy": 267.4263916015625, "policy_loss": -128445.640625, "vf_loss": 6989954.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 191.0, "diff_num_grad_updates_vs_sampler_policy": 190.0}}, "num_env_steps_sampled": 243480, "num_env_steps_trained": 243480, "num_agent_steps_sampled": 243480, "num_agent_steps_trained": 243480}, "sampler_results": {"episode_reward_max": -360.4635582382683, "episode_reward_min": -1247.5517022468086, "episode_reward_mean": -760.4195444556124, "episode_len_mean": 120.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-536.4521534334979, -401.0565983900857, -735.497953612034, -1186.642378836706, -728.6278433915107, -832.3646724203976, -664.031553164132, -621.1268227183493, -360.4635582382683, -783.908098890003, -816.2804678552773, -598.5624720922849, -821.8618812052129, -798.6359594142689, -914.7550554229312, -907.387398828879, -806.032838220834, -853.2777366222037, -535.9236276345816, -668.3005809784493, -817.6324127460357, -575.5426486006425, -844.338362443564, -987.9638919071522, -964.0078814003056, -575.0411396747068, -486.9990873779783, -810.4021681023249, -1020.3625499691664, -788.4657366836122, -1059.1970154748042, -491.5507545100828, -538.8076432084302, -802.9904993100657, -483.486963464396, -1093.3772423579098, -1154.7176883418608, -679.809950071456, -628.7414875841309, -620.1015333203428, -690.1998822665496, -565.2021177932787, -633.5753863466925, -647.6501468015776, -1247.5517022468086, -990.2846551648403, -554.2219541785735, -880.0112778118812, -743.7017521335646, -531.721159893199, -807.166822801979, -551.432737099075, -890.643322597953, -822.2198866915962, -710.9860813596496, -937.5742495392379, -662.4326357313347, -800.6691972778154, -658.2315142840092, -700.7227396798912, -586.691534492754, -761.4475237982085, -733.9128377870884, -782.827678748833, -549.3468543859714, -774.413592672589, -682.1860211806298, -751.5461669019867, -673.7653080406461, -719.383273251562, -860.7816931032946, -574.5873207935329, -758.1958160256859, -814.6505144404368, -550.202945075386, -711.9037625285532, -651.2176932449257, -924.0613606677422, -1116.3976631432336, -654.0189189977006, -501.74581124005044, -798.3699660057422, -1203.9385734942814, -1082.0907286407714, -394.41729969669444, -677.9611896108728, -540.2029569599493, -754.0495819975154, -684.376520070522, -1026.549368134969, -581.8008976875988, -876.150756472005, -1026.3913555404197, -941.0153748167279, -894.517853659287, -771.3302897777419, -1000.0613863105932, -842.1085515218751, -978.9860428100424, -813.4259322144324], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 21.07543749446419, "mean_inference_ms": 0.40156553511941195, "mean_action_processing_ms": 0.09582784237882677, "mean_env_wait_ms": 2.812104144403364, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003943443298339844, "StateBufferConnector_ms": 0.002741098403930664, "ViewRequirementAgentConnector_ms": 0.06811952590942383}}, "episode_reward_max": -360.4635582382683, "episode_reward_min": -1247.5517022468086, "episode_reward_mean": -760.4195444556124, "episode_len_mean": 120.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-536.4521534334979, -401.0565983900857, -735.497953612034, -1186.642378836706, -728.6278433915107, -832.3646724203976, -664.031553164132, -621.1268227183493, -360.4635582382683, -783.908098890003, -816.2804678552773, -598.5624720922849, -821.8618812052129, -798.6359594142689, -914.7550554229312, -907.387398828879, -806.032838220834, -853.2777366222037, -535.9236276345816, -668.3005809784493, -817.6324127460357, -575.5426486006425, -844.338362443564, -987.9638919071522, -964.0078814003056, -575.0411396747068, -486.9990873779783, -810.4021681023249, -1020.3625499691664, -788.4657366836122, -1059.1970154748042, -491.5507545100828, -538.8076432084302, -802.9904993100657, -483.486963464396, -1093.3772423579098, -1154.7176883418608, -679.809950071456, -628.7414875841309, -620.1015333203428, -690.1998822665496, -565.2021177932787, -633.5753863466925, -647.6501468015776, -1247.5517022468086, -990.2846551648403, -554.2219541785735, -880.0112778118812, -743.7017521335646, -531.721159893199, -807.166822801979, -551.432737099075, -890.643322597953, -822.2198866915962, -710.9860813596496, -937.5742495392379, -662.4326357313347, -800.6691972778154, -658.2315142840092, -700.7227396798912, -586.691534492754, -761.4475237982085, -733.9128377870884, -782.827678748833, -549.3468543859714, -774.413592672589, -682.1860211806298, -751.5461669019867, -673.7653080406461, -719.383273251562, -860.7816931032946, -574.5873207935329, -758.1958160256859, -814.6505144404368, -550.202945075386, -711.9037625285532, -651.2176932449257, -924.0613606677422, -1116.3976631432336, -654.0189189977006, -501.74581124005044, -798.3699660057422, -1203.9385734942814, -1082.0907286407714, -394.41729969669444, -677.9611896108728, -540.2029569599493, -754.0495819975154, -684.376520070522, -1026.549368134969, -581.8008976875988, -876.150756472005, -1026.3913555404197, -941.0153748167279, -894.517853659287, -771.3302897777419, -1000.0613863105932, -842.1085515218751, -978.9860428100424, -813.4259322144324], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 21.07543749446419, "mean_inference_ms": 0.40156553511941195, "mean_action_processing_ms": 0.09582784237882677, "mean_env_wait_ms": 2.812104144403364, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003943443298339844, "StateBufferConnector_ms": 0.002741098403930664, "ViewRequirementAgentConnector_ms": 0.06811952590942383}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 243480, "num_agent_steps_trained": 243480, "num_env_steps_sampled": 243480, "num_env_steps_trained": 243480, "num_env_steps_sampled_this_iter": 480, "num_env_steps_trained_this_iter": 480, "num_env_steps_sampled_throughput_per_sec": 40.99515013849766, "num_env_steps_trained_throughput_per_sec": 40.99515013849766, "timesteps_total": 243480, "num_steps_trained_this_iter": 480, "agent_timesteps_total": 243480, "timers": {"training_iteration_time_ms": 2921.13, "sample_time_ms": 2917.357, "load_time_ms": 0.224, "load_throughput": 535899.148, "learn_time_ms": 2.802, "learn_throughput": 42824.876, "synch_weights_time_ms": 0.706}, "counters": {"num_env_steps_sampled": 243480, "num_env_steps_trained": 243480, "num_agent_steps_sampled": 243480, "num_agent_steps_trained": 243480}, "done": false, "episodes_total": 2029, "training_iteration": 508, "trial_id": "29a31_00000", "date": "2023-07-26_02-32-14", "timestamp": 1690327934, "time_this_iter_s": 11.711475372314453, "time_total_s": 6180.904050111771, "pid": 90822, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 1, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[253680, 5e-06], [256080, 5e-06], [258480, 2.5e-06], [260880, 2.5e-06], [263280, 2.5e-06], [265680, 2.5e-06], [268080, 1e-06], [270480, 1e-06], [272880, 1e-06], [275280, 5e-07], [277680, 5e-07], [280080, 5e-07], [282480, 5e-07], [284880, 5e-07], [287280, 1e-07], [289680, 1e-07], [292080, 1e-07]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 120, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x16ca65700>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 559.578574180603, "iterations_since_restore": 48, "perf": {"cpu_util_percent": 43.22941176470588, "ram_util_percent": 72.92941176470588}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-07, "entropy_coeff": 0.05, "policy_entropy": 267.45556640625, "policy_loss": -94612.671875, "vf_loss": 4308709.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 195.0, "diff_num_grad_updates_vs_sampler_policy": 194.0}}, "num_env_steps_sampled": 243960, "num_env_steps_trained": 243960, "num_agent_steps_sampled": 243960, "num_agent_steps_trained": 243960}, "sampler_results": {"episode_reward_max": -360.4635582382683, "episode_reward_min": -1247.5517022468086, "episode_reward_mean": -761.6219065008243, "episode_len_mean": 120.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-728.6278433915107, -832.3646724203976, -664.031553164132, -621.1268227183493, -360.4635582382683, -783.908098890003, -816.2804678552773, -598.5624720922849, -821.8618812052129, -798.6359594142689, -914.7550554229312, -907.387398828879, -806.032838220834, -853.2777366222037, -535.9236276345816, -668.3005809784493, -817.6324127460357, -575.5426486006425, -844.338362443564, -987.9638919071522, -964.0078814003056, -575.0411396747068, -486.9990873779783, -810.4021681023249, -1020.3625499691664, -788.4657366836122, -1059.1970154748042, -491.5507545100828, -538.8076432084302, -802.9904993100657, -483.486963464396, -1093.3772423579098, -1154.7176883418608, -679.809950071456, -628.7414875841309, -620.1015333203428, -690.1998822665496, -565.2021177932787, -633.5753863466925, -647.6501468015776, -1247.5517022468086, -990.2846551648403, -554.2219541785735, -880.0112778118812, -743.7017521335646, -531.721159893199, -807.166822801979, -551.432737099075, -890.643322597953, -822.2198866915962, -710.9860813596496, -937.5742495392379, -662.4326357313347, -800.6691972778154, -658.2315142840092, -700.7227396798912, -586.691534492754, -761.4475237982085, -733.9128377870884, -782.827678748833, -549.3468543859714, -774.413592672589, -682.1860211806298, -751.5461669019867, -673.7653080406461, -719.383273251562, -860.7816931032946, -574.5873207935329, -758.1958160256859, -814.6505144404368, -550.202945075386, -711.9037625285532, -651.2176932449257, -924.0613606677422, -1116.3976631432336, -654.0189189977006, -501.74581124005044, -798.3699660057422, -1203.9385734942814, -1082.0907286407714, -394.41729969669444, -677.9611896108728, -540.2029569599493, -754.0495819975154, -684.376520070522, -1026.549368134969, -581.8008976875988, -876.150756472005, -1026.3913555404197, -941.0153748167279, -894.517853659287, -771.3302897777419, -1000.0613863105932, -842.1085515218751, -978.9860428100424, -813.4259322144324, -855.2558251874146, -809.3701680786904, -623.5688613804812, -691.690434146929], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 21.0758805101339, "mean_inference_ms": 0.4015795237289532, "mean_action_processing_ms": 0.09582943785085726, "mean_env_wait_ms": 2.8072967611180224, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003959178924560547, "StateBufferConnector_ms": 0.002745389938354492, "ViewRequirementAgentConnector_ms": 0.0683138370513916}}, "episode_reward_max": -360.4635582382683, "episode_reward_min": -1247.5517022468086, "episode_reward_mean": -761.6219065008243, "episode_len_mean": 120.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-728.6278433915107, -832.3646724203976, -664.031553164132, -621.1268227183493, -360.4635582382683, -783.908098890003, -816.2804678552773, -598.5624720922849, -821.8618812052129, -798.6359594142689, -914.7550554229312, -907.387398828879, -806.032838220834, -853.2777366222037, -535.9236276345816, -668.3005809784493, -817.6324127460357, -575.5426486006425, -844.338362443564, -987.9638919071522, -964.0078814003056, -575.0411396747068, -486.9990873779783, -810.4021681023249, -1020.3625499691664, -788.4657366836122, -1059.1970154748042, -491.5507545100828, -538.8076432084302, -802.9904993100657, -483.486963464396, -1093.3772423579098, -1154.7176883418608, -679.809950071456, -628.7414875841309, -620.1015333203428, -690.1998822665496, -565.2021177932787, -633.5753863466925, -647.6501468015776, -1247.5517022468086, -990.2846551648403, -554.2219541785735, -880.0112778118812, -743.7017521335646, -531.721159893199, -807.166822801979, -551.432737099075, -890.643322597953, -822.2198866915962, -710.9860813596496, -937.5742495392379, -662.4326357313347, -800.6691972778154, -658.2315142840092, -700.7227396798912, -586.691534492754, -761.4475237982085, -733.9128377870884, -782.827678748833, -549.3468543859714, -774.413592672589, -682.1860211806298, -751.5461669019867, -673.7653080406461, -719.383273251562, -860.7816931032946, -574.5873207935329, -758.1958160256859, -814.6505144404368, -550.202945075386, -711.9037625285532, -651.2176932449257, -924.0613606677422, -1116.3976631432336, -654.0189189977006, -501.74581124005044, -798.3699660057422, -1203.9385734942814, -1082.0907286407714, -394.41729969669444, -677.9611896108728, -540.2029569599493, -754.0495819975154, -684.376520070522, -1026.549368134969, -581.8008976875988, -876.150756472005, -1026.3913555404197, -941.0153748167279, -894.517853659287, -771.3302897777419, -1000.0613863105932, -842.1085515218751, -978.9860428100424, -813.4259322144324, -855.2558251874146, -809.3701680786904, -623.5688613804812, -691.690434146929], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 21.0758805101339, "mean_inference_ms": 0.4015795237289532, "mean_action_processing_ms": 0.09582943785085726, "mean_env_wait_ms": 2.8072967611180224, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003959178924560547, "StateBufferConnector_ms": 0.002745389938354492, "ViewRequirementAgentConnector_ms": 0.0683138370513916}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 243960, "num_agent_steps_trained": 243960, "num_env_steps_sampled": 243960, "num_env_steps_trained": 243960, "num_env_steps_sampled_this_iter": 480, "num_env_steps_trained_this_iter": 480, "num_env_steps_sampled_throughput_per_sec": 39.71540304330124, "num_env_steps_trained_throughput_per_sec": 39.71540304330124, "timesteps_total": 243960, "num_steps_trained_this_iter": 480, "agent_timesteps_total": 243960, "timers": {"training_iteration_time_ms": 2954.907, "sample_time_ms": 2951.123, "load_time_ms": 0.225, "load_throughput": 533343.732, "learn_time_ms": 2.8, "learn_throughput": 42860.249, "synch_weights_time_ms": 0.713}, "counters": {"num_env_steps_sampled": 243960, "num_env_steps_trained": 243960, "num_agent_steps_sampled": 243960, "num_agent_steps_trained": 243960}, "done": false, "episodes_total": 2033, "training_iteration": 509, "trial_id": "29a31_00000", "date": "2023-07-26_02-32-26", "timestamp": 1690327946, "time_this_iter_s": 12.0887291431427, "time_total_s": 6192.992779254913, "pid": 90822, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 1, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[253680, 5e-06], [256080, 5e-06], [258480, 2.5e-06], [260880, 2.5e-06], [263280, 2.5e-06], [265680, 2.5e-06], [268080, 1e-06], [270480, 1e-06], [272880, 1e-06], [275280, 5e-07], [277680, 5e-07], [280080, 5e-07], [282480, 5e-07], [284880, 5e-07], [287280, 1e-07], [289680, 1e-07], [292080, 1e-07]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 120, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x16ca65700>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 571.6673033237457, "iterations_since_restore": 49, "perf": {"cpu_util_percent": 39.28235294117647, "ram_util_percent": 75.60588235294118}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-07, "entropy_coeff": 0.05, "policy_entropy": 267.4376525878906, "policy_loss": -81366.96875, "vf_loss": 3401203.75}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 199.0, "diff_num_grad_updates_vs_sampler_policy": 198.0}}, "num_env_steps_sampled": 244440, "num_env_steps_trained": 244440, "num_agent_steps_sampled": 244440, "num_agent_steps_trained": 244440}, "sampler_results": {"episode_reward_max": -360.4635582382683, "episode_reward_min": -1247.5517022468086, "episode_reward_mean": -770.7180719983392, "episode_len_mean": 120.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-360.4635582382683, -783.908098890003, -816.2804678552773, -598.5624720922849, -821.8618812052129, -798.6359594142689, -914.7550554229312, -907.387398828879, -806.032838220834, -853.2777366222037, -535.9236276345816, -668.3005809784493, -817.6324127460357, -575.5426486006425, -844.338362443564, -987.9638919071522, -964.0078814003056, -575.0411396747068, -486.9990873779783, -810.4021681023249, -1020.3625499691664, -788.4657366836122, -1059.1970154748042, -491.5507545100828, -538.8076432084302, -802.9904993100657, -483.486963464396, -1093.3772423579098, -1154.7176883418608, -679.809950071456, -628.7414875841309, -620.1015333203428, -690.1998822665496, -565.2021177932787, -633.5753863466925, -647.6501468015776, -1247.5517022468086, -990.2846551648403, -554.2219541785735, -880.0112778118812, -743.7017521335646, -531.721159893199, -807.166822801979, -551.432737099075, -890.643322597953, -822.2198866915962, -710.9860813596496, -937.5742495392379, -662.4326357313347, -800.6691972778154, -658.2315142840092, -700.7227396798912, -586.691534492754, -761.4475237982085, -733.9128377870884, -782.827678748833, -549.3468543859714, -774.413592672589, -682.1860211806298, -751.5461669019867, -673.7653080406461, -719.383273251562, -860.7816931032946, -574.5873207935329, -758.1958160256859, -814.6505144404368, -550.202945075386, -711.9037625285532, -651.2176932449257, -924.0613606677422, -1116.3976631432336, -654.0189189977006, -501.74581124005044, -798.3699660057422, -1203.9385734942814, -1082.0907286407714, -394.41729969669444, -677.9611896108728, -540.2029569599493, -754.0495819975154, -684.376520070522, -1026.549368134969, -581.8008976875988, -876.150756472005, -1026.3913555404197, -941.0153748167279, -894.517853659287, -771.3302897777419, -1000.0613863105932, -842.1085515218751, -978.9860428100424, -813.4259322144324, -855.2558251874146, -809.3701680786904, -623.5688613804812, -691.690434146929, -1079.2199202035683, -981.7720482360744, -1082.7679266808696, -612.0075463253661], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 21.07673032694273, "mean_inference_ms": 0.4015990324054002, "mean_action_processing_ms": 0.09583229673526537, "mean_env_wait_ms": 2.8028685257188055, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003958463668823242, "StateBufferConnector_ms": 0.0027480125427246094, "ViewRequirementAgentConnector_ms": 0.06827592849731445}}, "episode_reward_max": -360.4635582382683, "episode_reward_min": -1247.5517022468086, "episode_reward_mean": -770.7180719983392, "episode_len_mean": 120.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-360.4635582382683, -783.908098890003, -816.2804678552773, -598.5624720922849, -821.8618812052129, -798.6359594142689, -914.7550554229312, -907.387398828879, -806.032838220834, -853.2777366222037, -535.9236276345816, -668.3005809784493, -817.6324127460357, -575.5426486006425, -844.338362443564, -987.9638919071522, -964.0078814003056, -575.0411396747068, -486.9990873779783, -810.4021681023249, -1020.3625499691664, -788.4657366836122, -1059.1970154748042, -491.5507545100828, -538.8076432084302, -802.9904993100657, -483.486963464396, -1093.3772423579098, -1154.7176883418608, -679.809950071456, -628.7414875841309, -620.1015333203428, -690.1998822665496, -565.2021177932787, -633.5753863466925, -647.6501468015776, -1247.5517022468086, -990.2846551648403, -554.2219541785735, -880.0112778118812, -743.7017521335646, -531.721159893199, -807.166822801979, -551.432737099075, -890.643322597953, -822.2198866915962, -710.9860813596496, -937.5742495392379, -662.4326357313347, -800.6691972778154, -658.2315142840092, -700.7227396798912, -586.691534492754, -761.4475237982085, -733.9128377870884, -782.827678748833, -549.3468543859714, -774.413592672589, -682.1860211806298, -751.5461669019867, -673.7653080406461, -719.383273251562, -860.7816931032946, -574.5873207935329, -758.1958160256859, -814.6505144404368, -550.202945075386, -711.9037625285532, -651.2176932449257, -924.0613606677422, -1116.3976631432336, -654.0189189977006, -501.74581124005044, -798.3699660057422, -1203.9385734942814, -1082.0907286407714, -394.41729969669444, -677.9611896108728, -540.2029569599493, -754.0495819975154, -684.376520070522, -1026.549368134969, -581.8008976875988, -876.150756472005, -1026.3913555404197, -941.0153748167279, -894.517853659287, -771.3302897777419, -1000.0613863105932, -842.1085515218751, -978.9860428100424, -813.4259322144324, -855.2558251874146, -809.3701680786904, -623.5688613804812, -691.690434146929, -1079.2199202035683, -981.7720482360744, -1082.7679266808696, -612.0075463253661], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 21.07673032694273, "mean_inference_ms": 0.4015990324054002, "mean_action_processing_ms": 0.09583229673526537, "mean_env_wait_ms": 2.8028685257188055, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003958463668823242, "StateBufferConnector_ms": 0.0027480125427246094, "ViewRequirementAgentConnector_ms": 0.06827592849731445}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 244440, "num_agent_steps_trained": 244440, "num_env_steps_sampled": 244440, "num_env_steps_trained": 244440, "num_env_steps_sampled_this_iter": 480, "num_env_steps_trained_this_iter": 480, "num_env_steps_sampled_throughput_per_sec": 41.48304659552416, "num_env_steps_trained_throughput_per_sec": 41.48304659552416, "timesteps_total": 244440, "num_steps_trained_this_iter": 480, "agent_timesteps_total": 244440, "timers": {"training_iteration_time_ms": 2941.099, "sample_time_ms": 2937.265, "load_time_ms": 0.226, "load_throughput": 531541.324, "learn_time_ms": 2.844, "learn_throughput": 42199.401, "synch_weights_time_ms": 0.718}, "counters": {"num_env_steps_sampled": 244440, "num_env_steps_trained": 244440, "num_agent_steps_sampled": 244440, "num_agent_steps_trained": 244440}, "done": false, "episodes_total": 2037, "training_iteration": 510, "trial_id": "29a31_00000", "date": "2023-07-26_02-32-37", "timestamp": 1690327957, "time_this_iter_s": 11.573752164840698, "time_total_s": 6204.566531419754, "pid": 90822, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 1, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[253680, 5e-06], [256080, 5e-06], [258480, 2.5e-06], [260880, 2.5e-06], [263280, 2.5e-06], [265680, 2.5e-06], [268080, 1e-06], [270480, 1e-06], [272880, 1e-06], [275280, 5e-07], [277680, 5e-07], [280080, 5e-07], [282480, 5e-07], [284880, 5e-07], [287280, 1e-07], [289680, 1e-07], [292080, 1e-07]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 120, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x16ca65700>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 583.2410554885864, "iterations_since_restore": 50, "perf": {"cpu_util_percent": 35.5625, "ram_util_percent": 77.26875}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-07, "entropy_coeff": 0.05, "policy_entropy": 267.467041015625, "policy_loss": -108338.2734375, "vf_loss": 5159909.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 203.0, "diff_num_grad_updates_vs_sampler_policy": 202.0}}, "num_env_steps_sampled": 244920, "num_env_steps_trained": 244920, "num_agent_steps_sampled": 244920, "num_agent_steps_trained": 244920}, "sampler_results": {"episode_reward_max": -394.41729969669444, "episode_reward_min": -1247.5517022468086, "episode_reward_mean": -773.3227411136899, "episode_len_mean": 120.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-821.8618812052129, -798.6359594142689, -914.7550554229312, -907.387398828879, -806.032838220834, -853.2777366222037, -535.9236276345816, -668.3005809784493, -817.6324127460357, -575.5426486006425, -844.338362443564, -987.9638919071522, -964.0078814003056, -575.0411396747068, -486.9990873779783, -810.4021681023249, -1020.3625499691664, -788.4657366836122, -1059.1970154748042, -491.5507545100828, -538.8076432084302, -802.9904993100657, -483.486963464396, -1093.3772423579098, -1154.7176883418608, -679.809950071456, -628.7414875841309, -620.1015333203428, -690.1998822665496, -565.2021177932787, -633.5753863466925, -647.6501468015776, -1247.5517022468086, -990.2846551648403, -554.2219541785735, -880.0112778118812, -743.7017521335646, -531.721159893199, -807.166822801979, -551.432737099075, -890.643322597953, -822.2198866915962, -710.9860813596496, -937.5742495392379, -662.4326357313347, -800.6691972778154, -658.2315142840092, -700.7227396798912, -586.691534492754, -761.4475237982085, -733.9128377870884, -782.827678748833, -549.3468543859714, -774.413592672589, -682.1860211806298, -751.5461669019867, -673.7653080406461, -719.383273251562, -860.7816931032946, -574.5873207935329, -758.1958160256859, -814.6505144404368, -550.202945075386, -711.9037625285532, -651.2176932449257, -924.0613606677422, -1116.3976631432336, -654.0189189977006, -501.74581124005044, -798.3699660057422, -1203.9385734942814, -1082.0907286407714, -394.41729969669444, -677.9611896108728, -540.2029569599493, -754.0495819975154, -684.376520070522, -1026.549368134969, -581.8008976875988, -876.150756472005, -1026.3913555404197, -941.0153748167279, -894.517853659287, -771.3302897777419, -1000.0613863105932, -842.1085515218751, -978.9860428100424, -813.4259322144324, -855.2558251874146, -809.3701680786904, -623.5688613804812, -691.690434146929, -1079.2199202035683, -981.7720482360744, -1082.7679266808696, -612.0075463253661, -727.6773331050063, -530.4021591506896, -704.1432740093248, -857.4587423458685], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 21.076423158092634, "mean_inference_ms": 0.40160721473447625, "mean_action_processing_ms": 0.09583283688934141, "mean_env_wait_ms": 2.7986576509559686, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0039577484130859375, "StateBufferConnector_ms": 0.0027437210083007812, "ViewRequirementAgentConnector_ms": 0.06831693649291992}}, "episode_reward_max": -394.41729969669444, "episode_reward_min": -1247.5517022468086, "episode_reward_mean": -773.3227411136899, "episode_len_mean": 120.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-821.8618812052129, -798.6359594142689, -914.7550554229312, -907.387398828879, -806.032838220834, -853.2777366222037, -535.9236276345816, -668.3005809784493, -817.6324127460357, -575.5426486006425, -844.338362443564, -987.9638919071522, -964.0078814003056, -575.0411396747068, -486.9990873779783, -810.4021681023249, -1020.3625499691664, -788.4657366836122, -1059.1970154748042, -491.5507545100828, -538.8076432084302, -802.9904993100657, -483.486963464396, -1093.3772423579098, -1154.7176883418608, -679.809950071456, -628.7414875841309, -620.1015333203428, -690.1998822665496, -565.2021177932787, -633.5753863466925, -647.6501468015776, -1247.5517022468086, -990.2846551648403, -554.2219541785735, -880.0112778118812, -743.7017521335646, -531.721159893199, -807.166822801979, -551.432737099075, -890.643322597953, -822.2198866915962, -710.9860813596496, -937.5742495392379, -662.4326357313347, -800.6691972778154, -658.2315142840092, -700.7227396798912, -586.691534492754, -761.4475237982085, -733.9128377870884, -782.827678748833, -549.3468543859714, -774.413592672589, -682.1860211806298, -751.5461669019867, -673.7653080406461, -719.383273251562, -860.7816931032946, -574.5873207935329, -758.1958160256859, -814.6505144404368, -550.202945075386, -711.9037625285532, -651.2176932449257, -924.0613606677422, -1116.3976631432336, -654.0189189977006, -501.74581124005044, -798.3699660057422, -1203.9385734942814, -1082.0907286407714, -394.41729969669444, -677.9611896108728, -540.2029569599493, -754.0495819975154, -684.376520070522, -1026.549368134969, -581.8008976875988, -876.150756472005, -1026.3913555404197, -941.0153748167279, -894.517853659287, -771.3302897777419, -1000.0613863105932, -842.1085515218751, -978.9860428100424, -813.4259322144324, -855.2558251874146, -809.3701680786904, -623.5688613804812, -691.690434146929, -1079.2199202035683, -981.7720482360744, -1082.7679266808696, -612.0075463253661, -727.6773331050063, -530.4021591506896, -704.1432740093248, -857.4587423458685], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 21.076423158092634, "mean_inference_ms": 0.40160721473447625, "mean_action_processing_ms": 0.09583283688934141, "mean_env_wait_ms": 2.7986576509559686, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0039577484130859375, "StateBufferConnector_ms": 0.0027437210083007812, "ViewRequirementAgentConnector_ms": 0.06831693649291992}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 244920, "num_agent_steps_trained": 244920, "num_env_steps_sampled": 244920, "num_env_steps_trained": 244920, "num_env_steps_sampled_this_iter": 480, "num_env_steps_trained_this_iter": 480, "num_env_steps_sampled_throughput_per_sec": 41.296571426063075, "num_env_steps_trained_throughput_per_sec": 41.296571426063075, "timesteps_total": 244920, "num_steps_trained_this_iter": 480, "agent_timesteps_total": 244920, "timers": {"training_iteration_time_ms": 2915.18, "sample_time_ms": 2911.242, "load_time_ms": 0.271, "load_throughput": 442126.212, "learn_time_ms": 2.893, "learn_throughput": 41484.293, "synch_weights_time_ms": 0.728}, "counters": {"num_env_steps_sampled": 244920, "num_env_steps_trained": 244920, "num_agent_steps_sampled": 244920, "num_agent_steps_trained": 244920}, "done": false, "episodes_total": 2041, "training_iteration": 511, "trial_id": "29a31_00000", "date": "2023-07-26_02-32-49", "timestamp": 1690327969, "time_this_iter_s": 11.625959873199463, "time_total_s": 6216.1924912929535, "pid": 90822, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 1, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[253680, 5e-06], [256080, 5e-06], [258480, 2.5e-06], [260880, 2.5e-06], [263280, 2.5e-06], [265680, 2.5e-06], [268080, 1e-06], [270480, 1e-06], [272880, 1e-06], [275280, 5e-07], [277680, 5e-07], [280080, 5e-07], [282480, 5e-07], [284880, 5e-07], [287280, 1e-07], [289680, 1e-07], [292080, 1e-07]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 120, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x16ca65700>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 594.8670153617859, "iterations_since_restore": 51, "perf": {"cpu_util_percent": 35.423529411764704, "ram_util_percent": 77.45882352941175}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-07, "entropy_coeff": 0.05, "policy_entropy": 267.422119140625, "policy_loss": -118964.4375, "vf_loss": 6422667.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 207.0, "diff_num_grad_updates_vs_sampler_policy": 206.0}}, "num_env_steps_sampled": 245400, "num_env_steps_trained": 245400, "num_agent_steps_sampled": 245400, "num_agent_steps_trained": 245400}, "sampler_results": {"episode_reward_max": -394.41729969669444, "episode_reward_min": -1247.5517022468086, "episode_reward_mean": -773.1284603890834, "episode_len_mean": 120.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-806.032838220834, -853.2777366222037, -535.9236276345816, -668.3005809784493, -817.6324127460357, -575.5426486006425, -844.338362443564, -987.9638919071522, -964.0078814003056, -575.0411396747068, -486.9990873779783, -810.4021681023249, -1020.3625499691664, -788.4657366836122, -1059.1970154748042, -491.5507545100828, -538.8076432084302, -802.9904993100657, -483.486963464396, -1093.3772423579098, -1154.7176883418608, -679.809950071456, -628.7414875841309, -620.1015333203428, -690.1998822665496, -565.2021177932787, -633.5753863466925, -647.6501468015776, -1247.5517022468086, -990.2846551648403, -554.2219541785735, -880.0112778118812, -743.7017521335646, -531.721159893199, -807.166822801979, -551.432737099075, -890.643322597953, -822.2198866915962, -710.9860813596496, -937.5742495392379, -662.4326357313347, -800.6691972778154, -658.2315142840092, -700.7227396798912, -586.691534492754, -761.4475237982085, -733.9128377870884, -782.827678748833, -549.3468543859714, -774.413592672589, -682.1860211806298, -751.5461669019867, -673.7653080406461, -719.383273251562, -860.7816931032946, -574.5873207935329, -758.1958160256859, -814.6505144404368, -550.202945075386, -711.9037625285532, -651.2176932449257, -924.0613606677422, -1116.3976631432336, -654.0189189977006, -501.74581124005044, -798.3699660057422, -1203.9385734942814, -1082.0907286407714, -394.41729969669444, -677.9611896108728, -540.2029569599493, -754.0495819975154, -684.376520070522, -1026.549368134969, -581.8008976875988, -876.150756472005, -1026.3913555404197, -941.0153748167279, -894.517853659287, -771.3302897777419, -1000.0613863105932, -842.1085515218751, -978.9860428100424, -813.4259322144324, -855.2558251874146, -809.3701680786904, -623.5688613804812, -691.690434146929, -1079.2199202035683, -981.7720482360744, -1082.7679266808696, -612.0075463253661, -727.6773331050063, -530.4021591506896, -704.1432740093248, -857.4587423458685, -999.4472655854777, -733.8772667141154, -773.7495603462278, -916.1381297648675], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 21.075589430775427, "mean_inference_ms": 0.40158586482723124, "mean_action_processing_ms": 0.09582729666519896, "mean_env_wait_ms": 2.7944945430152672, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003949403762817383, "StateBufferConnector_ms": 0.0027441978454589844, "ViewRequirementAgentConnector_ms": 0.06827020645141602}}, "episode_reward_max": -394.41729969669444, "episode_reward_min": -1247.5517022468086, "episode_reward_mean": -773.1284603890834, "episode_len_mean": 120.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-806.032838220834, -853.2777366222037, -535.9236276345816, -668.3005809784493, -817.6324127460357, -575.5426486006425, -844.338362443564, -987.9638919071522, -964.0078814003056, -575.0411396747068, -486.9990873779783, -810.4021681023249, -1020.3625499691664, -788.4657366836122, -1059.1970154748042, -491.5507545100828, -538.8076432084302, -802.9904993100657, -483.486963464396, -1093.3772423579098, -1154.7176883418608, -679.809950071456, -628.7414875841309, -620.1015333203428, -690.1998822665496, -565.2021177932787, -633.5753863466925, -647.6501468015776, -1247.5517022468086, -990.2846551648403, -554.2219541785735, -880.0112778118812, -743.7017521335646, -531.721159893199, -807.166822801979, -551.432737099075, -890.643322597953, -822.2198866915962, -710.9860813596496, -937.5742495392379, -662.4326357313347, -800.6691972778154, -658.2315142840092, -700.7227396798912, -586.691534492754, -761.4475237982085, -733.9128377870884, -782.827678748833, -549.3468543859714, -774.413592672589, -682.1860211806298, -751.5461669019867, -673.7653080406461, -719.383273251562, -860.7816931032946, -574.5873207935329, -758.1958160256859, -814.6505144404368, -550.202945075386, -711.9037625285532, -651.2176932449257, -924.0613606677422, -1116.3976631432336, -654.0189189977006, -501.74581124005044, -798.3699660057422, -1203.9385734942814, -1082.0907286407714, -394.41729969669444, -677.9611896108728, -540.2029569599493, -754.0495819975154, -684.376520070522, -1026.549368134969, -581.8008976875988, -876.150756472005, -1026.3913555404197, -941.0153748167279, -894.517853659287, -771.3302897777419, -1000.0613863105932, -842.1085515218751, -978.9860428100424, -813.4259322144324, -855.2558251874146, -809.3701680786904, -623.5688613804812, -691.690434146929, -1079.2199202035683, -981.7720482360744, -1082.7679266808696, -612.0075463253661, -727.6773331050063, -530.4021591506896, -704.1432740093248, -857.4587423458685, -999.4472655854777, -733.8772667141154, -773.7495603462278, -916.1381297648675], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 21.075589430775427, "mean_inference_ms": 0.40158586482723124, "mean_action_processing_ms": 0.09582729666519896, "mean_env_wait_ms": 2.7944945430152672, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003949403762817383, "StateBufferConnector_ms": 0.0027441978454589844, "ViewRequirementAgentConnector_ms": 0.06827020645141602}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 245400, "num_agent_steps_trained": 245400, "num_env_steps_sampled": 245400, "num_env_steps_trained": 245400, "num_env_steps_sampled_this_iter": 480, "num_env_steps_trained_this_iter": 480, "num_env_steps_sampled_throughput_per_sec": 41.66340736161598, "num_env_steps_trained_throughput_per_sec": 41.66340736161598, "timesteps_total": 245400, "num_steps_trained_this_iter": 480, "agent_timesteps_total": 245400, "timers": {"training_iteration_time_ms": 2887.093, "sample_time_ms": 2883.08, "load_time_ms": 0.268, "load_throughput": 448029.624, "learn_time_ms": 2.954, "learn_throughput": 40626.734, "synch_weights_time_ms": 0.749}, "counters": {"num_env_steps_sampled": 245400, "num_env_steps_trained": 245400, "num_agent_steps_sampled": 245400, "num_agent_steps_trained": 245400}, "done": false, "episodes_total": 2045, "training_iteration": 512, "trial_id": "29a31_00000", "date": "2023-07-26_02-33-00", "timestamp": 1690327980, "time_this_iter_s": 11.524503946304321, "time_total_s": 6227.716995239258, "pid": 90822, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 1, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[253680, 5e-06], [256080, 5e-06], [258480, 2.5e-06], [260880, 2.5e-06], [263280, 2.5e-06], [265680, 2.5e-06], [268080, 1e-06], [270480, 1e-06], [272880, 1e-06], [275280, 5e-07], [277680, 5e-07], [280080, 5e-07], [282480, 5e-07], [284880, 5e-07], [287280, 1e-07], [289680, 1e-07], [292080, 1e-07]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 120, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x16ca65700>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 606.3915193080902, "iterations_since_restore": 52, "perf": {"cpu_util_percent": 35.88125, "ram_util_percent": 76.0375}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-07, "entropy_coeff": 0.05, "policy_entropy": 267.4747009277344, "policy_loss": -88222.2265625, "vf_loss": 3578939.25}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 211.0, "diff_num_grad_updates_vs_sampler_policy": 210.0}}, "num_env_steps_sampled": 245880, "num_env_steps_trained": 245880, "num_agent_steps_sampled": 245880, "num_agent_steps_trained": 245880}, "sampler_results": {"episode_reward_max": -394.41729969669444, "episode_reward_min": -1247.5517022468086, "episode_reward_mean": -781.0017142463008, "episode_len_mean": 120.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-817.6324127460357, -575.5426486006425, -844.338362443564, -987.9638919071522, -964.0078814003056, -575.0411396747068, -486.9990873779783, -810.4021681023249, -1020.3625499691664, -788.4657366836122, -1059.1970154748042, -491.5507545100828, -538.8076432084302, -802.9904993100657, -483.486963464396, -1093.3772423579098, -1154.7176883418608, -679.809950071456, -628.7414875841309, -620.1015333203428, -690.1998822665496, -565.2021177932787, -633.5753863466925, -647.6501468015776, -1247.5517022468086, -990.2846551648403, -554.2219541785735, -880.0112778118812, -743.7017521335646, -531.721159893199, -807.166822801979, -551.432737099075, -890.643322597953, -822.2198866915962, -710.9860813596496, -937.5742495392379, -662.4326357313347, -800.6691972778154, -658.2315142840092, -700.7227396798912, -586.691534492754, -761.4475237982085, -733.9128377870884, -782.827678748833, -549.3468543859714, -774.413592672589, -682.1860211806298, -751.5461669019867, -673.7653080406461, -719.383273251562, -860.7816931032946, -574.5873207935329, -758.1958160256859, -814.6505144404368, -550.202945075386, -711.9037625285532, -651.2176932449257, -924.0613606677422, -1116.3976631432336, -654.0189189977006, -501.74581124005044, -798.3699660057422, -1203.9385734942814, -1082.0907286407714, -394.41729969669444, -677.9611896108728, -540.2029569599493, -754.0495819975154, -684.376520070522, -1026.549368134969, -581.8008976875988, -876.150756472005, -1026.3913555404197, -941.0153748167279, -894.517853659287, -771.3302897777419, -1000.0613863105932, -842.1085515218751, -978.9860428100424, -813.4259322144324, -855.2558251874146, -809.3701680786904, -623.5688613804812, -691.690434146929, -1079.2199202035683, -981.7720482360744, -1082.7679266808696, -612.0075463253661, -727.6773331050063, -530.4021591506896, -704.1432740093248, -857.4587423458685, -999.4472655854777, -733.8772667141154, -773.7495603462278, -916.1381297648675, -972.3508070939575, -954.4290190514084, -995.778583007221, -728.3017600252008], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 21.075116747047154, "mean_inference_ms": 0.4015602415397667, "mean_action_processing_ms": 0.09582116680472716, "mean_env_wait_ms": 2.7903100673729906, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00395512580871582, "StateBufferConnector_ms": 0.00273895263671875, "ViewRequirementAgentConnector_ms": 0.06852293014526367}}, "episode_reward_max": -394.41729969669444, "episode_reward_min": -1247.5517022468086, "episode_reward_mean": -781.0017142463008, "episode_len_mean": 120.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-817.6324127460357, -575.5426486006425, -844.338362443564, -987.9638919071522, -964.0078814003056, -575.0411396747068, -486.9990873779783, -810.4021681023249, -1020.3625499691664, -788.4657366836122, -1059.1970154748042, -491.5507545100828, -538.8076432084302, -802.9904993100657, -483.486963464396, -1093.3772423579098, -1154.7176883418608, -679.809950071456, -628.7414875841309, -620.1015333203428, -690.1998822665496, -565.2021177932787, -633.5753863466925, -647.6501468015776, -1247.5517022468086, -990.2846551648403, -554.2219541785735, -880.0112778118812, -743.7017521335646, -531.721159893199, -807.166822801979, -551.432737099075, -890.643322597953, -822.2198866915962, -710.9860813596496, -937.5742495392379, -662.4326357313347, -800.6691972778154, -658.2315142840092, -700.7227396798912, -586.691534492754, -761.4475237982085, -733.9128377870884, -782.827678748833, -549.3468543859714, -774.413592672589, -682.1860211806298, -751.5461669019867, -673.7653080406461, -719.383273251562, -860.7816931032946, -574.5873207935329, -758.1958160256859, -814.6505144404368, -550.202945075386, -711.9037625285532, -651.2176932449257, -924.0613606677422, -1116.3976631432336, -654.0189189977006, -501.74581124005044, -798.3699660057422, -1203.9385734942814, -1082.0907286407714, -394.41729969669444, -677.9611896108728, -540.2029569599493, -754.0495819975154, -684.376520070522, -1026.549368134969, -581.8008976875988, -876.150756472005, -1026.3913555404197, -941.0153748167279, -894.517853659287, -771.3302897777419, -1000.0613863105932, -842.1085515218751, -978.9860428100424, -813.4259322144324, -855.2558251874146, -809.3701680786904, -623.5688613804812, -691.690434146929, -1079.2199202035683, -981.7720482360744, -1082.7679266808696, -612.0075463253661, -727.6773331050063, -530.4021591506896, -704.1432740093248, -857.4587423458685, -999.4472655854777, -733.8772667141154, -773.7495603462278, -916.1381297648675, -972.3508070939575, -954.4290190514084, -995.778583007221, -728.3017600252008], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 21.075116747047154, "mean_inference_ms": 0.4015602415397667, "mean_action_processing_ms": 0.09582116680472716, "mean_env_wait_ms": 2.7903100673729906, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00395512580871582, "StateBufferConnector_ms": 0.00273895263671875, "ViewRequirementAgentConnector_ms": 0.06852293014526367}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 245880, "num_agent_steps_trained": 245880, "num_env_steps_sampled": 245880, "num_env_steps_trained": 245880, "num_env_steps_sampled_this_iter": 480, "num_env_steps_trained_this_iter": 480, "num_env_steps_sampled_throughput_per_sec": 41.16668856957782, "num_env_steps_trained_throughput_per_sec": 41.16668856957782, "timesteps_total": 245880, "num_steps_trained_this_iter": 480, "agent_timesteps_total": 245880, "timers": {"training_iteration_time_ms": 2914.372, "sample_time_ms": 2910.482, "load_time_ms": 0.22, "load_throughput": 545127.781, "learn_time_ms": 2.885, "learn_throughput": 41588.154, "synch_weights_time_ms": 0.743}, "counters": {"num_env_steps_sampled": 245880, "num_env_steps_trained": 245880, "num_agent_steps_sampled": 245880, "num_agent_steps_trained": 245880}, "done": false, "episodes_total": 2049, "training_iteration": 513, "trial_id": "29a31_00000", "date": "2023-07-26_02-33-12", "timestamp": 1690327992, "time_this_iter_s": 11.662577152252197, "time_total_s": 6239.37957239151, "pid": 90822, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 1, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[253680, 5e-06], [256080, 5e-06], [258480, 2.5e-06], [260880, 2.5e-06], [263280, 2.5e-06], [265680, 2.5e-06], [268080, 1e-06], [270480, 1e-06], [272880, 1e-06], [275280, 5e-07], [277680, 5e-07], [280080, 5e-07], [282480, 5e-07], [284880, 5e-07], [287280, 1e-07], [289680, 1e-07], [292080, 1e-07]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 120, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x16ca65700>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 618.0540964603424, "iterations_since_restore": 53, "perf": {"cpu_util_percent": 45.5, "ram_util_percent": 76.7125}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-07, "entropy_coeff": 0.05, "policy_entropy": 267.4217224121094, "policy_loss": -63091.5078125, "vf_loss": 1722315.25}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 215.0, "diff_num_grad_updates_vs_sampler_policy": 214.0}}, "num_env_steps_sampled": 246360, "num_env_steps_trained": 246360, "num_agent_steps_sampled": 246360, "num_agent_steps_trained": 246360}, "sampler_results": {"episode_reward_max": -394.41729969669444, "episode_reward_min": -1247.5517022468086, "episode_reward_mean": -779.5200572518314, "episode_len_mean": 120.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-964.0078814003056, -575.0411396747068, -486.9990873779783, -810.4021681023249, -1020.3625499691664, -788.4657366836122, -1059.1970154748042, -491.5507545100828, -538.8076432084302, -802.9904993100657, -483.486963464396, -1093.3772423579098, -1154.7176883418608, -679.809950071456, -628.7414875841309, -620.1015333203428, -690.1998822665496, -565.2021177932787, -633.5753863466925, -647.6501468015776, -1247.5517022468086, -990.2846551648403, -554.2219541785735, -880.0112778118812, -743.7017521335646, -531.721159893199, -807.166822801979, -551.432737099075, -890.643322597953, -822.2198866915962, -710.9860813596496, -937.5742495392379, -662.4326357313347, -800.6691972778154, -658.2315142840092, -700.7227396798912, -586.691534492754, -761.4475237982085, -733.9128377870884, -782.827678748833, -549.3468543859714, -774.413592672589, -682.1860211806298, -751.5461669019867, -673.7653080406461, -719.383273251562, -860.7816931032946, -574.5873207935329, -758.1958160256859, -814.6505144404368, -550.202945075386, -711.9037625285532, -651.2176932449257, -924.0613606677422, -1116.3976631432336, -654.0189189977006, -501.74581124005044, -798.3699660057422, -1203.9385734942814, -1082.0907286407714, -394.41729969669444, -677.9611896108728, -540.2029569599493, -754.0495819975154, -684.376520070522, -1026.549368134969, -581.8008976875988, -876.150756472005, -1026.3913555404197, -941.0153748167279, -894.517853659287, -771.3302897777419, -1000.0613863105932, -842.1085515218751, -978.9860428100424, -813.4259322144324, -855.2558251874146, -809.3701680786904, -623.5688613804812, -691.690434146929, -1079.2199202035683, -981.7720482360744, -1082.7679266808696, -612.0075463253661, -727.6773331050063, -530.4021591506896, -704.1432740093248, -857.4587423458685, -999.4472655854777, -733.8772667141154, -773.7495603462278, -916.1381297648675, -972.3508070939575, -954.4290190514084, -995.778583007221, -728.3017600252008, -948.2494413130097, -850.4386558258736, -786.6237144016616, -491.99980470992875], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 21.075664697226358, "mean_inference_ms": 0.40153141135137305, "mean_action_processing_ms": 0.09581548185646371, "mean_env_wait_ms": 2.7864600844764693, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003941059112548828, "StateBufferConnector_ms": 0.002737760543823242, "ViewRequirementAgentConnector_ms": 0.06845831871032715}}, "episode_reward_max": -394.41729969669444, "episode_reward_min": -1247.5517022468086, "episode_reward_mean": -779.5200572518314, "episode_len_mean": 120.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-964.0078814003056, -575.0411396747068, -486.9990873779783, -810.4021681023249, -1020.3625499691664, -788.4657366836122, -1059.1970154748042, -491.5507545100828, -538.8076432084302, -802.9904993100657, -483.486963464396, -1093.3772423579098, -1154.7176883418608, -679.809950071456, -628.7414875841309, -620.1015333203428, -690.1998822665496, -565.2021177932787, -633.5753863466925, -647.6501468015776, -1247.5517022468086, -990.2846551648403, -554.2219541785735, -880.0112778118812, -743.7017521335646, -531.721159893199, -807.166822801979, -551.432737099075, -890.643322597953, -822.2198866915962, -710.9860813596496, -937.5742495392379, -662.4326357313347, -800.6691972778154, -658.2315142840092, -700.7227396798912, -586.691534492754, -761.4475237982085, -733.9128377870884, -782.827678748833, -549.3468543859714, -774.413592672589, -682.1860211806298, -751.5461669019867, -673.7653080406461, -719.383273251562, -860.7816931032946, -574.5873207935329, -758.1958160256859, -814.6505144404368, -550.202945075386, -711.9037625285532, -651.2176932449257, -924.0613606677422, -1116.3976631432336, -654.0189189977006, -501.74581124005044, -798.3699660057422, -1203.9385734942814, -1082.0907286407714, -394.41729969669444, -677.9611896108728, -540.2029569599493, -754.0495819975154, -684.376520070522, -1026.549368134969, -581.8008976875988, -876.150756472005, -1026.3913555404197, -941.0153748167279, -894.517853659287, -771.3302897777419, -1000.0613863105932, -842.1085515218751, -978.9860428100424, -813.4259322144324, -855.2558251874146, -809.3701680786904, -623.5688613804812, -691.690434146929, -1079.2199202035683, -981.7720482360744, -1082.7679266808696, -612.0075463253661, -727.6773331050063, -530.4021591506896, -704.1432740093248, -857.4587423458685, -999.4472655854777, -733.8772667141154, -773.7495603462278, -916.1381297648675, -972.3508070939575, -954.4290190514084, -995.778583007221, -728.3017600252008, -948.2494413130097, -850.4386558258736, -786.6237144016616, -491.99980470992875], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 21.075664697226358, "mean_inference_ms": 0.40153141135137305, "mean_action_processing_ms": 0.09581548185646371, "mean_env_wait_ms": 2.7864600844764693, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003941059112548828, "StateBufferConnector_ms": 0.002737760543823242, "ViewRequirementAgentConnector_ms": 0.06845831871032715}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 246360, "num_agent_steps_trained": 246360, "num_env_steps_sampled": 246360, "num_env_steps_trained": 246360, "num_env_steps_sampled_this_iter": 480, "num_env_steps_trained_this_iter": 480, "num_env_steps_sampled_throughput_per_sec": 40.43814455974522, "num_env_steps_trained_throughput_per_sec": 40.43814455974522, "timesteps_total": 246360, "num_steps_trained_this_iter": 480, "agent_timesteps_total": 246360, "timers": {"training_iteration_time_ms": 2929.493, "sample_time_ms": 2925.485, "load_time_ms": 0.227, "load_throughput": 529583.838, "learn_time_ms": 2.982, "learn_throughput": 40235.062, "synch_weights_time_ms": 0.756}, "counters": {"num_env_steps_sampled": 246360, "num_env_steps_trained": 246360, "num_agent_steps_sampled": 246360, "num_agent_steps_trained": 246360}, "done": false, "episodes_total": 2053, "training_iteration": 514, "trial_id": "29a31_00000", "date": "2023-07-26_02-33-24", "timestamp": 1690328004, "time_this_iter_s": 11.872857093811035, "time_total_s": 6251.252429485321, "pid": 90822, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 1, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[253680, 5e-06], [256080, 5e-06], [258480, 2.5e-06], [260880, 2.5e-06], [263280, 2.5e-06], [265680, 2.5e-06], [268080, 1e-06], [270480, 1e-06], [272880, 1e-06], [275280, 5e-07], [277680, 5e-07], [280080, 5e-07], [282480, 5e-07], [284880, 5e-07], [287280, 1e-07], [289680, 1e-07], [292080, 1e-07]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 120, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x16ca65700>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 629.9269535541534, "iterations_since_restore": 54, "perf": {"cpu_util_percent": 42.91764705882353, "ram_util_percent": 77.17647058823528}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-07, "entropy_coeff": 0.05, "policy_entropy": 267.42620849609375, "policy_loss": -84351.796875, "vf_loss": 3539982.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 219.0, "diff_num_grad_updates_vs_sampler_policy": 218.0}}, "num_env_steps_sampled": 246840, "num_env_steps_trained": 246840, "num_agent_steps_sampled": 246840, "num_agent_steps_trained": 246840}, "sampler_results": {"episode_reward_max": -394.41729969669444, "episode_reward_min": -1247.5517022468086, "episode_reward_mean": -779.8054775439407, "episode_len_mean": 120.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1020.3625499691664, -788.4657366836122, -1059.1970154748042, -491.5507545100828, -538.8076432084302, -802.9904993100657, -483.486963464396, -1093.3772423579098, -1154.7176883418608, -679.809950071456, -628.7414875841309, -620.1015333203428, -690.1998822665496, -565.2021177932787, -633.5753863466925, -647.6501468015776, -1247.5517022468086, -990.2846551648403, -554.2219541785735, -880.0112778118812, -743.7017521335646, -531.721159893199, -807.166822801979, -551.432737099075, -890.643322597953, -822.2198866915962, -710.9860813596496, -937.5742495392379, -662.4326357313347, -800.6691972778154, -658.2315142840092, -700.7227396798912, -586.691534492754, -761.4475237982085, -733.9128377870884, -782.827678748833, -549.3468543859714, -774.413592672589, -682.1860211806298, -751.5461669019867, -673.7653080406461, -719.383273251562, -860.7816931032946, -574.5873207935329, -758.1958160256859, -814.6505144404368, -550.202945075386, -711.9037625285532, -651.2176932449257, -924.0613606677422, -1116.3976631432336, -654.0189189977006, -501.74581124005044, -798.3699660057422, -1203.9385734942814, -1082.0907286407714, -394.41729969669444, -677.9611896108728, -540.2029569599493, -754.0495819975154, -684.376520070522, -1026.549368134969, -581.8008976875988, -876.150756472005, -1026.3913555404197, -941.0153748167279, -894.517853659287, -771.3302897777419, -1000.0613863105932, -842.1085515218751, -978.9860428100424, -813.4259322144324, -855.2558251874146, -809.3701680786904, -623.5688613804812, -691.690434146929, -1079.2199202035683, -981.7720482360744, -1082.7679266808696, -612.0075463253661, -727.6773331050063, -530.4021591506896, -704.1432740093248, -857.4587423458685, -999.4472655854777, -733.8772667141154, -773.7495603462278, -916.1381297648675, -972.3508070939575, -954.4290190514084, -995.778583007221, -728.3017600252008, -948.2494413130097, -850.4386558258736, -786.6237144016616, -491.99980470992875, -963.0005892533788, -602.4696272128233, -534.2964904864742, -765.2255988135338], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 21.07662042258974, "mean_inference_ms": 0.401496242642839, "mean_action_processing_ms": 0.09580849808735321, "mean_env_wait_ms": 2.7828323580958325, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003938436508178711, "StateBufferConnector_ms": 0.0027396678924560547, "ViewRequirementAgentConnector_ms": 0.06844758987426758}}, "episode_reward_max": -394.41729969669444, "episode_reward_min": -1247.5517022468086, "episode_reward_mean": -779.8054775439407, "episode_len_mean": 120.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1020.3625499691664, -788.4657366836122, -1059.1970154748042, -491.5507545100828, -538.8076432084302, -802.9904993100657, -483.486963464396, -1093.3772423579098, -1154.7176883418608, -679.809950071456, -628.7414875841309, -620.1015333203428, -690.1998822665496, -565.2021177932787, -633.5753863466925, -647.6501468015776, -1247.5517022468086, -990.2846551648403, -554.2219541785735, -880.0112778118812, -743.7017521335646, -531.721159893199, -807.166822801979, -551.432737099075, -890.643322597953, -822.2198866915962, -710.9860813596496, -937.5742495392379, -662.4326357313347, -800.6691972778154, -658.2315142840092, -700.7227396798912, -586.691534492754, -761.4475237982085, -733.9128377870884, -782.827678748833, -549.3468543859714, -774.413592672589, -682.1860211806298, -751.5461669019867, -673.7653080406461, -719.383273251562, -860.7816931032946, -574.5873207935329, -758.1958160256859, -814.6505144404368, -550.202945075386, -711.9037625285532, -651.2176932449257, -924.0613606677422, -1116.3976631432336, -654.0189189977006, -501.74581124005044, -798.3699660057422, -1203.9385734942814, -1082.0907286407714, -394.41729969669444, -677.9611896108728, -540.2029569599493, -754.0495819975154, -684.376520070522, -1026.549368134969, -581.8008976875988, -876.150756472005, -1026.3913555404197, -941.0153748167279, -894.517853659287, -771.3302897777419, -1000.0613863105932, -842.1085515218751, -978.9860428100424, -813.4259322144324, -855.2558251874146, -809.3701680786904, -623.5688613804812, -691.690434146929, -1079.2199202035683, -981.7720482360744, -1082.7679266808696, -612.0075463253661, -727.6773331050063, -530.4021591506896, -704.1432740093248, -857.4587423458685, -999.4472655854777, -733.8772667141154, -773.7495603462278, -916.1381297648675, -972.3508070939575, -954.4290190514084, -995.778583007221, -728.3017600252008, -948.2494413130097, -850.4386558258736, -786.6237144016616, -491.99980470992875, -963.0005892533788, -602.4696272128233, -534.2964904864742, -765.2255988135338], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 21.07662042258974, "mean_inference_ms": 0.401496242642839, "mean_action_processing_ms": 0.09580849808735321, "mean_env_wait_ms": 2.7828323580958325, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003938436508178711, "StateBufferConnector_ms": 0.0027396678924560547, "ViewRequirementAgentConnector_ms": 0.06844758987426758}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 246840, "num_agent_steps_trained": 246840, "num_env_steps_sampled": 246840, "num_env_steps_trained": 246840, "num_env_steps_sampled_this_iter": 480, "num_env_steps_trained_this_iter": 480, "num_env_steps_sampled_throughput_per_sec": 40.514155533000576, "num_env_steps_trained_throughput_per_sec": 40.514155533000576, "timesteps_total": 246840, "num_steps_trained_this_iter": 480, "agent_timesteps_total": 246840, "timers": {"training_iteration_time_ms": 2957.604, "sample_time_ms": 2953.709, "load_time_ms": 0.231, "load_throughput": 519525.681, "learn_time_ms": 2.887, "learn_throughput": 41566.86, "synch_weights_time_ms": 0.731}, "counters": {"num_env_steps_sampled": 246840, "num_env_steps_trained": 246840, "num_agent_steps_sampled": 246840, "num_agent_steps_trained": 246840}, "done": false, "episodes_total": 2057, "training_iteration": 515, "trial_id": "29a31_00000", "date": "2023-07-26_02-33-36", "timestamp": 1690328016, "time_this_iter_s": 11.850480794906616, "time_total_s": 6263.102910280228, "pid": 90822, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 1, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[253680, 5e-06], [256080, 5e-06], [258480, 2.5e-06], [260880, 2.5e-06], [263280, 2.5e-06], [265680, 2.5e-06], [268080, 1e-06], [270480, 1e-06], [272880, 1e-06], [275280, 5e-07], [277680, 5e-07], [280080, 5e-07], [282480, 5e-07], [284880, 5e-07], [287280, 1e-07], [289680, 1e-07], [292080, 1e-07]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 120, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x16ca65700>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 641.7774343490601, "iterations_since_restore": 55, "perf": {"cpu_util_percent": 37.55294117647059, "ram_util_percent": 77.31176470588237}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-07, "entropy_coeff": 0.05, "policy_entropy": 267.44818115234375, "policy_loss": -123415.40625, "vf_loss": 6387457.5}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 223.0, "diff_num_grad_updates_vs_sampler_policy": 222.0}}, "num_env_steps_sampled": 247320, "num_env_steps_trained": 247320, "num_agent_steps_sampled": 247320, "num_agent_steps_trained": 247320}, "sampler_results": {"episode_reward_max": -394.41729969669444, "episode_reward_min": -1247.5517022468086, "episode_reward_mean": -782.1407099082196, "episode_len_mean": 120.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-538.8076432084302, -802.9904993100657, -483.486963464396, -1093.3772423579098, -1154.7176883418608, -679.809950071456, -628.7414875841309, -620.1015333203428, -690.1998822665496, -565.2021177932787, -633.5753863466925, -647.6501468015776, -1247.5517022468086, -990.2846551648403, -554.2219541785735, -880.0112778118812, -743.7017521335646, -531.721159893199, -807.166822801979, -551.432737099075, -890.643322597953, -822.2198866915962, -710.9860813596496, -937.5742495392379, -662.4326357313347, -800.6691972778154, -658.2315142840092, -700.7227396798912, -586.691534492754, -761.4475237982085, -733.9128377870884, -782.827678748833, -549.3468543859714, -774.413592672589, -682.1860211806298, -751.5461669019867, -673.7653080406461, -719.383273251562, -860.7816931032946, -574.5873207935329, -758.1958160256859, -814.6505144404368, -550.202945075386, -711.9037625285532, -651.2176932449257, -924.0613606677422, -1116.3976631432336, -654.0189189977006, -501.74581124005044, -798.3699660057422, -1203.9385734942814, -1082.0907286407714, -394.41729969669444, -677.9611896108728, -540.2029569599493, -754.0495819975154, -684.376520070522, -1026.549368134969, -581.8008976875988, -876.150756472005, -1026.3913555404197, -941.0153748167279, -894.517853659287, -771.3302897777419, -1000.0613863105932, -842.1085515218751, -978.9860428100424, -813.4259322144324, -855.2558251874146, -809.3701680786904, -623.5688613804812, -691.690434146929, -1079.2199202035683, -981.7720482360744, -1082.7679266808696, -612.0075463253661, -727.6773331050063, -530.4021591506896, -704.1432740093248, -857.4587423458685, -999.4472655854777, -733.8772667141154, -773.7495603462278, -916.1381297648675, -972.3508070939575, -954.4290190514084, -995.778583007221, -728.3017600252008, -948.2494413130097, -850.4386558258736, -786.6237144016616, -491.99980470992875, -963.0005892533788, -602.4696272128233, -534.2964904864742, -765.2255988135338, -1152.6001370306305, -732.0769404936107, -791.9863848469458, -916.4358306943702], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 21.077243501611473, "mean_inference_ms": 0.4014675273635284, "mean_action_processing_ms": 0.09580314528761814, "mean_env_wait_ms": 2.7793689999477236, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003934144973754883, "StateBufferConnector_ms": 0.002730846405029297, "ViewRequirementAgentConnector_ms": 0.06832718849182129}}, "episode_reward_max": -394.41729969669444, "episode_reward_min": -1247.5517022468086, "episode_reward_mean": -782.1407099082196, "episode_len_mean": 120.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-538.8076432084302, -802.9904993100657, -483.486963464396, -1093.3772423579098, -1154.7176883418608, -679.809950071456, -628.7414875841309, -620.1015333203428, -690.1998822665496, -565.2021177932787, -633.5753863466925, -647.6501468015776, -1247.5517022468086, -990.2846551648403, -554.2219541785735, -880.0112778118812, -743.7017521335646, -531.721159893199, -807.166822801979, -551.432737099075, -890.643322597953, -822.2198866915962, -710.9860813596496, -937.5742495392379, -662.4326357313347, -800.6691972778154, -658.2315142840092, -700.7227396798912, -586.691534492754, -761.4475237982085, -733.9128377870884, -782.827678748833, -549.3468543859714, -774.413592672589, -682.1860211806298, -751.5461669019867, -673.7653080406461, -719.383273251562, -860.7816931032946, -574.5873207935329, -758.1958160256859, -814.6505144404368, -550.202945075386, -711.9037625285532, -651.2176932449257, -924.0613606677422, -1116.3976631432336, -654.0189189977006, -501.74581124005044, -798.3699660057422, -1203.9385734942814, -1082.0907286407714, -394.41729969669444, -677.9611896108728, -540.2029569599493, -754.0495819975154, -684.376520070522, -1026.549368134969, -581.8008976875988, -876.150756472005, -1026.3913555404197, -941.0153748167279, -894.517853659287, -771.3302897777419, -1000.0613863105932, -842.1085515218751, -978.9860428100424, -813.4259322144324, -855.2558251874146, -809.3701680786904, -623.5688613804812, -691.690434146929, -1079.2199202035683, -981.7720482360744, -1082.7679266808696, -612.0075463253661, -727.6773331050063, -530.4021591506896, -704.1432740093248, -857.4587423458685, -999.4472655854777, -733.8772667141154, -773.7495603462278, -916.1381297648675, -972.3508070939575, -954.4290190514084, -995.778583007221, -728.3017600252008, -948.2494413130097, -850.4386558258736, -786.6237144016616, -491.99980470992875, -963.0005892533788, -602.4696272128233, -534.2964904864742, -765.2255988135338, -1152.6001370306305, -732.0769404936107, -791.9863848469458, -916.4358306943702], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 21.077243501611473, "mean_inference_ms": 0.4014675273635284, "mean_action_processing_ms": 0.09580314528761814, "mean_env_wait_ms": 2.7793689999477236, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003934144973754883, "StateBufferConnector_ms": 0.002730846405029297, "ViewRequirementAgentConnector_ms": 0.06832718849182129}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 247320, "num_agent_steps_trained": 247320, "num_env_steps_sampled": 247320, "num_env_steps_trained": 247320, "num_env_steps_sampled_this_iter": 480, "num_env_steps_trained_this_iter": 480, "num_env_steps_sampled_throughput_per_sec": 41.99080629177382, "num_env_steps_trained_throughput_per_sec": 41.99080629177382, "timesteps_total": 247320, "num_steps_trained_this_iter": 480, "agent_timesteps_total": 247320, "timers": {"training_iteration_time_ms": 2911.41, "sample_time_ms": 2907.535, "load_time_ms": 0.229, "load_throughput": 524288.0, "learn_time_ms": 2.869, "learn_throughput": 41825.58, "synch_weights_time_ms": 0.73}, "counters": {"num_env_steps_sampled": 247320, "num_env_steps_trained": 247320, "num_agent_steps_sampled": 247320, "num_agent_steps_trained": 247320}, "done": false, "episodes_total": 2061, "training_iteration": 516, "trial_id": "29a31_00000", "date": "2023-07-26_02-33-47", "timestamp": 1690328027, "time_this_iter_s": 11.433809041976929, "time_total_s": 6274.536719322205, "pid": 90822, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 1, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[253680, 5e-06], [256080, 5e-06], [258480, 2.5e-06], [260880, 2.5e-06], [263280, 2.5e-06], [265680, 2.5e-06], [268080, 1e-06], [270480, 1e-06], [272880, 1e-06], [275280, 5e-07], [277680, 5e-07], [280080, 5e-07], [282480, 5e-07], [284880, 5e-07], [287280, 1e-07], [289680, 1e-07], [292080, 1e-07]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 120, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x16ca65700>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 653.211243391037, "iterations_since_restore": 56, "perf": {"cpu_util_percent": 33.64375, "ram_util_percent": 76.38125}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-07, "entropy_coeff": 0.05, "policy_entropy": 267.4445495605469, "policy_loss": -89379.3046875, "vf_loss": 3770717.5}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 227.0, "diff_num_grad_updates_vs_sampler_policy": 226.0}}, "num_env_steps_sampled": 247800, "num_env_steps_trained": 247800, "num_agent_steps_sampled": 247800, "num_agent_steps_trained": 247800}, "sampler_results": {"episode_reward_max": -394.41729969669444, "episode_reward_min": -1247.5517022468086, "episode_reward_mean": -780.6117443349084, "episode_len_mean": 120.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1154.7176883418608, -679.809950071456, -628.7414875841309, -620.1015333203428, -690.1998822665496, -565.2021177932787, -633.5753863466925, -647.6501468015776, -1247.5517022468086, -990.2846551648403, -554.2219541785735, -880.0112778118812, -743.7017521335646, -531.721159893199, -807.166822801979, -551.432737099075, -890.643322597953, -822.2198866915962, -710.9860813596496, -937.5742495392379, -662.4326357313347, -800.6691972778154, -658.2315142840092, -700.7227396798912, -586.691534492754, -761.4475237982085, -733.9128377870884, -782.827678748833, -549.3468543859714, -774.413592672589, -682.1860211806298, -751.5461669019867, -673.7653080406461, -719.383273251562, -860.7816931032946, -574.5873207935329, -758.1958160256859, -814.6505144404368, -550.202945075386, -711.9037625285532, -651.2176932449257, -924.0613606677422, -1116.3976631432336, -654.0189189977006, -501.74581124005044, -798.3699660057422, -1203.9385734942814, -1082.0907286407714, -394.41729969669444, -677.9611896108728, -540.2029569599493, -754.0495819975154, -684.376520070522, -1026.549368134969, -581.8008976875988, -876.150756472005, -1026.3913555404197, -941.0153748167279, -894.517853659287, -771.3302897777419, -1000.0613863105932, -842.1085515218751, -978.9860428100424, -813.4259322144324, -855.2558251874146, -809.3701680786904, -623.5688613804812, -691.690434146929, -1079.2199202035683, -981.7720482360744, -1082.7679266808696, -612.0075463253661, -727.6773331050063, -530.4021591506896, -704.1432740093248, -857.4587423458685, -999.4472655854777, -733.8772667141154, -773.7495603462278, -916.1381297648675, -972.3508070939575, -954.4290190514084, -995.778583007221, -728.3017600252008, -948.2494413130097, -850.4386558258736, -786.6237144016616, -491.99980470992875, -963.0005892533788, -602.4696272128233, -534.2964904864742, -765.2255988135338, -1152.6001370306305, -732.0769404936107, -791.9863848469458, -916.4358306943702, -735.9125920102998, -757.7772228364103, -569.7552278520072, -702.3207483109954], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 21.0774103271217, "mean_inference_ms": 0.40144906975587885, "mean_action_processing_ms": 0.09580003821399377, "mean_env_wait_ms": 2.776038024132006, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003947257995605469, "StateBufferConnector_ms": 0.002744913101196289, "ViewRequirementAgentConnector_ms": 0.06850743293762207}}, "episode_reward_max": -394.41729969669444, "episode_reward_min": -1247.5517022468086, "episode_reward_mean": -780.6117443349084, "episode_len_mean": 120.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1154.7176883418608, -679.809950071456, -628.7414875841309, -620.1015333203428, -690.1998822665496, -565.2021177932787, -633.5753863466925, -647.6501468015776, -1247.5517022468086, -990.2846551648403, -554.2219541785735, -880.0112778118812, -743.7017521335646, -531.721159893199, -807.166822801979, -551.432737099075, -890.643322597953, -822.2198866915962, -710.9860813596496, -937.5742495392379, -662.4326357313347, -800.6691972778154, -658.2315142840092, -700.7227396798912, -586.691534492754, -761.4475237982085, -733.9128377870884, -782.827678748833, -549.3468543859714, -774.413592672589, -682.1860211806298, -751.5461669019867, -673.7653080406461, -719.383273251562, -860.7816931032946, -574.5873207935329, -758.1958160256859, -814.6505144404368, -550.202945075386, -711.9037625285532, -651.2176932449257, -924.0613606677422, -1116.3976631432336, -654.0189189977006, -501.74581124005044, -798.3699660057422, -1203.9385734942814, -1082.0907286407714, -394.41729969669444, -677.9611896108728, -540.2029569599493, -754.0495819975154, -684.376520070522, -1026.549368134969, -581.8008976875988, -876.150756472005, -1026.3913555404197, -941.0153748167279, -894.517853659287, -771.3302897777419, -1000.0613863105932, -842.1085515218751, -978.9860428100424, -813.4259322144324, -855.2558251874146, -809.3701680786904, -623.5688613804812, -691.690434146929, -1079.2199202035683, -981.7720482360744, -1082.7679266808696, -612.0075463253661, -727.6773331050063, -530.4021591506896, -704.1432740093248, -857.4587423458685, -999.4472655854777, -733.8772667141154, -773.7495603462278, -916.1381297648675, -972.3508070939575, -954.4290190514084, -995.778583007221, -728.3017600252008, -948.2494413130097, -850.4386558258736, -786.6237144016616, -491.99980470992875, -963.0005892533788, -602.4696272128233, -534.2964904864742, -765.2255988135338, -1152.6001370306305, -732.0769404936107, -791.9863848469458, -916.4358306943702, -735.9125920102998, -757.7772228364103, -569.7552278520072, -702.3207483109954], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 21.0774103271217, "mean_inference_ms": 0.40144906975587885, "mean_action_processing_ms": 0.09580003821399377, "mean_env_wait_ms": 2.776038024132006, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003947257995605469, "StateBufferConnector_ms": 0.002744913101196289, "ViewRequirementAgentConnector_ms": 0.06850743293762207}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 247800, "num_agent_steps_trained": 247800, "num_env_steps_sampled": 247800, "num_env_steps_trained": 247800, "num_env_steps_sampled_this_iter": 480, "num_env_steps_trained_this_iter": 480, "num_env_steps_sampled_throughput_per_sec": 41.087353911453526, "num_env_steps_trained_throughput_per_sec": 41.087353911453526, "timesteps_total": 247800, "num_steps_trained_this_iter": 480, "agent_timesteps_total": 247800, "timers": {"training_iteration_time_ms": 2891.274, "sample_time_ms": 2887.488, "load_time_ms": 0.224, "load_throughput": 535386.108, "learn_time_ms": 2.798, "learn_throughput": 42892.026, "synch_weights_time_ms": 0.719}, "counters": {"num_env_steps_sampled": 247800, "num_env_steps_trained": 247800, "num_agent_steps_sampled": 247800, "num_agent_steps_trained": 247800}, "done": false, "episodes_total": 2065, "training_iteration": 517, "trial_id": "29a31_00000", "date": "2023-07-26_02-33-59", "timestamp": 1690328039, "time_this_iter_s": 11.68514895439148, "time_total_s": 6286.221868276596, "pid": 90822, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 1, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[253680, 5e-06], [256080, 5e-06], [258480, 2.5e-06], [260880, 2.5e-06], [263280, 2.5e-06], [265680, 2.5e-06], [268080, 1e-06], [270480, 1e-06], [272880, 1e-06], [275280, 5e-07], [277680, 5e-07], [280080, 5e-07], [282480, 5e-07], [284880, 5e-07], [287280, 1e-07], [289680, 1e-07], [292080, 1e-07]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 120, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x16ca65700>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 664.8963923454285, "iterations_since_restore": 57, "perf": {"cpu_util_percent": 35.205882352941174, "ram_util_percent": 77.07058823529412}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-07, "entropy_coeff": 0.05, "policy_entropy": 267.436279296875, "policy_loss": -86703.5703125, "vf_loss": 4109301.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 231.0, "diff_num_grad_updates_vs_sampler_policy": 230.0}}, "num_env_steps_sampled": 248280, "num_env_steps_trained": 248280, "num_agent_steps_sampled": 248280, "num_agent_steps_trained": 248280}, "sampler_results": {"episode_reward_max": -394.41729969669444, "episode_reward_min": -1247.5517022468086, "episode_reward_mean": -781.6552400914921, "episode_len_mean": 120.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-690.1998822665496, -565.2021177932787, -633.5753863466925, -647.6501468015776, -1247.5517022468086, -990.2846551648403, -554.2219541785735, -880.0112778118812, -743.7017521335646, -531.721159893199, -807.166822801979, -551.432737099075, -890.643322597953, -822.2198866915962, -710.9860813596496, -937.5742495392379, -662.4326357313347, -800.6691972778154, -658.2315142840092, -700.7227396798912, -586.691534492754, -761.4475237982085, -733.9128377870884, -782.827678748833, -549.3468543859714, -774.413592672589, -682.1860211806298, -751.5461669019867, -673.7653080406461, -719.383273251562, -860.7816931032946, -574.5873207935329, -758.1958160256859, -814.6505144404368, -550.202945075386, -711.9037625285532, -651.2176932449257, -924.0613606677422, -1116.3976631432336, -654.0189189977006, -501.74581124005044, -798.3699660057422, -1203.9385734942814, -1082.0907286407714, -394.41729969669444, -677.9611896108728, -540.2029569599493, -754.0495819975154, -684.376520070522, -1026.549368134969, -581.8008976875988, -876.150756472005, -1026.3913555404197, -941.0153748167279, -894.517853659287, -771.3302897777419, -1000.0613863105932, -842.1085515218751, -978.9860428100424, -813.4259322144324, -855.2558251874146, -809.3701680786904, -623.5688613804812, -691.690434146929, -1079.2199202035683, -981.7720482360744, -1082.7679266808696, -612.0075463253661, -727.6773331050063, -530.4021591506896, -704.1432740093248, -857.4587423458685, -999.4472655854777, -733.8772667141154, -773.7495603462278, -916.1381297648675, -972.3508070939575, -954.4290190514084, -995.778583007221, -728.3017600252008, -948.2494413130097, -850.4386558258736, -786.6237144016616, -491.99980470992875, -963.0005892533788, -602.4696272128233, -534.2964904864742, -765.2255988135338, -1152.6001370306305, -732.0769404936107, -791.9863848469458, -916.4358306943702, -735.9125920102998, -757.7772228364103, -569.7552278520072, -702.3207483109954, -647.6811417861289, -670.9380505027437, -1070.644233335096, -798.4568093521814], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 21.077322571091962, "mean_inference_ms": 0.401426321536254, "mean_action_processing_ms": 0.09579654715361176, "mean_env_wait_ms": 2.772855766365974, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0039055347442626953, "StateBufferConnector_ms": 0.002727031707763672, "ViewRequirementAgentConnector_ms": 0.06817388534545898}}, "episode_reward_max": -394.41729969669444, "episode_reward_min": -1247.5517022468086, "episode_reward_mean": -781.6552400914921, "episode_len_mean": 120.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-690.1998822665496, -565.2021177932787, -633.5753863466925, -647.6501468015776, -1247.5517022468086, -990.2846551648403, -554.2219541785735, -880.0112778118812, -743.7017521335646, -531.721159893199, -807.166822801979, -551.432737099075, -890.643322597953, -822.2198866915962, -710.9860813596496, -937.5742495392379, -662.4326357313347, -800.6691972778154, -658.2315142840092, -700.7227396798912, -586.691534492754, -761.4475237982085, -733.9128377870884, -782.827678748833, -549.3468543859714, -774.413592672589, -682.1860211806298, -751.5461669019867, -673.7653080406461, -719.383273251562, -860.7816931032946, -574.5873207935329, -758.1958160256859, -814.6505144404368, -550.202945075386, -711.9037625285532, -651.2176932449257, -924.0613606677422, -1116.3976631432336, -654.0189189977006, -501.74581124005044, -798.3699660057422, -1203.9385734942814, -1082.0907286407714, -394.41729969669444, -677.9611896108728, -540.2029569599493, -754.0495819975154, -684.376520070522, -1026.549368134969, -581.8008976875988, -876.150756472005, -1026.3913555404197, -941.0153748167279, -894.517853659287, -771.3302897777419, -1000.0613863105932, -842.1085515218751, -978.9860428100424, -813.4259322144324, -855.2558251874146, -809.3701680786904, -623.5688613804812, -691.690434146929, -1079.2199202035683, -981.7720482360744, -1082.7679266808696, -612.0075463253661, -727.6773331050063, -530.4021591506896, -704.1432740093248, -857.4587423458685, -999.4472655854777, -733.8772667141154, -773.7495603462278, -916.1381297648675, -972.3508070939575, -954.4290190514084, -995.778583007221, -728.3017600252008, -948.2494413130097, -850.4386558258736, -786.6237144016616, -491.99980470992875, -963.0005892533788, -602.4696272128233, -534.2964904864742, -765.2255988135338, -1152.6001370306305, -732.0769404936107, -791.9863848469458, -916.4358306943702, -735.9125920102998, -757.7772228364103, -569.7552278520072, -702.3207483109954, -647.6811417861289, -670.9380505027437, -1070.644233335096, -798.4568093521814], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 21.077322571091962, "mean_inference_ms": 0.401426321536254, "mean_action_processing_ms": 0.09579654715361176, "mean_env_wait_ms": 2.772855766365974, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0039055347442626953, "StateBufferConnector_ms": 0.002727031707763672, "ViewRequirementAgentConnector_ms": 0.06817388534545898}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 248280, "num_agent_steps_trained": 248280, "num_env_steps_sampled": 248280, "num_env_steps_trained": 248280, "num_env_steps_sampled_this_iter": 480, "num_env_steps_trained_this_iter": 480, "num_env_steps_sampled_throughput_per_sec": 40.82270425582223, "num_env_steps_trained_throughput_per_sec": 40.82270425582223, "timesteps_total": 248280, "num_steps_trained_this_iter": 480, "agent_timesteps_total": 248280, "timers": {"training_iteration_time_ms": 2919.015, "sample_time_ms": 2915.193, "load_time_ms": 0.22, "load_throughput": 545423.147, "learn_time_ms": 2.817, "learn_throughput": 42604.474, "synch_weights_time_ms": 0.744}, "counters": {"num_env_steps_sampled": 248280, "num_env_steps_trained": 248280, "num_agent_steps_sampled": 248280, "num_agent_steps_trained": 248280}, "done": false, "episodes_total": 2069, "training_iteration": 518, "trial_id": "29a31_00000", "date": "2023-07-26_02-34-11", "timestamp": 1690328051, "time_this_iter_s": 11.761282920837402, "time_total_s": 6297.9831511974335, "pid": 90822, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 1, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[253680, 5e-06], [256080, 5e-06], [258480, 2.5e-06], [260880, 2.5e-06], [263280, 2.5e-06], [265680, 2.5e-06], [268080, 1e-06], [270480, 1e-06], [272880, 1e-06], [275280, 5e-07], [277680, 5e-07], [280080, 5e-07], [282480, 5e-07], [284880, 5e-07], [287280, 1e-07], [289680, 1e-07], [292080, 1e-07]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 120, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x16ca65700>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 676.6576752662659, "iterations_since_restore": 58, "perf": {"cpu_util_percent": 36.28235294117647, "ram_util_percent": 75.46470588235293}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-07, "entropy_coeff": 0.05, "policy_entropy": 267.4125671386719, "policy_loss": -87894.2578125, "vf_loss": 3833080.25}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 235.0, "diff_num_grad_updates_vs_sampler_policy": 234.0}}, "num_env_steps_sampled": 248760, "num_env_steps_trained": 248760, "num_agent_steps_sampled": 248760, "num_agent_steps_trained": 248760}, "sampler_results": {"episode_reward_max": -394.41729969669444, "episode_reward_min": -1247.5517022468086, "episode_reward_mean": -782.140525078743, "episode_len_mean": 120.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1247.5517022468086, -990.2846551648403, -554.2219541785735, -880.0112778118812, -743.7017521335646, -531.721159893199, -807.166822801979, -551.432737099075, -890.643322597953, -822.2198866915962, -710.9860813596496, -937.5742495392379, -662.4326357313347, -800.6691972778154, -658.2315142840092, -700.7227396798912, -586.691534492754, -761.4475237982085, -733.9128377870884, -782.827678748833, -549.3468543859714, -774.413592672589, -682.1860211806298, -751.5461669019867, -673.7653080406461, -719.383273251562, -860.7816931032946, -574.5873207935329, -758.1958160256859, -814.6505144404368, -550.202945075386, -711.9037625285532, -651.2176932449257, -924.0613606677422, -1116.3976631432336, -654.0189189977006, -501.74581124005044, -798.3699660057422, -1203.9385734942814, -1082.0907286407714, -394.41729969669444, -677.9611896108728, -540.2029569599493, -754.0495819975154, -684.376520070522, -1026.549368134969, -581.8008976875988, -876.150756472005, -1026.3913555404197, -941.0153748167279, -894.517853659287, -771.3302897777419, -1000.0613863105932, -842.1085515218751, -978.9860428100424, -813.4259322144324, -855.2558251874146, -809.3701680786904, -623.5688613804812, -691.690434146929, -1079.2199202035683, -981.7720482360744, -1082.7679266808696, -612.0075463253661, -727.6773331050063, -530.4021591506896, -704.1432740093248, -857.4587423458685, -999.4472655854777, -733.8772667141154, -773.7495603462278, -916.1381297648675, -972.3508070939575, -954.4290190514084, -995.778583007221, -728.3017600252008, -948.2494413130097, -850.4386558258736, -786.6237144016616, -491.99980470992875, -963.0005892533788, -602.4696272128233, -534.2964904864742, -765.2255988135338, -1152.6001370306305, -732.0769404936107, -791.9863848469458, -916.4358306943702, -735.9125920102998, -757.7772228364103, -569.7552278520072, -702.3207483109954, -647.6811417861289, -670.9380505027437, -1070.644233335096, -798.4568093521814, -626.3483127361287, -745.7895433704377, -563.0169346287039, -650.0012411979194], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 21.077691906847804, "mean_inference_ms": 0.4013881577464412, "mean_action_processing_ms": 0.0957913739005953, "mean_env_wait_ms": 2.7699527073789136, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0039010047912597656, "StateBufferConnector_ms": 0.002726316452026367, "ViewRequirementAgentConnector_ms": 0.06816935539245605}}, "episode_reward_max": -394.41729969669444, "episode_reward_min": -1247.5517022468086, "episode_reward_mean": -782.140525078743, "episode_len_mean": 120.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1247.5517022468086, -990.2846551648403, -554.2219541785735, -880.0112778118812, -743.7017521335646, -531.721159893199, -807.166822801979, -551.432737099075, -890.643322597953, -822.2198866915962, -710.9860813596496, -937.5742495392379, -662.4326357313347, -800.6691972778154, -658.2315142840092, -700.7227396798912, -586.691534492754, -761.4475237982085, -733.9128377870884, -782.827678748833, -549.3468543859714, -774.413592672589, -682.1860211806298, -751.5461669019867, -673.7653080406461, -719.383273251562, -860.7816931032946, -574.5873207935329, -758.1958160256859, -814.6505144404368, -550.202945075386, -711.9037625285532, -651.2176932449257, -924.0613606677422, -1116.3976631432336, -654.0189189977006, -501.74581124005044, -798.3699660057422, -1203.9385734942814, -1082.0907286407714, -394.41729969669444, -677.9611896108728, -540.2029569599493, -754.0495819975154, -684.376520070522, -1026.549368134969, -581.8008976875988, -876.150756472005, -1026.3913555404197, -941.0153748167279, -894.517853659287, -771.3302897777419, -1000.0613863105932, -842.1085515218751, -978.9860428100424, -813.4259322144324, -855.2558251874146, -809.3701680786904, -623.5688613804812, -691.690434146929, -1079.2199202035683, -981.7720482360744, -1082.7679266808696, -612.0075463253661, -727.6773331050063, -530.4021591506896, -704.1432740093248, -857.4587423458685, -999.4472655854777, -733.8772667141154, -773.7495603462278, -916.1381297648675, -972.3508070939575, -954.4290190514084, -995.778583007221, -728.3017600252008, -948.2494413130097, -850.4386558258736, -786.6237144016616, -491.99980470992875, -963.0005892533788, -602.4696272128233, -534.2964904864742, -765.2255988135338, -1152.6001370306305, -732.0769404936107, -791.9863848469458, -916.4358306943702, -735.9125920102998, -757.7772228364103, -569.7552278520072, -702.3207483109954, -647.6811417861289, -670.9380505027437, -1070.644233335096, -798.4568093521814, -626.3483127361287, -745.7895433704377, -563.0169346287039, -650.0012411979194], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 21.077691906847804, "mean_inference_ms": 0.4013881577464412, "mean_action_processing_ms": 0.0957913739005953, "mean_env_wait_ms": 2.7699527073789136, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0039010047912597656, "StateBufferConnector_ms": 0.002726316452026367, "ViewRequirementAgentConnector_ms": 0.06816935539245605}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 248760, "num_agent_steps_trained": 248760, "num_env_steps_sampled": 248760, "num_env_steps_trained": 248760, "num_env_steps_sampled_this_iter": 480, "num_env_steps_trained_this_iter": 480, "num_env_steps_sampled_throughput_per_sec": 40.71650532447143, "num_env_steps_trained_throughput_per_sec": 40.71650532447143, "timesteps_total": 248760, "num_steps_trained_this_iter": 480, "agent_timesteps_total": 248760, "timers": {"training_iteration_time_ms": 2935.476, "sample_time_ms": 2931.6, "load_time_ms": 0.24, "load_throughput": 499173.341, "learn_time_ms": 2.842, "learn_throughput": 42224.183, "synch_weights_time_ms": 0.752}, "counters": {"num_env_steps_sampled": 248760, "num_env_steps_trained": 248760, "num_agent_steps_sampled": 248760, "num_agent_steps_trained": 248760}, "done": false, "episodes_total": 2073, "training_iteration": 519, "trial_id": "29a31_00000", "date": "2023-07-26_02-34-23", "timestamp": 1690328063, "time_this_iter_s": 11.791563987731934, "time_total_s": 6309.774715185165, "pid": 90822, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 1, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[253680, 5e-06], [256080, 5e-06], [258480, 2.5e-06], [260880, 2.5e-06], [263280, 2.5e-06], [265680, 2.5e-06], [268080, 1e-06], [270480, 1e-06], [272880, 1e-06], [275280, 5e-07], [277680, 5e-07], [280080, 5e-07], [282480, 5e-07], [284880, 5e-07], [287280, 1e-07], [289680, 1e-07], [292080, 1e-07]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 120, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x16ca65700>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 688.4492392539978, "iterations_since_restore": 59, "perf": {"cpu_util_percent": 35.9625, "ram_util_percent": 76.45625000000001}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-07, "entropy_coeff": 0.05, "policy_entropy": 267.4193420410156, "policy_loss": -59576.72265625, "vf_loss": 1776596.875}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 239.0, "diff_num_grad_updates_vs_sampler_policy": 238.0}}, "num_env_steps_sampled": 249240, "num_env_steps_trained": 249240, "num_agent_steps_sampled": 249240, "num_agent_steps_trained": 249240}, "sampler_results": {"episode_reward_max": -394.41729969669444, "episode_reward_min": -1203.9385734942814, "episode_reward_mean": -770.8626089778616, "episode_len_mean": 120.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-743.7017521335646, -531.721159893199, -807.166822801979, -551.432737099075, -890.643322597953, -822.2198866915962, -710.9860813596496, -937.5742495392379, -662.4326357313347, -800.6691972778154, -658.2315142840092, -700.7227396798912, -586.691534492754, -761.4475237982085, -733.9128377870884, -782.827678748833, -549.3468543859714, -774.413592672589, -682.1860211806298, -751.5461669019867, -673.7653080406461, -719.383273251562, -860.7816931032946, -574.5873207935329, -758.1958160256859, -814.6505144404368, -550.202945075386, -711.9037625285532, -651.2176932449257, -924.0613606677422, -1116.3976631432336, -654.0189189977006, -501.74581124005044, -798.3699660057422, -1203.9385734942814, -1082.0907286407714, -394.41729969669444, -677.9611896108728, -540.2029569599493, -754.0495819975154, -684.376520070522, -1026.549368134969, -581.8008976875988, -876.150756472005, -1026.3913555404197, -941.0153748167279, -894.517853659287, -771.3302897777419, -1000.0613863105932, -842.1085515218751, -978.9860428100424, -813.4259322144324, -855.2558251874146, -809.3701680786904, -623.5688613804812, -691.690434146929, -1079.2199202035683, -981.7720482360744, -1082.7679266808696, -612.0075463253661, -727.6773331050063, -530.4021591506896, -704.1432740093248, -857.4587423458685, -999.4472655854777, -733.8772667141154, -773.7495603462278, -916.1381297648675, -972.3508070939575, -954.4290190514084, -995.778583007221, -728.3017600252008, -948.2494413130097, -850.4386558258736, -786.6237144016616, -491.99980470992875, -963.0005892533788, -602.4696272128233, -534.2964904864742, -765.2255988135338, -1152.6001370306305, -732.0769404936107, -791.9863848469458, -916.4358306943702, -735.9125920102998, -757.7772228364103, -569.7552278520072, -702.3207483109954, -647.6811417861289, -670.9380505027437, -1070.644233335096, -798.4568093521814, -626.3483127361287, -745.7895433704377, -563.0169346287039, -650.0012411979194, -766.1771461992677, -755.1716508967431, -617.1073540062661, -405.8218282116934], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 21.078807948943346, "mean_inference_ms": 0.4013443943826023, "mean_action_processing_ms": 0.09578561561005138, "mean_env_wait_ms": 2.7671816159626372, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0038988590240478516, "StateBufferConnector_ms": 0.0027222633361816406, "ViewRequirementAgentConnector_ms": 0.06814193725585938}}, "episode_reward_max": -394.41729969669444, "episode_reward_min": -1203.9385734942814, "episode_reward_mean": -770.8626089778616, "episode_len_mean": 120.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-743.7017521335646, -531.721159893199, -807.166822801979, -551.432737099075, -890.643322597953, -822.2198866915962, -710.9860813596496, -937.5742495392379, -662.4326357313347, -800.6691972778154, -658.2315142840092, -700.7227396798912, -586.691534492754, -761.4475237982085, -733.9128377870884, -782.827678748833, -549.3468543859714, -774.413592672589, -682.1860211806298, -751.5461669019867, -673.7653080406461, -719.383273251562, -860.7816931032946, -574.5873207935329, -758.1958160256859, -814.6505144404368, -550.202945075386, -711.9037625285532, -651.2176932449257, -924.0613606677422, -1116.3976631432336, -654.0189189977006, -501.74581124005044, -798.3699660057422, -1203.9385734942814, -1082.0907286407714, -394.41729969669444, -677.9611896108728, -540.2029569599493, -754.0495819975154, -684.376520070522, -1026.549368134969, -581.8008976875988, -876.150756472005, -1026.3913555404197, -941.0153748167279, -894.517853659287, -771.3302897777419, -1000.0613863105932, -842.1085515218751, -978.9860428100424, -813.4259322144324, -855.2558251874146, -809.3701680786904, -623.5688613804812, -691.690434146929, -1079.2199202035683, -981.7720482360744, -1082.7679266808696, -612.0075463253661, -727.6773331050063, -530.4021591506896, -704.1432740093248, -857.4587423458685, -999.4472655854777, -733.8772667141154, -773.7495603462278, -916.1381297648675, -972.3508070939575, -954.4290190514084, -995.778583007221, -728.3017600252008, -948.2494413130097, -850.4386558258736, -786.6237144016616, -491.99980470992875, -963.0005892533788, -602.4696272128233, -534.2964904864742, -765.2255988135338, -1152.6001370306305, -732.0769404936107, -791.9863848469458, -916.4358306943702, -735.9125920102998, -757.7772228364103, -569.7552278520072, -702.3207483109954, -647.6811417861289, -670.9380505027437, -1070.644233335096, -798.4568093521814, -626.3483127361287, -745.7895433704377, -563.0169346287039, -650.0012411979194, -766.1771461992677, -755.1716508967431, -617.1073540062661, -405.8218282116934], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 21.078807948943346, "mean_inference_ms": 0.4013443943826023, "mean_action_processing_ms": 0.09578561561005138, "mean_env_wait_ms": 2.7671816159626372, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0038988590240478516, "StateBufferConnector_ms": 0.0027222633361816406, "ViewRequirementAgentConnector_ms": 0.06814193725585938}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 249240, "num_agent_steps_trained": 249240, "num_env_steps_sampled": 249240, "num_env_steps_trained": 249240, "num_env_steps_sampled_this_iter": 480, "num_env_steps_trained_this_iter": 480, "num_env_steps_sampled_throughput_per_sec": 40.50142469537567, "num_env_steps_trained_throughput_per_sec": 40.50142469537567, "timesteps_total": 249240, "num_steps_trained_this_iter": 480, "agent_timesteps_total": 249240, "timers": {"training_iteration_time_ms": 2966.836, "sample_time_ms": 2962.968, "load_time_ms": 0.246, "load_throughput": 488514.491, "learn_time_ms": 2.845, "learn_throughput": 42174.296, "synch_weights_time_ms": 0.735}, "counters": {"num_env_steps_sampled": 249240, "num_env_steps_trained": 249240, "num_agent_steps_sampled": 249240, "num_agent_steps_trained": 249240}, "done": false, "episodes_total": 2077, "training_iteration": 520, "trial_id": "29a31_00000", "date": "2023-07-26_02-34-35", "timestamp": 1690328075, "time_this_iter_s": 11.854328155517578, "time_total_s": 6321.629043340683, "pid": 90822, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 1, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[253680, 5e-06], [256080, 5e-06], [258480, 2.5e-06], [260880, 2.5e-06], [263280, 2.5e-06], [265680, 2.5e-06], [268080, 1e-06], [270480, 1e-06], [272880, 1e-06], [275280, 5e-07], [277680, 5e-07], [280080, 5e-07], [282480, 5e-07], [284880, 5e-07], [287280, 1e-07], [289680, 1e-07], [292080, 1e-07]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 120, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x16ca65700>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 700.3035674095154, "iterations_since_restore": 60, "perf": {"cpu_util_percent": 40.13529411764706, "ram_util_percent": 78.34705882352942}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-07, "entropy_coeff": 0.05, "policy_entropy": 267.468994140625, "policy_loss": -117196.8125, "vf_loss": 7240035.5}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 243.0, "diff_num_grad_updates_vs_sampler_policy": 242.0}}, "num_env_steps_sampled": 249720, "num_env_steps_trained": 249720, "num_agent_steps_sampled": 249720, "num_agent_steps_trained": 249720}, "sampler_results": {"episode_reward_max": -394.41729969669444, "episode_reward_min": -1203.9385734942814, "episode_reward_mean": -773.5871929669763, "episode_len_mean": 120.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-890.643322597953, -822.2198866915962, -710.9860813596496, -937.5742495392379, -662.4326357313347, -800.6691972778154, -658.2315142840092, -700.7227396798912, -586.691534492754, -761.4475237982085, -733.9128377870884, -782.827678748833, -549.3468543859714, -774.413592672589, -682.1860211806298, -751.5461669019867, -673.7653080406461, -719.383273251562, -860.7816931032946, -574.5873207935329, -758.1958160256859, -814.6505144404368, -550.202945075386, -711.9037625285532, -651.2176932449257, -924.0613606677422, -1116.3976631432336, -654.0189189977006, -501.74581124005044, -798.3699660057422, -1203.9385734942814, -1082.0907286407714, -394.41729969669444, -677.9611896108728, -540.2029569599493, -754.0495819975154, -684.376520070522, -1026.549368134969, -581.8008976875988, -876.150756472005, -1026.3913555404197, -941.0153748167279, -894.517853659287, -771.3302897777419, -1000.0613863105932, -842.1085515218751, -978.9860428100424, -813.4259322144324, -855.2558251874146, -809.3701680786904, -623.5688613804812, -691.690434146929, -1079.2199202035683, -981.7720482360744, -1082.7679266808696, -612.0075463253661, -727.6773331050063, -530.4021591506896, -704.1432740093248, -857.4587423458685, -999.4472655854777, -733.8772667141154, -773.7495603462278, -916.1381297648675, -972.3508070939575, -954.4290190514084, -995.778583007221, -728.3017600252008, -948.2494413130097, -850.4386558258736, -786.6237144016616, -491.99980470992875, -963.0005892533788, -602.4696272128233, -534.2964904864742, -765.2255988135338, -1152.6001370306305, -732.0769404936107, -791.9863848469458, -916.4358306943702, -735.9125920102998, -757.7772228364103, -569.7552278520072, -702.3207483109954, -647.6811417861289, -670.9380505027437, -1070.644233335096, -798.4568093521814, -626.3483127361287, -745.7895433704377, -563.0169346287039, -650.0012411979194, -766.1771461992677, -755.1716508967431, -617.1073540062661, -405.8218282116934, -605.5509802718186, -700.5695184825174, -757.3624230407881, -842.9979490441494], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 21.07974833807371, "mean_inference_ms": 0.40131563285099175, "mean_action_processing_ms": 0.09578225184510891, "mean_env_wait_ms": 2.764618052655056, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003932476043701172, "StateBufferConnector_ms": 0.0027501583099365234, "ViewRequirementAgentConnector_ms": 0.06845951080322266}}, "episode_reward_max": -394.41729969669444, "episode_reward_min": -1203.9385734942814, "episode_reward_mean": -773.5871929669763, "episode_len_mean": 120.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-890.643322597953, -822.2198866915962, -710.9860813596496, -937.5742495392379, -662.4326357313347, -800.6691972778154, -658.2315142840092, -700.7227396798912, -586.691534492754, -761.4475237982085, -733.9128377870884, -782.827678748833, -549.3468543859714, -774.413592672589, -682.1860211806298, -751.5461669019867, -673.7653080406461, -719.383273251562, -860.7816931032946, -574.5873207935329, -758.1958160256859, -814.6505144404368, -550.202945075386, -711.9037625285532, -651.2176932449257, -924.0613606677422, -1116.3976631432336, -654.0189189977006, -501.74581124005044, -798.3699660057422, -1203.9385734942814, -1082.0907286407714, -394.41729969669444, -677.9611896108728, -540.2029569599493, -754.0495819975154, -684.376520070522, -1026.549368134969, -581.8008976875988, -876.150756472005, -1026.3913555404197, -941.0153748167279, -894.517853659287, -771.3302897777419, -1000.0613863105932, -842.1085515218751, -978.9860428100424, -813.4259322144324, -855.2558251874146, -809.3701680786904, -623.5688613804812, -691.690434146929, -1079.2199202035683, -981.7720482360744, -1082.7679266808696, -612.0075463253661, -727.6773331050063, -530.4021591506896, -704.1432740093248, -857.4587423458685, -999.4472655854777, -733.8772667141154, -773.7495603462278, -916.1381297648675, -972.3508070939575, -954.4290190514084, -995.778583007221, -728.3017600252008, -948.2494413130097, -850.4386558258736, -786.6237144016616, -491.99980470992875, -963.0005892533788, -602.4696272128233, -534.2964904864742, -765.2255988135338, -1152.6001370306305, -732.0769404936107, -791.9863848469458, -916.4358306943702, -735.9125920102998, -757.7772228364103, -569.7552278520072, -702.3207483109954, -647.6811417861289, -670.9380505027437, -1070.644233335096, -798.4568093521814, -626.3483127361287, -745.7895433704377, -563.0169346287039, -650.0012411979194, -766.1771461992677, -755.1716508967431, -617.1073540062661, -405.8218282116934, -605.5509802718186, -700.5695184825174, -757.3624230407881, -842.9979490441494], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 21.07974833807371, "mean_inference_ms": 0.40131563285099175, "mean_action_processing_ms": 0.09578225184510891, "mean_env_wait_ms": 2.764618052655056, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003932476043701172, "StateBufferConnector_ms": 0.0027501583099365234, "ViewRequirementAgentConnector_ms": 0.06845951080322266}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 249720, "num_agent_steps_trained": 249720, "num_env_steps_sampled": 249720, "num_env_steps_trained": 249720, "num_env_steps_sampled_this_iter": 480, "num_env_steps_trained_this_iter": 480, "num_env_steps_sampled_throughput_per_sec": 41.20325951071974, "num_env_steps_trained_throughput_per_sec": 41.20325951071974, "timesteps_total": 249720, "num_steps_trained_this_iter": 480, "agent_timesteps_total": 249720, "timers": {"training_iteration_time_ms": 2945.303, "sample_time_ms": 2941.427, "load_time_ms": 0.248, "load_throughput": 484703.852, "learn_time_ms": 2.861, "learn_throughput": 41941.292, "synch_weights_time_ms": 0.726}, "counters": {"num_env_steps_sampled": 249720, "num_env_steps_trained": 249720, "num_agent_steps_sampled": 249720, "num_agent_steps_trained": 249720}, "done": false, "episodes_total": 2081, "training_iteration": 521, "trial_id": "29a31_00000", "date": "2023-07-26_02-34-46", "timestamp": 1690328086, "time_this_iter_s": 11.652416944503784, "time_total_s": 6333.281460285187, "pid": 90822, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 1, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[253680, 5e-06], [256080, 5e-06], [258480, 2.5e-06], [260880, 2.5e-06], [263280, 2.5e-06], [265680, 2.5e-06], [268080, 1e-06], [270480, 1e-06], [272880, 1e-06], [275280, 5e-07], [277680, 5e-07], [280080, 5e-07], [282480, 5e-07], [284880, 5e-07], [287280, 1e-07], [289680, 1e-07], [292080, 1e-07]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 120, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x16ca65700>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 711.9559843540192, "iterations_since_restore": 61, "perf": {"cpu_util_percent": 33.1, "ram_util_percent": 74.56470588235295}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-07, "entropy_coeff": 0.05, "policy_entropy": 267.4493713378906, "policy_loss": -89423.0546875, "vf_loss": 4072197.75}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 247.0, "diff_num_grad_updates_vs_sampler_policy": 246.0}}, "num_env_steps_sampled": 250200, "num_env_steps_trained": 250200, "num_agent_steps_sampled": 250200, "num_agent_steps_trained": 250200}, "sampler_results": {"episode_reward_max": -394.41729969669444, "episode_reward_min": -1203.9385734942814, "episode_reward_mean": -767.9031802207969, "episode_len_mean": 120.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-662.4326357313347, -800.6691972778154, -658.2315142840092, -700.7227396798912, -586.691534492754, -761.4475237982085, -733.9128377870884, -782.827678748833, -549.3468543859714, -774.413592672589, -682.1860211806298, -751.5461669019867, -673.7653080406461, -719.383273251562, -860.7816931032946, -574.5873207935329, -758.1958160256859, -814.6505144404368, -550.202945075386, -711.9037625285532, -651.2176932449257, -924.0613606677422, -1116.3976631432336, -654.0189189977006, -501.74581124005044, -798.3699660057422, -1203.9385734942814, -1082.0907286407714, -394.41729969669444, -677.9611896108728, -540.2029569599493, -754.0495819975154, -684.376520070522, -1026.549368134969, -581.8008976875988, -876.150756472005, -1026.3913555404197, -941.0153748167279, -894.517853659287, -771.3302897777419, -1000.0613863105932, -842.1085515218751, -978.9860428100424, -813.4259322144324, -855.2558251874146, -809.3701680786904, -623.5688613804812, -691.690434146929, -1079.2199202035683, -981.7720482360744, -1082.7679266808696, -612.0075463253661, -727.6773331050063, -530.4021591506896, -704.1432740093248, -857.4587423458685, -999.4472655854777, -733.8772667141154, -773.7495603462278, -916.1381297648675, -972.3508070939575, -954.4290190514084, -995.778583007221, -728.3017600252008, -948.2494413130097, -850.4386558258736, -786.6237144016616, -491.99980470992875, -963.0005892533788, -602.4696272128233, -534.2964904864742, -765.2255988135338, -1152.6001370306305, -732.0769404936107, -791.9863848469458, -916.4358306943702, -735.9125920102998, -757.7772228364103, -569.7552278520072, -702.3207483109954, -647.6811417861289, -670.9380505027437, -1070.644233335096, -798.4568093521814, -626.3483127361287, -745.7895433704377, -563.0169346287039, -650.0012411979194, -766.1771461992677, -755.1716508967431, -617.1073540062661, -405.8218282116934, -605.5509802718186, -700.5695184825174, -757.3624230407881, -842.9979490441494, -586.975997972194, -559.4725684851281, -920.866738946617, -725.706960166542], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 21.080085491380558, "mean_inference_ms": 0.40127194397029015, "mean_action_processing_ms": 0.09577670874030364, "mean_env_wait_ms": 2.762100589183255, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003920078277587891, "StateBufferConnector_ms": 0.002742767333984375, "ViewRequirementAgentConnector_ms": 0.0684213638305664}}, "episode_reward_max": -394.41729969669444, "episode_reward_min": -1203.9385734942814, "episode_reward_mean": -767.9031802207969, "episode_len_mean": 120.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-662.4326357313347, -800.6691972778154, -658.2315142840092, -700.7227396798912, -586.691534492754, -761.4475237982085, -733.9128377870884, -782.827678748833, -549.3468543859714, -774.413592672589, -682.1860211806298, -751.5461669019867, -673.7653080406461, -719.383273251562, -860.7816931032946, -574.5873207935329, -758.1958160256859, -814.6505144404368, -550.202945075386, -711.9037625285532, -651.2176932449257, -924.0613606677422, -1116.3976631432336, -654.0189189977006, -501.74581124005044, -798.3699660057422, -1203.9385734942814, -1082.0907286407714, -394.41729969669444, -677.9611896108728, -540.2029569599493, -754.0495819975154, -684.376520070522, -1026.549368134969, -581.8008976875988, -876.150756472005, -1026.3913555404197, -941.0153748167279, -894.517853659287, -771.3302897777419, -1000.0613863105932, -842.1085515218751, -978.9860428100424, -813.4259322144324, -855.2558251874146, -809.3701680786904, -623.5688613804812, -691.690434146929, -1079.2199202035683, -981.7720482360744, -1082.7679266808696, -612.0075463253661, -727.6773331050063, -530.4021591506896, -704.1432740093248, -857.4587423458685, -999.4472655854777, -733.8772667141154, -773.7495603462278, -916.1381297648675, -972.3508070939575, -954.4290190514084, -995.778583007221, -728.3017600252008, -948.2494413130097, -850.4386558258736, -786.6237144016616, -491.99980470992875, -963.0005892533788, -602.4696272128233, -534.2964904864742, -765.2255988135338, -1152.6001370306305, -732.0769404936107, -791.9863848469458, -916.4358306943702, -735.9125920102998, -757.7772228364103, -569.7552278520072, -702.3207483109954, -647.6811417861289, -670.9380505027437, -1070.644233335096, -798.4568093521814, -626.3483127361287, -745.7895433704377, -563.0169346287039, -650.0012411979194, -766.1771461992677, -755.1716508967431, -617.1073540062661, -405.8218282116934, -605.5509802718186, -700.5695184825174, -757.3624230407881, -842.9979490441494, -586.975997972194, -559.4725684851281, -920.866738946617, -725.706960166542], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 21.080085491380558, "mean_inference_ms": 0.40127194397029015, "mean_action_processing_ms": 0.09577670874030364, "mean_env_wait_ms": 2.762100589183255, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003920078277587891, "StateBufferConnector_ms": 0.002742767333984375, "ViewRequirementAgentConnector_ms": 0.0684213638305664}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 250200, "num_agent_steps_trained": 250200, "num_env_steps_sampled": 250200, "num_env_steps_trained": 250200, "num_env_steps_sampled_this_iter": 480, "num_env_steps_trained_this_iter": 480, "num_env_steps_sampled_throughput_per_sec": 41.372965358078154, "num_env_steps_trained_throughput_per_sec": 41.372965358078154, "timesteps_total": 250200, "num_steps_trained_this_iter": 480, "agent_timesteps_total": 250200, "timers": {"training_iteration_time_ms": 2905.803, "sample_time_ms": 2901.927, "load_time_ms": 0.224, "load_throughput": 536413.173, "learn_time_ms": 2.889, "learn_throughput": 41542.844, "synch_weights_time_ms": 0.723}, "counters": {"num_env_steps_sampled": 250200, "num_env_steps_trained": 250200, "num_agent_steps_sampled": 250200, "num_agent_steps_trained": 250200}, "done": false, "episodes_total": 2085, "training_iteration": 522, "trial_id": "29a31_00000", "date": "2023-07-26_02-34-58", "timestamp": 1690328098, "time_this_iter_s": 11.604593992233276, "time_total_s": 6344.88605427742, "pid": 90822, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 1, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[253680, 5e-06], [256080, 5e-06], [258480, 2.5e-06], [260880, 2.5e-06], [263280, 2.5e-06], [265680, 2.5e-06], [268080, 1e-06], [270480, 1e-06], [272880, 1e-06], [275280, 5e-07], [277680, 5e-07], [280080, 5e-07], [282480, 5e-07], [284880, 5e-07], [287280, 1e-07], [289680, 1e-07], [292080, 1e-07]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 120, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x16ca65700>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 723.5605783462524, "iterations_since_restore": 62, "perf": {"cpu_util_percent": 34.50625, "ram_util_percent": 73.8375}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-07, "entropy_coeff": 0.05, "policy_entropy": 267.4406433105469, "policy_loss": -119206.109375, "vf_loss": 5875811.5}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 251.0, "diff_num_grad_updates_vs_sampler_policy": 250.0}}, "num_env_steps_sampled": 250680, "num_env_steps_trained": 250680, "num_agent_steps_sampled": 250680, "num_agent_steps_trained": 250680}, "sampler_results": {"episode_reward_max": -394.41729969669444, "episode_reward_min": -1203.9385734942814, "episode_reward_mean": -774.063217871955, "episode_len_mean": 120.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-586.691534492754, -761.4475237982085, -733.9128377870884, -782.827678748833, -549.3468543859714, -774.413592672589, -682.1860211806298, -751.5461669019867, -673.7653080406461, -719.383273251562, -860.7816931032946, -574.5873207935329, -758.1958160256859, -814.6505144404368, -550.202945075386, -711.9037625285532, -651.2176932449257, -924.0613606677422, -1116.3976631432336, -654.0189189977006, -501.74581124005044, -798.3699660057422, -1203.9385734942814, -1082.0907286407714, -394.41729969669444, -677.9611896108728, -540.2029569599493, -754.0495819975154, -684.376520070522, -1026.549368134969, -581.8008976875988, -876.150756472005, -1026.3913555404197, -941.0153748167279, -894.517853659287, -771.3302897777419, -1000.0613863105932, -842.1085515218751, -978.9860428100424, -813.4259322144324, -855.2558251874146, -809.3701680786904, -623.5688613804812, -691.690434146929, -1079.2199202035683, -981.7720482360744, -1082.7679266808696, -612.0075463253661, -727.6773331050063, -530.4021591506896, -704.1432740093248, -857.4587423458685, -999.4472655854777, -733.8772667141154, -773.7495603462278, -916.1381297648675, -972.3508070939575, -954.4290190514084, -995.778583007221, -728.3017600252008, -948.2494413130097, -850.4386558258736, -786.6237144016616, -491.99980470992875, -963.0005892533788, -602.4696272128233, -534.2964904864742, -765.2255988135338, -1152.6001370306305, -732.0769404936107, -791.9863848469458, -916.4358306943702, -735.9125920102998, -757.7772228364103, -569.7552278520072, -702.3207483109954, -647.6811417861289, -670.9380505027437, -1070.644233335096, -798.4568093521814, -626.3483127361287, -745.7895433704377, -563.0169346287039, -650.0012411979194, -766.1771461992677, -755.1716508967431, -617.1073540062661, -405.8218282116934, -605.5509802718186, -700.5695184825174, -757.3624230407881, -842.9979490441494, -586.975997972194, -559.4725684851281, -920.866738946617, -725.706960166542, -1142.077011550846, -886.0252132539247, -572.9000785535595, -837.0575487305188], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 21.080260896508943, "mean_inference_ms": 0.4012286646071101, "mean_action_processing_ms": 0.0957720060318299, "mean_env_wait_ms": 2.759684090534732, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003917694091796875, "StateBufferConnector_ms": 0.0027246475219726562, "ViewRequirementAgentConnector_ms": 0.06839466094970703}}, "episode_reward_max": -394.41729969669444, "episode_reward_min": -1203.9385734942814, "episode_reward_mean": -774.063217871955, "episode_len_mean": 120.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-586.691534492754, -761.4475237982085, -733.9128377870884, -782.827678748833, -549.3468543859714, -774.413592672589, -682.1860211806298, -751.5461669019867, -673.7653080406461, -719.383273251562, -860.7816931032946, -574.5873207935329, -758.1958160256859, -814.6505144404368, -550.202945075386, -711.9037625285532, -651.2176932449257, -924.0613606677422, -1116.3976631432336, -654.0189189977006, -501.74581124005044, -798.3699660057422, -1203.9385734942814, -1082.0907286407714, -394.41729969669444, -677.9611896108728, -540.2029569599493, -754.0495819975154, -684.376520070522, -1026.549368134969, -581.8008976875988, -876.150756472005, -1026.3913555404197, -941.0153748167279, -894.517853659287, -771.3302897777419, -1000.0613863105932, -842.1085515218751, -978.9860428100424, -813.4259322144324, -855.2558251874146, -809.3701680786904, -623.5688613804812, -691.690434146929, -1079.2199202035683, -981.7720482360744, -1082.7679266808696, -612.0075463253661, -727.6773331050063, -530.4021591506896, -704.1432740093248, -857.4587423458685, -999.4472655854777, -733.8772667141154, -773.7495603462278, -916.1381297648675, -972.3508070939575, -954.4290190514084, -995.778583007221, -728.3017600252008, -948.2494413130097, -850.4386558258736, -786.6237144016616, -491.99980470992875, -963.0005892533788, -602.4696272128233, -534.2964904864742, -765.2255988135338, -1152.6001370306305, -732.0769404936107, -791.9863848469458, -916.4358306943702, -735.9125920102998, -757.7772228364103, -569.7552278520072, -702.3207483109954, -647.6811417861289, -670.9380505027437, -1070.644233335096, -798.4568093521814, -626.3483127361287, -745.7895433704377, -563.0169346287039, -650.0012411979194, -766.1771461992677, -755.1716508967431, -617.1073540062661, -405.8218282116934, -605.5509802718186, -700.5695184825174, -757.3624230407881, -842.9979490441494, -586.975997972194, -559.4725684851281, -920.866738946617, -725.706960166542, -1142.077011550846, -886.0252132539247, -572.9000785535595, -837.0575487305188], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 21.080260896508943, "mean_inference_ms": 0.4012286646071101, "mean_action_processing_ms": 0.0957720060318299, "mean_env_wait_ms": 2.759684090534732, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003917694091796875, "StateBufferConnector_ms": 0.0027246475219726562, "ViewRequirementAgentConnector_ms": 0.06839466094970703}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 250680, "num_agent_steps_trained": 250680, "num_env_steps_sampled": 250680, "num_env_steps_trained": 250680, "num_env_steps_sampled_this_iter": 480, "num_env_steps_trained_this_iter": 480, "num_env_steps_sampled_throughput_per_sec": 40.907686898443835, "num_env_steps_trained_throughput_per_sec": 40.907686898443835, "timesteps_total": 250680, "num_steps_trained_this_iter": 480, "agent_timesteps_total": 250680, "timers": {"training_iteration_time_ms": 2901.463, "sample_time_ms": 2897.62, "load_time_ms": 0.218, "load_throughput": 549532.132, "learn_time_ms": 2.866, "learn_throughput": 41875.342, "synch_weights_time_ms": 0.718}, "counters": {"num_env_steps_sampled": 250680, "num_env_steps_trained": 250680, "num_agent_steps_sampled": 250680, "num_agent_steps_trained": 250680}, "done": false, "episodes_total": 2089, "training_iteration": 523, "trial_id": "29a31_00000", "date": "2023-07-26_02-35-10", "timestamp": 1690328110, "time_this_iter_s": 11.736435890197754, "time_total_s": 6356.622490167618, "pid": 90822, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 1, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[253680, 5e-06], [256080, 5e-06], [258480, 2.5e-06], [260880, 2.5e-06], [263280, 2.5e-06], [265680, 2.5e-06], [268080, 1e-06], [270480, 1e-06], [272880, 1e-06], [275280, 5e-07], [277680, 5e-07], [280080, 5e-07], [282480, 5e-07], [284880, 5e-07], [287280, 1e-07], [289680, 1e-07], [292080, 1e-07]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 120, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x16ca65700>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 735.2970142364502, "iterations_since_restore": 63, "perf": {"cpu_util_percent": 36.2764705882353, "ram_util_percent": 74.11764705882354}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-07, "entropy_coeff": 0.05, "policy_entropy": 267.4324951171875, "policy_loss": -107730.046875, "vf_loss": 5404558.5}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 255.0, "diff_num_grad_updates_vs_sampler_policy": 254.0}}, "num_env_steps_sampled": 251160, "num_env_steps_trained": 251160, "num_agent_steps_sampled": 251160, "num_agent_steps_trained": 251160}, "sampler_results": {"episode_reward_max": -394.41729969669444, "episode_reward_min": -1203.9385734942814, "episode_reward_mean": -780.3453017754349, "episode_len_mean": 120.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-549.3468543859714, -774.413592672589, -682.1860211806298, -751.5461669019867, -673.7653080406461, -719.383273251562, -860.7816931032946, -574.5873207935329, -758.1958160256859, -814.6505144404368, -550.202945075386, -711.9037625285532, -651.2176932449257, -924.0613606677422, -1116.3976631432336, -654.0189189977006, -501.74581124005044, -798.3699660057422, -1203.9385734942814, -1082.0907286407714, -394.41729969669444, -677.9611896108728, -540.2029569599493, -754.0495819975154, -684.376520070522, -1026.549368134969, -581.8008976875988, -876.150756472005, -1026.3913555404197, -941.0153748167279, -894.517853659287, -771.3302897777419, -1000.0613863105932, -842.1085515218751, -978.9860428100424, -813.4259322144324, -855.2558251874146, -809.3701680786904, -623.5688613804812, -691.690434146929, -1079.2199202035683, -981.7720482360744, -1082.7679266808696, -612.0075463253661, -727.6773331050063, -530.4021591506896, -704.1432740093248, -857.4587423458685, -999.4472655854777, -733.8772667141154, -773.7495603462278, -916.1381297648675, -972.3508070939575, -954.4290190514084, -995.778583007221, -728.3017600252008, -948.2494413130097, -850.4386558258736, -786.6237144016616, -491.99980470992875, -963.0005892533788, -602.4696272128233, -534.2964904864742, -765.2255988135338, -1152.6001370306305, -732.0769404936107, -791.9863848469458, -916.4358306943702, -735.9125920102998, -757.7772228364103, -569.7552278520072, -702.3207483109954, -647.6811417861289, -670.9380505027437, -1070.644233335096, -798.4568093521814, -626.3483127361287, -745.7895433704377, -563.0169346287039, -650.0012411979194, -766.1771461992677, -755.1716508967431, -617.1073540062661, -405.8218282116934, -605.5509802718186, -700.5695184825174, -757.3624230407881, -842.9979490441494, -586.975997972194, -559.4725684851281, -920.866738946617, -725.706960166542, -1142.077011550846, -886.0252132539247, -572.9000785535595, -837.0575487305188, -1019.7576467496582, -664.5709938593048, -936.9607098420689, -871.798614723867], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 21.08118312750766, "mean_inference_ms": 0.4011715675169228, "mean_action_processing_ms": 0.09576415661716255, "mean_env_wait_ms": 2.757496477129032, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0039043426513671875, "StateBufferConnector_ms": 0.0027196407318115234, "ViewRequirementAgentConnector_ms": 0.06815552711486816}}, "episode_reward_max": -394.41729969669444, "episode_reward_min": -1203.9385734942814, "episode_reward_mean": -780.3453017754349, "episode_len_mean": 120.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-549.3468543859714, -774.413592672589, -682.1860211806298, -751.5461669019867, -673.7653080406461, -719.383273251562, -860.7816931032946, -574.5873207935329, -758.1958160256859, -814.6505144404368, -550.202945075386, -711.9037625285532, -651.2176932449257, -924.0613606677422, -1116.3976631432336, -654.0189189977006, -501.74581124005044, -798.3699660057422, -1203.9385734942814, -1082.0907286407714, -394.41729969669444, -677.9611896108728, -540.2029569599493, -754.0495819975154, -684.376520070522, -1026.549368134969, -581.8008976875988, -876.150756472005, -1026.3913555404197, -941.0153748167279, -894.517853659287, -771.3302897777419, -1000.0613863105932, -842.1085515218751, -978.9860428100424, -813.4259322144324, -855.2558251874146, -809.3701680786904, -623.5688613804812, -691.690434146929, -1079.2199202035683, -981.7720482360744, -1082.7679266808696, -612.0075463253661, -727.6773331050063, -530.4021591506896, -704.1432740093248, -857.4587423458685, -999.4472655854777, -733.8772667141154, -773.7495603462278, -916.1381297648675, -972.3508070939575, -954.4290190514084, -995.778583007221, -728.3017600252008, -948.2494413130097, -850.4386558258736, -786.6237144016616, -491.99980470992875, -963.0005892533788, -602.4696272128233, -534.2964904864742, -765.2255988135338, -1152.6001370306305, -732.0769404936107, -791.9863848469458, -916.4358306943702, -735.9125920102998, -757.7772228364103, -569.7552278520072, -702.3207483109954, -647.6811417861289, -670.9380505027437, -1070.644233335096, -798.4568093521814, -626.3483127361287, -745.7895433704377, -563.0169346287039, -650.0012411979194, -766.1771461992677, -755.1716508967431, -617.1073540062661, -405.8218282116934, -605.5509802718186, -700.5695184825174, -757.3624230407881, -842.9979490441494, -586.975997972194, -559.4725684851281, -920.866738946617, -725.706960166542, -1142.077011550846, -886.0252132539247, -572.9000785535595, -837.0575487305188, -1019.7576467496582, -664.5709938593048, -936.9607098420689, -871.798614723867], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 21.08118312750766, "mean_inference_ms": 0.4011715675169228, "mean_action_processing_ms": 0.09576415661716255, "mean_env_wait_ms": 2.757496477129032, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0039043426513671875, "StateBufferConnector_ms": 0.0027196407318115234, "ViewRequirementAgentConnector_ms": 0.06815552711486816}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 251160, "num_agent_steps_trained": 251160, "num_env_steps_sampled": 251160, "num_env_steps_trained": 251160, "num_env_steps_sampled_this_iter": 480, "num_env_steps_trained_this_iter": 480, "num_env_steps_sampled_throughput_per_sec": 39.885326111892866, "num_env_steps_trained_throughput_per_sec": 39.885326111892866, "timesteps_total": 251160, "num_steps_trained_this_iter": 480, "agent_timesteps_total": 251160, "timers": {"training_iteration_time_ms": 2960.228, "sample_time_ms": 2956.483, "load_time_ms": 0.215, "load_throughput": 557197.476, "learn_time_ms": 2.784, "learn_throughput": 43108.773, "synch_weights_time_ms": 0.705}, "counters": {"num_env_steps_sampled": 251160, "num_env_steps_trained": 251160, "num_agent_steps_sampled": 251160, "num_agent_steps_trained": 251160}, "done": false, "episodes_total": 2093, "training_iteration": 524, "trial_id": "29a31_00000", "date": "2023-07-26_02-35-22", "timestamp": 1690328122, "time_this_iter_s": 12.037235975265503, "time_total_s": 6368.659726142883, "pid": 90822, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 1, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[253680, 5e-06], [256080, 5e-06], [258480, 2.5e-06], [260880, 2.5e-06], [263280, 2.5e-06], [265680, 2.5e-06], [268080, 1e-06], [270480, 1e-06], [272880, 1e-06], [275280, 5e-07], [277680, 5e-07], [280080, 5e-07], [282480, 5e-07], [284880, 5e-07], [287280, 1e-07], [289680, 1e-07], [292080, 1e-07]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 120, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x16ca65700>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 747.3342502117157, "iterations_since_restore": 64, "perf": {"cpu_util_percent": 37.411764705882355, "ram_util_percent": 74.71176470588236}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-07, "entropy_coeff": 0.05, "policy_entropy": 267.4375, "policy_loss": -71324.7734375, "vf_loss": 2856895.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 259.0, "diff_num_grad_updates_vs_sampler_policy": 258.0}}, "num_env_steps_sampled": 251640, "num_env_steps_trained": 251640, "num_agent_steps_sampled": 251640, "num_agent_steps_trained": 251640}, "sampler_results": {"episode_reward_max": -394.41729969669444, "episode_reward_min": -1203.9385734942814, "episode_reward_mean": -784.263870651831, "episode_len_mean": 120.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-673.7653080406461, -719.383273251562, -860.7816931032946, -574.5873207935329, -758.1958160256859, -814.6505144404368, -550.202945075386, -711.9037625285532, -651.2176932449257, -924.0613606677422, -1116.3976631432336, -654.0189189977006, -501.74581124005044, -798.3699660057422, -1203.9385734942814, -1082.0907286407714, -394.41729969669444, -677.9611896108728, -540.2029569599493, -754.0495819975154, -684.376520070522, -1026.549368134969, -581.8008976875988, -876.150756472005, -1026.3913555404197, -941.0153748167279, -894.517853659287, -771.3302897777419, -1000.0613863105932, -842.1085515218751, -978.9860428100424, -813.4259322144324, -855.2558251874146, -809.3701680786904, -623.5688613804812, -691.690434146929, -1079.2199202035683, -981.7720482360744, -1082.7679266808696, -612.0075463253661, -727.6773331050063, -530.4021591506896, -704.1432740093248, -857.4587423458685, -999.4472655854777, -733.8772667141154, -773.7495603462278, -916.1381297648675, -972.3508070939575, -954.4290190514084, -995.778583007221, -728.3017600252008, -948.2494413130097, -850.4386558258736, -786.6237144016616, -491.99980470992875, -963.0005892533788, -602.4696272128233, -534.2964904864742, -765.2255988135338, -1152.6001370306305, -732.0769404936107, -791.9863848469458, -916.4358306943702, -735.9125920102998, -757.7772228364103, -569.7552278520072, -702.3207483109954, -647.6811417861289, -670.9380505027437, -1070.644233335096, -798.4568093521814, -626.3483127361287, -745.7895433704377, -563.0169346287039, -650.0012411979194, -766.1771461992677, -755.1716508967431, -617.1073540062661, -405.8218282116934, -605.5509802718186, -700.5695184825174, -757.3624230407881, -842.9979490441494, -586.975997972194, -559.4725684851281, -920.866738946617, -725.706960166542, -1142.077011550846, -886.0252132539247, -572.9000785535595, -837.0575487305188, -1019.7576467496582, -664.5709938593048, -936.9607098420689, -871.798614723867, -660.2346934523323, -1061.236532504413, -774.3954205921513, -653.4828762318899], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 21.082223626929267, "mean_inference_ms": 0.40111672846207597, "mean_action_processing_ms": 0.09575688788837472, "mean_env_wait_ms": 2.755456693774223, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0039060115814208984, "StateBufferConnector_ms": 0.0027289390563964844, "ViewRequirementAgentConnector_ms": 0.06806802749633789}}, "episode_reward_max": -394.41729969669444, "episode_reward_min": -1203.9385734942814, "episode_reward_mean": -784.263870651831, "episode_len_mean": 120.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-673.7653080406461, -719.383273251562, -860.7816931032946, -574.5873207935329, -758.1958160256859, -814.6505144404368, -550.202945075386, -711.9037625285532, -651.2176932449257, -924.0613606677422, -1116.3976631432336, -654.0189189977006, -501.74581124005044, -798.3699660057422, -1203.9385734942814, -1082.0907286407714, -394.41729969669444, -677.9611896108728, -540.2029569599493, -754.0495819975154, -684.376520070522, -1026.549368134969, -581.8008976875988, -876.150756472005, -1026.3913555404197, -941.0153748167279, -894.517853659287, -771.3302897777419, -1000.0613863105932, -842.1085515218751, -978.9860428100424, -813.4259322144324, -855.2558251874146, -809.3701680786904, -623.5688613804812, -691.690434146929, -1079.2199202035683, -981.7720482360744, -1082.7679266808696, -612.0075463253661, -727.6773331050063, -530.4021591506896, -704.1432740093248, -857.4587423458685, -999.4472655854777, -733.8772667141154, -773.7495603462278, -916.1381297648675, -972.3508070939575, -954.4290190514084, -995.778583007221, -728.3017600252008, -948.2494413130097, -850.4386558258736, -786.6237144016616, -491.99980470992875, -963.0005892533788, -602.4696272128233, -534.2964904864742, -765.2255988135338, -1152.6001370306305, -732.0769404936107, -791.9863848469458, -916.4358306943702, -735.9125920102998, -757.7772228364103, -569.7552278520072, -702.3207483109954, -647.6811417861289, -670.9380505027437, -1070.644233335096, -798.4568093521814, -626.3483127361287, -745.7895433704377, -563.0169346287039, -650.0012411979194, -766.1771461992677, -755.1716508967431, -617.1073540062661, -405.8218282116934, -605.5509802718186, -700.5695184825174, -757.3624230407881, -842.9979490441494, -586.975997972194, -559.4725684851281, -920.866738946617, -725.706960166542, -1142.077011550846, -886.0252132539247, -572.9000785535595, -837.0575487305188, -1019.7576467496582, -664.5709938593048, -936.9607098420689, -871.798614723867, -660.2346934523323, -1061.236532504413, -774.3954205921513, -653.4828762318899], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 21.082223626929267, "mean_inference_ms": 0.40111672846207597, "mean_action_processing_ms": 0.09575688788837472, "mean_env_wait_ms": 2.755456693774223, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0039060115814208984, "StateBufferConnector_ms": 0.0027289390563964844, "ViewRequirementAgentConnector_ms": 0.06806802749633789}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 251640, "num_agent_steps_trained": 251640, "num_env_steps_sampled": 251640, "num_env_steps_trained": 251640, "num_env_steps_sampled_this_iter": 480, "num_env_steps_trained_this_iter": 480, "num_env_steps_sampled_throughput_per_sec": 40.72802377619806, "num_env_steps_trained_throughput_per_sec": 40.72802377619806, "timesteps_total": 251640, "num_steps_trained_this_iter": 480, "agent_timesteps_total": 251640, "timers": {"training_iteration_time_ms": 2972.687, "sample_time_ms": 2968.923, "load_time_ms": 0.216, "load_throughput": 555046.846, "learn_time_ms": 2.804, "learn_throughput": 42797.929, "synch_weights_time_ms": 0.704}, "counters": {"num_env_steps_sampled": 251640, "num_env_steps_trained": 251640, "num_agent_steps_sampled": 251640, "num_agent_steps_trained": 251640}, "done": false, "episodes_total": 2097, "training_iteration": 525, "trial_id": "29a31_00000", "date": "2023-07-26_02-35-34", "timestamp": 1690328134, "time_this_iter_s": 11.788235902786255, "time_total_s": 6380.44796204567, "pid": 90822, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 1, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[253680, 5e-06], [256080, 5e-06], [258480, 2.5e-06], [260880, 2.5e-06], [263280, 2.5e-06], [265680, 2.5e-06], [268080, 1e-06], [270480, 1e-06], [272880, 1e-06], [275280, 5e-07], [277680, 5e-07], [280080, 5e-07], [282480, 5e-07], [284880, 5e-07], [287280, 1e-07], [289680, 1e-07], [292080, 1e-07]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 120, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x16ca65700>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 759.122486114502, "iterations_since_restore": 65, "perf": {"cpu_util_percent": 39.11875, "ram_util_percent": 74.94999999999999}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-07, "entropy_coeff": 0.05, "policy_entropy": 267.4440612792969, "policy_loss": -112334.4296875, "vf_loss": 5186314.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 263.0, "diff_num_grad_updates_vs_sampler_policy": 262.0}}, "num_env_steps_sampled": 252120, "num_env_steps_trained": 252120, "num_agent_steps_sampled": 252120, "num_agent_steps_trained": 252120}, "sampler_results": {"episode_reward_max": -394.41729969669444, "episode_reward_min": -1203.9385734942814, "episode_reward_mean": -784.4687487594352, "episode_len_mean": 120.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-758.1958160256859, -814.6505144404368, -550.202945075386, -711.9037625285532, -651.2176932449257, -924.0613606677422, -1116.3976631432336, -654.0189189977006, -501.74581124005044, -798.3699660057422, -1203.9385734942814, -1082.0907286407714, -394.41729969669444, -677.9611896108728, -540.2029569599493, -754.0495819975154, -684.376520070522, -1026.549368134969, -581.8008976875988, -876.150756472005, -1026.3913555404197, -941.0153748167279, -894.517853659287, -771.3302897777419, -1000.0613863105932, -842.1085515218751, -978.9860428100424, -813.4259322144324, -855.2558251874146, -809.3701680786904, -623.5688613804812, -691.690434146929, -1079.2199202035683, -981.7720482360744, -1082.7679266808696, -612.0075463253661, -727.6773331050063, -530.4021591506896, -704.1432740093248, -857.4587423458685, -999.4472655854777, -733.8772667141154, -773.7495603462278, -916.1381297648675, -972.3508070939575, -954.4290190514084, -995.778583007221, -728.3017600252008, -948.2494413130097, -850.4386558258736, -786.6237144016616, -491.99980470992875, -963.0005892533788, -602.4696272128233, -534.2964904864742, -765.2255988135338, -1152.6001370306305, -732.0769404936107, -791.9863848469458, -916.4358306943702, -735.9125920102998, -757.7772228364103, -569.7552278520072, -702.3207483109954, -647.6811417861289, -670.9380505027437, -1070.644233335096, -798.4568093521814, -626.3483127361287, -745.7895433704377, -563.0169346287039, -650.0012411979194, -766.1771461992677, -755.1716508967431, -617.1073540062661, -405.8218282116934, -605.5509802718186, -700.5695184825174, -757.3624230407881, -842.9979490441494, -586.975997972194, -559.4725684851281, -920.866738946617, -725.706960166542, -1142.077011550846, -886.0252132539247, -572.9000785535595, -837.0575487305188, -1019.7576467496582, -664.5709938593048, -936.9607098420689, -871.798614723867, -660.2346934523323, -1061.236532504413, -774.3954205921513, -653.4828762318899, -563.6321968465464, -772.215125564206, -597.1356022073888, -916.0224813313109], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 21.083612199888975, "mean_inference_ms": 0.4010701291948952, "mean_action_processing_ms": 0.09575078834498914, "mean_env_wait_ms": 2.7535262183017553, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0039348602294921875, "StateBufferConnector_ms": 0.0027320384979248047, "ViewRequirementAgentConnector_ms": 0.06828045845031738}}, "episode_reward_max": -394.41729969669444, "episode_reward_min": -1203.9385734942814, "episode_reward_mean": -784.4687487594352, "episode_len_mean": 120.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-758.1958160256859, -814.6505144404368, -550.202945075386, -711.9037625285532, -651.2176932449257, -924.0613606677422, -1116.3976631432336, -654.0189189977006, -501.74581124005044, -798.3699660057422, -1203.9385734942814, -1082.0907286407714, -394.41729969669444, -677.9611896108728, -540.2029569599493, -754.0495819975154, -684.376520070522, -1026.549368134969, -581.8008976875988, -876.150756472005, -1026.3913555404197, -941.0153748167279, -894.517853659287, -771.3302897777419, -1000.0613863105932, -842.1085515218751, -978.9860428100424, -813.4259322144324, -855.2558251874146, -809.3701680786904, -623.5688613804812, -691.690434146929, -1079.2199202035683, -981.7720482360744, -1082.7679266808696, -612.0075463253661, -727.6773331050063, -530.4021591506896, -704.1432740093248, -857.4587423458685, -999.4472655854777, -733.8772667141154, -773.7495603462278, -916.1381297648675, -972.3508070939575, -954.4290190514084, -995.778583007221, -728.3017600252008, -948.2494413130097, -850.4386558258736, -786.6237144016616, -491.99980470992875, -963.0005892533788, -602.4696272128233, -534.2964904864742, -765.2255988135338, -1152.6001370306305, -732.0769404936107, -791.9863848469458, -916.4358306943702, -735.9125920102998, -757.7772228364103, -569.7552278520072, -702.3207483109954, -647.6811417861289, -670.9380505027437, -1070.644233335096, -798.4568093521814, -626.3483127361287, -745.7895433704377, -563.0169346287039, -650.0012411979194, -766.1771461992677, -755.1716508967431, -617.1073540062661, -405.8218282116934, -605.5509802718186, -700.5695184825174, -757.3624230407881, -842.9979490441494, -586.975997972194, -559.4725684851281, -920.866738946617, -725.706960166542, -1142.077011550846, -886.0252132539247, -572.9000785535595, -837.0575487305188, -1019.7576467496582, -664.5709938593048, -936.9607098420689, -871.798614723867, -660.2346934523323, -1061.236532504413, -774.3954205921513, -653.4828762318899, -563.6321968465464, -772.215125564206, -597.1356022073888, -916.0224813313109], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 21.083612199888975, "mean_inference_ms": 0.4010701291948952, "mean_action_processing_ms": 0.09575078834498914, "mean_env_wait_ms": 2.7535262183017553, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0039348602294921875, "StateBufferConnector_ms": 0.0027320384979248047, "ViewRequirementAgentConnector_ms": 0.06828045845031738}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 252120, "num_agent_steps_trained": 252120, "num_env_steps_sampled": 252120, "num_env_steps_trained": 252120, "num_env_steps_sampled_this_iter": 480, "num_env_steps_trained_this_iter": 480, "num_env_steps_sampled_throughput_per_sec": 41.436156674915345, "num_env_steps_trained_throughput_per_sec": 41.436156674915345, "timesteps_total": 252120, "num_steps_trained_this_iter": 480, "agent_timesteps_total": 252120, "timers": {"training_iteration_time_ms": 2950.352, "sample_time_ms": 2946.576, "load_time_ms": 0.219, "load_throughput": 547738.035, "learn_time_ms": 2.803, "learn_throughput": 42812.49, "synch_weights_time_ms": 0.713}, "counters": {"num_env_steps_sampled": 252120, "num_env_steps_trained": 252120, "num_agent_steps_sampled": 252120, "num_agent_steps_trained": 252120}, "done": false, "episodes_total": 2101, "training_iteration": 526, "trial_id": "29a31_00000", "date": "2023-07-26_02-35-45", "timestamp": 1690328145, "time_this_iter_s": 11.586959838867188, "time_total_s": 6392.034921884537, "pid": 90822, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 1, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[253680, 5e-06], [256080, 5e-06], [258480, 2.5e-06], [260880, 2.5e-06], [263280, 2.5e-06], [265680, 2.5e-06], [268080, 1e-06], [270480, 1e-06], [272880, 1e-06], [275280, 5e-07], [277680, 5e-07], [280080, 5e-07], [282480, 5e-07], [284880, 5e-07], [287280, 1e-07], [289680, 1e-07], [292080, 1e-07]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 120, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x16ca65700>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 770.7094459533691, "iterations_since_restore": 66, "perf": {"cpu_util_percent": 35.911764705882355, "ram_util_percent": 73.98235294117647}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-07, "entropy_coeff": 0.05, "policy_entropy": 267.43035888671875, "policy_loss": -78893.5390625, "vf_loss": 2703687.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 267.0, "diff_num_grad_updates_vs_sampler_policy": 266.0}}, "num_env_steps_sampled": 252600, "num_env_steps_trained": 252600, "num_agent_steps_sampled": 252600, "num_agent_steps_trained": 252600}, "sampler_results": {"episode_reward_max": -394.41729969669444, "episode_reward_min": -1203.9385734942814, "episode_reward_mean": -780.2108805713411, "episode_len_mean": 120.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-651.2176932449257, -924.0613606677422, -1116.3976631432336, -654.0189189977006, -501.74581124005044, -798.3699660057422, -1203.9385734942814, -1082.0907286407714, -394.41729969669444, -677.9611896108728, -540.2029569599493, -754.0495819975154, -684.376520070522, -1026.549368134969, -581.8008976875988, -876.150756472005, -1026.3913555404197, -941.0153748167279, -894.517853659287, -771.3302897777419, -1000.0613863105932, -842.1085515218751, -978.9860428100424, -813.4259322144324, -855.2558251874146, -809.3701680786904, -623.5688613804812, -691.690434146929, -1079.2199202035683, -981.7720482360744, -1082.7679266808696, -612.0075463253661, -727.6773331050063, -530.4021591506896, -704.1432740093248, -857.4587423458685, -999.4472655854777, -733.8772667141154, -773.7495603462278, -916.1381297648675, -972.3508070939575, -954.4290190514084, -995.778583007221, -728.3017600252008, -948.2494413130097, -850.4386558258736, -786.6237144016616, -491.99980470992875, -963.0005892533788, -602.4696272128233, -534.2964904864742, -765.2255988135338, -1152.6001370306305, -732.0769404936107, -791.9863848469458, -916.4358306943702, -735.9125920102998, -757.7772228364103, -569.7552278520072, -702.3207483109954, -647.6811417861289, -670.9380505027437, -1070.644233335096, -798.4568093521814, -626.3483127361287, -745.7895433704377, -563.0169346287039, -650.0012411979194, -766.1771461992677, -755.1716508967431, -617.1073540062661, -405.8218282116934, -605.5509802718186, -700.5695184825174, -757.3624230407881, -842.9979490441494, -586.975997972194, -559.4725684851281, -920.866738946617, -725.706960166542, -1142.077011550846, -886.0252132539247, -572.9000785535595, -837.0575487305188, -1019.7576467496582, -664.5709938593048, -936.9607098420689, -871.798614723867, -660.2346934523323, -1061.236532504413, -774.3954205921513, -653.4828762318899, -563.6321968465464, -772.215125564206, -597.1356022073888, -916.0224813313109, -561.9032764442976, -664.1706291159477, -517.6571415124315, -665.43517218797], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 21.084890464767785, "mean_inference_ms": 0.40101998636240366, "mean_action_processing_ms": 0.09574404159373533, "mean_env_wait_ms": 2.751705791568712, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003941774368286133, "StateBufferConnector_ms": 0.0027322769165039062, "ViewRequirementAgentConnector_ms": 0.06818842887878418}}, "episode_reward_max": -394.41729969669444, "episode_reward_min": -1203.9385734942814, "episode_reward_mean": -780.2108805713411, "episode_len_mean": 120.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-651.2176932449257, -924.0613606677422, -1116.3976631432336, -654.0189189977006, -501.74581124005044, -798.3699660057422, -1203.9385734942814, -1082.0907286407714, -394.41729969669444, -677.9611896108728, -540.2029569599493, -754.0495819975154, -684.376520070522, -1026.549368134969, -581.8008976875988, -876.150756472005, -1026.3913555404197, -941.0153748167279, -894.517853659287, -771.3302897777419, -1000.0613863105932, -842.1085515218751, -978.9860428100424, -813.4259322144324, -855.2558251874146, -809.3701680786904, -623.5688613804812, -691.690434146929, -1079.2199202035683, -981.7720482360744, -1082.7679266808696, -612.0075463253661, -727.6773331050063, -530.4021591506896, -704.1432740093248, -857.4587423458685, -999.4472655854777, -733.8772667141154, -773.7495603462278, -916.1381297648675, -972.3508070939575, -954.4290190514084, -995.778583007221, -728.3017600252008, -948.2494413130097, -850.4386558258736, -786.6237144016616, -491.99980470992875, -963.0005892533788, -602.4696272128233, -534.2964904864742, -765.2255988135338, -1152.6001370306305, -732.0769404936107, -791.9863848469458, -916.4358306943702, -735.9125920102998, -757.7772228364103, -569.7552278520072, -702.3207483109954, -647.6811417861289, -670.9380505027437, -1070.644233335096, -798.4568093521814, -626.3483127361287, -745.7895433704377, -563.0169346287039, -650.0012411979194, -766.1771461992677, -755.1716508967431, -617.1073540062661, -405.8218282116934, -605.5509802718186, -700.5695184825174, -757.3624230407881, -842.9979490441494, -586.975997972194, -559.4725684851281, -920.866738946617, -725.706960166542, -1142.077011550846, -886.0252132539247, -572.9000785535595, -837.0575487305188, -1019.7576467496582, -664.5709938593048, -936.9607098420689, -871.798614723867, -660.2346934523323, -1061.236532504413, -774.3954205921513, -653.4828762318899, -563.6321968465464, -772.215125564206, -597.1356022073888, -916.0224813313109, -561.9032764442976, -664.1706291159477, -517.6571415124315, -665.43517218797], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 21.084890464767785, "mean_inference_ms": 0.40101998636240366, "mean_action_processing_ms": 0.09574404159373533, "mean_env_wait_ms": 2.751705791568712, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003941774368286133, "StateBufferConnector_ms": 0.0027322769165039062, "ViewRequirementAgentConnector_ms": 0.06818842887878418}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 252600, "num_agent_steps_trained": 252600, "num_env_steps_sampled": 252600, "num_env_steps_trained": 252600, "num_env_steps_sampled_this_iter": 480, "num_env_steps_trained_this_iter": 480, "num_env_steps_sampled_throughput_per_sec": 41.74597291660057, "num_env_steps_trained_throughput_per_sec": 41.74597291660057, "timesteps_total": 252600, "num_steps_trained_this_iter": 480, "agent_timesteps_total": 252600, "timers": {"training_iteration_time_ms": 2901.263, "sample_time_ms": 2897.487, "load_time_ms": 0.221, "load_throughput": 544008.301, "learn_time_ms": 2.801, "learn_throughput": 42836.174, "synch_weights_time_ms": 0.713}, "counters": {"num_env_steps_sampled": 252600, "num_env_steps_trained": 252600, "num_agent_steps_sampled": 252600, "num_agent_steps_trained": 252600}, "done": false, "episodes_total": 2105, "training_iteration": 527, "trial_id": "29a31_00000", "date": "2023-07-26_02-35-57", "timestamp": 1690328157, "time_this_iter_s": 11.500843048095703, "time_total_s": 6403.535764932632, "pid": 90822, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 1, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[253680, 5e-06], [256080, 5e-06], [258480, 2.5e-06], [260880, 2.5e-06], [263280, 2.5e-06], [265680, 2.5e-06], [268080, 1e-06], [270480, 1e-06], [272880, 1e-06], [275280, 5e-07], [277680, 5e-07], [280080, 5e-07], [282480, 5e-07], [284880, 5e-07], [287280, 1e-07], [289680, 1e-07], [292080, 1e-07]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 120, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x16ca65700>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 782.2102890014648, "iterations_since_restore": 67, "perf": {"cpu_util_percent": 31.324999999999996, "ram_util_percent": 72.83125000000001}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-07, "entropy_coeff": 0.05, "policy_entropy": 267.4509582519531, "policy_loss": -97300.3359375, "vf_loss": 4328319.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 271.0, "diff_num_grad_updates_vs_sampler_policy": 270.0}}, "num_env_steps_sampled": 253080, "num_env_steps_trained": 253080, "num_agent_steps_sampled": 253080, "num_agent_steps_trained": 253080}, "sampler_results": {"episode_reward_max": -394.41729969669444, "episode_reward_min": -1203.9385734942814, "episode_reward_mean": -782.6345429520504, "episode_len_mean": 120.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-501.74581124005044, -798.3699660057422, -1203.9385734942814, -1082.0907286407714, -394.41729969669444, -677.9611896108728, -540.2029569599493, -754.0495819975154, -684.376520070522, -1026.549368134969, -581.8008976875988, -876.150756472005, -1026.3913555404197, -941.0153748167279, -894.517853659287, -771.3302897777419, -1000.0613863105932, -842.1085515218751, -978.9860428100424, -813.4259322144324, -855.2558251874146, -809.3701680786904, -623.5688613804812, -691.690434146929, -1079.2199202035683, -981.7720482360744, -1082.7679266808696, -612.0075463253661, -727.6773331050063, -530.4021591506896, -704.1432740093248, -857.4587423458685, -999.4472655854777, -733.8772667141154, -773.7495603462278, -916.1381297648675, -972.3508070939575, -954.4290190514084, -995.778583007221, -728.3017600252008, -948.2494413130097, -850.4386558258736, -786.6237144016616, -491.99980470992875, -963.0005892533788, -602.4696272128233, -534.2964904864742, -765.2255988135338, -1152.6001370306305, -732.0769404936107, -791.9863848469458, -916.4358306943702, -735.9125920102998, -757.7772228364103, -569.7552278520072, -702.3207483109954, -647.6811417861289, -670.9380505027437, -1070.644233335096, -798.4568093521814, -626.3483127361287, -745.7895433704377, -563.0169346287039, -650.0012411979194, -766.1771461992677, -755.1716508967431, -617.1073540062661, -405.8218282116934, -605.5509802718186, -700.5695184825174, -757.3624230407881, -842.9979490441494, -586.975997972194, -559.4725684851281, -920.866738946617, -725.706960166542, -1142.077011550846, -886.0252132539247, -572.9000785535595, -837.0575487305188, -1019.7576467496582, -664.5709938593048, -936.9607098420689, -871.798614723867, -660.2346934523323, -1061.236532504413, -774.3954205921513, -653.4828762318899, -563.6321968465464, -772.215125564206, -597.1356022073888, -916.0224813313109, -561.9032764442976, -664.1706291159477, -517.6571415124315, -665.43517218797, -847.0364730522632, -1009.3836856419699, -1007.4155842446473, -724.2261311856754], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 21.0860269797348, "mean_inference_ms": 0.40097882183056455, "mean_action_processing_ms": 0.09573968499000152, "mean_env_wait_ms": 2.749896846897709, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003949642181396484, "StateBufferConnector_ms": 0.0027396678924560547, "ViewRequirementAgentConnector_ms": 0.06829833984375}}, "episode_reward_max": -394.41729969669444, "episode_reward_min": -1203.9385734942814, "episode_reward_mean": -782.6345429520504, "episode_len_mean": 120.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-501.74581124005044, -798.3699660057422, -1203.9385734942814, -1082.0907286407714, -394.41729969669444, -677.9611896108728, -540.2029569599493, -754.0495819975154, -684.376520070522, -1026.549368134969, -581.8008976875988, -876.150756472005, -1026.3913555404197, -941.0153748167279, -894.517853659287, -771.3302897777419, -1000.0613863105932, -842.1085515218751, -978.9860428100424, -813.4259322144324, -855.2558251874146, -809.3701680786904, -623.5688613804812, -691.690434146929, -1079.2199202035683, -981.7720482360744, -1082.7679266808696, -612.0075463253661, -727.6773331050063, -530.4021591506896, -704.1432740093248, -857.4587423458685, -999.4472655854777, -733.8772667141154, -773.7495603462278, -916.1381297648675, -972.3508070939575, -954.4290190514084, -995.778583007221, -728.3017600252008, -948.2494413130097, -850.4386558258736, -786.6237144016616, -491.99980470992875, -963.0005892533788, -602.4696272128233, -534.2964904864742, -765.2255988135338, -1152.6001370306305, -732.0769404936107, -791.9863848469458, -916.4358306943702, -735.9125920102998, -757.7772228364103, -569.7552278520072, -702.3207483109954, -647.6811417861289, -670.9380505027437, -1070.644233335096, -798.4568093521814, -626.3483127361287, -745.7895433704377, -563.0169346287039, -650.0012411979194, -766.1771461992677, -755.1716508967431, -617.1073540062661, -405.8218282116934, -605.5509802718186, -700.5695184825174, -757.3624230407881, -842.9979490441494, -586.975997972194, -559.4725684851281, -920.866738946617, -725.706960166542, -1142.077011550846, -886.0252132539247, -572.9000785535595, -837.0575487305188, -1019.7576467496582, -664.5709938593048, -936.9607098420689, -871.798614723867, -660.2346934523323, -1061.236532504413, -774.3954205921513, -653.4828762318899, -563.6321968465464, -772.215125564206, -597.1356022073888, -916.0224813313109, -561.9032764442976, -664.1706291159477, -517.6571415124315, -665.43517218797, -847.0364730522632, -1009.3836856419699, -1007.4155842446473, -724.2261311856754], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 21.0860269797348, "mean_inference_ms": 0.40097882183056455, "mean_action_processing_ms": 0.09573968499000152, "mean_env_wait_ms": 2.749896846897709, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003949642181396484, "StateBufferConnector_ms": 0.0027396678924560547, "ViewRequirementAgentConnector_ms": 0.06829833984375}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 253080, "num_agent_steps_trained": 253080, "num_env_steps_sampled": 253080, "num_env_steps_trained": 253080, "num_env_steps_sampled_this_iter": 480, "num_env_steps_trained_this_iter": 480, "num_env_steps_sampled_throughput_per_sec": 41.038597196160026, "num_env_steps_trained_throughput_per_sec": 41.038597196160026, "timesteps_total": 253080, "num_steps_trained_this_iter": 480, "agent_timesteps_total": 253080, "timers": {"training_iteration_time_ms": 2888.275, "sample_time_ms": 2884.48, "load_time_ms": 0.219, "load_throughput": 548095.916, "learn_time_ms": 2.812, "learn_throughput": 42668.041, "synch_weights_time_ms": 0.722}, "counters": {"num_env_steps_sampled": 253080, "num_env_steps_trained": 253080, "num_agent_steps_sampled": 253080, "num_agent_steps_trained": 253080}, "done": false, "episodes_total": 2109, "training_iteration": 528, "trial_id": "29a31_00000", "date": "2023-07-26_02-36-08", "timestamp": 1690328168, "time_this_iter_s": 11.699063062667847, "time_total_s": 6415.2348279953, "pid": 90822, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 1, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[253680, 5e-06], [256080, 5e-06], [258480, 2.5e-06], [260880, 2.5e-06], [263280, 2.5e-06], [265680, 2.5e-06], [268080, 1e-06], [270480, 1e-06], [272880, 1e-06], [275280, 5e-07], [277680, 5e-07], [280080, 5e-07], [282480, 5e-07], [284880, 5e-07], [287280, 1e-07], [289680, 1e-07], [292080, 1e-07]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 120, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x16ca65700>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 793.9093520641327, "iterations_since_restore": 68, "perf": {"cpu_util_percent": 35.699999999999996, "ram_util_percent": 73.04117647058824}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-07, "entropy_coeff": 0.05, "policy_entropy": 267.46295166015625, "policy_loss": -99094.5859375, "vf_loss": 4221810.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 275.0, "diff_num_grad_updates_vs_sampler_policy": 274.0}}, "num_env_steps_sampled": 253560, "num_env_steps_trained": 253560, "num_agent_steps_sampled": 253560, "num_agent_steps_trained": 253560}, "sampler_results": {"episode_reward_max": -394.41729969669444, "episode_reward_min": -1152.6001370306305, "episode_reward_mean": -778.3904096402482, "episode_len_mean": 120.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-394.41729969669444, -677.9611896108728, -540.2029569599493, -754.0495819975154, -684.376520070522, -1026.549368134969, -581.8008976875988, -876.150756472005, -1026.3913555404197, -941.0153748167279, -894.517853659287, -771.3302897777419, -1000.0613863105932, -842.1085515218751, -978.9860428100424, -813.4259322144324, -855.2558251874146, -809.3701680786904, -623.5688613804812, -691.690434146929, -1079.2199202035683, -981.7720482360744, -1082.7679266808696, -612.0075463253661, -727.6773331050063, -530.4021591506896, -704.1432740093248, -857.4587423458685, -999.4472655854777, -733.8772667141154, -773.7495603462278, -916.1381297648675, -972.3508070939575, -954.4290190514084, -995.778583007221, -728.3017600252008, -948.2494413130097, -850.4386558258736, -786.6237144016616, -491.99980470992875, -963.0005892533788, -602.4696272128233, -534.2964904864742, -765.2255988135338, -1152.6001370306305, -732.0769404936107, -791.9863848469458, -916.4358306943702, -735.9125920102998, -757.7772228364103, -569.7552278520072, -702.3207483109954, -647.6811417861289, -670.9380505027437, -1070.644233335096, -798.4568093521814, -626.3483127361287, -745.7895433704377, -563.0169346287039, -650.0012411979194, -766.1771461992677, -755.1716508967431, -617.1073540062661, -405.8218282116934, -605.5509802718186, -700.5695184825174, -757.3624230407881, -842.9979490441494, -586.975997972194, -559.4725684851281, -920.866738946617, -725.706960166542, -1142.077011550846, -886.0252132539247, -572.9000785535595, -837.0575487305188, -1019.7576467496582, -664.5709938593048, -936.9607098420689, -871.798614723867, -660.2346934523323, -1061.236532504413, -774.3954205921513, -653.4828762318899, -563.6321968465464, -772.215125564206, -597.1356022073888, -916.0224813313109, -561.9032764442976, -664.1706291159477, -517.6571415124315, -665.43517218797, -847.0364730522632, -1009.3836856419699, -1007.4155842446473, -724.2261311856754, -851.6414341486135, -909.5470207696831, -602.1261372289888, -798.4171560533446], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 21.087011825792224, "mean_inference_ms": 0.4009306681187518, "mean_action_processing_ms": 0.09573377412220023, "mean_env_wait_ms": 2.7481999582785237, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003941535949707031, "StateBufferConnector_ms": 0.0027205944061279297, "ViewRequirementAgentConnector_ms": 0.06819009780883789}}, "episode_reward_max": -394.41729969669444, "episode_reward_min": -1152.6001370306305, "episode_reward_mean": -778.3904096402482, "episode_len_mean": 120.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-394.41729969669444, -677.9611896108728, -540.2029569599493, -754.0495819975154, -684.376520070522, -1026.549368134969, -581.8008976875988, -876.150756472005, -1026.3913555404197, -941.0153748167279, -894.517853659287, -771.3302897777419, -1000.0613863105932, -842.1085515218751, -978.9860428100424, -813.4259322144324, -855.2558251874146, -809.3701680786904, -623.5688613804812, -691.690434146929, -1079.2199202035683, -981.7720482360744, -1082.7679266808696, -612.0075463253661, -727.6773331050063, -530.4021591506896, -704.1432740093248, -857.4587423458685, -999.4472655854777, -733.8772667141154, -773.7495603462278, -916.1381297648675, -972.3508070939575, -954.4290190514084, -995.778583007221, -728.3017600252008, -948.2494413130097, -850.4386558258736, -786.6237144016616, -491.99980470992875, -963.0005892533788, -602.4696272128233, -534.2964904864742, -765.2255988135338, -1152.6001370306305, -732.0769404936107, -791.9863848469458, -916.4358306943702, -735.9125920102998, -757.7772228364103, -569.7552278520072, -702.3207483109954, -647.6811417861289, -670.9380505027437, -1070.644233335096, -798.4568093521814, -626.3483127361287, -745.7895433704377, -563.0169346287039, -650.0012411979194, -766.1771461992677, -755.1716508967431, -617.1073540062661, -405.8218282116934, -605.5509802718186, -700.5695184825174, -757.3624230407881, -842.9979490441494, -586.975997972194, -559.4725684851281, -920.866738946617, -725.706960166542, -1142.077011550846, -886.0252132539247, -572.9000785535595, -837.0575487305188, -1019.7576467496582, -664.5709938593048, -936.9607098420689, -871.798614723867, -660.2346934523323, -1061.236532504413, -774.3954205921513, -653.4828762318899, -563.6321968465464, -772.215125564206, -597.1356022073888, -916.0224813313109, -561.9032764442976, -664.1706291159477, -517.6571415124315, -665.43517218797, -847.0364730522632, -1009.3836856419699, -1007.4155842446473, -724.2261311856754, -851.6414341486135, -909.5470207696831, -602.1261372289888, -798.4171560533446], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 21.087011825792224, "mean_inference_ms": 0.4009306681187518, "mean_action_processing_ms": 0.09573377412220023, "mean_env_wait_ms": 2.7481999582785237, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003941535949707031, "StateBufferConnector_ms": 0.0027205944061279297, "ViewRequirementAgentConnector_ms": 0.06819009780883789}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 253560, "num_agent_steps_trained": 253560, "num_env_steps_sampled": 253560, "num_env_steps_trained": 253560, "num_env_steps_sampled_this_iter": 480, "num_env_steps_trained_this_iter": 480, "num_env_steps_sampled_throughput_per_sec": 40.493983877558186, "num_env_steps_trained_throughput_per_sec": 40.493983877558186, "timesteps_total": 253560, "num_steps_trained_this_iter": 480, "agent_timesteps_total": 253560, "timers": {"training_iteration_time_ms": 2930.721, "sample_time_ms": 2926.912, "load_time_ms": 0.219, "load_throughput": 546964.225, "learn_time_ms": 2.823, "learn_throughput": 42509.12, "synch_weights_time_ms": 0.726}, "counters": {"num_env_steps_sampled": 253560, "num_env_steps_trained": 253560, "num_agent_steps_sampled": 253560, "num_agent_steps_trained": 253560}, "done": false, "episodes_total": 2113, "training_iteration": 529, "trial_id": "29a31_00000", "date": "2023-07-26_02-36-20", "timestamp": 1690328180, "time_this_iter_s": 11.856347799301147, "time_total_s": 6427.091175794601, "pid": 90822, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 1, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[253680, 5e-06], [256080, 5e-06], [258480, 2.5e-06], [260880, 2.5e-06], [263280, 2.5e-06], [265680, 2.5e-06], [268080, 1e-06], [270480, 1e-06], [272880, 1e-06], [275280, 5e-07], [277680, 5e-07], [280080, 5e-07], [282480, 5e-07], [284880, 5e-07], [287280, 1e-07], [289680, 1e-07], [292080, 1e-07]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 120, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x16ca65700>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 805.7656998634338, "iterations_since_restore": 69, "perf": {"cpu_util_percent": 37.311764705882354, "ram_util_percent": 73.44117647058823}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 5e-06, "entropy_coeff": 0.05, "policy_entropy": 267.34124755859375, "policy_loss": -119929.8046875, "vf_loss": 6879919.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 279.0, "diff_num_grad_updates_vs_sampler_policy": 278.0}}, "num_env_steps_sampled": 254040, "num_env_steps_trained": 254040, "num_agent_steps_sampled": 254040, "num_agent_steps_trained": 254040}, "sampler_results": {"episode_reward_max": -405.8218282116934, "episode_reward_min": -1152.6001370306305, "episode_reward_mean": -784.9810147015309, "episode_len_mean": 120.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-684.376520070522, -1026.549368134969, -581.8008976875988, -876.150756472005, -1026.3913555404197, -941.0153748167279, -894.517853659287, -771.3302897777419, -1000.0613863105932, -842.1085515218751, -978.9860428100424, -813.4259322144324, -855.2558251874146, -809.3701680786904, -623.5688613804812, -691.690434146929, -1079.2199202035683, -981.7720482360744, -1082.7679266808696, -612.0075463253661, -727.6773331050063, -530.4021591506896, -704.1432740093248, -857.4587423458685, -999.4472655854777, -733.8772667141154, -773.7495603462278, -916.1381297648675, -972.3508070939575, -954.4290190514084, -995.778583007221, -728.3017600252008, -948.2494413130097, -850.4386558258736, -786.6237144016616, -491.99980470992875, -963.0005892533788, -602.4696272128233, -534.2964904864742, -765.2255988135338, -1152.6001370306305, -732.0769404936107, -791.9863848469458, -916.4358306943702, -735.9125920102998, -757.7772228364103, -569.7552278520072, -702.3207483109954, -647.6811417861289, -670.9380505027437, -1070.644233335096, -798.4568093521814, -626.3483127361287, -745.7895433704377, -563.0169346287039, -650.0012411979194, -766.1771461992677, -755.1716508967431, -617.1073540062661, -405.8218282116934, -605.5509802718186, -700.5695184825174, -757.3624230407881, -842.9979490441494, -586.975997972194, -559.4725684851281, -920.866738946617, -725.706960166542, -1142.077011550846, -886.0252132539247, -572.9000785535595, -837.0575487305188, -1019.7576467496582, -664.5709938593048, -936.9607098420689, -871.798614723867, -660.2346934523323, -1061.236532504413, -774.3954205921513, -653.4828762318899, -563.6321968465464, -772.215125564206, -597.1356022073888, -916.0224813313109, -561.9032764442976, -664.1706291159477, -517.6571415124315, -665.43517218797, -847.0364730522632, -1009.3836856419699, -1007.4155842446473, -724.2261311856754, -851.6414341486135, -909.5470207696831, -602.1261372289888, -798.4171560533446, -469.77912058090806, -783.9063774070419, -853.6153943966289, -918.3906420086815], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 21.088685686360385, "mean_inference_ms": 0.4008858012429204, "mean_action_processing_ms": 0.0957283738906327, "mean_env_wait_ms": 2.7466838293175417, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003939390182495117, "StateBufferConnector_ms": 0.0027267932891845703, "ViewRequirementAgentConnector_ms": 0.0681760311126709}}, "episode_reward_max": -405.8218282116934, "episode_reward_min": -1152.6001370306305, "episode_reward_mean": -784.9810147015309, "episode_len_mean": 120.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-684.376520070522, -1026.549368134969, -581.8008976875988, -876.150756472005, -1026.3913555404197, -941.0153748167279, -894.517853659287, -771.3302897777419, -1000.0613863105932, -842.1085515218751, -978.9860428100424, -813.4259322144324, -855.2558251874146, -809.3701680786904, -623.5688613804812, -691.690434146929, -1079.2199202035683, -981.7720482360744, -1082.7679266808696, -612.0075463253661, -727.6773331050063, -530.4021591506896, -704.1432740093248, -857.4587423458685, -999.4472655854777, -733.8772667141154, -773.7495603462278, -916.1381297648675, -972.3508070939575, -954.4290190514084, -995.778583007221, -728.3017600252008, -948.2494413130097, -850.4386558258736, -786.6237144016616, -491.99980470992875, -963.0005892533788, -602.4696272128233, -534.2964904864742, -765.2255988135338, -1152.6001370306305, -732.0769404936107, -791.9863848469458, -916.4358306943702, -735.9125920102998, -757.7772228364103, -569.7552278520072, -702.3207483109954, -647.6811417861289, -670.9380505027437, -1070.644233335096, -798.4568093521814, -626.3483127361287, -745.7895433704377, -563.0169346287039, -650.0012411979194, -766.1771461992677, -755.1716508967431, -617.1073540062661, -405.8218282116934, -605.5509802718186, -700.5695184825174, -757.3624230407881, -842.9979490441494, -586.975997972194, -559.4725684851281, -920.866738946617, -725.706960166542, -1142.077011550846, -886.0252132539247, -572.9000785535595, -837.0575487305188, -1019.7576467496582, -664.5709938593048, -936.9607098420689, -871.798614723867, -660.2346934523323, -1061.236532504413, -774.3954205921513, -653.4828762318899, -563.6321968465464, -772.215125564206, -597.1356022073888, -916.0224813313109, -561.9032764442976, -664.1706291159477, -517.6571415124315, -665.43517218797, -847.0364730522632, -1009.3836856419699, -1007.4155842446473, -724.2261311856754, -851.6414341486135, -909.5470207696831, -602.1261372289888, -798.4171560533446, -469.77912058090806, -783.9063774070419, -853.6153943966289, -918.3906420086815], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 21.088685686360385, "mean_inference_ms": 0.4008858012429204, "mean_action_processing_ms": 0.0957283738906327, "mean_env_wait_ms": 2.7466838293175417, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003939390182495117, "StateBufferConnector_ms": 0.0027267932891845703, "ViewRequirementAgentConnector_ms": 0.0681760311126709}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 254040, "num_agent_steps_trained": 254040, "num_env_steps_sampled": 254040, "num_env_steps_trained": 254040, "num_env_steps_sampled_this_iter": 480, "num_env_steps_trained_this_iter": 480, "num_env_steps_sampled_throughput_per_sec": 40.12926014348352, "num_env_steps_trained_throughput_per_sec": 40.12926014348352, "timesteps_total": 254040, "num_steps_trained_this_iter": 480, "agent_timesteps_total": 254040, "timers": {"training_iteration_time_ms": 2970.22, "sample_time_ms": 2966.423, "load_time_ms": 0.216, "load_throughput": 555291.792, "learn_time_ms": 2.806, "learn_throughput": 42769.925, "synch_weights_time_ms": 0.735}, "counters": {"num_env_steps_sampled": 254040, "num_env_steps_trained": 254040, "num_agent_steps_sampled": 254040, "num_agent_steps_trained": 254040}, "done": false, "episodes_total": 2117, "training_iteration": 530, "trial_id": "29a31_00000", "date": "2023-07-26_02-36-32", "timestamp": 1690328192, "time_this_iter_s": 11.96421504020691, "time_total_s": 6439.055390834808, "pid": 90822, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 1, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[253680, 5e-06], [256080, 5e-06], [258480, 2.5e-06], [260880, 2.5e-06], [263280, 2.5e-06], [265680, 2.5e-06], [268080, 1e-06], [270480, 1e-06], [272880, 1e-06], [275280, 5e-07], [277680, 5e-07], [280080, 5e-07], [282480, 5e-07], [284880, 5e-07], [287280, 1e-07], [289680, 1e-07], [292080, 1e-07]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 120, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x16ca65700>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 817.7299149036407, "iterations_since_restore": 70, "perf": {"cpu_util_percent": 36.7, "ram_util_percent": 74.39375}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 5e-06, "entropy_coeff": 0.05, "policy_entropy": 267.3006286621094, "policy_loss": -123662.5859375, "vf_loss": 7467177.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 283.0, "diff_num_grad_updates_vs_sampler_policy": 282.0}}, "num_env_steps_sampled": 254520, "num_env_steps_trained": 254520, "num_agent_steps_sampled": 254520, "num_agent_steps_trained": 254520}, "sampler_results": {"episode_reward_max": -405.8218282116934, "episode_reward_min": -1152.6001370306305, "episode_reward_mean": -789.2704336160855, "episode_len_mean": 120.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1026.3913555404197, -941.0153748167279, -894.517853659287, -771.3302897777419, -1000.0613863105932, -842.1085515218751, -978.9860428100424, -813.4259322144324, -855.2558251874146, -809.3701680786904, -623.5688613804812, -691.690434146929, -1079.2199202035683, -981.7720482360744, -1082.7679266808696, -612.0075463253661, -727.6773331050063, -530.4021591506896, -704.1432740093248, -857.4587423458685, -999.4472655854777, -733.8772667141154, -773.7495603462278, -916.1381297648675, -972.3508070939575, -954.4290190514084, -995.778583007221, -728.3017600252008, -948.2494413130097, -850.4386558258736, -786.6237144016616, -491.99980470992875, -963.0005892533788, -602.4696272128233, -534.2964904864742, -765.2255988135338, -1152.6001370306305, -732.0769404936107, -791.9863848469458, -916.4358306943702, -735.9125920102998, -757.7772228364103, -569.7552278520072, -702.3207483109954, -647.6811417861289, -670.9380505027437, -1070.644233335096, -798.4568093521814, -626.3483127361287, -745.7895433704377, -563.0169346287039, -650.0012411979194, -766.1771461992677, -755.1716508967431, -617.1073540062661, -405.8218282116934, -605.5509802718186, -700.5695184825174, -757.3624230407881, -842.9979490441494, -586.975997972194, -559.4725684851281, -920.866738946617, -725.706960166542, -1142.077011550846, -886.0252132539247, -572.9000785535595, -837.0575487305188, -1019.7576467496582, -664.5709938593048, -936.9607098420689, -871.798614723867, -660.2346934523323, -1061.236532504413, -774.3954205921513, -653.4828762318899, -563.6321968465464, -772.215125564206, -597.1356022073888, -916.0224813313109, -561.9032764442976, -664.1706291159477, -517.6571415124315, -665.43517218797, -847.0364730522632, -1009.3836856419699, -1007.4155842446473, -724.2261311856754, -851.6414341486135, -909.5470207696831, -602.1261372289888, -798.4171560533446, -469.77912058090806, -783.9063774070419, -853.6153943966289, -918.3906420086815, -744.0703634619459, -929.5034414758214, -869.8693057377583, -1054.3763231450537], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 21.090604613399652, "mean_inference_ms": 0.40085467452126294, "mean_action_processing_ms": 0.09572467527018738, "mean_env_wait_ms": 2.7452973601901944, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003968477249145508, "StateBufferConnector_ms": 0.0027437210083007812, "ViewRequirementAgentConnector_ms": 0.06856584548950195}}, "episode_reward_max": -405.8218282116934, "episode_reward_min": -1152.6001370306305, "episode_reward_mean": -789.2704336160855, "episode_len_mean": 120.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1026.3913555404197, -941.0153748167279, -894.517853659287, -771.3302897777419, -1000.0613863105932, -842.1085515218751, -978.9860428100424, -813.4259322144324, -855.2558251874146, -809.3701680786904, -623.5688613804812, -691.690434146929, -1079.2199202035683, -981.7720482360744, -1082.7679266808696, -612.0075463253661, -727.6773331050063, -530.4021591506896, -704.1432740093248, -857.4587423458685, -999.4472655854777, -733.8772667141154, -773.7495603462278, -916.1381297648675, -972.3508070939575, -954.4290190514084, -995.778583007221, -728.3017600252008, -948.2494413130097, -850.4386558258736, -786.6237144016616, -491.99980470992875, -963.0005892533788, -602.4696272128233, -534.2964904864742, -765.2255988135338, -1152.6001370306305, -732.0769404936107, -791.9863848469458, -916.4358306943702, -735.9125920102998, -757.7772228364103, -569.7552278520072, -702.3207483109954, -647.6811417861289, -670.9380505027437, -1070.644233335096, -798.4568093521814, -626.3483127361287, -745.7895433704377, -563.0169346287039, -650.0012411979194, -766.1771461992677, -755.1716508967431, -617.1073540062661, -405.8218282116934, -605.5509802718186, -700.5695184825174, -757.3624230407881, -842.9979490441494, -586.975997972194, -559.4725684851281, -920.866738946617, -725.706960166542, -1142.077011550846, -886.0252132539247, -572.9000785535595, -837.0575487305188, -1019.7576467496582, -664.5709938593048, -936.9607098420689, -871.798614723867, -660.2346934523323, -1061.236532504413, -774.3954205921513, -653.4828762318899, -563.6321968465464, -772.215125564206, -597.1356022073888, -916.0224813313109, -561.9032764442976, -664.1706291159477, -517.6571415124315, -665.43517218797, -847.0364730522632, -1009.3836856419699, -1007.4155842446473, -724.2261311856754, -851.6414341486135, -909.5470207696831, -602.1261372289888, -798.4171560533446, -469.77912058090806, -783.9063774070419, -853.6153943966289, -918.3906420086815, -744.0703634619459, -929.5034414758214, -869.8693057377583, -1054.3763231450537], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 21.090604613399652, "mean_inference_ms": 0.40085467452126294, "mean_action_processing_ms": 0.09572467527018738, "mean_env_wait_ms": 2.7452973601901944, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003968477249145508, "StateBufferConnector_ms": 0.0027437210083007812, "ViewRequirementAgentConnector_ms": 0.06856584548950195}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 254520, "num_agent_steps_trained": 254520, "num_env_steps_sampled": 254520, "num_env_steps_trained": 254520, "num_env_steps_sampled_this_iter": 480, "num_env_steps_trained_this_iter": 480, "num_env_steps_sampled_throughput_per_sec": 40.180373073285764, "num_env_steps_trained_throughput_per_sec": 40.180373073285764, "timesteps_total": 254520, "num_steps_trained_this_iter": 480, "agent_timesteps_total": 254520, "timers": {"training_iteration_time_ms": 2995.477, "sample_time_ms": 2991.476, "load_time_ms": 0.23, "load_throughput": 521787.767, "learn_time_ms": 2.938, "learn_throughput": 40839.688, "synch_weights_time_ms": 0.783}, "counters": {"num_env_steps_sampled": 254520, "num_env_steps_trained": 254520, "num_agent_steps_sampled": 254520, "num_agent_steps_trained": 254520}, "done": false, "episodes_total": 2121, "training_iteration": 531, "trial_id": "29a31_00000", "date": "2023-07-26_02-36-44", "timestamp": 1690328204, "time_this_iter_s": 11.949109077453613, "time_total_s": 6451.004499912262, "pid": 90822, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 1, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[253680, 5e-06], [256080, 5e-06], [258480, 2.5e-06], [260880, 2.5e-06], [263280, 2.5e-06], [265680, 2.5e-06], [268080, 1e-06], [270480, 1e-06], [272880, 1e-06], [275280, 5e-07], [277680, 5e-07], [280080, 5e-07], [282480, 5e-07], [284880, 5e-07], [287280, 1e-07], [289680, 1e-07], [292080, 1e-07]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 120, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x16ca65700>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 829.6790239810944, "iterations_since_restore": 71, "perf": {"cpu_util_percent": 45.59411764705882, "ram_util_percent": 77.11764705882354}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 5e-06, "entropy_coeff": 0.05, "policy_entropy": 267.1937561035156, "policy_loss": -71533.7109375, "vf_loss": 2724011.25}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 287.0, "diff_num_grad_updates_vs_sampler_policy": 286.0}}, "num_env_steps_sampled": 255000, "num_env_steps_trained": 255000, "num_agent_steps_sampled": 255000, "num_agent_steps_trained": 255000}, "sampler_results": {"episode_reward_max": -396.6681276166806, "episode_reward_min": -1152.6001370306305, "episode_reward_mean": -778.81526342636, "episode_len_mean": 120.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1000.0613863105932, -842.1085515218751, -978.9860428100424, -813.4259322144324, -855.2558251874146, -809.3701680786904, -623.5688613804812, -691.690434146929, -1079.2199202035683, -981.7720482360744, -1082.7679266808696, -612.0075463253661, -727.6773331050063, -530.4021591506896, -704.1432740093248, -857.4587423458685, -999.4472655854777, -733.8772667141154, -773.7495603462278, -916.1381297648675, -972.3508070939575, -954.4290190514084, -995.778583007221, -728.3017600252008, -948.2494413130097, -850.4386558258736, -786.6237144016616, -491.99980470992875, -963.0005892533788, -602.4696272128233, -534.2964904864742, -765.2255988135338, -1152.6001370306305, -732.0769404936107, -791.9863848469458, -916.4358306943702, -735.9125920102998, -757.7772228364103, -569.7552278520072, -702.3207483109954, -647.6811417861289, -670.9380505027437, -1070.644233335096, -798.4568093521814, -626.3483127361287, -745.7895433704377, -563.0169346287039, -650.0012411979194, -766.1771461992677, -755.1716508967431, -617.1073540062661, -405.8218282116934, -605.5509802718186, -700.5695184825174, -757.3624230407881, -842.9979490441494, -586.975997972194, -559.4725684851281, -920.866738946617, -725.706960166542, -1142.077011550846, -886.0252132539247, -572.9000785535595, -837.0575487305188, -1019.7576467496582, -664.5709938593048, -936.9607098420689, -871.798614723867, -660.2346934523323, -1061.236532504413, -774.3954205921513, -653.4828762318899, -563.6321968465464, -772.215125564206, -597.1356022073888, -916.0224813313109, -561.9032764442976, -664.1706291159477, -517.6571415124315, -665.43517218797, -847.0364730522632, -1009.3836856419699, -1007.4155842446473, -724.2261311856754, -851.6414341486135, -909.5470207696831, -602.1261372289888, -798.4171560533446, -469.77912058090806, -783.9063774070419, -853.6153943966289, -918.3906420086815, -744.0703634619459, -929.5034414758214, -869.8693057377583, -1054.3763231450537, -855.9006586799028, -396.6681276166806, -847.4771024005569, -487.6919661244689], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 21.0923688461291, "mean_inference_ms": 0.40082450643353335, "mean_action_processing_ms": 0.09572072907055118, "mean_env_wait_ms": 2.7439235650912344, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003963947296142578, "StateBufferConnector_ms": 0.002741575241088867, "ViewRequirementAgentConnector_ms": 0.06858539581298828}}, "episode_reward_max": -396.6681276166806, "episode_reward_min": -1152.6001370306305, "episode_reward_mean": -778.81526342636, "episode_len_mean": 120.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1000.0613863105932, -842.1085515218751, -978.9860428100424, -813.4259322144324, -855.2558251874146, -809.3701680786904, -623.5688613804812, -691.690434146929, -1079.2199202035683, -981.7720482360744, -1082.7679266808696, -612.0075463253661, -727.6773331050063, -530.4021591506896, -704.1432740093248, -857.4587423458685, -999.4472655854777, -733.8772667141154, -773.7495603462278, -916.1381297648675, -972.3508070939575, -954.4290190514084, -995.778583007221, -728.3017600252008, -948.2494413130097, -850.4386558258736, -786.6237144016616, -491.99980470992875, -963.0005892533788, -602.4696272128233, -534.2964904864742, -765.2255988135338, -1152.6001370306305, -732.0769404936107, -791.9863848469458, -916.4358306943702, -735.9125920102998, -757.7772228364103, -569.7552278520072, -702.3207483109954, -647.6811417861289, -670.9380505027437, -1070.644233335096, -798.4568093521814, -626.3483127361287, -745.7895433704377, -563.0169346287039, -650.0012411979194, -766.1771461992677, -755.1716508967431, -617.1073540062661, -405.8218282116934, -605.5509802718186, -700.5695184825174, -757.3624230407881, -842.9979490441494, -586.975997972194, -559.4725684851281, -920.866738946617, -725.706960166542, -1142.077011550846, -886.0252132539247, -572.9000785535595, -837.0575487305188, -1019.7576467496582, -664.5709938593048, -936.9607098420689, -871.798614723867, -660.2346934523323, -1061.236532504413, -774.3954205921513, -653.4828762318899, -563.6321968465464, -772.215125564206, -597.1356022073888, -916.0224813313109, -561.9032764442976, -664.1706291159477, -517.6571415124315, -665.43517218797, -847.0364730522632, -1009.3836856419699, -1007.4155842446473, -724.2261311856754, -851.6414341486135, -909.5470207696831, -602.1261372289888, -798.4171560533446, -469.77912058090806, -783.9063774070419, -853.6153943966289, -918.3906420086815, -744.0703634619459, -929.5034414758214, -869.8693057377583, -1054.3763231450537, -855.9006586799028, -396.6681276166806, -847.4771024005569, -487.6919661244689], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 21.0923688461291, "mean_inference_ms": 0.40082450643353335, "mean_action_processing_ms": 0.09572072907055118, "mean_env_wait_ms": 2.7439235650912344, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003963947296142578, "StateBufferConnector_ms": 0.002741575241088867, "ViewRequirementAgentConnector_ms": 0.06858539581298828}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 255000, "num_agent_steps_trained": 255000, "num_env_steps_sampled": 255000, "num_env_steps_trained": 255000, "num_env_steps_sampled_this_iter": 480, "num_env_steps_trained_this_iter": 480, "num_env_steps_sampled_throughput_per_sec": 41.93719063559781, "num_env_steps_trained_throughput_per_sec": 41.93719063559781, "timesteps_total": 255000, "num_steps_trained_this_iter": 480, "agent_timesteps_total": 255000, "timers": {"training_iteration_time_ms": 2937.803, "sample_time_ms": 2933.806, "load_time_ms": 0.231, "load_throughput": 519204.126, "learn_time_ms": 2.949, "learn_throughput": 40685.518, "synch_weights_time_ms": 0.766}, "counters": {"num_env_steps_sampled": 255000, "num_env_steps_trained": 255000, "num_agent_steps_sampled": 255000, "num_agent_steps_trained": 255000}, "done": false, "episodes_total": 2125, "training_iteration": 532, "trial_id": "29a31_00000", "date": "2023-07-26_02-36-56", "timestamp": 1690328216, "time_this_iter_s": 11.448394060134888, "time_total_s": 6462.452893972397, "pid": 90822, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 1, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[253680, 5e-06], [256080, 5e-06], [258480, 2.5e-06], [260880, 2.5e-06], [263280, 2.5e-06], [265680, 2.5e-06], [268080, 1e-06], [270480, 1e-06], [272880, 1e-06], [275280, 5e-07], [277680, 5e-07], [280080, 5e-07], [282480, 5e-07], [284880, 5e-07], [287280, 1e-07], [289680, 1e-07], [292080, 1e-07]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 120, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x16ca65700>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 841.1274180412292, "iterations_since_restore": 72, "perf": {"cpu_util_percent": 34.7235294117647, "ram_util_percent": 73.05882352941177}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 5e-06, "entropy_coeff": 0.05, "policy_entropy": 267.3188781738281, "policy_loss": -87722.8984375, "vf_loss": 4202562.5}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 291.0, "diff_num_grad_updates_vs_sampler_policy": 290.0}}, "num_env_steps_sampled": 255480, "num_env_steps_trained": 255480, "num_agent_steps_sampled": 255480, "num_agent_steps_trained": 255480}, "sampler_results": {"episode_reward_max": -396.6681276166806, "episode_reward_min": -1152.6001370306305, "episode_reward_mean": -778.3579353122228, "episode_len_mean": 120.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-855.2558251874146, -809.3701680786904, -623.5688613804812, -691.690434146929, -1079.2199202035683, -981.7720482360744, -1082.7679266808696, -612.0075463253661, -727.6773331050063, -530.4021591506896, -704.1432740093248, -857.4587423458685, -999.4472655854777, -733.8772667141154, -773.7495603462278, -916.1381297648675, -972.3508070939575, -954.4290190514084, -995.778583007221, -728.3017600252008, -948.2494413130097, -850.4386558258736, -786.6237144016616, -491.99980470992875, -963.0005892533788, -602.4696272128233, -534.2964904864742, -765.2255988135338, -1152.6001370306305, -732.0769404936107, -791.9863848469458, -916.4358306943702, -735.9125920102998, -757.7772228364103, -569.7552278520072, -702.3207483109954, -647.6811417861289, -670.9380505027437, -1070.644233335096, -798.4568093521814, -626.3483127361287, -745.7895433704377, -563.0169346287039, -650.0012411979194, -766.1771461992677, -755.1716508967431, -617.1073540062661, -405.8218282116934, -605.5509802718186, -700.5695184825174, -757.3624230407881, -842.9979490441494, -586.975997972194, -559.4725684851281, -920.866738946617, -725.706960166542, -1142.077011550846, -886.0252132539247, -572.9000785535595, -837.0575487305188, -1019.7576467496582, -664.5709938593048, -936.9607098420689, -871.798614723867, -660.2346934523323, -1061.236532504413, -774.3954205921513, -653.4828762318899, -563.6321968465464, -772.215125564206, -597.1356022073888, -916.0224813313109, -561.9032764442976, -664.1706291159477, -517.6571415124315, -665.43517218797, -847.0364730522632, -1009.3836856419699, -1007.4155842446473, -724.2261311856754, -851.6414341486135, -909.5470207696831, -602.1261372289888, -798.4171560533446, -469.77912058090806, -783.9063774070419, -853.6153943966289, -918.3906420086815, -744.0703634619459, -929.5034414758214, -869.8693057377583, -1054.3763231450537, -855.9006586799028, -396.6681276166806, -847.4771024005569, -487.6919661244689, -1074.0655165585595, -862.3046350434795, -886.8203085420723, -765.6586412991363], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 21.093987972182877, "mean_inference_ms": 0.40079214218573556, "mean_action_processing_ms": 0.09571633262603217, "mean_env_wait_ms": 2.742564371155552, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0039594173431396484, "StateBufferConnector_ms": 0.002735614776611328, "ViewRequirementAgentConnector_ms": 0.06845903396606445}}, "episode_reward_max": -396.6681276166806, "episode_reward_min": -1152.6001370306305, "episode_reward_mean": -778.3579353122228, "episode_len_mean": 120.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-855.2558251874146, -809.3701680786904, -623.5688613804812, -691.690434146929, -1079.2199202035683, -981.7720482360744, -1082.7679266808696, -612.0075463253661, -727.6773331050063, -530.4021591506896, -704.1432740093248, -857.4587423458685, -999.4472655854777, -733.8772667141154, -773.7495603462278, -916.1381297648675, -972.3508070939575, -954.4290190514084, -995.778583007221, -728.3017600252008, -948.2494413130097, -850.4386558258736, -786.6237144016616, -491.99980470992875, -963.0005892533788, -602.4696272128233, -534.2964904864742, -765.2255988135338, -1152.6001370306305, -732.0769404936107, -791.9863848469458, -916.4358306943702, -735.9125920102998, -757.7772228364103, -569.7552278520072, -702.3207483109954, -647.6811417861289, -670.9380505027437, -1070.644233335096, -798.4568093521814, -626.3483127361287, -745.7895433704377, -563.0169346287039, -650.0012411979194, -766.1771461992677, -755.1716508967431, -617.1073540062661, -405.8218282116934, -605.5509802718186, -700.5695184825174, -757.3624230407881, -842.9979490441494, -586.975997972194, -559.4725684851281, -920.866738946617, -725.706960166542, -1142.077011550846, -886.0252132539247, -572.9000785535595, -837.0575487305188, -1019.7576467496582, -664.5709938593048, -936.9607098420689, -871.798614723867, -660.2346934523323, -1061.236532504413, -774.3954205921513, -653.4828762318899, -563.6321968465464, -772.215125564206, -597.1356022073888, -916.0224813313109, -561.9032764442976, -664.1706291159477, -517.6571415124315, -665.43517218797, -847.0364730522632, -1009.3836856419699, -1007.4155842446473, -724.2261311856754, -851.6414341486135, -909.5470207696831, -602.1261372289888, -798.4171560533446, -469.77912058090806, -783.9063774070419, -853.6153943966289, -918.3906420086815, -744.0703634619459, -929.5034414758214, -869.8693057377583, -1054.3763231450537, -855.9006586799028, -396.6681276166806, -847.4771024005569, -487.6919661244689, -1074.0655165585595, -862.3046350434795, -886.8203085420723, -765.6586412991363], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 21.093987972182877, "mean_inference_ms": 0.40079214218573556, "mean_action_processing_ms": 0.09571633262603217, "mean_env_wait_ms": 2.742564371155552, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0039594173431396484, "StateBufferConnector_ms": 0.002735614776611328, "ViewRequirementAgentConnector_ms": 0.06845903396606445}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 255480, "num_agent_steps_trained": 255480, "num_env_steps_sampled": 255480, "num_env_steps_trained": 255480, "num_env_steps_sampled_this_iter": 480, "num_env_steps_trained_this_iter": 480, "num_env_steps_sampled_throughput_per_sec": 41.40221409043628, "num_env_steps_trained_throughput_per_sec": 41.40221409043628, "timesteps_total": 255480, "num_steps_trained_this_iter": 480, "agent_timesteps_total": 255480, "timers": {"training_iteration_time_ms": 2888.701, "sample_time_ms": 2884.909, "load_time_ms": 0.218, "load_throughput": 549532.132, "learn_time_ms": 2.814, "learn_throughput": 42648.879, "synch_weights_time_ms": 0.72}, "counters": {"num_env_steps_sampled": 255480, "num_env_steps_trained": 255480, "num_agent_steps_sampled": 255480, "num_agent_steps_trained": 255480}, "done": false, "episodes_total": 2129, "training_iteration": 533, "trial_id": "29a31_00000", "date": "2023-07-26_02-37-07", "timestamp": 1690328227, "time_this_iter_s": 11.596297025680542, "time_total_s": 6474.049190998077, "pid": 90822, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 1, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[253680, 5e-06], [256080, 5e-06], [258480, 2.5e-06], [260880, 2.5e-06], [263280, 2.5e-06], [265680, 2.5e-06], [268080, 1e-06], [270480, 1e-06], [272880, 1e-06], [275280, 5e-07], [277680, 5e-07], [280080, 5e-07], [282480, 5e-07], [284880, 5e-07], [287280, 1e-07], [289680, 1e-07], [292080, 1e-07]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 120, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x16ca65700>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 852.7237150669098, "iterations_since_restore": 73, "perf": {"cpu_util_percent": 36.21875, "ram_util_percent": 71.975}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 5e-06, "entropy_coeff": 0.05, "policy_entropy": 267.3695983886719, "policy_loss": -69275.28125, "vf_loss": 2464915.5}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 295.0, "diff_num_grad_updates_vs_sampler_policy": 294.0}}, "num_env_steps_sampled": 255960, "num_env_steps_trained": 255960, "num_agent_steps_sampled": 255960, "num_agent_steps_trained": 255960}, "sampler_results": {"episode_reward_max": -396.6681276166806, "episode_reward_min": -1152.6001370306305, "episode_reward_mean": -777.2586854459785, "episode_len_mean": 120.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1079.2199202035683, -981.7720482360744, -1082.7679266808696, -612.0075463253661, -727.6773331050063, -530.4021591506896, -704.1432740093248, -857.4587423458685, -999.4472655854777, -733.8772667141154, -773.7495603462278, -916.1381297648675, -972.3508070939575, -954.4290190514084, -995.778583007221, -728.3017600252008, -948.2494413130097, -850.4386558258736, -786.6237144016616, -491.99980470992875, -963.0005892533788, -602.4696272128233, -534.2964904864742, -765.2255988135338, -1152.6001370306305, -732.0769404936107, -791.9863848469458, -916.4358306943702, -735.9125920102998, -757.7772228364103, -569.7552278520072, -702.3207483109954, -647.6811417861289, -670.9380505027437, -1070.644233335096, -798.4568093521814, -626.3483127361287, -745.7895433704377, -563.0169346287039, -650.0012411979194, -766.1771461992677, -755.1716508967431, -617.1073540062661, -405.8218282116934, -605.5509802718186, -700.5695184825174, -757.3624230407881, -842.9979490441494, -586.975997972194, -559.4725684851281, -920.866738946617, -725.706960166542, -1142.077011550846, -886.0252132539247, -572.9000785535595, -837.0575487305188, -1019.7576467496582, -664.5709938593048, -936.9607098420689, -871.798614723867, -660.2346934523323, -1061.236532504413, -774.3954205921513, -653.4828762318899, -563.6321968465464, -772.215125564206, -597.1356022073888, -916.0224813313109, -561.9032764442976, -664.1706291159477, -517.6571415124315, -665.43517218797, -847.0364730522632, -1009.3836856419699, -1007.4155842446473, -724.2261311856754, -851.6414341486135, -909.5470207696831, -602.1261372289888, -798.4171560533446, -469.77912058090806, -783.9063774070419, -853.6153943966289, -918.3906420086815, -744.0703634619459, -929.5034414758214, -869.8693057377583, -1054.3763231450537, -855.9006586799028, -396.6681276166806, -847.4771024005569, -487.6919661244689, -1074.0655165585595, -862.3046350434795, -886.8203085420723, -765.6586412991363, -807.8731827753852, -707.1276720706901, -860.4054162943373, -494.5540310286478], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 21.094957107988595, "mean_inference_ms": 0.4007592578175016, "mean_action_processing_ms": 0.09571198931644691, "mean_env_wait_ms": 2.7412406580123934, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003951549530029297, "StateBufferConnector_ms": 0.0027229785919189453, "ViewRequirementAgentConnector_ms": 0.06827664375305176}}, "episode_reward_max": -396.6681276166806, "episode_reward_min": -1152.6001370306305, "episode_reward_mean": -777.2586854459785, "episode_len_mean": 120.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1079.2199202035683, -981.7720482360744, -1082.7679266808696, -612.0075463253661, -727.6773331050063, -530.4021591506896, -704.1432740093248, -857.4587423458685, -999.4472655854777, -733.8772667141154, -773.7495603462278, -916.1381297648675, -972.3508070939575, -954.4290190514084, -995.778583007221, -728.3017600252008, -948.2494413130097, -850.4386558258736, -786.6237144016616, -491.99980470992875, -963.0005892533788, -602.4696272128233, -534.2964904864742, -765.2255988135338, -1152.6001370306305, -732.0769404936107, -791.9863848469458, -916.4358306943702, -735.9125920102998, -757.7772228364103, -569.7552278520072, -702.3207483109954, -647.6811417861289, -670.9380505027437, -1070.644233335096, -798.4568093521814, -626.3483127361287, -745.7895433704377, -563.0169346287039, -650.0012411979194, -766.1771461992677, -755.1716508967431, -617.1073540062661, -405.8218282116934, -605.5509802718186, -700.5695184825174, -757.3624230407881, -842.9979490441494, -586.975997972194, -559.4725684851281, -920.866738946617, -725.706960166542, -1142.077011550846, -886.0252132539247, -572.9000785535595, -837.0575487305188, -1019.7576467496582, -664.5709938593048, -936.9607098420689, -871.798614723867, -660.2346934523323, -1061.236532504413, -774.3954205921513, -653.4828762318899, -563.6321968465464, -772.215125564206, -597.1356022073888, -916.0224813313109, -561.9032764442976, -664.1706291159477, -517.6571415124315, -665.43517218797, -847.0364730522632, -1009.3836856419699, -1007.4155842446473, -724.2261311856754, -851.6414341486135, -909.5470207696831, -602.1261372289888, -798.4171560533446, -469.77912058090806, -783.9063774070419, -853.6153943966289, -918.3906420086815, -744.0703634619459, -929.5034414758214, -869.8693057377583, -1054.3763231450537, -855.9006586799028, -396.6681276166806, -847.4771024005569, -487.6919661244689, -1074.0655165585595, -862.3046350434795, -886.8203085420723, -765.6586412991363, -807.8731827753852, -707.1276720706901, -860.4054162943373, -494.5540310286478], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 21.094957107988595, "mean_inference_ms": 0.4007592578175016, "mean_action_processing_ms": 0.09571198931644691, "mean_env_wait_ms": 2.7412406580123934, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003951549530029297, "StateBufferConnector_ms": 0.0027229785919189453, "ViewRequirementAgentConnector_ms": 0.06827664375305176}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 255960, "num_agent_steps_trained": 255960, "num_env_steps_sampled": 255960, "num_env_steps_trained": 255960, "num_env_steps_sampled_this_iter": 480, "num_env_steps_trained_this_iter": 480, "num_env_steps_sampled_throughput_per_sec": 40.90655732059038, "num_env_steps_trained_throughput_per_sec": 40.90655732059038, "timesteps_total": 255960, "num_steps_trained_this_iter": 480, "agent_timesteps_total": 255960, "timers": {"training_iteration_time_ms": 2905.876, "sample_time_ms": 2902.084, "load_time_ms": 0.216, "load_throughput": 554374.358, "learn_time_ms": 2.823, "learn_throughput": 42511.274, "synch_weights_time_ms": 0.713}, "counters": {"num_env_steps_sampled": 255960, "num_env_steps_trained": 255960, "num_agent_steps_sampled": 255960, "num_agent_steps_trained": 255960}, "done": false, "episodes_total": 2133, "training_iteration": 534, "trial_id": "29a31_00000", "date": "2023-07-26_02-37-19", "timestamp": 1690328239, "time_this_iter_s": 11.736762046813965, "time_total_s": 6485.785953044891, "pid": 90822, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 1, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[253680, 5e-06], [256080, 5e-06], [258480, 2.5e-06], [260880, 2.5e-06], [263280, 2.5e-06], [265680, 2.5e-06], [268080, 1e-06], [270480, 1e-06], [272880, 1e-06], [275280, 5e-07], [277680, 5e-07], [280080, 5e-07], [282480, 5e-07], [284880, 5e-07], [287280, 1e-07], [289680, 1e-07], [292080, 1e-07]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 120, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x16ca65700>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 864.4604771137238, "iterations_since_restore": 74, "perf": {"cpu_util_percent": 36.747058823529414, "ram_util_percent": 72.3}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 4.75e-06, "entropy_coeff": 0.05, "policy_entropy": 267.52978515625, "policy_loss": -53617.5234375, "vf_loss": 1496297.375}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 299.0, "diff_num_grad_updates_vs_sampler_policy": 298.0}}, "num_env_steps_sampled": 256440, "num_env_steps_trained": 256440, "num_agent_steps_sampled": 256440, "num_agent_steps_trained": 256440}, "sampler_results": {"episode_reward_max": -372.95108488290157, "episode_reward_min": -1152.6001370306305, "episode_reward_mean": -762.1430130301284, "episode_len_mean": 120.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-727.6773331050063, -530.4021591506896, -704.1432740093248, -857.4587423458685, -999.4472655854777, -733.8772667141154, -773.7495603462278, -916.1381297648675, -972.3508070939575, -954.4290190514084, -995.778583007221, -728.3017600252008, -948.2494413130097, -850.4386558258736, -786.6237144016616, -491.99980470992875, -963.0005892533788, -602.4696272128233, -534.2964904864742, -765.2255988135338, -1152.6001370306305, -732.0769404936107, -791.9863848469458, -916.4358306943702, -735.9125920102998, -757.7772228364103, -569.7552278520072, -702.3207483109954, -647.6811417861289, -670.9380505027437, -1070.644233335096, -798.4568093521814, -626.3483127361287, -745.7895433704377, -563.0169346287039, -650.0012411979194, -766.1771461992677, -755.1716508967431, -617.1073540062661, -405.8218282116934, -605.5509802718186, -700.5695184825174, -757.3624230407881, -842.9979490441494, -586.975997972194, -559.4725684851281, -920.866738946617, -725.706960166542, -1142.077011550846, -886.0252132539247, -572.9000785535595, -837.0575487305188, -1019.7576467496582, -664.5709938593048, -936.9607098420689, -871.798614723867, -660.2346934523323, -1061.236532504413, -774.3954205921513, -653.4828762318899, -563.6321968465464, -772.215125564206, -597.1356022073888, -916.0224813313109, -561.9032764442976, -664.1706291159477, -517.6571415124315, -665.43517218797, -847.0364730522632, -1009.3836856419699, -1007.4155842446473, -724.2261311856754, -851.6414341486135, -909.5470207696831, -602.1261372289888, -798.4171560533446, -469.77912058090806, -783.9063774070419, -853.6153943966289, -918.3906420086815, -744.0703634619459, -929.5034414758214, -869.8693057377583, -1054.3763231450537, -855.9006586799028, -396.6681276166806, -847.4771024005569, -487.6919661244689, -1074.0655165585595, -862.3046350434795, -886.8203085420723, -765.6586412991363, -807.8731827753852, -707.1276720706901, -860.4054162943373, -494.5540310286478, -714.0637766213503, -606.6292102687963, -550.5561280878185, -372.95108488290157], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 21.09629329284499, "mean_inference_ms": 0.40072792968280657, "mean_action_processing_ms": 0.09570743095355953, "mean_env_wait_ms": 2.739970682058445, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003949403762817383, "StateBufferConnector_ms": 0.0027246475219726562, "ViewRequirementAgentConnector_ms": 0.06820893287658691}}, "episode_reward_max": -372.95108488290157, "episode_reward_min": -1152.6001370306305, "episode_reward_mean": -762.1430130301284, "episode_len_mean": 120.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-727.6773331050063, -530.4021591506896, -704.1432740093248, -857.4587423458685, -999.4472655854777, -733.8772667141154, -773.7495603462278, -916.1381297648675, -972.3508070939575, -954.4290190514084, -995.778583007221, -728.3017600252008, -948.2494413130097, -850.4386558258736, -786.6237144016616, -491.99980470992875, -963.0005892533788, -602.4696272128233, -534.2964904864742, -765.2255988135338, -1152.6001370306305, -732.0769404936107, -791.9863848469458, -916.4358306943702, -735.9125920102998, -757.7772228364103, -569.7552278520072, -702.3207483109954, -647.6811417861289, -670.9380505027437, -1070.644233335096, -798.4568093521814, -626.3483127361287, -745.7895433704377, -563.0169346287039, -650.0012411979194, -766.1771461992677, -755.1716508967431, -617.1073540062661, -405.8218282116934, -605.5509802718186, -700.5695184825174, -757.3624230407881, -842.9979490441494, -586.975997972194, -559.4725684851281, -920.866738946617, -725.706960166542, -1142.077011550846, -886.0252132539247, -572.9000785535595, -837.0575487305188, -1019.7576467496582, -664.5709938593048, -936.9607098420689, -871.798614723867, -660.2346934523323, -1061.236532504413, -774.3954205921513, -653.4828762318899, -563.6321968465464, -772.215125564206, -597.1356022073888, -916.0224813313109, -561.9032764442976, -664.1706291159477, -517.6571415124315, -665.43517218797, -847.0364730522632, -1009.3836856419699, -1007.4155842446473, -724.2261311856754, -851.6414341486135, -909.5470207696831, -602.1261372289888, -798.4171560533446, -469.77912058090806, -783.9063774070419, -853.6153943966289, -918.3906420086815, -744.0703634619459, -929.5034414758214, -869.8693057377583, -1054.3763231450537, -855.9006586799028, -396.6681276166806, -847.4771024005569, -487.6919661244689, -1074.0655165585595, -862.3046350434795, -886.8203085420723, -765.6586412991363, -807.8731827753852, -707.1276720706901, -860.4054162943373, -494.5540310286478, -714.0637766213503, -606.6292102687963, -550.5561280878185, -372.95108488290157], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 21.09629329284499, "mean_inference_ms": 0.40072792968280657, "mean_action_processing_ms": 0.09570743095355953, "mean_env_wait_ms": 2.739970682058445, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003949403762817383, "StateBufferConnector_ms": 0.0027246475219726562, "ViewRequirementAgentConnector_ms": 0.06820893287658691}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 256440, "num_agent_steps_trained": 256440, "num_env_steps_sampled": 256440, "num_env_steps_trained": 256440, "num_env_steps_sampled_this_iter": 480, "num_env_steps_trained_this_iter": 480, "num_env_steps_sampled_throughput_per_sec": 40.44527967190012, "num_env_steps_trained_throughput_per_sec": 40.44527967190012, "timesteps_total": 256440, "num_steps_trained_this_iter": 480, "agent_timesteps_total": 256440, "timers": {"training_iteration_time_ms": 2930.229, "sample_time_ms": 2926.457, "load_time_ms": 0.216, "load_throughput": 556089.36, "learn_time_ms": 2.805, "learn_throughput": 42774.65, "synch_weights_time_ms": 0.71}, "counters": {"num_env_steps_sampled": 256440, "num_env_steps_trained": 256440, "num_agent_steps_sampled": 256440, "num_agent_steps_trained": 256440}, "done": false, "episodes_total": 2137, "training_iteration": 535, "trial_id": "29a31_00000", "date": "2023-07-26_02-37-31", "timestamp": 1690328251, "time_this_iter_s": 11.870605230331421, "time_total_s": 6497.656558275223, "pid": 90822, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 1, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[253680, 5e-06], [256080, 5e-06], [258480, 2.5e-06], [260880, 2.5e-06], [263280, 2.5e-06], [265680, 2.5e-06], [268080, 1e-06], [270480, 1e-06], [272880, 1e-06], [275280, 5e-07], [277680, 5e-07], [280080, 5e-07], [282480, 5e-07], [284880, 5e-07], [287280, 1e-07], [289680, 1e-07], [292080, 1e-07]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 120, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x16ca65700>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 876.3310823440552, "iterations_since_restore": 75, "perf": {"cpu_util_percent": 36.7, "ram_util_percent": 74.31764705882354}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 4.25e-06, "entropy_coeff": 0.05, "policy_entropy": 267.67755126953125, "policy_loss": -51450.98828125, "vf_loss": 1423856.375}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 303.0, "diff_num_grad_updates_vs_sampler_policy": 302.0}}, "num_env_steps_sampled": 256920, "num_env_steps_trained": 256920, "num_agent_steps_sampled": 256920, "num_agent_steps_trained": 256920}, "sampler_results": {"episode_reward_max": -372.95108488290157, "episode_reward_min": -1152.6001370306305, "episode_reward_mean": -758.9611386043148, "episode_len_mean": 120.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-999.4472655854777, -733.8772667141154, -773.7495603462278, -916.1381297648675, -972.3508070939575, -954.4290190514084, -995.778583007221, -728.3017600252008, -948.2494413130097, -850.4386558258736, -786.6237144016616, -491.99980470992875, -963.0005892533788, -602.4696272128233, -534.2964904864742, -765.2255988135338, -1152.6001370306305, -732.0769404936107, -791.9863848469458, -916.4358306943702, -735.9125920102998, -757.7772228364103, -569.7552278520072, -702.3207483109954, -647.6811417861289, -670.9380505027437, -1070.644233335096, -798.4568093521814, -626.3483127361287, -745.7895433704377, -563.0169346287039, -650.0012411979194, -766.1771461992677, -755.1716508967431, -617.1073540062661, -405.8218282116934, -605.5509802718186, -700.5695184825174, -757.3624230407881, -842.9979490441494, -586.975997972194, -559.4725684851281, -920.866738946617, -725.706960166542, -1142.077011550846, -886.0252132539247, -572.9000785535595, -837.0575487305188, -1019.7576467496582, -664.5709938593048, -936.9607098420689, -871.798614723867, -660.2346934523323, -1061.236532504413, -774.3954205921513, -653.4828762318899, -563.6321968465464, -772.215125564206, -597.1356022073888, -916.0224813313109, -561.9032764442976, -664.1706291159477, -517.6571415124315, -665.43517218797, -847.0364730522632, -1009.3836856419699, -1007.4155842446473, -724.2261311856754, -851.6414341486135, -909.5470207696831, -602.1261372289888, -798.4171560533446, -469.77912058090806, -783.9063774070419, -853.6153943966289, -918.3906420086815, -744.0703634619459, -929.5034414758214, -869.8693057377583, -1054.3763231450537, -855.9006586799028, -396.6681276166806, -847.4771024005569, -487.6919661244689, -1074.0655165585595, -862.3046350434795, -886.8203085420723, -765.6586412991363, -807.8731827753852, -707.1276720706901, -860.4054162943373, -494.5540310286478, -714.0637766213503, -606.6292102687963, -550.5561280878185, -372.95108488290157, -626.4212595579489, -850.8657021988108, -602.1339131166317, -422.07319115617565], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 21.09770988244606, "mean_inference_ms": 0.4006989455695571, "mean_action_processing_ms": 0.09570280568633976, "mean_env_wait_ms": 2.738809101338013, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003961086273193359, "StateBufferConnector_ms": 0.0027341842651367188, "ViewRequirementAgentConnector_ms": 0.06824636459350586}}, "episode_reward_max": -372.95108488290157, "episode_reward_min": -1152.6001370306305, "episode_reward_mean": -758.9611386043148, "episode_len_mean": 120.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-999.4472655854777, -733.8772667141154, -773.7495603462278, -916.1381297648675, -972.3508070939575, -954.4290190514084, -995.778583007221, -728.3017600252008, -948.2494413130097, -850.4386558258736, -786.6237144016616, -491.99980470992875, -963.0005892533788, -602.4696272128233, -534.2964904864742, -765.2255988135338, -1152.6001370306305, -732.0769404936107, -791.9863848469458, -916.4358306943702, -735.9125920102998, -757.7772228364103, -569.7552278520072, -702.3207483109954, -647.6811417861289, -670.9380505027437, -1070.644233335096, -798.4568093521814, -626.3483127361287, -745.7895433704377, -563.0169346287039, -650.0012411979194, -766.1771461992677, -755.1716508967431, -617.1073540062661, -405.8218282116934, -605.5509802718186, -700.5695184825174, -757.3624230407881, -842.9979490441494, -586.975997972194, -559.4725684851281, -920.866738946617, -725.706960166542, -1142.077011550846, -886.0252132539247, -572.9000785535595, -837.0575487305188, -1019.7576467496582, -664.5709938593048, -936.9607098420689, -871.798614723867, -660.2346934523323, -1061.236532504413, -774.3954205921513, -653.4828762318899, -563.6321968465464, -772.215125564206, -597.1356022073888, -916.0224813313109, -561.9032764442976, -664.1706291159477, -517.6571415124315, -665.43517218797, -847.0364730522632, -1009.3836856419699, -1007.4155842446473, -724.2261311856754, -851.6414341486135, -909.5470207696831, -602.1261372289888, -798.4171560533446, -469.77912058090806, -783.9063774070419, -853.6153943966289, -918.3906420086815, -744.0703634619459, -929.5034414758214, -869.8693057377583, -1054.3763231450537, -855.9006586799028, -396.6681276166806, -847.4771024005569, -487.6919661244689, -1074.0655165585595, -862.3046350434795, -886.8203085420723, -765.6586412991363, -807.8731827753852, -707.1276720706901, -860.4054162943373, -494.5540310286478, -714.0637766213503, -606.6292102687963, -550.5561280878185, -372.95108488290157, -626.4212595579489, -850.8657021988108, -602.1339131166317, -422.07319115617565], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 21.09770988244606, "mean_inference_ms": 0.4006989455695571, "mean_action_processing_ms": 0.09570280568633976, "mean_env_wait_ms": 2.738809101338013, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003961086273193359, "StateBufferConnector_ms": 0.0027341842651367188, "ViewRequirementAgentConnector_ms": 0.06824636459350586}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 256920, "num_agent_steps_trained": 256920, "num_env_steps_sampled": 256920, "num_env_steps_trained": 256920, "num_env_steps_sampled_this_iter": 480, "num_env_steps_trained_this_iter": 480, "num_env_steps_sampled_throughput_per_sec": 40.847598465266465, "num_env_steps_trained_throughput_per_sec": 40.847598465266465, "timesteps_total": 256920, "num_steps_trained_this_iter": 480, "agent_timesteps_total": 256920, "timers": {"training_iteration_time_ms": 2953.864, "sample_time_ms": 2950.079, "load_time_ms": 0.22, "load_throughput": 546074.081, "learn_time_ms": 2.814, "learn_throughput": 42648.879, "synch_weights_time_ms": 0.71}, "counters": {"num_env_steps_sampled": 256920, "num_env_steps_trained": 256920, "num_agent_steps_sampled": 256920, "num_agent_steps_trained": 256920}, "done": false, "episodes_total": 2141, "training_iteration": 536, "trial_id": "29a31_00000", "date": "2023-07-26_02-37-43", "timestamp": 1690328263, "time_this_iter_s": 11.753618001937866, "time_total_s": 6509.410176277161, "pid": 90822, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 1, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[253680, 5e-06], [256080, 5e-06], [258480, 2.5e-06], [260880, 2.5e-06], [263280, 2.5e-06], [265680, 2.5e-06], [268080, 1e-06], [270480, 1e-06], [272880, 1e-06], [275280, 5e-07], [277680, 5e-07], [280080, 5e-07], [282480, 5e-07], [284880, 5e-07], [287280, 1e-07], [289680, 1e-07], [292080, 1e-07]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 120, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x16ca65700>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 888.084700345993, "iterations_since_restore": 76, "perf": {"cpu_util_percent": 39.068749999999994, "ram_util_percent": 77.31875}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 3.7500000000000005e-06, "entropy_coeff": 0.05, "policy_entropy": 267.7519836425781, "policy_loss": -115173.4453125, "vf_loss": 5883417.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 307.0, "diff_num_grad_updates_vs_sampler_policy": 306.0}}, "num_env_steps_sampled": 257400, "num_env_steps_trained": 257400, "num_agent_steps_sampled": 257400, "num_agent_steps_trained": 257400}, "sampler_results": {"episode_reward_max": -372.95108488290157, "episode_reward_min": -1152.6001370306305, "episode_reward_mean": -756.9231212763185, "episode_len_mean": 120.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-972.3508070939575, -954.4290190514084, -995.778583007221, -728.3017600252008, -948.2494413130097, -850.4386558258736, -786.6237144016616, -491.99980470992875, -963.0005892533788, -602.4696272128233, -534.2964904864742, -765.2255988135338, -1152.6001370306305, -732.0769404936107, -791.9863848469458, -916.4358306943702, -735.9125920102998, -757.7772228364103, -569.7552278520072, -702.3207483109954, -647.6811417861289, -670.9380505027437, -1070.644233335096, -798.4568093521814, -626.3483127361287, -745.7895433704377, -563.0169346287039, -650.0012411979194, -766.1771461992677, -755.1716508967431, -617.1073540062661, -405.8218282116934, -605.5509802718186, -700.5695184825174, -757.3624230407881, -842.9979490441494, -586.975997972194, -559.4725684851281, -920.866738946617, -725.706960166542, -1142.077011550846, -886.0252132539247, -572.9000785535595, -837.0575487305188, -1019.7576467496582, -664.5709938593048, -936.9607098420689, -871.798614723867, -660.2346934523323, -1061.236532504413, -774.3954205921513, -653.4828762318899, -563.6321968465464, -772.215125564206, -597.1356022073888, -916.0224813313109, -561.9032764442976, -664.1706291159477, -517.6571415124315, -665.43517218797, -847.0364730522632, -1009.3836856419699, -1007.4155842446473, -724.2261311856754, -851.6414341486135, -909.5470207696831, -602.1261372289888, -798.4171560533446, -469.77912058090806, -783.9063774070419, -853.6153943966289, -918.3906420086815, -744.0703634619459, -929.5034414758214, -869.8693057377583, -1054.3763231450537, -855.9006586799028, -396.6681276166806, -847.4771024005569, -487.6919661244689, -1074.0655165585595, -862.3046350434795, -886.8203085420723, -765.6586412991363, -807.8731827753852, -707.1276720706901, -860.4054162943373, -494.5540310286478, -714.0637766213503, -606.6292102687963, -550.5561280878185, -372.95108488290157, -626.4212595579489, -850.8657021988108, -602.1339131166317, -422.07319115617565, -614.506937643913, -761.712107716466, -842.6942398734966, -1000.497204377166], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 21.099078895713916, "mean_inference_ms": 0.4006819007483841, "mean_action_processing_ms": 0.0957000473071056, "mean_env_wait_ms": 2.7377405908815997, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0039615631103515625, "StateBufferConnector_ms": 0.00273895263671875, "ViewRequirementAgentConnector_ms": 0.06830716133117676}}, "episode_reward_max": -372.95108488290157, "episode_reward_min": -1152.6001370306305, "episode_reward_mean": -756.9231212763185, "episode_len_mean": 120.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-972.3508070939575, -954.4290190514084, -995.778583007221, -728.3017600252008, -948.2494413130097, -850.4386558258736, -786.6237144016616, -491.99980470992875, -963.0005892533788, -602.4696272128233, -534.2964904864742, -765.2255988135338, -1152.6001370306305, -732.0769404936107, -791.9863848469458, -916.4358306943702, -735.9125920102998, -757.7772228364103, -569.7552278520072, -702.3207483109954, -647.6811417861289, -670.9380505027437, -1070.644233335096, -798.4568093521814, -626.3483127361287, -745.7895433704377, -563.0169346287039, -650.0012411979194, -766.1771461992677, -755.1716508967431, -617.1073540062661, -405.8218282116934, -605.5509802718186, -700.5695184825174, -757.3624230407881, -842.9979490441494, -586.975997972194, -559.4725684851281, -920.866738946617, -725.706960166542, -1142.077011550846, -886.0252132539247, -572.9000785535595, -837.0575487305188, -1019.7576467496582, -664.5709938593048, -936.9607098420689, -871.798614723867, -660.2346934523323, -1061.236532504413, -774.3954205921513, -653.4828762318899, -563.6321968465464, -772.215125564206, -597.1356022073888, -916.0224813313109, -561.9032764442976, -664.1706291159477, -517.6571415124315, -665.43517218797, -847.0364730522632, -1009.3836856419699, -1007.4155842446473, -724.2261311856754, -851.6414341486135, -909.5470207696831, -602.1261372289888, -798.4171560533446, -469.77912058090806, -783.9063774070419, -853.6153943966289, -918.3906420086815, -744.0703634619459, -929.5034414758214, -869.8693057377583, -1054.3763231450537, -855.9006586799028, -396.6681276166806, -847.4771024005569, -487.6919661244689, -1074.0655165585595, -862.3046350434795, -886.8203085420723, -765.6586412991363, -807.8731827753852, -707.1276720706901, -860.4054162943373, -494.5540310286478, -714.0637766213503, -606.6292102687963, -550.5561280878185, -372.95108488290157, -626.4212595579489, -850.8657021988108, -602.1339131166317, -422.07319115617565, -614.506937643913, -761.712107716466, -842.6942398734966, -1000.497204377166], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 21.099078895713916, "mean_inference_ms": 0.4006819007483841, "mean_action_processing_ms": 0.0957000473071056, "mean_env_wait_ms": 2.7377405908815997, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0039615631103515625, "StateBufferConnector_ms": 0.00273895263671875, "ViewRequirementAgentConnector_ms": 0.06830716133117676}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 257400, "num_agent_steps_trained": 257400, "num_env_steps_sampled": 257400, "num_env_steps_trained": 257400, "num_env_steps_sampled_this_iter": 480, "num_env_steps_trained_this_iter": 480, "num_env_steps_sampled_throughput_per_sec": 41.80663540034752, "num_env_steps_trained_throughput_per_sec": 41.80663540034752, "timesteps_total": 257400, "num_steps_trained_this_iter": 480, "agent_timesteps_total": 257400, "timers": {"training_iteration_time_ms": 2934.943, "sample_time_ms": 2931.126, "load_time_ms": 0.223, "load_throughput": 538421.566, "learn_time_ms": 2.837, "learn_throughput": 42298.702, "synch_weights_time_ms": 0.717}, "counters": {"num_env_steps_sampled": 257400, "num_env_steps_trained": 257400, "num_agent_steps_sampled": 257400, "num_agent_steps_trained": 257400}, "done": false, "episodes_total": 2145, "training_iteration": 537, "trial_id": "29a31_00000", "date": "2023-07-26_02-37-54", "timestamp": 1690328274, "time_this_iter_s": 11.48412799835205, "time_total_s": 6520.894304275513, "pid": 90822, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 1, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[253680, 5e-06], [256080, 5e-06], [258480, 2.5e-06], [260880, 2.5e-06], [263280, 2.5e-06], [265680, 2.5e-06], [268080, 1e-06], [270480, 1e-06], [272880, 1e-06], [275280, 5e-07], [277680, 5e-07], [280080, 5e-07], [282480, 5e-07], [284880, 5e-07], [287280, 1e-07], [289680, 1e-07], [292080, 1e-07]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 120, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x16ca65700>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 899.5688283443451, "iterations_since_restore": 77, "perf": {"cpu_util_percent": 35.06875, "ram_util_percent": 75.51249999999999}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 3.2500000000000002e-06, "entropy_coeff": 0.05, "policy_entropy": 267.6847839355469, "policy_loss": -90880.25, "vf_loss": 3181128.5}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 311.0, "diff_num_grad_updates_vs_sampler_policy": 310.0}}, "num_env_steps_sampled": 257880, "num_env_steps_trained": 257880, "num_agent_steps_sampled": 257880, "num_agent_steps_trained": 257880}, "sampler_results": {"episode_reward_max": -372.95108488290157, "episode_reward_min": -1152.6001370306305, "episode_reward_mean": -750.6502841274923, "episode_len_mean": 120.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-948.2494413130097, -850.4386558258736, -786.6237144016616, -491.99980470992875, -963.0005892533788, -602.4696272128233, -534.2964904864742, -765.2255988135338, -1152.6001370306305, -732.0769404936107, -791.9863848469458, -916.4358306943702, -735.9125920102998, -757.7772228364103, -569.7552278520072, -702.3207483109954, -647.6811417861289, -670.9380505027437, -1070.644233335096, -798.4568093521814, -626.3483127361287, -745.7895433704377, -563.0169346287039, -650.0012411979194, -766.1771461992677, -755.1716508967431, -617.1073540062661, -405.8218282116934, -605.5509802718186, -700.5695184825174, -757.3624230407881, -842.9979490441494, -586.975997972194, -559.4725684851281, -920.866738946617, -725.706960166542, -1142.077011550846, -886.0252132539247, -572.9000785535595, -837.0575487305188, -1019.7576467496582, -664.5709938593048, -936.9607098420689, -871.798614723867, -660.2346934523323, -1061.236532504413, -774.3954205921513, -653.4828762318899, -563.6321968465464, -772.215125564206, -597.1356022073888, -916.0224813313109, -561.9032764442976, -664.1706291159477, -517.6571415124315, -665.43517218797, -847.0364730522632, -1009.3836856419699, -1007.4155842446473, -724.2261311856754, -851.6414341486135, -909.5470207696831, -602.1261372289888, -798.4171560533446, -469.77912058090806, -783.9063774070419, -853.6153943966289, -918.3906420086815, -744.0703634619459, -929.5034414758214, -869.8693057377583, -1054.3763231450537, -855.9006586799028, -396.6681276166806, -847.4771024005569, -487.6919661244689, -1074.0655165585595, -862.3046350434795, -886.8203085420723, -765.6586412991363, -807.8731827753852, -707.1276720706901, -860.4054162943373, -494.5540310286478, -714.0637766213503, -606.6292102687963, -550.5561280878185, -372.95108488290157, -626.4212595579489, -850.8657021988108, -602.1339131166317, -422.07319115617565, -614.506937643913, -761.712107716466, -842.6942398734966, -1000.497204377166, -669.4388975484943, -815.409749115435, -840.1285586037965, -698.5992490274338], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 21.100442785302434, "mean_inference_ms": 0.4006702638275776, "mean_action_processing_ms": 0.09569799225057178, "mean_env_wait_ms": 2.7366454498678796, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0039408206939697266, "StateBufferConnector_ms": 0.002738475799560547, "ViewRequirementAgentConnector_ms": 0.0679326057434082}}, "episode_reward_max": -372.95108488290157, "episode_reward_min": -1152.6001370306305, "episode_reward_mean": -750.6502841274923, "episode_len_mean": 120.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-948.2494413130097, -850.4386558258736, -786.6237144016616, -491.99980470992875, -963.0005892533788, -602.4696272128233, -534.2964904864742, -765.2255988135338, -1152.6001370306305, -732.0769404936107, -791.9863848469458, -916.4358306943702, -735.9125920102998, -757.7772228364103, -569.7552278520072, -702.3207483109954, -647.6811417861289, -670.9380505027437, -1070.644233335096, -798.4568093521814, -626.3483127361287, -745.7895433704377, -563.0169346287039, -650.0012411979194, -766.1771461992677, -755.1716508967431, -617.1073540062661, -405.8218282116934, -605.5509802718186, -700.5695184825174, -757.3624230407881, -842.9979490441494, -586.975997972194, -559.4725684851281, -920.866738946617, -725.706960166542, -1142.077011550846, -886.0252132539247, -572.9000785535595, -837.0575487305188, -1019.7576467496582, -664.5709938593048, -936.9607098420689, -871.798614723867, -660.2346934523323, -1061.236532504413, -774.3954205921513, -653.4828762318899, -563.6321968465464, -772.215125564206, -597.1356022073888, -916.0224813313109, -561.9032764442976, -664.1706291159477, -517.6571415124315, -665.43517218797, -847.0364730522632, -1009.3836856419699, -1007.4155842446473, -724.2261311856754, -851.6414341486135, -909.5470207696831, -602.1261372289888, -798.4171560533446, -469.77912058090806, -783.9063774070419, -853.6153943966289, -918.3906420086815, -744.0703634619459, -929.5034414758214, -869.8693057377583, -1054.3763231450537, -855.9006586799028, -396.6681276166806, -847.4771024005569, -487.6919661244689, -1074.0655165585595, -862.3046350434795, -886.8203085420723, -765.6586412991363, -807.8731827753852, -707.1276720706901, -860.4054162943373, -494.5540310286478, -714.0637766213503, -606.6292102687963, -550.5561280878185, -372.95108488290157, -626.4212595579489, -850.8657021988108, -602.1339131166317, -422.07319115617565, -614.506937643913, -761.712107716466, -842.6942398734966, -1000.497204377166, -669.4388975484943, -815.409749115435, -840.1285586037965, -698.5992490274338], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 21.100442785302434, "mean_inference_ms": 0.4006702638275776, "mean_action_processing_ms": 0.09569799225057178, "mean_env_wait_ms": 2.7366454498678796, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0039408206939697266, "StateBufferConnector_ms": 0.002738475799560547, "ViewRequirementAgentConnector_ms": 0.0679326057434082}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 257880, "num_agent_steps_trained": 257880, "num_env_steps_sampled": 257880, "num_env_steps_trained": 257880, "num_env_steps_sampled_this_iter": 480, "num_env_steps_trained_this_iter": 480, "num_env_steps_sampled_throughput_per_sec": 41.32830132099459, "num_env_steps_trained_throughput_per_sec": 41.32830132099459, "timesteps_total": 257880, "num_steps_trained_this_iter": 480, "agent_timesteps_total": 257880, "timers": {"training_iteration_time_ms": 2897.589, "sample_time_ms": 2893.766, "load_time_ms": 0.224, "load_throughput": 536298.86, "learn_time_ms": 2.839, "learn_throughput": 42265.668, "synch_weights_time_ms": 0.72}, "counters": {"num_env_steps_sampled": 257880, "num_env_steps_trained": 257880, "num_agent_steps_sampled": 257880, "num_agent_steps_trained": 257880}, "done": false, "episodes_total": 2149, "training_iteration": 538, "trial_id": "29a31_00000", "date": "2023-07-26_02-38-06", "timestamp": 1690328286, "time_this_iter_s": 11.617095232009888, "time_total_s": 6532.511399507523, "pid": 90822, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 1, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[253680, 5e-06], [256080, 5e-06], [258480, 2.5e-06], [260880, 2.5e-06], [263280, 2.5e-06], [265680, 2.5e-06], [268080, 1e-06], [270480, 1e-06], [272880, 1e-06], [275280, 5e-07], [277680, 5e-07], [280080, 5e-07], [282480, 5e-07], [284880, 5e-07], [287280, 1e-07], [289680, 1e-07], [292080, 1e-07]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 120, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x16ca65700>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 911.185923576355, "iterations_since_restore": 78, "perf": {"cpu_util_percent": 37.641176470588235, "ram_util_percent": 74.03529411764707}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 2.7500000000000004e-06, "entropy_coeff": 0.05, "policy_entropy": 267.606201171875, "policy_loss": -130772.1796875, "vf_loss": 7477734.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 315.0, "diff_num_grad_updates_vs_sampler_policy": 314.0}}, "num_env_steps_sampled": 258360, "num_env_steps_trained": 258360, "num_agent_steps_sampled": 258360, "num_agent_steps_trained": 258360}, "sampler_results": {"episode_reward_max": -372.95108488290157, "episode_reward_min": -1152.6001370306305, "episode_reward_mean": -748.9287087982709, "episode_len_mean": 120.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-963.0005892533788, -602.4696272128233, -534.2964904864742, -765.2255988135338, -1152.6001370306305, -732.0769404936107, -791.9863848469458, -916.4358306943702, -735.9125920102998, -757.7772228364103, -569.7552278520072, -702.3207483109954, -647.6811417861289, -670.9380505027437, -1070.644233335096, -798.4568093521814, -626.3483127361287, -745.7895433704377, -563.0169346287039, -650.0012411979194, -766.1771461992677, -755.1716508967431, -617.1073540062661, -405.8218282116934, -605.5509802718186, -700.5695184825174, -757.3624230407881, -842.9979490441494, -586.975997972194, -559.4725684851281, -920.866738946617, -725.706960166542, -1142.077011550846, -886.0252132539247, -572.9000785535595, -837.0575487305188, -1019.7576467496582, -664.5709938593048, -936.9607098420689, -871.798614723867, -660.2346934523323, -1061.236532504413, -774.3954205921513, -653.4828762318899, -563.6321968465464, -772.215125564206, -597.1356022073888, -916.0224813313109, -561.9032764442976, -664.1706291159477, -517.6571415124315, -665.43517218797, -847.0364730522632, -1009.3836856419699, -1007.4155842446473, -724.2261311856754, -851.6414341486135, -909.5470207696831, -602.1261372289888, -798.4171560533446, -469.77912058090806, -783.9063774070419, -853.6153943966289, -918.3906420086815, -744.0703634619459, -929.5034414758214, -869.8693057377583, -1054.3763231450537, -855.9006586799028, -396.6681276166806, -847.4771024005569, -487.6919661244689, -1074.0655165585595, -862.3046350434795, -886.8203085420723, -765.6586412991363, -807.8731827753852, -707.1276720706901, -860.4054162943373, -494.5540310286478, -714.0637766213503, -606.6292102687963, -550.5561280878185, -372.95108488290157, -626.4212595579489, -850.8657021988108, -602.1339131166317, -422.07319115617565, -614.506937643913, -761.712107716466, -842.6942398734966, -1000.497204377166, -669.4388975484943, -815.409749115435, -840.1285586037965, -698.5992490274338, -644.476647946576, -633.0322119208028, -734.0477893965939, -893.597434064373], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 21.101438808570833, "mean_inference_ms": 0.4006630634461492, "mean_action_processing_ms": 0.09569691046068103, "mean_env_wait_ms": 2.7355350523460937, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003952503204345703, "StateBufferConnector_ms": 0.0027418136596679688, "ViewRequirementAgentConnector_ms": 0.06793212890625}}, "episode_reward_max": -372.95108488290157, "episode_reward_min": -1152.6001370306305, "episode_reward_mean": -748.9287087982709, "episode_len_mean": 120.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-963.0005892533788, -602.4696272128233, -534.2964904864742, -765.2255988135338, -1152.6001370306305, -732.0769404936107, -791.9863848469458, -916.4358306943702, -735.9125920102998, -757.7772228364103, -569.7552278520072, -702.3207483109954, -647.6811417861289, -670.9380505027437, -1070.644233335096, -798.4568093521814, -626.3483127361287, -745.7895433704377, -563.0169346287039, -650.0012411979194, -766.1771461992677, -755.1716508967431, -617.1073540062661, -405.8218282116934, -605.5509802718186, -700.5695184825174, -757.3624230407881, -842.9979490441494, -586.975997972194, -559.4725684851281, -920.866738946617, -725.706960166542, -1142.077011550846, -886.0252132539247, -572.9000785535595, -837.0575487305188, -1019.7576467496582, -664.5709938593048, -936.9607098420689, -871.798614723867, -660.2346934523323, -1061.236532504413, -774.3954205921513, -653.4828762318899, -563.6321968465464, -772.215125564206, -597.1356022073888, -916.0224813313109, -561.9032764442976, -664.1706291159477, -517.6571415124315, -665.43517218797, -847.0364730522632, -1009.3836856419699, -1007.4155842446473, -724.2261311856754, -851.6414341486135, -909.5470207696831, -602.1261372289888, -798.4171560533446, -469.77912058090806, -783.9063774070419, -853.6153943966289, -918.3906420086815, -744.0703634619459, -929.5034414758214, -869.8693057377583, -1054.3763231450537, -855.9006586799028, -396.6681276166806, -847.4771024005569, -487.6919661244689, -1074.0655165585595, -862.3046350434795, -886.8203085420723, -765.6586412991363, -807.8731827753852, -707.1276720706901, -860.4054162943373, -494.5540310286478, -714.0637766213503, -606.6292102687963, -550.5561280878185, -372.95108488290157, -626.4212595579489, -850.8657021988108, -602.1339131166317, -422.07319115617565, -614.506937643913, -761.712107716466, -842.6942398734966, -1000.497204377166, -669.4388975484943, -815.409749115435, -840.1285586037965, -698.5992490274338, -644.476647946576, -633.0322119208028, -734.0477893965939, -893.597434064373], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 21.101438808570833, "mean_inference_ms": 0.4006630634461492, "mean_action_processing_ms": 0.09569691046068103, "mean_env_wait_ms": 2.7355350523460937, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003952503204345703, "StateBufferConnector_ms": 0.0027418136596679688, "ViewRequirementAgentConnector_ms": 0.06793212890625}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 258360, "num_agent_steps_trained": 258360, "num_env_steps_sampled": 258360, "num_env_steps_trained": 258360, "num_env_steps_sampled_this_iter": 480, "num_env_steps_trained_this_iter": 480, "num_env_steps_sampled_throughput_per_sec": 41.4277495677823, "num_env_steps_trained_throughput_per_sec": 41.4277495677823, "timesteps_total": 258360, "num_steps_trained_this_iter": 480, "agent_timesteps_total": 258360, "timers": {"training_iteration_time_ms": 2896.531, "sample_time_ms": 2892.731, "load_time_ms": 0.222, "load_throughput": 541025.992, "learn_time_ms": 2.809, "learn_throughput": 42727.082, "synch_weights_time_ms": 0.73}, "counters": {"num_env_steps_sampled": 258360, "num_env_steps_trained": 258360, "num_agent_steps_sampled": 258360, "num_agent_steps_trained": 258360}, "done": false, "episodes_total": 2153, "training_iteration": 539, "trial_id": "29a31_00000", "date": "2023-07-26_02-38-18", "timestamp": 1690328298, "time_this_iter_s": 11.58943796157837, "time_total_s": 6544.100837469101, "pid": 90822, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 1, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[253680, 5e-06], [256080, 5e-06], [258480, 2.5e-06], [260880, 2.5e-06], [263280, 2.5e-06], [265680, 2.5e-06], [268080, 1e-06], [270480, 1e-06], [272880, 1e-06], [275280, 5e-07], [277680, 5e-07], [280080, 5e-07], [282480, 5e-07], [284880, 5e-07], [287280, 1e-07], [289680, 1e-07], [292080, 1e-07]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 120, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x16ca65700>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 922.7753615379333, "iterations_since_restore": 79, "perf": {"cpu_util_percent": 44.4125, "ram_util_percent": 74.75}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 2.5e-06, "entropy_coeff": 0.05, "policy_entropy": 267.4848327636719, "policy_loss": -105571.4921875, "vf_loss": 4713550.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 319.0, "diff_num_grad_updates_vs_sampler_policy": 318.0}}, "num_env_steps_sampled": 258840, "num_env_steps_trained": 258840, "num_agent_steps_sampled": 258840, "num_agent_steps_trained": 258840}, "sampler_results": {"episode_reward_max": -372.95108488290157, "episode_reward_min": -1152.6001370306305, "episode_reward_mean": -753.1291119557969, "episode_len_mean": 120.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1152.6001370306305, -732.0769404936107, -791.9863848469458, -916.4358306943702, -735.9125920102998, -757.7772228364103, -569.7552278520072, -702.3207483109954, -647.6811417861289, -670.9380505027437, -1070.644233335096, -798.4568093521814, -626.3483127361287, -745.7895433704377, -563.0169346287039, -650.0012411979194, -766.1771461992677, -755.1716508967431, -617.1073540062661, -405.8218282116934, -605.5509802718186, -700.5695184825174, -757.3624230407881, -842.9979490441494, -586.975997972194, -559.4725684851281, -920.866738946617, -725.706960166542, -1142.077011550846, -886.0252132539247, -572.9000785535595, -837.0575487305188, -1019.7576467496582, -664.5709938593048, -936.9607098420689, -871.798614723867, -660.2346934523323, -1061.236532504413, -774.3954205921513, -653.4828762318899, -563.6321968465464, -772.215125564206, -597.1356022073888, -916.0224813313109, -561.9032764442976, -664.1706291159477, -517.6571415124315, -665.43517218797, -847.0364730522632, -1009.3836856419699, -1007.4155842446473, -724.2261311856754, -851.6414341486135, -909.5470207696831, -602.1261372289888, -798.4171560533446, -469.77912058090806, -783.9063774070419, -853.6153943966289, -918.3906420086815, -744.0703634619459, -929.5034414758214, -869.8693057377583, -1054.3763231450537, -855.9006586799028, -396.6681276166806, -847.4771024005569, -487.6919661244689, -1074.0655165585595, -862.3046350434795, -886.8203085420723, -765.6586412991363, -807.8731827753852, -707.1276720706901, -860.4054162943373, -494.5540310286478, -714.0637766213503, -606.6292102687963, -550.5561280878185, -372.95108488290157, -626.4212595579489, -850.8657021988108, -602.1339131166317, -422.07319115617565, -614.506937643913, -761.712107716466, -842.6942398734966, -1000.497204377166, -669.4388975484943, -815.409749115435, -840.1285586037965, -698.5992490274338, -644.476647946576, -633.0322119208028, -734.0477893965939, -893.597434064373, -878.3842015122432, -777.7866167472084, -794.3839637978729, -834.4778394614882], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 21.102283396502443, "mean_inference_ms": 0.40064951426679, "mean_action_processing_ms": 0.09569468353625893, "mean_env_wait_ms": 2.7344347981677286, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003955364227294922, "StateBufferConnector_ms": 0.0027451515197753906, "ViewRequirementAgentConnector_ms": 0.06790494918823242}}, "episode_reward_max": -372.95108488290157, "episode_reward_min": -1152.6001370306305, "episode_reward_mean": -753.1291119557969, "episode_len_mean": 120.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1152.6001370306305, -732.0769404936107, -791.9863848469458, -916.4358306943702, -735.9125920102998, -757.7772228364103, -569.7552278520072, -702.3207483109954, -647.6811417861289, -670.9380505027437, -1070.644233335096, -798.4568093521814, -626.3483127361287, -745.7895433704377, -563.0169346287039, -650.0012411979194, -766.1771461992677, -755.1716508967431, -617.1073540062661, -405.8218282116934, -605.5509802718186, -700.5695184825174, -757.3624230407881, -842.9979490441494, -586.975997972194, -559.4725684851281, -920.866738946617, -725.706960166542, -1142.077011550846, -886.0252132539247, -572.9000785535595, -837.0575487305188, -1019.7576467496582, -664.5709938593048, -936.9607098420689, -871.798614723867, -660.2346934523323, -1061.236532504413, -774.3954205921513, -653.4828762318899, -563.6321968465464, -772.215125564206, -597.1356022073888, -916.0224813313109, -561.9032764442976, -664.1706291159477, -517.6571415124315, -665.43517218797, -847.0364730522632, -1009.3836856419699, -1007.4155842446473, -724.2261311856754, -851.6414341486135, -909.5470207696831, -602.1261372289888, -798.4171560533446, -469.77912058090806, -783.9063774070419, -853.6153943966289, -918.3906420086815, -744.0703634619459, -929.5034414758214, -869.8693057377583, -1054.3763231450537, -855.9006586799028, -396.6681276166806, -847.4771024005569, -487.6919661244689, -1074.0655165585595, -862.3046350434795, -886.8203085420723, -765.6586412991363, -807.8731827753852, -707.1276720706901, -860.4054162943373, -494.5540310286478, -714.0637766213503, -606.6292102687963, -550.5561280878185, -372.95108488290157, -626.4212595579489, -850.8657021988108, -602.1339131166317, -422.07319115617565, -614.506937643913, -761.712107716466, -842.6942398734966, -1000.497204377166, -669.4388975484943, -815.409749115435, -840.1285586037965, -698.5992490274338, -644.476647946576, -633.0322119208028, -734.0477893965939, -893.597434064373, -878.3842015122432, -777.7866167472084, -794.3839637978729, -834.4778394614882], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 21.102283396502443, "mean_inference_ms": 0.40064951426679, "mean_action_processing_ms": 0.09569468353625893, "mean_env_wait_ms": 2.7344347981677286, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003955364227294922, "StateBufferConnector_ms": 0.0027451515197753906, "ViewRequirementAgentConnector_ms": 0.06790494918823242}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 258840, "num_agent_steps_trained": 258840, "num_env_steps_sampled": 258840, "num_env_steps_trained": 258840, "num_env_steps_sampled_this_iter": 480, "num_env_steps_trained_this_iter": 480, "num_env_steps_sampled_throughput_per_sec": 40.80757186337484, "num_env_steps_trained_throughput_per_sec": 40.80757186337484, "timesteps_total": 258840, "num_steps_trained_this_iter": 480, "agent_timesteps_total": 258840, "timers": {"training_iteration_time_ms": 2914.382, "sample_time_ms": 2910.613, "load_time_ms": 0.219, "load_throughput": 548215.314, "learn_time_ms": 2.789, "learn_throughput": 43019.238, "synch_weights_time_ms": 0.721}, "counters": {"num_env_steps_sampled": 258840, "num_env_steps_trained": 258840, "num_agent_steps_sampled": 258840, "num_agent_steps_trained": 258840}, "done": false, "episodes_total": 2157, "training_iteration": 540, "trial_id": "29a31_00000", "date": "2023-07-26_02-38-29", "timestamp": 1690328309, "time_this_iter_s": 11.765182971954346, "time_total_s": 6555.866020441055, "pid": 90822, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 1, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[253680, 5e-06], [256080, 5e-06], [258480, 2.5e-06], [260880, 2.5e-06], [263280, 2.5e-06], [265680, 2.5e-06], [268080, 1e-06], [270480, 1e-06], [272880, 1e-06], [275280, 5e-07], [277680, 5e-07], [280080, 5e-07], [282480, 5e-07], [284880, 5e-07], [287280, 1e-07], [289680, 1e-07], [292080, 1e-07]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 120, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x16ca65700>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 934.5405445098877, "iterations_since_restore": 80, "perf": {"cpu_util_percent": 38.758823529411764, "ram_util_percent": 75.35294117647061}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 2.5e-06, "entropy_coeff": 0.05, "policy_entropy": 267.3397521972656, "policy_loss": -85465.875, "vf_loss": 3612615.25}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 323.0, "diff_num_grad_updates_vs_sampler_policy": 322.0}}, "num_env_steps_sampled": 259320, "num_env_steps_trained": 259320, "num_agent_steps_sampled": 259320, "num_agent_steps_trained": 259320}, "sampler_results": {"episode_reward_max": -372.95108488290157, "episode_reward_min": -1142.077011550846, "episode_reward_mean": -747.2846267054962, "episode_len_mean": 120.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-735.9125920102998, -757.7772228364103, -569.7552278520072, -702.3207483109954, -647.6811417861289, -670.9380505027437, -1070.644233335096, -798.4568093521814, -626.3483127361287, -745.7895433704377, -563.0169346287039, -650.0012411979194, -766.1771461992677, -755.1716508967431, -617.1073540062661, -405.8218282116934, -605.5509802718186, -700.5695184825174, -757.3624230407881, -842.9979490441494, -586.975997972194, -559.4725684851281, -920.866738946617, -725.706960166542, -1142.077011550846, -886.0252132539247, -572.9000785535595, -837.0575487305188, -1019.7576467496582, -664.5709938593048, -936.9607098420689, -871.798614723867, -660.2346934523323, -1061.236532504413, -774.3954205921513, -653.4828762318899, -563.6321968465464, -772.215125564206, -597.1356022073888, -916.0224813313109, -561.9032764442976, -664.1706291159477, -517.6571415124315, -665.43517218797, -847.0364730522632, -1009.3836856419699, -1007.4155842446473, -724.2261311856754, -851.6414341486135, -909.5470207696831, -602.1261372289888, -798.4171560533446, -469.77912058090806, -783.9063774070419, -853.6153943966289, -918.3906420086815, -744.0703634619459, -929.5034414758214, -869.8693057377583, -1054.3763231450537, -855.9006586799028, -396.6681276166806, -847.4771024005569, -487.6919661244689, -1074.0655165585595, -862.3046350434795, -886.8203085420723, -765.6586412991363, -807.8731827753852, -707.1276720706901, -860.4054162943373, -494.5540310286478, -714.0637766213503, -606.6292102687963, -550.5561280878185, -372.95108488290157, -626.4212595579489, -850.8657021988108, -602.1339131166317, -422.07319115617565, -614.506937643913, -761.712107716466, -842.6942398734966, -1000.497204377166, -669.4388975484943, -815.409749115435, -840.1285586037965, -698.5992490274338, -644.476647946576, -633.0322119208028, -734.0477893965939, -893.597434064373, -878.3842015122432, -777.7866167472084, -794.3839637978729, -834.4778394614882, -436.7975754677551, -892.7292495246536, -938.229323055449, -740.8946199876059], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 21.103607405184178, "mean_inference_ms": 0.40063308900459044, "mean_action_processing_ms": 0.09569185529079455, "mean_env_wait_ms": 2.7334242231828525, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00396728515625, "StateBufferConnector_ms": 0.0027539730072021484, "ViewRequirementAgentConnector_ms": 0.0681312084197998}}, "episode_reward_max": -372.95108488290157, "episode_reward_min": -1142.077011550846, "episode_reward_mean": -747.2846267054962, "episode_len_mean": 120.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-735.9125920102998, -757.7772228364103, -569.7552278520072, -702.3207483109954, -647.6811417861289, -670.9380505027437, -1070.644233335096, -798.4568093521814, -626.3483127361287, -745.7895433704377, -563.0169346287039, -650.0012411979194, -766.1771461992677, -755.1716508967431, -617.1073540062661, -405.8218282116934, -605.5509802718186, -700.5695184825174, -757.3624230407881, -842.9979490441494, -586.975997972194, -559.4725684851281, -920.866738946617, -725.706960166542, -1142.077011550846, -886.0252132539247, -572.9000785535595, -837.0575487305188, -1019.7576467496582, -664.5709938593048, -936.9607098420689, -871.798614723867, -660.2346934523323, -1061.236532504413, -774.3954205921513, -653.4828762318899, -563.6321968465464, -772.215125564206, -597.1356022073888, -916.0224813313109, -561.9032764442976, -664.1706291159477, -517.6571415124315, -665.43517218797, -847.0364730522632, -1009.3836856419699, -1007.4155842446473, -724.2261311856754, -851.6414341486135, -909.5470207696831, -602.1261372289888, -798.4171560533446, -469.77912058090806, -783.9063774070419, -853.6153943966289, -918.3906420086815, -744.0703634619459, -929.5034414758214, -869.8693057377583, -1054.3763231450537, -855.9006586799028, -396.6681276166806, -847.4771024005569, -487.6919661244689, -1074.0655165585595, -862.3046350434795, -886.8203085420723, -765.6586412991363, -807.8731827753852, -707.1276720706901, -860.4054162943373, -494.5540310286478, -714.0637766213503, -606.6292102687963, -550.5561280878185, -372.95108488290157, -626.4212595579489, -850.8657021988108, -602.1339131166317, -422.07319115617565, -614.506937643913, -761.712107716466, -842.6942398734966, -1000.497204377166, -669.4388975484943, -815.409749115435, -840.1285586037965, -698.5992490274338, -644.476647946576, -633.0322119208028, -734.0477893965939, -893.597434064373, -878.3842015122432, -777.7866167472084, -794.3839637978729, -834.4778394614882, -436.7975754677551, -892.7292495246536, -938.229323055449, -740.8946199876059], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 21.103607405184178, "mean_inference_ms": 0.40063308900459044, "mean_action_processing_ms": 0.09569185529079455, "mean_env_wait_ms": 2.7334242231828525, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00396728515625, "StateBufferConnector_ms": 0.0027539730072021484, "ViewRequirementAgentConnector_ms": 0.0681312084197998}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 259320, "num_agent_steps_trained": 259320, "num_env_steps_sampled": 259320, "num_env_steps_trained": 259320, "num_env_steps_sampled_this_iter": 480, "num_env_steps_trained_this_iter": 480, "num_env_steps_sampled_throughput_per_sec": 40.514930889208415, "num_env_steps_trained_throughput_per_sec": 40.514930889208415, "timesteps_total": 259320, "num_steps_trained_this_iter": 480, "agent_timesteps_total": 259320, "timers": {"training_iteration_time_ms": 2935.621, "sample_time_ms": 2931.883, "load_time_ms": 0.217, "load_throughput": 553095.033, "learn_time_ms": 2.766, "learn_throughput": 43386.36, "synch_weights_time_ms": 0.716}, "counters": {"num_env_steps_sampled": 259320, "num_env_steps_trained": 259320, "num_agent_steps_sampled": 259320, "num_agent_steps_trained": 259320}, "done": false, "episodes_total": 2161, "training_iteration": 541, "trial_id": "29a31_00000", "date": "2023-07-26_02-38-41", "timestamp": 1690328321, "time_this_iter_s": 11.850312948226929, "time_total_s": 6567.716333389282, "pid": 90822, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 1, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[253680, 5e-06], [256080, 5e-06], [258480, 2.5e-06], [260880, 2.5e-06], [263280, 2.5e-06], [265680, 2.5e-06], [268080, 1e-06], [270480, 1e-06], [272880, 1e-06], [275280, 5e-07], [277680, 5e-07], [280080, 5e-07], [282480, 5e-07], [284880, 5e-07], [287280, 1e-07], [289680, 1e-07], [292080, 1e-07]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 120, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x16ca65700>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 946.3908574581146, "iterations_since_restore": 81, "perf": {"cpu_util_percent": 38.91764705882353, "ram_util_percent": 77.47058823529412}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 2.5e-06, "entropy_coeff": 0.05, "policy_entropy": 267.23388671875, "policy_loss": -66551.25, "vf_loss": 2155264.25}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 327.0, "diff_num_grad_updates_vs_sampler_policy": 326.0}}, "num_env_steps_sampled": 259800, "num_env_steps_trained": 259800, "num_agent_steps_sampled": 259800, "num_agent_steps_trained": 259800}, "sampler_results": {"episode_reward_max": -372.95108488290157, "episode_reward_min": -1142.077011550846, "episode_reward_mean": -747.588630539188, "episode_len_mean": 120.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-647.6811417861289, -670.9380505027437, -1070.644233335096, -798.4568093521814, -626.3483127361287, -745.7895433704377, -563.0169346287039, -650.0012411979194, -766.1771461992677, -755.1716508967431, -617.1073540062661, -405.8218282116934, -605.5509802718186, -700.5695184825174, -757.3624230407881, -842.9979490441494, -586.975997972194, -559.4725684851281, -920.866738946617, -725.706960166542, -1142.077011550846, -886.0252132539247, -572.9000785535595, -837.0575487305188, -1019.7576467496582, -664.5709938593048, -936.9607098420689, -871.798614723867, -660.2346934523323, -1061.236532504413, -774.3954205921513, -653.4828762318899, -563.6321968465464, -772.215125564206, -597.1356022073888, -916.0224813313109, -561.9032764442976, -664.1706291159477, -517.6571415124315, -665.43517218797, -847.0364730522632, -1009.3836856419699, -1007.4155842446473, -724.2261311856754, -851.6414341486135, -909.5470207696831, -602.1261372289888, -798.4171560533446, -469.77912058090806, -783.9063774070419, -853.6153943966289, -918.3906420086815, -744.0703634619459, -929.5034414758214, -869.8693057377583, -1054.3763231450537, -855.9006586799028, -396.6681276166806, -847.4771024005569, -487.6919661244689, -1074.0655165585595, -862.3046350434795, -886.8203085420723, -765.6586412991363, -807.8731827753852, -707.1276720706901, -860.4054162943373, -494.5540310286478, -714.0637766213503, -606.6292102687963, -550.5561280878185, -372.95108488290157, -626.4212595579489, -850.8657021988108, -602.1339131166317, -422.07319115617565, -614.506937643913, -761.712107716466, -842.6942398734966, -1000.497204377166, -669.4388975484943, -815.409749115435, -840.1285586037965, -698.5992490274338, -644.476647946576, -633.0322119208028, -734.0477893965939, -893.597434064373, -878.3842015122432, -777.7866167472084, -794.3839637978729, -834.4778394614882, -436.7975754677551, -892.7292495246536, -938.229323055449, -740.8946199876059, -657.4388919129041, -919.5575899922369, -656.1244389699065, -563.0452535038455], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 21.104744749390566, "mean_inference_ms": 0.40061479595030947, "mean_action_processing_ms": 0.09568868216324815, "mean_env_wait_ms": 2.7324487361943013, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003960371017456055, "StateBufferConnector_ms": 0.0027494430541992188, "ViewRequirementAgentConnector_ms": 0.06801056861877441}}, "episode_reward_max": -372.95108488290157, "episode_reward_min": -1142.077011550846, "episode_reward_mean": -747.588630539188, "episode_len_mean": 120.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-647.6811417861289, -670.9380505027437, -1070.644233335096, -798.4568093521814, -626.3483127361287, -745.7895433704377, -563.0169346287039, -650.0012411979194, -766.1771461992677, -755.1716508967431, -617.1073540062661, -405.8218282116934, -605.5509802718186, -700.5695184825174, -757.3624230407881, -842.9979490441494, -586.975997972194, -559.4725684851281, -920.866738946617, -725.706960166542, -1142.077011550846, -886.0252132539247, -572.9000785535595, -837.0575487305188, -1019.7576467496582, -664.5709938593048, -936.9607098420689, -871.798614723867, -660.2346934523323, -1061.236532504413, -774.3954205921513, -653.4828762318899, -563.6321968465464, -772.215125564206, -597.1356022073888, -916.0224813313109, -561.9032764442976, -664.1706291159477, -517.6571415124315, -665.43517218797, -847.0364730522632, -1009.3836856419699, -1007.4155842446473, -724.2261311856754, -851.6414341486135, -909.5470207696831, -602.1261372289888, -798.4171560533446, -469.77912058090806, -783.9063774070419, -853.6153943966289, -918.3906420086815, -744.0703634619459, -929.5034414758214, -869.8693057377583, -1054.3763231450537, -855.9006586799028, -396.6681276166806, -847.4771024005569, -487.6919661244689, -1074.0655165585595, -862.3046350434795, -886.8203085420723, -765.6586412991363, -807.8731827753852, -707.1276720706901, -860.4054162943373, -494.5540310286478, -714.0637766213503, -606.6292102687963, -550.5561280878185, -372.95108488290157, -626.4212595579489, -850.8657021988108, -602.1339131166317, -422.07319115617565, -614.506937643913, -761.712107716466, -842.6942398734966, -1000.497204377166, -669.4388975484943, -815.409749115435, -840.1285586037965, -698.5992490274338, -644.476647946576, -633.0322119208028, -734.0477893965939, -893.597434064373, -878.3842015122432, -777.7866167472084, -794.3839637978729, -834.4778394614882, -436.7975754677551, -892.7292495246536, -938.229323055449, -740.8946199876059, -657.4388919129041, -919.5575899922369, -656.1244389699065, -563.0452535038455], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 21.104744749390566, "mean_inference_ms": 0.40061479595030947, "mean_action_processing_ms": 0.09568868216324815, "mean_env_wait_ms": 2.7324487361943013, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003960371017456055, "StateBufferConnector_ms": 0.0027494430541992188, "ViewRequirementAgentConnector_ms": 0.06801056861877441}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 259800, "num_agent_steps_trained": 259800, "num_env_steps_sampled": 259800, "num_env_steps_trained": 259800, "num_env_steps_sampled_this_iter": 480, "num_env_steps_trained_this_iter": 480, "num_env_steps_sampled_throughput_per_sec": 41.662634844011734, "num_env_steps_trained_throughput_per_sec": 41.662634844011734, "timesteps_total": 259800, "num_steps_trained_this_iter": 480, "agent_timesteps_total": 259800, "timers": {"training_iteration_time_ms": 2930.038, "sample_time_ms": 2926.308, "load_time_ms": 0.218, "load_throughput": 551277.634, "learn_time_ms": 2.768, "learn_throughput": 43345.632, "synch_weights_time_ms": 0.703}, "counters": {"num_env_steps_sampled": 259800, "num_env_steps_trained": 259800, "num_agent_steps_sampled": 259800, "num_agent_steps_trained": 259800}, "done": false, "episodes_total": 2165, "training_iteration": 542, "trial_id": "29a31_00000", "date": "2023-07-26_02-38-53", "timestamp": 1690328333, "time_this_iter_s": 11.523887157440186, "time_total_s": 6579.240220546722, "pid": 90822, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 1, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[253680, 5e-06], [256080, 5e-06], [258480, 2.5e-06], [260880, 2.5e-06], [263280, 2.5e-06], [265680, 2.5e-06], [268080, 1e-06], [270480, 1e-06], [272880, 1e-06], [275280, 5e-07], [277680, 5e-07], [280080, 5e-07], [282480, 5e-07], [284880, 5e-07], [287280, 1e-07], [289680, 1e-07], [292080, 1e-07]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 120, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x16ca65700>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 957.9147446155548, "iterations_since_restore": 82, "perf": {"cpu_util_percent": 33.23125, "ram_util_percent": 76.575}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 2.5e-06, "entropy_coeff": 0.05, "policy_entropy": 267.172607421875, "policy_loss": -80460.3984375, "vf_loss": 3321356.5}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 331.0, "diff_num_grad_updates_vs_sampler_policy": 330.0}}, "num_env_steps_sampled": 260280, "num_env_steps_trained": 260280, "num_agent_steps_sampled": 260280, "num_agent_steps_trained": 260280}, "sampler_results": {"episode_reward_max": -372.95108488290157, "episode_reward_min": -1142.077011550846, "episode_reward_mean": -746.9071889185071, "episode_len_mean": 120.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-626.3483127361287, -745.7895433704377, -563.0169346287039, -650.0012411979194, -766.1771461992677, -755.1716508967431, -617.1073540062661, -405.8218282116934, -605.5509802718186, -700.5695184825174, -757.3624230407881, -842.9979490441494, -586.975997972194, -559.4725684851281, -920.866738946617, -725.706960166542, -1142.077011550846, -886.0252132539247, -572.9000785535595, -837.0575487305188, -1019.7576467496582, -664.5709938593048, -936.9607098420689, -871.798614723867, -660.2346934523323, -1061.236532504413, -774.3954205921513, -653.4828762318899, -563.6321968465464, -772.215125564206, -597.1356022073888, -916.0224813313109, -561.9032764442976, -664.1706291159477, -517.6571415124315, -665.43517218797, -847.0364730522632, -1009.3836856419699, -1007.4155842446473, -724.2261311856754, -851.6414341486135, -909.5470207696831, -602.1261372289888, -798.4171560533446, -469.77912058090806, -783.9063774070419, -853.6153943966289, -918.3906420086815, -744.0703634619459, -929.5034414758214, -869.8693057377583, -1054.3763231450537, -855.9006586799028, -396.6681276166806, -847.4771024005569, -487.6919661244689, -1074.0655165585595, -862.3046350434795, -886.8203085420723, -765.6586412991363, -807.8731827753852, -707.1276720706901, -860.4054162943373, -494.5540310286478, -714.0637766213503, -606.6292102687963, -550.5561280878185, -372.95108488290157, -626.4212595579489, -850.8657021988108, -602.1339131166317, -422.07319115617565, -614.506937643913, -761.712107716466, -842.6942398734966, -1000.497204377166, -669.4388975484943, -815.409749115435, -840.1285586037965, -698.5992490274338, -644.476647946576, -633.0322119208028, -734.0477893965939, -893.597434064373, -878.3842015122432, -777.7866167472084, -794.3839637978729, -834.4778394614882, -436.7975754677551, -892.7292495246536, -938.229323055449, -740.8946199876059, -657.4388919129041, -919.5575899922369, -656.1244389699065, -563.0452535038455, -491.3412702844287, -1120.0412274475445, -816.4275686934928, -691.7660064826232], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 21.105922932758475, "mean_inference_ms": 0.4005994888847145, "mean_action_processing_ms": 0.09568628149613868, "mean_env_wait_ms": 2.73148876860713, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003964900970458984, "StateBufferConnector_ms": 0.0027484893798828125, "ViewRequirementAgentConnector_ms": 0.06811189651489258}}, "episode_reward_max": -372.95108488290157, "episode_reward_min": -1142.077011550846, "episode_reward_mean": -746.9071889185071, "episode_len_mean": 120.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-626.3483127361287, -745.7895433704377, -563.0169346287039, -650.0012411979194, -766.1771461992677, -755.1716508967431, -617.1073540062661, -405.8218282116934, -605.5509802718186, -700.5695184825174, -757.3624230407881, -842.9979490441494, -586.975997972194, -559.4725684851281, -920.866738946617, -725.706960166542, -1142.077011550846, -886.0252132539247, -572.9000785535595, -837.0575487305188, -1019.7576467496582, -664.5709938593048, -936.9607098420689, -871.798614723867, -660.2346934523323, -1061.236532504413, -774.3954205921513, -653.4828762318899, -563.6321968465464, -772.215125564206, -597.1356022073888, -916.0224813313109, -561.9032764442976, -664.1706291159477, -517.6571415124315, -665.43517218797, -847.0364730522632, -1009.3836856419699, -1007.4155842446473, -724.2261311856754, -851.6414341486135, -909.5470207696831, -602.1261372289888, -798.4171560533446, -469.77912058090806, -783.9063774070419, -853.6153943966289, -918.3906420086815, -744.0703634619459, -929.5034414758214, -869.8693057377583, -1054.3763231450537, -855.9006586799028, -396.6681276166806, -847.4771024005569, -487.6919661244689, -1074.0655165585595, -862.3046350434795, -886.8203085420723, -765.6586412991363, -807.8731827753852, -707.1276720706901, -860.4054162943373, -494.5540310286478, -714.0637766213503, -606.6292102687963, -550.5561280878185, -372.95108488290157, -626.4212595579489, -850.8657021988108, -602.1339131166317, -422.07319115617565, -614.506937643913, -761.712107716466, -842.6942398734966, -1000.497204377166, -669.4388975484943, -815.409749115435, -840.1285586037965, -698.5992490274338, -644.476647946576, -633.0322119208028, -734.0477893965939, -893.597434064373, -878.3842015122432, -777.7866167472084, -794.3839637978729, -834.4778394614882, -436.7975754677551, -892.7292495246536, -938.229323055449, -740.8946199876059, -657.4388919129041, -919.5575899922369, -656.1244389699065, -563.0452535038455, -491.3412702844287, -1120.0412274475445, -816.4275686934928, -691.7660064826232], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 21.105922932758475, "mean_inference_ms": 0.4005994888847145, "mean_action_processing_ms": 0.09568628149613868, "mean_env_wait_ms": 2.73148876860713, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003964900970458984, "StateBufferConnector_ms": 0.0027484893798828125, "ViewRequirementAgentConnector_ms": 0.06811189651489258}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 260280, "num_agent_steps_trained": 260280, "num_env_steps_sampled": 260280, "num_env_steps_trained": 260280, "num_env_steps_sampled_this_iter": 480, "num_env_steps_trained_this_iter": 480, "num_env_steps_sampled_throughput_per_sec": 40.537322210539834, "num_env_steps_trained_throughput_per_sec": 40.537322210539834, "timesteps_total": 260280, "num_steps_trained_this_iter": 480, "agent_timesteps_total": 260280, "timers": {"training_iteration_time_ms": 2931.405, "sample_time_ms": 2927.517, "load_time_ms": 0.221, "load_throughput": 542483.811, "learn_time_ms": 2.889, "learn_throughput": 41541.472, "synch_weights_time_ms": 0.735}, "counters": {"num_env_steps_sampled": 260280, "num_env_steps_trained": 260280, "num_agent_steps_sampled": 260280, "num_agent_steps_trained": 260280}, "done": false, "episodes_total": 2169, "training_iteration": 543, "trial_id": "29a31_00000", "date": "2023-07-26_02-39-05", "timestamp": 1690328345, "time_this_iter_s": 11.843755006790161, "time_total_s": 6591.083975553513, "pid": 90822, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 1, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[253680, 5e-06], [256080, 5e-06], [258480, 2.5e-06], [260880, 2.5e-06], [263280, 2.5e-06], [265680, 2.5e-06], [268080, 1e-06], [270480, 1e-06], [272880, 1e-06], [275280, 5e-07], [277680, 5e-07], [280080, 5e-07], [282480, 5e-07], [284880, 5e-07], [287280, 1e-07], [289680, 1e-07], [292080, 1e-07]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 120, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x16ca65700>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 969.758499622345, "iterations_since_restore": 83, "perf": {"cpu_util_percent": 37.48823529411764, "ram_util_percent": 76.22941176470589}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 2.5e-06, "entropy_coeff": 0.05, "policy_entropy": 267.03887939453125, "policy_loss": -118724.9765625, "vf_loss": 5941076.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 335.0, "diff_num_grad_updates_vs_sampler_policy": 334.0}}, "num_env_steps_sampled": 260760, "num_env_steps_trained": 260760, "num_agent_steps_sampled": 260760, "num_agent_steps_trained": 260760}, "sampler_results": {"episode_reward_max": -372.95108488290157, "episode_reward_min": -1142.077011550846, "episode_reward_mean": -752.9612420191335, "episode_len_mean": 120.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-766.1771461992677, -755.1716508967431, -617.1073540062661, -405.8218282116934, -605.5509802718186, -700.5695184825174, -757.3624230407881, -842.9979490441494, -586.975997972194, -559.4725684851281, -920.866738946617, -725.706960166542, -1142.077011550846, -886.0252132539247, -572.9000785535595, -837.0575487305188, -1019.7576467496582, -664.5709938593048, -936.9607098420689, -871.798614723867, -660.2346934523323, -1061.236532504413, -774.3954205921513, -653.4828762318899, -563.6321968465464, -772.215125564206, -597.1356022073888, -916.0224813313109, -561.9032764442976, -664.1706291159477, -517.6571415124315, -665.43517218797, -847.0364730522632, -1009.3836856419699, -1007.4155842446473, -724.2261311856754, -851.6414341486135, -909.5470207696831, -602.1261372289888, -798.4171560533446, -469.77912058090806, -783.9063774070419, -853.6153943966289, -918.3906420086815, -744.0703634619459, -929.5034414758214, -869.8693057377583, -1054.3763231450537, -855.9006586799028, -396.6681276166806, -847.4771024005569, -487.6919661244689, -1074.0655165585595, -862.3046350434795, -886.8203085420723, -765.6586412991363, -807.8731827753852, -707.1276720706901, -860.4054162943373, -494.5540310286478, -714.0637766213503, -606.6292102687963, -550.5561280878185, -372.95108488290157, -626.4212595579489, -850.8657021988108, -602.1339131166317, -422.07319115617565, -614.506937643913, -761.712107716466, -842.6942398734966, -1000.497204377166, -669.4388975484943, -815.409749115435, -840.1285586037965, -698.5992490274338, -644.476647946576, -633.0322119208028, -734.0477893965939, -893.597434064373, -878.3842015122432, -777.7866167472084, -794.3839637978729, -834.4778394614882, -436.7975754677551, -892.7292495246536, -938.229323055449, -740.8946199876059, -657.4388919129041, -919.5575899922369, -656.1244389699065, -563.0452535038455, -491.3412702844287, -1120.0412274475445, -816.4275686934928, -691.7660064826232, -672.150304929537, -743.7823698198567, -990.6073427430988, -784.0213245033037], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 21.106982373766172, "mean_inference_ms": 0.4005908885768646, "mean_action_processing_ms": 0.09568501629317136, "mean_env_wait_ms": 2.730495796357622, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003968000411987305, "StateBufferConnector_ms": 0.0027437210083007812, "ViewRequirementAgentConnector_ms": 0.06804966926574707}}, "episode_reward_max": -372.95108488290157, "episode_reward_min": -1142.077011550846, "episode_reward_mean": -752.9612420191335, "episode_len_mean": 120.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-766.1771461992677, -755.1716508967431, -617.1073540062661, -405.8218282116934, -605.5509802718186, -700.5695184825174, -757.3624230407881, -842.9979490441494, -586.975997972194, -559.4725684851281, -920.866738946617, -725.706960166542, -1142.077011550846, -886.0252132539247, -572.9000785535595, -837.0575487305188, -1019.7576467496582, -664.5709938593048, -936.9607098420689, -871.798614723867, -660.2346934523323, -1061.236532504413, -774.3954205921513, -653.4828762318899, -563.6321968465464, -772.215125564206, -597.1356022073888, -916.0224813313109, -561.9032764442976, -664.1706291159477, -517.6571415124315, -665.43517218797, -847.0364730522632, -1009.3836856419699, -1007.4155842446473, -724.2261311856754, -851.6414341486135, -909.5470207696831, -602.1261372289888, -798.4171560533446, -469.77912058090806, -783.9063774070419, -853.6153943966289, -918.3906420086815, -744.0703634619459, -929.5034414758214, -869.8693057377583, -1054.3763231450537, -855.9006586799028, -396.6681276166806, -847.4771024005569, -487.6919661244689, -1074.0655165585595, -862.3046350434795, -886.8203085420723, -765.6586412991363, -807.8731827753852, -707.1276720706901, -860.4054162943373, -494.5540310286478, -714.0637766213503, -606.6292102687963, -550.5561280878185, -372.95108488290157, -626.4212595579489, -850.8657021988108, -602.1339131166317, -422.07319115617565, -614.506937643913, -761.712107716466, -842.6942398734966, -1000.497204377166, -669.4388975484943, -815.409749115435, -840.1285586037965, -698.5992490274338, -644.476647946576, -633.0322119208028, -734.0477893965939, -893.597434064373, -878.3842015122432, -777.7866167472084, -794.3839637978729, -834.4778394614882, -436.7975754677551, -892.7292495246536, -938.229323055449, -740.8946199876059, -657.4388919129041, -919.5575899922369, -656.1244389699065, -563.0452535038455, -491.3412702844287, -1120.0412274475445, -816.4275686934928, -691.7660064826232, -672.150304929537, -743.7823698198567, -990.6073427430988, -784.0213245033037], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 21.106982373766172, "mean_inference_ms": 0.4005908885768646, "mean_action_processing_ms": 0.09568501629317136, "mean_env_wait_ms": 2.730495796357622, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003968000411987305, "StateBufferConnector_ms": 0.0027437210083007812, "ViewRequirementAgentConnector_ms": 0.06804966926574707}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 260760, "num_agent_steps_trained": 260760, "num_env_steps_sampled": 260760, "num_env_steps_trained": 260760, "num_env_steps_sampled_this_iter": 480, "num_env_steps_trained_this_iter": 480, "num_env_steps_sampled_throughput_per_sec": 41.10112288625124, "num_env_steps_trained_throughput_per_sec": 41.10112288625124, "timesteps_total": 260760, "num_steps_trained_this_iter": 480, "agent_timesteps_total": 260760, "timers": {"training_iteration_time_ms": 2925.828, "sample_time_ms": 2921.914, "load_time_ms": 0.224, "load_throughput": 535101.51, "learn_time_ms": 2.902, "learn_throughput": 41345.256, "synch_weights_time_ms": 0.744}, "counters": {"num_env_steps_sampled": 260760, "num_env_steps_trained": 260760, "num_agent_steps_sampled": 260760, "num_agent_steps_trained": 260760}, "done": false, "episodes_total": 2173, "training_iteration": 544, "trial_id": "29a31_00000", "date": "2023-07-26_02-39-16", "timestamp": 1690328356, "time_this_iter_s": 11.681272983551025, "time_total_s": 6602.765248537064, "pid": 90822, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 1, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[253680, 5e-06], [256080, 5e-06], [258480, 2.5e-06], [260880, 2.5e-06], [263280, 2.5e-06], [265680, 2.5e-06], [268080, 1e-06], [270480, 1e-06], [272880, 1e-06], [275280, 5e-07], [277680, 5e-07], [280080, 5e-07], [282480, 5e-07], [284880, 5e-07], [287280, 1e-07], [289680, 1e-07], [292080, 1e-07]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 120, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x16ca65700>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 981.439772605896, "iterations_since_restore": 84, "perf": {"cpu_util_percent": 35.25882352941177, "ram_util_percent": 74.27058823529413}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 2.5e-06, "entropy_coeff": 0.05, "policy_entropy": 266.8531799316406, "policy_loss": -102552.640625, "vf_loss": 4902659.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 339.0, "diff_num_grad_updates_vs_sampler_policy": 338.0}}, "num_env_steps_sampled": 261240, "num_env_steps_trained": 261240, "num_agent_steps_sampled": 261240, "num_agent_steps_trained": 261240}, "sampler_results": {"episode_reward_max": -372.95108488290157, "episode_reward_min": -1142.077011550846, "episode_reward_mean": -754.263259602677, "episode_len_mean": 120.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-605.5509802718186, -700.5695184825174, -757.3624230407881, -842.9979490441494, -586.975997972194, -559.4725684851281, -920.866738946617, -725.706960166542, -1142.077011550846, -886.0252132539247, -572.9000785535595, -837.0575487305188, -1019.7576467496582, -664.5709938593048, -936.9607098420689, -871.798614723867, -660.2346934523323, -1061.236532504413, -774.3954205921513, -653.4828762318899, -563.6321968465464, -772.215125564206, -597.1356022073888, -916.0224813313109, -561.9032764442976, -664.1706291159477, -517.6571415124315, -665.43517218797, -847.0364730522632, -1009.3836856419699, -1007.4155842446473, -724.2261311856754, -851.6414341486135, -909.5470207696831, -602.1261372289888, -798.4171560533446, -469.77912058090806, -783.9063774070419, -853.6153943966289, -918.3906420086815, -744.0703634619459, -929.5034414758214, -869.8693057377583, -1054.3763231450537, -855.9006586799028, -396.6681276166806, -847.4771024005569, -487.6919661244689, -1074.0655165585595, -862.3046350434795, -886.8203085420723, -765.6586412991363, -807.8731827753852, -707.1276720706901, -860.4054162943373, -494.5540310286478, -714.0637766213503, -606.6292102687963, -550.5561280878185, -372.95108488290157, -626.4212595579489, -850.8657021988108, -602.1339131166317, -422.07319115617565, -614.506937643913, -761.712107716466, -842.6942398734966, -1000.497204377166, -669.4388975484943, -815.409749115435, -840.1285586037965, -698.5992490274338, -644.476647946576, -633.0322119208028, -734.0477893965939, -893.597434064373, -878.3842015122432, -777.7866167472084, -794.3839637978729, -834.4778394614882, -436.7975754677551, -892.7292495246536, -938.229323055449, -740.8946199876059, -657.4388919129041, -919.5575899922369, -656.1244389699065, -563.0452535038455, -491.3412702844287, -1120.0412274475445, -816.4275686934928, -691.7660064826232, -672.150304929537, -743.7823698198567, -990.6073427430988, -784.0213245033037, -779.8132443920898, -526.7318438888908, -559.9690290628494, -807.9656203244913], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 21.108021765142368, "mean_inference_ms": 0.40058511069123653, "mean_action_processing_ms": 0.09568414539598916, "mean_env_wait_ms": 2.729545373059677, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003971099853515625, "StateBufferConnector_ms": 0.0027468204498291016, "ViewRequirementAgentConnector_ms": 0.06815624237060547}}, "episode_reward_max": -372.95108488290157, "episode_reward_min": -1142.077011550846, "episode_reward_mean": -754.263259602677, "episode_len_mean": 120.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-605.5509802718186, -700.5695184825174, -757.3624230407881, -842.9979490441494, -586.975997972194, -559.4725684851281, -920.866738946617, -725.706960166542, -1142.077011550846, -886.0252132539247, -572.9000785535595, -837.0575487305188, -1019.7576467496582, -664.5709938593048, -936.9607098420689, -871.798614723867, -660.2346934523323, -1061.236532504413, -774.3954205921513, -653.4828762318899, -563.6321968465464, -772.215125564206, -597.1356022073888, -916.0224813313109, -561.9032764442976, -664.1706291159477, -517.6571415124315, -665.43517218797, -847.0364730522632, -1009.3836856419699, -1007.4155842446473, -724.2261311856754, -851.6414341486135, -909.5470207696831, -602.1261372289888, -798.4171560533446, -469.77912058090806, -783.9063774070419, -853.6153943966289, -918.3906420086815, -744.0703634619459, -929.5034414758214, -869.8693057377583, -1054.3763231450537, -855.9006586799028, -396.6681276166806, -847.4771024005569, -487.6919661244689, -1074.0655165585595, -862.3046350434795, -886.8203085420723, -765.6586412991363, -807.8731827753852, -707.1276720706901, -860.4054162943373, -494.5540310286478, -714.0637766213503, -606.6292102687963, -550.5561280878185, -372.95108488290157, -626.4212595579489, -850.8657021988108, -602.1339131166317, -422.07319115617565, -614.506937643913, -761.712107716466, -842.6942398734966, -1000.497204377166, -669.4388975484943, -815.409749115435, -840.1285586037965, -698.5992490274338, -644.476647946576, -633.0322119208028, -734.0477893965939, -893.597434064373, -878.3842015122432, -777.7866167472084, -794.3839637978729, -834.4778394614882, -436.7975754677551, -892.7292495246536, -938.229323055449, -740.8946199876059, -657.4388919129041, -919.5575899922369, -656.1244389699065, -563.0452535038455, -491.3412702844287, -1120.0412274475445, -816.4275686934928, -691.7660064826232, -672.150304929537, -743.7823698198567, -990.6073427430988, -784.0213245033037, -779.8132443920898, -526.7318438888908, -559.9690290628494, -807.9656203244913], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 21.108021765142368, "mean_inference_ms": 0.40058511069123653, "mean_action_processing_ms": 0.09568414539598916, "mean_env_wait_ms": 2.729545373059677, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003971099853515625, "StateBufferConnector_ms": 0.0027468204498291016, "ViewRequirementAgentConnector_ms": 0.06815624237060547}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 261240, "num_agent_steps_trained": 261240, "num_env_steps_sampled": 261240, "num_env_steps_trained": 261240, "num_env_steps_sampled_this_iter": 480, "num_env_steps_trained_this_iter": 480, "num_env_steps_sampled_throughput_per_sec": 40.2172065557973, "num_env_steps_trained_throughput_per_sec": 40.2172065557973, "timesteps_total": 261240, "num_steps_trained_this_iter": 480, "agent_timesteps_total": 261240, "timers": {"training_iteration_time_ms": 2966.824, "sample_time_ms": 2963.039, "load_time_ms": 0.221, "load_throughput": 544067.106, "learn_time_ms": 2.814, "learn_throughput": 42639.485, "synch_weights_time_ms": 0.709}, "counters": {"num_env_steps_sampled": 261240, "num_env_steps_trained": 261240, "num_agent_steps_sampled": 261240, "num_agent_steps_trained": 261240}, "done": false, "episodes_total": 2177, "training_iteration": 545, "trial_id": "29a31_00000", "date": "2023-07-26_02-39-28", "timestamp": 1690328368, "time_this_iter_s": 11.937914848327637, "time_total_s": 6614.703163385391, "pid": 90822, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 1, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[253680, 5e-06], [256080, 5e-06], [258480, 2.5e-06], [260880, 2.5e-06], [263280, 2.5e-06], [265680, 2.5e-06], [268080, 1e-06], [270480, 1e-06], [272880, 1e-06], [275280, 5e-07], [277680, 5e-07], [280080, 5e-07], [282480, 5e-07], [284880, 5e-07], [287280, 1e-07], [289680, 1e-07], [292080, 1e-07]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 120, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x16ca65700>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 993.3776874542236, "iterations_since_restore": 85, "perf": {"cpu_util_percent": 37.693749999999994, "ram_util_percent": 74.19375}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 2.5e-06, "entropy_coeff": 0.05, "policy_entropy": 266.77618408203125, "policy_loss": -98848.03125, "vf_loss": 4424537.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 343.0, "diff_num_grad_updates_vs_sampler_policy": 342.0}}, "num_env_steps_sampled": 261720, "num_env_steps_trained": 261720, "num_agent_steps_sampled": 261720, "num_agent_steps_trained": 261720}, "sampler_results": {"episode_reward_max": -372.95108488290157, "episode_reward_min": -1142.077011550846, "episode_reward_mean": -759.3146628240384, "episode_len_mean": 120.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-586.975997972194, -559.4725684851281, -920.866738946617, -725.706960166542, -1142.077011550846, -886.0252132539247, -572.9000785535595, -837.0575487305188, -1019.7576467496582, -664.5709938593048, -936.9607098420689, -871.798614723867, -660.2346934523323, -1061.236532504413, -774.3954205921513, -653.4828762318899, -563.6321968465464, -772.215125564206, -597.1356022073888, -916.0224813313109, -561.9032764442976, -664.1706291159477, -517.6571415124315, -665.43517218797, -847.0364730522632, -1009.3836856419699, -1007.4155842446473, -724.2261311856754, -851.6414341486135, -909.5470207696831, -602.1261372289888, -798.4171560533446, -469.77912058090806, -783.9063774070419, -853.6153943966289, -918.3906420086815, -744.0703634619459, -929.5034414758214, -869.8693057377583, -1054.3763231450537, -855.9006586799028, -396.6681276166806, -847.4771024005569, -487.6919661244689, -1074.0655165585595, -862.3046350434795, -886.8203085420723, -765.6586412991363, -807.8731827753852, -707.1276720706901, -860.4054162943373, -494.5540310286478, -714.0637766213503, -606.6292102687963, -550.5561280878185, -372.95108488290157, -626.4212595579489, -850.8657021988108, -602.1339131166317, -422.07319115617565, -614.506937643913, -761.712107716466, -842.6942398734966, -1000.497204377166, -669.4388975484943, -815.409749115435, -840.1285586037965, -698.5992490274338, -644.476647946576, -633.0322119208028, -734.0477893965939, -893.597434064373, -878.3842015122432, -777.7866167472084, -794.3839637978729, -834.4778394614882, -436.7975754677551, -892.7292495246536, -938.229323055449, -740.8946199876059, -657.4388919129041, -919.5575899922369, -656.1244389699065, -563.0452535038455, -491.3412702844287, -1120.0412274475445, -816.4275686934928, -691.7660064826232, -672.150304929537, -743.7823698198567, -990.6073427430988, -784.0213245033037, -779.8132443920898, -526.7318438888908, -559.9690290628494, -807.9656203244913, -853.2066580917271, -773.5155461170024, -1087.0730426597029, -697.8259461069835], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 21.109403805564874, "mean_inference_ms": 0.4005727106169208, "mean_action_processing_ms": 0.09568227285591346, "mean_env_wait_ms": 2.7286896259510467, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003934383392333984, "StateBufferConnector_ms": 0.0027196407318115234, "ViewRequirementAgentConnector_ms": 0.06780195236206055}}, "episode_reward_max": -372.95108488290157, "episode_reward_min": -1142.077011550846, "episode_reward_mean": -759.3146628240384, "episode_len_mean": 120.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-586.975997972194, -559.4725684851281, -920.866738946617, -725.706960166542, -1142.077011550846, -886.0252132539247, -572.9000785535595, -837.0575487305188, -1019.7576467496582, -664.5709938593048, -936.9607098420689, -871.798614723867, -660.2346934523323, -1061.236532504413, -774.3954205921513, -653.4828762318899, -563.6321968465464, -772.215125564206, -597.1356022073888, -916.0224813313109, -561.9032764442976, -664.1706291159477, -517.6571415124315, -665.43517218797, -847.0364730522632, -1009.3836856419699, -1007.4155842446473, -724.2261311856754, -851.6414341486135, -909.5470207696831, -602.1261372289888, -798.4171560533446, -469.77912058090806, -783.9063774070419, -853.6153943966289, -918.3906420086815, -744.0703634619459, -929.5034414758214, -869.8693057377583, -1054.3763231450537, -855.9006586799028, -396.6681276166806, -847.4771024005569, -487.6919661244689, -1074.0655165585595, -862.3046350434795, -886.8203085420723, -765.6586412991363, -807.8731827753852, -707.1276720706901, -860.4054162943373, -494.5540310286478, -714.0637766213503, -606.6292102687963, -550.5561280878185, -372.95108488290157, -626.4212595579489, -850.8657021988108, -602.1339131166317, -422.07319115617565, -614.506937643913, -761.712107716466, -842.6942398734966, -1000.497204377166, -669.4388975484943, -815.409749115435, -840.1285586037965, -698.5992490274338, -644.476647946576, -633.0322119208028, -734.0477893965939, -893.597434064373, -878.3842015122432, -777.7866167472084, -794.3839637978729, -834.4778394614882, -436.7975754677551, -892.7292495246536, -938.229323055449, -740.8946199876059, -657.4388919129041, -919.5575899922369, -656.1244389699065, -563.0452535038455, -491.3412702844287, -1120.0412274475445, -816.4275686934928, -691.7660064826232, -672.150304929537, -743.7823698198567, -990.6073427430988, -784.0213245033037, -779.8132443920898, -526.7318438888908, -559.9690290628494, -807.9656203244913, -853.2066580917271, -773.5155461170024, -1087.0730426597029, -697.8259461069835], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 21.109403805564874, "mean_inference_ms": 0.4005727106169208, "mean_action_processing_ms": 0.09568227285591346, "mean_env_wait_ms": 2.7286896259510467, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003934383392333984, "StateBufferConnector_ms": 0.0027196407318115234, "ViewRequirementAgentConnector_ms": 0.06780195236206055}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 261720, "num_agent_steps_trained": 261720, "num_env_steps_sampled": 261720, "num_env_steps_trained": 261720, "num_env_steps_sampled_this_iter": 480, "num_env_steps_trained_this_iter": 480, "num_env_steps_sampled_throughput_per_sec": 39.780649268412326, "num_env_steps_trained_throughput_per_sec": 39.780649268412326, "timesteps_total": 261720, "num_steps_trained_this_iter": 480, "agent_timesteps_total": 261720, "timers": {"training_iteration_time_ms": 2977.109, "sample_time_ms": 2973.258, "load_time_ms": 0.227, "load_throughput": 528471.735, "learn_time_ms": 2.843, "learn_throughput": 42216.037, "synch_weights_time_ms": 0.73}, "counters": {"num_env_steps_sampled": 261720, "num_env_steps_trained": 261720, "num_agent_steps_sampled": 261720, "num_agent_steps_trained": 261720}, "done": false, "episodes_total": 2181, "training_iteration": 546, "trial_id": "29a31_00000", "date": "2023-07-26_02-39-40", "timestamp": 1690328380, "time_this_iter_s": 12.068994045257568, "time_total_s": 6626.772157430649, "pid": 90822, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 1, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[253680, 5e-06], [256080, 5e-06], [258480, 2.5e-06], [260880, 2.5e-06], [263280, 2.5e-06], [265680, 2.5e-06], [268080, 1e-06], [270480, 1e-06], [272880, 1e-06], [275280, 5e-07], [277680, 5e-07], [280080, 5e-07], [282480, 5e-07], [284880, 5e-07], [287280, 1e-07], [289680, 1e-07], [292080, 1e-07]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 120, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x16ca65700>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1005.4466814994812, "iterations_since_restore": 86, "perf": {"cpu_util_percent": 38.011111111111106, "ram_util_percent": 76.47222222222223}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 2.5e-06, "entropy_coeff": 0.05, "policy_entropy": 266.70001220703125, "policy_loss": -77416.359375, "vf_loss": 2720409.25}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 347.0, "diff_num_grad_updates_vs_sampler_policy": 346.0}}, "num_env_steps_sampled": 262200, "num_env_steps_trained": 262200, "num_agent_steps_sampled": 262200, "num_agent_steps_trained": 262200}, "sampler_results": {"episode_reward_max": -372.95108488290157, "episode_reward_min": -1142.077011550846, "episode_reward_mean": -766.0415378770554, "episode_len_mean": 120.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1142.077011550846, -886.0252132539247, -572.9000785535595, -837.0575487305188, -1019.7576467496582, -664.5709938593048, -936.9607098420689, -871.798614723867, -660.2346934523323, -1061.236532504413, -774.3954205921513, -653.4828762318899, -563.6321968465464, -772.215125564206, -597.1356022073888, -916.0224813313109, -561.9032764442976, -664.1706291159477, -517.6571415124315, -665.43517218797, -847.0364730522632, -1009.3836856419699, -1007.4155842446473, -724.2261311856754, -851.6414341486135, -909.5470207696831, -602.1261372289888, -798.4171560533446, -469.77912058090806, -783.9063774070419, -853.6153943966289, -918.3906420086815, -744.0703634619459, -929.5034414758214, -869.8693057377583, -1054.3763231450537, -855.9006586799028, -396.6681276166806, -847.4771024005569, -487.6919661244689, -1074.0655165585595, -862.3046350434795, -886.8203085420723, -765.6586412991363, -807.8731827753852, -707.1276720706901, -860.4054162943373, -494.5540310286478, -714.0637766213503, -606.6292102687963, -550.5561280878185, -372.95108488290157, -626.4212595579489, -850.8657021988108, -602.1339131166317, -422.07319115617565, -614.506937643913, -761.712107716466, -842.6942398734966, -1000.497204377166, -669.4388975484943, -815.409749115435, -840.1285586037965, -698.5992490274338, -644.476647946576, -633.0322119208028, -734.0477893965939, -893.597434064373, -878.3842015122432, -777.7866167472084, -794.3839637978729, -834.4778394614882, -436.7975754677551, -892.7292495246536, -938.229323055449, -740.8946199876059, -657.4388919129041, -919.5575899922369, -656.1244389699065, -563.0452535038455, -491.3412702844287, -1120.0412274475445, -816.4275686934928, -691.7660064826232, -672.150304929537, -743.7823698198567, -990.6073427430988, -784.0213245033037, -779.8132443920898, -526.7318438888908, -559.9690290628494, -807.9656203244913, -853.2066580917271, -773.5155461170024, -1087.0730426597029, -697.8259461069835, -711.2352334562752, -928.5001612789654, -1128.8663733947067, -697.1080027422427], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 21.110735730645093, "mean_inference_ms": 0.4005659678657587, "mean_action_processing_ms": 0.09568068032308691, "mean_env_wait_ms": 2.7278825936070574, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0039386749267578125, "StateBufferConnector_ms": 0.0027244091033935547, "ViewRequirementAgentConnector_ms": 0.06772899627685547}}, "episode_reward_max": -372.95108488290157, "episode_reward_min": -1142.077011550846, "episode_reward_mean": -766.0415378770554, "episode_len_mean": 120.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1142.077011550846, -886.0252132539247, -572.9000785535595, -837.0575487305188, -1019.7576467496582, -664.5709938593048, -936.9607098420689, -871.798614723867, -660.2346934523323, -1061.236532504413, -774.3954205921513, -653.4828762318899, -563.6321968465464, -772.215125564206, -597.1356022073888, -916.0224813313109, -561.9032764442976, -664.1706291159477, -517.6571415124315, -665.43517218797, -847.0364730522632, -1009.3836856419699, -1007.4155842446473, -724.2261311856754, -851.6414341486135, -909.5470207696831, -602.1261372289888, -798.4171560533446, -469.77912058090806, -783.9063774070419, -853.6153943966289, -918.3906420086815, -744.0703634619459, -929.5034414758214, -869.8693057377583, -1054.3763231450537, -855.9006586799028, -396.6681276166806, -847.4771024005569, -487.6919661244689, -1074.0655165585595, -862.3046350434795, -886.8203085420723, -765.6586412991363, -807.8731827753852, -707.1276720706901, -860.4054162943373, -494.5540310286478, -714.0637766213503, -606.6292102687963, -550.5561280878185, -372.95108488290157, -626.4212595579489, -850.8657021988108, -602.1339131166317, -422.07319115617565, -614.506937643913, -761.712107716466, -842.6942398734966, -1000.497204377166, -669.4388975484943, -815.409749115435, -840.1285586037965, -698.5992490274338, -644.476647946576, -633.0322119208028, -734.0477893965939, -893.597434064373, -878.3842015122432, -777.7866167472084, -794.3839637978729, -834.4778394614882, -436.7975754677551, -892.7292495246536, -938.229323055449, -740.8946199876059, -657.4388919129041, -919.5575899922369, -656.1244389699065, -563.0452535038455, -491.3412702844287, -1120.0412274475445, -816.4275686934928, -691.7660064826232, -672.150304929537, -743.7823698198567, -990.6073427430988, -784.0213245033037, -779.8132443920898, -526.7318438888908, -559.9690290628494, -807.9656203244913, -853.2066580917271, -773.5155461170024, -1087.0730426597029, -697.8259461069835, -711.2352334562752, -928.5001612789654, -1128.8663733947067, -697.1080027422427], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 21.110735730645093, "mean_inference_ms": 0.4005659678657587, "mean_action_processing_ms": 0.09568068032308691, "mean_env_wait_ms": 2.7278825936070574, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0039386749267578125, "StateBufferConnector_ms": 0.0027244091033935547, "ViewRequirementAgentConnector_ms": 0.06772899627685547}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 262200, "num_agent_steps_trained": 262200, "num_env_steps_sampled": 262200, "num_env_steps_trained": 262200, "num_env_steps_sampled_this_iter": 480, "num_env_steps_trained_this_iter": 480, "num_env_steps_sampled_throughput_per_sec": 41.50238924680516, "num_env_steps_trained_throughput_per_sec": 41.50238924680516, "timesteps_total": 262200, "num_steps_trained_this_iter": 480, "agent_timesteps_total": 262200, "timers": {"training_iteration_time_ms": 2946.088, "sample_time_ms": 2942.215, "load_time_ms": 0.225, "load_throughput": 533343.732, "learn_time_ms": 2.86, "learn_throughput": 41962.273, "synch_weights_time_ms": 0.737}, "counters": {"num_env_steps_sampled": 262200, "num_env_steps_trained": 262200, "num_agent_steps_sampled": 262200, "num_agent_steps_trained": 262200}, "done": false, "episodes_total": 2185, "training_iteration": 547, "trial_id": "29a31_00000", "date": "2023-07-26_02-39-52", "timestamp": 1690328392, "time_this_iter_s": 11.568241834640503, "time_total_s": 6638.340399265289, "pid": 90822, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 1, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[253680, 5e-06], [256080, 5e-06], [258480, 2.5e-06], [260880, 2.5e-06], [263280, 2.5e-06], [265680, 2.5e-06], [268080, 1e-06], [270480, 1e-06], [272880, 1e-06], [275280, 5e-07], [277680, 5e-07], [280080, 5e-07], [282480, 5e-07], [284880, 5e-07], [287280, 1e-07], [289680, 1e-07], [292080, 1e-07]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 120, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x16ca65700>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1017.0149233341217, "iterations_since_restore": 87, "perf": {"cpu_util_percent": 33.162499999999994, "ram_util_percent": 76.0375}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 2.5e-06, "entropy_coeff": 0.05, "policy_entropy": 266.5525207519531, "policy_loss": -81387.09375, "vf_loss": 3323828.25}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 351.0, "diff_num_grad_updates_vs_sampler_policy": 350.0}}, "num_env_steps_sampled": 262680, "num_env_steps_trained": 262680, "num_agent_steps_sampled": 262680, "num_agent_steps_trained": 262680}, "sampler_results": {"episode_reward_max": -372.95108488290157, "episode_reward_min": -1128.8663733947067, "episode_reward_mean": -759.2220337067206, "episode_len_mean": 120.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1019.7576467496582, -664.5709938593048, -936.9607098420689, -871.798614723867, -660.2346934523323, -1061.236532504413, -774.3954205921513, -653.4828762318899, -563.6321968465464, -772.215125564206, -597.1356022073888, -916.0224813313109, -561.9032764442976, -664.1706291159477, -517.6571415124315, -665.43517218797, -847.0364730522632, -1009.3836856419699, -1007.4155842446473, -724.2261311856754, -851.6414341486135, -909.5470207696831, -602.1261372289888, -798.4171560533446, -469.77912058090806, -783.9063774070419, -853.6153943966289, -918.3906420086815, -744.0703634619459, -929.5034414758214, -869.8693057377583, -1054.3763231450537, -855.9006586799028, -396.6681276166806, -847.4771024005569, -487.6919661244689, -1074.0655165585595, -862.3046350434795, -886.8203085420723, -765.6586412991363, -807.8731827753852, -707.1276720706901, -860.4054162943373, -494.5540310286478, -714.0637766213503, -606.6292102687963, -550.5561280878185, -372.95108488290157, -626.4212595579489, -850.8657021988108, -602.1339131166317, -422.07319115617565, -614.506937643913, -761.712107716466, -842.6942398734966, -1000.497204377166, -669.4388975484943, -815.409749115435, -840.1285586037965, -698.5992490274338, -644.476647946576, -633.0322119208028, -734.0477893965939, -893.597434064373, -878.3842015122432, -777.7866167472084, -794.3839637978729, -834.4778394614882, -436.7975754677551, -892.7292495246536, -938.229323055449, -740.8946199876059, -657.4388919129041, -919.5575899922369, -656.1244389699065, -563.0452535038455, -491.3412702844287, -1120.0412274475445, -816.4275686934928, -691.7660064826232, -672.150304929537, -743.7823698198567, -990.6073427430988, -784.0213245033037, -779.8132443920898, -526.7318438888908, -559.9690290628494, -807.9656203244913, -853.2066580917271, -773.5155461170024, -1087.0730426597029, -697.8259461069835, -711.2352334562752, -928.5001612789654, -1128.8663733947067, -697.1080027422427, -651.0406053492508, -817.6958478805825, -606.2983100992903, -681.0746717262585], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 21.11202589040287, "mean_inference_ms": 0.4005608477204804, "mean_action_processing_ms": 0.09567927028344483, "mean_env_wait_ms": 2.727081938168786, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003940582275390625, "StateBufferConnector_ms": 0.002743244171142578, "ViewRequirementAgentConnector_ms": 0.0677032470703125}}, "episode_reward_max": -372.95108488290157, "episode_reward_min": -1128.8663733947067, "episode_reward_mean": -759.2220337067206, "episode_len_mean": 120.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1019.7576467496582, -664.5709938593048, -936.9607098420689, -871.798614723867, -660.2346934523323, -1061.236532504413, -774.3954205921513, -653.4828762318899, -563.6321968465464, -772.215125564206, -597.1356022073888, -916.0224813313109, -561.9032764442976, -664.1706291159477, -517.6571415124315, -665.43517218797, -847.0364730522632, -1009.3836856419699, -1007.4155842446473, -724.2261311856754, -851.6414341486135, -909.5470207696831, -602.1261372289888, -798.4171560533446, -469.77912058090806, -783.9063774070419, -853.6153943966289, -918.3906420086815, -744.0703634619459, -929.5034414758214, -869.8693057377583, -1054.3763231450537, -855.9006586799028, -396.6681276166806, -847.4771024005569, -487.6919661244689, -1074.0655165585595, -862.3046350434795, -886.8203085420723, -765.6586412991363, -807.8731827753852, -707.1276720706901, -860.4054162943373, -494.5540310286478, -714.0637766213503, -606.6292102687963, -550.5561280878185, -372.95108488290157, -626.4212595579489, -850.8657021988108, -602.1339131166317, -422.07319115617565, -614.506937643913, -761.712107716466, -842.6942398734966, -1000.497204377166, -669.4388975484943, -815.409749115435, -840.1285586037965, -698.5992490274338, -644.476647946576, -633.0322119208028, -734.0477893965939, -893.597434064373, -878.3842015122432, -777.7866167472084, -794.3839637978729, -834.4778394614882, -436.7975754677551, -892.7292495246536, -938.229323055449, -740.8946199876059, -657.4388919129041, -919.5575899922369, -656.1244389699065, -563.0452535038455, -491.3412702844287, -1120.0412274475445, -816.4275686934928, -691.7660064826232, -672.150304929537, -743.7823698198567, -990.6073427430988, -784.0213245033037, -779.8132443920898, -526.7318438888908, -559.9690290628494, -807.9656203244913, -853.2066580917271, -773.5155461170024, -1087.0730426597029, -697.8259461069835, -711.2352334562752, -928.5001612789654, -1128.8663733947067, -697.1080027422427, -651.0406053492508, -817.6958478805825, -606.2983100992903, -681.0746717262585], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 21.11202589040287, "mean_inference_ms": 0.4005608477204804, "mean_action_processing_ms": 0.09567927028344483, "mean_env_wait_ms": 2.727081938168786, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003940582275390625, "StateBufferConnector_ms": 0.002743244171142578, "ViewRequirementAgentConnector_ms": 0.0677032470703125}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 262680, "num_agent_steps_trained": 262680, "num_env_steps_sampled": 262680, "num_env_steps_trained": 262680, "num_env_steps_sampled_this_iter": 480, "num_env_steps_trained_this_iter": 480, "num_env_steps_sampled_throughput_per_sec": 40.97944589428789, "num_env_steps_trained_throughput_per_sec": 40.97944589428789, "timesteps_total": 262680, "num_steps_trained_this_iter": 480, "agent_timesteps_total": 262680, "timers": {"training_iteration_time_ms": 2937.516, "sample_time_ms": 2933.631, "load_time_ms": 0.225, "load_throughput": 533852.864, "learn_time_ms": 2.869, "learn_throughput": 41821.409, "synch_weights_time_ms": 0.74}, "counters": {"num_env_steps_sampled": 262680, "num_env_steps_trained": 262680, "num_agent_steps_sampled": 262680, "num_agent_steps_trained": 262680}, "done": false, "episodes_total": 2189, "training_iteration": 548, "trial_id": "29a31_00000", "date": "2023-07-26_02-40-04", "timestamp": 1690328404, "time_this_iter_s": 11.71651291847229, "time_total_s": 6650.056912183762, "pid": 90822, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 1, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[253680, 5e-06], [256080, 5e-06], [258480, 2.5e-06], [260880, 2.5e-06], [263280, 2.5e-06], [265680, 2.5e-06], [268080, 1e-06], [270480, 1e-06], [272880, 1e-06], [275280, 5e-07], [277680, 5e-07], [280080, 5e-07], [282480, 5e-07], [284880, 5e-07], [287280, 1e-07], [289680, 1e-07], [292080, 1e-07]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 120, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x16ca65700>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1028.731436252594, "iterations_since_restore": 88, "perf": {"cpu_util_percent": 35.77647058823529, "ram_util_percent": 75.80588235294118}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 2.5e-06, "entropy_coeff": 0.05, "policy_entropy": 266.4581604003906, "policy_loss": -73284.7578125, "vf_loss": 2915104.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 355.0, "diff_num_grad_updates_vs_sampler_policy": 354.0}}, "num_env_steps_sampled": 263160, "num_env_steps_trained": 263160, "num_agent_steps_sampled": 263160, "num_agent_steps_trained": 263160}, "sampler_results": {"episode_reward_max": -372.95108488290157, "episode_reward_min": -1128.8663733947067, "episode_reward_mean": -755.8216772556682, "episode_len_mean": 120.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-660.2346934523323, -1061.236532504413, -774.3954205921513, -653.4828762318899, -563.6321968465464, -772.215125564206, -597.1356022073888, -916.0224813313109, -561.9032764442976, -664.1706291159477, -517.6571415124315, -665.43517218797, -847.0364730522632, -1009.3836856419699, -1007.4155842446473, -724.2261311856754, -851.6414341486135, -909.5470207696831, -602.1261372289888, -798.4171560533446, -469.77912058090806, -783.9063774070419, -853.6153943966289, -918.3906420086815, -744.0703634619459, -929.5034414758214, -869.8693057377583, -1054.3763231450537, -855.9006586799028, -396.6681276166806, -847.4771024005569, -487.6919661244689, -1074.0655165585595, -862.3046350434795, -886.8203085420723, -765.6586412991363, -807.8731827753852, -707.1276720706901, -860.4054162943373, -494.5540310286478, -714.0637766213503, -606.6292102687963, -550.5561280878185, -372.95108488290157, -626.4212595579489, -850.8657021988108, -602.1339131166317, -422.07319115617565, -614.506937643913, -761.712107716466, -842.6942398734966, -1000.497204377166, -669.4388975484943, -815.409749115435, -840.1285586037965, -698.5992490274338, -644.476647946576, -633.0322119208028, -734.0477893965939, -893.597434064373, -878.3842015122432, -777.7866167472084, -794.3839637978729, -834.4778394614882, -436.7975754677551, -892.7292495246536, -938.229323055449, -740.8946199876059, -657.4388919129041, -919.5575899922369, -656.1244389699065, -563.0452535038455, -491.3412702844287, -1120.0412274475445, -816.4275686934928, -691.7660064826232, -672.150304929537, -743.7823698198567, -990.6073427430988, -784.0213245033037, -779.8132443920898, -526.7318438888908, -559.9690290628494, -807.9656203244913, -853.2066580917271, -773.5155461170024, -1087.0730426597029, -697.8259461069835, -711.2352334562752, -928.5001612789654, -1128.8663733947067, -697.1080027422427, -651.0406053492508, -817.6958478805825, -606.2983100992903, -681.0746717262585, -816.8936860624655, -706.4786605700737, -1044.5855233606906, -585.0944500764128], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 21.112862066560112, "mean_inference_ms": 0.4005630647654369, "mean_action_processing_ms": 0.09567924791076107, "mean_env_wait_ms": 2.7262008351594353, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003949642181396484, "StateBufferConnector_ms": 0.0027582645416259766, "ViewRequirementAgentConnector_ms": 0.06779289245605469}}, "episode_reward_max": -372.95108488290157, "episode_reward_min": -1128.8663733947067, "episode_reward_mean": -755.8216772556682, "episode_len_mean": 120.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-660.2346934523323, -1061.236532504413, -774.3954205921513, -653.4828762318899, -563.6321968465464, -772.215125564206, -597.1356022073888, -916.0224813313109, -561.9032764442976, -664.1706291159477, -517.6571415124315, -665.43517218797, -847.0364730522632, -1009.3836856419699, -1007.4155842446473, -724.2261311856754, -851.6414341486135, -909.5470207696831, -602.1261372289888, -798.4171560533446, -469.77912058090806, -783.9063774070419, -853.6153943966289, -918.3906420086815, -744.0703634619459, -929.5034414758214, -869.8693057377583, -1054.3763231450537, -855.9006586799028, -396.6681276166806, -847.4771024005569, -487.6919661244689, -1074.0655165585595, -862.3046350434795, -886.8203085420723, -765.6586412991363, -807.8731827753852, -707.1276720706901, -860.4054162943373, -494.5540310286478, -714.0637766213503, -606.6292102687963, -550.5561280878185, -372.95108488290157, -626.4212595579489, -850.8657021988108, -602.1339131166317, -422.07319115617565, -614.506937643913, -761.712107716466, -842.6942398734966, -1000.497204377166, -669.4388975484943, -815.409749115435, -840.1285586037965, -698.5992490274338, -644.476647946576, -633.0322119208028, -734.0477893965939, -893.597434064373, -878.3842015122432, -777.7866167472084, -794.3839637978729, -834.4778394614882, -436.7975754677551, -892.7292495246536, -938.229323055449, -740.8946199876059, -657.4388919129041, -919.5575899922369, -656.1244389699065, -563.0452535038455, -491.3412702844287, -1120.0412274475445, -816.4275686934928, -691.7660064826232, -672.150304929537, -743.7823698198567, -990.6073427430988, -784.0213245033037, -779.8132443920898, -526.7318438888908, -559.9690290628494, -807.9656203244913, -853.2066580917271, -773.5155461170024, -1087.0730426597029, -697.8259461069835, -711.2352334562752, -928.5001612789654, -1128.8663733947067, -697.1080027422427, -651.0406053492508, -817.6958478805825, -606.2983100992903, -681.0746717262585, -816.8936860624655, -706.4786605700737, -1044.5855233606906, -585.0944500764128], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 21.112862066560112, "mean_inference_ms": 0.4005630647654369, "mean_action_processing_ms": 0.09567924791076107, "mean_env_wait_ms": 2.7262008351594353, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003949642181396484, "StateBufferConnector_ms": 0.0027582645416259766, "ViewRequirementAgentConnector_ms": 0.06779289245605469}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 263160, "num_agent_steps_trained": 263160, "num_env_steps_sampled": 263160, "num_env_steps_trained": 263160, "num_env_steps_sampled_this_iter": 480, "num_env_steps_trained_this_iter": 480, "num_env_steps_sampled_throughput_per_sec": 41.356012086439044, "num_env_steps_trained_throughput_per_sec": 41.356012086439044, "timesteps_total": 263160, "num_steps_trained_this_iter": 480, "agent_timesteps_total": 263160, "timers": {"training_iteration_time_ms": 2906.05, "sample_time_ms": 2902.288, "load_time_ms": 0.217, "load_throughput": 552912.754, "learn_time_ms": 2.78, "learn_throughput": 43173.114, "synch_weights_time_ms": 0.726}, "counters": {"num_env_steps_sampled": 263160, "num_env_steps_trained": 263160, "num_agent_steps_sampled": 263160, "num_agent_steps_trained": 263160}, "done": false, "episodes_total": 2193, "training_iteration": 549, "trial_id": "29a31_00000", "date": "2023-07-26_02-40-15", "timestamp": 1690328415, "time_this_iter_s": 11.60928988456726, "time_total_s": 6661.666202068329, "pid": 90822, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 1, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[253680, 5e-06], [256080, 5e-06], [258480, 2.5e-06], [260880, 2.5e-06], [263280, 2.5e-06], [265680, 2.5e-06], [268080, 1e-06], [270480, 1e-06], [272880, 1e-06], [275280, 5e-07], [277680, 5e-07], [280080, 5e-07], [282480, 5e-07], [284880, 5e-07], [287280, 1e-07], [289680, 1e-07], [292080, 1e-07]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 120, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x16ca65700>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1040.3407261371613, "iterations_since_restore": 89, "perf": {"cpu_util_percent": 39.006249999999994, "ram_util_percent": 75.95625000000001}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 2.5e-06, "entropy_coeff": 0.05, "policy_entropy": 266.3653259277344, "policy_loss": -120152.2578125, "vf_loss": 5563060.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 359.0, "diff_num_grad_updates_vs_sampler_policy": 358.0}}, "num_env_steps_sampled": 263640, "num_env_steps_trained": 263640, "num_agent_steps_sampled": 263640, "num_agent_steps_trained": 263640}, "sampler_results": {"episode_reward_max": -372.95108488290157, "episode_reward_min": -1128.8663733947067, "episode_reward_mean": -754.8630130011933, "episode_len_mean": 120.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-563.6321968465464, -772.215125564206, -597.1356022073888, -916.0224813313109, -561.9032764442976, -664.1706291159477, -517.6571415124315, -665.43517218797, -847.0364730522632, -1009.3836856419699, -1007.4155842446473, -724.2261311856754, -851.6414341486135, -909.5470207696831, -602.1261372289888, -798.4171560533446, -469.77912058090806, -783.9063774070419, -853.6153943966289, -918.3906420086815, -744.0703634619459, -929.5034414758214, -869.8693057377583, -1054.3763231450537, -855.9006586799028, -396.6681276166806, -847.4771024005569, -487.6919661244689, -1074.0655165585595, -862.3046350434795, -886.8203085420723, -765.6586412991363, -807.8731827753852, -707.1276720706901, -860.4054162943373, -494.5540310286478, -714.0637766213503, -606.6292102687963, -550.5561280878185, -372.95108488290157, -626.4212595579489, -850.8657021988108, -602.1339131166317, -422.07319115617565, -614.506937643913, -761.712107716466, -842.6942398734966, -1000.497204377166, -669.4388975484943, -815.409749115435, -840.1285586037965, -698.5992490274338, -644.476647946576, -633.0322119208028, -734.0477893965939, -893.597434064373, -878.3842015122432, -777.7866167472084, -794.3839637978729, -834.4778394614882, -436.7975754677551, -892.7292495246536, -938.229323055449, -740.8946199876059, -657.4388919129041, -919.5575899922369, -656.1244389699065, -563.0452535038455, -491.3412702844287, -1120.0412274475445, -816.4275686934928, -691.7660064826232, -672.150304929537, -743.7823698198567, -990.6073427430988, -784.0213245033037, -779.8132443920898, -526.7318438888908, -559.9690290628494, -807.9656203244913, -853.2066580917271, -773.5155461170024, -1087.0730426597029, -697.8259461069835, -711.2352334562752, -928.5001612789654, -1128.8663733947067, -697.1080027422427, -651.0406053492508, -817.6958478805825, -606.2983100992903, -681.0746717262585, -816.8936860624655, -706.4786605700737, -1044.5855233606906, -585.0944500764128, -385.0153366421304, -839.2397681819978, -975.8865490336793, -853.3414434755031], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 21.113858286783895, "mean_inference_ms": 0.40056982106007455, "mean_action_processing_ms": 0.09567973775673622, "mean_env_wait_ms": 2.725294270599974, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003949880599975586, "StateBufferConnector_ms": 0.002758502960205078, "ViewRequirementAgentConnector_ms": 0.0677950382232666}}, "episode_reward_max": -372.95108488290157, "episode_reward_min": -1128.8663733947067, "episode_reward_mean": -754.8630130011933, "episode_len_mean": 120.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-563.6321968465464, -772.215125564206, -597.1356022073888, -916.0224813313109, -561.9032764442976, -664.1706291159477, -517.6571415124315, -665.43517218797, -847.0364730522632, -1009.3836856419699, -1007.4155842446473, -724.2261311856754, -851.6414341486135, -909.5470207696831, -602.1261372289888, -798.4171560533446, -469.77912058090806, -783.9063774070419, -853.6153943966289, -918.3906420086815, -744.0703634619459, -929.5034414758214, -869.8693057377583, -1054.3763231450537, -855.9006586799028, -396.6681276166806, -847.4771024005569, -487.6919661244689, -1074.0655165585595, -862.3046350434795, -886.8203085420723, -765.6586412991363, -807.8731827753852, -707.1276720706901, -860.4054162943373, -494.5540310286478, -714.0637766213503, -606.6292102687963, -550.5561280878185, -372.95108488290157, -626.4212595579489, -850.8657021988108, -602.1339131166317, -422.07319115617565, -614.506937643913, -761.712107716466, -842.6942398734966, -1000.497204377166, -669.4388975484943, -815.409749115435, -840.1285586037965, -698.5992490274338, -644.476647946576, -633.0322119208028, -734.0477893965939, -893.597434064373, -878.3842015122432, -777.7866167472084, -794.3839637978729, -834.4778394614882, -436.7975754677551, -892.7292495246536, -938.229323055449, -740.8946199876059, -657.4388919129041, -919.5575899922369, -656.1244389699065, -563.0452535038455, -491.3412702844287, -1120.0412274475445, -816.4275686934928, -691.7660064826232, -672.150304929537, -743.7823698198567, -990.6073427430988, -784.0213245033037, -779.8132443920898, -526.7318438888908, -559.9690290628494, -807.9656203244913, -853.2066580917271, -773.5155461170024, -1087.0730426597029, -697.8259461069835, -711.2352334562752, -928.5001612789654, -1128.8663733947067, -697.1080027422427, -651.0406053492508, -817.6958478805825, -606.2983100992903, -681.0746717262585, -816.8936860624655, -706.4786605700737, -1044.5855233606906, -585.0944500764128, -385.0153366421304, -839.2397681819978, -975.8865490336793, -853.3414434755031], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 21.113858286783895, "mean_inference_ms": 0.40056982106007455, "mean_action_processing_ms": 0.09567973775673622, "mean_env_wait_ms": 2.725294270599974, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003949880599975586, "StateBufferConnector_ms": 0.002758502960205078, "ViewRequirementAgentConnector_ms": 0.0677950382232666}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 263640, "num_agent_steps_trained": 263640, "num_env_steps_sampled": 263640, "num_env_steps_trained": 263640, "num_env_steps_sampled_this_iter": 480, "num_env_steps_trained_this_iter": 480, "num_env_steps_sampled_throughput_per_sec": 40.13292389735501, "num_env_steps_trained_throughput_per_sec": 40.13292389735501, "timesteps_total": 263640, "num_steps_trained_this_iter": 480, "agent_timesteps_total": 263640, "timers": {"training_iteration_time_ms": 2946.901, "sample_time_ms": 2943.162, "load_time_ms": 0.217, "load_throughput": 553947.26, "learn_time_ms": 2.766, "learn_throughput": 43390.1, "synch_weights_time_ms": 0.716}, "counters": {"num_env_steps_sampled": 263640, "num_env_steps_trained": 263640, "num_agent_steps_sampled": 263640, "num_agent_steps_trained": 263640}, "done": false, "episodes_total": 2197, "training_iteration": 550, "trial_id": "29a31_00000", "date": "2023-07-26_02-40-27", "timestamp": 1690328427, "time_this_iter_s": 11.963015794754028, "time_total_s": 6673.629217863083, "pid": 90822, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 1, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[253680, 5e-06], [256080, 5e-06], [258480, 2.5e-06], [260880, 2.5e-06], [263280, 2.5e-06], [265680, 2.5e-06], [268080, 1e-06], [270480, 1e-06], [272880, 1e-06], [275280, 5e-07], [277680, 5e-07], [280080, 5e-07], [282480, 5e-07], [284880, 5e-07], [287280, 1e-07], [289680, 1e-07], [292080, 1e-07]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 120, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x16ca65700>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1052.3037419319153, "iterations_since_restore": 90, "perf": {"cpu_util_percent": 38.211764705882345, "ram_util_percent": 74.08823529411765}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 2.5e-06, "entropy_coeff": 0.05, "policy_entropy": 266.2680969238281, "policy_loss": -112739.8203125, "vf_loss": 5734822.5}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 363.0, "diff_num_grad_updates_vs_sampler_policy": 362.0}}, "num_env_steps_sampled": 264120, "num_env_steps_trained": 264120, "num_agent_steps_sampled": 264120, "num_agent_steps_trained": 264120}, "sampler_results": {"episode_reward_max": -372.95108488290157, "episode_reward_min": -1128.8663733947067, "episode_reward_mean": -764.0854424635805, "episode_len_mean": 120.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-561.9032764442976, -664.1706291159477, -517.6571415124315, -665.43517218797, -847.0364730522632, -1009.3836856419699, -1007.4155842446473, -724.2261311856754, -851.6414341486135, -909.5470207696831, -602.1261372289888, -798.4171560533446, -469.77912058090806, -783.9063774070419, -853.6153943966289, -918.3906420086815, -744.0703634619459, -929.5034414758214, -869.8693057377583, -1054.3763231450537, -855.9006586799028, -396.6681276166806, -847.4771024005569, -487.6919661244689, -1074.0655165585595, -862.3046350434795, -886.8203085420723, -765.6586412991363, -807.8731827753852, -707.1276720706901, -860.4054162943373, -494.5540310286478, -714.0637766213503, -606.6292102687963, -550.5561280878185, -372.95108488290157, -626.4212595579489, -850.8657021988108, -602.1339131166317, -422.07319115617565, -614.506937643913, -761.712107716466, -842.6942398734966, -1000.497204377166, -669.4388975484943, -815.409749115435, -840.1285586037965, -698.5992490274338, -644.476647946576, -633.0322119208028, -734.0477893965939, -893.597434064373, -878.3842015122432, -777.7866167472084, -794.3839637978729, -834.4778394614882, -436.7975754677551, -892.7292495246536, -938.229323055449, -740.8946199876059, -657.4388919129041, -919.5575899922369, -656.1244389699065, -563.0452535038455, -491.3412702844287, -1120.0412274475445, -816.4275686934928, -691.7660064826232, -672.150304929537, -743.7823698198567, -990.6073427430988, -784.0213245033037, -779.8132443920898, -526.7318438888908, -559.9690290628494, -807.9656203244913, -853.2066580917271, -773.5155461170024, -1087.0730426597029, -697.8259461069835, -711.2352334562752, -928.5001612789654, -1128.8663733947067, -697.1080027422427, -651.0406053492508, -817.6958478805825, -606.2983100992903, -681.0746717262585, -816.8936860624655, -706.4786605700737, -1044.5855233606906, -585.0944500764128, -385.0153366421304, -839.2397681819978, -975.8865490336793, -853.3414434755031, -912.9648169829818, -1108.4090223671267, -879.6547428146221, -870.2197700234386], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 21.115052209941954, "mean_inference_ms": 0.40057476891661026, "mean_action_processing_ms": 0.09567977105740705, "mean_env_wait_ms": 2.7244546897812927, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0039196014404296875, "StateBufferConnector_ms": 0.0027527809143066406, "ViewRequirementAgentConnector_ms": 0.06747317314147949}}, "episode_reward_max": -372.95108488290157, "episode_reward_min": -1128.8663733947067, "episode_reward_mean": -764.0854424635805, "episode_len_mean": 120.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-561.9032764442976, -664.1706291159477, -517.6571415124315, -665.43517218797, -847.0364730522632, -1009.3836856419699, -1007.4155842446473, -724.2261311856754, -851.6414341486135, -909.5470207696831, -602.1261372289888, -798.4171560533446, -469.77912058090806, -783.9063774070419, -853.6153943966289, -918.3906420086815, -744.0703634619459, -929.5034414758214, -869.8693057377583, -1054.3763231450537, -855.9006586799028, -396.6681276166806, -847.4771024005569, -487.6919661244689, -1074.0655165585595, -862.3046350434795, -886.8203085420723, -765.6586412991363, -807.8731827753852, -707.1276720706901, -860.4054162943373, -494.5540310286478, -714.0637766213503, -606.6292102687963, -550.5561280878185, -372.95108488290157, -626.4212595579489, -850.8657021988108, -602.1339131166317, -422.07319115617565, -614.506937643913, -761.712107716466, -842.6942398734966, -1000.497204377166, -669.4388975484943, -815.409749115435, -840.1285586037965, -698.5992490274338, -644.476647946576, -633.0322119208028, -734.0477893965939, -893.597434064373, -878.3842015122432, -777.7866167472084, -794.3839637978729, -834.4778394614882, -436.7975754677551, -892.7292495246536, -938.229323055449, -740.8946199876059, -657.4388919129041, -919.5575899922369, -656.1244389699065, -563.0452535038455, -491.3412702844287, -1120.0412274475445, -816.4275686934928, -691.7660064826232, -672.150304929537, -743.7823698198567, -990.6073427430988, -784.0213245033037, -779.8132443920898, -526.7318438888908, -559.9690290628494, -807.9656203244913, -853.2066580917271, -773.5155461170024, -1087.0730426597029, -697.8259461069835, -711.2352334562752, -928.5001612789654, -1128.8663733947067, -697.1080027422427, -651.0406053492508, -817.6958478805825, -606.2983100992903, -681.0746717262585, -816.8936860624655, -706.4786605700737, -1044.5855233606906, -585.0944500764128, -385.0153366421304, -839.2397681819978, -975.8865490336793, -853.3414434755031, -912.9648169829818, -1108.4090223671267, -879.6547428146221, -870.2197700234386], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 21.115052209941954, "mean_inference_ms": 0.40057476891661026, "mean_action_processing_ms": 0.09567977105740705, "mean_env_wait_ms": 2.7244546897812927, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0039196014404296875, "StateBufferConnector_ms": 0.0027527809143066406, "ViewRequirementAgentConnector_ms": 0.06747317314147949}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 264120, "num_agent_steps_trained": 264120, "num_env_steps_sampled": 264120, "num_env_steps_trained": 264120, "num_env_steps_sampled_this_iter": 480, "num_env_steps_trained_this_iter": 480, "num_env_steps_sampled_throughput_per_sec": 40.61384366255964, "num_env_steps_trained_throughput_per_sec": 40.61384366255964, "timesteps_total": 264120, "num_steps_trained_this_iter": 480, "agent_timesteps_total": 264120, "timers": {"training_iteration_time_ms": 2960.833, "sample_time_ms": 2957.104, "load_time_ms": 0.216, "load_throughput": 555108.062, "learn_time_ms": 2.756, "learn_throughput": 43545.138, "synch_weights_time_ms": 0.717}, "counters": {"num_env_steps_sampled": 264120, "num_env_steps_trained": 264120, "num_agent_steps_sampled": 264120, "num_agent_steps_trained": 264120}, "done": false, "episodes_total": 2201, "training_iteration": 551, "trial_id": "29a31_00000", "date": "2023-07-26_02-40-39", "timestamp": 1690328439, "time_this_iter_s": 11.821329116821289, "time_total_s": 6685.450546979904, "pid": 90822, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 1, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[253680, 5e-06], [256080, 5e-06], [258480, 2.5e-06], [260880, 2.5e-06], [263280, 2.5e-06], [265680, 2.5e-06], [268080, 1e-06], [270480, 1e-06], [272880, 1e-06], [275280, 5e-07], [277680, 5e-07], [280080, 5e-07], [282480, 5e-07], [284880, 5e-07], [287280, 1e-07], [289680, 1e-07], [292080, 1e-07]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 120, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x16ca65700>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1064.1250710487366, "iterations_since_restore": 91, "perf": {"cpu_util_percent": 38.15882352941176, "ram_util_percent": 74.78823529411764}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 2.5e-06, "entropy_coeff": 0.05, "policy_entropy": 266.107666015625, "policy_loss": -101673.6796875, "vf_loss": 4373171.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 367.0, "diff_num_grad_updates_vs_sampler_policy": 366.0}}, "num_env_steps_sampled": 264600, "num_env_steps_trained": 264600, "num_agent_steps_sampled": 264600, "num_agent_steps_trained": 264600}, "sampler_results": {"episode_reward_max": -372.95108488290157, "episode_reward_min": -1128.8663733947067, "episode_reward_mean": -772.7140993370056, "episode_len_mean": 120.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-847.0364730522632, -1009.3836856419699, -1007.4155842446473, -724.2261311856754, -851.6414341486135, -909.5470207696831, -602.1261372289888, -798.4171560533446, -469.77912058090806, -783.9063774070419, -853.6153943966289, -918.3906420086815, -744.0703634619459, -929.5034414758214, -869.8693057377583, -1054.3763231450537, -855.9006586799028, -396.6681276166806, -847.4771024005569, -487.6919661244689, -1074.0655165585595, -862.3046350434795, -886.8203085420723, -765.6586412991363, -807.8731827753852, -707.1276720706901, -860.4054162943373, -494.5540310286478, -714.0637766213503, -606.6292102687963, -550.5561280878185, -372.95108488290157, -626.4212595579489, -850.8657021988108, -602.1339131166317, -422.07319115617565, -614.506937643913, -761.712107716466, -842.6942398734966, -1000.497204377166, -669.4388975484943, -815.409749115435, -840.1285586037965, -698.5992490274338, -644.476647946576, -633.0322119208028, -734.0477893965939, -893.597434064373, -878.3842015122432, -777.7866167472084, -794.3839637978729, -834.4778394614882, -436.7975754677551, -892.7292495246536, -938.229323055449, -740.8946199876059, -657.4388919129041, -919.5575899922369, -656.1244389699065, -563.0452535038455, -491.3412702844287, -1120.0412274475445, -816.4275686934928, -691.7660064826232, -672.150304929537, -743.7823698198567, -990.6073427430988, -784.0213245033037, -779.8132443920898, -526.7318438888908, -559.9690290628494, -807.9656203244913, -853.2066580917271, -773.5155461170024, -1087.0730426597029, -697.8259461069835, -711.2352334562752, -928.5001612789654, -1128.8663733947067, -697.1080027422427, -651.0406053492508, -817.6958478805825, -606.2983100992903, -681.0746717262585, -816.8936860624655, -706.4786605700737, -1044.5855233606906, -585.0944500764128, -385.0153366421304, -839.2397681819978, -975.8865490336793, -853.3414434755031, -912.9648169829818, -1108.4090223671267, -879.6547428146221, -870.2197700234386, -603.7880686842849, -1053.0806957298885, -801.9626659898719, -813.2004761991038], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 21.116280531291007, "mean_inference_ms": 0.40057476811246145, "mean_action_processing_ms": 0.0956788957999613, "mean_env_wait_ms": 2.7236507616973507, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0039141178131103516, "StateBufferConnector_ms": 0.0027511119842529297, "ViewRequirementAgentConnector_ms": 0.06743264198303223}}, "episode_reward_max": -372.95108488290157, "episode_reward_min": -1128.8663733947067, "episode_reward_mean": -772.7140993370056, "episode_len_mean": 120.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-847.0364730522632, -1009.3836856419699, -1007.4155842446473, -724.2261311856754, -851.6414341486135, -909.5470207696831, -602.1261372289888, -798.4171560533446, -469.77912058090806, -783.9063774070419, -853.6153943966289, -918.3906420086815, -744.0703634619459, -929.5034414758214, -869.8693057377583, -1054.3763231450537, -855.9006586799028, -396.6681276166806, -847.4771024005569, -487.6919661244689, -1074.0655165585595, -862.3046350434795, -886.8203085420723, -765.6586412991363, -807.8731827753852, -707.1276720706901, -860.4054162943373, -494.5540310286478, -714.0637766213503, -606.6292102687963, -550.5561280878185, -372.95108488290157, -626.4212595579489, -850.8657021988108, -602.1339131166317, -422.07319115617565, -614.506937643913, -761.712107716466, -842.6942398734966, -1000.497204377166, -669.4388975484943, -815.409749115435, -840.1285586037965, -698.5992490274338, -644.476647946576, -633.0322119208028, -734.0477893965939, -893.597434064373, -878.3842015122432, -777.7866167472084, -794.3839637978729, -834.4778394614882, -436.7975754677551, -892.7292495246536, -938.229323055449, -740.8946199876059, -657.4388919129041, -919.5575899922369, -656.1244389699065, -563.0452535038455, -491.3412702844287, -1120.0412274475445, -816.4275686934928, -691.7660064826232, -672.150304929537, -743.7823698198567, -990.6073427430988, -784.0213245033037, -779.8132443920898, -526.7318438888908, -559.9690290628494, -807.9656203244913, -853.2066580917271, -773.5155461170024, -1087.0730426597029, -697.8259461069835, -711.2352334562752, -928.5001612789654, -1128.8663733947067, -697.1080027422427, -651.0406053492508, -817.6958478805825, -606.2983100992903, -681.0746717262585, -816.8936860624655, -706.4786605700737, -1044.5855233606906, -585.0944500764128, -385.0153366421304, -839.2397681819978, -975.8865490336793, -853.3414434755031, -912.9648169829818, -1108.4090223671267, -879.6547428146221, -870.2197700234386, -603.7880686842849, -1053.0806957298885, -801.9626659898719, -813.2004761991038], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 21.116280531291007, "mean_inference_ms": 0.40057476811246145, "mean_action_processing_ms": 0.0956788957999613, "mean_env_wait_ms": 2.7236507616973507, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0039141178131103516, "StateBufferConnector_ms": 0.0027511119842529297, "ViewRequirementAgentConnector_ms": 0.06743264198303223}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 264600, "num_agent_steps_trained": 264600, "num_env_steps_sampled": 264600, "num_env_steps_trained": 264600, "num_env_steps_sampled_this_iter": 480, "num_env_steps_trained_this_iter": 480, "num_env_steps_sampled_throughput_per_sec": 41.771461112763006, "num_env_steps_trained_throughput_per_sec": 41.771461112763006, "timesteps_total": 264600, "num_steps_trained_this_iter": 480, "agent_timesteps_total": 264600, "timers": {"training_iteration_time_ms": 2917.389, "sample_time_ms": 2913.61, "load_time_ms": 0.224, "load_throughput": 535728.026, "learn_time_ms": 2.797, "learn_throughput": 42906.286, "synch_weights_time_ms": 0.712}, "counters": {"num_env_steps_sampled": 264600, "num_env_steps_trained": 264600, "num_agent_steps_sampled": 264600, "num_agent_steps_trained": 264600}, "done": false, "episodes_total": 2205, "training_iteration": 552, "trial_id": "29a31_00000", "date": "2023-07-26_02-40-51", "timestamp": 1690328451, "time_this_iter_s": 11.493810176849365, "time_total_s": 6696.9443571567535, "pid": 90822, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 1, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[253680, 5e-06], [256080, 5e-06], [258480, 2.5e-06], [260880, 2.5e-06], [263280, 2.5e-06], [265680, 2.5e-06], [268080, 1e-06], [270480, 1e-06], [272880, 1e-06], [275280, 5e-07], [277680, 5e-07], [280080, 5e-07], [282480, 5e-07], [284880, 5e-07], [287280, 1e-07], [289680, 1e-07], [292080, 1e-07]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 120, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x16ca65700>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1075.618881225586, "iterations_since_restore": 92, "perf": {"cpu_util_percent": 33.574999999999996, "ram_util_percent": 74.55000000000001}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 2.5e-06, "entropy_coeff": 0.05, "policy_entropy": 266.0002746582031, "policy_loss": -89366.359375, "vf_loss": 3473920.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 371.0, "diff_num_grad_updates_vs_sampler_policy": 370.0}}, "num_env_steps_sampled": 265080, "num_env_steps_trained": 265080, "num_agent_steps_sampled": 265080, "num_agent_steps_trained": 265080}, "sampler_results": {"episode_reward_max": -372.95108488290157, "episode_reward_min": -1128.8663733947067, "episode_reward_mean": -760.5756235454778, "episode_len_mean": 120.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-851.6414341486135, -909.5470207696831, -602.1261372289888, -798.4171560533446, -469.77912058090806, -783.9063774070419, -853.6153943966289, -918.3906420086815, -744.0703634619459, -929.5034414758214, -869.8693057377583, -1054.3763231450537, -855.9006586799028, -396.6681276166806, -847.4771024005569, -487.6919661244689, -1074.0655165585595, -862.3046350434795, -886.8203085420723, -765.6586412991363, -807.8731827753852, -707.1276720706901, -860.4054162943373, -494.5540310286478, -714.0637766213503, -606.6292102687963, -550.5561280878185, -372.95108488290157, -626.4212595579489, -850.8657021988108, -602.1339131166317, -422.07319115617565, -614.506937643913, -761.712107716466, -842.6942398734966, -1000.497204377166, -669.4388975484943, -815.409749115435, -840.1285586037965, -698.5992490274338, -644.476647946576, -633.0322119208028, -734.0477893965939, -893.597434064373, -878.3842015122432, -777.7866167472084, -794.3839637978729, -834.4778394614882, -436.7975754677551, -892.7292495246536, -938.229323055449, -740.8946199876059, -657.4388919129041, -919.5575899922369, -656.1244389699065, -563.0452535038455, -491.3412702844287, -1120.0412274475445, -816.4275686934928, -691.7660064826232, -672.150304929537, -743.7823698198567, -990.6073427430988, -784.0213245033037, -779.8132443920898, -526.7318438888908, -559.9690290628494, -807.9656203244913, -853.2066580917271, -773.5155461170024, -1087.0730426597029, -697.8259461069835, -711.2352334562752, -928.5001612789654, -1128.8663733947067, -697.1080027422427, -651.0406053492508, -817.6958478805825, -606.2983100992903, -681.0746717262585, -816.8936860624655, -706.4786605700737, -1044.5855233606906, -585.0944500764128, -385.0153366421304, -839.2397681819978, -975.8865490336793, -853.3414434755031, -912.9648169829818, -1108.4090223671267, -879.6547428146221, -870.2197700234386, -603.7880686842849, -1053.0806957298885, -801.9626659898719, -813.2004761991038, -390.28266894907233, -787.5212111763349, -620.2969929910752, -576.1134218552871], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 21.117430075109436, "mean_inference_ms": 0.4005646823265681, "mean_action_processing_ms": 0.09567614013187516, "mean_env_wait_ms": 2.7228105684240154, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0038957595825195312, "StateBufferConnector_ms": 0.002736330032348633, "ViewRequirementAgentConnector_ms": 0.06713461875915527}}, "episode_reward_max": -372.95108488290157, "episode_reward_min": -1128.8663733947067, "episode_reward_mean": -760.5756235454778, "episode_len_mean": 120.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-851.6414341486135, -909.5470207696831, -602.1261372289888, -798.4171560533446, -469.77912058090806, -783.9063774070419, -853.6153943966289, -918.3906420086815, -744.0703634619459, -929.5034414758214, -869.8693057377583, -1054.3763231450537, -855.9006586799028, -396.6681276166806, -847.4771024005569, -487.6919661244689, -1074.0655165585595, -862.3046350434795, -886.8203085420723, -765.6586412991363, -807.8731827753852, -707.1276720706901, -860.4054162943373, -494.5540310286478, -714.0637766213503, -606.6292102687963, -550.5561280878185, -372.95108488290157, -626.4212595579489, -850.8657021988108, -602.1339131166317, -422.07319115617565, -614.506937643913, -761.712107716466, -842.6942398734966, -1000.497204377166, -669.4388975484943, -815.409749115435, -840.1285586037965, -698.5992490274338, -644.476647946576, -633.0322119208028, -734.0477893965939, -893.597434064373, -878.3842015122432, -777.7866167472084, -794.3839637978729, -834.4778394614882, -436.7975754677551, -892.7292495246536, -938.229323055449, -740.8946199876059, -657.4388919129041, -919.5575899922369, -656.1244389699065, -563.0452535038455, -491.3412702844287, -1120.0412274475445, -816.4275686934928, -691.7660064826232, -672.150304929537, -743.7823698198567, -990.6073427430988, -784.0213245033037, -779.8132443920898, -526.7318438888908, -559.9690290628494, -807.9656203244913, -853.2066580917271, -773.5155461170024, -1087.0730426597029, -697.8259461069835, -711.2352334562752, -928.5001612789654, -1128.8663733947067, -697.1080027422427, -651.0406053492508, -817.6958478805825, -606.2983100992903, -681.0746717262585, -816.8936860624655, -706.4786605700737, -1044.5855233606906, -585.0944500764128, -385.0153366421304, -839.2397681819978, -975.8865490336793, -853.3414434755031, -912.9648169829818, -1108.4090223671267, -879.6547428146221, -870.2197700234386, -603.7880686842849, -1053.0806957298885, -801.9626659898719, -813.2004761991038, -390.28266894907233, -787.5212111763349, -620.2969929910752, -576.1134218552871], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 21.117430075109436, "mean_inference_ms": 0.4005646823265681, "mean_action_processing_ms": 0.09567614013187516, "mean_env_wait_ms": 2.7228105684240154, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0038957595825195312, "StateBufferConnector_ms": 0.002736330032348633, "ViewRequirementAgentConnector_ms": 0.06713461875915527}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 265080, "num_agent_steps_trained": 265080, "num_env_steps_sampled": 265080, "num_env_steps_trained": 265080, "num_env_steps_sampled_this_iter": 480, "num_env_steps_trained_this_iter": 480, "num_env_steps_sampled_throughput_per_sec": 41.55283721643496, "num_env_steps_trained_throughput_per_sec": 41.55283721643496, "timesteps_total": 265080, "num_steps_trained_this_iter": 480, "agent_timesteps_total": 265080, "timers": {"training_iteration_time_ms": 2887.152, "sample_time_ms": 2883.361, "load_time_ms": 0.224, "load_throughput": 534703.58, "learn_time_ms": 2.808, "learn_throughput": 42730.709, "synch_weights_time_ms": 0.713}, "counters": {"num_env_steps_sampled": 265080, "num_env_steps_trained": 265080, "num_agent_steps_sampled": 265080, "num_agent_steps_trained": 265080}, "done": false, "episodes_total": 2209, "training_iteration": 553, "trial_id": "29a31_00000", "date": "2023-07-26_02-41-02", "timestamp": 1690328462, "time_this_iter_s": 11.55423903465271, "time_total_s": 6708.498596191406, "pid": 90822, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 1, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[253680, 5e-06], [256080, 5e-06], [258480, 2.5e-06], [260880, 2.5e-06], [263280, 2.5e-06], [265680, 2.5e-06], [268080, 1e-06], [270480, 1e-06], [272880, 1e-06], [275280, 5e-07], [277680, 5e-07], [280080, 5e-07], [282480, 5e-07], [284880, 5e-07], [287280, 1e-07], [289680, 1e-07], [292080, 1e-07]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 120, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x16ca65700>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1087.1731202602386, "iterations_since_restore": 93, "perf": {"cpu_util_percent": 33.75, "ram_util_percent": 72.13125}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 2.5e-06, "entropy_coeff": 0.05, "policy_entropy": 265.9285583496094, "policy_loss": -75642.875, "vf_loss": 2413702.5}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 375.0, "diff_num_grad_updates_vs_sampler_policy": 374.0}}, "num_env_steps_sampled": 265560, "num_env_steps_trained": 265560, "num_agent_steps_sampled": 265560, "num_agent_steps_trained": 265560}, "sampler_results": {"episode_reward_max": -372.95108488290157, "episode_reward_min": -1128.8663733947067, "episode_reward_mean": -756.3723415648918, "episode_len_mean": 120.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-469.77912058090806, -783.9063774070419, -853.6153943966289, -918.3906420086815, -744.0703634619459, -929.5034414758214, -869.8693057377583, -1054.3763231450537, -855.9006586799028, -396.6681276166806, -847.4771024005569, -487.6919661244689, -1074.0655165585595, -862.3046350434795, -886.8203085420723, -765.6586412991363, -807.8731827753852, -707.1276720706901, -860.4054162943373, -494.5540310286478, -714.0637766213503, -606.6292102687963, -550.5561280878185, -372.95108488290157, -626.4212595579489, -850.8657021988108, -602.1339131166317, -422.07319115617565, -614.506937643913, -761.712107716466, -842.6942398734966, -1000.497204377166, -669.4388975484943, -815.409749115435, -840.1285586037965, -698.5992490274338, -644.476647946576, -633.0322119208028, -734.0477893965939, -893.597434064373, -878.3842015122432, -777.7866167472084, -794.3839637978729, -834.4778394614882, -436.7975754677551, -892.7292495246536, -938.229323055449, -740.8946199876059, -657.4388919129041, -919.5575899922369, -656.1244389699065, -563.0452535038455, -491.3412702844287, -1120.0412274475445, -816.4275686934928, -691.7660064826232, -672.150304929537, -743.7823698198567, -990.6073427430988, -784.0213245033037, -779.8132443920898, -526.7318438888908, -559.9690290628494, -807.9656203244913, -853.2066580917271, -773.5155461170024, -1087.0730426597029, -697.8259461069835, -711.2352334562752, -928.5001612789654, -1128.8663733947067, -697.1080027422427, -651.0406053492508, -817.6958478805825, -606.2983100992903, -681.0746717262585, -816.8936860624655, -706.4786605700737, -1044.5855233606906, -585.0944500764128, -385.0153366421304, -839.2397681819978, -975.8865490336793, -853.3414434755031, -912.9648169829818, -1108.4090223671267, -879.6547428146221, -870.2197700234386, -603.7880686842849, -1053.0806957298885, -801.9626659898719, -813.2004761991038, -390.28266894907233, -787.5212111763349, -620.2969929910752, -576.1134218552871, -875.3310221140351, -784.3060011469621, -529.436838816755, -552.3296880642856], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 21.11835441139829, "mean_inference_ms": 0.4005629782575819, "mean_action_processing_ms": 0.09567516308088388, "mean_env_wait_ms": 2.721962283170259, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003908872604370117, "StateBufferConnector_ms": 0.00275421142578125, "ViewRequirementAgentConnector_ms": 0.06726598739624023}}, "episode_reward_max": -372.95108488290157, "episode_reward_min": -1128.8663733947067, "episode_reward_mean": -756.3723415648918, "episode_len_mean": 120.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-469.77912058090806, -783.9063774070419, -853.6153943966289, -918.3906420086815, -744.0703634619459, -929.5034414758214, -869.8693057377583, -1054.3763231450537, -855.9006586799028, -396.6681276166806, -847.4771024005569, -487.6919661244689, -1074.0655165585595, -862.3046350434795, -886.8203085420723, -765.6586412991363, -807.8731827753852, -707.1276720706901, -860.4054162943373, -494.5540310286478, -714.0637766213503, -606.6292102687963, -550.5561280878185, -372.95108488290157, -626.4212595579489, -850.8657021988108, -602.1339131166317, -422.07319115617565, -614.506937643913, -761.712107716466, -842.6942398734966, -1000.497204377166, -669.4388975484943, -815.409749115435, -840.1285586037965, -698.5992490274338, -644.476647946576, -633.0322119208028, -734.0477893965939, -893.597434064373, -878.3842015122432, -777.7866167472084, -794.3839637978729, -834.4778394614882, -436.7975754677551, -892.7292495246536, -938.229323055449, -740.8946199876059, -657.4388919129041, -919.5575899922369, -656.1244389699065, -563.0452535038455, -491.3412702844287, -1120.0412274475445, -816.4275686934928, -691.7660064826232, -672.150304929537, -743.7823698198567, -990.6073427430988, -784.0213245033037, -779.8132443920898, -526.7318438888908, -559.9690290628494, -807.9656203244913, -853.2066580917271, -773.5155461170024, -1087.0730426597029, -697.8259461069835, -711.2352334562752, -928.5001612789654, -1128.8663733947067, -697.1080027422427, -651.0406053492508, -817.6958478805825, -606.2983100992903, -681.0746717262585, -816.8936860624655, -706.4786605700737, -1044.5855233606906, -585.0944500764128, -385.0153366421304, -839.2397681819978, -975.8865490336793, -853.3414434755031, -912.9648169829818, -1108.4090223671267, -879.6547428146221, -870.2197700234386, -603.7880686842849, -1053.0806957298885, -801.9626659898719, -813.2004761991038, -390.28266894907233, -787.5212111763349, -620.2969929910752, -576.1134218552871, -875.3310221140351, -784.3060011469621, -529.436838816755, -552.3296880642856], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 21.11835441139829, "mean_inference_ms": 0.4005629782575819, "mean_action_processing_ms": 0.09567516308088388, "mean_env_wait_ms": 2.721962283170259, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003908872604370117, "StateBufferConnector_ms": 0.00275421142578125, "ViewRequirementAgentConnector_ms": 0.06726598739624023}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 265560, "num_agent_steps_trained": 265560, "num_env_steps_sampled": 265560, "num_env_steps_trained": 265560, "num_env_steps_sampled_this_iter": 480, "num_env_steps_trained_this_iter": 480, "num_env_steps_sampled_throughput_per_sec": 41.175399310271246, "num_env_steps_trained_throughput_per_sec": 41.175399310271246, "timesteps_total": 265560, "num_steps_trained_this_iter": 480, "agent_timesteps_total": 265560, "timers": {"training_iteration_time_ms": 2893.772, "sample_time_ms": 2889.982, "load_time_ms": 0.218, "load_throughput": 549292.241, "learn_time_ms": 2.796, "learn_throughput": 42911.773, "synch_weights_time_ms": 0.734}, "counters": {"num_env_steps_sampled": 265560, "num_env_steps_trained": 265560, "num_agent_steps_sampled": 265560, "num_agent_steps_trained": 265560}, "done": false, "episodes_total": 2213, "training_iteration": 554, "trial_id": "29a31_00000", "date": "2023-07-26_02-41-14", "timestamp": 1690328474, "time_this_iter_s": 11.660282135009766, "time_total_s": 6720.158878326416, "pid": 90822, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 1, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[253680, 5e-06], [256080, 5e-06], [258480, 2.5e-06], [260880, 2.5e-06], [263280, 2.5e-06], [265680, 2.5e-06], [268080, 1e-06], [270480, 1e-06], [272880, 1e-06], [275280, 5e-07], [277680, 5e-07], [280080, 5e-07], [282480, 5e-07], [284880, 5e-07], [287280, 1e-07], [289680, 1e-07], [292080, 1e-07]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 120, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x16ca65700>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1098.8334023952484, "iterations_since_restore": 94, "perf": {"cpu_util_percent": 37.129411764705885, "ram_util_percent": 72.08235294117647}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 2.3500000000000004e-06, "entropy_coeff": 0.05, "policy_entropy": 265.7452697753906, "policy_loss": -88713.21875, "vf_loss": 3620768.25}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 379.0, "diff_num_grad_updates_vs_sampler_policy": 378.0}}, "num_env_steps_sampled": 266040, "num_env_steps_trained": 266040, "num_agent_steps_sampled": 266040, "num_agent_steps_trained": 266040}, "sampler_results": {"episode_reward_max": -272.31552728616106, "episode_reward_min": -1128.8663733947067, "episode_reward_mean": -751.0802512936052, "episode_len_mean": 120.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-744.0703634619459, -929.5034414758214, -869.8693057377583, -1054.3763231450537, -855.9006586799028, -396.6681276166806, -847.4771024005569, -487.6919661244689, -1074.0655165585595, -862.3046350434795, -886.8203085420723, -765.6586412991363, -807.8731827753852, -707.1276720706901, -860.4054162943373, -494.5540310286478, -714.0637766213503, -606.6292102687963, -550.5561280878185, -372.95108488290157, -626.4212595579489, -850.8657021988108, -602.1339131166317, -422.07319115617565, -614.506937643913, -761.712107716466, -842.6942398734966, -1000.497204377166, -669.4388975484943, -815.409749115435, -840.1285586037965, -698.5992490274338, -644.476647946576, -633.0322119208028, -734.0477893965939, -893.597434064373, -878.3842015122432, -777.7866167472084, -794.3839637978729, -834.4778394614882, -436.7975754677551, -892.7292495246536, -938.229323055449, -740.8946199876059, -657.4388919129041, -919.5575899922369, -656.1244389699065, -563.0452535038455, -491.3412702844287, -1120.0412274475445, -816.4275686934928, -691.7660064826232, -672.150304929537, -743.7823698198567, -990.6073427430988, -784.0213245033037, -779.8132443920898, -526.7318438888908, -559.9690290628494, -807.9656203244913, -853.2066580917271, -773.5155461170024, -1087.0730426597029, -697.8259461069835, -711.2352334562752, -928.5001612789654, -1128.8663733947067, -697.1080027422427, -651.0406053492508, -817.6958478805825, -606.2983100992903, -681.0746717262585, -816.8936860624655, -706.4786605700737, -1044.5855233606906, -585.0944500764128, -385.0153366421304, -839.2397681819978, -975.8865490336793, -853.3414434755031, -912.9648169829818, -1108.4090223671267, -879.6547428146221, -870.2197700234386, -603.7880686842849, -1053.0806957298885, -801.9626659898719, -813.2004761991038, -390.28266894907233, -787.5212111763349, -620.2969929910752, -576.1134218552871, -875.3310221140351, -784.3060011469621, -529.436838816755, -552.3296880642856, -900.6715073624943, -672.5117722411179, -272.31552728616106, -650.9837003748399], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 21.119028621190566, "mean_inference_ms": 0.40056515957821176, "mean_action_processing_ms": 0.09567493856334071, "mean_env_wait_ms": 2.72107935999863, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0039217472076416016, "StateBufferConnector_ms": 0.002756834030151367, "ViewRequirementAgentConnector_ms": 0.06738829612731934}}, "episode_reward_max": -272.31552728616106, "episode_reward_min": -1128.8663733947067, "episode_reward_mean": -751.0802512936052, "episode_len_mean": 120.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-744.0703634619459, -929.5034414758214, -869.8693057377583, -1054.3763231450537, -855.9006586799028, -396.6681276166806, -847.4771024005569, -487.6919661244689, -1074.0655165585595, -862.3046350434795, -886.8203085420723, -765.6586412991363, -807.8731827753852, -707.1276720706901, -860.4054162943373, -494.5540310286478, -714.0637766213503, -606.6292102687963, -550.5561280878185, -372.95108488290157, -626.4212595579489, -850.8657021988108, -602.1339131166317, -422.07319115617565, -614.506937643913, -761.712107716466, -842.6942398734966, -1000.497204377166, -669.4388975484943, -815.409749115435, -840.1285586037965, -698.5992490274338, -644.476647946576, -633.0322119208028, -734.0477893965939, -893.597434064373, -878.3842015122432, -777.7866167472084, -794.3839637978729, -834.4778394614882, -436.7975754677551, -892.7292495246536, -938.229323055449, -740.8946199876059, -657.4388919129041, -919.5575899922369, -656.1244389699065, -563.0452535038455, -491.3412702844287, -1120.0412274475445, -816.4275686934928, -691.7660064826232, -672.150304929537, -743.7823698198567, -990.6073427430988, -784.0213245033037, -779.8132443920898, -526.7318438888908, -559.9690290628494, -807.9656203244913, -853.2066580917271, -773.5155461170024, -1087.0730426597029, -697.8259461069835, -711.2352334562752, -928.5001612789654, -1128.8663733947067, -697.1080027422427, -651.0406053492508, -817.6958478805825, -606.2983100992903, -681.0746717262585, -816.8936860624655, -706.4786605700737, -1044.5855233606906, -585.0944500764128, -385.0153366421304, -839.2397681819978, -975.8865490336793, -853.3414434755031, -912.9648169829818, -1108.4090223671267, -879.6547428146221, -870.2197700234386, -603.7880686842849, -1053.0806957298885, -801.9626659898719, -813.2004761991038, -390.28266894907233, -787.5212111763349, -620.2969929910752, -576.1134218552871, -875.3310221140351, -784.3060011469621, -529.436838816755, -552.3296880642856, -900.6715073624943, -672.5117722411179, -272.31552728616106, -650.9837003748399], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 21.119028621190566, "mean_inference_ms": 0.40056515957821176, "mean_action_processing_ms": 0.09567493856334071, "mean_env_wait_ms": 2.72107935999863, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0039217472076416016, "StateBufferConnector_ms": 0.002756834030151367, "ViewRequirementAgentConnector_ms": 0.06738829612731934}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 266040, "num_agent_steps_trained": 266040, "num_env_steps_sampled": 266040, "num_env_steps_trained": 266040, "num_env_steps_sampled_this_iter": 480, "num_env_steps_trained_this_iter": 480, "num_env_steps_sampled_throughput_per_sec": 40.91797815549046, "num_env_steps_trained_throughput_per_sec": 40.91797815549046, "timesteps_total": 266040, "num_steps_trained_this_iter": 480, "agent_timesteps_total": 266040, "timers": {"training_iteration_time_ms": 2922.63, "sample_time_ms": 2918.867, "load_time_ms": 0.216, "load_throughput": 555169.292, "learn_time_ms": 2.78, "learn_throughput": 43165.339, "synch_weights_time_ms": 0.727}, "counters": {"num_env_steps_sampled": 266040, "num_env_steps_trained": 266040, "num_agent_steps_sampled": 266040, "num_agent_steps_trained": 266040}, "done": false, "episodes_total": 2217, "training_iteration": 555, "trial_id": "29a31_00000", "date": "2023-07-26_02-41-26", "timestamp": 1690328486, "time_this_iter_s": 11.733420848846436, "time_total_s": 6731.892299175262, "pid": 90822, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 1, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[253680, 5e-06], [256080, 5e-06], [258480, 2.5e-06], [260880, 2.5e-06], [263280, 2.5e-06], [265680, 2.5e-06], [268080, 1e-06], [270480, 1e-06], [272880, 1e-06], [275280, 5e-07], [277680, 5e-07], [280080, 5e-07], [282480, 5e-07], [284880, 5e-07], [287280, 1e-07], [289680, 1e-07], [292080, 1e-07]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 120, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x16ca65700>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1110.5668232440948, "iterations_since_restore": 95, "perf": {"cpu_util_percent": 39.1764705882353, "ram_util_percent": 72.68235294117646}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 2.0500000000000003e-06, "entropy_coeff": 0.05, "policy_entropy": 265.6768798828125, "policy_loss": -86847.3828125, "vf_loss": 3608637.5}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 383.0, "diff_num_grad_updates_vs_sampler_policy": 382.0}}, "num_env_steps_sampled": 266520, "num_env_steps_trained": 266520, "num_agent_steps_sampled": 266520, "num_agent_steps_trained": 266520}, "sampler_results": {"episode_reward_max": -272.31552728616106, "episode_reward_min": -1128.8663733947067, "episode_reward_mean": -742.6717691722499, "episode_len_mean": 120.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-855.9006586799028, -396.6681276166806, -847.4771024005569, -487.6919661244689, -1074.0655165585595, -862.3046350434795, -886.8203085420723, -765.6586412991363, -807.8731827753852, -707.1276720706901, -860.4054162943373, -494.5540310286478, -714.0637766213503, -606.6292102687963, -550.5561280878185, -372.95108488290157, -626.4212595579489, -850.8657021988108, -602.1339131166317, -422.07319115617565, -614.506937643913, -761.712107716466, -842.6942398734966, -1000.497204377166, -669.4388975484943, -815.409749115435, -840.1285586037965, -698.5992490274338, -644.476647946576, -633.0322119208028, -734.0477893965939, -893.597434064373, -878.3842015122432, -777.7866167472084, -794.3839637978729, -834.4778394614882, -436.7975754677551, -892.7292495246536, -938.229323055449, -740.8946199876059, -657.4388919129041, -919.5575899922369, -656.1244389699065, -563.0452535038455, -491.3412702844287, -1120.0412274475445, -816.4275686934928, -691.7660064826232, -672.150304929537, -743.7823698198567, -990.6073427430988, -784.0213245033037, -779.8132443920898, -526.7318438888908, -559.9690290628494, -807.9656203244913, -853.2066580917271, -773.5155461170024, -1087.0730426597029, -697.8259461069835, -711.2352334562752, -928.5001612789654, -1128.8663733947067, -697.1080027422427, -651.0406053492508, -817.6958478805825, -606.2983100992903, -681.0746717262585, -816.8936860624655, -706.4786605700737, -1044.5855233606906, -585.0944500764128, -385.0153366421304, -839.2397681819978, -975.8865490336793, -853.3414434755031, -912.9648169829818, -1108.4090223671267, -879.6547428146221, -870.2197700234386, -603.7880686842849, -1053.0806957298885, -801.9626659898719, -813.2004761991038, -390.28266894907233, -787.5212111763349, -620.2969929910752, -576.1134218552871, -875.3310221140351, -784.3060011469621, -529.436838816755, -552.3296880642856, -900.6715073624943, -672.5117722411179, -272.31552728616106, -650.9837003748399, -804.12847176988, -448.0585819875234, -831.4354898360913, -673.3486780915445], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 21.11963635923119, "mean_inference_ms": 0.40055711952290557, "mean_action_processing_ms": 0.09567317523779341, "mean_env_wait_ms": 2.720210374048415, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003889799118041992, "StateBufferConnector_ms": 0.002736330032348633, "ViewRequirementAgentConnector_ms": 0.06690478324890137}}, "episode_reward_max": -272.31552728616106, "episode_reward_min": -1128.8663733947067, "episode_reward_mean": -742.6717691722499, "episode_len_mean": 120.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-855.9006586799028, -396.6681276166806, -847.4771024005569, -487.6919661244689, -1074.0655165585595, -862.3046350434795, -886.8203085420723, -765.6586412991363, -807.8731827753852, -707.1276720706901, -860.4054162943373, -494.5540310286478, -714.0637766213503, -606.6292102687963, -550.5561280878185, -372.95108488290157, -626.4212595579489, -850.8657021988108, -602.1339131166317, -422.07319115617565, -614.506937643913, -761.712107716466, -842.6942398734966, -1000.497204377166, -669.4388975484943, -815.409749115435, -840.1285586037965, -698.5992490274338, -644.476647946576, -633.0322119208028, -734.0477893965939, -893.597434064373, -878.3842015122432, -777.7866167472084, -794.3839637978729, -834.4778394614882, -436.7975754677551, -892.7292495246536, -938.229323055449, -740.8946199876059, -657.4388919129041, -919.5575899922369, -656.1244389699065, -563.0452535038455, -491.3412702844287, -1120.0412274475445, -816.4275686934928, -691.7660064826232, -672.150304929537, -743.7823698198567, -990.6073427430988, -784.0213245033037, -779.8132443920898, -526.7318438888908, -559.9690290628494, -807.9656203244913, -853.2066580917271, -773.5155461170024, -1087.0730426597029, -697.8259461069835, -711.2352334562752, -928.5001612789654, -1128.8663733947067, -697.1080027422427, -651.0406053492508, -817.6958478805825, -606.2983100992903, -681.0746717262585, -816.8936860624655, -706.4786605700737, -1044.5855233606906, -585.0944500764128, -385.0153366421304, -839.2397681819978, -975.8865490336793, -853.3414434755031, -912.9648169829818, -1108.4090223671267, -879.6547428146221, -870.2197700234386, -603.7880686842849, -1053.0806957298885, -801.9626659898719, -813.2004761991038, -390.28266894907233, -787.5212111763349, -620.2969929910752, -576.1134218552871, -875.3310221140351, -784.3060011469621, -529.436838816755, -552.3296880642856, -900.6715073624943, -672.5117722411179, -272.31552728616106, -650.9837003748399, -804.12847176988, -448.0585819875234, -831.4354898360913, -673.3486780915445], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 21.11963635923119, "mean_inference_ms": 0.40055711952290557, "mean_action_processing_ms": 0.09567317523779341, "mean_env_wait_ms": 2.720210374048415, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003889799118041992, "StateBufferConnector_ms": 0.002736330032348633, "ViewRequirementAgentConnector_ms": 0.06690478324890137}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 266520, "num_agent_steps_trained": 266520, "num_env_steps_sampled": 266520, "num_env_steps_trained": 266520, "num_env_steps_sampled_this_iter": 480, "num_env_steps_trained_this_iter": 480, "num_env_steps_sampled_throughput_per_sec": 40.18930836109666, "num_env_steps_trained_throughput_per_sec": 40.18930836109666, "timesteps_total": 266520, "num_steps_trained_this_iter": 480, "agent_timesteps_total": 266520, "timers": {"training_iteration_time_ms": 2950.877, "sample_time_ms": 2947.118, "load_time_ms": 0.217, "load_throughput": 551882.105, "learn_time_ms": 2.778, "learn_throughput": 43189.415, "synch_weights_time_ms": 0.723}, "counters": {"num_env_steps_sampled": 266520, "num_env_steps_trained": 266520, "num_agent_steps_sampled": 266520, "num_agent_steps_trained": 266520}, "done": false, "episodes_total": 2221, "training_iteration": 556, "trial_id": "29a31_00000", "date": "2023-07-26_02-41-38", "timestamp": 1690328498, "time_this_iter_s": 11.94610595703125, "time_total_s": 6743.838405132294, "pid": 90822, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 1, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[253680, 5e-06], [256080, 5e-06], [258480, 2.5e-06], [260880, 2.5e-06], [263280, 2.5e-06], [265680, 2.5e-06], [268080, 1e-06], [270480, 1e-06], [272880, 1e-06], [275280, 5e-07], [277680, 5e-07], [280080, 5e-07], [282480, 5e-07], [284880, 5e-07], [287280, 1e-07], [289680, 1e-07], [292080, 1e-07]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 120, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x16ca65700>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1122.512929201126, "iterations_since_restore": 96, "perf": {"cpu_util_percent": 39.07058823529412, "ram_util_percent": 73.9470588235294}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1.7500000000000002e-06, "entropy_coeff": 0.05, "policy_entropy": 265.6683349609375, "policy_loss": -101915.6953125, "vf_loss": 4705334.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 387.0, "diff_num_grad_updates_vs_sampler_policy": 386.0}}, "num_env_steps_sampled": 267000, "num_env_steps_trained": 267000, "num_agent_steps_sampled": 267000, "num_agent_steps_trained": 267000}, "sampler_results": {"episode_reward_max": -272.31552728616106, "episode_reward_min": -1128.8663733947067, "episode_reward_mean": -744.0979300001168, "episode_len_mean": 120.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1074.0655165585595, -862.3046350434795, -886.8203085420723, -765.6586412991363, -807.8731827753852, -707.1276720706901, -860.4054162943373, -494.5540310286478, -714.0637766213503, -606.6292102687963, -550.5561280878185, -372.95108488290157, -626.4212595579489, -850.8657021988108, -602.1339131166317, -422.07319115617565, -614.506937643913, -761.712107716466, -842.6942398734966, -1000.497204377166, -669.4388975484943, -815.409749115435, -840.1285586037965, -698.5992490274338, -644.476647946576, -633.0322119208028, -734.0477893965939, -893.597434064373, -878.3842015122432, -777.7866167472084, -794.3839637978729, -834.4778394614882, -436.7975754677551, -892.7292495246536, -938.229323055449, -740.8946199876059, -657.4388919129041, -919.5575899922369, -656.1244389699065, -563.0452535038455, -491.3412702844287, -1120.0412274475445, -816.4275686934928, -691.7660064826232, -672.150304929537, -743.7823698198567, -990.6073427430988, -784.0213245033037, -779.8132443920898, -526.7318438888908, -559.9690290628494, -807.9656203244913, -853.2066580917271, -773.5155461170024, -1087.0730426597029, -697.8259461069835, -711.2352334562752, -928.5001612789654, -1128.8663733947067, -697.1080027422427, -651.0406053492508, -817.6958478805825, -606.2983100992903, -681.0746717262585, -816.8936860624655, -706.4786605700737, -1044.5855233606906, -585.0944500764128, -385.0153366421304, -839.2397681819978, -975.8865490336793, -853.3414434755031, -912.9648169829818, -1108.4090223671267, -879.6547428146221, -870.2197700234386, -603.7880686842849, -1053.0806957298885, -801.9626659898719, -813.2004761991038, -390.28266894907233, -787.5212111763349, -620.2969929910752, -576.1134218552871, -875.3310221140351, -784.3060011469621, -529.436838816755, -552.3296880642856, -900.6715073624943, -672.5117722411179, -272.31552728616106, -650.9837003748399, -804.12847176988, -448.0585819875234, -831.4354898360913, -673.3486780915445, -582.773580763202, -559.9339705182151, -862.8252586335362, -724.8211276933365], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 21.120454078459524, "mean_inference_ms": 0.4005560652855793, "mean_action_processing_ms": 0.09567286128785017, "mean_env_wait_ms": 2.719411150335333, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0038955211639404297, "StateBufferConnector_ms": 0.002742767333984375, "ViewRequirementAgentConnector_ms": 0.06688904762268066}}, "episode_reward_max": -272.31552728616106, "episode_reward_min": -1128.8663733947067, "episode_reward_mean": -744.0979300001168, "episode_len_mean": 120.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1074.0655165585595, -862.3046350434795, -886.8203085420723, -765.6586412991363, -807.8731827753852, -707.1276720706901, -860.4054162943373, -494.5540310286478, -714.0637766213503, -606.6292102687963, -550.5561280878185, -372.95108488290157, -626.4212595579489, -850.8657021988108, -602.1339131166317, -422.07319115617565, -614.506937643913, -761.712107716466, -842.6942398734966, -1000.497204377166, -669.4388975484943, -815.409749115435, -840.1285586037965, -698.5992490274338, -644.476647946576, -633.0322119208028, -734.0477893965939, -893.597434064373, -878.3842015122432, -777.7866167472084, -794.3839637978729, -834.4778394614882, -436.7975754677551, -892.7292495246536, -938.229323055449, -740.8946199876059, -657.4388919129041, -919.5575899922369, -656.1244389699065, -563.0452535038455, -491.3412702844287, -1120.0412274475445, -816.4275686934928, -691.7660064826232, -672.150304929537, -743.7823698198567, -990.6073427430988, -784.0213245033037, -779.8132443920898, -526.7318438888908, -559.9690290628494, -807.9656203244913, -853.2066580917271, -773.5155461170024, -1087.0730426597029, -697.8259461069835, -711.2352334562752, -928.5001612789654, -1128.8663733947067, -697.1080027422427, -651.0406053492508, -817.6958478805825, -606.2983100992903, -681.0746717262585, -816.8936860624655, -706.4786605700737, -1044.5855233606906, -585.0944500764128, -385.0153366421304, -839.2397681819978, -975.8865490336793, -853.3414434755031, -912.9648169829818, -1108.4090223671267, -879.6547428146221, -870.2197700234386, -603.7880686842849, -1053.0806957298885, -801.9626659898719, -813.2004761991038, -390.28266894907233, -787.5212111763349, -620.2969929910752, -576.1134218552871, -875.3310221140351, -784.3060011469621, -529.436838816755, -552.3296880642856, -900.6715073624943, -672.5117722411179, -272.31552728616106, -650.9837003748399, -804.12847176988, -448.0585819875234, -831.4354898360913, -673.3486780915445, -582.773580763202, -559.9339705182151, -862.8252586335362, -724.8211276933365], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 21.120454078459524, "mean_inference_ms": 0.4005560652855793, "mean_action_processing_ms": 0.09567286128785017, "mean_env_wait_ms": 2.719411150335333, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0038955211639404297, "StateBufferConnector_ms": 0.002742767333984375, "ViewRequirementAgentConnector_ms": 0.06688904762268066}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 267000, "num_agent_steps_trained": 267000, "num_env_steps_sampled": 267000, "num_env_steps_trained": 267000, "num_env_steps_sampled_this_iter": 480, "num_env_steps_trained_this_iter": 480, "num_env_steps_sampled_throughput_per_sec": 41.076472759704444, "num_env_steps_trained_throughput_per_sec": 41.076472759704444, "timesteps_total": 267000, "num_steps_trained_this_iter": 480, "agent_timesteps_total": 267000, "timers": {"training_iteration_time_ms": 2944.005, "sample_time_ms": 2940.153, "load_time_ms": 0.22, "load_throughput": 546014.841, "learn_time_ms": 2.796, "learn_throughput": 42923.484, "synch_weights_time_ms": 0.797}, "counters": {"num_env_steps_sampled": 267000, "num_env_steps_trained": 267000, "num_agent_steps_sampled": 267000, "num_agent_steps_trained": 267000}, "done": false, "episodes_total": 2225, "training_iteration": 557, "trial_id": "29a31_00000", "date": "2023-07-26_02-41-49", "timestamp": 1690328509, "time_this_iter_s": 11.68816590309143, "time_total_s": 6755.526571035385, "pid": 90822, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 1, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[253680, 5e-06], [256080, 5e-06], [258480, 2.5e-06], [260880, 2.5e-06], [263280, 2.5e-06], [265680, 2.5e-06], [268080, 1e-06], [270480, 1e-06], [272880, 1e-06], [275280, 5e-07], [277680, 5e-07], [280080, 5e-07], [282480, 5e-07], [284880, 5e-07], [287280, 1e-07], [289680, 1e-07], [292080, 1e-07]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 120, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x16ca65700>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1134.2010951042175, "iterations_since_restore": 97, "perf": {"cpu_util_percent": 33.574999999999996, "ram_util_percent": 74.84375}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1.45e-06, "entropy_coeff": 0.05, "policy_entropy": 265.6840515136719, "policy_loss": -75966.9453125, "vf_loss": 2775081.5}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 391.0, "diff_num_grad_updates_vs_sampler_policy": 390.0}}, "num_env_steps_sampled": 267480, "num_env_steps_trained": 267480, "num_agent_steps_sampled": 267480, "num_agent_steps_trained": 267480}, "sampler_results": {"episode_reward_max": -272.31552728616106, "episode_reward_min": -1128.8663733947067, "episode_reward_mean": -731.6403582253013, "episode_len_mean": 120.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-807.8731827753852, -707.1276720706901, -860.4054162943373, -494.5540310286478, -714.0637766213503, -606.6292102687963, -550.5561280878185, -372.95108488290157, -626.4212595579489, -850.8657021988108, -602.1339131166317, -422.07319115617565, -614.506937643913, -761.712107716466, -842.6942398734966, -1000.497204377166, -669.4388975484943, -815.409749115435, -840.1285586037965, -698.5992490274338, -644.476647946576, -633.0322119208028, -734.0477893965939, -893.597434064373, -878.3842015122432, -777.7866167472084, -794.3839637978729, -834.4778394614882, -436.7975754677551, -892.7292495246536, -938.229323055449, -740.8946199876059, -657.4388919129041, -919.5575899922369, -656.1244389699065, -563.0452535038455, -491.3412702844287, -1120.0412274475445, -816.4275686934928, -691.7660064826232, -672.150304929537, -743.7823698198567, -990.6073427430988, -784.0213245033037, -779.8132443920898, -526.7318438888908, -559.9690290628494, -807.9656203244913, -853.2066580917271, -773.5155461170024, -1087.0730426597029, -697.8259461069835, -711.2352334562752, -928.5001612789654, -1128.8663733947067, -697.1080027422427, -651.0406053492508, -817.6958478805825, -606.2983100992903, -681.0746717262585, -816.8936860624655, -706.4786605700737, -1044.5855233606906, -585.0944500764128, -385.0153366421304, -839.2397681819978, -975.8865490336793, -853.3414434755031, -912.9648169829818, -1108.4090223671267, -879.6547428146221, -870.2197700234386, -603.7880686842849, -1053.0806957298885, -801.9626659898719, -813.2004761991038, -390.28266894907233, -787.5212111763349, -620.2969929910752, -576.1134218552871, -875.3310221140351, -784.3060011469621, -529.436838816755, -552.3296880642856, -900.6715073624943, -672.5117722411179, -272.31552728616106, -650.9837003748399, -804.12847176988, -448.0585819875234, -831.4354898360913, -673.3486780915445, -582.773580763202, -559.9339705182151, -862.8252586335362, -724.8211276933365, -611.0126685427279, -660.4702908239256, -440.0600391494581, -631.5489254456106], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 21.121217959172824, "mean_inference_ms": 0.40055731496220515, "mean_action_processing_ms": 0.095673003849116, "mean_env_wait_ms": 2.718606421345738, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0039000511169433594, "StateBufferConnector_ms": 0.0027396678924560547, "ViewRequirementAgentConnector_ms": 0.06698465347290039}}, "episode_reward_max": -272.31552728616106, "episode_reward_min": -1128.8663733947067, "episode_reward_mean": -731.6403582253013, "episode_len_mean": 120.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-807.8731827753852, -707.1276720706901, -860.4054162943373, -494.5540310286478, -714.0637766213503, -606.6292102687963, -550.5561280878185, -372.95108488290157, -626.4212595579489, -850.8657021988108, -602.1339131166317, -422.07319115617565, -614.506937643913, -761.712107716466, -842.6942398734966, -1000.497204377166, -669.4388975484943, -815.409749115435, -840.1285586037965, -698.5992490274338, -644.476647946576, -633.0322119208028, -734.0477893965939, -893.597434064373, -878.3842015122432, -777.7866167472084, -794.3839637978729, -834.4778394614882, -436.7975754677551, -892.7292495246536, -938.229323055449, -740.8946199876059, -657.4388919129041, -919.5575899922369, -656.1244389699065, -563.0452535038455, -491.3412702844287, -1120.0412274475445, -816.4275686934928, -691.7660064826232, -672.150304929537, -743.7823698198567, -990.6073427430988, -784.0213245033037, -779.8132443920898, -526.7318438888908, -559.9690290628494, -807.9656203244913, -853.2066580917271, -773.5155461170024, -1087.0730426597029, -697.8259461069835, -711.2352334562752, -928.5001612789654, -1128.8663733947067, -697.1080027422427, -651.0406053492508, -817.6958478805825, -606.2983100992903, -681.0746717262585, -816.8936860624655, -706.4786605700737, -1044.5855233606906, -585.0944500764128, -385.0153366421304, -839.2397681819978, -975.8865490336793, -853.3414434755031, -912.9648169829818, -1108.4090223671267, -879.6547428146221, -870.2197700234386, -603.7880686842849, -1053.0806957298885, -801.9626659898719, -813.2004761991038, -390.28266894907233, -787.5212111763349, -620.2969929910752, -576.1134218552871, -875.3310221140351, -784.3060011469621, -529.436838816755, -552.3296880642856, -900.6715073624943, -672.5117722411179, -272.31552728616106, -650.9837003748399, -804.12847176988, -448.0585819875234, -831.4354898360913, -673.3486780915445, -582.773580763202, -559.9339705182151, -862.8252586335362, -724.8211276933365, -611.0126685427279, -660.4702908239256, -440.0600391494581, -631.5489254456106], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 21.121217959172824, "mean_inference_ms": 0.40055731496220515, "mean_action_processing_ms": 0.095673003849116, "mean_env_wait_ms": 2.718606421345738, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0039000511169433594, "StateBufferConnector_ms": 0.0027396678924560547, "ViewRequirementAgentConnector_ms": 0.06698465347290039}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 267480, "num_agent_steps_trained": 267480, "num_env_steps_sampled": 267480, "num_env_steps_trained": 267480, "num_env_steps_sampled_this_iter": 480, "num_env_steps_trained_this_iter": 480, "num_env_steps_sampled_throughput_per_sec": 41.797982713367176, "num_env_steps_trained_throughput_per_sec": 41.797982713367176, "timesteps_total": 267480, "num_steps_trained_this_iter": 480, "agent_timesteps_total": 267480, "timers": {"training_iteration_time_ms": 2903.764, "sample_time_ms": 2899.895, "load_time_ms": 0.221, "load_throughput": 541783.079, "learn_time_ms": 2.804, "learn_throughput": 42788.469, "synch_weights_time_ms": 0.804}, "counters": {"num_env_steps_sampled": 267480, "num_env_steps_trained": 267480, "num_agent_steps_sampled": 267480, "num_agent_steps_trained": 267480}, "done": false, "episodes_total": 2229, "training_iteration": 558, "trial_id": "29a31_00000", "date": "2023-07-26_02-42-01", "timestamp": 1690328521, "time_this_iter_s": 11.486602067947388, "time_total_s": 6767.0131731033325, "pid": 90822, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 1, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[253680, 5e-06], [256080, 5e-06], [258480, 2.5e-06], [260880, 2.5e-06], [263280, 2.5e-06], [265680, 2.5e-06], [268080, 1e-06], [270480, 1e-06], [272880, 1e-06], [275280, 5e-07], [277680, 5e-07], [280080, 5e-07], [282480, 5e-07], [284880, 5e-07], [287280, 1e-07], [289680, 1e-07], [292080, 1e-07]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 120, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x16ca65700>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1145.687697172165, "iterations_since_restore": 98, "perf": {"cpu_util_percent": 31.69375, "ram_util_percent": 72.025}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1.15e-06, "entropy_coeff": 0.05, "policy_entropy": 265.7063293457031, "policy_loss": -68981.8203125, "vf_loss": 2091136.625}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 395.0, "diff_num_grad_updates_vs_sampler_policy": 394.0}}, "num_env_steps_sampled": 267960, "num_env_steps_trained": 267960, "num_agent_steps_sampled": 267960, "num_agent_steps_trained": 267960}, "sampler_results": {"episode_reward_max": -272.31552728616106, "episode_reward_min": -1128.8663733947067, "episode_reward_mean": -723.080897311156, "episode_len_mean": 120.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-714.0637766213503, -606.6292102687963, -550.5561280878185, -372.95108488290157, -626.4212595579489, -850.8657021988108, -602.1339131166317, -422.07319115617565, -614.506937643913, -761.712107716466, -842.6942398734966, -1000.497204377166, -669.4388975484943, -815.409749115435, -840.1285586037965, -698.5992490274338, -644.476647946576, -633.0322119208028, -734.0477893965939, -893.597434064373, -878.3842015122432, -777.7866167472084, -794.3839637978729, -834.4778394614882, -436.7975754677551, -892.7292495246536, -938.229323055449, -740.8946199876059, -657.4388919129041, -919.5575899922369, -656.1244389699065, -563.0452535038455, -491.3412702844287, -1120.0412274475445, -816.4275686934928, -691.7660064826232, -672.150304929537, -743.7823698198567, -990.6073427430988, -784.0213245033037, -779.8132443920898, -526.7318438888908, -559.9690290628494, -807.9656203244913, -853.2066580917271, -773.5155461170024, -1087.0730426597029, -697.8259461069835, -711.2352334562752, -928.5001612789654, -1128.8663733947067, -697.1080027422427, -651.0406053492508, -817.6958478805825, -606.2983100992903, -681.0746717262585, -816.8936860624655, -706.4786605700737, -1044.5855233606906, -585.0944500764128, -385.0153366421304, -839.2397681819978, -975.8865490336793, -853.3414434755031, -912.9648169829818, -1108.4090223671267, -879.6547428146221, -870.2197700234386, -603.7880686842849, -1053.0806957298885, -801.9626659898719, -813.2004761991038, -390.28266894907233, -787.5212111763349, -620.2969929910752, -576.1134218552871, -875.3310221140351, -784.3060011469621, -529.436838816755, -552.3296880642856, -900.6715073624943, -672.5117722411179, -272.31552728616106, -650.9837003748399, -804.12847176988, -448.0585819875234, -831.4354898360913, -673.3486780915445, -582.773580763202, -559.9339705182151, -862.8252586335362, -724.8211276933365, -611.0126685427279, -660.4702908239256, -440.0600391494581, -631.5489254456106, -533.793376273585, -351.12785653806856, -584.7363253973668, -544.3566525455012], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 21.12194519956297, "mean_inference_ms": 0.40056498488403186, "mean_action_processing_ms": 0.09567420386509179, "mean_env_wait_ms": 2.7177889288144503, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003905057907104492, "StateBufferConnector_ms": 0.00273895263671875, "ViewRequirementAgentConnector_ms": 0.06699967384338379}}, "episode_reward_max": -272.31552728616106, "episode_reward_min": -1128.8663733947067, "episode_reward_mean": -723.080897311156, "episode_len_mean": 120.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-714.0637766213503, -606.6292102687963, -550.5561280878185, -372.95108488290157, -626.4212595579489, -850.8657021988108, -602.1339131166317, -422.07319115617565, -614.506937643913, -761.712107716466, -842.6942398734966, -1000.497204377166, -669.4388975484943, -815.409749115435, -840.1285586037965, -698.5992490274338, -644.476647946576, -633.0322119208028, -734.0477893965939, -893.597434064373, -878.3842015122432, -777.7866167472084, -794.3839637978729, -834.4778394614882, -436.7975754677551, -892.7292495246536, -938.229323055449, -740.8946199876059, -657.4388919129041, -919.5575899922369, -656.1244389699065, -563.0452535038455, -491.3412702844287, -1120.0412274475445, -816.4275686934928, -691.7660064826232, -672.150304929537, -743.7823698198567, -990.6073427430988, -784.0213245033037, -779.8132443920898, -526.7318438888908, -559.9690290628494, -807.9656203244913, -853.2066580917271, -773.5155461170024, -1087.0730426597029, -697.8259461069835, -711.2352334562752, -928.5001612789654, -1128.8663733947067, -697.1080027422427, -651.0406053492508, -817.6958478805825, -606.2983100992903, -681.0746717262585, -816.8936860624655, -706.4786605700737, -1044.5855233606906, -585.0944500764128, -385.0153366421304, -839.2397681819978, -975.8865490336793, -853.3414434755031, -912.9648169829818, -1108.4090223671267, -879.6547428146221, -870.2197700234386, -603.7880686842849, -1053.0806957298885, -801.9626659898719, -813.2004761991038, -390.28266894907233, -787.5212111763349, -620.2969929910752, -576.1134218552871, -875.3310221140351, -784.3060011469621, -529.436838816755, -552.3296880642856, -900.6715073624943, -672.5117722411179, -272.31552728616106, -650.9837003748399, -804.12847176988, -448.0585819875234, -831.4354898360913, -673.3486780915445, -582.773580763202, -559.9339705182151, -862.8252586335362, -724.8211276933365, -611.0126685427279, -660.4702908239256, -440.0600391494581, -631.5489254456106, -533.793376273585, -351.12785653806856, -584.7363253973668, -544.3566525455012], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 21.12194519956297, "mean_inference_ms": 0.40056498488403186, "mean_action_processing_ms": 0.09567420386509179, "mean_env_wait_ms": 2.7177889288144503, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003905057907104492, "StateBufferConnector_ms": 0.00273895263671875, "ViewRequirementAgentConnector_ms": 0.06699967384338379}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 267960, "num_agent_steps_trained": 267960, "num_env_steps_sampled": 267960, "num_env_steps_trained": 267960, "num_env_steps_sampled_this_iter": 480, "num_env_steps_trained_this_iter": 480, "num_env_steps_sampled_throughput_per_sec": 41.06274123086167, "num_env_steps_trained_throughput_per_sec": 41.06274123086167, "timesteps_total": 267960, "num_steps_trained_this_iter": 480, "agent_timesteps_total": 267960, "timers": {"training_iteration_time_ms": 2894.118, "sample_time_ms": 2890.371, "load_time_ms": 0.219, "load_throughput": 548932.795, "learn_time_ms": 2.774, "learn_throughput": 43264.779, "synch_weights_time_ms": 0.714}, "counters": {"num_env_steps_sampled": 267960, "num_env_steps_trained": 267960, "num_agent_steps_sampled": 267960, "num_agent_steps_trained": 267960}, "done": false, "episodes_total": 2233, "training_iteration": 559, "trial_id": "29a31_00000", "date": "2023-07-26_02-42-13", "timestamp": 1690328533, "time_this_iter_s": 11.69215202331543, "time_total_s": 6778.705325126648, "pid": 90822, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 1, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[253680, 5e-06], [256080, 5e-06], [258480, 2.5e-06], [260880, 2.5e-06], [263280, 2.5e-06], [265680, 2.5e-06], [268080, 1e-06], [270480, 1e-06], [272880, 1e-06], [275280, 5e-07], [277680, 5e-07], [280080, 5e-07], [282480, 5e-07], [284880, 5e-07], [287280, 1e-07], [289680, 1e-07], [292080, 1e-07]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 120, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x16ca65700>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1157.3798491954803, "iterations_since_restore": 99, "perf": {"cpu_util_percent": 38.670588235294126, "ram_util_percent": 71.55294117647058}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-06, "entropy_coeff": 0.05, "policy_entropy": 265.71490478515625, "policy_loss": -106411.53125, "vf_loss": 5305027.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 399.0, "diff_num_grad_updates_vs_sampler_policy": 398.0}}, "num_env_steps_sampled": 268440, "num_env_steps_trained": 268440, "num_agent_steps_sampled": 268440, "num_agent_steps_trained": 268440}, "sampler_results": {"episode_reward_max": -272.31552728616106, "episode_reward_min": -1128.8663733947067, "episode_reward_mean": -730.9939603059482, "episode_len_mean": 120.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-626.4212595579489, -850.8657021988108, -602.1339131166317, -422.07319115617565, -614.506937643913, -761.712107716466, -842.6942398734966, -1000.497204377166, -669.4388975484943, -815.409749115435, -840.1285586037965, -698.5992490274338, -644.476647946576, -633.0322119208028, -734.0477893965939, -893.597434064373, -878.3842015122432, -777.7866167472084, -794.3839637978729, -834.4778394614882, -436.7975754677551, -892.7292495246536, -938.229323055449, -740.8946199876059, -657.4388919129041, -919.5575899922369, -656.1244389699065, -563.0452535038455, -491.3412702844287, -1120.0412274475445, -816.4275686934928, -691.7660064826232, -672.150304929537, -743.7823698198567, -990.6073427430988, -784.0213245033037, -779.8132443920898, -526.7318438888908, -559.9690290628494, -807.9656203244913, -853.2066580917271, -773.5155461170024, -1087.0730426597029, -697.8259461069835, -711.2352334562752, -928.5001612789654, -1128.8663733947067, -697.1080027422427, -651.0406053492508, -817.6958478805825, -606.2983100992903, -681.0746717262585, -816.8936860624655, -706.4786605700737, -1044.5855233606906, -585.0944500764128, -385.0153366421304, -839.2397681819978, -975.8865490336793, -853.3414434755031, -912.9648169829818, -1108.4090223671267, -879.6547428146221, -870.2197700234386, -603.7880686842849, -1053.0806957298885, -801.9626659898719, -813.2004761991038, -390.28266894907233, -787.5212111763349, -620.2969929910752, -576.1134218552871, -875.3310221140351, -784.3060011469621, -529.436838816755, -552.3296880642856, -900.6715073624943, -672.5117722411179, -272.31552728616106, -650.9837003748399, -804.12847176988, -448.0585819875234, -831.4354898360913, -673.3486780915445, -582.773580763202, -559.9339705182151, -862.8252586335362, -724.8211276933365, -611.0126685427279, -660.4702908239256, -440.0600391494581, -631.5489254456106, -533.793376273585, -351.12785653806856, -584.7363253973668, -544.3566525455012, -741.4994338588891, -709.3517955170172, -629.2288466800566, -955.426423284139], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 21.122658548251483, "mean_inference_ms": 0.4005713155083829, "mean_action_processing_ms": 0.09567530299434733, "mean_env_wait_ms": 2.7170173434713716, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003908395767211914, "StateBufferConnector_ms": 0.002734661102294922, "ViewRequirementAgentConnector_ms": 0.06700515747070312}}, "episode_reward_max": -272.31552728616106, "episode_reward_min": -1128.8663733947067, "episode_reward_mean": -730.9939603059482, "episode_len_mean": 120.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-626.4212595579489, -850.8657021988108, -602.1339131166317, -422.07319115617565, -614.506937643913, -761.712107716466, -842.6942398734966, -1000.497204377166, -669.4388975484943, -815.409749115435, -840.1285586037965, -698.5992490274338, -644.476647946576, -633.0322119208028, -734.0477893965939, -893.597434064373, -878.3842015122432, -777.7866167472084, -794.3839637978729, -834.4778394614882, -436.7975754677551, -892.7292495246536, -938.229323055449, -740.8946199876059, -657.4388919129041, -919.5575899922369, -656.1244389699065, -563.0452535038455, -491.3412702844287, -1120.0412274475445, -816.4275686934928, -691.7660064826232, -672.150304929537, -743.7823698198567, -990.6073427430988, -784.0213245033037, -779.8132443920898, -526.7318438888908, -559.9690290628494, -807.9656203244913, -853.2066580917271, -773.5155461170024, -1087.0730426597029, -697.8259461069835, -711.2352334562752, -928.5001612789654, -1128.8663733947067, -697.1080027422427, -651.0406053492508, -817.6958478805825, -606.2983100992903, -681.0746717262585, -816.8936860624655, -706.4786605700737, -1044.5855233606906, -585.0944500764128, -385.0153366421304, -839.2397681819978, -975.8865490336793, -853.3414434755031, -912.9648169829818, -1108.4090223671267, -879.6547428146221, -870.2197700234386, -603.7880686842849, -1053.0806957298885, -801.9626659898719, -813.2004761991038, -390.28266894907233, -787.5212111763349, -620.2969929910752, -576.1134218552871, -875.3310221140351, -784.3060011469621, -529.436838816755, -552.3296880642856, -900.6715073624943, -672.5117722411179, -272.31552728616106, -650.9837003748399, -804.12847176988, -448.0585819875234, -831.4354898360913, -673.3486780915445, -582.773580763202, -559.9339705182151, -862.8252586335362, -724.8211276933365, -611.0126685427279, -660.4702908239256, -440.0600391494581, -631.5489254456106, -533.793376273585, -351.12785653806856, -584.7363253973668, -544.3566525455012, -741.4994338588891, -709.3517955170172, -629.2288466800566, -955.426423284139], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 21.122658548251483, "mean_inference_ms": 0.4005713155083829, "mean_action_processing_ms": 0.09567530299434733, "mean_env_wait_ms": 2.7170173434713716, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003908395767211914, "StateBufferConnector_ms": 0.002734661102294922, "ViewRequirementAgentConnector_ms": 0.06700515747070312}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 268440, "num_agent_steps_trained": 268440, "num_env_steps_sampled": 268440, "num_env_steps_trained": 268440, "num_env_steps_sampled_this_iter": 480, "num_env_steps_trained_this_iter": 480, "num_env_steps_sampled_throughput_per_sec": 40.15164988221644, "num_env_steps_trained_throughput_per_sec": 40.15164988221644, "timesteps_total": 268440, "num_steps_trained_this_iter": 480, "agent_timesteps_total": 268440, "timers": {"training_iteration_time_ms": 2939.656, "sample_time_ms": 2935.823, "load_time_ms": 0.218, "load_throughput": 549952.448, "learn_time_ms": 2.837, "learn_throughput": 42291.238, "synch_weights_time_ms": 0.737}, "counters": {"num_env_steps_sampled": 268440, "num_env_steps_trained": 268440, "num_agent_steps_sampled": 268440, "num_agent_steps_trained": 268440}, "done": false, "episodes_total": 2237, "training_iteration": 560, "trial_id": "29a31_00000", "date": "2023-07-26_02-42-25", "timestamp": 1690328545, "time_this_iter_s": 11.957596063613892, "time_total_s": 6790.662921190262, "pid": 90822, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 1, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[253680, 5e-06], [256080, 5e-06], [258480, 2.5e-06], [260880, 2.5e-06], [263280, 2.5e-06], [265680, 2.5e-06], [268080, 1e-06], [270480, 1e-06], [272880, 1e-06], [275280, 5e-07], [277680, 5e-07], [280080, 5e-07], [282480, 5e-07], [284880, 5e-07], [287280, 1e-07], [289680, 1e-07], [292080, 1e-07]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 120, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x16ca65700>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1169.3374452590942, "iterations_since_restore": 100, "perf": {"cpu_util_percent": 37.170588235294126, "ram_util_percent": 72.40588235294118}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-06, "entropy_coeff": 0.05, "policy_entropy": 265.72808837890625, "policy_loss": -87099.2265625, "vf_loss": 3798316.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 403.0, "diff_num_grad_updates_vs_sampler_policy": 402.0}}, "num_env_steps_sampled": 268920, "num_env_steps_trained": 268920, "num_agent_steps_sampled": 268920, "num_agent_steps_trained": 268920}, "sampler_results": {"episode_reward_max": -272.31552728616106, "episode_reward_min": -1128.8663733947067, "episode_reward_mean": -729.8262772009641, "episode_len_mean": 120.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-614.506937643913, -761.712107716466, -842.6942398734966, -1000.497204377166, -669.4388975484943, -815.409749115435, -840.1285586037965, -698.5992490274338, -644.476647946576, -633.0322119208028, -734.0477893965939, -893.597434064373, -878.3842015122432, -777.7866167472084, -794.3839637978729, -834.4778394614882, -436.7975754677551, -892.7292495246536, -938.229323055449, -740.8946199876059, -657.4388919129041, -919.5575899922369, -656.1244389699065, -563.0452535038455, -491.3412702844287, -1120.0412274475445, -816.4275686934928, -691.7660064826232, -672.150304929537, -743.7823698198567, -990.6073427430988, -784.0213245033037, -779.8132443920898, -526.7318438888908, -559.9690290628494, -807.9656203244913, -853.2066580917271, -773.5155461170024, -1087.0730426597029, -697.8259461069835, -711.2352334562752, -928.5001612789654, -1128.8663733947067, -697.1080027422427, -651.0406053492508, -817.6958478805825, -606.2983100992903, -681.0746717262585, -816.8936860624655, -706.4786605700737, -1044.5855233606906, -585.0944500764128, -385.0153366421304, -839.2397681819978, -975.8865490336793, -853.3414434755031, -912.9648169829818, -1108.4090223671267, -879.6547428146221, -870.2197700234386, -603.7880686842849, -1053.0806957298885, -801.9626659898719, -813.2004761991038, -390.28266894907233, -787.5212111763349, -620.2969929910752, -576.1134218552871, -875.3310221140351, -784.3060011469621, -529.436838816755, -552.3296880642856, -900.6715073624943, -672.5117722411179, -272.31552728616106, -650.9837003748399, -804.12847176988, -448.0585819875234, -831.4354898360913, -673.3486780915445, -582.773580763202, -559.9339705182151, -862.8252586335362, -724.8211276933365, -611.0126685427279, -660.4702908239256, -440.0600391494581, -631.5489254456106, -533.793376273585, -351.12785653806856, -584.7363253973668, -544.3566525455012, -741.4994338588891, -709.3517955170172, -629.2288466800566, -955.426423284139, -407.39508120066404, -783.9544336138666, -499.8737708572136, -693.5024698593968], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 21.123263506708945, "mean_inference_ms": 0.40057754994403644, "mean_action_processing_ms": 0.09567650236900178, "mean_env_wait_ms": 2.716258337034597, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003892183303833008, "StateBufferConnector_ms": 0.0027341842651367188, "ViewRequirementAgentConnector_ms": 0.06688117980957031}}, "episode_reward_max": -272.31552728616106, "episode_reward_min": -1128.8663733947067, "episode_reward_mean": -729.8262772009641, "episode_len_mean": 120.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-614.506937643913, -761.712107716466, -842.6942398734966, -1000.497204377166, -669.4388975484943, -815.409749115435, -840.1285586037965, -698.5992490274338, -644.476647946576, -633.0322119208028, -734.0477893965939, -893.597434064373, -878.3842015122432, -777.7866167472084, -794.3839637978729, -834.4778394614882, -436.7975754677551, -892.7292495246536, -938.229323055449, -740.8946199876059, -657.4388919129041, -919.5575899922369, -656.1244389699065, -563.0452535038455, -491.3412702844287, -1120.0412274475445, -816.4275686934928, -691.7660064826232, -672.150304929537, -743.7823698198567, -990.6073427430988, -784.0213245033037, -779.8132443920898, -526.7318438888908, -559.9690290628494, -807.9656203244913, -853.2066580917271, -773.5155461170024, -1087.0730426597029, -697.8259461069835, -711.2352334562752, -928.5001612789654, -1128.8663733947067, -697.1080027422427, -651.0406053492508, -817.6958478805825, -606.2983100992903, -681.0746717262585, -816.8936860624655, -706.4786605700737, -1044.5855233606906, -585.0944500764128, -385.0153366421304, -839.2397681819978, -975.8865490336793, -853.3414434755031, -912.9648169829818, -1108.4090223671267, -879.6547428146221, -870.2197700234386, -603.7880686842849, -1053.0806957298885, -801.9626659898719, -813.2004761991038, -390.28266894907233, -787.5212111763349, -620.2969929910752, -576.1134218552871, -875.3310221140351, -784.3060011469621, -529.436838816755, -552.3296880642856, -900.6715073624943, -672.5117722411179, -272.31552728616106, -650.9837003748399, -804.12847176988, -448.0585819875234, -831.4354898360913, -673.3486780915445, -582.773580763202, -559.9339705182151, -862.8252586335362, -724.8211276933365, -611.0126685427279, -660.4702908239256, -440.0600391494581, -631.5489254456106, -533.793376273585, -351.12785653806856, -584.7363253973668, -544.3566525455012, -741.4994338588891, -709.3517955170172, -629.2288466800566, -955.426423284139, -407.39508120066404, -783.9544336138666, -499.8737708572136, -693.5024698593968], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 21.123263506708945, "mean_inference_ms": 0.40057754994403644, "mean_action_processing_ms": 0.09567650236900178, "mean_env_wait_ms": 2.716258337034597, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003892183303833008, "StateBufferConnector_ms": 0.0027341842651367188, "ViewRequirementAgentConnector_ms": 0.06688117980957031}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 268920, "num_agent_steps_trained": 268920, "num_env_steps_sampled": 268920, "num_env_steps_trained": 268920, "num_env_steps_sampled_this_iter": 480, "num_env_steps_trained_this_iter": 480, "num_env_steps_sampled_throughput_per_sec": 41.22736557200114, "num_env_steps_trained_throughput_per_sec": 41.22736557200114, "timesteps_total": 268920, "num_steps_trained_this_iter": 480, "agent_timesteps_total": 268920, "timers": {"training_iteration_time_ms": 2945.919, "sample_time_ms": 2942.079, "load_time_ms": 0.218, "load_throughput": 549952.448, "learn_time_ms": 2.848, "learn_throughput": 42128.405, "synch_weights_time_ms": 0.732}, "counters": {"num_env_steps_sampled": 268920, "num_env_steps_trained": 268920, "num_agent_steps_sampled": 268920, "num_agent_steps_trained": 268920}, "done": false, "episodes_total": 2241, "training_iteration": 561, "trial_id": "29a31_00000", "date": "2023-07-26_02-42-36", "timestamp": 1690328556, "time_this_iter_s": 11.645474910736084, "time_total_s": 6802.308396100998, "pid": 90822, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 1, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[253680, 5e-06], [256080, 5e-06], [258480, 2.5e-06], [260880, 2.5e-06], [263280, 2.5e-06], [265680, 2.5e-06], [268080, 1e-06], [270480, 1e-06], [272880, 1e-06], [275280, 5e-07], [277680, 5e-07], [280080, 5e-07], [282480, 5e-07], [284880, 5e-07], [287280, 1e-07], [289680, 1e-07], [292080, 1e-07]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 120, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x16ca65700>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1180.9829201698303, "iterations_since_restore": 101, "perf": {"cpu_util_percent": 39.199999999999996, "ram_util_percent": 72.64375}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-06, "entropy_coeff": 0.05, "policy_entropy": 265.7693786621094, "policy_loss": -88447.234375, "vf_loss": 3360005.75}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 407.0, "diff_num_grad_updates_vs_sampler_policy": 406.0}}, "num_env_steps_sampled": 269400, "num_env_steps_trained": 269400, "num_agent_steps_sampled": 269400, "num_agent_steps_trained": 269400}, "sampler_results": {"episode_reward_max": -272.31552728616106, "episode_reward_min": -1128.8663733947067, "episode_reward_mean": -720.6039384061831, "episode_len_mean": 120.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-669.4388975484943, -815.409749115435, -840.1285586037965, -698.5992490274338, -644.476647946576, -633.0322119208028, -734.0477893965939, -893.597434064373, -878.3842015122432, -777.7866167472084, -794.3839637978729, -834.4778394614882, -436.7975754677551, -892.7292495246536, -938.229323055449, -740.8946199876059, -657.4388919129041, -919.5575899922369, -656.1244389699065, -563.0452535038455, -491.3412702844287, -1120.0412274475445, -816.4275686934928, -691.7660064826232, -672.150304929537, -743.7823698198567, -990.6073427430988, -784.0213245033037, -779.8132443920898, -526.7318438888908, -559.9690290628494, -807.9656203244913, -853.2066580917271, -773.5155461170024, -1087.0730426597029, -697.8259461069835, -711.2352334562752, -928.5001612789654, -1128.8663733947067, -697.1080027422427, -651.0406053492508, -817.6958478805825, -606.2983100992903, -681.0746717262585, -816.8936860624655, -706.4786605700737, -1044.5855233606906, -585.0944500764128, -385.0153366421304, -839.2397681819978, -975.8865490336793, -853.3414434755031, -912.9648169829818, -1108.4090223671267, -879.6547428146221, -870.2197700234386, -603.7880686842849, -1053.0806957298885, -801.9626659898719, -813.2004761991038, -390.28266894907233, -787.5212111763349, -620.2969929910752, -576.1134218552871, -875.3310221140351, -784.3060011469621, -529.436838816755, -552.3296880642856, -900.6715073624943, -672.5117722411179, -272.31552728616106, -650.9837003748399, -804.12847176988, -448.0585819875234, -831.4354898360913, -673.3486780915445, -582.773580763202, -559.9339705182151, -862.8252586335362, -724.8211276933365, -611.0126685427279, -660.4702908239256, -440.0600391494581, -631.5489254456106, -533.793376273585, -351.12785653806856, -584.7363253973668, -544.3566525455012, -741.4994338588891, -709.3517955170172, -629.2288466800566, -955.426423284139, -407.39508120066404, -783.9544336138666, -499.8737708572136, -693.5024698593968, -696.0666360585428, -561.1632121055709, -435.91501137047806, -604.0317505983413], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 21.1241225871126, "mean_inference_ms": 0.4005782759638009, "mean_action_processing_ms": 0.09567677984720893, "mean_env_wait_ms": 2.7154820471053234, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0038955211639404297, "StateBufferConnector_ms": 0.0027298927307128906, "ViewRequirementAgentConnector_ms": 0.06678199768066406}}, "episode_reward_max": -272.31552728616106, "episode_reward_min": -1128.8663733947067, "episode_reward_mean": -720.6039384061831, "episode_len_mean": 120.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-669.4388975484943, -815.409749115435, -840.1285586037965, -698.5992490274338, -644.476647946576, -633.0322119208028, -734.0477893965939, -893.597434064373, -878.3842015122432, -777.7866167472084, -794.3839637978729, -834.4778394614882, -436.7975754677551, -892.7292495246536, -938.229323055449, -740.8946199876059, -657.4388919129041, -919.5575899922369, -656.1244389699065, -563.0452535038455, -491.3412702844287, -1120.0412274475445, -816.4275686934928, -691.7660064826232, -672.150304929537, -743.7823698198567, -990.6073427430988, -784.0213245033037, -779.8132443920898, -526.7318438888908, -559.9690290628494, -807.9656203244913, -853.2066580917271, -773.5155461170024, -1087.0730426597029, -697.8259461069835, -711.2352334562752, -928.5001612789654, -1128.8663733947067, -697.1080027422427, -651.0406053492508, -817.6958478805825, -606.2983100992903, -681.0746717262585, -816.8936860624655, -706.4786605700737, -1044.5855233606906, -585.0944500764128, -385.0153366421304, -839.2397681819978, -975.8865490336793, -853.3414434755031, -912.9648169829818, -1108.4090223671267, -879.6547428146221, -870.2197700234386, -603.7880686842849, -1053.0806957298885, -801.9626659898719, -813.2004761991038, -390.28266894907233, -787.5212111763349, -620.2969929910752, -576.1134218552871, -875.3310221140351, -784.3060011469621, -529.436838816755, -552.3296880642856, -900.6715073624943, -672.5117722411179, -272.31552728616106, -650.9837003748399, -804.12847176988, -448.0585819875234, -831.4354898360913, -673.3486780915445, -582.773580763202, -559.9339705182151, -862.8252586335362, -724.8211276933365, -611.0126685427279, -660.4702908239256, -440.0600391494581, -631.5489254456106, -533.793376273585, -351.12785653806856, -584.7363253973668, -544.3566525455012, -741.4994338588891, -709.3517955170172, -629.2288466800566, -955.426423284139, -407.39508120066404, -783.9544336138666, -499.8737708572136, -693.5024698593968, -696.0666360585428, -561.1632121055709, -435.91501137047806, -604.0317505983413], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 21.1241225871126, "mean_inference_ms": 0.4005782759638009, "mean_action_processing_ms": 0.09567677984720893, "mean_env_wait_ms": 2.7154820471053234, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0038955211639404297, "StateBufferConnector_ms": 0.0027298927307128906, "ViewRequirementAgentConnector_ms": 0.06678199768066406}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 269400, "num_agent_steps_trained": 269400, "num_env_steps_sampled": 269400, "num_env_steps_trained": 269400, "num_env_steps_sampled_this_iter": 480, "num_env_steps_trained_this_iter": 480, "num_env_steps_sampled_throughput_per_sec": 41.08497180449402, "num_env_steps_trained_throughput_per_sec": 41.08497180449402, "timesteps_total": 269400, "num_steps_trained_this_iter": 480, "agent_timesteps_total": 269400, "timers": {"training_iteration_time_ms": 2948.234, "sample_time_ms": 2944.423, "load_time_ms": 0.217, "load_throughput": 553095.033, "learn_time_ms": 2.826, "learn_throughput": 42462.14, "synch_weights_time_ms": 0.727}, "counters": {"num_env_steps_sampled": 269400, "num_env_steps_trained": 269400, "num_agent_steps_sampled": 269400, "num_agent_steps_trained": 269400}, "done": false, "episodes_total": 2245, "training_iteration": 562, "trial_id": "29a31_00000", "date": "2023-07-26_02-42-48", "timestamp": 1690328568, "time_this_iter_s": 11.685940027236938, "time_total_s": 6813.994336128235, "pid": 90822, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 1, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[253680, 5e-06], [256080, 5e-06], [258480, 2.5e-06], [260880, 2.5e-06], [263280, 2.5e-06], [265680, 2.5e-06], [268080, 1e-06], [270480, 1e-06], [272880, 1e-06], [275280, 5e-07], [277680, 5e-07], [280080, 5e-07], [282480, 5e-07], [284880, 5e-07], [287280, 1e-07], [289680, 1e-07], [292080, 1e-07]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 120, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x16ca65700>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1192.6688601970673, "iterations_since_restore": 102, "perf": {"cpu_util_percent": 32.44705882352941, "ram_util_percent": 74.61176470588235}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-06, "entropy_coeff": 0.05, "policy_entropy": 265.82867431640625, "policy_loss": -121702.1015625, "vf_loss": 6918144.5}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 411.0, "diff_num_grad_updates_vs_sampler_policy": 410.0}}, "num_env_steps_sampled": 269880, "num_env_steps_trained": 269880, "num_agent_steps_sampled": 269880, "num_agent_steps_trained": 269880}, "sampler_results": {"episode_reward_max": -272.31552728616106, "episode_reward_min": -1128.8663733947067, "episode_reward_mean": -725.8099498138903, "episode_len_mean": 120.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-644.476647946576, -633.0322119208028, -734.0477893965939, -893.597434064373, -878.3842015122432, -777.7866167472084, -794.3839637978729, -834.4778394614882, -436.7975754677551, -892.7292495246536, -938.229323055449, -740.8946199876059, -657.4388919129041, -919.5575899922369, -656.1244389699065, -563.0452535038455, -491.3412702844287, -1120.0412274475445, -816.4275686934928, -691.7660064826232, -672.150304929537, -743.7823698198567, -990.6073427430988, -784.0213245033037, -779.8132443920898, -526.7318438888908, -559.9690290628494, -807.9656203244913, -853.2066580917271, -773.5155461170024, -1087.0730426597029, -697.8259461069835, -711.2352334562752, -928.5001612789654, -1128.8663733947067, -697.1080027422427, -651.0406053492508, -817.6958478805825, -606.2983100992903, -681.0746717262585, -816.8936860624655, -706.4786605700737, -1044.5855233606906, -585.0944500764128, -385.0153366421304, -839.2397681819978, -975.8865490336793, -853.3414434755031, -912.9648169829818, -1108.4090223671267, -879.6547428146221, -870.2197700234386, -603.7880686842849, -1053.0806957298885, -801.9626659898719, -813.2004761991038, -390.28266894907233, -787.5212111763349, -620.2969929910752, -576.1134218552871, -875.3310221140351, -784.3060011469621, -529.436838816755, -552.3296880642856, -900.6715073624943, -672.5117722411179, -272.31552728616106, -650.9837003748399, -804.12847176988, -448.0585819875234, -831.4354898360913, -673.3486780915445, -582.773580763202, -559.9339705182151, -862.8252586335362, -724.8211276933365, -611.0126685427279, -660.4702908239256, -440.0600391494581, -631.5489254456106, -533.793376273585, -351.12785653806856, -584.7363253973668, -544.3566525455012, -741.4994338588891, -709.3517955170172, -629.2288466800566, -955.426423284139, -407.39508120066404, -783.9544336138666, -499.8737708572136, -693.5024698593968, -696.0666360585428, -561.1632121055709, -435.91501137047806, -604.0317505983413, -939.3383088823931, -716.2847152315428, -915.5897601991649, -972.9648107527968], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 21.124937332592015, "mean_inference_ms": 0.4005738033025748, "mean_action_processing_ms": 0.09567625286598563, "mean_env_wait_ms": 2.7147403757578297, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0038924217224121094, "StateBufferConnector_ms": 0.002725839614868164, "ViewRequirementAgentConnector_ms": 0.06676697731018066}}, "episode_reward_max": -272.31552728616106, "episode_reward_min": -1128.8663733947067, "episode_reward_mean": -725.8099498138903, "episode_len_mean": 120.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-644.476647946576, -633.0322119208028, -734.0477893965939, -893.597434064373, -878.3842015122432, -777.7866167472084, -794.3839637978729, -834.4778394614882, -436.7975754677551, -892.7292495246536, -938.229323055449, -740.8946199876059, -657.4388919129041, -919.5575899922369, -656.1244389699065, -563.0452535038455, -491.3412702844287, -1120.0412274475445, -816.4275686934928, -691.7660064826232, -672.150304929537, -743.7823698198567, -990.6073427430988, -784.0213245033037, -779.8132443920898, -526.7318438888908, -559.9690290628494, -807.9656203244913, -853.2066580917271, -773.5155461170024, -1087.0730426597029, -697.8259461069835, -711.2352334562752, -928.5001612789654, -1128.8663733947067, -697.1080027422427, -651.0406053492508, -817.6958478805825, -606.2983100992903, -681.0746717262585, -816.8936860624655, -706.4786605700737, -1044.5855233606906, -585.0944500764128, -385.0153366421304, -839.2397681819978, -975.8865490336793, -853.3414434755031, -912.9648169829818, -1108.4090223671267, -879.6547428146221, -870.2197700234386, -603.7880686842849, -1053.0806957298885, -801.9626659898719, -813.2004761991038, -390.28266894907233, -787.5212111763349, -620.2969929910752, -576.1134218552871, -875.3310221140351, -784.3060011469621, -529.436838816755, -552.3296880642856, -900.6715073624943, -672.5117722411179, -272.31552728616106, -650.9837003748399, -804.12847176988, -448.0585819875234, -831.4354898360913, -673.3486780915445, -582.773580763202, -559.9339705182151, -862.8252586335362, -724.8211276933365, -611.0126685427279, -660.4702908239256, -440.0600391494581, -631.5489254456106, -533.793376273585, -351.12785653806856, -584.7363253973668, -544.3566525455012, -741.4994338588891, -709.3517955170172, -629.2288466800566, -955.426423284139, -407.39508120066404, -783.9544336138666, -499.8737708572136, -693.5024698593968, -696.0666360585428, -561.1632121055709, -435.91501137047806, -604.0317505983413, -939.3383088823931, -716.2847152315428, -915.5897601991649, -972.9648107527968], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 21.124937332592015, "mean_inference_ms": 0.4005738033025748, "mean_action_processing_ms": 0.09567625286598563, "mean_env_wait_ms": 2.7147403757578297, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0038924217224121094, "StateBufferConnector_ms": 0.002725839614868164, "ViewRequirementAgentConnector_ms": 0.06676697731018066}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 269880, "num_agent_steps_trained": 269880, "num_env_steps_sampled": 269880, "num_env_steps_trained": 269880, "num_env_steps_sampled_this_iter": 480, "num_env_steps_trained_this_iter": 480, "num_env_steps_sampled_throughput_per_sec": 41.512073757933315, "num_env_steps_trained_throughput_per_sec": 41.512073757933315, "timesteps_total": 269880, "num_steps_trained_this_iter": 480, "agent_timesteps_total": 269880, "timers": {"training_iteration_time_ms": 2901.429, "sample_time_ms": 2897.65, "load_time_ms": 0.217, "load_throughput": 551942.625, "learn_time_ms": 2.803, "learn_throughput": 42815.404, "synch_weights_time_ms": 0.719}, "counters": {"num_env_steps_sampled": 269880, "num_env_steps_trained": 269880, "num_agent_steps_sampled": 269880, "num_agent_steps_trained": 269880}, "done": false, "episodes_total": 2249, "training_iteration": 563, "trial_id": "29a31_00000", "date": "2023-07-26_02-43-00", "timestamp": 1690328580, "time_this_iter_s": 11.565572023391724, "time_total_s": 6825.559908151627, "pid": 90822, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 1, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[253680, 5e-06], [256080, 5e-06], [258480, 2.5e-06], [260880, 2.5e-06], [263280, 2.5e-06], [265680, 2.5e-06], [268080, 1e-06], [270480, 1e-06], [272880, 1e-06], [275280, 5e-07], [277680, 5e-07], [280080, 5e-07], [282480, 5e-07], [284880, 5e-07], [287280, 1e-07], [289680, 1e-07], [292080, 1e-07]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 120, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x16ca65700>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1204.234432220459, "iterations_since_restore": 103, "perf": {"cpu_util_percent": 34.59375, "ram_util_percent": 75.43125}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-06, "entropy_coeff": 0.05, "policy_entropy": 265.8082275390625, "policy_loss": -64107.1171875, "vf_loss": 1705783.875}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 415.0, "diff_num_grad_updates_vs_sampler_policy": 414.0}}, "num_env_steps_sampled": 270360, "num_env_steps_trained": 270360, "num_agent_steps_sampled": 270360, "num_agent_steps_trained": 270360}, "sampler_results": {"episode_reward_max": -272.31552728616106, "episode_reward_min": -1128.8663733947067, "episode_reward_mean": -725.8257894940566, "episode_len_mean": 120.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-878.3842015122432, -777.7866167472084, -794.3839637978729, -834.4778394614882, -436.7975754677551, -892.7292495246536, -938.229323055449, -740.8946199876059, -657.4388919129041, -919.5575899922369, -656.1244389699065, -563.0452535038455, -491.3412702844287, -1120.0412274475445, -816.4275686934928, -691.7660064826232, -672.150304929537, -743.7823698198567, -990.6073427430988, -784.0213245033037, -779.8132443920898, -526.7318438888908, -559.9690290628494, -807.9656203244913, -853.2066580917271, -773.5155461170024, -1087.0730426597029, -697.8259461069835, -711.2352334562752, -928.5001612789654, -1128.8663733947067, -697.1080027422427, -651.0406053492508, -817.6958478805825, -606.2983100992903, -681.0746717262585, -816.8936860624655, -706.4786605700737, -1044.5855233606906, -585.0944500764128, -385.0153366421304, -839.2397681819978, -975.8865490336793, -853.3414434755031, -912.9648169829818, -1108.4090223671267, -879.6547428146221, -870.2197700234386, -603.7880686842849, -1053.0806957298885, -801.9626659898719, -813.2004761991038, -390.28266894907233, -787.5212111763349, -620.2969929910752, -576.1134218552871, -875.3310221140351, -784.3060011469621, -529.436838816755, -552.3296880642856, -900.6715073624943, -672.5117722411179, -272.31552728616106, -650.9837003748399, -804.12847176988, -448.0585819875234, -831.4354898360913, -673.3486780915445, -582.773580763202, -559.9339705182151, -862.8252586335362, -724.8211276933365, -611.0126685427279, -660.4702908239256, -440.0600391494581, -631.5489254456106, -533.793376273585, -351.12785653806856, -584.7363253973668, -544.3566525455012, -741.4994338588891, -709.3517955170172, -629.2288466800566, -955.426423284139, -407.39508120066404, -783.9544336138666, -499.8737708572136, -693.5024698593968, -696.0666360585428, -561.1632121055709, -435.91501137047806, -604.0317505983413, -939.3383088823931, -716.2847152315428, -915.5897601991649, -972.9648107527968, -976.0298988284203, -785.0108339137687, -592.4608953946511, -553.2364232081312], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 21.125773398852804, "mean_inference_ms": 0.40056726690895206, "mean_action_processing_ms": 0.09567529926676702, "mean_env_wait_ms": 2.7140252868511068, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0038895606994628906, "StateBufferConnector_ms": 0.0027136802673339844, "ViewRequirementAgentConnector_ms": 0.06678891181945801}}, "episode_reward_max": -272.31552728616106, "episode_reward_min": -1128.8663733947067, "episode_reward_mean": -725.8257894940566, "episode_len_mean": 120.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-878.3842015122432, -777.7866167472084, -794.3839637978729, -834.4778394614882, -436.7975754677551, -892.7292495246536, -938.229323055449, -740.8946199876059, -657.4388919129041, -919.5575899922369, -656.1244389699065, -563.0452535038455, -491.3412702844287, -1120.0412274475445, -816.4275686934928, -691.7660064826232, -672.150304929537, -743.7823698198567, -990.6073427430988, -784.0213245033037, -779.8132443920898, -526.7318438888908, -559.9690290628494, -807.9656203244913, -853.2066580917271, -773.5155461170024, -1087.0730426597029, -697.8259461069835, -711.2352334562752, -928.5001612789654, -1128.8663733947067, -697.1080027422427, -651.0406053492508, -817.6958478805825, -606.2983100992903, -681.0746717262585, -816.8936860624655, -706.4786605700737, -1044.5855233606906, -585.0944500764128, -385.0153366421304, -839.2397681819978, -975.8865490336793, -853.3414434755031, -912.9648169829818, -1108.4090223671267, -879.6547428146221, -870.2197700234386, -603.7880686842849, -1053.0806957298885, -801.9626659898719, -813.2004761991038, -390.28266894907233, -787.5212111763349, -620.2969929910752, -576.1134218552871, -875.3310221140351, -784.3060011469621, -529.436838816755, -552.3296880642856, -900.6715073624943, -672.5117722411179, -272.31552728616106, -650.9837003748399, -804.12847176988, -448.0585819875234, -831.4354898360913, -673.3486780915445, -582.773580763202, -559.9339705182151, -862.8252586335362, -724.8211276933365, -611.0126685427279, -660.4702908239256, -440.0600391494581, -631.5489254456106, -533.793376273585, -351.12785653806856, -584.7363253973668, -544.3566525455012, -741.4994338588891, -709.3517955170172, -629.2288466800566, -955.426423284139, -407.39508120066404, -783.9544336138666, -499.8737708572136, -693.5024698593968, -696.0666360585428, -561.1632121055709, -435.91501137047806, -604.0317505983413, -939.3383088823931, -716.2847152315428, -915.5897601991649, -972.9648107527968, -976.0298988284203, -785.0108339137687, -592.4608953946511, -553.2364232081312], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 21.125773398852804, "mean_inference_ms": 0.40056726690895206, "mean_action_processing_ms": 0.09567529926676702, "mean_env_wait_ms": 2.7140252868511068, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0038895606994628906, "StateBufferConnector_ms": 0.0027136802673339844, "ViewRequirementAgentConnector_ms": 0.06678891181945801}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 270360, "num_agent_steps_trained": 270360, "num_env_steps_sampled": 270360, "num_env_steps_trained": 270360, "num_env_steps_sampled_this_iter": 480, "num_env_steps_trained_this_iter": 480, "num_env_steps_sampled_throughput_per_sec": 41.36750595516831, "num_env_steps_trained_throughput_per_sec": 41.36750595516831, "timesteps_total": 270360, "num_steps_trained_this_iter": 480, "agent_timesteps_total": 270360, "timers": {"training_iteration_time_ms": 2900.584, "sample_time_ms": 2896.828, "load_time_ms": 0.216, "load_throughput": 555414.346, "learn_time_ms": 2.787, "learn_throughput": 43052.356, "synch_weights_time_ms": 0.712}, "counters": {"num_env_steps_sampled": 270360, "num_env_steps_trained": 270360, "num_agent_steps_sampled": 270360, "num_agent_steps_trained": 270360}, "done": false, "episodes_total": 2253, "training_iteration": 564, "trial_id": "29a31_00000", "date": "2023-07-26_02-43-11", "timestamp": 1690328591, "time_this_iter_s": 11.60608720779419, "time_total_s": 6837.165995359421, "pid": 90822, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 1, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[253680, 5e-06], [256080, 5e-06], [258480, 2.5e-06], [260880, 2.5e-06], [263280, 2.5e-06], [265680, 2.5e-06], [268080, 1e-06], [270480, 1e-06], [272880, 1e-06], [275280, 5e-07], [277680, 5e-07], [280080, 5e-07], [282480, 5e-07], [284880, 5e-07], [287280, 1e-07], [289680, 1e-07], [292080, 1e-07]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 120, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x16ca65700>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1215.8405194282532, "iterations_since_restore": 104, "perf": {"cpu_util_percent": 36.85294117647059, "ram_util_percent": 75.4}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-06, "entropy_coeff": 0.05, "policy_entropy": 265.80328369140625, "policy_loss": -100707.0390625, "vf_loss": 4770748.5}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 419.0, "diff_num_grad_updates_vs_sampler_policy": 418.0}}, "num_env_steps_sampled": 270840, "num_env_steps_trained": 270840, "num_agent_steps_sampled": 270840, "num_agent_steps_trained": 270840}, "sampler_results": {"episode_reward_max": -272.31552728616106, "episode_reward_min": -1128.8663733947067, "episode_reward_mean": -722.8540518552134, "episode_len_mean": 120.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-436.7975754677551, -892.7292495246536, -938.229323055449, -740.8946199876059, -657.4388919129041, -919.5575899922369, -656.1244389699065, -563.0452535038455, -491.3412702844287, -1120.0412274475445, -816.4275686934928, -691.7660064826232, -672.150304929537, -743.7823698198567, -990.6073427430988, -784.0213245033037, -779.8132443920898, -526.7318438888908, -559.9690290628494, -807.9656203244913, -853.2066580917271, -773.5155461170024, -1087.0730426597029, -697.8259461069835, -711.2352334562752, -928.5001612789654, -1128.8663733947067, -697.1080027422427, -651.0406053492508, -817.6958478805825, -606.2983100992903, -681.0746717262585, -816.8936860624655, -706.4786605700737, -1044.5855233606906, -585.0944500764128, -385.0153366421304, -839.2397681819978, -975.8865490336793, -853.3414434755031, -912.9648169829818, -1108.4090223671267, -879.6547428146221, -870.2197700234386, -603.7880686842849, -1053.0806957298885, -801.9626659898719, -813.2004761991038, -390.28266894907233, -787.5212111763349, -620.2969929910752, -576.1134218552871, -875.3310221140351, -784.3060011469621, -529.436838816755, -552.3296880642856, -900.6715073624943, -672.5117722411179, -272.31552728616106, -650.9837003748399, -804.12847176988, -448.0585819875234, -831.4354898360913, -673.3486780915445, -582.773580763202, -559.9339705182151, -862.8252586335362, -724.8211276933365, -611.0126685427279, -660.4702908239256, -440.0600391494581, -631.5489254456106, -533.793376273585, -351.12785653806856, -584.7363253973668, -544.3566525455012, -741.4994338588891, -709.3517955170172, -629.2288466800566, -955.426423284139, -407.39508120066404, -783.9544336138666, -499.8737708572136, -693.5024698593968, -696.0666360585428, -561.1632121055709, -435.91501137047806, -604.0317505983413, -939.3383088823931, -716.2847152315428, -915.5897601991649, -972.9648107527968, -976.0298988284203, -785.0108339137687, -592.4608953946511, -553.2364232081312, -802.9696807975071, -657.9355352556672, -850.5801311461079, -676.3735104351586], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 21.12676027733598, "mean_inference_ms": 0.40056596344311984, "mean_action_processing_ms": 0.0956753080152455, "mean_env_wait_ms": 2.713377213307224, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003890514373779297, "StateBufferConnector_ms": 0.0027120113372802734, "ViewRequirementAgentConnector_ms": 0.06684470176696777}}, "episode_reward_max": -272.31552728616106, "episode_reward_min": -1128.8663733947067, "episode_reward_mean": -722.8540518552134, "episode_len_mean": 120.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-436.7975754677551, -892.7292495246536, -938.229323055449, -740.8946199876059, -657.4388919129041, -919.5575899922369, -656.1244389699065, -563.0452535038455, -491.3412702844287, -1120.0412274475445, -816.4275686934928, -691.7660064826232, -672.150304929537, -743.7823698198567, -990.6073427430988, -784.0213245033037, -779.8132443920898, -526.7318438888908, -559.9690290628494, -807.9656203244913, -853.2066580917271, -773.5155461170024, -1087.0730426597029, -697.8259461069835, -711.2352334562752, -928.5001612789654, -1128.8663733947067, -697.1080027422427, -651.0406053492508, -817.6958478805825, -606.2983100992903, -681.0746717262585, -816.8936860624655, -706.4786605700737, -1044.5855233606906, -585.0944500764128, -385.0153366421304, -839.2397681819978, -975.8865490336793, -853.3414434755031, -912.9648169829818, -1108.4090223671267, -879.6547428146221, -870.2197700234386, -603.7880686842849, -1053.0806957298885, -801.9626659898719, -813.2004761991038, -390.28266894907233, -787.5212111763349, -620.2969929910752, -576.1134218552871, -875.3310221140351, -784.3060011469621, -529.436838816755, -552.3296880642856, -900.6715073624943, -672.5117722411179, -272.31552728616106, -650.9837003748399, -804.12847176988, -448.0585819875234, -831.4354898360913, -673.3486780915445, -582.773580763202, -559.9339705182151, -862.8252586335362, -724.8211276933365, -611.0126685427279, -660.4702908239256, -440.0600391494581, -631.5489254456106, -533.793376273585, -351.12785653806856, -584.7363253973668, -544.3566525455012, -741.4994338588891, -709.3517955170172, -629.2288466800566, -955.426423284139, -407.39508120066404, -783.9544336138666, -499.8737708572136, -693.5024698593968, -696.0666360585428, -561.1632121055709, -435.91501137047806, -604.0317505983413, -939.3383088823931, -716.2847152315428, -915.5897601991649, -972.9648107527968, -976.0298988284203, -785.0108339137687, -592.4608953946511, -553.2364232081312, -802.9696807975071, -657.9355352556672, -850.5801311461079, -676.3735104351586], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 21.12676027733598, "mean_inference_ms": 0.40056596344311984, "mean_action_processing_ms": 0.0956753080152455, "mean_env_wait_ms": 2.713377213307224, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003890514373779297, "StateBufferConnector_ms": 0.0027120113372802734, "ViewRequirementAgentConnector_ms": 0.06684470176696777}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 270840, "num_agent_steps_trained": 270840, "num_env_steps_sampled": 270840, "num_env_steps_trained": 270840, "num_env_steps_sampled_this_iter": 480, "num_env_steps_trained_this_iter": 480, "num_env_steps_sampled_throughput_per_sec": 39.796421048636546, "num_env_steps_trained_throughput_per_sec": 39.796421048636546, "timesteps_total": 270840, "num_steps_trained_this_iter": 480, "agent_timesteps_total": 270840, "timers": {"training_iteration_time_ms": 2946.289, "sample_time_ms": 2942.538, "load_time_ms": 0.217, "load_throughput": 553338.259, "learn_time_ms": 2.783, "learn_throughput": 43112.466, "synch_weights_time_ms": 0.71}, "counters": {"num_env_steps_sampled": 270840, "num_env_steps_trained": 270840, "num_agent_steps_sampled": 270840, "num_agent_steps_trained": 270840}, "done": false, "episodes_total": 2257, "training_iteration": 565, "trial_id": "29a31_00000", "date": "2023-07-26_02-43-23", "timestamp": 1690328603, "time_this_iter_s": 12.064388990402222, "time_total_s": 6849.230384349823, "pid": 90822, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 1, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[253680, 5e-06], [256080, 5e-06], [258480, 2.5e-06], [260880, 2.5e-06], [263280, 2.5e-06], [265680, 2.5e-06], [268080, 1e-06], [270480, 1e-06], [272880, 1e-06], [275280, 5e-07], [277680, 5e-07], [280080, 5e-07], [282480, 5e-07], [284880, 5e-07], [287280, 1e-07], [289680, 1e-07], [292080, 1e-07]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 120, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x16ca65700>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1227.9049084186554, "iterations_since_restore": 105, "perf": {"cpu_util_percent": 36.67058823529411, "ram_util_percent": 75.58235294117648}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-06, "entropy_coeff": 0.05, "policy_entropy": 265.8003234863281, "policy_loss": -115128.203125, "vf_loss": 5929980.5}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 423.0, "diff_num_grad_updates_vs_sampler_policy": 422.0}}, "num_env_steps_sampled": 271320, "num_env_steps_trained": 271320, "num_agent_steps_sampled": 271320, "num_agent_steps_trained": 271320}, "sampler_results": {"episode_reward_max": -272.31552728616106, "episode_reward_min": -1128.8663733947067, "episode_reward_mean": -725.2003768233467, "episode_len_mean": 120.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-657.4388919129041, -919.5575899922369, -656.1244389699065, -563.0452535038455, -491.3412702844287, -1120.0412274475445, -816.4275686934928, -691.7660064826232, -672.150304929537, -743.7823698198567, -990.6073427430988, -784.0213245033037, -779.8132443920898, -526.7318438888908, -559.9690290628494, -807.9656203244913, -853.2066580917271, -773.5155461170024, -1087.0730426597029, -697.8259461069835, -711.2352334562752, -928.5001612789654, -1128.8663733947067, -697.1080027422427, -651.0406053492508, -817.6958478805825, -606.2983100992903, -681.0746717262585, -816.8936860624655, -706.4786605700737, -1044.5855233606906, -585.0944500764128, -385.0153366421304, -839.2397681819978, -975.8865490336793, -853.3414434755031, -912.9648169829818, -1108.4090223671267, -879.6547428146221, -870.2197700234386, -603.7880686842849, -1053.0806957298885, -801.9626659898719, -813.2004761991038, -390.28266894907233, -787.5212111763349, -620.2969929910752, -576.1134218552871, -875.3310221140351, -784.3060011469621, -529.436838816755, -552.3296880642856, -900.6715073624943, -672.5117722411179, -272.31552728616106, -650.9837003748399, -804.12847176988, -448.0585819875234, -831.4354898360913, -673.3486780915445, -582.773580763202, -559.9339705182151, -862.8252586335362, -724.8211276933365, -611.0126685427279, -660.4702908239256, -440.0600391494581, -631.5489254456106, -533.793376273585, -351.12785653806856, -584.7363253973668, -544.3566525455012, -741.4994338588891, -709.3517955170172, -629.2288466800566, -955.426423284139, -407.39508120066404, -783.9544336138666, -499.8737708572136, -693.5024698593968, -696.0666360585428, -561.1632121055709, -435.91501137047806, -604.0317505983413, -939.3383088823931, -716.2847152315428, -915.5897601991649, -972.9648107527968, -976.0298988284203, -785.0108339137687, -592.4608953946511, -553.2364232081312, -802.9696807975071, -657.9355352556672, -850.5801311461079, -676.3735104351586, -726.9580268886344, -984.4916792183878, -616.6977224988905, -915.1358362429053], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 21.127729580842875, "mean_inference_ms": 0.40056532281927987, "mean_action_processing_ms": 0.09567543890366106, "mean_env_wait_ms": 2.71271833209405, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003875255584716797, "StateBufferConnector_ms": 0.0027074813842773438, "ViewRequirementAgentConnector_ms": 0.06666803359985352}}, "episode_reward_max": -272.31552728616106, "episode_reward_min": -1128.8663733947067, "episode_reward_mean": -725.2003768233467, "episode_len_mean": 120.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-657.4388919129041, -919.5575899922369, -656.1244389699065, -563.0452535038455, -491.3412702844287, -1120.0412274475445, -816.4275686934928, -691.7660064826232, -672.150304929537, -743.7823698198567, -990.6073427430988, -784.0213245033037, -779.8132443920898, -526.7318438888908, -559.9690290628494, -807.9656203244913, -853.2066580917271, -773.5155461170024, -1087.0730426597029, -697.8259461069835, -711.2352334562752, -928.5001612789654, -1128.8663733947067, -697.1080027422427, -651.0406053492508, -817.6958478805825, -606.2983100992903, -681.0746717262585, -816.8936860624655, -706.4786605700737, -1044.5855233606906, -585.0944500764128, -385.0153366421304, -839.2397681819978, -975.8865490336793, -853.3414434755031, -912.9648169829818, -1108.4090223671267, -879.6547428146221, -870.2197700234386, -603.7880686842849, -1053.0806957298885, -801.9626659898719, -813.2004761991038, -390.28266894907233, -787.5212111763349, -620.2969929910752, -576.1134218552871, -875.3310221140351, -784.3060011469621, -529.436838816755, -552.3296880642856, -900.6715073624943, -672.5117722411179, -272.31552728616106, -650.9837003748399, -804.12847176988, -448.0585819875234, -831.4354898360913, -673.3486780915445, -582.773580763202, -559.9339705182151, -862.8252586335362, -724.8211276933365, -611.0126685427279, -660.4702908239256, -440.0600391494581, -631.5489254456106, -533.793376273585, -351.12785653806856, -584.7363253973668, -544.3566525455012, -741.4994338588891, -709.3517955170172, -629.2288466800566, -955.426423284139, -407.39508120066404, -783.9544336138666, -499.8737708572136, -693.5024698593968, -696.0666360585428, -561.1632121055709, -435.91501137047806, -604.0317505983413, -939.3383088823931, -716.2847152315428, -915.5897601991649, -972.9648107527968, -976.0298988284203, -785.0108339137687, -592.4608953946511, -553.2364232081312, -802.9696807975071, -657.9355352556672, -850.5801311461079, -676.3735104351586, -726.9580268886344, -984.4916792183878, -616.6977224988905, -915.1358362429053], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 21.127729580842875, "mean_inference_ms": 0.40056532281927987, "mean_action_processing_ms": 0.09567543890366106, "mean_env_wait_ms": 2.71271833209405, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003875255584716797, "StateBufferConnector_ms": 0.0027074813842773438, "ViewRequirementAgentConnector_ms": 0.06666803359985352}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 271320, "num_agent_steps_trained": 271320, "num_env_steps_sampled": 271320, "num_env_steps_trained": 271320, "num_env_steps_sampled_this_iter": 480, "num_env_steps_trained_this_iter": 480, "num_env_steps_sampled_throughput_per_sec": 40.4741235941397, "num_env_steps_trained_throughput_per_sec": 40.4741235941397, "timesteps_total": 271320, "num_steps_trained_this_iter": 480, "agent_timesteps_total": 271320, "timers": {"training_iteration_time_ms": 2978.527, "sample_time_ms": 2974.671, "load_time_ms": 0.222, "load_throughput": 539344.706, "learn_time_ms": 2.869, "learn_throughput": 41819.672, "synch_weights_time_ms": 0.722}, "counters": {"num_env_steps_sampled": 271320, "num_env_steps_trained": 271320, "num_agent_steps_sampled": 271320, "num_agent_steps_trained": 271320}, "done": false, "episodes_total": 2261, "training_iteration": 566, "trial_id": "29a31_00000", "date": "2023-07-26_02-43-35", "timestamp": 1690328615, "time_this_iter_s": 11.862321138381958, "time_total_s": 6861.092705488205, "pid": 90822, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 1, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[253680, 5e-06], [256080, 5e-06], [258480, 2.5e-06], [260880, 2.5e-06], [263280, 2.5e-06], [265680, 2.5e-06], [268080, 1e-06], [270480, 1e-06], [272880, 1e-06], [275280, 5e-07], [277680, 5e-07], [280080, 5e-07], [282480, 5e-07], [284880, 5e-07], [287280, 1e-07], [289680, 1e-07], [292080, 1e-07]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 120, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x16ca65700>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1239.7672295570374, "iterations_since_restore": 106, "perf": {"cpu_util_percent": 39.64705882352941, "ram_util_percent": 76.8}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-06, "entropy_coeff": 0.05, "policy_entropy": 265.74114990234375, "policy_loss": -48820.0234375, "vf_loss": 1214120.75}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 427.0, "diff_num_grad_updates_vs_sampler_policy": 426.0}}, "num_env_steps_sampled": 271800, "num_env_steps_trained": 271800, "num_agent_steps_sampled": 271800, "num_agent_steps_trained": 271800}, "sampler_results": {"episode_reward_max": -272.31552728616106, "episode_reward_min": -1128.8663733947067, "episode_reward_mean": -724.3762033386769, "episode_len_mean": 120.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-491.3412702844287, -1120.0412274475445, -816.4275686934928, -691.7660064826232, -672.150304929537, -743.7823698198567, -990.6073427430988, -784.0213245033037, -779.8132443920898, -526.7318438888908, -559.9690290628494, -807.9656203244913, -853.2066580917271, -773.5155461170024, -1087.0730426597029, -697.8259461069835, -711.2352334562752, -928.5001612789654, -1128.8663733947067, -697.1080027422427, -651.0406053492508, -817.6958478805825, -606.2983100992903, -681.0746717262585, -816.8936860624655, -706.4786605700737, -1044.5855233606906, -585.0944500764128, -385.0153366421304, -839.2397681819978, -975.8865490336793, -853.3414434755031, -912.9648169829818, -1108.4090223671267, -879.6547428146221, -870.2197700234386, -603.7880686842849, -1053.0806957298885, -801.9626659898719, -813.2004761991038, -390.28266894907233, -787.5212111763349, -620.2969929910752, -576.1134218552871, -875.3310221140351, -784.3060011469621, -529.436838816755, -552.3296880642856, -900.6715073624943, -672.5117722411179, -272.31552728616106, -650.9837003748399, -804.12847176988, -448.0585819875234, -831.4354898360913, -673.3486780915445, -582.773580763202, -559.9339705182151, -862.8252586335362, -724.8211276933365, -611.0126685427279, -660.4702908239256, -440.0600391494581, -631.5489254456106, -533.793376273585, -351.12785653806856, -584.7363253973668, -544.3566525455012, -741.4994338588891, -709.3517955170172, -629.2288466800566, -955.426423284139, -407.39508120066404, -783.9544336138666, -499.8737708572136, -693.5024698593968, -696.0666360585428, -561.1632121055709, -435.91501137047806, -604.0317505983413, -939.3383088823931, -716.2847152315428, -915.5897601991649, -972.9648107527968, -976.0298988284203, -785.0108339137687, -592.4608953946511, -553.2364232081312, -802.9696807975071, -657.9355352556672, -850.5801311461079, -676.3735104351586, -726.9580268886344, -984.4916792183878, -616.6977224988905, -915.1358362429053, -893.7816637274223, -624.647383853262, -723.8986036735728, -471.42117465765386], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 21.12875526685314, "mean_inference_ms": 0.4005650124245041, "mean_action_processing_ms": 0.09567568926552177, "mean_env_wait_ms": 2.712037733053512, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003876209259033203, "StateBufferConnector_ms": 0.0027065277099609375, "ViewRequirementAgentConnector_ms": 0.0667276382446289}}, "episode_reward_max": -272.31552728616106, "episode_reward_min": -1128.8663733947067, "episode_reward_mean": -724.3762033386769, "episode_len_mean": 120.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-491.3412702844287, -1120.0412274475445, -816.4275686934928, -691.7660064826232, -672.150304929537, -743.7823698198567, -990.6073427430988, -784.0213245033037, -779.8132443920898, -526.7318438888908, -559.9690290628494, -807.9656203244913, -853.2066580917271, -773.5155461170024, -1087.0730426597029, -697.8259461069835, -711.2352334562752, -928.5001612789654, -1128.8663733947067, -697.1080027422427, -651.0406053492508, -817.6958478805825, -606.2983100992903, -681.0746717262585, -816.8936860624655, -706.4786605700737, -1044.5855233606906, -585.0944500764128, -385.0153366421304, -839.2397681819978, -975.8865490336793, -853.3414434755031, -912.9648169829818, -1108.4090223671267, -879.6547428146221, -870.2197700234386, -603.7880686842849, -1053.0806957298885, -801.9626659898719, -813.2004761991038, -390.28266894907233, -787.5212111763349, -620.2969929910752, -576.1134218552871, -875.3310221140351, -784.3060011469621, -529.436838816755, -552.3296880642856, -900.6715073624943, -672.5117722411179, -272.31552728616106, -650.9837003748399, -804.12847176988, -448.0585819875234, -831.4354898360913, -673.3486780915445, -582.773580763202, -559.9339705182151, -862.8252586335362, -724.8211276933365, -611.0126685427279, -660.4702908239256, -440.0600391494581, -631.5489254456106, -533.793376273585, -351.12785653806856, -584.7363253973668, -544.3566525455012, -741.4994338588891, -709.3517955170172, -629.2288466800566, -955.426423284139, -407.39508120066404, -783.9544336138666, -499.8737708572136, -693.5024698593968, -696.0666360585428, -561.1632121055709, -435.91501137047806, -604.0317505983413, -939.3383088823931, -716.2847152315428, -915.5897601991649, -972.9648107527968, -976.0298988284203, -785.0108339137687, -592.4608953946511, -553.2364232081312, -802.9696807975071, -657.9355352556672, -850.5801311461079, -676.3735104351586, -726.9580268886344, -984.4916792183878, -616.6977224988905, -915.1358362429053, -893.7816637274223, -624.647383853262, -723.8986036735728, -471.42117465765386], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 21.12875526685314, "mean_inference_ms": 0.4005650124245041, "mean_action_processing_ms": 0.09567568926552177, "mean_env_wait_ms": 2.712037733053512, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003876209259033203, "StateBufferConnector_ms": 0.0027065277099609375, "ViewRequirementAgentConnector_ms": 0.0667276382446289}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 271800, "num_agent_steps_trained": 271800, "num_env_steps_sampled": 271800, "num_env_steps_trained": 271800, "num_env_steps_sampled_this_iter": 480, "num_env_steps_trained_this_iter": 480, "num_env_steps_sampled_throughput_per_sec": 41.699614158639136, "num_env_steps_trained_throughput_per_sec": 41.699614158639136, "timesteps_total": 271800, "num_steps_trained_this_iter": 480, "agent_timesteps_total": 271800, "timers": {"training_iteration_time_ms": 2952.186, "sample_time_ms": 2948.318, "load_time_ms": 0.222, "load_throughput": 539923.278, "learn_time_ms": 2.871, "learn_throughput": 41792.587, "synch_weights_time_ms": 0.733}, "counters": {"num_env_steps_sampled": 271800, "num_env_steps_trained": 271800, "num_agent_steps_sampled": 271800, "num_agent_steps_trained": 271800}, "done": false, "episodes_total": 2265, "training_iteration": 567, "trial_id": "29a31_00000", "date": "2023-07-26_02-43-47", "timestamp": 1690328627, "time_this_iter_s": 11.51391315460205, "time_total_s": 6872.606618642807, "pid": 90822, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 1, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[253680, 5e-06], [256080, 5e-06], [258480, 2.5e-06], [260880, 2.5e-06], [263280, 2.5e-06], [265680, 2.5e-06], [268080, 1e-06], [270480, 1e-06], [272880, 1e-06], [275280, 5e-07], [277680, 5e-07], [280080, 5e-07], [282480, 5e-07], [284880, 5e-07], [287280, 1e-07], [289680, 1e-07], [292080, 1e-07]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 120, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x16ca65700>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1251.2811427116394, "iterations_since_restore": 107, "perf": {"cpu_util_percent": 35.16875, "ram_util_percent": 75.70625000000001}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-06, "entropy_coeff": 0.05, "policy_entropy": 265.75128173828125, "policy_loss": -107959.859375, "vf_loss": 5066011.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 431.0, "diff_num_grad_updates_vs_sampler_policy": 430.0}}, "num_env_steps_sampled": 272280, "num_env_steps_trained": 272280, "num_agent_steps_sampled": 272280, "num_agent_steps_trained": 272280}, "sampler_results": {"episode_reward_max": -272.31552728616106, "episode_reward_min": -1128.8663733947067, "episode_reward_mean": -725.3801353289944, "episode_len_mean": 120.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-672.150304929537, -743.7823698198567, -990.6073427430988, -784.0213245033037, -779.8132443920898, -526.7318438888908, -559.9690290628494, -807.9656203244913, -853.2066580917271, -773.5155461170024, -1087.0730426597029, -697.8259461069835, -711.2352334562752, -928.5001612789654, -1128.8663733947067, -697.1080027422427, -651.0406053492508, -817.6958478805825, -606.2983100992903, -681.0746717262585, -816.8936860624655, -706.4786605700737, -1044.5855233606906, -585.0944500764128, -385.0153366421304, -839.2397681819978, -975.8865490336793, -853.3414434755031, -912.9648169829818, -1108.4090223671267, -879.6547428146221, -870.2197700234386, -603.7880686842849, -1053.0806957298885, -801.9626659898719, -813.2004761991038, -390.28266894907233, -787.5212111763349, -620.2969929910752, -576.1134218552871, -875.3310221140351, -784.3060011469621, -529.436838816755, -552.3296880642856, -900.6715073624943, -672.5117722411179, -272.31552728616106, -650.9837003748399, -804.12847176988, -448.0585819875234, -831.4354898360913, -673.3486780915445, -582.773580763202, -559.9339705182151, -862.8252586335362, -724.8211276933365, -611.0126685427279, -660.4702908239256, -440.0600391494581, -631.5489254456106, -533.793376273585, -351.12785653806856, -584.7363253973668, -544.3566525455012, -741.4994338588891, -709.3517955170172, -629.2288466800566, -955.426423284139, -407.39508120066404, -783.9544336138666, -499.8737708572136, -693.5024698593968, -696.0666360585428, -561.1632121055709, -435.91501137047806, -604.0317505983413, -939.3383088823931, -716.2847152315428, -915.5897601991649, -972.9648107527968, -976.0298988284203, -785.0108339137687, -592.4608953946511, -553.2364232081312, -802.9696807975071, -657.9355352556672, -850.5801311461079, -676.3735104351586, -726.9580268886344, -984.4916792183878, -616.6977224988905, -915.1358362429053, -893.7816637274223, -624.647383853262, -723.8986036735728, -471.42117465765386, -831.0077487444229, -947.0396737642479, -634.663800990879, -807.2580484403014], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 21.129566275278385, "mean_inference_ms": 0.400561012688464, "mean_action_processing_ms": 0.09567540435673556, "mean_env_wait_ms": 2.711321955310908, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0038738250732421875, "StateBufferConnector_ms": 0.002706766128540039, "ViewRequirementAgentConnector_ms": 0.0666196346282959}}, "episode_reward_max": -272.31552728616106, "episode_reward_min": -1128.8663733947067, "episode_reward_mean": -725.3801353289944, "episode_len_mean": 120.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-672.150304929537, -743.7823698198567, -990.6073427430988, -784.0213245033037, -779.8132443920898, -526.7318438888908, -559.9690290628494, -807.9656203244913, -853.2066580917271, -773.5155461170024, -1087.0730426597029, -697.8259461069835, -711.2352334562752, -928.5001612789654, -1128.8663733947067, -697.1080027422427, -651.0406053492508, -817.6958478805825, -606.2983100992903, -681.0746717262585, -816.8936860624655, -706.4786605700737, -1044.5855233606906, -585.0944500764128, -385.0153366421304, -839.2397681819978, -975.8865490336793, -853.3414434755031, -912.9648169829818, -1108.4090223671267, -879.6547428146221, -870.2197700234386, -603.7880686842849, -1053.0806957298885, -801.9626659898719, -813.2004761991038, -390.28266894907233, -787.5212111763349, -620.2969929910752, -576.1134218552871, -875.3310221140351, -784.3060011469621, -529.436838816755, -552.3296880642856, -900.6715073624943, -672.5117722411179, -272.31552728616106, -650.9837003748399, -804.12847176988, -448.0585819875234, -831.4354898360913, -673.3486780915445, -582.773580763202, -559.9339705182151, -862.8252586335362, -724.8211276933365, -611.0126685427279, -660.4702908239256, -440.0600391494581, -631.5489254456106, -533.793376273585, -351.12785653806856, -584.7363253973668, -544.3566525455012, -741.4994338588891, -709.3517955170172, -629.2288466800566, -955.426423284139, -407.39508120066404, -783.9544336138666, -499.8737708572136, -693.5024698593968, -696.0666360585428, -561.1632121055709, -435.91501137047806, -604.0317505983413, -939.3383088823931, -716.2847152315428, -915.5897601991649, -972.9648107527968, -976.0298988284203, -785.0108339137687, -592.4608953946511, -553.2364232081312, -802.9696807975071, -657.9355352556672, -850.5801311461079, -676.3735104351586, -726.9580268886344, -984.4916792183878, -616.6977224988905, -915.1358362429053, -893.7816637274223, -624.647383853262, -723.8986036735728, -471.42117465765386, -831.0077487444229, -947.0396737642479, -634.663800990879, -807.2580484403014], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 21.129566275278385, "mean_inference_ms": 0.400561012688464, "mean_action_processing_ms": 0.09567540435673556, "mean_env_wait_ms": 2.711321955310908, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0038738250732421875, "StateBufferConnector_ms": 0.002706766128540039, "ViewRequirementAgentConnector_ms": 0.0666196346282959}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 272280, "num_agent_steps_trained": 272280, "num_env_steps_sampled": 272280, "num_env_steps_trained": 272280, "num_env_steps_sampled_this_iter": 480, "num_env_steps_trained_this_iter": 480, "num_env_steps_sampled_throughput_per_sec": 41.55571819705608, "num_env_steps_trained_throughput_per_sec": 41.55571819705608, "timesteps_total": 272280, "num_steps_trained_this_iter": 480, "agent_timesteps_total": 272280, "timers": {"training_iteration_time_ms": 2908.89, "sample_time_ms": 2904.997, "load_time_ms": 0.221, "load_throughput": 542308.458, "learn_time_ms": 2.898, "learn_throughput": 41404.097, "synch_weights_time_ms": 0.732}, "counters": {"num_env_steps_sampled": 272280, "num_env_steps_trained": 272280, "num_agent_steps_sampled": 272280, "num_agent_steps_trained": 272280}, "done": false, "episodes_total": 2269, "training_iteration": 568, "trial_id": "29a31_00000", "date": "2023-07-26_02-43-58", "timestamp": 1690328638, "time_this_iter_s": 11.553577184677124, "time_total_s": 6884.160195827484, "pid": 90822, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 1, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[253680, 5e-06], [256080, 5e-06], [258480, 2.5e-06], [260880, 2.5e-06], [263280, 2.5e-06], [265680, 2.5e-06], [268080, 1e-06], [270480, 1e-06], [272880, 1e-06], [275280, 5e-07], [277680, 5e-07], [280080, 5e-07], [282480, 5e-07], [284880, 5e-07], [287280, 1e-07], [289680, 1e-07], [292080, 1e-07]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 120, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x16ca65700>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1262.8347198963165, "iterations_since_restore": 108, "perf": {"cpu_util_percent": 37.074999999999996, "ram_util_percent": 76.4875}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-06, "entropy_coeff": 0.05, "policy_entropy": 265.7633056640625, "policy_loss": -100271.5390625, "vf_loss": 4996980.5}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 435.0, "diff_num_grad_updates_vs_sampler_policy": 434.0}}, "num_env_steps_sampled": 272760, "num_env_steps_trained": 272760, "num_agent_steps_sampled": 272760, "num_agent_steps_trained": 272760}, "sampler_results": {"episode_reward_max": -272.31552728616106, "episode_reward_min": -1128.8663733947067, "episode_reward_mean": -722.0004488816991, "episode_len_mean": 120.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-779.8132443920898, -526.7318438888908, -559.9690290628494, -807.9656203244913, -853.2066580917271, -773.5155461170024, -1087.0730426597029, -697.8259461069835, -711.2352334562752, -928.5001612789654, -1128.8663733947067, -697.1080027422427, -651.0406053492508, -817.6958478805825, -606.2983100992903, -681.0746717262585, -816.8936860624655, -706.4786605700737, -1044.5855233606906, -585.0944500764128, -385.0153366421304, -839.2397681819978, -975.8865490336793, -853.3414434755031, -912.9648169829818, -1108.4090223671267, -879.6547428146221, -870.2197700234386, -603.7880686842849, -1053.0806957298885, -801.9626659898719, -813.2004761991038, -390.28266894907233, -787.5212111763349, -620.2969929910752, -576.1134218552871, -875.3310221140351, -784.3060011469621, -529.436838816755, -552.3296880642856, -900.6715073624943, -672.5117722411179, -272.31552728616106, -650.9837003748399, -804.12847176988, -448.0585819875234, -831.4354898360913, -673.3486780915445, -582.773580763202, -559.9339705182151, -862.8252586335362, -724.8211276933365, -611.0126685427279, -660.4702908239256, -440.0600391494581, -631.5489254456106, -533.793376273585, -351.12785653806856, -584.7363253973668, -544.3566525455012, -741.4994338588891, -709.3517955170172, -629.2288466800566, -955.426423284139, -407.39508120066404, -783.9544336138666, -499.8737708572136, -693.5024698593968, -696.0666360585428, -561.1632121055709, -435.91501137047806, -604.0317505983413, -939.3383088823931, -716.2847152315428, -915.5897601991649, -972.9648107527968, -976.0298988284203, -785.0108339137687, -592.4608953946511, -553.2364232081312, -802.9696807975071, -657.9355352556672, -850.5801311461079, -676.3735104351586, -726.9580268886344, -984.4916792183878, -616.6977224988905, -915.1358362429053, -893.7816637274223, -624.647383853262, -723.8986036735728, -471.42117465765386, -831.0077487444229, -947.0396737642479, -634.663800990879, -807.2580484403014, -648.9219181161432, -620.3567345551995, -639.4533850960762, -943.8606594988436], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 21.130340106970348, "mean_inference_ms": 0.4005538451270365, "mean_action_processing_ms": 0.09567461415258448, "mean_env_wait_ms": 2.7106156965524364, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003890514373779297, "StateBufferConnector_ms": 0.0027189254760742188, "ViewRequirementAgentConnector_ms": 0.06704115867614746}}, "episode_reward_max": -272.31552728616106, "episode_reward_min": -1128.8663733947067, "episode_reward_mean": -722.0004488816991, "episode_len_mean": 120.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-779.8132443920898, -526.7318438888908, -559.9690290628494, -807.9656203244913, -853.2066580917271, -773.5155461170024, -1087.0730426597029, -697.8259461069835, -711.2352334562752, -928.5001612789654, -1128.8663733947067, -697.1080027422427, -651.0406053492508, -817.6958478805825, -606.2983100992903, -681.0746717262585, -816.8936860624655, -706.4786605700737, -1044.5855233606906, -585.0944500764128, -385.0153366421304, -839.2397681819978, -975.8865490336793, -853.3414434755031, -912.9648169829818, -1108.4090223671267, -879.6547428146221, -870.2197700234386, -603.7880686842849, -1053.0806957298885, -801.9626659898719, -813.2004761991038, -390.28266894907233, -787.5212111763349, -620.2969929910752, -576.1134218552871, -875.3310221140351, -784.3060011469621, -529.436838816755, -552.3296880642856, -900.6715073624943, -672.5117722411179, -272.31552728616106, -650.9837003748399, -804.12847176988, -448.0585819875234, -831.4354898360913, -673.3486780915445, -582.773580763202, -559.9339705182151, -862.8252586335362, -724.8211276933365, -611.0126685427279, -660.4702908239256, -440.0600391494581, -631.5489254456106, -533.793376273585, -351.12785653806856, -584.7363253973668, -544.3566525455012, -741.4994338588891, -709.3517955170172, -629.2288466800566, -955.426423284139, -407.39508120066404, -783.9544336138666, -499.8737708572136, -693.5024698593968, -696.0666360585428, -561.1632121055709, -435.91501137047806, -604.0317505983413, -939.3383088823931, -716.2847152315428, -915.5897601991649, -972.9648107527968, -976.0298988284203, -785.0108339137687, -592.4608953946511, -553.2364232081312, -802.9696807975071, -657.9355352556672, -850.5801311461079, -676.3735104351586, -726.9580268886344, -984.4916792183878, -616.6977224988905, -915.1358362429053, -893.7816637274223, -624.647383853262, -723.8986036735728, -471.42117465765386, -831.0077487444229, -947.0396737642479, -634.663800990879, -807.2580484403014, -648.9219181161432, -620.3567345551995, -639.4533850960762, -943.8606594988436], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 21.130340106970348, "mean_inference_ms": 0.4005538451270365, "mean_action_processing_ms": 0.09567461415258448, "mean_env_wait_ms": 2.7106156965524364, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003890514373779297, "StateBufferConnector_ms": 0.0027189254760742188, "ViewRequirementAgentConnector_ms": 0.06704115867614746}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 272760, "num_agent_steps_trained": 272760, "num_env_steps_sampled": 272760, "num_env_steps_trained": 272760, "num_env_steps_sampled_this_iter": 480, "num_env_steps_trained_this_iter": 480, "num_env_steps_sampled_throughput_per_sec": 41.27667706484214, "num_env_steps_trained_throughput_per_sec": 41.27667706484214, "timesteps_total": 272760, "num_steps_trained_this_iter": 480, "agent_timesteps_total": 272760, "timers": {"training_iteration_time_ms": 2883.109, "sample_time_ms": 2879.283, "load_time_ms": 0.218, "load_throughput": 549472.14, "learn_time_ms": 2.825, "learn_throughput": 42477.191, "synch_weights_time_ms": 0.742}, "counters": {"num_env_steps_sampled": 272760, "num_env_steps_trained": 272760, "num_agent_steps_sampled": 272760, "num_agent_steps_trained": 272760}, "done": false, "episodes_total": 2273, "training_iteration": 569, "trial_id": "29a31_00000", "date": "2023-07-26_02-44-10", "timestamp": 1690328650, "time_this_iter_s": 11.63145112991333, "time_total_s": 6895.7916469573975, "pid": 90822, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 1, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[253680, 5e-06], [256080, 5e-06], [258480, 2.5e-06], [260880, 2.5e-06], [263280, 2.5e-06], [265680, 2.5e-06], [268080, 1e-06], [270480, 1e-06], [272880, 1e-06], [275280, 5e-07], [277680, 5e-07], [280080, 5e-07], [282480, 5e-07], [284880, 5e-07], [287280, 1e-07], [289680, 1e-07], [292080, 1e-07]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 120, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x16ca65700>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1274.4661710262299, "iterations_since_restore": 109, "perf": {"cpu_util_percent": 34.588235294117645, "ram_util_percent": 76.6}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 9.5e-07, "entropy_coeff": 0.05, "policy_entropy": 265.7493591308594, "policy_loss": -79355.9296875, "vf_loss": 3046587.25}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 439.0, "diff_num_grad_updates_vs_sampler_policy": 438.0}}, "num_env_steps_sampled": 273240, "num_env_steps_trained": 273240, "num_agent_steps_sampled": 273240, "num_agent_steps_trained": 273240}, "sampler_results": {"episode_reward_max": -272.31552728616106, "episode_reward_min": -1128.8663733947067, "episode_reward_mean": -725.2115363253926, "episode_len_mean": 120.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-853.2066580917271, -773.5155461170024, -1087.0730426597029, -697.8259461069835, -711.2352334562752, -928.5001612789654, -1128.8663733947067, -697.1080027422427, -651.0406053492508, -817.6958478805825, -606.2983100992903, -681.0746717262585, -816.8936860624655, -706.4786605700737, -1044.5855233606906, -585.0944500764128, -385.0153366421304, -839.2397681819978, -975.8865490336793, -853.3414434755031, -912.9648169829818, -1108.4090223671267, -879.6547428146221, -870.2197700234386, -603.7880686842849, -1053.0806957298885, -801.9626659898719, -813.2004761991038, -390.28266894907233, -787.5212111763349, -620.2969929910752, -576.1134218552871, -875.3310221140351, -784.3060011469621, -529.436838816755, -552.3296880642856, -900.6715073624943, -672.5117722411179, -272.31552728616106, -650.9837003748399, -804.12847176988, -448.0585819875234, -831.4354898360913, -673.3486780915445, -582.773580763202, -559.9339705182151, -862.8252586335362, -724.8211276933365, -611.0126685427279, -660.4702908239256, -440.0600391494581, -631.5489254456106, -533.793376273585, -351.12785653806856, -584.7363253973668, -544.3566525455012, -741.4994338588891, -709.3517955170172, -629.2288466800566, -955.426423284139, -407.39508120066404, -783.9544336138666, -499.8737708572136, -693.5024698593968, -696.0666360585428, -561.1632121055709, -435.91501137047806, -604.0317505983413, -939.3383088823931, -716.2847152315428, -915.5897601991649, -972.9648107527968, -976.0298988284203, -785.0108339137687, -592.4608953946511, -553.2364232081312, -802.9696807975071, -657.9355352556672, -850.5801311461079, -676.3735104351586, -726.9580268886344, -984.4916792183878, -616.6977224988905, -915.1358362429053, -893.7816637274223, -624.647383853262, -723.8986036735728, -471.42117465765386, -831.0077487444229, -947.0396737642479, -634.663800990879, -807.2580484403014, -648.9219181161432, -620.3567345551995, -639.4533850960762, -943.8606594988436, -858.495290093199, -786.4370754929433, -786.6827755922249, -563.973340859308], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 21.130939893055807, "mean_inference_ms": 0.4005462315301848, "mean_action_processing_ms": 0.0956737450085731, "mean_env_wait_ms": 2.7099512067486717, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003886699676513672, "StateBufferConnector_ms": 0.002718687057495117, "ViewRequirementAgentConnector_ms": 0.06693267822265625}}, "episode_reward_max": -272.31552728616106, "episode_reward_min": -1128.8663733947067, "episode_reward_mean": -725.2115363253926, "episode_len_mean": 120.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-853.2066580917271, -773.5155461170024, -1087.0730426597029, -697.8259461069835, -711.2352334562752, -928.5001612789654, -1128.8663733947067, -697.1080027422427, -651.0406053492508, -817.6958478805825, -606.2983100992903, -681.0746717262585, -816.8936860624655, -706.4786605700737, -1044.5855233606906, -585.0944500764128, -385.0153366421304, -839.2397681819978, -975.8865490336793, -853.3414434755031, -912.9648169829818, -1108.4090223671267, -879.6547428146221, -870.2197700234386, -603.7880686842849, -1053.0806957298885, -801.9626659898719, -813.2004761991038, -390.28266894907233, -787.5212111763349, -620.2969929910752, -576.1134218552871, -875.3310221140351, -784.3060011469621, -529.436838816755, -552.3296880642856, -900.6715073624943, -672.5117722411179, -272.31552728616106, -650.9837003748399, -804.12847176988, -448.0585819875234, -831.4354898360913, -673.3486780915445, -582.773580763202, -559.9339705182151, -862.8252586335362, -724.8211276933365, -611.0126685427279, -660.4702908239256, -440.0600391494581, -631.5489254456106, -533.793376273585, -351.12785653806856, -584.7363253973668, -544.3566525455012, -741.4994338588891, -709.3517955170172, -629.2288466800566, -955.426423284139, -407.39508120066404, -783.9544336138666, -499.8737708572136, -693.5024698593968, -696.0666360585428, -561.1632121055709, -435.91501137047806, -604.0317505983413, -939.3383088823931, -716.2847152315428, -915.5897601991649, -972.9648107527968, -976.0298988284203, -785.0108339137687, -592.4608953946511, -553.2364232081312, -802.9696807975071, -657.9355352556672, -850.5801311461079, -676.3735104351586, -726.9580268886344, -984.4916792183878, -616.6977224988905, -915.1358362429053, -893.7816637274223, -624.647383853262, -723.8986036735728, -471.42117465765386, -831.0077487444229, -947.0396737642479, -634.663800990879, -807.2580484403014, -648.9219181161432, -620.3567345551995, -639.4533850960762, -943.8606594988436, -858.495290093199, -786.4370754929433, -786.6827755922249, -563.973340859308], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 21.130939893055807, "mean_inference_ms": 0.4005462315301848, "mean_action_processing_ms": 0.0956737450085731, "mean_env_wait_ms": 2.7099512067486717, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003886699676513672, "StateBufferConnector_ms": 0.002718687057495117, "ViewRequirementAgentConnector_ms": 0.06693267822265625}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 273240, "num_agent_steps_trained": 273240, "num_env_steps_sampled": 273240, "num_env_steps_trained": 273240, "num_env_steps_sampled_this_iter": 480, "num_env_steps_trained_this_iter": 480, "num_env_steps_sampled_throughput_per_sec": 40.58770082537786, "num_env_steps_trained_throughput_per_sec": 40.58770082537786, "timesteps_total": 273240, "num_steps_trained_this_iter": 480, "agent_timesteps_total": 273240, "timers": {"training_iteration_time_ms": 2922.398, "sample_time_ms": 2918.589, "load_time_ms": 0.218, "load_throughput": 549532.132, "learn_time_ms": 2.832, "learn_throughput": 42380.263, "synch_weights_time_ms": 0.719}, "counters": {"num_env_steps_sampled": 273240, "num_env_steps_trained": 273240, "num_agent_steps_sampled": 273240, "num_agent_steps_trained": 273240}, "done": false, "episodes_total": 2277, "training_iteration": 570, "trial_id": "29a31_00000", "date": "2023-07-26_02-44-22", "timestamp": 1690328662, "time_this_iter_s": 11.828998804092407, "time_total_s": 6907.62064576149, "pid": 90822, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 1, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[253680, 5e-06], [256080, 5e-06], [258480, 2.5e-06], [260880, 2.5e-06], [263280, 2.5e-06], [265680, 2.5e-06], [268080, 1e-06], [270480, 1e-06], [272880, 1e-06], [275280, 5e-07], [277680, 5e-07], [280080, 5e-07], [282480, 5e-07], [284880, 5e-07], [287280, 1e-07], [289680, 1e-07], [292080, 1e-07]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 120, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x16ca65700>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1286.2951698303223, "iterations_since_restore": 110, "perf": {"cpu_util_percent": 38.21764705882353, "ram_util_percent": 77.41764705882352}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 8.499999999999999e-07, "entropy_coeff": 0.05, "policy_entropy": 265.7808837890625, "policy_loss": -61084.42578125, "vf_loss": 1828411.25}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 443.0, "diff_num_grad_updates_vs_sampler_policy": 442.0}}, "num_env_steps_sampled": 273720, "num_env_steps_trained": 273720, "num_agent_steps_sampled": 273720, "num_agent_steps_trained": 273720}, "sampler_results": {"episode_reward_max": -272.31552728616106, "episode_reward_min": -1128.8663733947067, "episode_reward_mean": -715.6009351352127, "episode_len_mean": 120.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-711.2352334562752, -928.5001612789654, -1128.8663733947067, -697.1080027422427, -651.0406053492508, -817.6958478805825, -606.2983100992903, -681.0746717262585, -816.8936860624655, -706.4786605700737, -1044.5855233606906, -585.0944500764128, -385.0153366421304, -839.2397681819978, -975.8865490336793, -853.3414434755031, -912.9648169829818, -1108.4090223671267, -879.6547428146221, -870.2197700234386, -603.7880686842849, -1053.0806957298885, -801.9626659898719, -813.2004761991038, -390.28266894907233, -787.5212111763349, -620.2969929910752, -576.1134218552871, -875.3310221140351, -784.3060011469621, -529.436838816755, -552.3296880642856, -900.6715073624943, -672.5117722411179, -272.31552728616106, -650.9837003748399, -804.12847176988, -448.0585819875234, -831.4354898360913, -673.3486780915445, -582.773580763202, -559.9339705182151, -862.8252586335362, -724.8211276933365, -611.0126685427279, -660.4702908239256, -440.0600391494581, -631.5489254456106, -533.793376273585, -351.12785653806856, -584.7363253973668, -544.3566525455012, -741.4994338588891, -709.3517955170172, -629.2288466800566, -955.426423284139, -407.39508120066404, -783.9544336138666, -499.8737708572136, -693.5024698593968, -696.0666360585428, -561.1632121055709, -435.91501137047806, -604.0317505983413, -939.3383088823931, -716.2847152315428, -915.5897601991649, -972.9648107527968, -976.0298988284203, -785.0108339137687, -592.4608953946511, -553.2364232081312, -802.9696807975071, -657.9355352556672, -850.5801311461079, -676.3735104351586, -726.9580268886344, -984.4916792183878, -616.6977224988905, -915.1358362429053, -893.7816637274223, -624.647383853262, -723.8986036735728, -471.42117465765386, -831.0077487444229, -947.0396737642479, -634.663800990879, -807.2580484403014, -648.9219181161432, -620.3567345551995, -639.4533850960762, -943.8606594988436, -858.495290093199, -786.4370754929433, -786.6827755922249, -563.973340859308, -464.8012292399626, -865.170113788972, -582.8359530439983, -537.7537778844808], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 21.131288752886547, "mean_inference_ms": 0.4005471365066892, "mean_action_processing_ms": 0.09567399763708988, "mean_env_wait_ms": 2.709306192245646, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0038955211639404297, "StateBufferConnector_ms": 0.0027222633361816406, "ViewRequirementAgentConnector_ms": 0.06709051132202148}}, "episode_reward_max": -272.31552728616106, "episode_reward_min": -1128.8663733947067, "episode_reward_mean": -715.6009351352127, "episode_len_mean": 120.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-711.2352334562752, -928.5001612789654, -1128.8663733947067, -697.1080027422427, -651.0406053492508, -817.6958478805825, -606.2983100992903, -681.0746717262585, -816.8936860624655, -706.4786605700737, -1044.5855233606906, -585.0944500764128, -385.0153366421304, -839.2397681819978, -975.8865490336793, -853.3414434755031, -912.9648169829818, -1108.4090223671267, -879.6547428146221, -870.2197700234386, -603.7880686842849, -1053.0806957298885, -801.9626659898719, -813.2004761991038, -390.28266894907233, -787.5212111763349, -620.2969929910752, -576.1134218552871, -875.3310221140351, -784.3060011469621, -529.436838816755, -552.3296880642856, -900.6715073624943, -672.5117722411179, -272.31552728616106, -650.9837003748399, -804.12847176988, -448.0585819875234, -831.4354898360913, -673.3486780915445, -582.773580763202, -559.9339705182151, -862.8252586335362, -724.8211276933365, -611.0126685427279, -660.4702908239256, -440.0600391494581, -631.5489254456106, -533.793376273585, -351.12785653806856, -584.7363253973668, -544.3566525455012, -741.4994338588891, -709.3517955170172, -629.2288466800566, -955.426423284139, -407.39508120066404, -783.9544336138666, -499.8737708572136, -693.5024698593968, -696.0666360585428, -561.1632121055709, -435.91501137047806, -604.0317505983413, -939.3383088823931, -716.2847152315428, -915.5897601991649, -972.9648107527968, -976.0298988284203, -785.0108339137687, -592.4608953946511, -553.2364232081312, -802.9696807975071, -657.9355352556672, -850.5801311461079, -676.3735104351586, -726.9580268886344, -984.4916792183878, -616.6977224988905, -915.1358362429053, -893.7816637274223, -624.647383853262, -723.8986036735728, -471.42117465765386, -831.0077487444229, -947.0396737642479, -634.663800990879, -807.2580484403014, -648.9219181161432, -620.3567345551995, -639.4533850960762, -943.8606594988436, -858.495290093199, -786.4370754929433, -786.6827755922249, -563.973340859308, -464.8012292399626, -865.170113788972, -582.8359530439983, -537.7537778844808], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 21.131288752886547, "mean_inference_ms": 0.4005471365066892, "mean_action_processing_ms": 0.09567399763708988, "mean_env_wait_ms": 2.709306192245646, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0038955211639404297, "StateBufferConnector_ms": 0.0027222633361816406, "ViewRequirementAgentConnector_ms": 0.06709051132202148}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 273720, "num_agent_steps_trained": 273720, "num_env_steps_sampled": 273720, "num_env_steps_trained": 273720, "num_env_steps_sampled_this_iter": 480, "num_env_steps_trained_this_iter": 480, "num_env_steps_sampled_throughput_per_sec": 40.42673832345171, "num_env_steps_trained_throughput_per_sec": 40.42673832345171, "timesteps_total": 273720, "num_steps_trained_this_iter": 480, "agent_timesteps_total": 273720, "timers": {"training_iteration_time_ms": 2937.49, "sample_time_ms": 2933.641, "load_time_ms": 0.224, "load_throughput": 534760.391, "learn_time_ms": 2.843, "learn_throughput": 42210.372, "synch_weights_time_ms": 0.736}, "counters": {"num_env_steps_sampled": 273720, "num_env_steps_trained": 273720, "num_agent_steps_sampled": 273720, "num_agent_steps_trained": 273720}, "done": false, "episodes_total": 2281, "training_iteration": 571, "trial_id": "29a31_00000", "date": "2023-07-26_02-44-34", "timestamp": 1690328674, "time_this_iter_s": 11.876009941101074, "time_total_s": 6919.496655702591, "pid": 90822, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 1, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[253680, 5e-06], [256080, 5e-06], [258480, 2.5e-06], [260880, 2.5e-06], [263280, 2.5e-06], [265680, 2.5e-06], [268080, 1e-06], [270480, 1e-06], [272880, 1e-06], [275280, 5e-07], [277680, 5e-07], [280080, 5e-07], [282480, 5e-07], [284880, 5e-07], [287280, 1e-07], [289680, 1e-07], [292080, 1e-07]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 120, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x16ca65700>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1298.1711797714233, "iterations_since_restore": 111, "perf": {"cpu_util_percent": 38.50625, "ram_util_percent": 77.65}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 7.5e-07, "entropy_coeff": 0.05, "policy_entropy": 265.77264404296875, "policy_loss": -132930.078125, "vf_loss": 7999411.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 447.0, "diff_num_grad_updates_vs_sampler_policy": 446.0}}, "num_env_steps_sampled": 274200, "num_env_steps_trained": 274200, "num_agent_steps_sampled": 274200, "num_agent_steps_trained": 274200}, "sampler_results": {"episode_reward_max": -272.31552728616106, "episode_reward_min": -1108.4090223671267, "episode_reward_mean": -712.4856009415157, "episode_len_mean": 120.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-651.0406053492508, -817.6958478805825, -606.2983100992903, -681.0746717262585, -816.8936860624655, -706.4786605700737, -1044.5855233606906, -585.0944500764128, -385.0153366421304, -839.2397681819978, -975.8865490336793, -853.3414434755031, -912.9648169829818, -1108.4090223671267, -879.6547428146221, -870.2197700234386, -603.7880686842849, -1053.0806957298885, -801.9626659898719, -813.2004761991038, -390.28266894907233, -787.5212111763349, -620.2969929910752, -576.1134218552871, -875.3310221140351, -784.3060011469621, -529.436838816755, -552.3296880642856, -900.6715073624943, -672.5117722411179, -272.31552728616106, -650.9837003748399, -804.12847176988, -448.0585819875234, -831.4354898360913, -673.3486780915445, -582.773580763202, -559.9339705182151, -862.8252586335362, -724.8211276933365, -611.0126685427279, -660.4702908239256, -440.0600391494581, -631.5489254456106, -533.793376273585, -351.12785653806856, -584.7363253973668, -544.3566525455012, -741.4994338588891, -709.3517955170172, -629.2288466800566, -955.426423284139, -407.39508120066404, -783.9544336138666, -499.8737708572136, -693.5024698593968, -696.0666360585428, -561.1632121055709, -435.91501137047806, -604.0317505983413, -939.3383088823931, -716.2847152315428, -915.5897601991649, -972.9648107527968, -976.0298988284203, -785.0108339137687, -592.4608953946511, -553.2364232081312, -802.9696807975071, -657.9355352556672, -850.5801311461079, -676.3735104351586, -726.9580268886344, -984.4916792183878, -616.6977224988905, -915.1358362429053, -893.7816637274223, -624.647383853262, -723.8986036735728, -471.42117465765386, -831.0077487444229, -947.0396737642479, -634.663800990879, -807.2580484403014, -648.9219181161432, -620.3567345551995, -639.4533850960762, -943.8606594988436, -858.495290093199, -786.4370754929433, -786.6827755922249, -563.973340859308, -464.8012292399626, -865.170113788972, -582.8359530439983, -537.7537778844808, -759.6805018287604, -610.7492818518934, -834.2038676824883, -949.5427001393628], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 21.131696303482517, "mean_inference_ms": 0.4005471256548775, "mean_action_processing_ms": 0.09567459185436412, "mean_env_wait_ms": 2.7087104009394225, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003904104232788086, "StateBufferConnector_ms": 0.0027222633361816406, "ViewRequirementAgentConnector_ms": 0.06723999977111816}}, "episode_reward_max": -272.31552728616106, "episode_reward_min": -1108.4090223671267, "episode_reward_mean": -712.4856009415157, "episode_len_mean": 120.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-651.0406053492508, -817.6958478805825, -606.2983100992903, -681.0746717262585, -816.8936860624655, -706.4786605700737, -1044.5855233606906, -585.0944500764128, -385.0153366421304, -839.2397681819978, -975.8865490336793, -853.3414434755031, -912.9648169829818, -1108.4090223671267, -879.6547428146221, -870.2197700234386, -603.7880686842849, -1053.0806957298885, -801.9626659898719, -813.2004761991038, -390.28266894907233, -787.5212111763349, -620.2969929910752, -576.1134218552871, -875.3310221140351, -784.3060011469621, -529.436838816755, -552.3296880642856, -900.6715073624943, -672.5117722411179, -272.31552728616106, -650.9837003748399, -804.12847176988, -448.0585819875234, -831.4354898360913, -673.3486780915445, -582.773580763202, -559.9339705182151, -862.8252586335362, -724.8211276933365, -611.0126685427279, -660.4702908239256, -440.0600391494581, -631.5489254456106, -533.793376273585, -351.12785653806856, -584.7363253973668, -544.3566525455012, -741.4994338588891, -709.3517955170172, -629.2288466800566, -955.426423284139, -407.39508120066404, -783.9544336138666, -499.8737708572136, -693.5024698593968, -696.0666360585428, -561.1632121055709, -435.91501137047806, -604.0317505983413, -939.3383088823931, -716.2847152315428, -915.5897601991649, -972.9648107527968, -976.0298988284203, -785.0108339137687, -592.4608953946511, -553.2364232081312, -802.9696807975071, -657.9355352556672, -850.5801311461079, -676.3735104351586, -726.9580268886344, -984.4916792183878, -616.6977224988905, -915.1358362429053, -893.7816637274223, -624.647383853262, -723.8986036735728, -471.42117465765386, -831.0077487444229, -947.0396737642479, -634.663800990879, -807.2580484403014, -648.9219181161432, -620.3567345551995, -639.4533850960762, -943.8606594988436, -858.495290093199, -786.4370754929433, -786.6827755922249, -563.973340859308, -464.8012292399626, -865.170113788972, -582.8359530439983, -537.7537778844808, -759.6805018287604, -610.7492818518934, -834.2038676824883, -949.5427001393628], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 21.131696303482517, "mean_inference_ms": 0.4005471256548775, "mean_action_processing_ms": 0.09567459185436412, "mean_env_wait_ms": 2.7087104009394225, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003904104232788086, "StateBufferConnector_ms": 0.0027222633361816406, "ViewRequirementAgentConnector_ms": 0.06723999977111816}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 274200, "num_agent_steps_trained": 274200, "num_env_steps_sampled": 274200, "num_env_steps_trained": 274200, "num_env_steps_sampled_this_iter": 480, "num_env_steps_trained_this_iter": 480, "num_env_steps_sampled_throughput_per_sec": 41.16130787102253, "num_env_steps_trained_throughput_per_sec": 41.16130787102253, "timesteps_total": 274200, "num_steps_trained_this_iter": 480, "agent_timesteps_total": 274200, "timers": {"training_iteration_time_ms": 2941.536, "sample_time_ms": 2937.68, "load_time_ms": 0.224, "load_throughput": 535215.313, "learn_time_ms": 2.852, "learn_throughput": 42079.799, "synch_weights_time_ms": 0.733}, "counters": {"num_env_steps_sampled": 274200, "num_env_steps_trained": 274200, "num_agent_steps_sampled": 274200, "num_agent_steps_trained": 274200}, "done": false, "episodes_total": 2285, "training_iteration": 572, "trial_id": "29a31_00000", "date": "2023-07-26_02-44-45", "timestamp": 1690328685, "time_this_iter_s": 11.664444208145142, "time_total_s": 6931.161099910736, "pid": 90822, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 1, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[253680, 5e-06], [256080, 5e-06], [258480, 2.5e-06], [260880, 2.5e-06], [263280, 2.5e-06], [265680, 2.5e-06], [268080, 1e-06], [270480, 1e-06], [272880, 1e-06], [275280, 5e-07], [277680, 5e-07], [280080, 5e-07], [282480, 5e-07], [284880, 5e-07], [287280, 1e-07], [289680, 1e-07], [292080, 1e-07]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 120, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x16ca65700>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1309.8356239795685, "iterations_since_restore": 112, "perf": {"cpu_util_percent": 33.2235294117647, "ram_util_percent": 76.82352941176471}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 6.499999999999999e-07, "entropy_coeff": 0.05, "policy_entropy": 265.8282165527344, "policy_loss": -74635.875, "vf_loss": 2225587.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 451.0, "diff_num_grad_updates_vs_sampler_policy": 450.0}}, "num_env_steps_sampled": 274680, "num_env_steps_trained": 274680, "num_agent_steps_sampled": 274680, "num_agent_steps_trained": 274680}, "sampler_results": {"episode_reward_max": -272.31552728616106, "episode_reward_min": -1108.4090223671267, "episode_reward_mean": -710.5398480094473, "episode_len_mean": 120.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-816.8936860624655, -706.4786605700737, -1044.5855233606906, -585.0944500764128, -385.0153366421304, -839.2397681819978, -975.8865490336793, -853.3414434755031, -912.9648169829818, -1108.4090223671267, -879.6547428146221, -870.2197700234386, -603.7880686842849, -1053.0806957298885, -801.9626659898719, -813.2004761991038, -390.28266894907233, -787.5212111763349, -620.2969929910752, -576.1134218552871, -875.3310221140351, -784.3060011469621, -529.436838816755, -552.3296880642856, -900.6715073624943, -672.5117722411179, -272.31552728616106, -650.9837003748399, -804.12847176988, -448.0585819875234, -831.4354898360913, -673.3486780915445, -582.773580763202, -559.9339705182151, -862.8252586335362, -724.8211276933365, -611.0126685427279, -660.4702908239256, -440.0600391494581, -631.5489254456106, -533.793376273585, -351.12785653806856, -584.7363253973668, -544.3566525455012, -741.4994338588891, -709.3517955170172, -629.2288466800566, -955.426423284139, -407.39508120066404, -783.9544336138666, -499.8737708572136, -693.5024698593968, -696.0666360585428, -561.1632121055709, -435.91501137047806, -604.0317505983413, -939.3383088823931, -716.2847152315428, -915.5897601991649, -972.9648107527968, -976.0298988284203, -785.0108339137687, -592.4608953946511, -553.2364232081312, -802.9696807975071, -657.9355352556672, -850.5801311461079, -676.3735104351586, -726.9580268886344, -984.4916792183878, -616.6977224988905, -915.1358362429053, -893.7816637274223, -624.647383853262, -723.8986036735728, -471.42117465765386, -831.0077487444229, -947.0396737642479, -634.663800990879, -807.2580484403014, -648.9219181161432, -620.3567345551995, -639.4533850960762, -943.8606594988436, -858.495290093199, -786.4370754929433, -786.6827755922249, -563.973340859308, -464.8012292399626, -865.170113788972, -582.8359530439983, -537.7537778844808, -759.6805018287604, -610.7492818518934, -834.2038676824883, -949.5427001393628, -667.1258244678824, -700.8509962992503, -648.5050724387345, -545.0522486426842], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 21.13198078602789, "mean_inference_ms": 0.4005468658226192, "mean_action_processing_ms": 0.09567513626133418, "mean_env_wait_ms": 2.708123433743541, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0039031505584716797, "StateBufferConnector_ms": 0.002718210220336914, "ViewRequirementAgentConnector_ms": 0.06727051734924316}}, "episode_reward_max": -272.31552728616106, "episode_reward_min": -1108.4090223671267, "episode_reward_mean": -710.5398480094473, "episode_len_mean": 120.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-816.8936860624655, -706.4786605700737, -1044.5855233606906, -585.0944500764128, -385.0153366421304, -839.2397681819978, -975.8865490336793, -853.3414434755031, -912.9648169829818, -1108.4090223671267, -879.6547428146221, -870.2197700234386, -603.7880686842849, -1053.0806957298885, -801.9626659898719, -813.2004761991038, -390.28266894907233, -787.5212111763349, -620.2969929910752, -576.1134218552871, -875.3310221140351, -784.3060011469621, -529.436838816755, -552.3296880642856, -900.6715073624943, -672.5117722411179, -272.31552728616106, -650.9837003748399, -804.12847176988, -448.0585819875234, -831.4354898360913, -673.3486780915445, -582.773580763202, -559.9339705182151, -862.8252586335362, -724.8211276933365, -611.0126685427279, -660.4702908239256, -440.0600391494581, -631.5489254456106, -533.793376273585, -351.12785653806856, -584.7363253973668, -544.3566525455012, -741.4994338588891, -709.3517955170172, -629.2288466800566, -955.426423284139, -407.39508120066404, -783.9544336138666, -499.8737708572136, -693.5024698593968, -696.0666360585428, -561.1632121055709, -435.91501137047806, -604.0317505983413, -939.3383088823931, -716.2847152315428, -915.5897601991649, -972.9648107527968, -976.0298988284203, -785.0108339137687, -592.4608953946511, -553.2364232081312, -802.9696807975071, -657.9355352556672, -850.5801311461079, -676.3735104351586, -726.9580268886344, -984.4916792183878, -616.6977224988905, -915.1358362429053, -893.7816637274223, -624.647383853262, -723.8986036735728, -471.42117465765386, -831.0077487444229, -947.0396737642479, -634.663800990879, -807.2580484403014, -648.9219181161432, -620.3567345551995, -639.4533850960762, -943.8606594988436, -858.495290093199, -786.4370754929433, -786.6827755922249, -563.973340859308, -464.8012292399626, -865.170113788972, -582.8359530439983, -537.7537778844808, -759.6805018287604, -610.7492818518934, -834.2038676824883, -949.5427001393628, -667.1258244678824, -700.8509962992503, -648.5050724387345, -545.0522486426842], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 21.13198078602789, "mean_inference_ms": 0.4005468658226192, "mean_action_processing_ms": 0.09567513626133418, "mean_env_wait_ms": 2.708123433743541, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0039031505584716797, "StateBufferConnector_ms": 0.002718210220336914, "ViewRequirementAgentConnector_ms": 0.06727051734924316}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 274680, "num_agent_steps_trained": 274680, "num_env_steps_sampled": 274680, "num_env_steps_trained": 274680, "num_env_steps_sampled_this_iter": 480, "num_env_steps_trained_this_iter": 480, "num_env_steps_sampled_throughput_per_sec": 41.54364373657941, "num_env_steps_trained_throughput_per_sec": 41.54364373657941, "timesteps_total": 274680, "num_steps_trained_this_iter": 480, "agent_timesteps_total": 274680, "timers": {"training_iteration_time_ms": 2923.129, "sample_time_ms": 2919.344, "load_time_ms": 0.223, "load_throughput": 538825.051, "learn_time_ms": 2.8, "learn_throughput": 42858.425, "synch_weights_time_ms": 0.717}, "counters": {"num_env_steps_sampled": 274680, "num_env_steps_trained": 274680, "num_agent_steps_sampled": 274680, "num_agent_steps_trained": 274680}, "done": false, "episodes_total": 2289, "training_iteration": 573, "trial_id": "29a31_00000", "date": "2023-07-26_02-44-57", "timestamp": 1690328697, "time_this_iter_s": 11.556904077529907, "time_total_s": 6942.718003988266, "pid": 90822, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 1, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[253680, 5e-06], [256080, 5e-06], [258480, 2.5e-06], [260880, 2.5e-06], [263280, 2.5e-06], [265680, 2.5e-06], [268080, 1e-06], [270480, 1e-06], [272880, 1e-06], [275280, 5e-07], [277680, 5e-07], [280080, 5e-07], [282480, 5e-07], [284880, 5e-07], [287280, 1e-07], [289680, 1e-07], [292080, 1e-07]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 120, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x16ca65700>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1321.3925280570984, "iterations_since_restore": 113, "perf": {"cpu_util_percent": 36.21875, "ram_util_percent": 75.725}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 5.5e-07, "entropy_coeff": 0.05, "policy_entropy": 265.82073974609375, "policy_loss": -113612.5390625, "vf_loss": 5204692.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 455.0, "diff_num_grad_updates_vs_sampler_policy": 454.0}}, "num_env_steps_sampled": 275160, "num_env_steps_trained": 275160, "num_agent_steps_sampled": 275160, "num_agent_steps_trained": 275160}, "sampler_results": {"episode_reward_max": -272.31552728616106, "episode_reward_min": -1108.4090223671267, "episode_reward_mean": -713.537005040579, "episode_len_mean": 120.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-385.0153366421304, -839.2397681819978, -975.8865490336793, -853.3414434755031, -912.9648169829818, -1108.4090223671267, -879.6547428146221, -870.2197700234386, -603.7880686842849, -1053.0806957298885, -801.9626659898719, -813.2004761991038, -390.28266894907233, -787.5212111763349, -620.2969929910752, -576.1134218552871, -875.3310221140351, -784.3060011469621, -529.436838816755, -552.3296880642856, -900.6715073624943, -672.5117722411179, -272.31552728616106, -650.9837003748399, -804.12847176988, -448.0585819875234, -831.4354898360913, -673.3486780915445, -582.773580763202, -559.9339705182151, -862.8252586335362, -724.8211276933365, -611.0126685427279, -660.4702908239256, -440.0600391494581, -631.5489254456106, -533.793376273585, -351.12785653806856, -584.7363253973668, -544.3566525455012, -741.4994338588891, -709.3517955170172, -629.2288466800566, -955.426423284139, -407.39508120066404, -783.9544336138666, -499.8737708572136, -693.5024698593968, -696.0666360585428, -561.1632121055709, -435.91501137047806, -604.0317505983413, -939.3383088823931, -716.2847152315428, -915.5897601991649, -972.9648107527968, -976.0298988284203, -785.0108339137687, -592.4608953946511, -553.2364232081312, -802.9696807975071, -657.9355352556672, -850.5801311461079, -676.3735104351586, -726.9580268886344, -984.4916792183878, -616.6977224988905, -915.1358362429053, -893.7816637274223, -624.647383853262, -723.8986036735728, -471.42117465765386, -831.0077487444229, -947.0396737642479, -634.663800990879, -807.2580484403014, -648.9219181161432, -620.3567345551995, -639.4533850960762, -943.8606594988436, -858.495290093199, -786.4370754929433, -786.6827755922249, -563.973340859308, -464.8012292399626, -865.170113788972, -582.8359530439983, -537.7537778844808, -759.6805018287604, -610.7492818518934, -834.2038676824883, -949.5427001393628, -667.1258244678824, -700.8509962992503, -648.5050724387345, -545.0522486426842, -925.2814935636152, -801.4027627857698, -912.1556027608797, -813.9281640725316], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 21.132190417634007, "mean_inference_ms": 0.40054933676101584, "mean_action_processing_ms": 0.09567618794078331, "mean_env_wait_ms": 2.7075312213970175, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0039055347442626953, "StateBufferConnector_ms": 0.0027060508728027344, "ViewRequirementAgentConnector_ms": 0.06729626655578613}}, "episode_reward_max": -272.31552728616106, "episode_reward_min": -1108.4090223671267, "episode_reward_mean": -713.537005040579, "episode_len_mean": 120.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-385.0153366421304, -839.2397681819978, -975.8865490336793, -853.3414434755031, -912.9648169829818, -1108.4090223671267, -879.6547428146221, -870.2197700234386, -603.7880686842849, -1053.0806957298885, -801.9626659898719, -813.2004761991038, -390.28266894907233, -787.5212111763349, -620.2969929910752, -576.1134218552871, -875.3310221140351, -784.3060011469621, -529.436838816755, -552.3296880642856, -900.6715073624943, -672.5117722411179, -272.31552728616106, -650.9837003748399, -804.12847176988, -448.0585819875234, -831.4354898360913, -673.3486780915445, -582.773580763202, -559.9339705182151, -862.8252586335362, -724.8211276933365, -611.0126685427279, -660.4702908239256, -440.0600391494581, -631.5489254456106, -533.793376273585, -351.12785653806856, -584.7363253973668, -544.3566525455012, -741.4994338588891, -709.3517955170172, -629.2288466800566, -955.426423284139, -407.39508120066404, -783.9544336138666, -499.8737708572136, -693.5024698593968, -696.0666360585428, -561.1632121055709, -435.91501137047806, -604.0317505983413, -939.3383088823931, -716.2847152315428, -915.5897601991649, -972.9648107527968, -976.0298988284203, -785.0108339137687, -592.4608953946511, -553.2364232081312, -802.9696807975071, -657.9355352556672, -850.5801311461079, -676.3735104351586, -726.9580268886344, -984.4916792183878, -616.6977224988905, -915.1358362429053, -893.7816637274223, -624.647383853262, -723.8986036735728, -471.42117465765386, -831.0077487444229, -947.0396737642479, -634.663800990879, -807.2580484403014, -648.9219181161432, -620.3567345551995, -639.4533850960762, -943.8606594988436, -858.495290093199, -786.4370754929433, -786.6827755922249, -563.973340859308, -464.8012292399626, -865.170113788972, -582.8359530439983, -537.7537778844808, -759.6805018287604, -610.7492818518934, -834.2038676824883, -949.5427001393628, -667.1258244678824, -700.8509962992503, -648.5050724387345, -545.0522486426842, -925.2814935636152, -801.4027627857698, -912.1556027608797, -813.9281640725316], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 21.132190417634007, "mean_inference_ms": 0.40054933676101584, "mean_action_processing_ms": 0.09567618794078331, "mean_env_wait_ms": 2.7075312213970175, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0039055347442626953, "StateBufferConnector_ms": 0.0027060508728027344, "ViewRequirementAgentConnector_ms": 0.06729626655578613}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 275160, "num_agent_steps_trained": 275160, "num_env_steps_sampled": 275160, "num_env_steps_trained": 275160, "num_env_steps_sampled_this_iter": 480, "num_env_steps_trained_this_iter": 480, "num_env_steps_sampled_throughput_per_sec": 41.85643032556675, "num_env_steps_trained_throughput_per_sec": 41.85643032556675, "timesteps_total": 275160, "num_steps_trained_this_iter": 480, "agent_timesteps_total": 275160, "timers": {"training_iteration_time_ms": 2885.807, "sample_time_ms": 2882.012, "load_time_ms": 0.219, "load_throughput": 548454.266, "learn_time_ms": 2.799, "learn_throughput": 42868.28, "synch_weights_time_ms": 0.736}, "counters": {"num_env_steps_sampled": 275160, "num_env_steps_trained": 275160, "num_agent_steps_sampled": 275160, "num_agent_steps_trained": 275160}, "done": false, "episodes_total": 2293, "training_iteration": 574, "trial_id": "29a31_00000", "date": "2023-07-26_02-45-09", "timestamp": 1690328709, "time_this_iter_s": 11.470555305480957, "time_total_s": 6954.188559293747, "pid": 90822, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 1, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[253680, 5e-06], [256080, 5e-06], [258480, 2.5e-06], [260880, 2.5e-06], [263280, 2.5e-06], [265680, 2.5e-06], [268080, 1e-06], [270480, 1e-06], [272880, 1e-06], [275280, 5e-07], [277680, 5e-07], [280080, 5e-07], [282480, 5e-07], [284880, 5e-07], [287280, 1e-07], [289680, 1e-07], [292080, 1e-07]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 120, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x16ca65700>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1332.8630833625793, "iterations_since_restore": 114, "perf": {"cpu_util_percent": 38.45294117647058, "ram_util_percent": 76.00588235294117}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 5e-07, "entropy_coeff": 0.05, "policy_entropy": 265.8063049316406, "policy_loss": -105154.4609375, "vf_loss": 5423556.5}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 459.0, "diff_num_grad_updates_vs_sampler_policy": 458.0}}, "num_env_steps_sampled": 275640, "num_env_steps_trained": 275640, "num_agent_steps_sampled": 275640, "num_agent_steps_trained": 275640}, "sampler_results": {"episode_reward_max": -272.31552728616106, "episode_reward_min": -1108.4090223671267, "episode_reward_mean": -710.3615022332295, "episode_len_mean": 120.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-912.9648169829818, -1108.4090223671267, -879.6547428146221, -870.2197700234386, -603.7880686842849, -1053.0806957298885, -801.9626659898719, -813.2004761991038, -390.28266894907233, -787.5212111763349, -620.2969929910752, -576.1134218552871, -875.3310221140351, -784.3060011469621, -529.436838816755, -552.3296880642856, -900.6715073624943, -672.5117722411179, -272.31552728616106, -650.9837003748399, -804.12847176988, -448.0585819875234, -831.4354898360913, -673.3486780915445, -582.773580763202, -559.9339705182151, -862.8252586335362, -724.8211276933365, -611.0126685427279, -660.4702908239256, -440.0600391494581, -631.5489254456106, -533.793376273585, -351.12785653806856, -584.7363253973668, -544.3566525455012, -741.4994338588891, -709.3517955170172, -629.2288466800566, -955.426423284139, -407.39508120066404, -783.9544336138666, -499.8737708572136, -693.5024698593968, -696.0666360585428, -561.1632121055709, -435.91501137047806, -604.0317505983413, -939.3383088823931, -716.2847152315428, -915.5897601991649, -972.9648107527968, -976.0298988284203, -785.0108339137687, -592.4608953946511, -553.2364232081312, -802.9696807975071, -657.9355352556672, -850.5801311461079, -676.3735104351586, -726.9580268886344, -984.4916792183878, -616.6977224988905, -915.1358362429053, -893.7816637274223, -624.647383853262, -723.8986036735728, -471.42117465765386, -831.0077487444229, -947.0396737642479, -634.663800990879, -807.2580484403014, -648.9219181161432, -620.3567345551995, -639.4533850960762, -943.8606594988436, -858.495290093199, -786.4370754929433, -786.6827755922249, -563.973340859308, -464.8012292399626, -865.170113788972, -582.8359530439983, -537.7537778844808, -759.6805018287604, -610.7492818518934, -834.2038676824883, -949.5427001393628, -667.1258244678824, -700.8509962992503, -648.5050724387345, -545.0522486426842, -925.2814935636152, -801.4027627857698, -912.1556027608797, -813.9281640725316, -584.2112016587049, -787.9273601768657, -563.0925867475765, -800.7016680152313], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 21.13242808919495, "mean_inference_ms": 0.4005498584845331, "mean_action_processing_ms": 0.09567691261046622, "mean_env_wait_ms": 2.706992943557177, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003904104232788086, "StateBufferConnector_ms": 0.0027043819427490234, "ViewRequirementAgentConnector_ms": 0.06729650497436523}}, "episode_reward_max": -272.31552728616106, "episode_reward_min": -1108.4090223671267, "episode_reward_mean": -710.3615022332295, "episode_len_mean": 120.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-912.9648169829818, -1108.4090223671267, -879.6547428146221, -870.2197700234386, -603.7880686842849, -1053.0806957298885, -801.9626659898719, -813.2004761991038, -390.28266894907233, -787.5212111763349, -620.2969929910752, -576.1134218552871, -875.3310221140351, -784.3060011469621, -529.436838816755, -552.3296880642856, -900.6715073624943, -672.5117722411179, -272.31552728616106, -650.9837003748399, -804.12847176988, -448.0585819875234, -831.4354898360913, -673.3486780915445, -582.773580763202, -559.9339705182151, -862.8252586335362, -724.8211276933365, -611.0126685427279, -660.4702908239256, -440.0600391494581, -631.5489254456106, -533.793376273585, -351.12785653806856, -584.7363253973668, -544.3566525455012, -741.4994338588891, -709.3517955170172, -629.2288466800566, -955.426423284139, -407.39508120066404, -783.9544336138666, -499.8737708572136, -693.5024698593968, -696.0666360585428, -561.1632121055709, -435.91501137047806, -604.0317505983413, -939.3383088823931, -716.2847152315428, -915.5897601991649, -972.9648107527968, -976.0298988284203, -785.0108339137687, -592.4608953946511, -553.2364232081312, -802.9696807975071, -657.9355352556672, -850.5801311461079, -676.3735104351586, -726.9580268886344, -984.4916792183878, -616.6977224988905, -915.1358362429053, -893.7816637274223, -624.647383853262, -723.8986036735728, -471.42117465765386, -831.0077487444229, -947.0396737642479, -634.663800990879, -807.2580484403014, -648.9219181161432, -620.3567345551995, -639.4533850960762, -943.8606594988436, -858.495290093199, -786.4370754929433, -786.6827755922249, -563.973340859308, -464.8012292399626, -865.170113788972, -582.8359530439983, -537.7537778844808, -759.6805018287604, -610.7492818518934, -834.2038676824883, -949.5427001393628, -667.1258244678824, -700.8509962992503, -648.5050724387345, -545.0522486426842, -925.2814935636152, -801.4027627857698, -912.1556027608797, -813.9281640725316, -584.2112016587049, -787.9273601768657, -563.0925867475765, -800.7016680152313], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 21.13242808919495, "mean_inference_ms": 0.4005498584845331, "mean_action_processing_ms": 0.09567691261046622, "mean_env_wait_ms": 2.706992943557177, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003904104232788086, "StateBufferConnector_ms": 0.0027043819427490234, "ViewRequirementAgentConnector_ms": 0.06729650497436523}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 275640, "num_agent_steps_trained": 275640, "num_env_steps_sampled": 275640, "num_env_steps_trained": 275640, "num_env_steps_sampled_this_iter": 480, "num_env_steps_trained_this_iter": 480, "num_env_steps_sampled_throughput_per_sec": 39.56233215495208, "num_env_steps_trained_throughput_per_sec": 39.56233215495208, "timesteps_total": 275640, "num_steps_trained_this_iter": 480, "agent_timesteps_total": 275640, "timers": {"training_iteration_time_ms": 2939.609, "sample_time_ms": 2935.773, "load_time_ms": 0.22, "load_throughput": 545245.889, "learn_time_ms": 2.839, "learn_throughput": 42264.248, "synch_weights_time_ms": 0.736}, "counters": {"num_env_steps_sampled": 275640, "num_env_steps_trained": 275640, "num_agent_steps_sampled": 275640, "num_agent_steps_trained": 275640}, "done": false, "episodes_total": 2297, "training_iteration": 575, "trial_id": "29a31_00000", "date": "2023-07-26_02-45-21", "timestamp": 1690328721, "time_this_iter_s": 12.135499000549316, "time_total_s": 6966.324058294296, "pid": 90822, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 1, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[253680, 5e-06], [256080, 5e-06], [258480, 2.5e-06], [260880, 2.5e-06], [263280, 2.5e-06], [265680, 2.5e-06], [268080, 1e-06], [270480, 1e-06], [272880, 1e-06], [275280, 5e-07], [277680, 5e-07], [280080, 5e-07], [282480, 5e-07], [284880, 5e-07], [287280, 1e-07], [289680, 1e-07], [292080, 1e-07]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 120, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x16ca65700>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1344.9985823631287, "iterations_since_restore": 115, "perf": {"cpu_util_percent": 36.88235294117647, "ram_util_percent": 76.03529411764706}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 5e-07, "entropy_coeff": 0.05, "policy_entropy": 265.79705810546875, "policy_loss": -98783.5234375, "vf_loss": 4586195.5}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 463.0, "diff_num_grad_updates_vs_sampler_policy": 462.0}}, "num_env_steps_sampled": 276120, "num_env_steps_trained": 276120, "num_agent_steps_sampled": 276120, "num_agent_steps_trained": 276120}, "sampler_results": {"episode_reward_max": -272.31552728616106, "episode_reward_min": -1053.0806957298885, "episode_reward_mean": -704.8834938977514, "episode_len_mean": 120.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-603.7880686842849, -1053.0806957298885, -801.9626659898719, -813.2004761991038, -390.28266894907233, -787.5212111763349, -620.2969929910752, -576.1134218552871, -875.3310221140351, -784.3060011469621, -529.436838816755, -552.3296880642856, -900.6715073624943, -672.5117722411179, -272.31552728616106, -650.9837003748399, -804.12847176988, -448.0585819875234, -831.4354898360913, -673.3486780915445, -582.773580763202, -559.9339705182151, -862.8252586335362, -724.8211276933365, -611.0126685427279, -660.4702908239256, -440.0600391494581, -631.5489254456106, -533.793376273585, -351.12785653806856, -584.7363253973668, -544.3566525455012, -741.4994338588891, -709.3517955170172, -629.2288466800566, -955.426423284139, -407.39508120066404, -783.9544336138666, -499.8737708572136, -693.5024698593968, -696.0666360585428, -561.1632121055709, -435.91501137047806, -604.0317505983413, -939.3383088823931, -716.2847152315428, -915.5897601991649, -972.9648107527968, -976.0298988284203, -785.0108339137687, -592.4608953946511, -553.2364232081312, -802.9696807975071, -657.9355352556672, -850.5801311461079, -676.3735104351586, -726.9580268886344, -984.4916792183878, -616.6977224988905, -915.1358362429053, -893.7816637274223, -624.647383853262, -723.8986036735728, -471.42117465765386, -831.0077487444229, -947.0396737642479, -634.663800990879, -807.2580484403014, -648.9219181161432, -620.3567345551995, -639.4533850960762, -943.8606594988436, -858.495290093199, -786.4370754929433, -786.6827755922249, -563.973340859308, -464.8012292399626, -865.170113788972, -582.8359530439983, -537.7537778844808, -759.6805018287604, -610.7492818518934, -834.2038676824883, -949.5427001393628, -667.1258244678824, -700.8509962992503, -648.5050724387345, -545.0522486426842, -925.2814935636152, -801.4027627857698, -912.1556027608797, -813.9281640725316, -584.2112016587049, -787.9273601768657, -563.0925867475765, -800.7016680152313, -913.9847801122165, -847.9866764941737, -643.2681590791219, -818.2079029548335], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 21.13283635968963, "mean_inference_ms": 0.40054814607080785, "mean_action_processing_ms": 0.09567719414282727, "mean_env_wait_ms": 2.7064558356864246, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0039017200469970703, "StateBufferConnector_ms": 0.0027081966400146484, "ViewRequirementAgentConnector_ms": 0.06730127334594727}}, "episode_reward_max": -272.31552728616106, "episode_reward_min": -1053.0806957298885, "episode_reward_mean": -704.8834938977514, "episode_len_mean": 120.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-603.7880686842849, -1053.0806957298885, -801.9626659898719, -813.2004761991038, -390.28266894907233, -787.5212111763349, -620.2969929910752, -576.1134218552871, -875.3310221140351, -784.3060011469621, -529.436838816755, -552.3296880642856, -900.6715073624943, -672.5117722411179, -272.31552728616106, -650.9837003748399, -804.12847176988, -448.0585819875234, -831.4354898360913, -673.3486780915445, -582.773580763202, -559.9339705182151, -862.8252586335362, -724.8211276933365, -611.0126685427279, -660.4702908239256, -440.0600391494581, -631.5489254456106, -533.793376273585, -351.12785653806856, -584.7363253973668, -544.3566525455012, -741.4994338588891, -709.3517955170172, -629.2288466800566, -955.426423284139, -407.39508120066404, -783.9544336138666, -499.8737708572136, -693.5024698593968, -696.0666360585428, -561.1632121055709, -435.91501137047806, -604.0317505983413, -939.3383088823931, -716.2847152315428, -915.5897601991649, -972.9648107527968, -976.0298988284203, -785.0108339137687, -592.4608953946511, -553.2364232081312, -802.9696807975071, -657.9355352556672, -850.5801311461079, -676.3735104351586, -726.9580268886344, -984.4916792183878, -616.6977224988905, -915.1358362429053, -893.7816637274223, -624.647383853262, -723.8986036735728, -471.42117465765386, -831.0077487444229, -947.0396737642479, -634.663800990879, -807.2580484403014, -648.9219181161432, -620.3567345551995, -639.4533850960762, -943.8606594988436, -858.495290093199, -786.4370754929433, -786.6827755922249, -563.973340859308, -464.8012292399626, -865.170113788972, -582.8359530439983, -537.7537778844808, -759.6805018287604, -610.7492818518934, -834.2038676824883, -949.5427001393628, -667.1258244678824, -700.8509962992503, -648.5050724387345, -545.0522486426842, -925.2814935636152, -801.4027627857698, -912.1556027608797, -813.9281640725316, -584.2112016587049, -787.9273601768657, -563.0925867475765, -800.7016680152313, -913.9847801122165, -847.9866764941737, -643.2681590791219, -818.2079029548335], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 21.13283635968963, "mean_inference_ms": 0.40054814607080785, "mean_action_processing_ms": 0.09567719414282727, "mean_env_wait_ms": 2.7064558356864246, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0039017200469970703, "StateBufferConnector_ms": 0.0027081966400146484, "ViewRequirementAgentConnector_ms": 0.06730127334594727}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 276120, "num_agent_steps_trained": 276120, "num_env_steps_sampled": 276120, "num_env_steps_trained": 276120, "num_env_steps_sampled_this_iter": 480, "num_env_steps_trained_this_iter": 480, "num_env_steps_sampled_throughput_per_sec": 39.74285093306376, "num_env_steps_trained_throughput_per_sec": 39.74285093306376, "timesteps_total": 276120, "num_steps_trained_this_iter": 480, "agent_timesteps_total": 276120, "timers": {"training_iteration_time_ms": 2992.301, "sample_time_ms": 2988.43, "load_time_ms": 0.222, "load_throughput": 540271.018, "learn_time_ms": 2.868, "learn_throughput": 41845.401, "synch_weights_time_ms": 0.74}, "counters": {"num_env_steps_sampled": 276120, "num_env_steps_trained": 276120, "num_agent_steps_sampled": 276120, "num_agent_steps_trained": 276120}, "done": false, "episodes_total": 2301, "training_iteration": 576, "trial_id": "29a31_00000", "date": "2023-07-26_02-45-33", "timestamp": 1690328733, "time_this_iter_s": 12.080710172653198, "time_total_s": 6978.4047684669495, "pid": 90822, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 1, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[253680, 5e-06], [256080, 5e-06], [258480, 2.5e-06], [260880, 2.5e-06], [263280, 2.5e-06], [265680, 2.5e-06], [268080, 1e-06], [270480, 1e-06], [272880, 1e-06], [275280, 5e-07], [277680, 5e-07], [280080, 5e-07], [282480, 5e-07], [284880, 5e-07], [287280, 1e-07], [289680, 1e-07], [292080, 1e-07]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 120, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x16ca65700>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1357.0792925357819, "iterations_since_restore": 116, "perf": {"cpu_util_percent": 37.63529411764706, "ram_util_percent": 77.38235294117648}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 5e-07, "entropy_coeff": 0.05, "policy_entropy": 265.72894287109375, "policy_loss": -53535.40234375, "vf_loss": 1477136.375}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 467.0, "diff_num_grad_updates_vs_sampler_policy": 466.0}}, "num_env_steps_sampled": 276600, "num_env_steps_trained": 276600, "num_agent_steps_sampled": 276600, "num_agent_steps_trained": 276600}, "sampler_results": {"episode_reward_max": -272.31552728616106, "episode_reward_min": -984.4916792183878, "episode_reward_mean": -692.3862859160373, "episode_len_mean": 120.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-390.28266894907233, -787.5212111763349, -620.2969929910752, -576.1134218552871, -875.3310221140351, -784.3060011469621, -529.436838816755, -552.3296880642856, -900.6715073624943, -672.5117722411179, -272.31552728616106, -650.9837003748399, -804.12847176988, -448.0585819875234, -831.4354898360913, -673.3486780915445, -582.773580763202, -559.9339705182151, -862.8252586335362, -724.8211276933365, -611.0126685427279, -660.4702908239256, -440.0600391494581, -631.5489254456106, -533.793376273585, -351.12785653806856, -584.7363253973668, -544.3566525455012, -741.4994338588891, -709.3517955170172, -629.2288466800566, -955.426423284139, -407.39508120066404, -783.9544336138666, -499.8737708572136, -693.5024698593968, -696.0666360585428, -561.1632121055709, -435.91501137047806, -604.0317505983413, -939.3383088823931, -716.2847152315428, -915.5897601991649, -972.9648107527968, -976.0298988284203, -785.0108339137687, -592.4608953946511, -553.2364232081312, -802.9696807975071, -657.9355352556672, -850.5801311461079, -676.3735104351586, -726.9580268886344, -984.4916792183878, -616.6977224988905, -915.1358362429053, -893.7816637274223, -624.647383853262, -723.8986036735728, -471.42117465765386, -831.0077487444229, -947.0396737642479, -634.663800990879, -807.2580484403014, -648.9219181161432, -620.3567345551995, -639.4533850960762, -943.8606594988436, -858.495290093199, -786.4370754929433, -786.6827755922249, -563.973340859308, -464.8012292399626, -865.170113788972, -582.8359530439983, -537.7537778844808, -759.6805018287604, -610.7492818518934, -834.2038676824883, -949.5427001393628, -667.1258244678824, -700.8509962992503, -648.5050724387345, -545.0522486426842, -925.2814935636152, -801.4027627857698, -912.1556027608797, -813.9281640725316, -584.2112016587049, -787.9273601768657, -563.0925867475765, -800.7016680152313, -913.9847801122165, -847.9866764941737, -643.2681590791219, -818.2079029548335, -453.51368003433026, -396.61829840819047, -665.3456250856366, -506.83350490356173], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 21.133263998455714, "mean_inference_ms": 0.40055282098231826, "mean_action_processing_ms": 0.0956784992715929, "mean_env_wait_ms": 2.7059336851307996, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0039010047912597656, "StateBufferConnector_ms": 0.0027031898498535156, "ViewRequirementAgentConnector_ms": 0.06731796264648438}}, "episode_reward_max": -272.31552728616106, "episode_reward_min": -984.4916792183878, "episode_reward_mean": -692.3862859160373, "episode_len_mean": 120.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-390.28266894907233, -787.5212111763349, -620.2969929910752, -576.1134218552871, -875.3310221140351, -784.3060011469621, -529.436838816755, -552.3296880642856, -900.6715073624943, -672.5117722411179, -272.31552728616106, -650.9837003748399, -804.12847176988, -448.0585819875234, -831.4354898360913, -673.3486780915445, -582.773580763202, -559.9339705182151, -862.8252586335362, -724.8211276933365, -611.0126685427279, -660.4702908239256, -440.0600391494581, -631.5489254456106, -533.793376273585, -351.12785653806856, -584.7363253973668, -544.3566525455012, -741.4994338588891, -709.3517955170172, -629.2288466800566, -955.426423284139, -407.39508120066404, -783.9544336138666, -499.8737708572136, -693.5024698593968, -696.0666360585428, -561.1632121055709, -435.91501137047806, -604.0317505983413, -939.3383088823931, -716.2847152315428, -915.5897601991649, -972.9648107527968, -976.0298988284203, -785.0108339137687, -592.4608953946511, -553.2364232081312, -802.9696807975071, -657.9355352556672, -850.5801311461079, -676.3735104351586, -726.9580268886344, -984.4916792183878, -616.6977224988905, -915.1358362429053, -893.7816637274223, -624.647383853262, -723.8986036735728, -471.42117465765386, -831.0077487444229, -947.0396737642479, -634.663800990879, -807.2580484403014, -648.9219181161432, -620.3567345551995, -639.4533850960762, -943.8606594988436, -858.495290093199, -786.4370754929433, -786.6827755922249, -563.973340859308, -464.8012292399626, -865.170113788972, -582.8359530439983, -537.7537778844808, -759.6805018287604, -610.7492818518934, -834.2038676824883, -949.5427001393628, -667.1258244678824, -700.8509962992503, -648.5050724387345, -545.0522486426842, -925.2814935636152, -801.4027627857698, -912.1556027608797, -813.9281640725316, -584.2112016587049, -787.9273601768657, -563.0925867475765, -800.7016680152313, -913.9847801122165, -847.9866764941737, -643.2681590791219, -818.2079029548335, -453.51368003433026, -396.61829840819047, -665.3456250856366, -506.83350490356173], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 21.133263998455714, "mean_inference_ms": 0.40055282098231826, "mean_action_processing_ms": 0.0956784992715929, "mean_env_wait_ms": 2.7059336851307996, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0039010047912597656, "StateBufferConnector_ms": 0.0027031898498535156, "ViewRequirementAgentConnector_ms": 0.06731796264648438}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 276600, "num_agent_steps_trained": 276600, "num_env_steps_sampled": 276600, "num_env_steps_trained": 276600, "num_env_steps_sampled_this_iter": 480, "num_env_steps_trained_this_iter": 480, "num_env_steps_sampled_throughput_per_sec": 41.790947939487474, "num_env_steps_trained_throughput_per_sec": 41.790947939487474, "timesteps_total": 276600, "num_steps_trained_this_iter": 480, "agent_timesteps_total": 276600, "timers": {"training_iteration_time_ms": 2939.355, "sample_time_ms": 2935.471, "load_time_ms": 0.224, "load_throughput": 535785.054, "learn_time_ms": 2.882, "learn_throughput": 41643.898, "synch_weights_time_ms": 0.736}, "counters": {"num_env_steps_sampled": 276600, "num_env_steps_trained": 276600, "num_agent_steps_sampled": 276600, "num_agent_steps_trained": 276600}, "done": false, "episodes_total": 2305, "training_iteration": 577, "trial_id": "29a31_00000", "date": "2023-07-26_02-45-44", "timestamp": 1690328744, "time_this_iter_s": 11.488692998886108, "time_total_s": 6989.893461465836, "pid": 90822, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 1, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[253680, 5e-06], [256080, 5e-06], [258480, 2.5e-06], [260880, 2.5e-06], [263280, 2.5e-06], [265680, 2.5e-06], [268080, 1e-06], [270480, 1e-06], [272880, 1e-06], [275280, 5e-07], [277680, 5e-07], [280080, 5e-07], [282480, 5e-07], [284880, 5e-07], [287280, 1e-07], [289680, 1e-07], [292080, 1e-07]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 120, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x16ca65700>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1368.567985534668, "iterations_since_restore": 117, "perf": {"cpu_util_percent": 36.48125, "ram_util_percent": 76.925}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 5e-07, "entropy_coeff": 0.05, "policy_entropy": 265.77886962890625, "policy_loss": -78957.7578125, "vf_loss": 3078724.25}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 471.0, "diff_num_grad_updates_vs_sampler_policy": 470.0}}, "num_env_steps_sampled": 277080, "num_env_steps_trained": 277080, "num_agent_steps_sampled": 277080, "num_agent_steps_trained": 277080}, "sampler_results": {"episode_reward_max": -272.31552728616106, "episode_reward_min": -984.4916792183878, "episode_reward_mean": -700.6317945011107, "episode_len_mean": 120.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-875.3310221140351, -784.3060011469621, -529.436838816755, -552.3296880642856, -900.6715073624943, -672.5117722411179, -272.31552728616106, -650.9837003748399, -804.12847176988, -448.0585819875234, -831.4354898360913, -673.3486780915445, -582.773580763202, -559.9339705182151, -862.8252586335362, -724.8211276933365, -611.0126685427279, -660.4702908239256, -440.0600391494581, -631.5489254456106, -533.793376273585, -351.12785653806856, -584.7363253973668, -544.3566525455012, -741.4994338588891, -709.3517955170172, -629.2288466800566, -955.426423284139, -407.39508120066404, -783.9544336138666, -499.8737708572136, -693.5024698593968, -696.0666360585428, -561.1632121055709, -435.91501137047806, -604.0317505983413, -939.3383088823931, -716.2847152315428, -915.5897601991649, -972.9648107527968, -976.0298988284203, -785.0108339137687, -592.4608953946511, -553.2364232081312, -802.9696807975071, -657.9355352556672, -850.5801311461079, -676.3735104351586, -726.9580268886344, -984.4916792183878, -616.6977224988905, -915.1358362429053, -893.7816637274223, -624.647383853262, -723.8986036735728, -471.42117465765386, -831.0077487444229, -947.0396737642479, -634.663800990879, -807.2580484403014, -648.9219181161432, -620.3567345551995, -639.4533850960762, -943.8606594988436, -858.495290093199, -786.4370754929433, -786.6827755922249, -563.973340859308, -464.8012292399626, -865.170113788972, -582.8359530439983, -537.7537778844808, -759.6805018287604, -610.7492818518934, -834.2038676824883, -949.5427001393628, -667.1258244678824, -700.8509962992503, -648.5050724387345, -545.0522486426842, -925.2814935636152, -801.4027627857698, -912.1556027608797, -813.9281640725316, -584.2112016587049, -787.9273601768657, -563.0925867475765, -800.7016680152313, -913.9847801122165, -847.9866764941737, -643.2681590791219, -818.2079029548335, -453.51368003433026, -396.61829840819047, -665.3456250856366, -506.83350490356173, -972.8543213673162, -573.5920277339925, -915.9296934869996, -736.3891108908471], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 21.133665798953924, "mean_inference_ms": 0.4005586375374341, "mean_action_processing_ms": 0.09567972575873472, "mean_env_wait_ms": 2.705429210256972, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003904104232788086, "StateBufferConnector_ms": 0.002707242965698242, "ViewRequirementAgentConnector_ms": 0.06733417510986328}}, "episode_reward_max": -272.31552728616106, "episode_reward_min": -984.4916792183878, "episode_reward_mean": -700.6317945011107, "episode_len_mean": 120.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-875.3310221140351, -784.3060011469621, -529.436838816755, -552.3296880642856, -900.6715073624943, -672.5117722411179, -272.31552728616106, -650.9837003748399, -804.12847176988, -448.0585819875234, -831.4354898360913, -673.3486780915445, -582.773580763202, -559.9339705182151, -862.8252586335362, -724.8211276933365, -611.0126685427279, -660.4702908239256, -440.0600391494581, -631.5489254456106, -533.793376273585, -351.12785653806856, -584.7363253973668, -544.3566525455012, -741.4994338588891, -709.3517955170172, -629.2288466800566, -955.426423284139, -407.39508120066404, -783.9544336138666, -499.8737708572136, -693.5024698593968, -696.0666360585428, -561.1632121055709, -435.91501137047806, -604.0317505983413, -939.3383088823931, -716.2847152315428, -915.5897601991649, -972.9648107527968, -976.0298988284203, -785.0108339137687, -592.4608953946511, -553.2364232081312, -802.9696807975071, -657.9355352556672, -850.5801311461079, -676.3735104351586, -726.9580268886344, -984.4916792183878, -616.6977224988905, -915.1358362429053, -893.7816637274223, -624.647383853262, -723.8986036735728, -471.42117465765386, -831.0077487444229, -947.0396737642479, -634.663800990879, -807.2580484403014, -648.9219181161432, -620.3567345551995, -639.4533850960762, -943.8606594988436, -858.495290093199, -786.4370754929433, -786.6827755922249, -563.973340859308, -464.8012292399626, -865.170113788972, -582.8359530439983, -537.7537778844808, -759.6805018287604, -610.7492818518934, -834.2038676824883, -949.5427001393628, -667.1258244678824, -700.8509962992503, -648.5050724387345, -545.0522486426842, -925.2814935636152, -801.4027627857698, -912.1556027608797, -813.9281640725316, -584.2112016587049, -787.9273601768657, -563.0925867475765, -800.7016680152313, -913.9847801122165, -847.9866764941737, -643.2681590791219, -818.2079029548335, -453.51368003433026, -396.61829840819047, -665.3456250856366, -506.83350490356173, -972.8543213673162, -573.5920277339925, -915.9296934869996, -736.3891108908471], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 21.133665798953924, "mean_inference_ms": 0.4005586375374341, "mean_action_processing_ms": 0.09567972575873472, "mean_env_wait_ms": 2.705429210256972, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003904104232788086, "StateBufferConnector_ms": 0.002707242965698242, "ViewRequirementAgentConnector_ms": 0.06733417510986328}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 277080, "num_agent_steps_trained": 277080, "num_env_steps_sampled": 277080, "num_env_steps_trained": 277080, "num_env_steps_sampled_this_iter": 480, "num_env_steps_trained_this_iter": 480, "num_env_steps_sampled_throughput_per_sec": 41.755356631169, "num_env_steps_trained_throughput_per_sec": 41.755356631169, "timesteps_total": 277080, "num_steps_trained_this_iter": 480, "agent_timesteps_total": 277080, "timers": {"training_iteration_time_ms": 2907.441, "sample_time_ms": 2903.594, "load_time_ms": 0.222, "load_throughput": 541142.329, "learn_time_ms": 2.856, "learn_throughput": 42014.465, "synch_weights_time_ms": 0.728}, "counters": {"num_env_steps_sampled": 277080, "num_env_steps_trained": 277080, "num_agent_steps_sampled": 277080, "num_agent_steps_trained": 277080}, "done": false, "episodes_total": 2309, "training_iteration": 578, "trial_id": "29a31_00000", "date": "2023-07-26_02-45-56", "timestamp": 1690328756, "time_this_iter_s": 11.498235702514648, "time_total_s": 7001.39169716835, "pid": 90822, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 1, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[253680, 5e-06], [256080, 5e-06], [258480, 2.5e-06], [260880, 2.5e-06], [263280, 2.5e-06], [265680, 2.5e-06], [268080, 1e-06], [270480, 1e-06], [272880, 1e-06], [275280, 5e-07], [277680, 5e-07], [280080, 5e-07], [282480, 5e-07], [284880, 5e-07], [287280, 1e-07], [289680, 1e-07], [292080, 1e-07]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 120, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x16ca65700>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1380.0662212371826, "iterations_since_restore": 118, "perf": {"cpu_util_percent": 33.90625, "ram_util_percent": 74.975}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 5e-07, "entropy_coeff": 0.05, "policy_entropy": 265.76300048828125, "policy_loss": -70590.9296875, "vf_loss": 2460190.5}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 475.0, "diff_num_grad_updates_vs_sampler_policy": 474.0}}, "num_env_steps_sampled": 277560, "num_env_steps_trained": 277560, "num_agent_steps_sampled": 277560, "num_agent_steps_trained": 277560}, "sampler_results": {"episode_reward_max": -272.31552728616106, "episode_reward_min": -984.4916792183878, "episode_reward_mean": -702.2997743005918, "episode_len_mean": 120.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-900.6715073624943, -672.5117722411179, -272.31552728616106, -650.9837003748399, -804.12847176988, -448.0585819875234, -831.4354898360913, -673.3486780915445, -582.773580763202, -559.9339705182151, -862.8252586335362, -724.8211276933365, -611.0126685427279, -660.4702908239256, -440.0600391494581, -631.5489254456106, -533.793376273585, -351.12785653806856, -584.7363253973668, -544.3566525455012, -741.4994338588891, -709.3517955170172, -629.2288466800566, -955.426423284139, -407.39508120066404, -783.9544336138666, -499.8737708572136, -693.5024698593968, -696.0666360585428, -561.1632121055709, -435.91501137047806, -604.0317505983413, -939.3383088823931, -716.2847152315428, -915.5897601991649, -972.9648107527968, -976.0298988284203, -785.0108339137687, -592.4608953946511, -553.2364232081312, -802.9696807975071, -657.9355352556672, -850.5801311461079, -676.3735104351586, -726.9580268886344, -984.4916792183878, -616.6977224988905, -915.1358362429053, -893.7816637274223, -624.647383853262, -723.8986036735728, -471.42117465765386, -831.0077487444229, -947.0396737642479, -634.663800990879, -807.2580484403014, -648.9219181161432, -620.3567345551995, -639.4533850960762, -943.8606594988436, -858.495290093199, -786.4370754929433, -786.6827755922249, -563.973340859308, -464.8012292399626, -865.170113788972, -582.8359530439983, -537.7537778844808, -759.6805018287604, -610.7492818518934, -834.2038676824883, -949.5427001393628, -667.1258244678824, -700.8509962992503, -648.5050724387345, -545.0522486426842, -925.2814935636152, -801.4027627857698, -912.1556027608797, -813.9281640725316, -584.2112016587049, -787.9273601768657, -563.0925867475765, -800.7016680152313, -913.9847801122165, -847.9866764941737, -643.2681590791219, -818.2079029548335, -453.51368003433026, -396.61829840819047, -665.3456250856366, -506.83350490356173, -972.8543213673162, -573.5920277339925, -915.9296934869996, -736.3891108908471, -695.1621794893973, -859.3927844262998, -831.5223105078321, -522.1242556666122], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 21.133999734960522, "mean_inference_ms": 0.40055897018491804, "mean_action_processing_ms": 0.09567966117892056, "mean_env_wait_ms": 2.7049192088880587, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0038919448852539062, "StateBufferConnector_ms": 0.0026998519897460938, "ViewRequirementAgentConnector_ms": 0.0672144889831543}}, "episode_reward_max": -272.31552728616106, "episode_reward_min": -984.4916792183878, "episode_reward_mean": -702.2997743005918, "episode_len_mean": 120.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-900.6715073624943, -672.5117722411179, -272.31552728616106, -650.9837003748399, -804.12847176988, -448.0585819875234, -831.4354898360913, -673.3486780915445, -582.773580763202, -559.9339705182151, -862.8252586335362, -724.8211276933365, -611.0126685427279, -660.4702908239256, -440.0600391494581, -631.5489254456106, -533.793376273585, -351.12785653806856, -584.7363253973668, -544.3566525455012, -741.4994338588891, -709.3517955170172, -629.2288466800566, -955.426423284139, -407.39508120066404, -783.9544336138666, -499.8737708572136, -693.5024698593968, -696.0666360585428, -561.1632121055709, -435.91501137047806, -604.0317505983413, -939.3383088823931, -716.2847152315428, -915.5897601991649, -972.9648107527968, -976.0298988284203, -785.0108339137687, -592.4608953946511, -553.2364232081312, -802.9696807975071, -657.9355352556672, -850.5801311461079, -676.3735104351586, -726.9580268886344, -984.4916792183878, -616.6977224988905, -915.1358362429053, -893.7816637274223, -624.647383853262, -723.8986036735728, -471.42117465765386, -831.0077487444229, -947.0396737642479, -634.663800990879, -807.2580484403014, -648.9219181161432, -620.3567345551995, -639.4533850960762, -943.8606594988436, -858.495290093199, -786.4370754929433, -786.6827755922249, -563.973340859308, -464.8012292399626, -865.170113788972, -582.8359530439983, -537.7537778844808, -759.6805018287604, -610.7492818518934, -834.2038676824883, -949.5427001393628, -667.1258244678824, -700.8509962992503, -648.5050724387345, -545.0522486426842, -925.2814935636152, -801.4027627857698, -912.1556027608797, -813.9281640725316, -584.2112016587049, -787.9273601768657, -563.0925867475765, -800.7016680152313, -913.9847801122165, -847.9866764941737, -643.2681590791219, -818.2079029548335, -453.51368003433026, -396.61829840819047, -665.3456250856366, -506.83350490356173, -972.8543213673162, -573.5920277339925, -915.9296934869996, -736.3891108908471, -695.1621794893973, -859.3927844262998, -831.5223105078321, -522.1242556666122], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 21.133999734960522, "mean_inference_ms": 0.40055897018491804, "mean_action_processing_ms": 0.09567966117892056, "mean_env_wait_ms": 2.7049192088880587, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0038919448852539062, "StateBufferConnector_ms": 0.0026998519897460938, "ViewRequirementAgentConnector_ms": 0.0672144889831543}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 277560, "num_agent_steps_trained": 277560, "num_env_steps_sampled": 277560, "num_env_steps_trained": 277560, "num_env_steps_sampled_this_iter": 480, "num_env_steps_trained_this_iter": 480, "num_env_steps_sampled_throughput_per_sec": 41.647271489698035, "num_env_steps_trained_throughput_per_sec": 41.647271489698035, "timesteps_total": 277560, "num_steps_trained_this_iter": 480, "agent_timesteps_total": 277560, "timers": {"training_iteration_time_ms": 2876.555, "sample_time_ms": 2872.772, "load_time_ms": 0.219, "load_throughput": 547857.277, "learn_time_ms": 2.805, "learn_throughput": 42775.014, "synch_weights_time_ms": 0.717}, "counters": {"num_env_steps_sampled": 277560, "num_env_steps_trained": 277560, "num_agent_steps_sampled": 277560, "num_agent_steps_trained": 277560}, "done": false, "episodes_total": 2313, "training_iteration": 579, "trial_id": "29a31_00000", "date": "2023-07-26_02-46-07", "timestamp": 1690328767, "time_this_iter_s": 11.528195858001709, "time_total_s": 7012.919893026352, "pid": 90822, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 1, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[253680, 5e-06], [256080, 5e-06], [258480, 2.5e-06], [260880, 2.5e-06], [263280, 2.5e-06], [265680, 2.5e-06], [268080, 1e-06], [270480, 1e-06], [272880, 1e-06], [275280, 5e-07], [277680, 5e-07], [280080, 5e-07], [282480, 5e-07], [284880, 5e-07], [287280, 1e-07], [289680, 1e-07], [292080, 1e-07]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 120, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x16ca65700>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1391.5944170951843, "iterations_since_restore": 119, "perf": {"cpu_util_percent": 38.04117647058824, "ram_util_percent": 73.83529411764707}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 5e-07, "entropy_coeff": 0.05, "policy_entropy": 265.740234375, "policy_loss": -40115.2578125, "vf_loss": 802613.9375}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 479.0, "diff_num_grad_updates_vs_sampler_policy": 478.0}}, "num_env_steps_sampled": 278040, "num_env_steps_trained": 278040, "num_agent_steps_sampled": 278040, "num_agent_steps_trained": 278040}, "sampler_results": {"episode_reward_max": -231.74763244156043, "episode_reward_min": -1020.0141325025317, "episode_reward_mean": -700.9390457764068, "episode_len_mean": 120.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-804.12847176988, -448.0585819875234, -831.4354898360913, -673.3486780915445, -582.773580763202, -559.9339705182151, -862.8252586335362, -724.8211276933365, -611.0126685427279, -660.4702908239256, -440.0600391494581, -631.5489254456106, -533.793376273585, -351.12785653806856, -584.7363253973668, -544.3566525455012, -741.4994338588891, -709.3517955170172, -629.2288466800566, -955.426423284139, -407.39508120066404, -783.9544336138666, -499.8737708572136, -693.5024698593968, -696.0666360585428, -561.1632121055709, -435.91501137047806, -604.0317505983413, -939.3383088823931, -716.2847152315428, -915.5897601991649, -972.9648107527968, -976.0298988284203, -785.0108339137687, -592.4608953946511, -553.2364232081312, -802.9696807975071, -657.9355352556672, -850.5801311461079, -676.3735104351586, -726.9580268886344, -984.4916792183878, -616.6977224988905, -915.1358362429053, -893.7816637274223, -624.647383853262, -723.8986036735728, -471.42117465765386, -831.0077487444229, -947.0396737642479, -634.663800990879, -807.2580484403014, -648.9219181161432, -620.3567345551995, -639.4533850960762, -943.8606594988436, -858.495290093199, -786.4370754929433, -786.6827755922249, -563.973340859308, -464.8012292399626, -865.170113788972, -582.8359530439983, -537.7537778844808, -759.6805018287604, -610.7492818518934, -834.2038676824883, -949.5427001393628, -667.1258244678824, -700.8509962992503, -648.5050724387345, -545.0522486426842, -925.2814935636152, -801.4027627857698, -912.1556027608797, -813.9281640725316, -584.2112016587049, -787.9273601768657, -563.0925867475765, -800.7016680152313, -913.9847801122165, -847.9866764941737, -643.2681590791219, -818.2079029548335, -453.51368003433026, -396.61829840819047, -665.3456250856366, -506.83350490356173, -972.8543213673162, -573.5920277339925, -915.9296934869996, -736.3891108908471, -695.1621794893973, -859.3927844262998, -831.5223105078321, -522.1242556666122, -438.1174254569087, -670.530464445105, -1020.0141325025317, -231.74763244156043], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 21.134473175330196, "mean_inference_ms": 0.400554544676136, "mean_action_processing_ms": 0.0956788297609173, "mean_env_wait_ms": 2.7044082920183676, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0038759708404541016, "StateBufferConnector_ms": 0.002692699432373047, "ViewRequirementAgentConnector_ms": 0.06705737113952637}}, "episode_reward_max": -231.74763244156043, "episode_reward_min": -1020.0141325025317, "episode_reward_mean": -700.9390457764068, "episode_len_mean": 120.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-804.12847176988, -448.0585819875234, -831.4354898360913, -673.3486780915445, -582.773580763202, -559.9339705182151, -862.8252586335362, -724.8211276933365, -611.0126685427279, -660.4702908239256, -440.0600391494581, -631.5489254456106, -533.793376273585, -351.12785653806856, -584.7363253973668, -544.3566525455012, -741.4994338588891, -709.3517955170172, -629.2288466800566, -955.426423284139, -407.39508120066404, -783.9544336138666, -499.8737708572136, -693.5024698593968, -696.0666360585428, -561.1632121055709, -435.91501137047806, -604.0317505983413, -939.3383088823931, -716.2847152315428, -915.5897601991649, -972.9648107527968, -976.0298988284203, -785.0108339137687, -592.4608953946511, -553.2364232081312, -802.9696807975071, -657.9355352556672, -850.5801311461079, -676.3735104351586, -726.9580268886344, -984.4916792183878, -616.6977224988905, -915.1358362429053, -893.7816637274223, -624.647383853262, -723.8986036735728, -471.42117465765386, -831.0077487444229, -947.0396737642479, -634.663800990879, -807.2580484403014, -648.9219181161432, -620.3567345551995, -639.4533850960762, -943.8606594988436, -858.495290093199, -786.4370754929433, -786.6827755922249, -563.973340859308, -464.8012292399626, -865.170113788972, -582.8359530439983, -537.7537778844808, -759.6805018287604, -610.7492818518934, -834.2038676824883, -949.5427001393628, -667.1258244678824, -700.8509962992503, -648.5050724387345, -545.0522486426842, -925.2814935636152, -801.4027627857698, -912.1556027608797, -813.9281640725316, -584.2112016587049, -787.9273601768657, -563.0925867475765, -800.7016680152313, -913.9847801122165, -847.9866764941737, -643.2681590791219, -818.2079029548335, -453.51368003433026, -396.61829840819047, -665.3456250856366, -506.83350490356173, -972.8543213673162, -573.5920277339925, -915.9296934869996, -736.3891108908471, -695.1621794893973, -859.3927844262998, -831.5223105078321, -522.1242556666122, -438.1174254569087, -670.530464445105, -1020.0141325025317, -231.74763244156043], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 21.134473175330196, "mean_inference_ms": 0.400554544676136, "mean_action_processing_ms": 0.0956788297609173, "mean_env_wait_ms": 2.7044082920183676, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0038759708404541016, "StateBufferConnector_ms": 0.002692699432373047, "ViewRequirementAgentConnector_ms": 0.06705737113952637}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 278040, "num_agent_steps_trained": 278040, "num_env_steps_sampled": 278040, "num_env_steps_trained": 278040, "num_env_steps_sampled_this_iter": 480, "num_env_steps_trained_this_iter": 480, "num_env_steps_sampled_throughput_per_sec": 40.252877845573046, "num_env_steps_trained_throughput_per_sec": 40.252877845573046, "timesteps_total": 278040, "num_steps_trained_this_iter": 480, "agent_timesteps_total": 278040, "timers": {"training_iteration_time_ms": 2926.532, "sample_time_ms": 2922.759, "load_time_ms": 0.218, "load_throughput": 551579.704, "learn_time_ms": 2.782, "learn_throughput": 43134.634, "synch_weights_time_ms": 0.732}, "counters": {"num_env_steps_sampled": 278040, "num_env_steps_trained": 278040, "num_agent_steps_sampled": 278040, "num_agent_steps_trained": 278040}, "done": false, "episodes_total": 2317, "training_iteration": 580, "trial_id": "29a31_00000", "date": "2023-07-26_02-46-19", "timestamp": 1690328779, "time_this_iter_s": 11.927298069000244, "time_total_s": 7024.847191095352, "pid": 90822, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 1, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[253680, 5e-06], [256080, 5e-06], [258480, 2.5e-06], [260880, 2.5e-06], [263280, 2.5e-06], [265680, 2.5e-06], [268080, 1e-06], [270480, 1e-06], [272880, 1e-06], [275280, 5e-07], [277680, 5e-07], [280080, 5e-07], [282480, 5e-07], [284880, 5e-07], [287280, 1e-07], [289680, 1e-07], [292080, 1e-07]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 120, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x16ca65700>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1403.5217151641846, "iterations_since_restore": 120, "perf": {"cpu_util_percent": 37.16470588235294, "ram_util_percent": 74.67058823529412}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 5e-07, "entropy_coeff": 0.05, "policy_entropy": 265.7651062011719, "policy_loss": -35650.546875, "vf_loss": 683920.8125}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 483.0, "diff_num_grad_updates_vs_sampler_policy": 482.0}}, "num_env_steps_sampled": 278520, "num_env_steps_trained": 278520, "num_agent_steps_sampled": 278520, "num_agent_steps_trained": 278520}, "sampler_results": {"episode_reward_max": -231.74763244156043, "episode_reward_min": -1020.0141325025317, "episode_reward_mean": -700.6619114130782, "episode_len_mean": 120.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-582.773580763202, -559.9339705182151, -862.8252586335362, -724.8211276933365, -611.0126685427279, -660.4702908239256, -440.0600391494581, -631.5489254456106, -533.793376273585, -351.12785653806856, -584.7363253973668, -544.3566525455012, -741.4994338588891, -709.3517955170172, -629.2288466800566, -955.426423284139, -407.39508120066404, -783.9544336138666, -499.8737708572136, -693.5024698593968, -696.0666360585428, -561.1632121055709, -435.91501137047806, -604.0317505983413, -939.3383088823931, -716.2847152315428, -915.5897601991649, -972.9648107527968, -976.0298988284203, -785.0108339137687, -592.4608953946511, -553.2364232081312, -802.9696807975071, -657.9355352556672, -850.5801311461079, -676.3735104351586, -726.9580268886344, -984.4916792183878, -616.6977224988905, -915.1358362429053, -893.7816637274223, -624.647383853262, -723.8986036735728, -471.42117465765386, -831.0077487444229, -947.0396737642479, -634.663800990879, -807.2580484403014, -648.9219181161432, -620.3567345551995, -639.4533850960762, -943.8606594988436, -858.495290093199, -786.4370754929433, -786.6827755922249, -563.973340859308, -464.8012292399626, -865.170113788972, -582.8359530439983, -537.7537778844808, -759.6805018287604, -610.7492818518934, -834.2038676824883, -949.5427001393628, -667.1258244678824, -700.8509962992503, -648.5050724387345, -545.0522486426842, -925.2814935636152, -801.4027627857698, -912.1556027608797, -813.9281640725316, -584.2112016587049, -787.9273601768657, -563.0925867475765, -800.7016680152313, -913.9847801122165, -847.9866764941737, -643.2681590791219, -818.2079029548335, -453.51368003433026, -396.61829840819047, -665.3456250856366, -506.83350490356173, -972.8543213673162, -573.5920277339925, -915.9296934869996, -736.3891108908471, -695.1621794893973, -859.3927844262998, -831.5223105078321, -522.1242556666122, -438.1174254569087, -670.530464445105, -1020.0141325025317, -231.74763244156043, -814.5989806353488, -572.5373769046483, -963.4093169303922, -378.7121108817956], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 21.134813809556796, "mean_inference_ms": 0.4005512692017497, "mean_action_processing_ms": 0.09567825596626232, "mean_env_wait_ms": 2.7038997210740017, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00388336181640625, "StateBufferConnector_ms": 0.0027008056640625, "ViewRequirementAgentConnector_ms": 0.06725215911865234}}, "episode_reward_max": -231.74763244156043, "episode_reward_min": -1020.0141325025317, "episode_reward_mean": -700.6619114130782, "episode_len_mean": 120.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-582.773580763202, -559.9339705182151, -862.8252586335362, -724.8211276933365, -611.0126685427279, -660.4702908239256, -440.0600391494581, -631.5489254456106, -533.793376273585, -351.12785653806856, -584.7363253973668, -544.3566525455012, -741.4994338588891, -709.3517955170172, -629.2288466800566, -955.426423284139, -407.39508120066404, -783.9544336138666, -499.8737708572136, -693.5024698593968, -696.0666360585428, -561.1632121055709, -435.91501137047806, -604.0317505983413, -939.3383088823931, -716.2847152315428, -915.5897601991649, -972.9648107527968, -976.0298988284203, -785.0108339137687, -592.4608953946511, -553.2364232081312, -802.9696807975071, -657.9355352556672, -850.5801311461079, -676.3735104351586, -726.9580268886344, -984.4916792183878, -616.6977224988905, -915.1358362429053, -893.7816637274223, -624.647383853262, -723.8986036735728, -471.42117465765386, -831.0077487444229, -947.0396737642479, -634.663800990879, -807.2580484403014, -648.9219181161432, -620.3567345551995, -639.4533850960762, -943.8606594988436, -858.495290093199, -786.4370754929433, -786.6827755922249, -563.973340859308, -464.8012292399626, -865.170113788972, -582.8359530439983, -537.7537778844808, -759.6805018287604, -610.7492818518934, -834.2038676824883, -949.5427001393628, -667.1258244678824, -700.8509962992503, -648.5050724387345, -545.0522486426842, -925.2814935636152, -801.4027627857698, -912.1556027608797, -813.9281640725316, -584.2112016587049, -787.9273601768657, -563.0925867475765, -800.7016680152313, -913.9847801122165, -847.9866764941737, -643.2681590791219, -818.2079029548335, -453.51368003433026, -396.61829840819047, -665.3456250856366, -506.83350490356173, -972.8543213673162, -573.5920277339925, -915.9296934869996, -736.3891108908471, -695.1621794893973, -859.3927844262998, -831.5223105078321, -522.1242556666122, -438.1174254569087, -670.530464445105, -1020.0141325025317, -231.74763244156043, -814.5989806353488, -572.5373769046483, -963.4093169303922, -378.7121108817956], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 21.134813809556796, "mean_inference_ms": 0.4005512692017497, "mean_action_processing_ms": 0.09567825596626232, "mean_env_wait_ms": 2.7038997210740017, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00388336181640625, "StateBufferConnector_ms": 0.0027008056640625, "ViewRequirementAgentConnector_ms": 0.06725215911865234}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 278520, "num_agent_steps_trained": 278520, "num_env_steps_sampled": 278520, "num_env_steps_trained": 278520, "num_env_steps_sampled_this_iter": 480, "num_env_steps_trained_this_iter": 480, "num_env_steps_sampled_throughput_per_sec": 40.626201762782834, "num_env_steps_trained_throughput_per_sec": 40.626201762782834, "timesteps_total": 278520, "num_steps_trained_this_iter": 480, "agent_timesteps_total": 278520, "timers": {"training_iteration_time_ms": 2953.864, "sample_time_ms": 2950.086, "load_time_ms": 0.218, "load_throughput": 550855.292, "learn_time_ms": 2.784, "learn_throughput": 43106.927, "synch_weights_time_ms": 0.735}, "counters": {"num_env_steps_sampled": 278520, "num_env_steps_trained": 278520, "num_agent_steps_sampled": 278520, "num_agent_steps_trained": 278520}, "done": false, "episodes_total": 2321, "training_iteration": 581, "trial_id": "29a31_00000", "date": "2023-07-26_02-46-31", "timestamp": 1690328791, "time_this_iter_s": 11.817665100097656, "time_total_s": 7036.66485619545, "pid": 90822, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 1, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[253680, 5e-06], [256080, 5e-06], [258480, 2.5e-06], [260880, 2.5e-06], [263280, 2.5e-06], [265680, 2.5e-06], [268080, 1e-06], [270480, 1e-06], [272880, 1e-06], [275280, 5e-07], [277680, 5e-07], [280080, 5e-07], [282480, 5e-07], [284880, 5e-07], [287280, 1e-07], [289680, 1e-07], [292080, 1e-07]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 120, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x16ca65700>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1415.3393802642822, "iterations_since_restore": 121, "perf": {"cpu_util_percent": 37.6, "ram_util_percent": 75.0625}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 5e-07, "entropy_coeff": 0.05, "policy_entropy": 265.7902526855469, "policy_loss": -72713.1171875, "vf_loss": 2776434.5}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 487.0, "diff_num_grad_updates_vs_sampler_policy": 486.0}}, "num_env_steps_sampled": 279000, "num_env_steps_trained": 279000, "num_agent_steps_sampled": 279000, "num_agent_steps_trained": 279000}, "sampler_results": {"episode_reward_max": -231.74763244156043, "episode_reward_min": -1020.0141325025317, "episode_reward_mean": -701.858017765014, "episode_len_mean": 120.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-611.0126685427279, -660.4702908239256, -440.0600391494581, -631.5489254456106, -533.793376273585, -351.12785653806856, -584.7363253973668, -544.3566525455012, -741.4994338588891, -709.3517955170172, -629.2288466800566, -955.426423284139, -407.39508120066404, -783.9544336138666, -499.8737708572136, -693.5024698593968, -696.0666360585428, -561.1632121055709, -435.91501137047806, -604.0317505983413, -939.3383088823931, -716.2847152315428, -915.5897601991649, -972.9648107527968, -976.0298988284203, -785.0108339137687, -592.4608953946511, -553.2364232081312, -802.9696807975071, -657.9355352556672, -850.5801311461079, -676.3735104351586, -726.9580268886344, -984.4916792183878, -616.6977224988905, -915.1358362429053, -893.7816637274223, -624.647383853262, -723.8986036735728, -471.42117465765386, -831.0077487444229, -947.0396737642479, -634.663800990879, -807.2580484403014, -648.9219181161432, -620.3567345551995, -639.4533850960762, -943.8606594988436, -858.495290093199, -786.4370754929433, -786.6827755922249, -563.973340859308, -464.8012292399626, -865.170113788972, -582.8359530439983, -537.7537778844808, -759.6805018287604, -610.7492818518934, -834.2038676824883, -949.5427001393628, -667.1258244678824, -700.8509962992503, -648.5050724387345, -545.0522486426842, -925.2814935636152, -801.4027627857698, -912.1556027608797, -813.9281640725316, -584.2112016587049, -787.9273601768657, -563.0925867475765, -800.7016680152313, -913.9847801122165, -847.9866764941737, -643.2681590791219, -818.2079029548335, -453.51368003433026, -396.61829840819047, -665.3456250856366, -506.83350490356173, -972.8543213673162, -573.5920277339925, -915.9296934869996, -736.3891108908471, -695.1621794893973, -859.3927844262998, -831.5223105078321, -522.1242556666122, -438.1174254569087, -670.530464445105, -1020.0141325025317, -231.74763244156043, -814.5989806353488, -572.5373769046483, -963.4093169303922, -378.7121108817956, -660.6809945759999, -964.4500678079972, -569.6248747523435, -655.2086356655067], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 21.13515215069002, "mean_inference_ms": 0.40054436492781437, "mean_action_processing_ms": 0.09567680152374652, "mean_env_wait_ms": 2.703417993889468, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0038874149322509766, "StateBufferConnector_ms": 0.002704143524169922, "ViewRequirementAgentConnector_ms": 0.0673520565032959}}, "episode_reward_max": -231.74763244156043, "episode_reward_min": -1020.0141325025317, "episode_reward_mean": -701.858017765014, "episode_len_mean": 120.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-611.0126685427279, -660.4702908239256, -440.0600391494581, -631.5489254456106, -533.793376273585, -351.12785653806856, -584.7363253973668, -544.3566525455012, -741.4994338588891, -709.3517955170172, -629.2288466800566, -955.426423284139, -407.39508120066404, -783.9544336138666, -499.8737708572136, -693.5024698593968, -696.0666360585428, -561.1632121055709, -435.91501137047806, -604.0317505983413, -939.3383088823931, -716.2847152315428, -915.5897601991649, -972.9648107527968, -976.0298988284203, -785.0108339137687, -592.4608953946511, -553.2364232081312, -802.9696807975071, -657.9355352556672, -850.5801311461079, -676.3735104351586, -726.9580268886344, -984.4916792183878, -616.6977224988905, -915.1358362429053, -893.7816637274223, -624.647383853262, -723.8986036735728, -471.42117465765386, -831.0077487444229, -947.0396737642479, -634.663800990879, -807.2580484403014, -648.9219181161432, -620.3567345551995, -639.4533850960762, -943.8606594988436, -858.495290093199, -786.4370754929433, -786.6827755922249, -563.973340859308, -464.8012292399626, -865.170113788972, -582.8359530439983, -537.7537778844808, -759.6805018287604, -610.7492818518934, -834.2038676824883, -949.5427001393628, -667.1258244678824, -700.8509962992503, -648.5050724387345, -545.0522486426842, -925.2814935636152, -801.4027627857698, -912.1556027608797, -813.9281640725316, -584.2112016587049, -787.9273601768657, -563.0925867475765, -800.7016680152313, -913.9847801122165, -847.9866764941737, -643.2681590791219, -818.2079029548335, -453.51368003433026, -396.61829840819047, -665.3456250856366, -506.83350490356173, -972.8543213673162, -573.5920277339925, -915.9296934869996, -736.3891108908471, -695.1621794893973, -859.3927844262998, -831.5223105078321, -522.1242556666122, -438.1174254569087, -670.530464445105, -1020.0141325025317, -231.74763244156043, -814.5989806353488, -572.5373769046483, -963.4093169303922, -378.7121108817956, -660.6809945759999, -964.4500678079972, -569.6248747523435, -655.2086356655067], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 21.13515215069002, "mean_inference_ms": 0.40054436492781437, "mean_action_processing_ms": 0.09567680152374652, "mean_env_wait_ms": 2.703417993889468, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0038874149322509766, "StateBufferConnector_ms": 0.002704143524169922, "ViewRequirementAgentConnector_ms": 0.0673520565032959}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 279000, "num_agent_steps_trained": 279000, "num_env_steps_sampled": 279000, "num_env_steps_trained": 279000, "num_env_steps_sampled_this_iter": 480, "num_env_steps_trained_this_iter": 480, "num_env_steps_sampled_throughput_per_sec": 41.02836140368403, "num_env_steps_trained_throughput_per_sec": 41.02836140368403, "timesteps_total": 279000, "num_steps_trained_this_iter": 480, "agent_timesteps_total": 279000, "timers": {"training_iteration_time_ms": 2934.484, "sample_time_ms": 2930.678, "load_time_ms": 0.219, "load_throughput": 548693.426, "learn_time_ms": 2.812, "learn_throughput": 42670.212, "synch_weights_time_ms": 0.734}, "counters": {"num_env_steps_sampled": 279000, "num_env_steps_trained": 279000, "num_agent_steps_sampled": 279000, "num_agent_steps_trained": 279000}, "done": false, "episodes_total": 2325, "training_iteration": 582, "trial_id": "29a31_00000", "date": "2023-07-26_02-46-43", "timestamp": 1690328803, "time_this_iter_s": 11.701902151107788, "time_total_s": 7048.366758346558, "pid": 90822, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 1, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[253680, 5e-06], [256080, 5e-06], [258480, 2.5e-06], [260880, 2.5e-06], [263280, 2.5e-06], [265680, 2.5e-06], [268080, 1e-06], [270480, 1e-06], [272880, 1e-06], [275280, 5e-07], [277680, 5e-07], [280080, 5e-07], [282480, 5e-07], [284880, 5e-07], [287280, 1e-07], [289680, 1e-07], [292080, 1e-07]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 120, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x16ca65700>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1427.04128241539, "iterations_since_restore": 122, "perf": {"cpu_util_percent": 34.46470588235294, "ram_util_percent": 76.84117647058825}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 5e-07, "entropy_coeff": 0.05, "policy_entropy": 265.7639465332031, "policy_loss": -79611.375, "vf_loss": 2996968.75}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 491.0, "diff_num_grad_updates_vs_sampler_policy": 490.0}}, "num_env_steps_sampled": 279480, "num_env_steps_trained": 279480, "num_agent_steps_sampled": 279480, "num_agent_steps_trained": 279480}, "sampler_results": {"episode_reward_max": -231.74763244156043, "episode_reward_min": -1020.0141325025317, "episode_reward_mean": -710.2777803785071, "episode_len_mean": 120.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-533.793376273585, -351.12785653806856, -584.7363253973668, -544.3566525455012, -741.4994338588891, -709.3517955170172, -629.2288466800566, -955.426423284139, -407.39508120066404, -783.9544336138666, -499.8737708572136, -693.5024698593968, -696.0666360585428, -561.1632121055709, -435.91501137047806, -604.0317505983413, -939.3383088823931, -716.2847152315428, -915.5897601991649, -972.9648107527968, -976.0298988284203, -785.0108339137687, -592.4608953946511, -553.2364232081312, -802.9696807975071, -657.9355352556672, -850.5801311461079, -676.3735104351586, -726.9580268886344, -984.4916792183878, -616.6977224988905, -915.1358362429053, -893.7816637274223, -624.647383853262, -723.8986036735728, -471.42117465765386, -831.0077487444229, -947.0396737642479, -634.663800990879, -807.2580484403014, -648.9219181161432, -620.3567345551995, -639.4533850960762, -943.8606594988436, -858.495290093199, -786.4370754929433, -786.6827755922249, -563.973340859308, -464.8012292399626, -865.170113788972, -582.8359530439983, -537.7537778844808, -759.6805018287604, -610.7492818518934, -834.2038676824883, -949.5427001393628, -667.1258244678824, -700.8509962992503, -648.5050724387345, -545.0522486426842, -925.2814935636152, -801.4027627857698, -912.1556027608797, -813.9281640725316, -584.2112016587049, -787.9273601768657, -563.0925867475765, -800.7016680152313, -913.9847801122165, -847.9866764941737, -643.2681590791219, -818.2079029548335, -453.51368003433026, -396.61829840819047, -665.3456250856366, -506.83350490356173, -972.8543213673162, -573.5920277339925, -915.9296934869996, -736.3891108908471, -695.1621794893973, -859.3927844262998, -831.5223105078321, -522.1242556666122, -438.1174254569087, -670.530464445105, -1020.0141325025317, -231.74763244156043, -814.5989806353488, -572.5373769046483, -963.4093169303922, -378.7121108817956, -660.6809945759999, -964.4500678079972, -569.6248747523435, -655.2086356655067, -948.6080202306124, -969.4364238085022, -725.7014478863263, -541.3222933855977], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 21.135590022795313, "mean_inference_ms": 0.400541034081141, "mean_action_processing_ms": 0.09567603772664601, "mean_env_wait_ms": 2.702972678419241, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003881216049194336, "StateBufferConnector_ms": 0.0027103424072265625, "ViewRequirementAgentConnector_ms": 0.06731390953063965}}, "episode_reward_max": -231.74763244156043, "episode_reward_min": -1020.0141325025317, "episode_reward_mean": -710.2777803785071, "episode_len_mean": 120.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-533.793376273585, -351.12785653806856, -584.7363253973668, -544.3566525455012, -741.4994338588891, -709.3517955170172, -629.2288466800566, -955.426423284139, -407.39508120066404, -783.9544336138666, -499.8737708572136, -693.5024698593968, -696.0666360585428, -561.1632121055709, -435.91501137047806, -604.0317505983413, -939.3383088823931, -716.2847152315428, -915.5897601991649, -972.9648107527968, -976.0298988284203, -785.0108339137687, -592.4608953946511, -553.2364232081312, -802.9696807975071, -657.9355352556672, -850.5801311461079, -676.3735104351586, -726.9580268886344, -984.4916792183878, -616.6977224988905, -915.1358362429053, -893.7816637274223, -624.647383853262, -723.8986036735728, -471.42117465765386, -831.0077487444229, -947.0396737642479, -634.663800990879, -807.2580484403014, -648.9219181161432, -620.3567345551995, -639.4533850960762, -943.8606594988436, -858.495290093199, -786.4370754929433, -786.6827755922249, -563.973340859308, -464.8012292399626, -865.170113788972, -582.8359530439983, -537.7537778844808, -759.6805018287604, -610.7492818518934, -834.2038676824883, -949.5427001393628, -667.1258244678824, -700.8509962992503, -648.5050724387345, -545.0522486426842, -925.2814935636152, -801.4027627857698, -912.1556027608797, -813.9281640725316, -584.2112016587049, -787.9273601768657, -563.0925867475765, -800.7016680152313, -913.9847801122165, -847.9866764941737, -643.2681590791219, -818.2079029548335, -453.51368003433026, -396.61829840819047, -665.3456250856366, -506.83350490356173, -972.8543213673162, -573.5920277339925, -915.9296934869996, -736.3891108908471, -695.1621794893973, -859.3927844262998, -831.5223105078321, -522.1242556666122, -438.1174254569087, -670.530464445105, -1020.0141325025317, -231.74763244156043, -814.5989806353488, -572.5373769046483, -963.4093169303922, -378.7121108817956, -660.6809945759999, -964.4500678079972, -569.6248747523435, -655.2086356655067, -948.6080202306124, -969.4364238085022, -725.7014478863263, -541.3222933855977], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 21.135590022795313, "mean_inference_ms": 0.400541034081141, "mean_action_processing_ms": 0.09567603772664601, "mean_env_wait_ms": 2.702972678419241, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003881216049194336, "StateBufferConnector_ms": 0.0027103424072265625, "ViewRequirementAgentConnector_ms": 0.06731390953063965}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 279480, "num_agent_steps_trained": 279480, "num_env_steps_sampled": 279480, "num_env_steps_trained": 279480, "num_env_steps_sampled_this_iter": 480, "num_env_steps_trained_this_iter": 480, "num_env_steps_sampled_throughput_per_sec": 41.2788850981666, "num_env_steps_trained_throughput_per_sec": 41.2788850981666, "timesteps_total": 279480, "num_steps_trained_this_iter": 480, "agent_timesteps_total": 279480, "timers": {"training_iteration_time_ms": 2903.412, "sample_time_ms": 2899.63, "load_time_ms": 0.218, "load_throughput": 550915.587, "learn_time_ms": 2.811, "learn_throughput": 42695.911, "synch_weights_time_ms": 0.714}, "counters": {"num_env_steps_sampled": 279480, "num_env_steps_trained": 279480, "num_agent_steps_sampled": 279480, "num_agent_steps_trained": 279480}, "done": false, "episodes_total": 2329, "training_iteration": 583, "trial_id": "29a31_00000", "date": "2023-07-26_02-46-55", "timestamp": 1690328815, "time_this_iter_s": 11.630886793136597, "time_total_s": 7059.997645139694, "pid": 90822, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 1, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[253680, 5e-06], [256080, 5e-06], [258480, 2.5e-06], [260880, 2.5e-06], [263280, 2.5e-06], [265680, 2.5e-06], [268080, 1e-06], [270480, 1e-06], [272880, 1e-06], [275280, 5e-07], [277680, 5e-07], [280080, 5e-07], [282480, 5e-07], [284880, 5e-07], [287280, 1e-07], [289680, 1e-07], [292080, 1e-07]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 120, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x16ca65700>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1438.6721692085266, "iterations_since_restore": 123, "perf": {"cpu_util_percent": 34.02941176470589, "ram_util_percent": 76.71176470588235}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 5e-07, "entropy_coeff": 0.05, "policy_entropy": 265.77117919921875, "policy_loss": -53278.7578125, "vf_loss": 1486341.25}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 495.0, "diff_num_grad_updates_vs_sampler_policy": 494.0}}, "num_env_steps_sampled": 279960, "num_env_steps_trained": 279960, "num_agent_steps_sampled": 279960, "num_agent_steps_trained": 279960}, "sampler_results": {"episode_reward_max": -231.74763244156043, "episode_reward_min": -1020.0141325025317, "episode_reward_mean": -720.0482089564196, "episode_len_mean": 120.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-741.4994338588891, -709.3517955170172, -629.2288466800566, -955.426423284139, -407.39508120066404, -783.9544336138666, -499.8737708572136, -693.5024698593968, -696.0666360585428, -561.1632121055709, -435.91501137047806, -604.0317505983413, -939.3383088823931, -716.2847152315428, -915.5897601991649, -972.9648107527968, -976.0298988284203, -785.0108339137687, -592.4608953946511, -553.2364232081312, -802.9696807975071, -657.9355352556672, -850.5801311461079, -676.3735104351586, -726.9580268886344, -984.4916792183878, -616.6977224988905, -915.1358362429053, -893.7816637274223, -624.647383853262, -723.8986036735728, -471.42117465765386, -831.0077487444229, -947.0396737642479, -634.663800990879, -807.2580484403014, -648.9219181161432, -620.3567345551995, -639.4533850960762, -943.8606594988436, -858.495290093199, -786.4370754929433, -786.6827755922249, -563.973340859308, -464.8012292399626, -865.170113788972, -582.8359530439983, -537.7537778844808, -759.6805018287604, -610.7492818518934, -834.2038676824883, -949.5427001393628, -667.1258244678824, -700.8509962992503, -648.5050724387345, -545.0522486426842, -925.2814935636152, -801.4027627857698, -912.1556027608797, -813.9281640725316, -584.2112016587049, -787.9273601768657, -563.0925867475765, -800.7016680152313, -913.9847801122165, -847.9866764941737, -643.2681590791219, -818.2079029548335, -453.51368003433026, -396.61829840819047, -665.3456250856366, -506.83350490356173, -972.8543213673162, -573.5920277339925, -915.9296934869996, -736.3891108908471, -695.1621794893973, -859.3927844262998, -831.5223105078321, -522.1242556666122, -438.1174254569087, -670.530464445105, -1020.0141325025317, -231.74763244156043, -814.5989806353488, -572.5373769046483, -963.4093169303922, -378.7121108817956, -660.6809945759999, -964.4500678079972, -569.6248747523435, -655.2086356655067, -948.6080202306124, -969.4364238085022, -725.7014478863263, -541.3222933855977, -1008.6424508690859, -742.7160311111671, -779.4896749801029, -460.20891158542935], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 21.13586576036572, "mean_inference_ms": 0.4005317672585712, "mean_action_processing_ms": 0.09567425765060855, "mean_env_wait_ms": 2.7025557572476306, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0038754940032958984, "StateBufferConnector_ms": 0.002712249755859375, "ViewRequirementAgentConnector_ms": 0.06731009483337402}}, "episode_reward_max": -231.74763244156043, "episode_reward_min": -1020.0141325025317, "episode_reward_mean": -720.0482089564196, "episode_len_mean": 120.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-741.4994338588891, -709.3517955170172, -629.2288466800566, -955.426423284139, -407.39508120066404, -783.9544336138666, -499.8737708572136, -693.5024698593968, -696.0666360585428, -561.1632121055709, -435.91501137047806, -604.0317505983413, -939.3383088823931, -716.2847152315428, -915.5897601991649, -972.9648107527968, -976.0298988284203, -785.0108339137687, -592.4608953946511, -553.2364232081312, -802.9696807975071, -657.9355352556672, -850.5801311461079, -676.3735104351586, -726.9580268886344, -984.4916792183878, -616.6977224988905, -915.1358362429053, -893.7816637274223, -624.647383853262, -723.8986036735728, -471.42117465765386, -831.0077487444229, -947.0396737642479, -634.663800990879, -807.2580484403014, -648.9219181161432, -620.3567345551995, -639.4533850960762, -943.8606594988436, -858.495290093199, -786.4370754929433, -786.6827755922249, -563.973340859308, -464.8012292399626, -865.170113788972, -582.8359530439983, -537.7537778844808, -759.6805018287604, -610.7492818518934, -834.2038676824883, -949.5427001393628, -667.1258244678824, -700.8509962992503, -648.5050724387345, -545.0522486426842, -925.2814935636152, -801.4027627857698, -912.1556027608797, -813.9281640725316, -584.2112016587049, -787.9273601768657, -563.0925867475765, -800.7016680152313, -913.9847801122165, -847.9866764941737, -643.2681590791219, -818.2079029548335, -453.51368003433026, -396.61829840819047, -665.3456250856366, -506.83350490356173, -972.8543213673162, -573.5920277339925, -915.9296934869996, -736.3891108908471, -695.1621794893973, -859.3927844262998, -831.5223105078321, -522.1242556666122, -438.1174254569087, -670.530464445105, -1020.0141325025317, -231.74763244156043, -814.5989806353488, -572.5373769046483, -963.4093169303922, -378.7121108817956, -660.6809945759999, -964.4500678079972, -569.6248747523435, -655.2086356655067, -948.6080202306124, -969.4364238085022, -725.7014478863263, -541.3222933855977, -1008.6424508690859, -742.7160311111671, -779.4896749801029, -460.20891158542935], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 21.13586576036572, "mean_inference_ms": 0.4005317672585712, "mean_action_processing_ms": 0.09567425765060855, "mean_env_wait_ms": 2.7025557572476306, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0038754940032958984, "StateBufferConnector_ms": 0.002712249755859375, "ViewRequirementAgentConnector_ms": 0.06731009483337402}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 279960, "num_agent_steps_trained": 279960, "num_env_steps_sampled": 279960, "num_env_steps_trained": 279960, "num_env_steps_sampled_this_iter": 480, "num_env_steps_trained_this_iter": 480, "num_env_steps_sampled_throughput_per_sec": 41.82853699426177, "num_env_steps_trained_throughput_per_sec": 41.82853699426177, "timesteps_total": 279960, "num_steps_trained_this_iter": 480, "agent_timesteps_total": 279960, "timers": {"training_iteration_time_ms": 2877.392, "sample_time_ms": 2873.605, "load_time_ms": 0.218, "load_throughput": 550433.596, "learn_time_ms": 2.813, "learn_throughput": 42661.893, "synch_weights_time_ms": 0.716}, "counters": {"num_env_steps_sampled": 279960, "num_env_steps_trained": 279960, "num_agent_steps_sampled": 279960, "num_agent_steps_trained": 279960}, "done": false, "episodes_total": 2333, "training_iteration": 584, "trial_id": "29a31_00000", "date": "2023-07-26_02-47-06", "timestamp": 1690328826, "time_this_iter_s": 11.47841215133667, "time_total_s": 7071.476057291031, "pid": 90822, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 1, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[253680, 5e-06], [256080, 5e-06], [258480, 2.5e-06], [260880, 2.5e-06], [263280, 2.5e-06], [265680, 2.5e-06], [268080, 1e-06], [270480, 1e-06], [272880, 1e-06], [275280, 5e-07], [277680, 5e-07], [280080, 5e-07], [282480, 5e-07], [284880, 5e-07], [287280, 1e-07], [289680, 1e-07], [292080, 1e-07]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 120, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x16ca65700>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1450.1505813598633, "iterations_since_restore": 124, "perf": {"cpu_util_percent": 37.59375, "ram_util_percent": 76.52499999999999}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 5e-07, "entropy_coeff": 0.05, "policy_entropy": 265.75335693359375, "policy_loss": -59654.5546875, "vf_loss": 1742355.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 499.0, "diff_num_grad_updates_vs_sampler_policy": 498.0}}, "num_env_steps_sampled": 280440, "num_env_steps_trained": 280440, "num_agent_steps_sampled": 280440, "num_agent_steps_trained": 280440}, "sampler_results": {"episode_reward_max": -231.74763244156043, "episode_reward_min": -1020.0141325025317, "episode_reward_mean": -714.123371904068, "episode_len_mean": 120.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-407.39508120066404, -783.9544336138666, -499.8737708572136, -693.5024698593968, -696.0666360585428, -561.1632121055709, -435.91501137047806, -604.0317505983413, -939.3383088823931, -716.2847152315428, -915.5897601991649, -972.9648107527968, -976.0298988284203, -785.0108339137687, -592.4608953946511, -553.2364232081312, -802.9696807975071, -657.9355352556672, -850.5801311461079, -676.3735104351586, -726.9580268886344, -984.4916792183878, -616.6977224988905, -915.1358362429053, -893.7816637274223, -624.647383853262, -723.8986036735728, -471.42117465765386, -831.0077487444229, -947.0396737642479, -634.663800990879, -807.2580484403014, -648.9219181161432, -620.3567345551995, -639.4533850960762, -943.8606594988436, -858.495290093199, -786.4370754929433, -786.6827755922249, -563.973340859308, -464.8012292399626, -865.170113788972, -582.8359530439983, -537.7537778844808, -759.6805018287604, -610.7492818518934, -834.2038676824883, -949.5427001393628, -667.1258244678824, -700.8509962992503, -648.5050724387345, -545.0522486426842, -925.2814935636152, -801.4027627857698, -912.1556027608797, -813.9281640725316, -584.2112016587049, -787.9273601768657, -563.0925867475765, -800.7016680152313, -913.9847801122165, -847.9866764941737, -643.2681590791219, -818.2079029548335, -453.51368003433026, -396.61829840819047, -665.3456250856366, -506.83350490356173, -972.8543213673162, -573.5920277339925, -915.9296934869996, -736.3891108908471, -695.1621794893973, -859.3927844262998, -831.5223105078321, -522.1242556666122, -438.1174254569087, -670.530464445105, -1020.0141325025317, -231.74763244156043, -814.5989806353488, -572.5373769046483, -963.4093169303922, -378.7121108817956, -660.6809945759999, -964.4500678079972, -569.6248747523435, -655.2086356655067, -948.6080202306124, -969.4364238085022, -725.7014478863263, -541.3222933855977, -1008.6424508690859, -742.7160311111671, -779.4896749801029, -460.20891158542935, -645.4409639656476, -706.5483776911964, -565.9220434169837, -525.1114090311074], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 21.135951096694797, "mean_inference_ms": 0.40052399343175366, "mean_action_processing_ms": 0.09567269821831402, "mean_env_wait_ms": 2.702131794417864, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003879070281982422, "StateBufferConnector_ms": 0.002710580825805664, "ViewRequirementAgentConnector_ms": 0.06733965873718262}}, "episode_reward_max": -231.74763244156043, "episode_reward_min": -1020.0141325025317, "episode_reward_mean": -714.123371904068, "episode_len_mean": 120.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-407.39508120066404, -783.9544336138666, -499.8737708572136, -693.5024698593968, -696.0666360585428, -561.1632121055709, -435.91501137047806, -604.0317505983413, -939.3383088823931, -716.2847152315428, -915.5897601991649, -972.9648107527968, -976.0298988284203, -785.0108339137687, -592.4608953946511, -553.2364232081312, -802.9696807975071, -657.9355352556672, -850.5801311461079, -676.3735104351586, -726.9580268886344, -984.4916792183878, -616.6977224988905, -915.1358362429053, -893.7816637274223, -624.647383853262, -723.8986036735728, -471.42117465765386, -831.0077487444229, -947.0396737642479, -634.663800990879, -807.2580484403014, -648.9219181161432, -620.3567345551995, -639.4533850960762, -943.8606594988436, -858.495290093199, -786.4370754929433, -786.6827755922249, -563.973340859308, -464.8012292399626, -865.170113788972, -582.8359530439983, -537.7537778844808, -759.6805018287604, -610.7492818518934, -834.2038676824883, -949.5427001393628, -667.1258244678824, -700.8509962992503, -648.5050724387345, -545.0522486426842, -925.2814935636152, -801.4027627857698, -912.1556027608797, -813.9281640725316, -584.2112016587049, -787.9273601768657, -563.0925867475765, -800.7016680152313, -913.9847801122165, -847.9866764941737, -643.2681590791219, -818.2079029548335, -453.51368003433026, -396.61829840819047, -665.3456250856366, -506.83350490356173, -972.8543213673162, -573.5920277339925, -915.9296934869996, -736.3891108908471, -695.1621794893973, -859.3927844262998, -831.5223105078321, -522.1242556666122, -438.1174254569087, -670.530464445105, -1020.0141325025317, -231.74763244156043, -814.5989806353488, -572.5373769046483, -963.4093169303922, -378.7121108817956, -660.6809945759999, -964.4500678079972, -569.6248747523435, -655.2086356655067, -948.6080202306124, -969.4364238085022, -725.7014478863263, -541.3222933855977, -1008.6424508690859, -742.7160311111671, -779.4896749801029, -460.20891158542935, -645.4409639656476, -706.5483776911964, -565.9220434169837, -525.1114090311074], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 21.135951096694797, "mean_inference_ms": 0.40052399343175366, "mean_action_processing_ms": 0.09567269821831402, "mean_env_wait_ms": 2.702131794417864, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003879070281982422, "StateBufferConnector_ms": 0.002710580825805664, "ViewRequirementAgentConnector_ms": 0.06733965873718262}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 280440, "num_agent_steps_trained": 280440, "num_env_steps_sampled": 280440, "num_env_steps_trained": 280440, "num_env_steps_sampled_this_iter": 480, "num_env_steps_trained_this_iter": 480, "num_env_steps_sampled_throughput_per_sec": 40.96018916754031, "num_env_steps_trained_throughput_per_sec": 40.96018916754031, "timesteps_total": 280440, "num_steps_trained_this_iter": 480, "agent_timesteps_total": 280440, "timers": {"training_iteration_time_ms": 2910.853, "sample_time_ms": 2907.085, "load_time_ms": 0.218, "load_throughput": 550795.01, "learn_time_ms": 2.796, "learn_throughput": 42924.948, "synch_weights_time_ms": 0.714}, "counters": {"num_env_steps_sampled": 280440, "num_env_steps_trained": 280440, "num_agent_steps_sampled": 280440, "num_agent_steps_trained": 280440}, "done": false, "episodes_total": 2337, "training_iteration": 585, "trial_id": "29a31_00000", "date": "2023-07-26_02-47-18", "timestamp": 1690328838, "time_this_iter_s": 11.72144103050232, "time_total_s": 7083.197498321533, "pid": 90822, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 1, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[253680, 5e-06], [256080, 5e-06], [258480, 2.5e-06], [260880, 2.5e-06], [263280, 2.5e-06], [265680, 2.5e-06], [268080, 1e-06], [270480, 1e-06], [272880, 1e-06], [275280, 5e-07], [277680, 5e-07], [280080, 5e-07], [282480, 5e-07], [284880, 5e-07], [287280, 1e-07], [289680, 1e-07], [292080, 1e-07]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 120, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x16ca65700>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1461.8720223903656, "iterations_since_restore": 125, "perf": {"cpu_util_percent": 36.84375, "ram_util_percent": 76.94375000000001}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 5e-07, "entropy_coeff": 0.05, "policy_entropy": 265.7838439941406, "policy_loss": -64919.953125, "vf_loss": 2060384.125}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 503.0, "diff_num_grad_updates_vs_sampler_policy": 502.0}}, "num_env_steps_sampled": 280920, "num_env_steps_trained": 280920, "num_agent_steps_sampled": 280920, "num_agent_steps_trained": 280920}, "sampler_results": {"episode_reward_max": -231.74763244156043, "episode_reward_min": -1020.0141325025317, "episode_reward_mean": -718.0816563523268, "episode_len_mean": 120.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-696.0666360585428, -561.1632121055709, -435.91501137047806, -604.0317505983413, -939.3383088823931, -716.2847152315428, -915.5897601991649, -972.9648107527968, -976.0298988284203, -785.0108339137687, -592.4608953946511, -553.2364232081312, -802.9696807975071, -657.9355352556672, -850.5801311461079, -676.3735104351586, -726.9580268886344, -984.4916792183878, -616.6977224988905, -915.1358362429053, -893.7816637274223, -624.647383853262, -723.8986036735728, -471.42117465765386, -831.0077487444229, -947.0396737642479, -634.663800990879, -807.2580484403014, -648.9219181161432, -620.3567345551995, -639.4533850960762, -943.8606594988436, -858.495290093199, -786.4370754929433, -786.6827755922249, -563.973340859308, -464.8012292399626, -865.170113788972, -582.8359530439983, -537.7537778844808, -759.6805018287604, -610.7492818518934, -834.2038676824883, -949.5427001393628, -667.1258244678824, -700.8509962992503, -648.5050724387345, -545.0522486426842, -925.2814935636152, -801.4027627857698, -912.1556027608797, -813.9281640725316, -584.2112016587049, -787.9273601768657, -563.0925867475765, -800.7016680152313, -913.9847801122165, -847.9866764941737, -643.2681590791219, -818.2079029548335, -453.51368003433026, -396.61829840819047, -665.3456250856366, -506.83350490356173, -972.8543213673162, -573.5920277339925, -915.9296934869996, -736.3891108908471, -695.1621794893973, -859.3927844262998, -831.5223105078321, -522.1242556666122, -438.1174254569087, -670.530464445105, -1020.0141325025317, -231.74763244156043, -814.5989806353488, -572.5373769046483, -963.4093169303922, -378.7121108817956, -660.6809945759999, -964.4500678079972, -569.6248747523435, -655.2086356655067, -948.6080202306124, -969.4364238085022, -725.7014478863263, -541.3222933855977, -1008.6424508690859, -742.7160311111671, -779.4896749801029, -460.20891158542935, -645.4409639656476, -706.5483776911964, -565.9220434169837, -525.1114090311074, -780.5136943219226, -840.7269000866697, -673.5101670170865, -485.803438931345], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 21.136206997838165, "mean_inference_ms": 0.40051573711297606, "mean_action_processing_ms": 0.0956711185655112, "mean_env_wait_ms": 2.7016772978508903, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003877878189086914, "StateBufferConnector_ms": 0.0027055740356445312, "ViewRequirementAgentConnector_ms": 0.06733918190002441}}, "episode_reward_max": -231.74763244156043, "episode_reward_min": -1020.0141325025317, "episode_reward_mean": -718.0816563523268, "episode_len_mean": 120.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-696.0666360585428, -561.1632121055709, -435.91501137047806, -604.0317505983413, -939.3383088823931, -716.2847152315428, -915.5897601991649, -972.9648107527968, -976.0298988284203, -785.0108339137687, -592.4608953946511, -553.2364232081312, -802.9696807975071, -657.9355352556672, -850.5801311461079, -676.3735104351586, -726.9580268886344, -984.4916792183878, -616.6977224988905, -915.1358362429053, -893.7816637274223, -624.647383853262, -723.8986036735728, -471.42117465765386, -831.0077487444229, -947.0396737642479, -634.663800990879, -807.2580484403014, -648.9219181161432, -620.3567345551995, -639.4533850960762, -943.8606594988436, -858.495290093199, -786.4370754929433, -786.6827755922249, -563.973340859308, -464.8012292399626, -865.170113788972, -582.8359530439983, -537.7537778844808, -759.6805018287604, -610.7492818518934, -834.2038676824883, -949.5427001393628, -667.1258244678824, -700.8509962992503, -648.5050724387345, -545.0522486426842, -925.2814935636152, -801.4027627857698, -912.1556027608797, -813.9281640725316, -584.2112016587049, -787.9273601768657, -563.0925867475765, -800.7016680152313, -913.9847801122165, -847.9866764941737, -643.2681590791219, -818.2079029548335, -453.51368003433026, -396.61829840819047, -665.3456250856366, -506.83350490356173, -972.8543213673162, -573.5920277339925, -915.9296934869996, -736.3891108908471, -695.1621794893973, -859.3927844262998, -831.5223105078321, -522.1242556666122, -438.1174254569087, -670.530464445105, -1020.0141325025317, -231.74763244156043, -814.5989806353488, -572.5373769046483, -963.4093169303922, -378.7121108817956, -660.6809945759999, -964.4500678079972, -569.6248747523435, -655.2086356655067, -948.6080202306124, -969.4364238085022, -725.7014478863263, -541.3222933855977, -1008.6424508690859, -742.7160311111671, -779.4896749801029, -460.20891158542935, -645.4409639656476, -706.5483776911964, -565.9220434169837, -525.1114090311074, -780.5136943219226, -840.7269000866697, -673.5101670170865, -485.803438931345], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 21.136206997838165, "mean_inference_ms": 0.40051573711297606, "mean_action_processing_ms": 0.0956711185655112, "mean_env_wait_ms": 2.7016772978508903, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003877878189086914, "StateBufferConnector_ms": 0.0027055740356445312, "ViewRequirementAgentConnector_ms": 0.06733918190002441}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 280920, "num_agent_steps_trained": 280920, "num_env_steps_sampled": 280920, "num_env_steps_trained": 280920, "num_env_steps_sampled_this_iter": 480, "num_env_steps_trained_this_iter": 480, "num_env_steps_sampled_throughput_per_sec": 40.574836234746236, "num_env_steps_trained_throughput_per_sec": 40.574836234746236, "timesteps_total": 280920, "num_steps_trained_this_iter": 480, "agent_timesteps_total": 280920, "timers": {"training_iteration_time_ms": 2928.594, "sample_time_ms": 2924.791, "load_time_ms": 0.219, "load_throughput": 548932.795, "learn_time_ms": 2.827, "learn_throughput": 42449.605, "synch_weights_time_ms": 0.717}, "counters": {"num_env_steps_sampled": 280920, "num_env_steps_trained": 280920, "num_agent_steps_sampled": 280920, "num_agent_steps_trained": 280920}, "done": false, "episodes_total": 2341, "training_iteration": 586, "trial_id": "29a31_00000", "date": "2023-07-26_02-47-30", "timestamp": 1690328850, "time_this_iter_s": 11.832921028137207, "time_total_s": 7095.03041934967, "pid": 90822, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 1, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[253680, 5e-06], [256080, 5e-06], [258480, 2.5e-06], [260880, 2.5e-06], [263280, 2.5e-06], [265680, 2.5e-06], [268080, 1e-06], [270480, 1e-06], [272880, 1e-06], [275280, 5e-07], [277680, 5e-07], [280080, 5e-07], [282480, 5e-07], [284880, 5e-07], [287280, 1e-07], [289680, 1e-07], [292080, 1e-07]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 120, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x16ca65700>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1473.7049434185028, "iterations_since_restore": 126, "perf": {"cpu_util_percent": 39.523529411764706, "ram_util_percent": 76.98823529411764}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 5e-07, "entropy_coeff": 0.05, "policy_entropy": 265.796875, "policy_loss": -63810.5078125, "vf_loss": 1828629.875}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 507.0, "diff_num_grad_updates_vs_sampler_policy": 506.0}}, "num_env_steps_sampled": 281400, "num_env_steps_trained": 281400, "num_agent_steps_sampled": 281400, "num_agent_steps_trained": 281400}, "sampler_results": {"episode_reward_max": -231.74763244156043, "episode_reward_min": -1020.0141325025317, "episode_reward_mean": -720.07790422562, "episode_len_mean": 120.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-939.3383088823931, -716.2847152315428, -915.5897601991649, -972.9648107527968, -976.0298988284203, -785.0108339137687, -592.4608953946511, -553.2364232081312, -802.9696807975071, -657.9355352556672, -850.5801311461079, -676.3735104351586, -726.9580268886344, -984.4916792183878, -616.6977224988905, -915.1358362429053, -893.7816637274223, -624.647383853262, -723.8986036735728, -471.42117465765386, -831.0077487444229, -947.0396737642479, -634.663800990879, -807.2580484403014, -648.9219181161432, -620.3567345551995, -639.4533850960762, -943.8606594988436, -858.495290093199, -786.4370754929433, -786.6827755922249, -563.973340859308, -464.8012292399626, -865.170113788972, -582.8359530439983, -537.7537778844808, -759.6805018287604, -610.7492818518934, -834.2038676824883, -949.5427001393628, -667.1258244678824, -700.8509962992503, -648.5050724387345, -545.0522486426842, -925.2814935636152, -801.4027627857698, -912.1556027608797, -813.9281640725316, -584.2112016587049, -787.9273601768657, -563.0925867475765, -800.7016680152313, -913.9847801122165, -847.9866764941737, -643.2681590791219, -818.2079029548335, -453.51368003433026, -396.61829840819047, -665.3456250856366, -506.83350490356173, -972.8543213673162, -573.5920277339925, -915.9296934869996, -736.3891108908471, -695.1621794893973, -859.3927844262998, -831.5223105078321, -522.1242556666122, -438.1174254569087, -670.530464445105, -1020.0141325025317, -231.74763244156043, -814.5989806353488, -572.5373769046483, -963.4093169303922, -378.7121108817956, -660.6809945759999, -964.4500678079972, -569.6248747523435, -655.2086356655067, -948.6080202306124, -969.4364238085022, -725.7014478863263, -541.3222933855977, -1008.6424508690859, -742.7160311111671, -779.4896749801029, -460.20891158542935, -645.4409639656476, -706.5483776911964, -565.9220434169837, -525.1114090311074, -780.5136943219226, -840.7269000866697, -673.5101670170865, -485.803438931345, -551.3636866450577, -908.9449212146648, -574.0773882990579, -462.41540130345356], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 21.136313062132913, "mean_inference_ms": 0.4005116376124025, "mean_action_processing_ms": 0.09567011253944874, "mean_env_wait_ms": 2.7012832113216154, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0039038658142089844, "StateBufferConnector_ms": 0.0027120113372802734, "ViewRequirementAgentConnector_ms": 0.06773948669433594}}, "episode_reward_max": -231.74763244156043, "episode_reward_min": -1020.0141325025317, "episode_reward_mean": -720.07790422562, "episode_len_mean": 120.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-939.3383088823931, -716.2847152315428, -915.5897601991649, -972.9648107527968, -976.0298988284203, -785.0108339137687, -592.4608953946511, -553.2364232081312, -802.9696807975071, -657.9355352556672, -850.5801311461079, -676.3735104351586, -726.9580268886344, -984.4916792183878, -616.6977224988905, -915.1358362429053, -893.7816637274223, -624.647383853262, -723.8986036735728, -471.42117465765386, -831.0077487444229, -947.0396737642479, -634.663800990879, -807.2580484403014, -648.9219181161432, -620.3567345551995, -639.4533850960762, -943.8606594988436, -858.495290093199, -786.4370754929433, -786.6827755922249, -563.973340859308, -464.8012292399626, -865.170113788972, -582.8359530439983, -537.7537778844808, -759.6805018287604, -610.7492818518934, -834.2038676824883, -949.5427001393628, -667.1258244678824, -700.8509962992503, -648.5050724387345, -545.0522486426842, -925.2814935636152, -801.4027627857698, -912.1556027608797, -813.9281640725316, -584.2112016587049, -787.9273601768657, -563.0925867475765, -800.7016680152313, -913.9847801122165, -847.9866764941737, -643.2681590791219, -818.2079029548335, -453.51368003433026, -396.61829840819047, -665.3456250856366, -506.83350490356173, -972.8543213673162, -573.5920277339925, -915.9296934869996, -736.3891108908471, -695.1621794893973, -859.3927844262998, -831.5223105078321, -522.1242556666122, -438.1174254569087, -670.530464445105, -1020.0141325025317, -231.74763244156043, -814.5989806353488, -572.5373769046483, -963.4093169303922, -378.7121108817956, -660.6809945759999, -964.4500678079972, -569.6248747523435, -655.2086356655067, -948.6080202306124, -969.4364238085022, -725.7014478863263, -541.3222933855977, -1008.6424508690859, -742.7160311111671, -779.4896749801029, -460.20891158542935, -645.4409639656476, -706.5483776911964, -565.9220434169837, -525.1114090311074, -780.5136943219226, -840.7269000866697, -673.5101670170865, -485.803438931345, -551.3636866450577, -908.9449212146648, -574.0773882990579, -462.41540130345356], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 21.136313062132913, "mean_inference_ms": 0.4005116376124025, "mean_action_processing_ms": 0.09567011253944874, "mean_env_wait_ms": 2.7012832113216154, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0039038658142089844, "StateBufferConnector_ms": 0.0027120113372802734, "ViewRequirementAgentConnector_ms": 0.06773948669433594}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 281400, "num_agent_steps_trained": 281400, "num_env_steps_sampled": 281400, "num_env_steps_trained": 281400, "num_env_steps_sampled_this_iter": 480, "num_env_steps_trained_this_iter": 480, "num_env_steps_sampled_throughput_per_sec": 41.57799902786832, "num_env_steps_trained_throughput_per_sec": 41.57799902786832, "timesteps_total": 281400, "num_steps_trained_this_iter": 480, "agent_timesteps_total": 281400, "timers": {"training_iteration_time_ms": 2927.788, "sample_time_ms": 2923.966, "load_time_ms": 0.221, "load_throughput": 543831.961, "learn_time_ms": 2.84, "learn_throughput": 42256.087, "synch_weights_time_ms": 0.719}, "counters": {"num_env_steps_sampled": 281400, "num_env_steps_trained": 281400, "num_agent_steps_sampled": 281400, "num_agent_steps_trained": 281400}, "done": false, "episodes_total": 2345, "training_iteration": 587, "trial_id": "29a31_00000", "date": "2023-07-26_02-47-41", "timestamp": 1690328861, "time_this_iter_s": 11.547437906265259, "time_total_s": 7106.577857255936, "pid": 90822, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 1, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[253680, 5e-06], [256080, 5e-06], [258480, 2.5e-06], [260880, 2.5e-06], [263280, 2.5e-06], [265680, 2.5e-06], [268080, 1e-06], [270480, 1e-06], [272880, 1e-06], [275280, 5e-07], [277680, 5e-07], [280080, 5e-07], [282480, 5e-07], [284880, 5e-07], [287280, 1e-07], [289680, 1e-07], [292080, 1e-07]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 120, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x16ca65700>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1485.252381324768, "iterations_since_restore": 127, "perf": {"cpu_util_percent": 33.16470588235294, "ram_util_percent": 74.2235294117647}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 5e-07, "entropy_coeff": 0.05, "policy_entropy": 265.8269958496094, "policy_loss": -110241.203125, "vf_loss": 6062592.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 511.0, "diff_num_grad_updates_vs_sampler_policy": 510.0}}, "num_env_steps_sampled": 281880, "num_env_steps_trained": 281880, "num_agent_steps_sampled": 281880, "num_agent_steps_trained": 281880}, "sampler_results": {"episode_reward_max": -231.74763244156043, "episode_reward_min": -1020.0141325025317, "episode_reward_mean": -711.88083691977, "episode_len_mean": 120.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-976.0298988284203, -785.0108339137687, -592.4608953946511, -553.2364232081312, -802.9696807975071, -657.9355352556672, -850.5801311461079, -676.3735104351586, -726.9580268886344, -984.4916792183878, -616.6977224988905, -915.1358362429053, -893.7816637274223, -624.647383853262, -723.8986036735728, -471.42117465765386, -831.0077487444229, -947.0396737642479, -634.663800990879, -807.2580484403014, -648.9219181161432, -620.3567345551995, -639.4533850960762, -943.8606594988436, -858.495290093199, -786.4370754929433, -786.6827755922249, -563.973340859308, -464.8012292399626, -865.170113788972, -582.8359530439983, -537.7537778844808, -759.6805018287604, -610.7492818518934, -834.2038676824883, -949.5427001393628, -667.1258244678824, -700.8509962992503, -648.5050724387345, -545.0522486426842, -925.2814935636152, -801.4027627857698, -912.1556027608797, -813.9281640725316, -584.2112016587049, -787.9273601768657, -563.0925867475765, -800.7016680152313, -913.9847801122165, -847.9866764941737, -643.2681590791219, -818.2079029548335, -453.51368003433026, -396.61829840819047, -665.3456250856366, -506.83350490356173, -972.8543213673162, -573.5920277339925, -915.9296934869996, -736.3891108908471, -695.1621794893973, -859.3927844262998, -831.5223105078321, -522.1242556666122, -438.1174254569087, -670.530464445105, -1020.0141325025317, -231.74763244156043, -814.5989806353488, -572.5373769046483, -963.4093169303922, -378.7121108817956, -660.6809945759999, -964.4500678079972, -569.6248747523435, -655.2086356655067, -948.6080202306124, -969.4364238085022, -725.7014478863263, -541.3222933855977, -1008.6424508690859, -742.7160311111671, -779.4896749801029, -460.20891158542935, -645.4409639656476, -706.5483776911964, -565.9220434169837, -525.1114090311074, -780.5136943219226, -840.7269000866697, -673.5101670170865, -485.803438931345, -551.3636866450577, -908.9449212146648, -574.0773882990579, -462.41540130345356, -557.150220673903, -660.5988816692344, -627.3411577451357, -879.3806043926231], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 21.136384322186174, "mean_inference_ms": 0.4005097086353885, "mean_action_processing_ms": 0.09566970705044393, "mean_env_wait_ms": 2.7009024537912594, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0039119720458984375, "StateBufferConnector_ms": 0.002719879150390625, "ViewRequirementAgentConnector_ms": 0.06784820556640625}}, "episode_reward_max": -231.74763244156043, "episode_reward_min": -1020.0141325025317, "episode_reward_mean": -711.88083691977, "episode_len_mean": 120.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-976.0298988284203, -785.0108339137687, -592.4608953946511, -553.2364232081312, -802.9696807975071, -657.9355352556672, -850.5801311461079, -676.3735104351586, -726.9580268886344, -984.4916792183878, -616.6977224988905, -915.1358362429053, -893.7816637274223, -624.647383853262, -723.8986036735728, -471.42117465765386, -831.0077487444229, -947.0396737642479, -634.663800990879, -807.2580484403014, -648.9219181161432, -620.3567345551995, -639.4533850960762, -943.8606594988436, -858.495290093199, -786.4370754929433, -786.6827755922249, -563.973340859308, -464.8012292399626, -865.170113788972, -582.8359530439983, -537.7537778844808, -759.6805018287604, -610.7492818518934, -834.2038676824883, -949.5427001393628, -667.1258244678824, -700.8509962992503, -648.5050724387345, -545.0522486426842, -925.2814935636152, -801.4027627857698, -912.1556027608797, -813.9281640725316, -584.2112016587049, -787.9273601768657, -563.0925867475765, -800.7016680152313, -913.9847801122165, -847.9866764941737, -643.2681590791219, -818.2079029548335, -453.51368003433026, -396.61829840819047, -665.3456250856366, -506.83350490356173, -972.8543213673162, -573.5920277339925, -915.9296934869996, -736.3891108908471, -695.1621794893973, -859.3927844262998, -831.5223105078321, -522.1242556666122, -438.1174254569087, -670.530464445105, -1020.0141325025317, -231.74763244156043, -814.5989806353488, -572.5373769046483, -963.4093169303922, -378.7121108817956, -660.6809945759999, -964.4500678079972, -569.6248747523435, -655.2086356655067, -948.6080202306124, -969.4364238085022, -725.7014478863263, -541.3222933855977, -1008.6424508690859, -742.7160311111671, -779.4896749801029, -460.20891158542935, -645.4409639656476, -706.5483776911964, -565.9220434169837, -525.1114090311074, -780.5136943219226, -840.7269000866697, -673.5101670170865, -485.803438931345, -551.3636866450577, -908.9449212146648, -574.0773882990579, -462.41540130345356, -557.150220673903, -660.5988816692344, -627.3411577451357, -879.3806043926231], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 21.136384322186174, "mean_inference_ms": 0.4005097086353885, "mean_action_processing_ms": 0.09566970705044393, "mean_env_wait_ms": 2.7009024537912594, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0039119720458984375, "StateBufferConnector_ms": 0.002719879150390625, "ViewRequirementAgentConnector_ms": 0.06784820556640625}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 281880, "num_agent_steps_trained": 281880, "num_env_steps_sampled": 281880, "num_env_steps_trained": 281880, "num_env_steps_sampled_this_iter": 480, "num_env_steps_trained_this_iter": 480, "num_env_steps_sampled_throughput_per_sec": 41.76437721482214, "num_env_steps_trained_throughput_per_sec": 41.76437721482214, "timesteps_total": 281880, "num_steps_trained_this_iter": 480, "agent_timesteps_total": 281880, "timers": {"training_iteration_time_ms": 2888.277, "sample_time_ms": 2884.447, "load_time_ms": 0.221, "load_throughput": 543244.987, "learn_time_ms": 2.838, "learn_throughput": 42289.461, "synch_weights_time_ms": 0.73}, "counters": {"num_env_steps_sampled": 281880, "num_env_steps_trained": 281880, "num_agent_steps_sampled": 281880, "num_agent_steps_trained": 281880}, "done": false, "episodes_total": 2349, "training_iteration": 588, "trial_id": "29a31_00000", "date": "2023-07-26_02-47-53", "timestamp": 1690328873, "time_this_iter_s": 11.495830059051514, "time_total_s": 7118.073687314987, "pid": 90822, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 1, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[253680, 5e-06], [256080, 5e-06], [258480, 2.5e-06], [260880, 2.5e-06], [263280, 2.5e-06], [265680, 2.5e-06], [268080, 1e-06], [270480, 1e-06], [272880, 1e-06], [275280, 5e-07], [277680, 5e-07], [280080, 5e-07], [282480, 5e-07], [284880, 5e-07], [287280, 1e-07], [289680, 1e-07], [292080, 1e-07]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 120, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x16ca65700>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1496.7482113838196, "iterations_since_restore": 128, "perf": {"cpu_util_percent": 35.137499999999996, "ram_util_percent": 72.28125}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 5e-07, "entropy_coeff": 0.05, "policy_entropy": 265.82159423828125, "policy_loss": -118717.0703125, "vf_loss": 6615555.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 515.0, "diff_num_grad_updates_vs_sampler_policy": 514.0}}, "num_env_steps_sampled": 282360, "num_env_steps_trained": 282360, "num_agent_steps_sampled": 282360, "num_agent_steps_trained": 282360}, "sampler_results": {"episode_reward_max": -231.74763244156043, "episode_reward_min": -1061.8762252237666, "episode_reward_mean": -717.9773703738203, "episode_len_mean": 120.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-802.9696807975071, -657.9355352556672, -850.5801311461079, -676.3735104351586, -726.9580268886344, -984.4916792183878, -616.6977224988905, -915.1358362429053, -893.7816637274223, -624.647383853262, -723.8986036735728, -471.42117465765386, -831.0077487444229, -947.0396737642479, -634.663800990879, -807.2580484403014, -648.9219181161432, -620.3567345551995, -639.4533850960762, -943.8606594988436, -858.495290093199, -786.4370754929433, -786.6827755922249, -563.973340859308, -464.8012292399626, -865.170113788972, -582.8359530439983, -537.7537778844808, -759.6805018287604, -610.7492818518934, -834.2038676824883, -949.5427001393628, -667.1258244678824, -700.8509962992503, -648.5050724387345, -545.0522486426842, -925.2814935636152, -801.4027627857698, -912.1556027608797, -813.9281640725316, -584.2112016587049, -787.9273601768657, -563.0925867475765, -800.7016680152313, -913.9847801122165, -847.9866764941737, -643.2681590791219, -818.2079029548335, -453.51368003433026, -396.61829840819047, -665.3456250856366, -506.83350490356173, -972.8543213673162, -573.5920277339925, -915.9296934869996, -736.3891108908471, -695.1621794893973, -859.3927844262998, -831.5223105078321, -522.1242556666122, -438.1174254569087, -670.530464445105, -1020.0141325025317, -231.74763244156043, -814.5989806353488, -572.5373769046483, -963.4093169303922, -378.7121108817956, -660.6809945759999, -964.4500678079972, -569.6248747523435, -655.2086356655067, -948.6080202306124, -969.4364238085022, -725.7014478863263, -541.3222933855977, -1008.6424508690859, -742.7160311111671, -779.4896749801029, -460.20891158542935, -645.4409639656476, -706.5483776911964, -565.9220434169837, -525.1114090311074, -780.5136943219226, -840.7269000866697, -673.5101670170865, -485.803438931345, -551.3636866450577, -908.9449212146648, -574.0773882990579, -462.41540130345356, -557.150220673903, -660.5988816692344, -627.3411577451357, -879.3806043926231, -562.4316851037782, -1061.8762252237666, -843.654621820575, -1048.4288646018947], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 21.136385721710884, "mean_inference_ms": 0.4005095800228983, "mean_action_processing_ms": 0.09566948780112862, "mean_env_wait_ms": 2.7005569487741834, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003916740417480469, "StateBufferConnector_ms": 0.002727508544921875, "ViewRequirementAgentConnector_ms": 0.06796622276306152}}, "episode_reward_max": -231.74763244156043, "episode_reward_min": -1061.8762252237666, "episode_reward_mean": -717.9773703738203, "episode_len_mean": 120.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-802.9696807975071, -657.9355352556672, -850.5801311461079, -676.3735104351586, -726.9580268886344, -984.4916792183878, -616.6977224988905, -915.1358362429053, -893.7816637274223, -624.647383853262, -723.8986036735728, -471.42117465765386, -831.0077487444229, -947.0396737642479, -634.663800990879, -807.2580484403014, -648.9219181161432, -620.3567345551995, -639.4533850960762, -943.8606594988436, -858.495290093199, -786.4370754929433, -786.6827755922249, -563.973340859308, -464.8012292399626, -865.170113788972, -582.8359530439983, -537.7537778844808, -759.6805018287604, -610.7492818518934, -834.2038676824883, -949.5427001393628, -667.1258244678824, -700.8509962992503, -648.5050724387345, -545.0522486426842, -925.2814935636152, -801.4027627857698, -912.1556027608797, -813.9281640725316, -584.2112016587049, -787.9273601768657, -563.0925867475765, -800.7016680152313, -913.9847801122165, -847.9866764941737, -643.2681590791219, -818.2079029548335, -453.51368003433026, -396.61829840819047, -665.3456250856366, -506.83350490356173, -972.8543213673162, -573.5920277339925, -915.9296934869996, -736.3891108908471, -695.1621794893973, -859.3927844262998, -831.5223105078321, -522.1242556666122, -438.1174254569087, -670.530464445105, -1020.0141325025317, -231.74763244156043, -814.5989806353488, -572.5373769046483, -963.4093169303922, -378.7121108817956, -660.6809945759999, -964.4500678079972, -569.6248747523435, -655.2086356655067, -948.6080202306124, -969.4364238085022, -725.7014478863263, -541.3222933855977, -1008.6424508690859, -742.7160311111671, -779.4896749801029, -460.20891158542935, -645.4409639656476, -706.5483776911964, -565.9220434169837, -525.1114090311074, -780.5136943219226, -840.7269000866697, -673.5101670170865, -485.803438931345, -551.3636866450577, -908.9449212146648, -574.0773882990579, -462.41540130345356, -557.150220673903, -660.5988816692344, -627.3411577451357, -879.3806043926231, -562.4316851037782, -1061.8762252237666, -843.654621820575, -1048.4288646018947], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 21.136385721710884, "mean_inference_ms": 0.4005095800228983, "mean_action_processing_ms": 0.09566948780112862, "mean_env_wait_ms": 2.7005569487741834, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003916740417480469, "StateBufferConnector_ms": 0.002727508544921875, "ViewRequirementAgentConnector_ms": 0.06796622276306152}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 282360, "num_agent_steps_trained": 282360, "num_env_steps_sampled": 282360, "num_env_steps_trained": 282360, "num_env_steps_sampled_this_iter": 480, "num_env_steps_trained_this_iter": 480, "num_env_steps_sampled_throughput_per_sec": 41.66256587061875, "num_env_steps_trained_throughput_per_sec": 41.66256587061875, "timesteps_total": 282360, "num_steps_trained_this_iter": 480, "agent_timesteps_total": 282360, "timers": {"training_iteration_time_ms": 2871.063, "sample_time_ms": 2867.275, "load_time_ms": 0.218, "load_throughput": 550614.244, "learn_time_ms": 2.799, "learn_throughput": 42870.471, "synch_weights_time_ms": 0.731}, "counters": {"num_env_steps_sampled": 282360, "num_env_steps_trained": 282360, "num_agent_steps_sampled": 282360, "num_agent_steps_trained": 282360}, "done": false, "episodes_total": 2353, "training_iteration": 589, "trial_id": "29a31_00000", "date": "2023-07-26_02-48-04", "timestamp": 1690328884, "time_this_iter_s": 11.523807048797607, "time_total_s": 7129.597494363785, "pid": 90822, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 1, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[253680, 5e-06], [256080, 5e-06], [258480, 2.5e-06], [260880, 2.5e-06], [263280, 2.5e-06], [265680, 2.5e-06], [268080, 1e-06], [270480, 1e-06], [272880, 1e-06], [275280, 5e-07], [277680, 5e-07], [280080, 5e-07], [282480, 5e-07], [284880, 5e-07], [287280, 1e-07], [289680, 1e-07], [292080, 1e-07]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 120, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x16ca65700>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1508.2720184326172, "iterations_since_restore": 129, "perf": {"cpu_util_percent": 34.0625, "ram_util_percent": 72.46875}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 5e-07, "entropy_coeff": 0.05, "policy_entropy": 265.8077697753906, "policy_loss": -54865.24609375, "vf_loss": 1507197.75}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 519.0, "diff_num_grad_updates_vs_sampler_policy": 518.0}}, "num_env_steps_sampled": 282840, "num_env_steps_trained": 282840, "num_agent_steps_sampled": 282840, "num_agent_steps_trained": 282840}, "sampler_results": {"episode_reward_max": -231.74763244156043, "episode_reward_min": -1061.8762252237666, "episode_reward_mean": -718.904182418226, "episode_len_mean": 120.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-726.9580268886344, -984.4916792183878, -616.6977224988905, -915.1358362429053, -893.7816637274223, -624.647383853262, -723.8986036735728, -471.42117465765386, -831.0077487444229, -947.0396737642479, -634.663800990879, -807.2580484403014, -648.9219181161432, -620.3567345551995, -639.4533850960762, -943.8606594988436, -858.495290093199, -786.4370754929433, -786.6827755922249, -563.973340859308, -464.8012292399626, -865.170113788972, -582.8359530439983, -537.7537778844808, -759.6805018287604, -610.7492818518934, -834.2038676824883, -949.5427001393628, -667.1258244678824, -700.8509962992503, -648.5050724387345, -545.0522486426842, -925.2814935636152, -801.4027627857698, -912.1556027608797, -813.9281640725316, -584.2112016587049, -787.9273601768657, -563.0925867475765, -800.7016680152313, -913.9847801122165, -847.9866764941737, -643.2681590791219, -818.2079029548335, -453.51368003433026, -396.61829840819047, -665.3456250856366, -506.83350490356173, -972.8543213673162, -573.5920277339925, -915.9296934869996, -736.3891108908471, -695.1621794893973, -859.3927844262998, -831.5223105078321, -522.1242556666122, -438.1174254569087, -670.530464445105, -1020.0141325025317, -231.74763244156043, -814.5989806353488, -572.5373769046483, -963.4093169303922, -378.7121108817956, -660.6809945759999, -964.4500678079972, -569.6248747523435, -655.2086356655067, -948.6080202306124, -969.4364238085022, -725.7014478863263, -541.3222933855977, -1008.6424508690859, -742.7160311111671, -779.4896749801029, -460.20891158542935, -645.4409639656476, -706.5483776911964, -565.9220434169837, -525.1114090311074, -780.5136943219226, -840.7269000866697, -673.5101670170865, -485.803438931345, -551.3636866450577, -908.9449212146648, -574.0773882990579, -462.41540130345356, -557.150220673903, -660.5988816692344, -627.3411577451357, -879.3806043926231, -562.4316851037782, -1061.8762252237666, -843.654621820575, -1048.4288646018947, -987.5935105478637, -622.2701431641075, -1008.7533844008826, -461.9230239621608], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 21.13620653232481, "mean_inference_ms": 0.4005059403802538, "mean_action_processing_ms": 0.09566864885022383, "mean_env_wait_ms": 2.7001670839907526, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003912448883056641, "StateBufferConnector_ms": 0.0027265548706054688, "ViewRequirementAgentConnector_ms": 0.06789612770080566}}, "episode_reward_max": -231.74763244156043, "episode_reward_min": -1061.8762252237666, "episode_reward_mean": -718.904182418226, "episode_len_mean": 120.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-726.9580268886344, -984.4916792183878, -616.6977224988905, -915.1358362429053, -893.7816637274223, -624.647383853262, -723.8986036735728, -471.42117465765386, -831.0077487444229, -947.0396737642479, -634.663800990879, -807.2580484403014, -648.9219181161432, -620.3567345551995, -639.4533850960762, -943.8606594988436, -858.495290093199, -786.4370754929433, -786.6827755922249, -563.973340859308, -464.8012292399626, -865.170113788972, -582.8359530439983, -537.7537778844808, -759.6805018287604, -610.7492818518934, -834.2038676824883, -949.5427001393628, -667.1258244678824, -700.8509962992503, -648.5050724387345, -545.0522486426842, -925.2814935636152, -801.4027627857698, -912.1556027608797, -813.9281640725316, -584.2112016587049, -787.9273601768657, -563.0925867475765, -800.7016680152313, -913.9847801122165, -847.9866764941737, -643.2681590791219, -818.2079029548335, -453.51368003433026, -396.61829840819047, -665.3456250856366, -506.83350490356173, -972.8543213673162, -573.5920277339925, -915.9296934869996, -736.3891108908471, -695.1621794893973, -859.3927844262998, -831.5223105078321, -522.1242556666122, -438.1174254569087, -670.530464445105, -1020.0141325025317, -231.74763244156043, -814.5989806353488, -572.5373769046483, -963.4093169303922, -378.7121108817956, -660.6809945759999, -964.4500678079972, -569.6248747523435, -655.2086356655067, -948.6080202306124, -969.4364238085022, -725.7014478863263, -541.3222933855977, -1008.6424508690859, -742.7160311111671, -779.4896749801029, -460.20891158542935, -645.4409639656476, -706.5483776911964, -565.9220434169837, -525.1114090311074, -780.5136943219226, -840.7269000866697, -673.5101670170865, -485.803438931345, -551.3636866450577, -908.9449212146648, -574.0773882990579, -462.41540130345356, -557.150220673903, -660.5988816692344, -627.3411577451357, -879.3806043926231, -562.4316851037782, -1061.8762252237666, -843.654621820575, -1048.4288646018947, -987.5935105478637, -622.2701431641075, -1008.7533844008826, -461.9230239621608], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 21.13620653232481, "mean_inference_ms": 0.4005059403802538, "mean_action_processing_ms": 0.09566864885022383, "mean_env_wait_ms": 2.7001670839907526, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003912448883056641, "StateBufferConnector_ms": 0.0027265548706054688, "ViewRequirementAgentConnector_ms": 0.06789612770080566}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 282840, "num_agent_steps_trained": 282840, "num_env_steps_sampled": 282840, "num_env_steps_trained": 282840, "num_env_steps_sampled_this_iter": 480, "num_env_steps_trained_this_iter": 480, "num_env_steps_sampled_throughput_per_sec": 40.738050890139355, "num_env_steps_trained_throughput_per_sec": 40.738050890139355, "timesteps_total": 282840, "num_steps_trained_this_iter": 480, "agent_timesteps_total": 282840, "timers": {"training_iteration_time_ms": 2905.445, "sample_time_ms": 2901.692, "load_time_ms": 0.218, "load_throughput": 550915.587, "learn_time_ms": 2.79, "learn_throughput": 43006.005, "synch_weights_time_ms": 0.705}, "counters": {"num_env_steps_sampled": 282840, "num_env_steps_trained": 282840, "num_agent_steps_sampled": 282840, "num_agent_steps_trained": 282840}, "done": false, "episodes_total": 2357, "training_iteration": 590, "trial_id": "29a31_00000", "date": "2023-07-26_02-48-16", "timestamp": 1690328896, "time_this_iter_s": 11.785298347473145, "time_total_s": 7141.382792711258, "pid": 90822, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 1, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[253680, 5e-06], [256080, 5e-06], [258480, 2.5e-06], [260880, 2.5e-06], [263280, 2.5e-06], [265680, 2.5e-06], [268080, 1e-06], [270480, 1e-06], [272880, 1e-06], [275280, 5e-07], [277680, 5e-07], [280080, 5e-07], [282480, 5e-07], [284880, 5e-07], [287280, 1e-07], [289680, 1e-07], [292080, 1e-07]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 120, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x16ca65700>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1520.0573167800903, "iterations_since_restore": 130, "perf": {"cpu_util_percent": 38.02941176470588, "ram_util_percent": 72.92941176470588}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 5e-07, "entropy_coeff": 0.05, "policy_entropy": 265.7899475097656, "policy_loss": -92808.359375, "vf_loss": 4005852.5}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 523.0, "diff_num_grad_updates_vs_sampler_policy": 522.0}}, "num_env_steps_sampled": 283320, "num_env_steps_trained": 283320, "num_agent_steps_sampled": 283320, "num_agent_steps_trained": 283320}, "sampler_results": {"episode_reward_max": -231.74763244156043, "episode_reward_min": -1061.8762252237666, "episode_reward_mean": -716.0109717560781, "episode_len_mean": 120.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-893.7816637274223, -624.647383853262, -723.8986036735728, -471.42117465765386, -831.0077487444229, -947.0396737642479, -634.663800990879, -807.2580484403014, -648.9219181161432, -620.3567345551995, -639.4533850960762, -943.8606594988436, -858.495290093199, -786.4370754929433, -786.6827755922249, -563.973340859308, -464.8012292399626, -865.170113788972, -582.8359530439983, -537.7537778844808, -759.6805018287604, -610.7492818518934, -834.2038676824883, -949.5427001393628, -667.1258244678824, -700.8509962992503, -648.5050724387345, -545.0522486426842, -925.2814935636152, -801.4027627857698, -912.1556027608797, -813.9281640725316, -584.2112016587049, -787.9273601768657, -563.0925867475765, -800.7016680152313, -913.9847801122165, -847.9866764941737, -643.2681590791219, -818.2079029548335, -453.51368003433026, -396.61829840819047, -665.3456250856366, -506.83350490356173, -972.8543213673162, -573.5920277339925, -915.9296934869996, -736.3891108908471, -695.1621794893973, -859.3927844262998, -831.5223105078321, -522.1242556666122, -438.1174254569087, -670.530464445105, -1020.0141325025317, -231.74763244156043, -814.5989806353488, -572.5373769046483, -963.4093169303922, -378.7121108817956, -660.6809945759999, -964.4500678079972, -569.6248747523435, -655.2086356655067, -948.6080202306124, -969.4364238085022, -725.7014478863263, -541.3222933855977, -1008.6424508690859, -742.7160311111671, -779.4896749801029, -460.20891158542935, -645.4409639656476, -706.5483776911964, -565.9220434169837, -525.1114090311074, -780.5136943219226, -840.7269000866697, -673.5101670170865, -485.803438931345, -551.3636866450577, -908.9449212146648, -574.0773882990579, -462.41540130345356, -557.150220673903, -660.5988816692344, -627.3411577451357, -879.3806043926231, -562.4316851037782, -1061.8762252237666, -843.654621820575, -1048.4288646018947, -987.5935105478637, -622.2701431641075, -1008.7533844008826, -461.9230239621608, -699.5586721894739, -974.3962426513264, -613.6975434392224, -666.3097403539799], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 21.13599980438143, "mean_inference_ms": 0.4005003427625271, "mean_action_processing_ms": 0.09566740921203738, "mean_env_wait_ms": 2.6998063043508376, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003907680511474609, "StateBufferConnector_ms": 0.0027294158935546875, "ViewRequirementAgentConnector_ms": 0.06786036491394043}}, "episode_reward_max": -231.74763244156043, "episode_reward_min": -1061.8762252237666, "episode_reward_mean": -716.0109717560781, "episode_len_mean": 120.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-893.7816637274223, -624.647383853262, -723.8986036735728, -471.42117465765386, -831.0077487444229, -947.0396737642479, -634.663800990879, -807.2580484403014, -648.9219181161432, -620.3567345551995, -639.4533850960762, -943.8606594988436, -858.495290093199, -786.4370754929433, -786.6827755922249, -563.973340859308, -464.8012292399626, -865.170113788972, -582.8359530439983, -537.7537778844808, -759.6805018287604, -610.7492818518934, -834.2038676824883, -949.5427001393628, -667.1258244678824, -700.8509962992503, -648.5050724387345, -545.0522486426842, -925.2814935636152, -801.4027627857698, -912.1556027608797, -813.9281640725316, -584.2112016587049, -787.9273601768657, -563.0925867475765, -800.7016680152313, -913.9847801122165, -847.9866764941737, -643.2681590791219, -818.2079029548335, -453.51368003433026, -396.61829840819047, -665.3456250856366, -506.83350490356173, -972.8543213673162, -573.5920277339925, -915.9296934869996, -736.3891108908471, -695.1621794893973, -859.3927844262998, -831.5223105078321, -522.1242556666122, -438.1174254569087, -670.530464445105, -1020.0141325025317, -231.74763244156043, -814.5989806353488, -572.5373769046483, -963.4093169303922, -378.7121108817956, -660.6809945759999, -964.4500678079972, -569.6248747523435, -655.2086356655067, -948.6080202306124, -969.4364238085022, -725.7014478863263, -541.3222933855977, -1008.6424508690859, -742.7160311111671, -779.4896749801029, -460.20891158542935, -645.4409639656476, -706.5483776911964, -565.9220434169837, -525.1114090311074, -780.5136943219226, -840.7269000866697, -673.5101670170865, -485.803438931345, -551.3636866450577, -908.9449212146648, -574.0773882990579, -462.41540130345356, -557.150220673903, -660.5988816692344, -627.3411577451357, -879.3806043926231, -562.4316851037782, -1061.8762252237666, -843.654621820575, -1048.4288646018947, -987.5935105478637, -622.2701431641075, -1008.7533844008826, -461.9230239621608, -699.5586721894739, -974.3962426513264, -613.6975434392224, -666.3097403539799], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 21.13599980438143, "mean_inference_ms": 0.4005003427625271, "mean_action_processing_ms": 0.09566740921203738, "mean_env_wait_ms": 2.6998063043508376, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003907680511474609, "StateBufferConnector_ms": 0.0027294158935546875, "ViewRequirementAgentConnector_ms": 0.06786036491394043}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 283320, "num_agent_steps_trained": 283320, "num_env_steps_sampled": 283320, "num_env_steps_trained": 283320, "num_env_steps_sampled_this_iter": 480, "num_env_steps_trained_this_iter": 480, "num_env_steps_sampled_throughput_per_sec": 40.36500785991162, "num_env_steps_trained_throughput_per_sec": 40.36500785991162, "timesteps_total": 283320, "num_steps_trained_this_iter": 480, "agent_timesteps_total": 283320, "timers": {"training_iteration_time_ms": 2944.871, "sample_time_ms": 2940.517, "load_time_ms": 0.311, "load_throughput": 385328.801, "learn_time_ms": 3.054, "learn_throughput": 39287.53, "synch_weights_time_ms": 0.944}, "counters": {"num_env_steps_sampled": 283320, "num_env_steps_trained": 283320, "num_agent_steps_sampled": 283320, "num_agent_steps_trained": 283320}, "done": false, "episodes_total": 2361, "training_iteration": 591, "trial_id": "29a31_00000", "date": "2023-07-26_02-48-28", "timestamp": 1690328908, "time_this_iter_s": 11.938033103942871, "time_total_s": 7153.320825815201, "pid": 90822, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 1, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[253680, 5e-06], [256080, 5e-06], [258480, 2.5e-06], [260880, 2.5e-06], [263280, 2.5e-06], [265680, 2.5e-06], [268080, 1e-06], [270480, 1e-06], [272880, 1e-06], [275280, 5e-07], [277680, 5e-07], [280080, 5e-07], [282480, 5e-07], [284880, 5e-07], [287280, 1e-07], [289680, 1e-07], [292080, 1e-07]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 120, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x16ca65700>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1531.9953498840332, "iterations_since_restore": 131, "perf": {"cpu_util_percent": 43.64117647058824, "ram_util_percent": 74.30000000000001}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 5e-07, "entropy_coeff": 0.05, "policy_entropy": 265.80682373046875, "policy_loss": -115740.1796875, "vf_loss": 6264089.5}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 527.0, "diff_num_grad_updates_vs_sampler_policy": 526.0}}, "num_env_steps_sampled": 283800, "num_env_steps_trained": 283800, "num_agent_steps_sampled": 283800, "num_agent_steps_trained": 283800}, "sampler_results": {"episode_reward_max": -231.74763244156043, "episode_reward_min": -1061.8762252237666, "episode_reward_mean": -716.7429642586053, "episode_len_mean": 120.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-831.0077487444229, -947.0396737642479, -634.663800990879, -807.2580484403014, -648.9219181161432, -620.3567345551995, -639.4533850960762, -943.8606594988436, -858.495290093199, -786.4370754929433, -786.6827755922249, -563.973340859308, -464.8012292399626, -865.170113788972, -582.8359530439983, -537.7537778844808, -759.6805018287604, -610.7492818518934, -834.2038676824883, -949.5427001393628, -667.1258244678824, -700.8509962992503, -648.5050724387345, -545.0522486426842, -925.2814935636152, -801.4027627857698, -912.1556027608797, -813.9281640725316, -584.2112016587049, -787.9273601768657, -563.0925867475765, -800.7016680152313, -913.9847801122165, -847.9866764941737, -643.2681590791219, -818.2079029548335, -453.51368003433026, -396.61829840819047, -665.3456250856366, -506.83350490356173, -972.8543213673162, -573.5920277339925, -915.9296934869996, -736.3891108908471, -695.1621794893973, -859.3927844262998, -831.5223105078321, -522.1242556666122, -438.1174254569087, -670.530464445105, -1020.0141325025317, -231.74763244156043, -814.5989806353488, -572.5373769046483, -963.4093169303922, -378.7121108817956, -660.6809945759999, -964.4500678079972, -569.6248747523435, -655.2086356655067, -948.6080202306124, -969.4364238085022, -725.7014478863263, -541.3222933855977, -1008.6424508690859, -742.7160311111671, -779.4896749801029, -460.20891158542935, -645.4409639656476, -706.5483776911964, -565.9220434169837, -525.1114090311074, -780.5136943219226, -840.7269000866697, -673.5101670170865, -485.803438931345, -551.3636866450577, -908.9449212146648, -574.0773882990579, -462.41540130345356, -557.150220673903, -660.5988816692344, -627.3411577451357, -879.3806043926231, -562.4316851037782, -1061.8762252237666, -843.654621820575, -1048.4288646018947, -987.5935105478637, -622.2701431641075, -1008.7533844008826, -461.9230239621608, -699.5586721894739, -974.3962426513264, -613.6975434392224, -666.3097403539799, -722.8978520890435, -658.7188670623723, -484.81889639785794, -920.5124606153803], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 21.135801931512475, "mean_inference_ms": 0.4004987110783124, "mean_action_processing_ms": 0.09566689455698604, "mean_env_wait_ms": 2.6994684712452686, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003947257995605469, "StateBufferConnector_ms": 0.0027387142181396484, "ViewRequirementAgentConnector_ms": 0.06819891929626465}}, "episode_reward_max": -231.74763244156043, "episode_reward_min": -1061.8762252237666, "episode_reward_mean": -716.7429642586053, "episode_len_mean": 120.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-831.0077487444229, -947.0396737642479, -634.663800990879, -807.2580484403014, -648.9219181161432, -620.3567345551995, -639.4533850960762, -943.8606594988436, -858.495290093199, -786.4370754929433, -786.6827755922249, -563.973340859308, -464.8012292399626, -865.170113788972, -582.8359530439983, -537.7537778844808, -759.6805018287604, -610.7492818518934, -834.2038676824883, -949.5427001393628, -667.1258244678824, -700.8509962992503, -648.5050724387345, -545.0522486426842, -925.2814935636152, -801.4027627857698, -912.1556027608797, -813.9281640725316, -584.2112016587049, -787.9273601768657, -563.0925867475765, -800.7016680152313, -913.9847801122165, -847.9866764941737, -643.2681590791219, -818.2079029548335, -453.51368003433026, -396.61829840819047, -665.3456250856366, -506.83350490356173, -972.8543213673162, -573.5920277339925, -915.9296934869996, -736.3891108908471, -695.1621794893973, -859.3927844262998, -831.5223105078321, -522.1242556666122, -438.1174254569087, -670.530464445105, -1020.0141325025317, -231.74763244156043, -814.5989806353488, -572.5373769046483, -963.4093169303922, -378.7121108817956, -660.6809945759999, -964.4500678079972, -569.6248747523435, -655.2086356655067, -948.6080202306124, -969.4364238085022, -725.7014478863263, -541.3222933855977, -1008.6424508690859, -742.7160311111671, -779.4896749801029, -460.20891158542935, -645.4409639656476, -706.5483776911964, -565.9220434169837, -525.1114090311074, -780.5136943219226, -840.7269000866697, -673.5101670170865, -485.803438931345, -551.3636866450577, -908.9449212146648, -574.0773882990579, -462.41540130345356, -557.150220673903, -660.5988816692344, -627.3411577451357, -879.3806043926231, -562.4316851037782, -1061.8762252237666, -843.654621820575, -1048.4288646018947, -987.5935105478637, -622.2701431641075, -1008.7533844008826, -461.9230239621608, -699.5586721894739, -974.3962426513264, -613.6975434392224, -666.3097403539799, -722.8978520890435, -658.7188670623723, -484.81889639785794, -920.5124606153803], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 21.135801931512475, "mean_inference_ms": 0.4004987110783124, "mean_action_processing_ms": 0.09566689455698604, "mean_env_wait_ms": 2.6994684712452686, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003947257995605469, "StateBufferConnector_ms": 0.0027387142181396484, "ViewRequirementAgentConnector_ms": 0.06819891929626465}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 283800, "num_agent_steps_trained": 283800, "num_env_steps_sampled": 283800, "num_env_steps_trained": 283800, "num_env_steps_sampled_this_iter": 480, "num_env_steps_trained_this_iter": 480, "num_env_steps_sampled_throughput_per_sec": 41.687304022560596, "num_env_steps_trained_throughput_per_sec": 41.687304022560596, "timesteps_total": 283800, "num_steps_trained_this_iter": 480, "agent_timesteps_total": 283800, "timers": {"training_iteration_time_ms": 2943.493, "sample_time_ms": 2939.009, "load_time_ms": 0.321, "load_throughput": 373657.372, "learn_time_ms": 3.157, "learn_throughput": 38013.404, "synch_weights_time_ms": 0.956}, "counters": {"num_env_steps_sampled": 283800, "num_env_steps_trained": 283800, "num_agent_steps_sampled": 283800, "num_agent_steps_trained": 283800}, "done": false, "episodes_total": 2365, "training_iteration": 592, "trial_id": "29a31_00000", "date": "2023-07-26_02-48-40", "timestamp": 1690328920, "time_this_iter_s": 11.517024040222168, "time_total_s": 7164.837849855423, "pid": 90822, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 1, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[253680, 5e-06], [256080, 5e-06], [258480, 2.5e-06], [260880, 2.5e-06], [263280, 2.5e-06], [265680, 2.5e-06], [268080, 1e-06], [270480, 1e-06], [272880, 1e-06], [275280, 5e-07], [277680, 5e-07], [280080, 5e-07], [282480, 5e-07], [284880, 5e-07], [287280, 1e-07], [289680, 1e-07], [292080, 1e-07]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 120, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x16ca65700>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1543.5123739242554, "iterations_since_restore": 132, "perf": {"cpu_util_percent": 47.912499999999994, "ram_util_percent": 78.2375}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 5e-07, "entropy_coeff": 0.05, "policy_entropy": 265.76934814453125, "policy_loss": -97879.78125, "vf_loss": 4307076.5}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 531.0, "diff_num_grad_updates_vs_sampler_policy": 530.0}}, "num_env_steps_sampled": 284280, "num_env_steps_trained": 284280, "num_agent_steps_sampled": 284280, "num_agent_steps_trained": 284280}, "sampler_results": {"episode_reward_max": -231.74763244156043, "episode_reward_min": -1061.8762252237666, "episode_reward_mean": -713.5187221917257, "episode_len_mean": 120.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-648.9219181161432, -620.3567345551995, -639.4533850960762, -943.8606594988436, -858.495290093199, -786.4370754929433, -786.6827755922249, -563.973340859308, -464.8012292399626, -865.170113788972, -582.8359530439983, -537.7537778844808, -759.6805018287604, -610.7492818518934, -834.2038676824883, -949.5427001393628, -667.1258244678824, -700.8509962992503, -648.5050724387345, -545.0522486426842, -925.2814935636152, -801.4027627857698, -912.1556027608797, -813.9281640725316, -584.2112016587049, -787.9273601768657, -563.0925867475765, -800.7016680152313, -913.9847801122165, -847.9866764941737, -643.2681590791219, -818.2079029548335, -453.51368003433026, -396.61829840819047, -665.3456250856366, -506.83350490356173, -972.8543213673162, -573.5920277339925, -915.9296934869996, -736.3891108908471, -695.1621794893973, -859.3927844262998, -831.5223105078321, -522.1242556666122, -438.1174254569087, -670.530464445105, -1020.0141325025317, -231.74763244156043, -814.5989806353488, -572.5373769046483, -963.4093169303922, -378.7121108817956, -660.6809945759999, -964.4500678079972, -569.6248747523435, -655.2086356655067, -948.6080202306124, -969.4364238085022, -725.7014478863263, -541.3222933855977, -1008.6424508690859, -742.7160311111671, -779.4896749801029, -460.20891158542935, -645.4409639656476, -706.5483776911964, -565.9220434169837, -525.1114090311074, -780.5136943219226, -840.7269000866697, -673.5101670170865, -485.803438931345, -551.3636866450577, -908.9449212146648, -574.0773882990579, -462.41540130345356, -557.150220673903, -660.5988816692344, -627.3411577451357, -879.3806043926231, -562.4316851037782, -1061.8762252237666, -843.654621820575, -1048.4288646018947, -987.5935105478637, -622.2701431641075, -1008.7533844008826, -461.9230239621608, -699.5586721894739, -974.3962426513264, -613.6975434392224, -666.3097403539799, -722.8978520890435, -658.7188670623723, -484.81889639785794, -920.5124606153803, -884.8070548872474, -389.8007620963685, -820.973597930829, -801.9636503374331], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 21.135628954380653, "mean_inference_ms": 0.400505677177396, "mean_action_processing_ms": 0.09566758291300757, "mean_env_wait_ms": 2.6991241949551097, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003946542739868164, "StateBufferConnector_ms": 0.0027437210083007812, "ViewRequirementAgentConnector_ms": 0.06826519966125488}}, "episode_reward_max": -231.74763244156043, "episode_reward_min": -1061.8762252237666, "episode_reward_mean": -713.5187221917257, "episode_len_mean": 120.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-648.9219181161432, -620.3567345551995, -639.4533850960762, -943.8606594988436, -858.495290093199, -786.4370754929433, -786.6827755922249, -563.973340859308, -464.8012292399626, -865.170113788972, -582.8359530439983, -537.7537778844808, -759.6805018287604, -610.7492818518934, -834.2038676824883, -949.5427001393628, -667.1258244678824, -700.8509962992503, -648.5050724387345, -545.0522486426842, -925.2814935636152, -801.4027627857698, -912.1556027608797, -813.9281640725316, -584.2112016587049, -787.9273601768657, -563.0925867475765, -800.7016680152313, -913.9847801122165, -847.9866764941737, -643.2681590791219, -818.2079029548335, -453.51368003433026, -396.61829840819047, -665.3456250856366, -506.83350490356173, -972.8543213673162, -573.5920277339925, -915.9296934869996, -736.3891108908471, -695.1621794893973, -859.3927844262998, -831.5223105078321, -522.1242556666122, -438.1174254569087, -670.530464445105, -1020.0141325025317, -231.74763244156043, -814.5989806353488, -572.5373769046483, -963.4093169303922, -378.7121108817956, -660.6809945759999, -964.4500678079972, -569.6248747523435, -655.2086356655067, -948.6080202306124, -969.4364238085022, -725.7014478863263, -541.3222933855977, -1008.6424508690859, -742.7160311111671, -779.4896749801029, -460.20891158542935, -645.4409639656476, -706.5483776911964, -565.9220434169837, -525.1114090311074, -780.5136943219226, -840.7269000866697, -673.5101670170865, -485.803438931345, -551.3636866450577, -908.9449212146648, -574.0773882990579, -462.41540130345356, -557.150220673903, -660.5988816692344, -627.3411577451357, -879.3806043926231, -562.4316851037782, -1061.8762252237666, -843.654621820575, -1048.4288646018947, -987.5935105478637, -622.2701431641075, -1008.7533844008826, -461.9230239621608, -699.5586721894739, -974.3962426513264, -613.6975434392224, -666.3097403539799, -722.8978520890435, -658.7188670623723, -484.81889639785794, -920.5124606153803, -884.8070548872474, -389.8007620963685, -820.973597930829, -801.9636503374331], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 21.135628954380653, "mean_inference_ms": 0.400505677177396, "mean_action_processing_ms": 0.09566758291300757, "mean_env_wait_ms": 2.6991241949551097, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003946542739868164, "StateBufferConnector_ms": 0.0027437210083007812, "ViewRequirementAgentConnector_ms": 0.06826519966125488}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 284280, "num_agent_steps_trained": 284280, "num_env_steps_sampled": 284280, "num_env_steps_trained": 284280, "num_env_steps_sampled_this_iter": 480, "num_env_steps_trained_this_iter": 480, "num_env_steps_sampled_throughput_per_sec": 41.504967177061545, "num_env_steps_trained_throughput_per_sec": 41.504967177061545, "timesteps_total": 284280, "num_steps_trained_this_iter": 480, "agent_timesteps_total": 284280, "timers": {"training_iteration_time_ms": 2915.973, "sample_time_ms": 2910.762, "load_time_ms": 0.372, "load_throughput": 322266.923, "learn_time_ms": 3.7, "learn_throughput": 32433.529, "synch_weights_time_ms": 1.044}, "counters": {"num_env_steps_sampled": 284280, "num_env_steps_trained": 284280, "num_agent_steps_sampled": 284280, "num_agent_steps_trained": 284280}, "done": false, "episodes_total": 2369, "training_iteration": 593, "trial_id": "29a31_00000", "date": "2023-07-26_02-48-51", "timestamp": 1690328931, "time_this_iter_s": 11.568295955657959, "time_total_s": 7176.406145811081, "pid": 90822, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 1, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[253680, 5e-06], [256080, 5e-06], [258480, 2.5e-06], [260880, 2.5e-06], [263280, 2.5e-06], [265680, 2.5e-06], [268080, 1e-06], [270480, 1e-06], [272880, 1e-06], [275280, 5e-07], [277680, 5e-07], [280080, 5e-07], [282480, 5e-07], [284880, 5e-07], [287280, 1e-07], [289680, 1e-07], [292080, 1e-07]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 120, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x16ca65700>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1555.0806698799133, "iterations_since_restore": 133, "perf": {"cpu_util_percent": 41.241176470588236, "ram_util_percent": 75.83529411764707}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 5e-07, "entropy_coeff": 0.05, "policy_entropy": 265.75732421875, "policy_loss": -103338.5703125, "vf_loss": 4528371.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 535.0, "diff_num_grad_updates_vs_sampler_policy": 534.0}}, "num_env_steps_sampled": 284760, "num_env_steps_trained": 284760, "num_agent_steps_sampled": 284760, "num_agent_steps_trained": 284760}, "sampler_results": {"episode_reward_max": -231.74763244156043, "episode_reward_min": -1061.8762252237666, "episode_reward_mean": -713.311846928153, "episode_len_mean": 120.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-858.495290093199, -786.4370754929433, -786.6827755922249, -563.973340859308, -464.8012292399626, -865.170113788972, -582.8359530439983, -537.7537778844808, -759.6805018287604, -610.7492818518934, -834.2038676824883, -949.5427001393628, -667.1258244678824, -700.8509962992503, -648.5050724387345, -545.0522486426842, -925.2814935636152, -801.4027627857698, -912.1556027608797, -813.9281640725316, -584.2112016587049, -787.9273601768657, -563.0925867475765, -800.7016680152313, -913.9847801122165, -847.9866764941737, -643.2681590791219, -818.2079029548335, -453.51368003433026, -396.61829840819047, -665.3456250856366, -506.83350490356173, -972.8543213673162, -573.5920277339925, -915.9296934869996, -736.3891108908471, -695.1621794893973, -859.3927844262998, -831.5223105078321, -522.1242556666122, -438.1174254569087, -670.530464445105, -1020.0141325025317, -231.74763244156043, -814.5989806353488, -572.5373769046483, -963.4093169303922, -378.7121108817956, -660.6809945759999, -964.4500678079972, -569.6248747523435, -655.2086356655067, -948.6080202306124, -969.4364238085022, -725.7014478863263, -541.3222933855977, -1008.6424508690859, -742.7160311111671, -779.4896749801029, -460.20891158542935, -645.4409639656476, -706.5483776911964, -565.9220434169837, -525.1114090311074, -780.5136943219226, -840.7269000866697, -673.5101670170865, -485.803438931345, -551.3636866450577, -908.9449212146648, -574.0773882990579, -462.41540130345356, -557.150220673903, -660.5988816692344, -627.3411577451357, -879.3806043926231, -562.4316851037782, -1061.8762252237666, -843.654621820575, -1048.4288646018947, -987.5935105478637, -622.2701431641075, -1008.7533844008826, -461.9230239621608, -699.5586721894739, -974.3962426513264, -613.6975434392224, -666.3097403539799, -722.8978520890435, -658.7188670623723, -484.81889639785794, -920.5124606153803, -884.8070548872474, -389.8007620963685, -820.973597930829, -801.9636503374331, -531.6714034058501, -895.0071001447924, -618.5695908984351, -786.6570764599375], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 21.13561342843769, "mean_inference_ms": 0.40051890482067676, "mean_action_processing_ms": 0.09566914397168755, "mean_env_wait_ms": 2.6988033520771366, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003942012786865234, "StateBufferConnector_ms": 0.002736330032348633, "ViewRequirementAgentConnector_ms": 0.06801080703735352}}, "episode_reward_max": -231.74763244156043, "episode_reward_min": -1061.8762252237666, "episode_reward_mean": -713.311846928153, "episode_len_mean": 120.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-858.495290093199, -786.4370754929433, -786.6827755922249, -563.973340859308, -464.8012292399626, -865.170113788972, -582.8359530439983, -537.7537778844808, -759.6805018287604, -610.7492818518934, -834.2038676824883, -949.5427001393628, -667.1258244678824, -700.8509962992503, -648.5050724387345, -545.0522486426842, -925.2814935636152, -801.4027627857698, -912.1556027608797, -813.9281640725316, -584.2112016587049, -787.9273601768657, -563.0925867475765, -800.7016680152313, -913.9847801122165, -847.9866764941737, -643.2681590791219, -818.2079029548335, -453.51368003433026, -396.61829840819047, -665.3456250856366, -506.83350490356173, -972.8543213673162, -573.5920277339925, -915.9296934869996, -736.3891108908471, -695.1621794893973, -859.3927844262998, -831.5223105078321, -522.1242556666122, -438.1174254569087, -670.530464445105, -1020.0141325025317, -231.74763244156043, -814.5989806353488, -572.5373769046483, -963.4093169303922, -378.7121108817956, -660.6809945759999, -964.4500678079972, -569.6248747523435, -655.2086356655067, -948.6080202306124, -969.4364238085022, -725.7014478863263, -541.3222933855977, -1008.6424508690859, -742.7160311111671, -779.4896749801029, -460.20891158542935, -645.4409639656476, -706.5483776911964, -565.9220434169837, -525.1114090311074, -780.5136943219226, -840.7269000866697, -673.5101670170865, -485.803438931345, -551.3636866450577, -908.9449212146648, -574.0773882990579, -462.41540130345356, -557.150220673903, -660.5988816692344, -627.3411577451357, -879.3806043926231, -562.4316851037782, -1061.8762252237666, -843.654621820575, -1048.4288646018947, -987.5935105478637, -622.2701431641075, -1008.7533844008826, -461.9230239621608, -699.5586721894739, -974.3962426513264, -613.6975434392224, -666.3097403539799, -722.8978520890435, -658.7188670623723, -484.81889639785794, -920.5124606153803, -884.8070548872474, -389.8007620963685, -820.973597930829, -801.9636503374331, -531.6714034058501, -895.0071001447924, -618.5695908984351, -786.6570764599375], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 21.13561342843769, "mean_inference_ms": 0.40051890482067676, "mean_action_processing_ms": 0.09566914397168755, "mean_env_wait_ms": 2.6988033520771366, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003942012786865234, "StateBufferConnector_ms": 0.002736330032348633, "ViewRequirementAgentConnector_ms": 0.06801080703735352}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 284760, "num_agent_steps_trained": 284760, "num_env_steps_sampled": 284760, "num_env_steps_trained": 284760, "num_env_steps_sampled_this_iter": 480, "num_env_steps_trained_this_iter": 480, "num_env_steps_sampled_throughput_per_sec": 40.31931160293996, "num_env_steps_trained_throughput_per_sec": 40.31931160293996, "timesteps_total": 284760, "num_steps_trained_this_iter": 480, "agent_timesteps_total": 284760, "timers": {"training_iteration_time_ms": 2914.37, "sample_time_ms": 2909.829, "load_time_ms": 0.274, "load_throughput": 437666.504, "learn_time_ms": 3.395, "learn_throughput": 35344.514, "synch_weights_time_ms": 0.787}, "counters": {"num_env_steps_sampled": 284760, "num_env_steps_trained": 284760, "num_agent_steps_sampled": 284760, "num_agent_steps_trained": 284760}, "done": false, "episodes_total": 2373, "training_iteration": 594, "trial_id": "29a31_00000", "date": "2023-07-26_02-49-03", "timestamp": 1690328943, "time_this_iter_s": 11.907782793045044, "time_total_s": 7188.313928604126, "pid": 90822, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 1, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[253680, 5e-06], [256080, 5e-06], [258480, 2.5e-06], [260880, 2.5e-06], [263280, 2.5e-06], [265680, 2.5e-06], [268080, 1e-06], [270480, 1e-06], [272880, 1e-06], [275280, 5e-07], [277680, 5e-07], [280080, 5e-07], [282480, 5e-07], [284880, 5e-07], [287280, 1e-07], [289680, 1e-07], [292080, 1e-07]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 120, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x16ca65700>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1566.9884526729584, "iterations_since_restore": 134, "perf": {"cpu_util_percent": 41.9470588235294, "ram_util_percent": 78.21176470588235}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 4.6e-07, "entropy_coeff": 0.05, "policy_entropy": 265.7565002441406, "policy_loss": -124300.0234375, "vf_loss": 7163082.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 539.0, "diff_num_grad_updates_vs_sampler_policy": 538.0}}, "num_env_steps_sampled": 285240, "num_env_steps_trained": 285240, "num_agent_steps_sampled": 285240, "num_agent_steps_trained": 285240}, "sampler_results": {"episode_reward_max": -231.74763244156043, "episode_reward_min": -1061.8762252237666, "episode_reward_mean": -710.0841476139344, "episode_len_mean": 120.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-464.8012292399626, -865.170113788972, -582.8359530439983, -537.7537778844808, -759.6805018287604, -610.7492818518934, -834.2038676824883, -949.5427001393628, -667.1258244678824, -700.8509962992503, -648.5050724387345, -545.0522486426842, -925.2814935636152, -801.4027627857698, -912.1556027608797, -813.9281640725316, -584.2112016587049, -787.9273601768657, -563.0925867475765, -800.7016680152313, -913.9847801122165, -847.9866764941737, -643.2681590791219, -818.2079029548335, -453.51368003433026, -396.61829840819047, -665.3456250856366, -506.83350490356173, -972.8543213673162, -573.5920277339925, -915.9296934869996, -736.3891108908471, -695.1621794893973, -859.3927844262998, -831.5223105078321, -522.1242556666122, -438.1174254569087, -670.530464445105, -1020.0141325025317, -231.74763244156043, -814.5989806353488, -572.5373769046483, -963.4093169303922, -378.7121108817956, -660.6809945759999, -964.4500678079972, -569.6248747523435, -655.2086356655067, -948.6080202306124, -969.4364238085022, -725.7014478863263, -541.3222933855977, -1008.6424508690859, -742.7160311111671, -779.4896749801029, -460.20891158542935, -645.4409639656476, -706.5483776911964, -565.9220434169837, -525.1114090311074, -780.5136943219226, -840.7269000866697, -673.5101670170865, -485.803438931345, -551.3636866450577, -908.9449212146648, -574.0773882990579, -462.41540130345356, -557.150220673903, -660.5988816692344, -627.3411577451357, -879.3806043926231, -562.4316851037782, -1061.8762252237666, -843.654621820575, -1048.4288646018947, -987.5935105478637, -622.2701431641075, -1008.7533844008826, -461.9230239621608, -699.5586721894739, -974.3962426513264, -613.6975434392224, -666.3097403539799, -722.8978520890435, -658.7188670623723, -484.81889639785794, -920.5124606153803, -884.8070548872474, -389.8007620963685, -820.973597930829, -801.9636503374331, -531.6714034058501, -895.0071001447924, -618.5695908984351, -786.6570764599375, -559.742439549061, -538.2297947752028, -694.6017662002592, -880.2445500912851], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 21.135559765140346, "mean_inference_ms": 0.4005362210238647, "mean_action_processing_ms": 0.09567146036802081, "mean_env_wait_ms": 2.6984458277653567, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003935575485229492, "StateBufferConnector_ms": 0.0027348995208740234, "ViewRequirementAgentConnector_ms": 0.06796956062316895}}, "episode_reward_max": -231.74763244156043, "episode_reward_min": -1061.8762252237666, "episode_reward_mean": -710.0841476139344, "episode_len_mean": 120.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-464.8012292399626, -865.170113788972, -582.8359530439983, -537.7537778844808, -759.6805018287604, -610.7492818518934, -834.2038676824883, -949.5427001393628, -667.1258244678824, -700.8509962992503, -648.5050724387345, -545.0522486426842, -925.2814935636152, -801.4027627857698, -912.1556027608797, -813.9281640725316, -584.2112016587049, -787.9273601768657, -563.0925867475765, -800.7016680152313, -913.9847801122165, -847.9866764941737, -643.2681590791219, -818.2079029548335, -453.51368003433026, -396.61829840819047, -665.3456250856366, -506.83350490356173, -972.8543213673162, -573.5920277339925, -915.9296934869996, -736.3891108908471, -695.1621794893973, -859.3927844262998, -831.5223105078321, -522.1242556666122, -438.1174254569087, -670.530464445105, -1020.0141325025317, -231.74763244156043, -814.5989806353488, -572.5373769046483, -963.4093169303922, -378.7121108817956, -660.6809945759999, -964.4500678079972, -569.6248747523435, -655.2086356655067, -948.6080202306124, -969.4364238085022, -725.7014478863263, -541.3222933855977, -1008.6424508690859, -742.7160311111671, -779.4896749801029, -460.20891158542935, -645.4409639656476, -706.5483776911964, -565.9220434169837, -525.1114090311074, -780.5136943219226, -840.7269000866697, -673.5101670170865, -485.803438931345, -551.3636866450577, -908.9449212146648, -574.0773882990579, -462.41540130345356, -557.150220673903, -660.5988816692344, -627.3411577451357, -879.3806043926231, -562.4316851037782, -1061.8762252237666, -843.654621820575, -1048.4288646018947, -987.5935105478637, -622.2701431641075, -1008.7533844008826, -461.9230239621608, -699.5586721894739, -974.3962426513264, -613.6975434392224, -666.3097403539799, -722.8978520890435, -658.7188670623723, -484.81889639785794, -920.5124606153803, -884.8070548872474, -389.8007620963685, -820.973597930829, -801.9636503374331, -531.6714034058501, -895.0071001447924, -618.5695908984351, -786.6570764599375, -559.742439549061, -538.2297947752028, -694.6017662002592, -880.2445500912851], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 21.135559765140346, "mean_inference_ms": 0.4005362210238647, "mean_action_processing_ms": 0.09567146036802081, "mean_env_wait_ms": 2.6984458277653567, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003935575485229492, "StateBufferConnector_ms": 0.0027348995208740234, "ViewRequirementAgentConnector_ms": 0.06796956062316895}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 285240, "num_agent_steps_trained": 285240, "num_env_steps_sampled": 285240, "num_env_steps_trained": 285240, "num_env_steps_sampled_this_iter": 480, "num_env_steps_trained_this_iter": 480, "num_env_steps_sampled_throughput_per_sec": 40.89890626026528, "num_env_steps_trained_throughput_per_sec": 40.89890626026528, "timesteps_total": 285240, "num_steps_trained_this_iter": 480, "agent_timesteps_total": 285240, "timers": {"training_iteration_time_ms": 2940.778, "sample_time_ms": 2936.106, "load_time_ms": 0.278, "load_throughput": 432142.595, "learn_time_ms": 3.486, "learn_throughput": 34418.568, "synch_weights_time_ms": 0.823}, "counters": {"num_env_steps_sampled": 285240, "num_env_steps_trained": 285240, "num_agent_steps_sampled": 285240, "num_agent_steps_trained": 285240}, "done": false, "episodes_total": 2377, "training_iteration": 595, "trial_id": "29a31_00000", "date": "2023-07-26_02-49-15", "timestamp": 1690328955, "time_this_iter_s": 11.739097118377686, "time_total_s": 7200.053025722504, "pid": 90822, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 1, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[253680, 5e-06], [256080, 5e-06], [258480, 2.5e-06], [260880, 2.5e-06], [263280, 2.5e-06], [265680, 2.5e-06], [268080, 1e-06], [270480, 1e-06], [272880, 1e-06], [275280, 5e-07], [277680, 5e-07], [280080, 5e-07], [282480, 5e-07], [284880, 5e-07], [287280, 1e-07], [289680, 1e-07], [292080, 1e-07]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 120, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x16ca65700>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1578.727549791336, "iterations_since_restore": 135, "perf": {"cpu_util_percent": 48.293749999999996, "ram_util_percent": 77.8375}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 4e-07, "entropy_coeff": 0.05, "policy_entropy": 265.7563781738281, "policy_loss": -103894.7890625, "vf_loss": 5201565.5}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 542.0, "diff_num_grad_updates_vs_sampler_policy": 541.0}}, "num_env_steps_sampled": 285600, "num_env_steps_trained": 285600, "num_agent_steps_sampled": 285600, "num_agent_steps_trained": 285600}, "sampler_results": {"episode_reward_max": -231.74763244156043, "episode_reward_min": -1061.8762252237666, "episode_reward_mean": -714.9247048072535, "episode_len_mean": 120.0, "episode_media": {}, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-537.7537778844808, -759.6805018287604, -610.7492818518934, -834.2038676824883, -949.5427001393628, -667.1258244678824, -700.8509962992503, -648.5050724387345, -545.0522486426842, -925.2814935636152, -801.4027627857698, -912.1556027608797, -813.9281640725316, -584.2112016587049, -787.9273601768657, -563.0925867475765, -800.7016680152313, -913.9847801122165, -847.9866764941737, -643.2681590791219, -818.2079029548335, -453.51368003433026, -396.61829840819047, -665.3456250856366, -506.83350490356173, -972.8543213673162, -573.5920277339925, -915.9296934869996, -736.3891108908471, -695.1621794893973, -859.3927844262998, -831.5223105078321, -522.1242556666122, -438.1174254569087, -670.530464445105, -1020.0141325025317, -231.74763244156043, -814.5989806353488, -572.5373769046483, -963.4093169303922, -378.7121108817956, -660.6809945759999, -964.4500678079972, -569.6248747523435, -655.2086356655067, -948.6080202306124, -969.4364238085022, -725.7014478863263, -541.3222933855977, -1008.6424508690859, -742.7160311111671, -779.4896749801029, -460.20891158542935, -645.4409639656476, -706.5483776911964, -565.9220434169837, -525.1114090311074, -780.5136943219226, -840.7269000866697, -673.5101670170865, -485.803438931345, -551.3636866450577, -908.9449212146648, -574.0773882990579, -462.41540130345356, -557.150220673903, -660.5988816692344, -627.3411577451357, -879.3806043926231, -562.4316851037782, -1061.8762252237666, -843.654621820575, -1048.4288646018947, -987.5935105478637, -622.2701431641075, -1008.7533844008826, -461.9230239621608, -699.5586721894739, -974.3962426513264, -613.6975434392224, -666.3097403539799, -722.8978520890435, -658.7188670623723, -484.81889639785794, -920.5124606153803, -884.8070548872474, -389.8007620963685, -820.973597930829, -801.9636503374331, -531.6714034058501, -895.0071001447924, -618.5695908984351, -786.6570764599375, -559.742439549061, -538.2297947752028, -694.6017662002592, -880.2445500912851, -732.3779458880055, -755.6675855089625, -908.8174840078908], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 21.13606479392909, "mean_inference_ms": 0.4005489652455128, "mean_action_processing_ms": 0.09567315681463294, "mean_env_wait_ms": 2.6981653942768395, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003957509994506836, "StateBufferConnector_ms": 0.002744436264038086, "ViewRequirementAgentConnector_ms": 0.06840085983276367}}, "episode_reward_max": -231.74763244156043, "episode_reward_min": -1061.8762252237666, "episode_reward_mean": -714.9247048072535, "episode_len_mean": 120.0, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-537.7537778844808, -759.6805018287604, -610.7492818518934, -834.2038676824883, -949.5427001393628, -667.1258244678824, -700.8509962992503, -648.5050724387345, -545.0522486426842, -925.2814935636152, -801.4027627857698, -912.1556027608797, -813.9281640725316, -584.2112016587049, -787.9273601768657, -563.0925867475765, -800.7016680152313, -913.9847801122165, -847.9866764941737, -643.2681590791219, -818.2079029548335, -453.51368003433026, -396.61829840819047, -665.3456250856366, -506.83350490356173, -972.8543213673162, -573.5920277339925, -915.9296934869996, -736.3891108908471, -695.1621794893973, -859.3927844262998, -831.5223105078321, -522.1242556666122, -438.1174254569087, -670.530464445105, -1020.0141325025317, -231.74763244156043, -814.5989806353488, -572.5373769046483, -963.4093169303922, -378.7121108817956, -660.6809945759999, -964.4500678079972, -569.6248747523435, -655.2086356655067, -948.6080202306124, -969.4364238085022, -725.7014478863263, -541.3222933855977, -1008.6424508690859, -742.7160311111671, -779.4896749801029, -460.20891158542935, -645.4409639656476, -706.5483776911964, -565.9220434169837, -525.1114090311074, -780.5136943219226, -840.7269000866697, -673.5101670170865, -485.803438931345, -551.3636866450577, -908.9449212146648, -574.0773882990579, -462.41540130345356, -557.150220673903, -660.5988816692344, -627.3411577451357, -879.3806043926231, -562.4316851037782, -1061.8762252237666, -843.654621820575, -1048.4288646018947, -987.5935105478637, -622.2701431641075, -1008.7533844008826, -461.9230239621608, -699.5586721894739, -974.3962426513264, -613.6975434392224, -666.3097403539799, -722.8978520890435, -658.7188670623723, -484.81889639785794, -920.5124606153803, -884.8070548872474, -389.8007620963685, -820.973597930829, -801.9636503374331, -531.6714034058501, -895.0071001447924, -618.5695908984351, -786.6570764599375, -559.742439549061, -538.2297947752028, -694.6017662002592, -880.2445500912851, -732.3779458880055, -755.6675855089625, -908.8174840078908], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 21.13606479392909, "mean_inference_ms": 0.4005489652455128, "mean_action_processing_ms": 0.09567315681463294, "mean_env_wait_ms": 2.6981653942768395, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003957509994506836, "StateBufferConnector_ms": 0.002744436264038086, "ViewRequirementAgentConnector_ms": 0.06840085983276367}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 285600, "num_agent_steps_trained": 285600, "num_env_steps_sampled": 285600, "num_env_steps_trained": 285600, "num_env_steps_sampled_this_iter": 360, "num_env_steps_trained_this_iter": 360, "num_env_steps_sampled_throughput_per_sec": 35.52233543979994, "num_env_steps_trained_throughput_per_sec": 35.52233543979994, "timesteps_total": 285600, "num_steps_trained_this_iter": 360, "agent_timesteps_total": 285600, "timers": {"training_iteration_time_ms": 3068.299, "sample_time_ms": 3064.025, "load_time_ms": 0.247, "load_throughput": 485030.818, "learn_time_ms": 3.185, "learn_throughput": 37672.825, "synch_weights_time_ms": 0.791}, "counters": {"num_env_steps_sampled": 285600, "num_env_steps_trained": 285600, "num_agent_steps_sampled": 285600, "num_agent_steps_trained": 285600}, "done": false, "episodes_total": 2380, "training_iteration": 596, "trial_id": "29a31_00000", "date": "2023-07-26_02-49-25", "timestamp": 1690328965, "time_this_iter_s": 10.138166189193726, "time_total_s": 7210.191191911697, "pid": 90822, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 1, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[253680, 5e-06], [256080, 5e-06], [258480, 2.5e-06], [260880, 2.5e-06], [263280, 2.5e-06], [265680, 2.5e-06], [268080, 1e-06], [270480, 1e-06], [272880, 1e-06], [275280, 5e-07], [277680, 5e-07], [280080, 5e-07], [282480, 5e-07], [284880, 5e-07], [287280, 1e-07], [289680, 1e-07], [292080, 1e-07]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 120, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x16ca65700>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1588.8657159805298, "iterations_since_restore": 136, "perf": {"cpu_util_percent": 53.266666666666666, "ram_util_percent": 78.76666666666667}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 3.2e-07, "entropy_coeff": 0.05, "policy_entropy": 265.7195739746094, "policy_loss": -66279.75, "vf_loss": 2001657.25}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 546.0, "diff_num_grad_updates_vs_sampler_policy": 545.0}}, "num_env_steps_sampled": 286080, "num_env_steps_trained": 286080, "num_agent_steps_sampled": 286080, "num_agent_steps_trained": 286080}, "sampler_results": {"episode_reward_max": -231.74763244156043, "episode_reward_min": -1061.8762252237666, "episode_reward_mean": -717.2755297272843, "episode_len_mean": 120.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-949.5427001393628, -667.1258244678824, -700.8509962992503, -648.5050724387345, -545.0522486426842, -925.2814935636152, -801.4027627857698, -912.1556027608797, -813.9281640725316, -584.2112016587049, -787.9273601768657, -563.0925867475765, -800.7016680152313, -913.9847801122165, -847.9866764941737, -643.2681590791219, -818.2079029548335, -453.51368003433026, -396.61829840819047, -665.3456250856366, -506.83350490356173, -972.8543213673162, -573.5920277339925, -915.9296934869996, -736.3891108908471, -695.1621794893973, -859.3927844262998, -831.5223105078321, -522.1242556666122, -438.1174254569087, -670.530464445105, -1020.0141325025317, -231.74763244156043, -814.5989806353488, -572.5373769046483, -963.4093169303922, -378.7121108817956, -660.6809945759999, -964.4500678079972, -569.6248747523435, -655.2086356655067, -948.6080202306124, -969.4364238085022, -725.7014478863263, -541.3222933855977, -1008.6424508690859, -742.7160311111671, -779.4896749801029, -460.20891158542935, -645.4409639656476, -706.5483776911964, -565.9220434169837, -525.1114090311074, -780.5136943219226, -840.7269000866697, -673.5101670170865, -485.803438931345, -551.3636866450577, -908.9449212146648, -574.0773882990579, -462.41540130345356, -557.150220673903, -660.5988816692344, -627.3411577451357, -879.3806043926231, -562.4316851037782, -1061.8762252237666, -843.654621820575, -1048.4288646018947, -987.5935105478637, -622.2701431641075, -1008.7533844008826, -461.9230239621608, -699.5586721894739, -974.3962426513264, -613.6975434392224, -666.3097403539799, -722.8978520890435, -658.7188670623723, -484.81889639785794, -920.5124606153803, -884.8070548872474, -389.8007620963685, -820.973597930829, -801.9636503374331, -531.6714034058501, -895.0071001447924, -618.5695908984351, -786.6570764599375, -559.742439549061, -538.2297947752028, -694.6017662002592, -880.2445500912851, -732.3779458880055, -755.6675855089625, -908.8174840078908, -784.5750154257915, -898.5697845369799, -758.4893518189789, -535.8357694689186], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 21.13758665603596, "mean_inference_ms": 0.400571306650273, "mean_action_processing_ms": 0.09567593415641394, "mean_env_wait_ms": 2.6977653361778273, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003943204879760742, "StateBufferConnector_ms": 0.002737760543823242, "ViewRequirementAgentConnector_ms": 0.06821513175964355}}, "episode_reward_max": -231.74763244156043, "episode_reward_min": -1061.8762252237666, "episode_reward_mean": -717.2755297272843, "episode_len_mean": 120.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-949.5427001393628, -667.1258244678824, -700.8509962992503, -648.5050724387345, -545.0522486426842, -925.2814935636152, -801.4027627857698, -912.1556027608797, -813.9281640725316, -584.2112016587049, -787.9273601768657, -563.0925867475765, -800.7016680152313, -913.9847801122165, -847.9866764941737, -643.2681590791219, -818.2079029548335, -453.51368003433026, -396.61829840819047, -665.3456250856366, -506.83350490356173, -972.8543213673162, -573.5920277339925, -915.9296934869996, -736.3891108908471, -695.1621794893973, -859.3927844262998, -831.5223105078321, -522.1242556666122, -438.1174254569087, -670.530464445105, -1020.0141325025317, -231.74763244156043, -814.5989806353488, -572.5373769046483, -963.4093169303922, -378.7121108817956, -660.6809945759999, -964.4500678079972, -569.6248747523435, -655.2086356655067, -948.6080202306124, -969.4364238085022, -725.7014478863263, -541.3222933855977, -1008.6424508690859, -742.7160311111671, -779.4896749801029, -460.20891158542935, -645.4409639656476, -706.5483776911964, -565.9220434169837, -525.1114090311074, -780.5136943219226, -840.7269000866697, -673.5101670170865, -485.803438931345, -551.3636866450577, -908.9449212146648, -574.0773882990579, -462.41540130345356, -557.150220673903, -660.5988816692344, -627.3411577451357, -879.3806043926231, -562.4316851037782, -1061.8762252237666, -843.654621820575, -1048.4288646018947, -987.5935105478637, -622.2701431641075, -1008.7533844008826, -461.9230239621608, -699.5586721894739, -974.3962426513264, -613.6975434392224, -666.3097403539799, -722.8978520890435, -658.7188670623723, -484.81889639785794, -920.5124606153803, -884.8070548872474, -389.8007620963685, -820.973597930829, -801.9636503374331, -531.6714034058501, -895.0071001447924, -618.5695908984351, -786.6570764599375, -559.742439549061, -538.2297947752028, -694.6017662002592, -880.2445500912851, -732.3779458880055, -755.6675855089625, -908.8174840078908, -784.5750154257915, -898.5697845369799, -758.4893518189789, -535.8357694689186], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 21.13758665603596, "mean_inference_ms": 0.400571306650273, "mean_action_processing_ms": 0.09567593415641394, "mean_env_wait_ms": 2.6977653361778273, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003943204879760742, "StateBufferConnector_ms": 0.002737760543823242, "ViewRequirementAgentConnector_ms": 0.06821513175964355}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 286080, "num_agent_steps_trained": 286080, "num_env_steps_sampled": 286080, "num_env_steps_trained": 286080, "num_env_steps_sampled_this_iter": 480, "num_env_steps_trained_this_iter": 480, "num_env_steps_sampled_throughput_per_sec": 36.815335627029924, "num_env_steps_trained_throughput_per_sec": 36.815335627029924, "timesteps_total": 286080, "num_steps_trained_this_iter": 480, "agent_timesteps_total": 286080, "timers": {"training_iteration_time_ms": 3192.009, "sample_time_ms": 3187.198, "load_time_ms": 0.291, "load_throughput": 411879.28, "learn_time_ms": 3.53, "learn_throughput": 33990.875, "synch_weights_time_ms": 0.913}, "counters": {"num_env_steps_sampled": 286080, "num_env_steps_trained": 286080, "num_agent_steps_sampled": 286080, "num_agent_steps_trained": 286080}, "done": false, "episodes_total": 2384, "training_iteration": 597, "trial_id": "29a31_00000", "date": "2023-07-26_02-49-38", "timestamp": 1690328978, "time_this_iter_s": 13.04159426689148, "time_total_s": 7223.232786178589, "pid": 90822, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 1, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[253680, 5e-06], [256080, 5e-06], [258480, 2.5e-06], [260880, 2.5e-06], [263280, 2.5e-06], [265680, 2.5e-06], [268080, 1e-06], [270480, 1e-06], [272880, 1e-06], [275280, 5e-07], [277680, 5e-07], [280080, 5e-07], [282480, 5e-07], [284880, 5e-07], [287280, 1e-07], [289680, 1e-07], [292080, 1e-07]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 120, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x16ca65700>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1601.9073102474213, "iterations_since_restore": 137, "perf": {"cpu_util_percent": 55.177777777777784, "ram_util_percent": 79.53888888888889}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 2.4e-07, "entropy_coeff": 0.05, "policy_entropy": 265.76519775390625, "policy_loss": -96699.90625, "vf_loss": 4440965.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 550.0, "diff_num_grad_updates_vs_sampler_policy": 549.0}}, "num_env_steps_sampled": 286560, "num_env_steps_trained": 286560, "num_agent_steps_sampled": 286560, "num_agent_steps_trained": 286560}, "sampler_results": {"episode_reward_max": -231.74763244156043, "episode_reward_min": -1061.8762252237666, "episode_reward_mean": -716.376198576376, "episode_len_mean": 120.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-545.0522486426842, -925.2814935636152, -801.4027627857698, -912.1556027608797, -813.9281640725316, -584.2112016587049, -787.9273601768657, -563.0925867475765, -800.7016680152313, -913.9847801122165, -847.9866764941737, -643.2681590791219, -818.2079029548335, -453.51368003433026, -396.61829840819047, -665.3456250856366, -506.83350490356173, -972.8543213673162, -573.5920277339925, -915.9296934869996, -736.3891108908471, -695.1621794893973, -859.3927844262998, -831.5223105078321, -522.1242556666122, -438.1174254569087, -670.530464445105, -1020.0141325025317, -231.74763244156043, -814.5989806353488, -572.5373769046483, -963.4093169303922, -378.7121108817956, -660.6809945759999, -964.4500678079972, -569.6248747523435, -655.2086356655067, -948.6080202306124, -969.4364238085022, -725.7014478863263, -541.3222933855977, -1008.6424508690859, -742.7160311111671, -779.4896749801029, -460.20891158542935, -645.4409639656476, -706.5483776911964, -565.9220434169837, -525.1114090311074, -780.5136943219226, -840.7269000866697, -673.5101670170865, -485.803438931345, -551.3636866450577, -908.9449212146648, -574.0773882990579, -462.41540130345356, -557.150220673903, -660.5988816692344, -627.3411577451357, -879.3806043926231, -562.4316851037782, -1061.8762252237666, -843.654621820575, -1048.4288646018947, -987.5935105478637, -622.2701431641075, -1008.7533844008826, -461.9230239621608, -699.5586721894739, -974.3962426513264, -613.6975434392224, -666.3097403539799, -722.8978520890435, -658.7188670623723, -484.81889639785794, -920.5124606153803, -884.8070548872474, -389.8007620963685, -820.973597930829, -801.9636503374331, -531.6714034058501, -895.0071001447924, -618.5695908984351, -786.6570764599375, -559.742439549061, -538.2297947752028, -694.6017662002592, -880.2445500912851, -732.3779458880055, -755.6675855089625, -908.8174840078908, -784.5750154257915, -898.5697845369799, -758.4893518189789, -535.8357694689186, -738.0307533327327, -719.3608944549892, -733.4183175261072, -685.2815129405838], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 21.13928466942556, "mean_inference_ms": 0.4005973325599501, "mean_action_processing_ms": 0.09567909799080873, "mean_env_wait_ms": 2.6973660037469704, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003945112228393555, "StateBufferConnector_ms": 0.002744913101196289, "ViewRequirementAgentConnector_ms": 0.06829023361206055}}, "episode_reward_max": -231.74763244156043, "episode_reward_min": -1061.8762252237666, "episode_reward_mean": -716.376198576376, "episode_len_mean": 120.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-545.0522486426842, -925.2814935636152, -801.4027627857698, -912.1556027608797, -813.9281640725316, -584.2112016587049, -787.9273601768657, -563.0925867475765, -800.7016680152313, -913.9847801122165, -847.9866764941737, -643.2681590791219, -818.2079029548335, -453.51368003433026, -396.61829840819047, -665.3456250856366, -506.83350490356173, -972.8543213673162, -573.5920277339925, -915.9296934869996, -736.3891108908471, -695.1621794893973, -859.3927844262998, -831.5223105078321, -522.1242556666122, -438.1174254569087, -670.530464445105, -1020.0141325025317, -231.74763244156043, -814.5989806353488, -572.5373769046483, -963.4093169303922, -378.7121108817956, -660.6809945759999, -964.4500678079972, -569.6248747523435, -655.2086356655067, -948.6080202306124, -969.4364238085022, -725.7014478863263, -541.3222933855977, -1008.6424508690859, -742.7160311111671, -779.4896749801029, -460.20891158542935, -645.4409639656476, -706.5483776911964, -565.9220434169837, -525.1114090311074, -780.5136943219226, -840.7269000866697, -673.5101670170865, -485.803438931345, -551.3636866450577, -908.9449212146648, -574.0773882990579, -462.41540130345356, -557.150220673903, -660.5988816692344, -627.3411577451357, -879.3806043926231, -562.4316851037782, -1061.8762252237666, -843.654621820575, -1048.4288646018947, -987.5935105478637, -622.2701431641075, -1008.7533844008826, -461.9230239621608, -699.5586721894739, -974.3962426513264, -613.6975434392224, -666.3097403539799, -722.8978520890435, -658.7188670623723, -484.81889639785794, -920.5124606153803, -884.8070548872474, -389.8007620963685, -820.973597930829, -801.9636503374331, -531.6714034058501, -895.0071001447924, -618.5695908984351, -786.6570764599375, -559.742439549061, -538.2297947752028, -694.6017662002592, -880.2445500912851, -732.3779458880055, -755.6675855089625, -908.8174840078908, -784.5750154257915, -898.5697845369799, -758.4893518189789, -535.8357694689186, -738.0307533327327, -719.3608944549892, -733.4183175261072, -685.2815129405838], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 21.13928466942556, "mean_inference_ms": 0.4005973325599501, "mean_action_processing_ms": 0.09567909799080873, "mean_env_wait_ms": 2.6973660037469704, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003945112228393555, "StateBufferConnector_ms": 0.002744913101196289, "ViewRequirementAgentConnector_ms": 0.06829023361206055}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 286560, "num_agent_steps_trained": 286560, "num_env_steps_sampled": 286560, "num_env_steps_trained": 286560, "num_env_steps_sampled_this_iter": 480, "num_env_steps_trained_this_iter": 480, "num_env_steps_sampled_throughput_per_sec": 40.45496317637823, "num_env_steps_trained_throughput_per_sec": 40.45496317637823, "timesteps_total": 286560, "num_steps_trained_this_iter": 480, "agent_timesteps_total": 286560, "timers": {"training_iteration_time_ms": 3212.401, "sample_time_ms": 3207.608, "load_time_ms": 0.29, "load_throughput": 414491.048, "learn_time_ms": 3.527, "learn_throughput": 34026.263, "synch_weights_time_ms": 0.901}, "counters": {"num_env_steps_sampled": 286560, "num_env_steps_trained": 286560, "num_agent_steps_sampled": 286560, "num_agent_steps_trained": 286560}, "done": false, "episodes_total": 2388, "training_iteration": 598, "trial_id": "29a31_00000", "date": "2023-07-26_02-49-50", "timestamp": 1690328990, "time_this_iter_s": 11.867789030075073, "time_total_s": 7235.100575208664, "pid": 90822, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 1, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[253680, 5e-06], [256080, 5e-06], [258480, 2.5e-06], [260880, 2.5e-06], [263280, 2.5e-06], [265680, 2.5e-06], [268080, 1e-06], [270480, 1e-06], [272880, 1e-06], [275280, 5e-07], [277680, 5e-07], [280080, 5e-07], [282480, 5e-07], [284880, 5e-07], [287280, 1e-07], [289680, 1e-07], [292080, 1e-07]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 120, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x16ca65700>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1613.7750992774963, "iterations_since_restore": 138, "perf": {"cpu_util_percent": 41.58823529411765, "ram_util_percent": 81.21764705882352}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1.6e-07, "entropy_coeff": 0.05, "policy_entropy": 265.75537109375, "policy_loss": -80057.578125, "vf_loss": 3057156.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 554.0, "diff_num_grad_updates_vs_sampler_policy": 553.0}}, "num_env_steps_sampled": 287040, "num_env_steps_trained": 287040, "num_agent_steps_sampled": 287040, "num_agent_steps_trained": 287040}, "sampler_results": {"episode_reward_max": -231.74763244156043, "episode_reward_min": -1061.8762252237666, "episode_reward_mean": -713.5030591231688, "episode_len_mean": 120.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-813.9281640725316, -584.2112016587049, -787.9273601768657, -563.0925867475765, -800.7016680152313, -913.9847801122165, -847.9866764941737, -643.2681590791219, -818.2079029548335, -453.51368003433026, -396.61829840819047, -665.3456250856366, -506.83350490356173, -972.8543213673162, -573.5920277339925, -915.9296934869996, -736.3891108908471, -695.1621794893973, -859.3927844262998, -831.5223105078321, -522.1242556666122, -438.1174254569087, -670.530464445105, -1020.0141325025317, -231.74763244156043, -814.5989806353488, -572.5373769046483, -963.4093169303922, -378.7121108817956, -660.6809945759999, -964.4500678079972, -569.6248747523435, -655.2086356655067, -948.6080202306124, -969.4364238085022, -725.7014478863263, -541.3222933855977, -1008.6424508690859, -742.7160311111671, -779.4896749801029, -460.20891158542935, -645.4409639656476, -706.5483776911964, -565.9220434169837, -525.1114090311074, -780.5136943219226, -840.7269000866697, -673.5101670170865, -485.803438931345, -551.3636866450577, -908.9449212146648, -574.0773882990579, -462.41540130345356, -557.150220673903, -660.5988816692344, -627.3411577451357, -879.3806043926231, -562.4316851037782, -1061.8762252237666, -843.654621820575, -1048.4288646018947, -987.5935105478637, -622.2701431641075, -1008.7533844008826, -461.9230239621608, -699.5586721894739, -974.3962426513264, -613.6975434392224, -666.3097403539799, -722.8978520890435, -658.7188670623723, -484.81889639785794, -920.5124606153803, -884.8070548872474, -389.8007620963685, -820.973597930829, -801.9636503374331, -531.6714034058501, -895.0071001447924, -618.5695908984351, -786.6570764599375, -559.742439549061, -538.2297947752028, -694.6017662002592, -880.2445500912851, -732.3779458880055, -755.6675855089625, -908.8174840078908, -784.5750154257915, -898.5697845369799, -758.4893518189789, -535.8357694689186, -738.0307533327327, -719.3608944549892, -733.4183175261072, -685.2815129405838, -837.966023002167, -647.4860241209385, -768.7881292498366, -642.3379860592893], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 21.14109795238936, "mean_inference_ms": 0.40061834864028484, "mean_action_processing_ms": 0.09568134144655552, "mean_env_wait_ms": 2.6969642984076447, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00393986701965332, "StateBufferConnector_ms": 0.0027446746826171875, "ViewRequirementAgentConnector_ms": 0.06821703910827637}}, "episode_reward_max": -231.74763244156043, "episode_reward_min": -1061.8762252237666, "episode_reward_mean": -713.5030591231688, "episode_len_mean": 120.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-813.9281640725316, -584.2112016587049, -787.9273601768657, -563.0925867475765, -800.7016680152313, -913.9847801122165, -847.9866764941737, -643.2681590791219, -818.2079029548335, -453.51368003433026, -396.61829840819047, -665.3456250856366, -506.83350490356173, -972.8543213673162, -573.5920277339925, -915.9296934869996, -736.3891108908471, -695.1621794893973, -859.3927844262998, -831.5223105078321, -522.1242556666122, -438.1174254569087, -670.530464445105, -1020.0141325025317, -231.74763244156043, -814.5989806353488, -572.5373769046483, -963.4093169303922, -378.7121108817956, -660.6809945759999, -964.4500678079972, -569.6248747523435, -655.2086356655067, -948.6080202306124, -969.4364238085022, -725.7014478863263, -541.3222933855977, -1008.6424508690859, -742.7160311111671, -779.4896749801029, -460.20891158542935, -645.4409639656476, -706.5483776911964, -565.9220434169837, -525.1114090311074, -780.5136943219226, -840.7269000866697, -673.5101670170865, -485.803438931345, -551.3636866450577, -908.9449212146648, -574.0773882990579, -462.41540130345356, -557.150220673903, -660.5988816692344, -627.3411577451357, -879.3806043926231, -562.4316851037782, -1061.8762252237666, -843.654621820575, -1048.4288646018947, -987.5935105478637, -622.2701431641075, -1008.7533844008826, -461.9230239621608, -699.5586721894739, -974.3962426513264, -613.6975434392224, -666.3097403539799, -722.8978520890435, -658.7188670623723, -484.81889639785794, -920.5124606153803, -884.8070548872474, -389.8007620963685, -820.973597930829, -801.9636503374331, -531.6714034058501, -895.0071001447924, -618.5695908984351, -786.6570764599375, -559.742439549061, -538.2297947752028, -694.6017662002592, -880.2445500912851, -732.3779458880055, -755.6675855089625, -908.8174840078908, -784.5750154257915, -898.5697845369799, -758.4893518189789, -535.8357694689186, -738.0307533327327, -719.3608944549892, -733.4183175261072, -685.2815129405838, -837.966023002167, -647.4860241209385, -768.7881292498366, -642.3379860592893], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 21.14109795238936, "mean_inference_ms": 0.40061834864028484, "mean_action_processing_ms": 0.09568134144655552, "mean_env_wait_ms": 2.6969642984076447, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00393986701965332, "StateBufferConnector_ms": 0.0027446746826171875, "ViewRequirementAgentConnector_ms": 0.06821703910827637}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 287040, "num_agent_steps_trained": 287040, "num_env_steps_sampled": 287040, "num_env_steps_trained": 287040, "num_env_steps_sampled_this_iter": 480, "num_env_steps_trained_this_iter": 480, "num_env_steps_sampled_throughput_per_sec": 41.258493685159024, "num_env_steps_trained_throughput_per_sec": 41.258493685159024, "timesteps_total": 287040, "num_steps_trained_this_iter": 480, "agent_timesteps_total": 287040, "timers": {"training_iteration_time_ms": 3071.032, "sample_time_ms": 3066.542, "load_time_ms": 0.267, "load_throughput": 448628.648, "learn_time_ms": 3.286, "learn_throughput": 36522.228, "synch_weights_time_ms": 0.869}, "counters": {"num_env_steps_sampled": 287040, "num_env_steps_trained": 287040, "num_agent_steps_sampled": 287040, "num_agent_steps_trained": 287040}, "done": false, "episodes_total": 2392, "training_iteration": 599, "trial_id": "29a31_00000", "date": "2023-07-26_02-50-02", "timestamp": 1690329002, "time_this_iter_s": 11.637438297271729, "time_total_s": 7246.738013505936, "pid": 90822, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 1, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[253680, 5e-06], [256080, 5e-06], [258480, 2.5e-06], [260880, 2.5e-06], [263280, 2.5e-06], [265680, 2.5e-06], [268080, 1e-06], [270480, 1e-06], [272880, 1e-06], [275280, 5e-07], [277680, 5e-07], [280080, 5e-07], [282480, 5e-07], [284880, 5e-07], [287280, 1e-07], [289680, 1e-07], [292080, 1e-07]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 120, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x16ca65700>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1625.412537574768, "iterations_since_restore": 139, "perf": {"cpu_util_percent": 34.27058823529412, "ram_util_percent": 78.65294117647058}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-07, "entropy_coeff": 0.05, "policy_entropy": 265.770751953125, "policy_loss": -101982.9765625, "vf_loss": 4577703.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 558.0, "diff_num_grad_updates_vs_sampler_policy": 557.0}}, "num_env_steps_sampled": 287520, "num_env_steps_trained": 287520, "num_agent_steps_sampled": 287520, "num_agent_steps_trained": 287520}, "sampler_results": {"episode_reward_max": -231.74763244156043, "episode_reward_min": -1061.8762252237666, "episode_reward_mean": -716.2284847700008, "episode_len_mean": 120.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-800.7016680152313, -913.9847801122165, -847.9866764941737, -643.2681590791219, -818.2079029548335, -453.51368003433026, -396.61829840819047, -665.3456250856366, -506.83350490356173, -972.8543213673162, -573.5920277339925, -915.9296934869996, -736.3891108908471, -695.1621794893973, -859.3927844262998, -831.5223105078321, -522.1242556666122, -438.1174254569087, -670.530464445105, -1020.0141325025317, -231.74763244156043, -814.5989806353488, -572.5373769046483, -963.4093169303922, -378.7121108817956, -660.6809945759999, -964.4500678079972, -569.6248747523435, -655.2086356655067, -948.6080202306124, -969.4364238085022, -725.7014478863263, -541.3222933855977, -1008.6424508690859, -742.7160311111671, -779.4896749801029, -460.20891158542935, -645.4409639656476, -706.5483776911964, -565.9220434169837, -525.1114090311074, -780.5136943219226, -840.7269000866697, -673.5101670170865, -485.803438931345, -551.3636866450577, -908.9449212146648, -574.0773882990579, -462.41540130345356, -557.150220673903, -660.5988816692344, -627.3411577451357, -879.3806043926231, -562.4316851037782, -1061.8762252237666, -843.654621820575, -1048.4288646018947, -987.5935105478637, -622.2701431641075, -1008.7533844008826, -461.9230239621608, -699.5586721894739, -974.3962426513264, -613.6975434392224, -666.3097403539799, -722.8978520890435, -658.7188670623723, -484.81889639785794, -920.5124606153803, -884.8070548872474, -389.8007620963685, -820.973597930829, -801.9636503374331, -531.6714034058501, -895.0071001447924, -618.5695908984351, -786.6570764599375, -559.742439549061, -538.2297947752028, -694.6017662002592, -880.2445500912851, -732.3779458880055, -755.6675855089625, -908.8174840078908, -784.5750154257915, -898.5697845369799, -758.4893518189789, -535.8357694689186, -738.0307533327327, -719.3608944549892, -733.4183175261072, -685.2815129405838, -837.966023002167, -647.4860241209385, -768.7881292498366, -642.3379860592893, -649.7577702313796, -906.7586055803146, -556.8739593093886, -908.3115422177763], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 21.142855235966866, "mean_inference_ms": 0.40064357933264916, "mean_action_processing_ms": 0.09568425271558706, "mean_env_wait_ms": 2.6965367060271124, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0039441585540771484, "StateBufferConnector_ms": 0.002750873565673828, "ViewRequirementAgentConnector_ms": 0.06830620765686035}}, "episode_reward_max": -231.74763244156043, "episode_reward_min": -1061.8762252237666, "episode_reward_mean": -716.2284847700008, "episode_len_mean": 120.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-800.7016680152313, -913.9847801122165, -847.9866764941737, -643.2681590791219, -818.2079029548335, -453.51368003433026, -396.61829840819047, -665.3456250856366, -506.83350490356173, -972.8543213673162, -573.5920277339925, -915.9296934869996, -736.3891108908471, -695.1621794893973, -859.3927844262998, -831.5223105078321, -522.1242556666122, -438.1174254569087, -670.530464445105, -1020.0141325025317, -231.74763244156043, -814.5989806353488, -572.5373769046483, -963.4093169303922, -378.7121108817956, -660.6809945759999, -964.4500678079972, -569.6248747523435, -655.2086356655067, -948.6080202306124, -969.4364238085022, -725.7014478863263, -541.3222933855977, -1008.6424508690859, -742.7160311111671, -779.4896749801029, -460.20891158542935, -645.4409639656476, -706.5483776911964, -565.9220434169837, -525.1114090311074, -780.5136943219226, -840.7269000866697, -673.5101670170865, -485.803438931345, -551.3636866450577, -908.9449212146648, -574.0773882990579, -462.41540130345356, -557.150220673903, -660.5988816692344, -627.3411577451357, -879.3806043926231, -562.4316851037782, -1061.8762252237666, -843.654621820575, -1048.4288646018947, -987.5935105478637, -622.2701431641075, -1008.7533844008826, -461.9230239621608, -699.5586721894739, -974.3962426513264, -613.6975434392224, -666.3097403539799, -722.8978520890435, -658.7188670623723, -484.81889639785794, -920.5124606153803, -884.8070548872474, -389.8007620963685, -820.973597930829, -801.9636503374331, -531.6714034058501, -895.0071001447924, -618.5695908984351, -786.6570764599375, -559.742439549061, -538.2297947752028, -694.6017662002592, -880.2445500912851, -732.3779458880055, -755.6675855089625, -908.8174840078908, -784.5750154257915, -898.5697845369799, -758.4893518189789, -535.8357694689186, -738.0307533327327, -719.3608944549892, -733.4183175261072, -685.2815129405838, -837.966023002167, -647.4860241209385, -768.7881292498366, -642.3379860592893, -649.7577702313796, -906.7586055803146, -556.8739593093886, -908.3115422177763], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 21.142855235966866, "mean_inference_ms": 0.40064357933264916, "mean_action_processing_ms": 0.09568425271558706, "mean_env_wait_ms": 2.6965367060271124, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0039441585540771484, "StateBufferConnector_ms": 0.002750873565673828, "ViewRequirementAgentConnector_ms": 0.06830620765686035}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 287520, "num_agent_steps_trained": 287520, "num_env_steps_sampled": 287520, "num_env_steps_trained": 287520, "num_env_steps_sampled_this_iter": 480, "num_env_steps_trained_this_iter": 480, "num_env_steps_sampled_throughput_per_sec": 40.28189278760639, "num_env_steps_trained_throughput_per_sec": 40.28189278760639, "timesteps_total": 287520, "num_steps_trained_this_iter": 480, "agent_timesteps_total": 287520, "timers": {"training_iteration_time_ms": 2935.455, "sample_time_ms": 2931.176, "load_time_ms": 0.24, "load_throughput": 499371.446, "learn_time_ms": 3.107, "learn_throughput": 38620.398, "synch_weights_time_ms": 0.88}, "counters": {"num_env_steps_sampled": 287520, "num_env_steps_trained": 287520, "num_agent_steps_sampled": 287520, "num_agent_steps_trained": 287520}, "done": false, "episodes_total": 2396, "training_iteration": 600, "trial_id": "29a31_00000", "date": "2023-07-26_02-50-14", "timestamp": 1690329014, "time_this_iter_s": 11.919863939285278, "time_total_s": 7258.657877445221, "pid": 90822, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 1, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[253680, 5e-06], [256080, 5e-06], [258480, 2.5e-06], [260880, 2.5e-06], [263280, 2.5e-06], [265680, 2.5e-06], [268080, 1e-06], [270480, 1e-06], [272880, 1e-06], [275280, 5e-07], [277680, 5e-07], [280080, 5e-07], [282480, 5e-07], [284880, 5e-07], [287280, 1e-07], [289680, 1e-07], [292080, 1e-07]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 120, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x16ca65700>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1637.3324015140533, "iterations_since_restore": 140, "perf": {"cpu_util_percent": 45.2764705882353, "ram_util_percent": 79.1470588235294}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-07, "entropy_coeff": 0.05, "policy_entropy": 265.74774169921875, "policy_loss": -90134.234375, "vf_loss": 4194580.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 562.0, "diff_num_grad_updates_vs_sampler_policy": 561.0}}, "num_env_steps_sampled": 288000, "num_env_steps_trained": 288000, "num_agent_steps_sampled": 288000, "num_agent_steps_trained": 288000}, "sampler_results": {"episode_reward_max": -231.74763244156043, "episode_reward_min": -1061.8762252237666, "episode_reward_mean": -711.7322666095922, "episode_len_mean": 120.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-818.2079029548335, -453.51368003433026, -396.61829840819047, -665.3456250856366, -506.83350490356173, -972.8543213673162, -573.5920277339925, -915.9296934869996, -736.3891108908471, -695.1621794893973, -859.3927844262998, -831.5223105078321, -522.1242556666122, -438.1174254569087, -670.530464445105, -1020.0141325025317, -231.74763244156043, -814.5989806353488, -572.5373769046483, -963.4093169303922, -378.7121108817956, -660.6809945759999, -964.4500678079972, -569.6248747523435, -655.2086356655067, -948.6080202306124, -969.4364238085022, -725.7014478863263, -541.3222933855977, -1008.6424508690859, -742.7160311111671, -779.4896749801029, -460.20891158542935, -645.4409639656476, -706.5483776911964, -565.9220434169837, -525.1114090311074, -780.5136943219226, -840.7269000866697, -673.5101670170865, -485.803438931345, -551.3636866450577, -908.9449212146648, -574.0773882990579, -462.41540130345356, -557.150220673903, -660.5988816692344, -627.3411577451357, -879.3806043926231, -562.4316851037782, -1061.8762252237666, -843.654621820575, -1048.4288646018947, -987.5935105478637, -622.2701431641075, -1008.7533844008826, -461.9230239621608, -699.5586721894739, -974.3962426513264, -613.6975434392224, -666.3097403539799, -722.8978520890435, -658.7188670623723, -484.81889639785794, -920.5124606153803, -884.8070548872474, -389.8007620963685, -820.973597930829, -801.9636503374331, -531.6714034058501, -895.0071001447924, -618.5695908984351, -786.6570764599375, -559.742439549061, -538.2297947752028, -694.6017662002592, -880.2445500912851, -732.3779458880055, -755.6675855089625, -908.8174840078908, -784.5750154257915, -898.5697845369799, -758.4893518189789, -535.8357694689186, -738.0307533327327, -719.3608944549892, -733.4183175261072, -685.2815129405838, -837.966023002167, -647.4860241209385, -768.7881292498366, -642.3379860592893, -649.7577702313796, -906.7586055803146, -556.8739593093886, -908.3115422177763, -384.607542787935, -791.039839589689, -818.4019704425682, -762.2701148396951], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 21.14439938062835, "mean_inference_ms": 0.40071756734103303, "mean_action_processing_ms": 0.09569117686322948, "mean_env_wait_ms": 2.6961337660354485, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003949165344238281, "StateBufferConnector_ms": 0.0027475357055664062, "ViewRequirementAgentConnector_ms": 0.06838870048522949}}, "episode_reward_max": -231.74763244156043, "episode_reward_min": -1061.8762252237666, "episode_reward_mean": -711.7322666095922, "episode_len_mean": 120.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-818.2079029548335, -453.51368003433026, -396.61829840819047, -665.3456250856366, -506.83350490356173, -972.8543213673162, -573.5920277339925, -915.9296934869996, -736.3891108908471, -695.1621794893973, -859.3927844262998, -831.5223105078321, -522.1242556666122, -438.1174254569087, -670.530464445105, -1020.0141325025317, -231.74763244156043, -814.5989806353488, -572.5373769046483, -963.4093169303922, -378.7121108817956, -660.6809945759999, -964.4500678079972, -569.6248747523435, -655.2086356655067, -948.6080202306124, -969.4364238085022, -725.7014478863263, -541.3222933855977, -1008.6424508690859, -742.7160311111671, -779.4896749801029, -460.20891158542935, -645.4409639656476, -706.5483776911964, -565.9220434169837, -525.1114090311074, -780.5136943219226, -840.7269000866697, -673.5101670170865, -485.803438931345, -551.3636866450577, -908.9449212146648, -574.0773882990579, -462.41540130345356, -557.150220673903, -660.5988816692344, -627.3411577451357, -879.3806043926231, -562.4316851037782, -1061.8762252237666, -843.654621820575, -1048.4288646018947, -987.5935105478637, -622.2701431641075, -1008.7533844008826, -461.9230239621608, -699.5586721894739, -974.3962426513264, -613.6975434392224, -666.3097403539799, -722.8978520890435, -658.7188670623723, -484.81889639785794, -920.5124606153803, -884.8070548872474, -389.8007620963685, -820.973597930829, -801.9636503374331, -531.6714034058501, -895.0071001447924, -618.5695908984351, -786.6570764599375, -559.742439549061, -538.2297947752028, -694.6017662002592, -880.2445500912851, -732.3779458880055, -755.6675855089625, -908.8174840078908, -784.5750154257915, -898.5697845369799, -758.4893518189789, -535.8357694689186, -738.0307533327327, -719.3608944549892, -733.4183175261072, -685.2815129405838, -837.966023002167, -647.4860241209385, -768.7881292498366, -642.3379860592893, -649.7577702313796, -906.7586055803146, -556.8739593093886, -908.3115422177763, -384.607542787935, -791.039839589689, -818.4019704425682, -762.2701148396951], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 21.14439938062835, "mean_inference_ms": 0.40071756734103303, "mean_action_processing_ms": 0.09569117686322948, "mean_env_wait_ms": 2.6961337660354485, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003949165344238281, "StateBufferConnector_ms": 0.0027475357055664062, "ViewRequirementAgentConnector_ms": 0.06838870048522949}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 288000, "num_agent_steps_trained": 288000, "num_env_steps_sampled": 288000, "num_env_steps_trained": 288000, "num_env_steps_sampled_this_iter": 480, "num_env_steps_trained_this_iter": 480, "num_env_steps_sampled_throughput_per_sec": 40.10101172264856, "num_env_steps_trained_throughput_per_sec": 40.10101172264856, "timesteps_total": 288000, "num_steps_trained_this_iter": 480, "agent_timesteps_total": 288000, "timers": {"training_iteration_time_ms": 2969.413, "sample_time_ms": 2964.715, "load_time_ms": 0.265, "load_throughput": 452622.734, "learn_time_ms": 3.472, "learn_throughput": 34559.657, "synch_weights_time_ms": 0.907}, "counters": {"num_env_steps_sampled": 288000, "num_env_steps_trained": 288000, "num_agent_steps_sampled": 288000, "num_agent_steps_trained": 288000}, "done": false, "episodes_total": 2400, "training_iteration": 601, "trial_id": "29a31_00000", "date": "2023-07-26_02-50-26", "timestamp": 1690329026, "time_this_iter_s": 11.972689867019653, "time_total_s": 7270.630567312241, "pid": 90822, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 1, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[253680, 5e-06], [256080, 5e-06], [258480, 2.5e-06], [260880, 2.5e-06], [263280, 2.5e-06], [265680, 2.5e-06], [268080, 1e-06], [270480, 1e-06], [272880, 1e-06], [275280, 5e-07], [277680, 5e-07], [280080, 5e-07], [282480, 5e-07], [284880, 5e-07], [287280, 1e-07], [289680, 1e-07], [292080, 1e-07]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 120, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x16ca65700>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1649.305091381073, "iterations_since_restore": 141, "perf": {"cpu_util_percent": 48.57058823529411, "ram_util_percent": 78.17647058823529}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-07, "entropy_coeff": 0.05, "policy_entropy": 265.7380065917969, "policy_loss": -115620.6640625, "vf_loss": 6054330.5}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 566.0, "diff_num_grad_updates_vs_sampler_policy": 565.0}}, "num_env_steps_sampled": 288480, "num_env_steps_trained": 288480, "num_agent_steps_sampled": 288480, "num_agent_steps_trained": 288480}, "sampler_results": {"episode_reward_max": -231.74763244156043, "episode_reward_min": -1061.8762252237666, "episode_reward_mean": -720.1615344796021, "episode_len_mean": 120.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-506.83350490356173, -972.8543213673162, -573.5920277339925, -915.9296934869996, -736.3891108908471, -695.1621794893973, -859.3927844262998, -831.5223105078321, -522.1242556666122, -438.1174254569087, -670.530464445105, -1020.0141325025317, -231.74763244156043, -814.5989806353488, -572.5373769046483, -963.4093169303922, -378.7121108817956, -660.6809945759999, -964.4500678079972, -569.6248747523435, -655.2086356655067, -948.6080202306124, -969.4364238085022, -725.7014478863263, -541.3222933855977, -1008.6424508690859, -742.7160311111671, -779.4896749801029, -460.20891158542935, -645.4409639656476, -706.5483776911964, -565.9220434169837, -525.1114090311074, -780.5136943219226, -840.7269000866697, -673.5101670170865, -485.803438931345, -551.3636866450577, -908.9449212146648, -574.0773882990579, -462.41540130345356, -557.150220673903, -660.5988816692344, -627.3411577451357, -879.3806043926231, -562.4316851037782, -1061.8762252237666, -843.654621820575, -1048.4288646018947, -987.5935105478637, -622.2701431641075, -1008.7533844008826, -461.9230239621608, -699.5586721894739, -974.3962426513264, -613.6975434392224, -666.3097403539799, -722.8978520890435, -658.7188670623723, -484.81889639785794, -920.5124606153803, -884.8070548872474, -389.8007620963685, -820.973597930829, -801.9636503374331, -531.6714034058501, -895.0071001447924, -618.5695908984351, -786.6570764599375, -559.742439549061, -538.2297947752028, -694.6017662002592, -880.2445500912851, -732.3779458880055, -755.6675855089625, -908.8174840078908, -784.5750154257915, -898.5697845369799, -758.4893518189789, -535.8357694689186, -738.0307533327327, -719.3608944549892, -733.4183175261072, -685.2815129405838, -837.966023002167, -647.4860241209385, -768.7881292498366, -642.3379860592893, -649.7577702313796, -906.7586055803146, -556.8739593093886, -908.3115422177763, -384.607542787935, -791.039839589689, -818.4019704425682, -762.2701148396951, -768.9944532744827, -919.2177373753337, -599.1370072667128, -889.2630955674581], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 21.14605425229511, "mean_inference_ms": 0.4008009068271729, "mean_action_processing_ms": 0.09569932436740552, "mean_env_wait_ms": 2.6957477817038495, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003968477249145508, "StateBufferConnector_ms": 0.0027573108673095703, "ViewRequirementAgentConnector_ms": 0.068572998046875}}, "episode_reward_max": -231.74763244156043, "episode_reward_min": -1061.8762252237666, "episode_reward_mean": -720.1615344796021, "episode_len_mean": 120.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-506.83350490356173, -972.8543213673162, -573.5920277339925, -915.9296934869996, -736.3891108908471, -695.1621794893973, -859.3927844262998, -831.5223105078321, -522.1242556666122, -438.1174254569087, -670.530464445105, -1020.0141325025317, -231.74763244156043, -814.5989806353488, -572.5373769046483, -963.4093169303922, -378.7121108817956, -660.6809945759999, -964.4500678079972, -569.6248747523435, -655.2086356655067, -948.6080202306124, -969.4364238085022, -725.7014478863263, -541.3222933855977, -1008.6424508690859, -742.7160311111671, -779.4896749801029, -460.20891158542935, -645.4409639656476, -706.5483776911964, -565.9220434169837, -525.1114090311074, -780.5136943219226, -840.7269000866697, -673.5101670170865, -485.803438931345, -551.3636866450577, -908.9449212146648, -574.0773882990579, -462.41540130345356, -557.150220673903, -660.5988816692344, -627.3411577451357, -879.3806043926231, -562.4316851037782, -1061.8762252237666, -843.654621820575, -1048.4288646018947, -987.5935105478637, -622.2701431641075, -1008.7533844008826, -461.9230239621608, -699.5586721894739, -974.3962426513264, -613.6975434392224, -666.3097403539799, -722.8978520890435, -658.7188670623723, -484.81889639785794, -920.5124606153803, -884.8070548872474, -389.8007620963685, -820.973597930829, -801.9636503374331, -531.6714034058501, -895.0071001447924, -618.5695908984351, -786.6570764599375, -559.742439549061, -538.2297947752028, -694.6017662002592, -880.2445500912851, -732.3779458880055, -755.6675855089625, -908.8174840078908, -784.5750154257915, -898.5697845369799, -758.4893518189789, -535.8357694689186, -738.0307533327327, -719.3608944549892, -733.4183175261072, -685.2815129405838, -837.966023002167, -647.4860241209385, -768.7881292498366, -642.3379860592893, -649.7577702313796, -906.7586055803146, -556.8739593093886, -908.3115422177763, -384.607542787935, -791.039839589689, -818.4019704425682, -762.2701148396951, -768.9944532744827, -919.2177373753337, -599.1370072667128, -889.2630955674581], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 21.14605425229511, "mean_inference_ms": 0.4008009068271729, "mean_action_processing_ms": 0.09569932436740552, "mean_env_wait_ms": 2.6957477817038495, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003968477249145508, "StateBufferConnector_ms": 0.0027573108673095703, "ViewRequirementAgentConnector_ms": 0.068572998046875}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 288480, "num_agent_steps_trained": 288480, "num_env_steps_sampled": 288480, "num_env_steps_trained": 288480, "num_env_steps_sampled_this_iter": 480, "num_env_steps_trained_this_iter": 480, "num_env_steps_sampled_throughput_per_sec": 40.44576962794124, "num_env_steps_trained_throughput_per_sec": 40.44576962794124, "timesteps_total": 288480, "num_steps_trained_this_iter": 480, "agent_timesteps_total": 288480, "timers": {"training_iteration_time_ms": 2965.479, "sample_time_ms": 2960.988, "load_time_ms": 0.254, "load_throughput": 471932.94, "learn_time_ms": 3.345, "learn_throughput": 35870.213, "synch_weights_time_ms": 0.845}, "counters": {"num_env_steps_sampled": 288480, "num_env_steps_trained": 288480, "num_agent_steps_sampled": 288480, "num_agent_steps_trained": 288480}, "done": false, "episodes_total": 2404, "training_iteration": 602, "trial_id": "29a31_00000", "date": "2023-07-26_02-50-38", "timestamp": 1690329038, "time_this_iter_s": 11.870550155639648, "time_total_s": 7282.50111746788, "pid": 90822, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 1, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[253680, 5e-06], [256080, 5e-06], [258480, 2.5e-06], [260880, 2.5e-06], [263280, 2.5e-06], [265680, 2.5e-06], [268080, 1e-06], [270480, 1e-06], [272880, 1e-06], [275280, 5e-07], [277680, 5e-07], [280080, 5e-07], [282480, 5e-07], [284880, 5e-07], [287280, 1e-07], [289680, 1e-07], [292080, 1e-07]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 120, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x16ca65700>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1661.1756415367126, "iterations_since_restore": 142, "perf": {"cpu_util_percent": 42.747058823529414, "ram_util_percent": 77.80588235294118}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-07, "entropy_coeff": 0.05, "policy_entropy": 265.7263488769531, "policy_loss": -98631.140625, "vf_loss": 4753823.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 570.0, "diff_num_grad_updates_vs_sampler_policy": 569.0}}, "num_env_steps_sampled": 288960, "num_env_steps_trained": 288960, "num_agent_steps_sampled": 288960, "num_agent_steps_trained": 288960}, "sampler_results": {"episode_reward_max": -231.74763244156043, "episode_reward_min": -1061.8762252237666, "episode_reward_mean": -722.6693851299476, "episode_len_mean": 120.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-736.3891108908471, -695.1621794893973, -859.3927844262998, -831.5223105078321, -522.1242556666122, -438.1174254569087, -670.530464445105, -1020.0141325025317, -231.74763244156043, -814.5989806353488, -572.5373769046483, -963.4093169303922, -378.7121108817956, -660.6809945759999, -964.4500678079972, -569.6248747523435, -655.2086356655067, -948.6080202306124, -969.4364238085022, -725.7014478863263, -541.3222933855977, -1008.6424508690859, -742.7160311111671, -779.4896749801029, -460.20891158542935, -645.4409639656476, -706.5483776911964, -565.9220434169837, -525.1114090311074, -780.5136943219226, -840.7269000866697, -673.5101670170865, -485.803438931345, -551.3636866450577, -908.9449212146648, -574.0773882990579, -462.41540130345356, -557.150220673903, -660.5988816692344, -627.3411577451357, -879.3806043926231, -562.4316851037782, -1061.8762252237666, -843.654621820575, -1048.4288646018947, -987.5935105478637, -622.2701431641075, -1008.7533844008826, -461.9230239621608, -699.5586721894739, -974.3962426513264, -613.6975434392224, -666.3097403539799, -722.8978520890435, -658.7188670623723, -484.81889639785794, -920.5124606153803, -884.8070548872474, -389.8007620963685, -820.973597930829, -801.9636503374331, -531.6714034058501, -895.0071001447924, -618.5695908984351, -786.6570764599375, -559.742439549061, -538.2297947752028, -694.6017662002592, -880.2445500912851, -732.3779458880055, -755.6675855089625, -908.8174840078908, -784.5750154257915, -898.5697845369799, -758.4893518189789, -535.8357694689186, -738.0307533327327, -719.3608944549892, -733.4183175261072, -685.2815129405838, -837.966023002167, -647.4860241209385, -768.7881292498366, -642.3379860592893, -649.7577702313796, -906.7586055803146, -556.8739593093886, -908.3115422177763, -384.607542787935, -791.039839589689, -818.4019704425682, -762.2701148396951, -768.9944532744827, -919.2177373753337, -599.1370072667128, -889.2630955674581, -795.8970049667029, -836.8383973970862, -832.1314842544978, -755.1277259081394], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 21.147845345881496, "mean_inference_ms": 0.4008879284496427, "mean_action_processing_ms": 0.095708144933285, "mean_env_wait_ms": 2.695369426440866, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0039637088775634766, "StateBufferConnector_ms": 0.0027599334716796875, "ViewRequirementAgentConnector_ms": 0.06862831115722656}}, "episode_reward_max": -231.74763244156043, "episode_reward_min": -1061.8762252237666, "episode_reward_mean": -722.6693851299476, "episode_len_mean": 120.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-736.3891108908471, -695.1621794893973, -859.3927844262998, -831.5223105078321, -522.1242556666122, -438.1174254569087, -670.530464445105, -1020.0141325025317, -231.74763244156043, -814.5989806353488, -572.5373769046483, -963.4093169303922, -378.7121108817956, -660.6809945759999, -964.4500678079972, -569.6248747523435, -655.2086356655067, -948.6080202306124, -969.4364238085022, -725.7014478863263, -541.3222933855977, -1008.6424508690859, -742.7160311111671, -779.4896749801029, -460.20891158542935, -645.4409639656476, -706.5483776911964, -565.9220434169837, -525.1114090311074, -780.5136943219226, -840.7269000866697, -673.5101670170865, -485.803438931345, -551.3636866450577, -908.9449212146648, -574.0773882990579, -462.41540130345356, -557.150220673903, -660.5988816692344, -627.3411577451357, -879.3806043926231, -562.4316851037782, -1061.8762252237666, -843.654621820575, -1048.4288646018947, -987.5935105478637, -622.2701431641075, -1008.7533844008826, -461.9230239621608, -699.5586721894739, -974.3962426513264, -613.6975434392224, -666.3097403539799, -722.8978520890435, -658.7188670623723, -484.81889639785794, -920.5124606153803, -884.8070548872474, -389.8007620963685, -820.973597930829, -801.9636503374331, -531.6714034058501, -895.0071001447924, -618.5695908984351, -786.6570764599375, -559.742439549061, -538.2297947752028, -694.6017662002592, -880.2445500912851, -732.3779458880055, -755.6675855089625, -908.8174840078908, -784.5750154257915, -898.5697845369799, -758.4893518189789, -535.8357694689186, -738.0307533327327, -719.3608944549892, -733.4183175261072, -685.2815129405838, -837.966023002167, -647.4860241209385, -768.7881292498366, -642.3379860592893, -649.7577702313796, -906.7586055803146, -556.8739593093886, -908.3115422177763, -384.607542787935, -791.039839589689, -818.4019704425682, -762.2701148396951, -768.9944532744827, -919.2177373753337, -599.1370072667128, -889.2630955674581, -795.8970049667029, -836.8383973970862, -832.1314842544978, -755.1277259081394], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 21.147845345881496, "mean_inference_ms": 0.4008879284496427, "mean_action_processing_ms": 0.095708144933285, "mean_env_wait_ms": 2.695369426440866, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0039637088775634766, "StateBufferConnector_ms": 0.0027599334716796875, "ViewRequirementAgentConnector_ms": 0.06862831115722656}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 288960, "num_agent_steps_trained": 288960, "num_env_steps_sampled": 288960, "num_env_steps_trained": 288960, "num_env_steps_sampled_this_iter": 480, "num_env_steps_trained_this_iter": 480, "num_env_steps_sampled_throughput_per_sec": 40.96087335195461, "num_env_steps_trained_throughput_per_sec": 40.96087335195461, "timesteps_total": 288960, "num_steps_trained_this_iter": 480, "agent_timesteps_total": 288960, "timers": {"training_iteration_time_ms": 2955.171, "sample_time_ms": 2950.934, "load_time_ms": 0.231, "load_throughput": 518829.481, "learn_time_ms": 3.182, "learn_throughput": 37707.823, "synch_weights_time_ms": 0.779}, "counters": {"num_env_steps_sampled": 288960, "num_env_steps_trained": 288960, "num_agent_steps_sampled": 288960, "num_agent_steps_trained": 288960}, "done": false, "episodes_total": 2408, "training_iteration": 603, "trial_id": "29a31_00000", "date": "2023-07-26_02-50-50", "timestamp": 1690329050, "time_this_iter_s": 11.72202181816101, "time_total_s": 7294.223139286041, "pid": 90822, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 1, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[253680, 5e-06], [256080, 5e-06], [258480, 2.5e-06], [260880, 2.5e-06], [263280, 2.5e-06], [265680, 2.5e-06], [268080, 1e-06], [270480, 1e-06], [272880, 1e-06], [275280, 5e-07], [277680, 5e-07], [280080, 5e-07], [282480, 5e-07], [284880, 5e-07], [287280, 1e-07], [289680, 1e-07], [292080, 1e-07]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 120, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x16ca65700>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1672.8976633548737, "iterations_since_restore": 143, "perf": {"cpu_util_percent": 39.9, "ram_util_percent": 78.15294117647058}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-07, "entropy_coeff": 0.05, "policy_entropy": 265.73492431640625, "policy_loss": -91115.8203125, "vf_loss": 3597001.25}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 574.0, "diff_num_grad_updates_vs_sampler_policy": 573.0}}, "num_env_steps_sampled": 289440, "num_env_steps_trained": 289440, "num_agent_steps_sampled": 289440, "num_agent_steps_trained": 289440}, "sampler_results": {"episode_reward_max": -231.74763244156043, "episode_reward_min": -1061.8762252237666, "episode_reward_mean": -719.1118231576105, "episode_len_mean": 120.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-522.1242556666122, -438.1174254569087, -670.530464445105, -1020.0141325025317, -231.74763244156043, -814.5989806353488, -572.5373769046483, -963.4093169303922, -378.7121108817956, -660.6809945759999, -964.4500678079972, -569.6248747523435, -655.2086356655067, -948.6080202306124, -969.4364238085022, -725.7014478863263, -541.3222933855977, -1008.6424508690859, -742.7160311111671, -779.4896749801029, -460.20891158542935, -645.4409639656476, -706.5483776911964, -565.9220434169837, -525.1114090311074, -780.5136943219226, -840.7269000866697, -673.5101670170865, -485.803438931345, -551.3636866450577, -908.9449212146648, -574.0773882990579, -462.41540130345356, -557.150220673903, -660.5988816692344, -627.3411577451357, -879.3806043926231, -562.4316851037782, -1061.8762252237666, -843.654621820575, -1048.4288646018947, -987.5935105478637, -622.2701431641075, -1008.7533844008826, -461.9230239621608, -699.5586721894739, -974.3962426513264, -613.6975434392224, -666.3097403539799, -722.8978520890435, -658.7188670623723, -484.81889639785794, -920.5124606153803, -884.8070548872474, -389.8007620963685, -820.973597930829, -801.9636503374331, -531.6714034058501, -895.0071001447924, -618.5695908984351, -786.6570764599375, -559.742439549061, -538.2297947752028, -694.6017662002592, -880.2445500912851, -732.3779458880055, -755.6675855089625, -908.8174840078908, -784.5750154257915, -898.5697845369799, -758.4893518189789, -535.8357694689186, -738.0307533327327, -719.3608944549892, -733.4183175261072, -685.2815129405838, -837.966023002167, -647.4860241209385, -768.7881292498366, -642.3379860592893, -649.7577702313796, -906.7586055803146, -556.8739593093886, -908.3115422177763, -384.607542787935, -791.039839589689, -818.4019704425682, -762.2701148396951, -768.9944532744827, -919.2177373753337, -599.1370072667128, -889.2630955674581, -795.8970049667029, -836.8383973970862, -832.1314842544978, -755.1277259081394, -786.4968598637971, -586.9018928625665, -586.4988266878918, -806.8126086664032], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 21.150165255974127, "mean_inference_ms": 0.4009969713702138, "mean_action_processing_ms": 0.09572135050730553, "mean_env_wait_ms": 2.695047915527937, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003983497619628906, "StateBufferConnector_ms": 0.0027730464935302734, "ViewRequirementAgentConnector_ms": 0.06913208961486816}}, "episode_reward_max": -231.74763244156043, "episode_reward_min": -1061.8762252237666, "episode_reward_mean": -719.1118231576105, "episode_len_mean": 120.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-522.1242556666122, -438.1174254569087, -670.530464445105, -1020.0141325025317, -231.74763244156043, -814.5989806353488, -572.5373769046483, -963.4093169303922, -378.7121108817956, -660.6809945759999, -964.4500678079972, -569.6248747523435, -655.2086356655067, -948.6080202306124, -969.4364238085022, -725.7014478863263, -541.3222933855977, -1008.6424508690859, -742.7160311111671, -779.4896749801029, -460.20891158542935, -645.4409639656476, -706.5483776911964, -565.9220434169837, -525.1114090311074, -780.5136943219226, -840.7269000866697, -673.5101670170865, -485.803438931345, -551.3636866450577, -908.9449212146648, -574.0773882990579, -462.41540130345356, -557.150220673903, -660.5988816692344, -627.3411577451357, -879.3806043926231, -562.4316851037782, -1061.8762252237666, -843.654621820575, -1048.4288646018947, -987.5935105478637, -622.2701431641075, -1008.7533844008826, -461.9230239621608, -699.5586721894739, -974.3962426513264, -613.6975434392224, -666.3097403539799, -722.8978520890435, -658.7188670623723, -484.81889639785794, -920.5124606153803, -884.8070548872474, -389.8007620963685, -820.973597930829, -801.9636503374331, -531.6714034058501, -895.0071001447924, -618.5695908984351, -786.6570764599375, -559.742439549061, -538.2297947752028, -694.6017662002592, -880.2445500912851, -732.3779458880055, -755.6675855089625, -908.8174840078908, -784.5750154257915, -898.5697845369799, -758.4893518189789, -535.8357694689186, -738.0307533327327, -719.3608944549892, -733.4183175261072, -685.2815129405838, -837.966023002167, -647.4860241209385, -768.7881292498366, -642.3379860592893, -649.7577702313796, -906.7586055803146, -556.8739593093886, -908.3115422177763, -384.607542787935, -791.039839589689, -818.4019704425682, -762.2701148396951, -768.9944532744827, -919.2177373753337, -599.1370072667128, -889.2630955674581, -795.8970049667029, -836.8383973970862, -832.1314842544978, -755.1277259081394, -786.4968598637971, -586.9018928625665, -586.4988266878918, -806.8126086664032], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 21.150165255974127, "mean_inference_ms": 0.4009969713702138, "mean_action_processing_ms": 0.09572135050730553, "mean_env_wait_ms": 2.695047915527937, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003983497619628906, "StateBufferConnector_ms": 0.0027730464935302734, "ViewRequirementAgentConnector_ms": 0.06913208961486816}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 289440, "num_agent_steps_trained": 289440, "num_env_steps_sampled": 289440, "num_env_steps_trained": 289440, "num_env_steps_sampled_this_iter": 480, "num_env_steps_trained_this_iter": 480, "num_env_steps_sampled_throughput_per_sec": 38.23962620754685, "num_env_steps_trained_throughput_per_sec": 38.23962620754685, "timesteps_total": 289440, "num_steps_trained_this_iter": 480, "agent_timesteps_total": 289440, "timers": {"training_iteration_time_ms": 3036.263, "sample_time_ms": 3031.948, "load_time_ms": 0.238, "load_throughput": 504274.602, "learn_time_ms": 3.239, "learn_throughput": 37049.155, "synch_weights_time_ms": 0.792}, "counters": {"num_env_steps_sampled": 289440, "num_env_steps_trained": 289440, "num_agent_steps_sampled": 289440, "num_agent_steps_trained": 289440}, "done": false, "episodes_total": 2412, "training_iteration": 604, "trial_id": "29a31_00000", "date": "2023-07-26_02-51-02", "timestamp": 1690329062, "time_this_iter_s": 12.55612325668335, "time_total_s": 7306.779262542725, "pid": 90822, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 1, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[253680, 5e-06], [256080, 5e-06], [258480, 2.5e-06], [260880, 2.5e-06], [263280, 2.5e-06], [265680, 2.5e-06], [268080, 1e-06], [270480, 1e-06], [272880, 1e-06], [275280, 5e-07], [277680, 5e-07], [280080, 5e-07], [282480, 5e-07], [284880, 5e-07], [287280, 1e-07], [289680, 1e-07], [292080, 1e-07]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 120, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x16ca65700>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1685.453786611557, "iterations_since_restore": 144, "perf": {"cpu_util_percent": 46.28333333333333, "ram_util_percent": 77.82222222222222}}
